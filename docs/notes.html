<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-09-18 Tue 15:50 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>My Notes</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">My Notes</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgb416898">1. PHP</a>
<ul>
<li><a href="#orgf9f5b0c">1.1. Configuration php:config</a>
<ul>
<li><a href="#org8c10304">1.1.1. Basics</a>
<ul>
<li><a href="#org9fce66e">1.1.1.1. PHP Version</a></li>
<li><a href="#orgc0f88fb">1.1.1.2. Possible places for php.ini</a></li>
<li><a href="#org67cd321">1.1.1.3. php.ini vs .user.ini</a></li>
<li><a href="#org8f6684d">1.1.1.4. Apache</a></li>
<li><a href="#org0a796f4">1.1.1.5. Configuration Mode</a></li>
<li><a href="#org4fee0b1">1.1.1.6. Directive Value</a></li>
</ul>
</li>
<li><a href="#org8ca756c">1.1.2. [PHP] php.ini:directives</a>
<ul>
<li><a href="#orgf8d48c4">1.1.2.1. magic quotes</a></li>
<li><a href="#org453a9aa">1.1.2.2. allow_url_fopen php.ini:allow_url_fopen</a></li>
<li><a href="#org5cb7399">1.1.2.3. auto_prepend_file</a></li>
<li><a href="#orgd0b4e95">1.1.2.4. expose_php php.ini:expose_php</a></li>
<li><a href="#orgb8894db">1.1.2.5. session php.ini:session</a></li>
</ul>
</li>
<li><a href="#org7d497da">1.1.3. Enable extension php.ini:extension</a></li>
<li><a href="#orgeb8ccfb">1.1.4. prod php.ini:prod</a></li>
<li><a href="#org3fdfdce">1.1.5. dev php.ini:dev</a></li>
<li><a href="#org3b25e18">1.1.6. Mail php:ini:mail</a></li>
<li><a href="#orgb3cd4c8">1.1.7. Error log php:show error</a></li>
</ul>
</li>
<li><a href="#org2f6f552">1.2. Predefined Constants and Magic Constants</a></li>
<li><a href="#orgb2d4f26">1.3. $_SERVER php:$_SERVER</a>
<ul>
<li><a href="#org95b71a0">1.3.1. Partyly safe</a></li>
<li><a href="#org67593e6">1.3.2. HTTP_HOST and SERVER_NAME</a></li>
</ul>
</li>
<li><a href="#org784e88b">1.4. $_FILES POST method uploads</a></li>
<li><a href="#orgf241a2c">1.5. Filesystem</a>
<ul>
<li><a href="#org6b2e319">1.5.1. Delete file - unlink</a></li>
<li><a href="#org6ffdb45">1.5.2. File Modification time</a></li>
<li><a href="#org07fd439">1.5.3. Include file - <span class="underline"><span class="underline">DIR</span></span> dirname(<span class="underline"><span class="underline">FILE</span></span>)</a></li>
</ul>
</li>
<li><a href="#org3e2d5ff">1.6. Module, Extension</a>
<ul>
<li><a href="#org61ec849">1.6.1. bz2</a></li>
<li><a href="#org4229f9a">1.6.2. bcmath</a></li>
<li><a href="#org6974d3c">1.6.3. calendar</a></li>
<li><a href="#orga0c3089">1.6.4. enchant</a></li>
<li><a href="#orge004411">1.6.5. exif</a></li>
<li><a href="#org525fbad">1.6.6. gd</a></li>
<li><a href="#orgf7737c9">1.6.7. gettext</a></li>
<li><a href="#org614fc28">1.6.8. intl</a></li>
<li><a href="#org8d9169f">1.6.9. pspell</a></li>
<li><a href="#org6bd79e1">1.6.10. soap</a></li>
<li><a href="#org84b7bbc">1.6.11. sockets</a></li>
<li><a href="#org26d3c33">1.6.12. tidy</a></li>
<li><a href="#org506e7bf">1.6.13. xmlrpc</a></li>
</ul>
</li>
<li><a href="#orgf444497">1.7. Locale</a></li>
<li><a href="#orgfe7529b">1.8. Date</a>
<ul>
<li><a href="#orgeec9e21">1.8.1. Create a custom date</a>
<ul>
<li><a href="#orgb10c221">1.8.1.1. mktime return Unix timestamp</a></li>
<li><a href="#orgbd1cc76">1.8.1.2. String to Time</a></li>
<li><a href="#org3a53349">1.8.1.3. Unix timestamp (int) to datetime object</a></li>
<li><a href="#orgf6872b8">1.8.1.4. Format difference between 2 Datetime objects</a></li>
</ul>
</li>
<li><a href="#org6f9de6a">1.8.2. Date in Other Languages (Locale)</a></li>
<li><a href="#orgbe14da7">1.8.3. Change timezone</a></li>
</ul>
</li>
<li><a href="#orgcd93790">1.9. Multibyte</a>
<ul>
<li><a href="#org6d1abe3">1.9.1. Remove 4 byte characters php:4byte</a></li>
</ul>
</li>
<li><a href="#org3094fda">1.10. Array</a>
<ul>
<li><a href="#org6a55f4b">1.10.1. array_merge, array_merge_recursive</a></li>
<li><a href="#org060a39b">1.10.2. Last element</a></li>
<li><a href="#orga3bf0eb">1.10.3. Search Value and Return Key</a></li>
<li><a href="#org622c133">1.10.4. Change Case for All Keys</a></li>
<li><a href="#orgc703577">1.10.5. Get values of a column in a multidimensional array</a></li>
<li><a href="#orga4fc77f">1.10.6. Remove values</a></li>
<li><a href="#org822aac0">1.10.7. Change values of all elements php:array_map</a></li>
<li><a href="#org42380b1">1.10.8. Insert to any position of an array</a></li>
<li><a href="#orgc05d81b">1.10.9. array_filter</a></li>
<li><a href="#org881053c">1.10.10. Sort arrays</a>
<ul>
<li><a href="#org57d3eee">1.10.10.1. usort uasort - value sort</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org0379ec1">1.11. String</a>
<ul>
<li><a href="#org1964ec6">1.11.1. String to HTML, php:DOMDocument</a></li>
<li><a href="#orge6c73b7">1.11.2. Remove HTML tag, regex</a></li>
<li><a href="#org86fdffb">1.11.3. Remove an attribute from string, regex</a></li>
<li><a href="#orgf4c43fa">1.11.4. String Ellipsis, Trim</a></li>
<li><a href="#orgbcdc27b">1.11.5. Encode HTML php:htmlspecialchars</a></li>
<li><a href="#org91800fa">1.11.6. UTF-8 encoding php:string:encoding php:mb_convert_encoding php:mb_detect_encoding</a></li>
<li><a href="#orgb8c8aa3">1.11.7. Replace last</a></li>
<li><a href="#orgfd12617">1.11.8. Start with</a></li>
<li><a href="#org13184b0">1.11.9. Random bash64 string</a></li>
</ul>
</li>
<li><a href="#org36bc2a3">1.12. URL</a></li>
<li><a href="#orged819bd">1.13. Random Integer Number</a></li>
<li><a href="#org1d3623f">1.14. encrypt, decrypt</a></li>
<li><a href="#org00f67cb">1.15. HTML encode and decode</a></li>
<li><a href="#org831f0b7">1.16. Heredoc, Nowdoc</a></li>
<li><a href="#orgaf01cea">1.17. Buffer php:buffer</a></li>
<li><a href="#orgefd6cac">1.18. Template System</a></li>
<li><a href="#orgcd5fa6b">1.19. Image</a>
<ul>
<li><a href="#org05138cb">1.19.1. GD vs Imagick</a></li>
<li><a href="#org60815d7">1.19.2. Create image in memory and output</a></li>
<li><a href="#org8890d7c">1.19.3. Resize image</a></li>
</ul>
</li>
<li><a href="#orgd762c44">1.20. Apply XSLT on XML</a></li>
<li><a href="#orge727870">1.21. Block Referral Traffic</a></li>
<li><a href="#org44ffd64">1.22. PHPDoc PHPDoc</a>
<ul>
<li><a href="#org9b11e4f">1.22.1. Tag reference</a>
<ul>
<li><a href="#org745bee0">1.22.1.1. @code</a></li>
</ul>
</li>
<li><a href="#org8d94b21">1.22.2. datatype PHPDoc:datatype</a></li>
<li><a href="#org01c355d">1.22.3. @var PHPDoc:@var</a></li>
<li><a href="#org0e3bd21">1.22.4. @see PHPDoc:@see</a></li>
<li><a href="#org3072b35">1.22.5. @example</a></li>
</ul>
</li>
<li><a href="#org018fa41">1.23. mysqli</a></li>
<li><a href="#org73ed4f7">1.24. OOP</a>
<ul>
<li><a href="#org1c6c795">1.24.1. Sample</a></li>
<li><a href="#org0894207">1.24.2. Inheritance</a></li>
<li><a href="#org98ae469">1.24.3. Abstract Class</a></li>
<li><a href="#orgd9fc18d">1.24.4. Interface</a></li>
<li><a href="#org1105a16">1.24.5. Interface vs Abstract Class</a></li>
<li><a href="#org2398b95">1.24.6. Use trait with interface</a></li>
<li><a href="#orga363b74">1.24.7. Magic Methods</a>
<ul>
<li><a href="#org98a73f0">1.24.7.1. Overloading</a></li>
<li><a href="#org19d862a">1.24.7.2. __construct, __destruct</a></li>
<li><a href="#org192eb39">1.24.7.3. __toString()</a></li>
<li><a href="#orgccad83e">1.24.7.4. __clone()</a></li>
</ul>
</li>
<li><a href="#orge96cbea">1.24.8. Clone, copy and reference</a></li>
<li><a href="#orgad965a3">1.24.9. Autoload Classes</a></li>
<li><a href="#org0a6b9d2">1.24.10. Design Pattern</a>
<ul>
<li><a href="#org12df92a">1.24.10.1. Singleton Pattern</a></li>
<li><a href="#orge8ecf5c">1.24.10.2. Lazy Initialization</a></li>
<li><a href="#org08c858f">1.24.10.3. Factory Method</a></li>
<li><a href="#orgc1caa8c">1.24.10.4. Strategy Pattern</a></li>
<li><a href="#org29d31a9">1.24.10.5. Dependency Injection</a></li>
<li><a href="#org356ad7c">1.24.10.6. Decorator</a></li>
</ul>
</li>
<li><a href="#org42941e9">1.24.11. Namespace</a></li>
<li><a href="#org2d537a1">1.24.12. Cannot redeclare class</a></li>
</ul>
</li>
<li><a href="#org536edb6">1.25. Http Request - cURL, file_get_contents</a>
<ul>
<li><a href="#org8542db2">1.25.1. cURL-less php:file_get_contents</a></li>
<li><a href="#org15bef2a">1.25.2. cURL php:curl</a></li>
</ul>
</li>
<li><a href="#orgcfa5b6e">1.26. PHP HTTP Header php:header</a></li>
<li><a href="#org273dcd0">1.27. Troubleshooting</a>
<ul>
<li><a href="#org129d15a">1.27.1. Parse error: syntax error, unexpected end of file</a></li>
</ul>
</li>
<li><a href="#orgb5e33b9">1.28. Naming Convention</a></li>
<li><a href="#orgcb0c1f1">1.29. Shell Exec Command</a></li>
<li><a href="#org3ca6afc">1.30. Session</a></li>
<li><a href="#org9f95be7">1.31. Development mode determined by url parameter</a></li>
<li><a href="#org16934c7">1.32. RESTful</a></li>
<li><a href="#orge164938">1.33. Libraries</a>
<ul>
<li><a href="#org5e532d2">1.33.1. mPDF</a>
<ul>
<li><a href="#org9e389a7">1.33.1.1. @page</a></li>
</ul>
</li>
<li><a href="#org92edc53">1.33.2. Mobile-Detect</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgb355d57">2. Drupal</a>
<ul>
<li><a href="#org8595050">2.1. Install Drupal on Windows</a></li>
<li><a href="#org0d10c43">2.2. Update Core</a>
<ul>
<li><a href="#org8067c5b">2.2.1. 7.x</a></li>
<li><a href="#org844409f">2.2.2. Troubleshoot</a>
<ul>
<li><a href="#org36251d4">2.2.2.1. The following module is missing from the file system</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org9b5037d">2.3. Update Module</a></li>
<li><a href="#org4cc9383">2.4. Module</a>
<ul>
<li><a href="#org52b4314">2.4.1. Custom Module</a>
<ul>
<li><a href="#org4d5b948">2.4.1.1. .info file</a></li>
<li><a href="#orgcd8f048">2.4.1.2. Refactor, include .inc files</a></li>
<li><a href="#orgc149e39">2.4.1.3. lili.api.php</a></li>
</ul>
</li>
<li><a href="#org8333abb">2.4.2. sqlsrv</a></li>
<li><a href="#org9905517">2.4.3. Feeds - Package: Feeds</a>
<ul>
<li><a href="#orgc63c75b">2.4.3.1. New Feed Tamper Plugin</a></li>
<li><a href="#org7965a97">2.4.3.2. XPath</a></li>
</ul>
</li>
<li><a href="#org2a83ac9">2.4.4. Feeds Tamper - feeds_tamper - Package: Feeds</a></li>
<li><a href="#org1b1cbb1">2.4.5. Feeds Tamper Importer - feeds_tamper_importer - Package: Feeds</a></li>
<li><a href="#org0eee24a">2.4.6. Feeds XPath Parser - feeds_xpathparser - Package: Feeds</a></li>
<li><a href="#org30b3497">2.4.7. Feeds entity processor - feeds_entity_processor - Package: Feeds</a></li>
<li><a href="#org46499f4">2.4.8. XML Sitemap</a></li>
<li><a href="#orge1d9d84">2.4.9. ThemeKey</a></li>
<li><a href="#orgc79bd5d">2.4.10. Devel</a></li>
<li><a href="#orgcb23d1a">2.4.11. Administrator menu - admin_menu - Package: Administration</a></li>
<li><a href="#orgf1dd0ea">2.4.12. Administration Views - admin_views - Package: Administration</a></li>
<li><a href="#org26c7983">2.4.13. Administer Users by Role - administerusersbyrole</a></li>
<li><a href="#org6bb21e3">2.4.14. Variable</a></li>
<li><a href="#orgf52e34a">2.4.15. Libraries</a></li>
<li><a href="#org3f03fc6">2.4.16. Module Filter</a></li>
<li><a href="#org4e23154">2.4.17. Geocoder</a></li>
<li><a href="#org5083909">2.4.18. Entity View Modes - entity_view_mode</a></li>
<li><a href="#orgcf1b01c">2.4.19. wysiwyg</a>
<ul>
<li><a href="#orga45d428">2.4.19.1. Installation &amp; Config</a></li>
<li><a href="#org100ec36">2.4.19.2. Troubleshoot</a></li>
</ul>
</li>
<li><a href="#org1843b14">2.4.20. IMCE Wysiwyg bridge: imce_wysiwyg</a></li>
<li><a href="#org10423a4">2.4.21. IMCE</a></li>
<li><a href="#org52af3db">2.4.22. ckeditor</a></li>
<li><a href="#orgc519f57">2.4.23. nodeblock</a></li>
<li><a href="#org37884df">2.4.24. Block Group</a></li>
<li><a href="#org395d427">2.4.25. MultiBlock</a></li>
<li><a href="#org32dfa0c">2.4.26. Conditional Fields</a></li>
<li><a href="#org1c5762b">2.4.27. Search404</a></li>
<li><a href="#orgda27a63">2.4.28. Google Analytics</a></li>
<li><a href="#org29eedd8">2.4.29. Elysia Cron</a></li>
<li><a href="#orgea958d6">2.4.30. SMTP Authentication Support</a></li>
<li><a href="#orgc8fef40">2.4.31. Entity API - entity</a></li>
<li><a href="#orgafd09a8">2.4.32. Chaos Tools - ctools</a></li>
<li><a href="#orgf4a2353">2.4.33. Address Field - addressfield - Package: Fields</a></li>
<li><a href="#org7ba646e">2.4.34. Email - email - Package: Fields</a></li>
<li><a href="#orgffdc4b1">2.4.35. Geofield - Package: Fields</a></li>
<li><a href="#org0c531ef">2.4.36. Viewfield - Package: Fields</a></li>
<li><a href="#org6ddc1aa">2.4.37. Field collection - field_collection - Package: Fields</a></li>
<li><a href="#org49e77c6">2.4.38. Social Field - socialfield - Package: Fields</a></li>
<li><a href="#org1502171">2.4.39. Video Embed Field - video_embed_field - Package: Media</a></li>
<li><a href="#orga21532b">2.4.40. Display Suite - ds - Package: Display Suite</a></li>
<li><a href="#org557989b">2.4.41. Meta Tag - metatag</a></li>
<li><a href="#orgbec2115">2.4.42. Entity Reference - entityreference</a></li>
<li><a href="#orgb21c9ca">2.4.43. File Entity</a></li>
<li><a href="#org91f278f">2.4.44. Webform</a></li>
<li><a href="#org5fcfa51">2.4.45. Webform Validation</a></li>
<li><a href="#org0e343d6">2.4.46. Panels</a></li>
<li><a href="#org6d2b0ce">2.4.47. Facet API</a></li>
<li><a href="#org2706599">2.4.48. Search API - search_api</a>
<ul>
<li><a href="#orge8d79d5">2.4.48.1. Glossary</a></li>
<li><a href="#org28ea9c1">2.4.48.2. Index</a></li>
<li><a href="#org758782b">2.4.48.3. Create a search view or a search page</a></li>
<li><a href="#org1c20077">2.4.48.4. Convert an existing view to search api</a></li>
<li><a href="#orgaffe350">2.4.48.5. Configure Facet, Facet Blocks</a></li>
<li><a href="#orgfe240e8">2.4.48.6. Views Filter &gt; Search: Fulltext search</a></li>
<li><a href="#orgffb65ee">2.4.48.7. Current Search Block</a></li>
<li><a href="#org10d6a14">2.4.48.8. Other useful modules</a></li>
<li><a href="#orgcd21a41">2.4.48.9. Developer Documentation</a></li>
<li><a href="#orge625c5d">2.4.48.10. API of Search API</a></li>
</ul>
</li>
<li><a href="#org8571462">2.4.49. Search API Solr - search_api_solr - Package: Search</a>
<ul>
<li><a href="#org6fb97aa">2.4.49.1. Debug</a></li>
</ul>
</li>
<li><a href="#org09db53c">2.4.50. Search API Solr Overrides - search_api_solr_overrides</a></li>
<li><a href="#orgefa216e">2.4.51. Views</a></li>
<li><a href="#org9aa132e">2.4.52. Better Exposed Filters</a></li>
<li><a href="#orgbcc8ed6">2.4.53. Views Bulk Operations</a></li>
<li><a href="#orga8aa201">2.4.54. Administration views</a></li>
<li><a href="#orgfe7bfb2">2.4.55. Media</a></li>
<li><a href="#org91854ae">2.4.56. Internationalization - i18n</a></li>
<li><a href="#org84f5460">2.4.57. S3 File System - s3fs</a></li>
<li><a href="#orga0f1b76">2.4.58. Password Policy - password_policy</a></li>
<li><a href="#org1c92d1f">2.4.59. Secure Login - securelogin</a></li>
<li><a href="#org412f509">2.4.60. Secure Review - security_review</a></li>
<li><a href="#orge1d616c">2.4.61. Security Kit - seckit</a></li>
</ul>
</li>
<li><a href="#org2403e14">2.5. Debug d7:debug</a></li>
<li><a href="#orgaf0b062">2.6. Configuration, Setting, Maintenance Mode</a>
<ul>
<li><a href="#org76abcb2">2.6.1. d7:mysql:charset</a></li>
<li><a href="#orgfd5b8de">2.6.2. Show error d7:show error</a></li>
<li><a href="#orgb6354ac">2.6.3. Session Timeout, Session Cookie Timeout</a></li>
</ul>
</li>
<li><a href="#org1220ef8">2.7. URL Alias</a></li>
<li><a href="#org5735c86">2.8. Link, Module Path, Theme Path</a>
<ul>
<li><a href="#org9dfc129">2.8.1. Link</a></li>
<li><a href="#org948ec95">2.8.2. Current External URL, d7:url d7:current_path</a></li>
<li><a href="#orgcb4ac75">2.8.3. Module Path, Theme Path</a></li>
<li><a href="#orgb939cc7">2.8.4. global $base_url</a></li>
</ul>
</li>
<li><a href="#org393ce25">2.9. Translate</a>
<ul>
<li><a href="#org95d70de">2.9.1. t()</a></li>
<li><a href="#org4bcca99">2.9.2. Translate Date and Time</a></li>
</ul>
</li>
<li><a href="#org8f92453">2.10. Global Variables</a></li>
<li><a href="#orga49fb5b">2.11. Common Functions d7:functions</a>
<ul>
<li><a href="#orgdb2e83c">2.11.1. drupal_add_html_head</a></li>
<li><a href="#org91dd984">2.11.2. drupal_set_title</a></li>
<li><a href="#orgb606a27">2.11.3. drupal_goto</a></li>
<li><a href="#org39c478f">2.11.4. drupal_valid_path($path, $dynamic_allow= TRUE)</a></li>
<li><a href="#org6b3e8f4">2.11.5. drupal_clean_css_identifier</a></li>
<li><a href="#org5d15591">2.11.6. Sanitization functions d7:functions:sanitization</a></li>
</ul>
</li>
<li><a href="#orgbfdc36d">2.12. Theme API</a>
<ul>
<li><a href="#orgced9ba7">2.12.1. render() vs drupal_render()</a></li>
<li><a href="#org91b2595">2.12.2. theme()</a></li>
<li><a href="#org4bd6610">2.12.3. System Theme</a>
<ul>
<li><a href="#orga068e27">2.12.3.1. Fast detect if it's a node page</a></li>
<li><a href="#orgb100cec">2.12.3.2. Include file in *.tpl.php</a></li>
<li><a href="#org222f013">2.12.3.3. .info (required)</a></li>
<li><a href="#org0707062">2.12.3.4. html.tpl.php</a></li>
<li><a href="#org9e0051a">2.12.3.5. page.tpl.php</a></li>
<li><a href="#org8397e23">2.12.3.6. region.tpl.php</a></li>
<li><a href="#org907aafd">2.12.3.7. block.tpl.php</a></li>
<li><a href="#orge7f31be">2.12.3.8. node.tpl.php</a></li>
<li><a href="#org7b92481">2.12.3.9. field.tpl.php</a></li>
<li><a href="#org21252a0">2.12.3.10. comment-wrapper.tpl.php</a></li>
<li><a href="#org231ebab">2.12.3.11. comment.tpl.php</a></li>
<li><a href="#org6782c15">2.12.3.12. template.php</a></li>
<li><a href="#org5411437">2.12.3.13. logo.png</a></li>
<li><a href="#org4c5f8c9">2.12.3.14. screenshot.png</a></li>
</ul>
</li>
<li><a href="#org37c5261">2.12.4. Form Theme</a></li>
<li><a href="#orgce6dbf8">2.12.5. Region</a></li>
<li><a href="#org149f834">2.12.6. Block</a>
<ul>
<li><a href="#orge8885f6">2.12.6.1. hook_block_info</a></li>
<li><a href="#org927ab36">2.12.6.2. hook_block_view</a></li>
<li><a href="#org8b7e7d2">2.12.6.3. hook_block_view_alter</a></li>
<li><a href="#orgb4dcce2">2.12.6.4. Configurable Block: hook_block_configure, hook_block_save</a></li>
<li><a href="#orged989c5">2.12.6.5. Block API Sequence</a></li>
<li><a href="#org36b41f1">2.12.6.6. Render a block</a></li>
</ul>
</li>
<li><a href="#org61b4922">2.12.7. Custom Theme Function</a></li>
<li><a href="#orgeb7d26f">2.12.8. Sub theme</a></li>
<li><a href="#orgb2553de">2.12.9. 404 page</a></li>
<li><a href="#org929ff5b">2.12.10. Contributed themes</a>
<ul>
<li><a href="#org856bae5">2.12.10.1. Omega</a></li>
<li><a href="#org248c047">2.12.10.2. Corolla</a></li>
</ul>
</li>
<li><a href="#org75b13e7">2.12.11. Render a field of a node, a term</a>
<ul>
<li><a href="#org26ade1f">2.12.11.1. field_get_items, field_view_value, field_view_field</a></li>
<li><a href="#org1406470">2.12.11.2. Using node template</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org0f97127">2.13. Drush</a>
<ul>
<li><a href="#orgb3595e8">2.13.1. version <code>drush version</code></a></li>
<li><a href="#org01cb1fc">2.13.2. Debug <code>-vd</code></a></li>
<li><a href="#orgf56cb80">2.13.3. Alias</a></li>
<li><a href="#org7c93854">2.13.4. User</a></li>
<li><a href="#orgb4a6b14">2.13.5. Module</a></li>
<li><a href="#orgb973845">2.13.6. Detect if it's drush</a></li>
<li><a href="#org73752b9">2.13.7. Watchdog</a>
<ul>
<li><a href="#org4432a2d">2.13.7.1. Delete</a></li>
<li><a href="#org4a74aaf">2.13.7.2. Tail Recent Log Messages</a></li>
</ul>
</li>
<li><a href="#org9f347a4">2.13.8. SQL Query</a></li>
<li><a href="#orgd5e072e">2.13.9. Drupal Cache</a></li>
<li><a href="#orgcb5f0be">2.13.10. Fields</a></li>
<li><a href="#orgf972c9f">2.13.11. Custom Drush</a></li>
<li><a href="#org4c3efd2">2.13.12. Pantheon Drush</a></li>
</ul>
</li>
<li><a href="#org71b1f18">2.14. Node API d7:api:node</a>
<ul>
<li><a href="#org3eb3223">2.14.1. Update a node</a></li>
</ul>
</li>
<li><a href="#org5afd88a">2.15. Views d7:viewsapi</a>
<ul>
<li><a href="#org7a3fd71">2.15.1. UI</a>
<ul>
<li><a href="#orgd75e66b">2.15.1.1. Contextual filter with term name not term id</a></li>
<li><a href="#org9c5cfb2">2.15.1.2. Path vs Link</a></li>
<li><a href="#org2b71f11">2.15.1.3. Field value is taxonomy ID not taxonomy name</a></li>
<li><a href="#org6519b78">2.15.1.4. Row Class</a></li>
<li><a href="#orgcb8a157">2.15.1.5. Sort Tax Term Field</a></li>
</ul>
</li>
<li><a href="#org1f0f639">2.15.2. Entity Reference View</a></li>
<li><a href="#org56a77d3">2.15.3. View Object</a>
<ul>
<li><a href="#orga43ba16">2.15.3.1. Properties</a></li>
<li><a href="#org470537f">2.15.3.2. Methods</a></li>
</ul>
</li>
<li><a href="#org5c8881b">2.15.4. hook_views_api</a></li>
<li><a href="#orga372c78">2.15.5. hook_views_query_alter</a></li>
<li><a href="#org81d1d99">2.15.6. hook_views_pre_build</a></li>
<li><a href="#org8432f59">2.15.7. hook_views_pre_render</a>
<ul>
<li><a href="#org4222d27">2.15.7.1. Change Global Custom Text</a></li>
</ul>
</li>
<li><a href="#org897bbe8">2.15.8. Custom View Filter hook_views_data_alter</a></li>
<li><a href="#orge637db3">2.15.9. Better Exposed Filters Module d7:better exposed filters</a></li>
<li><a href="#org8d73bfb">2.15.10. Custom Views Plugin hook_views_plugins</a></li>
<li><a href="#orgdc9b5ef">2.15.11. Views API Order</a></li>
<li><a href="#org1d00242">2.15.12. Embed View and Display</a></li>
<li><a href="#org4f8f953">2.15.13. View Theming</a></li>
</ul>
</li>
<li><a href="#org217f3e3">2.16. Ellipsis d7:ellipsis</a></li>
<li><a href="#orgef70685">2.17. Form</a>
<ul>
<li><a href="#org6cfe556">2.17.1. Form API</a></li>
<li><a href="#orgea10218">2.17.2. Form alter hooks</a></li>
<li><a href="#org56c2a37">2.17.3. Form IDs of system forms</a></li>
<li><a href="#org0dab3cc">2.17.4. Confirm Form</a></li>
<li><a href="#orgc7f8af7">2.17.5. form_load_include</a></li>
<li><a href="#org1d03837">2.17.6. Form Ajax</a></li>
<li><a href="#org4a44cf2">2.17.7. Form field loaded with terms of a taxonomy fields d7:form:taxonomy field</a></li>
</ul>
</li>
<li><a href="#orgcd2f422">2.18. Action</a></li>
<li><a href="#org2e6600f">2.19. Field API d7:api:field</a>
<ul>
<li><a href="#org318a82d">2.19.1. hook_field_is_empty d7:api:field:hook_field_is_empty</a></li>
<li><a href="#org737ba70">2.19.2. Field Formatter d7:api:field:formatter</a></li>
<li><a href="#org2287ba5">2.19.3. field_get_items d7:field_get_items</a>
<ul>
<li><a href="#org5272e1e">2.19.3.1. Image field</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgc6c2456">2.20. Database</a>
<ul>
<li><a href="#org4013776">2.20.1. Close Comment for Existing Nodes</a></li>
<li><a href="#org6eeb37b">2.20.2. Structure</a>
<ul>
<li><a href="#orge874ddd">2.20.2.1. node</a></li>
<li><a href="#org8023299">2.20.2.2. field_data_body</a></li>
<li><a href="#orgba65d21">2.20.2.3. field_data_field_custom_term_reference</a></li>
<li><a href="#orga2d131d">2.20.2.4. taxonomy_term_data</a></li>
<li><a href="#org225b027">2.20.2.5. taxonomy_vocabular</a></li>
<li><a href="#org6173e53">2.20.2.6. field_data_field_contributor (entity reference)</a></li>
<li><a href="#orga3b465f">2.20.2.7. url_alias</a></li>
<li><a href="#org4059c05">2.20.2.8. Export Query</a></li>
<li><a href="#orgcd7455a">2.20.2.9. Export File URI, file_managed d7:db:file uri</a></li>
<li><a href="#orgb15f22e">2.20.2.10. file_usage</a></li>
<li><a href="#org57e8ce6">2.20.2.11. system</a></li>
<li><a href="#org4971254">2.20.2.12. users</a></li>
<li><a href="#orgbe43f3c">2.20.2.13. users_role</a></li>
<li><a href="#org015a567">2.20.2.14. role</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgb35fff7">2.21. Query</a>
<ul>
<li><a href="#org17cfd9a">2.21.1. db_select</a></li>
<li><a href="#orgfbe915f">2.21.2. db_query</a></li>
<li><a href="#orge70419c">2.21.3. db_delete</a></li>
<li><a href="#orgcf045ed">2.21.4. hook_query_TAG_alter hook_query_TAG_alter</a></li>
</ul>
</li>
<li><a href="#org1a4d154">2.22. Entity</a>
<ul>
<li><a href="#org2c9de92">2.22.1. EntityFieldQuery d7:efq</a></li>
<li><a href="#orgc5462fa">2.22.2. Update a field of an entity only d7:field_attach_update</a></li>
<li><a href="#orgaede518">2.22.3. entity_metadata_wrapper d7:entity_metadata_wrapper</a></li>
</ul>
</li>
<li><a href="#org68d6f55">2.23. Entityform</a></li>
<li><a href="#org9205fcc">2.24. User</a>
<ul>
<li><a href="#org37f131d">2.24.1. Get user fields</a></li>
<li><a href="#org618cc43">2.24.2. user_access</a></li>
<li><a href="#orge10bfd5">2.24.3. user_is_logged_in, user_has_role</a></li>
</ul>
</li>
<li><a href="#org032de29">2.25. Menu</a>
<ul>
<li><a href="#orgf3cd567">2.25.1. hook_menu: 'page callback'</a></li>
<li><a href="#org8fec258">2.25.2. hook_menu: 'file'</a></li>
<li><a href="#org3cb8aa6">2.25.3. hook_menu: 'type'</a></li>
<li><a href="#orgfaf13d2">2.25.4. hook_menu: 'access callback', 'access arguments'</a></li>
<li><a href="#orgcf05069">2.25.5. Embed a View Page</a></li>
<li><a href="#orgda00790">2.25.6. Array to CSV</a></li>
<li><a href="#org27e908e">2.25.7. Json</a></li>
</ul>
</li>
<li><a href="#orga364eb3">2.26. Taxonomy</a>
<ul>
<li><a href="#org4a42d1c">2.26.1. Get taxonomy terms of a node, ready for display with language</a></li>
<li><a href="#orgb0f33cd">2.26.2. Get multiple terms by id, taxonomy_term_load_multiple</a></li>
<li><a href="#orgd545812">2.26.3. Get term by name, taxonomy_get_term_by_name</a></li>
<li><a href="#org4671c4c">2.26.4. Get all children of a term, taxonomy_get_children</a></li>
<li><a href="#org72dcfcb">2.26.5. Get a vocabulary by name and all terms</a></li>
<li><a href="#orga7494c7">2.26.6. Get terms of a vocabulary ready for form</a></li>
</ul>
</li>
<li><a href="#orgfc594d3">2.27. Cache</a>
<ul>
<li><a href="#org6d4423e">2.27.1. Setting</a></li>
<li><a href="#orgbe144da">2.27.2. Same page request</a></li>
<li><a href="#orgfa8ff79">2.27.3. Cache variables in cache table, and clear them</a></li>
<li><a href="#org6e89155">2.27.4. Cache block d7:cache block</a></li>
</ul>
</li>
<li><a href="#orgb54f82c">2.28. File</a></li>
<li><a href="#org99a5042">2.29. Image Handling (Core)</a>
<ul>
<li><a href="#orgd945f55">2.29.1. Setting</a></li>
<li><a href="#orge5d4201">2.29.2. Code</a></li>
<li><a href="#org852e931">2.29.3. Get File URI from db d7:db:file uri</a></li>
</ul>
</li>
<li><a href="#orga1b8e7c">2.30. Basic Ajax</a></li>
<li><a href="#org8edd429">2.31. Javascript API</a>
<ul>
<li><a href="#org9120d09">2.31.1. Settings</a></li>
<li><a href="#orgb0eb6b7">2.31.2. Behaviors</a></li>
</ul>
</li>
<li><a href="#org6293cbb">2.32. Email</a></li>
<li><a href="#org72fea26">2.33. OOP</a></li>
</ul>
</li>
<li><a href="#org8c66b27">3. WordPress</a>
<ul>
<li><a href="#orge4e0a60">3.1. Core Update</a>
<ul>
<li><a href="#orgcad6f5d">3.1.1. Manual Update Core</a></li>
<li><a href="#org4d5c6ba">3.1.2. Release</a></li>
<li><a href="#org841492a">3.1.3. TS: update-core.php blank</a></li>
</ul>
</li>
<li><a href="#orga1483e4">3.2. Migrate database</a></li>
<li><a href="#org493c062">3.3. Redirect a path a Wordpress website wp:redirect path to wp</a>
<ul>
<li><a href="#org07b2c1c">3.3.1. Method 1: Apache</a></li>
<li><a href="#org7d4d12e">3.3.2. Method 2: (Not working..) Nginx proxy to another</a></li>
</ul>
</li>
<li><a href="#org36568a8">3.4. Load WP Core in sub directory under same domain</a></li>
<li><a href="#org5747bb5">3.5. Global Variables</a>
<ul>
<li><a href="#org9e4ae6e">3.5.1. $_GET, $_POST, $_COOKIE, $_SERVER</a></li>
<li><a href="#orgc138238">3.5.2. $post wp:global:post</a></li>
<li><a href="#org5c9470c">3.5.3. $wpdb wp:global:wpdb</a></li>
</ul>
</li>
<li><a href="#org65f8e90">3.6. wp-config.php</a>
<ul>
<li><a href="#org2a7daaf">3.6.1. wp:wp-config:DISALLOW_FILE_EDIT</a></li>
</ul>
</li>
<li><a href="#orgdb0f92b">3.7. Email PHPMailer</a></li>
<li><a href="#org830cccb">3.8. PHP redirect wp:php:redirect</a></li>
<li><a href="#org5ff9f70">3.9. WP-CLI wp-cli</a>
<ul>
<li><a href="#org46e23cb">3.9.1. WP CLI Install, Upgrade</a></li>
<li><a href="#org89397f4">3.9.2. Global Parameters</a></li>
<li><a href="#org43a9b59">3.9.3. User</a></li>
<li><a href="#orge4cf021">3.9.4. Core</a></li>
<li><a href="#orged56414">3.9.5. Plugin</a></li>
<li><a href="#orga3d74cc">3.9.6. CLI Package</a></li>
<li><a href="#orgc8f0e00">3.9.7. Theme</a></li>
<li><a href="#orgf030fb5">3.9.8. login</a></li>
<li><a href="#org3555a46">3.9.9. db check</a></li>
<li><a href="#orgf7b0f3f">3.9.10. db search</a></li>
<li><a href="#org8eae8de">3.9.11. db export</a></li>
<li><a href="#org0c4e331">3.9.12. db size</a></li>
<li><a href="#orge3d0b28">3.9.13. db query</a></li>
<li><a href="#org402f9e1">3.9.14. Search and replace wp-cli:search-replace</a></li>
<li><a href="#org6a86ca6">3.9.15. Common Issues</a>
<ul>
<li><a href="#orgc178d51">3.9.15.1. Can't connect to database</a></li>
<li><a href="#org0792d06">3.9.15.2. Out of memory</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org3025ad3">3.10. Conditional Tags wp:conditional tags</a></li>
<li><a href="#org1328ee8">3.11. Template Tags wp:template tags</a>
<ul>
<li><a href="#org29b352a">3.11.1. post-thumbnail-template.php wp:t:thumbnail</a></li>
<li><a href="#org7b907c9">3.11.2. post-template.php wp:t:post</a></li>
<li><a href="#orga7b98c1">3.11.3. category-template.php wp:t:category</a></li>
<li><a href="#org56e7fef">3.11.4. general-template wp:t:general</a></li>
<li><a href="#org7b12932">3.11.5. author-template.php</a></li>
</ul>
</li>
<li><a href="#orgc65e235">3.12. Functions</a>
<ul>
<li><a href="#org0f29e99">3.12.1. get_bloginfo, bloginfo, Site tagline, Sitetitle</a></li>
<li><a href="#orgc2cac9b">3.12.2. get_the_ID() the_ID() - ID of current item or false</a></li>
<li><a href="#orgc9ad5eb">3.12.3. get_post wp:f:get_post</a></li>
<li><a href="#org96d9298">3.12.4. get_post_meta, get_metadata wp:f:get_post_meta wp:f:get_metadata</a></li>
<li><a href="#org0c42afa">3.12.5. wp_get_post_terms($post_id, $tax, $args)</a></li>
<li><a href="#org598ee0d">3.12.6. wp_editor</a></li>
<li><a href="#org4d947b8">3.12.7. Translate</a>
<ul>
<li><a href="#org9722e94">3.12.7.1. Translate Functions</a></li>
<li><a href="#org07928ca">3.12.7.2. Setup, .po and .mo files</a></li>
</ul>
</li>
<li><a href="#org4788ab2">3.12.8. add_theme_support wp:f:add_theme_support</a></li>
<li><a href="#orgf2e1139">3.12.9. add_image_size</a></li>
<li><a href="#org636735d">3.12.10. add_management_page</a></li>
<li><a href="#org446aa2f">3.12.11. add_post_type_support</a></li>
<li><a href="#orgd428609">3.12.12. add_rewrite_rule, add_rewrite_tag wp:f:add_rewrite_rule wp:f:add_rewrite_tag</a></li>
<li><a href="#org9ffcc1e">3.12.13. add_editor_style</a></li>
<li><a href="#org343c8af">3.12.14. has_post_format wp:f:has_post_format</a></li>
<li><a href="#org74f9b8a">3.12.15. has_custom_logo, get_custom_logo, the_custom_logo wp:custom logo:display</a></li>
<li><a href="#org8213403">3.12.16. remove_meta_box</a></li>
<li><a href="#orgdf96eb6">3.12.17. get_header, get_footer, get_sidebar, get_search_form, comments_template</a></li>
<li><a href="#org8ba0a6d">3.12.18. get_template_part, get_theme_file_uri, get_theme_file_path wp:f:get_template_part</a></li>
<li><a href="#org06cf52f">3.12.19. get_template_directory, get_template_directory_uri, get_stylesheet_directory_uri, get_stylesheet_uri</a></li>
<li><a href="#orgb492f99">3.12.20. wp_upload_dir</a></li>
<li><a href="#org7aaa75d">3.12.21. get_the_excerpt, the_excerpt</a></li>
<li><a href="#org2056e21">3.12.22. wp_remote_get, wp_remote_post, wp_remote_head, wp_remote_request</a></li>
<li><a href="#org0a1e13e">3.12.23. register_post_type wp:f:register_post_type</a>
<ul>
<li><a href="#org5c339fa">3.12.23.1. labels</a></li>
<li><a href="#org0023c8c">3.12.23.2. menu_icon</a></li>
</ul>
</li>
<li><a href="#org37d427a">3.12.24. register_nav_menus, register_nav_menu, wp_nav_menu</a></li>
<li><a href="#org47f762a">3.12.25. register_widget wp:f:register_widget</a></li>
<li><a href="#orgf7975a1">3.12.26. wpautop wp:f:wpautop</a></li>
<li><a href="#orgfc80ca9">3.12.27. shortcode_unautop wp:f:shortcode_unautop</a></li>
<li><a href="#orgcabe15a">3.12.28. show_admin_bar wp:f:show_admin_bar</a></li>
<li><a href="#orgf0fcdf5">3.12.29. wp_get_image_editor</a></li>
<li><a href="#org360348c">3.12.30. wp_reset_postdata wp:f:wp_reset_postdata</a></li>
<li><a href="#org1d644c5">3.12.31. wp_reset_query wp:f:wp_reset_query</a></li>
<li><a href="#org08a03a3">3.12.32. update_post_meta</a></li>
<li><a href="#org476eb11">3.12.33. wp_enqueue_style, wp_style_add_data wp:f:wp_enqueue_style wp:f:wp_style_add_data</a></li>
<li><a href="#orga334c1c">3.12.34. wp_enqueue_script, wp_script_add_data wp:f:wp_enqueue_script</a></li>
<li><a href="#orgad706d7">3.12.35. wp_localize_script</a></li>
</ul>
</li>
<li><a href="#orgf197a8b">3.13. Current URL, and slug wp:current url</a></li>
<li><a href="#orgcb45005">3.14. WP_Post Post Object wp:post</a></li>
<li><a href="#orgcce5aec">3.15. WP_User, user object wp:user</a></li>
<li><a href="#orgf799a92">3.16. WP Custom Fields wp:Custom_Fields</a>
<ul>
<li><a href="#orgb5117fb">3.16.1. Get Custom Fields</a></li>
<li><a href="#org9abfc8e">3.16.2. Custom Fields in WP_Meta_Query</a></li>
<li><a href="#orged1685a">3.16.3. Create Custom Fields for Custom Post Type</a></li>
</ul>
</li>
<li><a href="#org5570f1b">3.17. WP_Query The Loop wp:The_Loop wp:query:main</a>
<ul>
<li><a href="#org353578a">3.17.1. Syntax</a></li>
<li><a href="#orgfad9ec2">3.17.2. WP_Query</a></li>
<li><a href="#orgeac9585">3.17.3. WP_Meta_Query</a>
<ul>
<li><a href="#org7596858">3.17.3.1. Fields for WP_Query</a></li>
<li><a href="#orgf6ffc55">3.17.3.2. Nesting</a></li>
<li><a href="#orgadded40">3.17.3.3. Operators</a></li>
</ul>
</li>
<li><a href="#org8968dff">3.17.4. WP Tax Query</a></li>
<li><a href="#org3d5f801">3.17.5. WP Order and Orderby</a>
<ul>
<li><a href="#orgf96afc6">3.17.5.1. order</a></li>
<li><a href="#org42f79ae">3.17.5.2. orderby</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org4e8a10b">3.18. RSS</a></li>
<li><a href="#org445e891">3.19. Default filters and actions</a></li>
<li><a href="#orgafee97b">3.20. add_filter</a>
<ul>
<li><a href="#orgbae279f">3.20.1. Syntax, remove_filter</a></li>
<li><a href="#org87f3f28">3.20.2. post_limits wp:filter:post_limits</a></li>
<li><a href="#org5054d6a">3.20.3. posts_clauses wp:filter:posts_clauses</a></li>
<li><a href="#org7a35062">3.20.4. page_link</a></li>
<li><a href="#orgf117955">3.20.5. url_to_postid</a></li>
<li><a href="#org40a0e45">3.20.6. pre_option_(option_name)</a></li>
<li><a href="#orgeb63f64">3.20.7. template_include wp:filter:template_include</a></li>
<li><a href="#orga945192">3.20.8. flush_rewrite_rules_hard wp:filter:flush_rewrite_rules_hard</a></li>
<li><a href="#org49aca44">3.20.9. tiny_mce_before_init wp:filter:tiny_mce_before_init</a></li>
<li><a href="#org23fb668">3.20.10. the_content wp:filter:the_content</a></li>
<li><a href="#orgf6b6bee">3.20.11. upload_mimes wp:filter:upload_mimes</a></li>
<li><a href="#orgd6c616a">3.20.12. widget_text wp:filter:widget_text</a></li>
<li><a href="#org13cf7de">3.20.13. sidebars_widgets wp:filter:sidebars_widgets</a></li>
<li><a href="#org14aad39">3.20.14. show_admin_bar wp:filter:show_admin_bar</a></li>
<li><a href="#orge330183">3.20.15. excerpt_more</a></li>
<li><a href="#org48bd914">3.20.16. wp_calculate_image_sizes</a></li>
<li><a href="#orgdbd8ae0">3.20.17. wp_resource_hints</a></li>
<li><a href="#org1f0081f">3.20.18. script_loader_src style_loader_src wp:filter:script_loader_src wp:filter:style_loader_src</a></li>
<li><a href="#org27b6eb1">3.20.19. get_header_image_tag</a></li>
<li><a href="#org75d1dbf">3.20.20. wp_get_attachment_image_attributes</a></li>
<li><a href="#orgb1afbf2">3.20.21. widget_tag_cloud_args</a></li>
<li><a href="#orgd984808">3.20.22. comments_open</a></li>
</ul>
</li>
<li><a href="#org8fda514">3.21. add_action, do_action, do_action_ref_array</a>
<ul>
<li><a href="#orgecff097">3.21.1. Basic</a></li>
<li><a href="#orga90c709">3.21.2. Action Sequence wp:action:loading sequence</a></li>
<li><a href="#orgeda44d5">3.21.3. after_setup_theme</a></li>
<li><a href="#orgf7a3348">3.21.4. init</a></li>
<li><a href="#org1464611">3.21.5. widgets_init wp:action:widgets_init</a></li>
<li><a href="#org6987586">3.21.6. admin_menu</a></li>
<li><a href="#org97fd6c9">3.21.7. admin_init wp:action:admin_init</a></li>
<li><a href="#org28549ab">3.21.8. pre_get_posts wp:action:pre_get_posts</a></li>
<li><a href="#orgd446e00">3.21.9. wp_enqueue_scripts wp:action:wp_enqueue_scripts</a></li>
<li><a href="#org6d8b53e">3.21.10. admin_head</a></li>
<li><a href="#orgcaeeee9">3.21.11. template_redirect wp:action:template_redirect</a></li>
<li><a href="#orge10c2a7">3.21.12. wp_head, wp_footer, get_footer wp:action:wp_head</a></li>
<li><a href="#org369c1a4">3.21.13. add_meta_boxes, add_meta_boxes<sub>post_type</sub></a></li>
<li><a href="#orgc2d19e2">3.21.14. edit_page_form wp:action:edit_page_form</a></li>
<li><a href="#org86f8b2d">3.21.15. edit_form_advanced</a></li>
<li><a href="#org544feed">3.21.16. save_post wp:action:save_post</a></li>
</ul>
</li>
<li><a href="#org7cc92b1">3.22. add_shortcode wp:f:add_shortcode</a></li>
<li><a href="#orgaf37c6c">3.23. Options, Settings WP All Options</a></li>
<li><a href="#org01c037c">3.24. FTP setting wp:ftp</a></li>
<li><a href="#orgd5fc684">3.25. Sanitizing and Escaping User Data</a>
<ul>
<li><a href="#orgee4b554">3.25.1. Ellipsis and trim, strip HTML and PHP tags wp:ellipsis</a></li>
</ul>
</li>
<li><a href="#orgca8541b">3.26. Ajax wp:ajax</a>
<ul>
<li><a href="#orgc8b59a4">3.26.1. Ajax on wp admin pages</a></li>
<li><a href="#orgda51e00">3.26.2. Ajax on wp front end pages</a></li>
</ul>
</li>
<li><a href="#org90e478b">3.27. Theme</a>
<ul>
<li><a href="#orgfa8f2c4">3.27.1. child theme</a></li>
<li><a href="#org1127c9b">3.27.2. functions.php wp:theme:functions</a></li>
<li><a href="#org2ca5f21">3.27.3. Template Files</a></li>
<li><a href="#orgeafc286">3.27.4. Page template</a>
<ul>
<li><a href="#orgd8fc932">3.27.4.1. Global Custom Page Template</a></li>
<li><a href="#org5e1a5ac">3.27.4.2. archive.php</a></li>
</ul>
</li>
<li><a href="#org59524b5">3.27.5. Setup</a></li>
<li><a href="#org675a87a">3.27.6. Include header, footer, sidebar and other, search form</a></li>
<li><a href="#org6ebd40d">3.27.7. Widgets</a>
<ul>
<li><a href="#org4122718">3.27.7.1. Create sidebar</a></li>
</ul>
</li>
<li><a href="#org3de40ba">3.27.8. Functions used in template</a></li>
<li><a href="#org1f65e08">3.27.9. Good themes</a></li>
</ul>
</li>
<li><a href="#orgf908e0c">3.28. Admin Screens</a>
<ul>
<li><a href="#orge40f48e">3.28.1. Admin bar now is called Toolbar wp:admin:toolbar</a></li>
</ul>
</li>
<li><a href="#orgccb970f">3.29. Transient API</a></li>
<li><a href="#org9f7bf8d">3.30. Custom Cache</a></li>
<li><a href="#orgf62ee6e">3.31. Custom page</a></li>
<li><a href="#orgac7061c">3.32. Database</a>
<ul>
<li><a href="#org9fc4e8e">3.32.1. wp_posts</a></li>
<li><a href="#org58ac668">3.32.2. wp_terms, wp_term_relationships</a></li>
</ul>
</li>
<li><a href="#org9ad18d2">3.33. Plugins</a>
<ul>
<li><a href="#org2fa869e">3.33.1. Custom Plugin</a></li>
<li><a href="#orgff4f5e8">3.33.2. polylang wp:plugin:polylang</a>
<ul>
<li><a href="#orgb71e57e">3.33.2.1. String translation is possible</a></li>
<li><a href="#org40e59f2">3.33.2.2. Sitemap and Permalink</a></li>
</ul>
</li>
<li><a href="#org4e50b22">3.33.3. Resize image on the fly</a></li>
<li><a href="#orgf0ae9b9">3.33.4. advanced-custom-fields - ACF wp:plugin:acf</a></li>
<li><a href="#org5b33b7d">3.33.5. types :: Toolset Types wp:plugin:types</a>
<ul>
<li><a href="#org552d487">3.33.5.1. Release</a></li>
</ul>
</li>
<li><a href="#org06b0fb5">3.33.6. BackUpWordPress wp:plugin:backupwordpress</a></li>
<li><a href="#org803fc16">3.33.7. backupbuddy (iThemes) wp:plugin:backupbuddy</a></li>
<li><a href="#org5410e56">3.33.8. WP Migrate DB wp:plugin:wp-migrate-db</a></li>
<li><a href="#org684e643">3.33.9. wordpress-importer</a></li>
<li><a href="#orgf5750de">3.33.10. wp-optimize</a></li>
<li><a href="#org5415430">3.33.11. duplicate-post wp:plugin:duplicate-post</a></li>
<li><a href="#org636a890">3.33.12. Super Cache (SuperCache)</a></li>
<li><a href="#org6bed495">3.33.13. W3 Total Cache wp:plugin:w3-total-cache</a>
<ul>
<li><a href="#org06f9063">3.33.13.1. Manually remove</a></li>
<li><a href="#orga0b0e5a">3.33.13.2. Releases</a></li>
</ul>
</li>
<li><a href="#orga7d46a4">3.33.14. Yoast SEO wordpress-seo wp:plugin:wordpress-seo</a>
<ul>
<li><a href="#org0824245">3.33.14.1. Version</a></li>
<li><a href="#org29310ba">3.33.14.2. Open Graph</a></li>
<li><a href="#org88a379a">3.33.14.3. Turn off json-ld wp:plugin:wordpress-seo:json-ld</a></li>
<li><a href="#orgff70d11">3.33.14.4. Turn off canonical</a></li>
<li><a href="#orgddd4a6d">3.33.14.5. Setting: turn off Author Archives</a></li>
<li><a href="#org4ca55d6">3.33.14.6. Release</a></li>
</ul>
</li>
<li><a href="#orgc50ecfb">3.33.15. all-in-one-seo-pack wp:plugin:all-in-one-seo-pack</a>
<ul>
<li><a href="#orgee9cc24">3.33.15.1. Release</a></li>
</ul>
</li>
<li><a href="#org83362fa">3.33.16. jetpack</a></li>
<li><a href="#org5238064">3.33.17. Disqus</a></li>
<li><a href="#org826a04b">3.33.18. captcha (dead)</a></li>
<li><a href="#orge558f27">3.33.19. disable-comments wp:plugin:disable-comments</a></li>
<li><a href="#org79d74c0">3.33.20. disable-embeds wp:plugin:disable-embeds</a></li>
<li><a href="#org47c064a">3.33.21. all-in-one-event-calendar</a></li>
<li><a href="#orgbbdaf34">3.33.22. contact-form-7</a>
<ul>
<li><a href="#org51665bf">3.33.22.1. Shortcode</a></li>
<li><a href="#org5d278e1">3.33.22.2. autop wp:p:contact-form-7:autop</a></li>
<li><a href="#orga2893b8">3.33.22.3. hooks - reCaptcha</a></li>
<li><a href="#org7d7f3dc">3.33.22.4. DOM Events</a></li>
<li><a href="#org3a5cb42">3.33.22.5. Form tags, akismet</a></li>
<li><a href="#org395f353">3.33.22.6. multifile-upload-field-for-contact-form-7</a></li>
<li><a href="#org2dfa0d6">3.33.22.7. contact-form-7-confirm-email-feild</a></li>
<li><a href="#org79f784b">3.33.22.8. flamingo</a></li>
<li><a href="#org10df3cb">3.33.22.9. contact-form-plugin</a></li>
<li><a href="#orga202090">3.33.22.10. Release</a></li>
</ul>
</li>
<li><a href="#org5387048">3.33.23. constant-contact-forms</a>
<ul>
<li><a href="#orga93bbd7">3.33.23.1. Setting</a></li>
<li><a href="#org86f8852">3.33.23.2. wp filters</a></li>
<li><a href="#org04090c0">3.33.23.3. Caveats</a></li>
</ul>
</li>
<li><a href="#orgffa9b87">3.33.24. constant-contact-forms-by-mailmunch</a></li>
<li><a href="#org40920a0">3.33.25. custom-search-plugin</a></li>
<li><a href="#org6af1593">3.33.26. custom-permalinks</a></li>
<li><a href="#org40631b8">3.33.27. redirection</a></li>
<li><a href="#org7bb9802">3.33.28. hc-custom-wp-admin-url</a></li>
<li><a href="#org1956dcc">3.33.29. better-wp-security (iThemes Security)</a>
<ul>
<li><a href="#org8b9c6f8">3.33.29.1. Release</a></li>
</ul>
</li>
<li><a href="#orga492a74">3.33.30. Exploit scanner exploit-scanner wp:plugin:exploit-scanner</a></li>
<li><a href="#org5d2f503">3.33.31. tinymce-advanced</a></li>
<li><a href="#orge445050">3.33.32. black-studio-tinymce-widget</a></li>
<li><a href="#orgc8c8e6f">3.33.33. menu-image</a></li>
<li><a href="#orgbaeac60">3.33.34. multiple-featured-images wp:plugin:multiple-featured-images</a></li>
<li><a href="#org9c4c5cb">3.33.35. responsive-lightbox</a></li>
<li><a href="#org5541182">3.33.36. revslider (not in WP directory)</a></li>
<li><a href="#org31f733b">3.33.37. wpfront-scroll-top</a></li>
<li><a href="#org1a4dcee">3.33.38. vertical-marquee-plugin</a></li>
<li><a href="#org504d779">3.33.39. vertical-scroll-recent-post</a></li>
<li><a href="#org71b7f50">3.33.40. recent-posts-widget-extended</a></li>
<li><a href="#org1d66daa">3.33.41. widget-logic</a></li>
<li><a href="#org952e498">3.33.42. widget-css-classes</a></li>
<li><a href="#org925680f">3.33.43. breadcrumb-navxt</a>
<ul>
<li><a href="#orga568bba">3.33.43.1. Release</a></li>
</ul>
</li>
<li><a href="#org93f3901">3.33.44. sendgrid-email-delivery-simplified</a></li>
<li><a href="#org00f639e">3.33.45. woocommerce</a>
<ul>
<li><a href="#org4449997">3.33.45.1. Basics</a></li>
<li><a href="#org6e36ae9">3.33.45.2. Payment Gateways</a></li>
<li><a href="#org588be74">3.33.45.3. hooks</a></li>
<li><a href="#org1babed6">3.33.45.4. Product</a></li>
<li><a href="#org68af226">3.33.45.5. Template Structure</a></li>
<li><a href="#orgd32f981">3.33.45.6. Test Credit Cards</a></li>
<li><a href="#orgac815d1">3.33.45.7. extension: Subscription</a></li>
<li><a href="#org2f30ef5">3.33.45.8. extension: Name Your Price</a></li>
<li><a href="#org3f6d98a">3.33.45.9. extension: WooCommerce Sequential Order Numbers Pro</a></li>
</ul>
</li>
<li><a href="#org4e54175">3.33.46. woo-order-export-lite</a></li>
<li><a href="#org9572732">3.33.47. woocommerce-pdf-invoices-packing-slips</a>
<ul>
<li><a href="#orgc905a29">3.33.47.1. Template hooks</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org3d6ca2e">3.34. Debug, WP_Error</a></li>
<li><a href="#org0a0270f">3.35. Installation Language</a></li>
<li><a href="#org664169f">3.36. File Permissions wp:file permissions</a></li>
<li><a href="#org2eb95c9">3.37. SSL</a></li>
<li><a href="#org28201d4">3.38. REST API</a></li>
<li><a href="#orgd3bfb29">3.39. Life Cycle</a></li>
<li><a href="#org0ea0741">3.40. PHP 7</a></li>
<li><a href="#orgc0dd9d3">3.41. UC: Simple HTML page with form submit</a>
<ul>
<li><a href="#org3df367f">3.41.1. /abc/index.html</a></li>
<li><a href="#org2077b3b">3.41.2. /abc/lb/js/app.js</a></li>
<li><a href="#org513dabe">3.41.3. /wp-content/themes/li-cdm-lp/lb/api-localbusiness/cf-form-post.php</a></li>
<li><a href="#org8422815">3.41.4. /wp-content/themes/li-cdm-lp/lb/api-localbusiness/form-clean.php</a></li>
</ul>
</li>
<li><a href="#org8f378d1">3.42. TS: Hacked wp:ts:hacked</a>
<ul>
<li><a href="#org9aeed62">3.42.1. Search backdoor scripts</a></li>
<li><a href="#org7edcdd8">3.42.2. Don't execute PHP in wp-content/uploads folder</a></li>
</ul>
</li>
<li><a href="#org163bf4f">3.43. TS: wp_deregister_script was called incorrectly</a></li>
<li><a href="#org4915d4f">3.44. TS: Check list</a></li>
</ul>
</li>
<li><a href="#org4a07eca">4. ColdFusion</a>
<ul>
<li><a href="#org28bca1d">4.1. cfsetting</a></li>
<li><a href="#org53b8d8f">4.2. Text</a></li>
<li><a href="#org194138a">4.3. Mail</a></li>
<li><a href="#org1640234">4.4. Function</a></li>
<li><a href="#org0a815b3">4.5. Query</a>
<ul>
<li><a href="#org4619d54">4.5.1. Get Identity After Insert</a></li>
<li><a href="#org9da20c2">4.5.2. Insert Null</a></li>
</ul>
</li>
<li><a href="#org1e507a4">4.6. Fast form to Database</a></li>
<li><a href="#orgf7b33e8">4.7. Loop</a></li>
<li><a href="#orgd28cc7d">4.8. Remote Address</a></li>
<li><a href="#orgb96f85c">4.9. cftry</a></li>
<li><a href="#orgd3d61b6">4.10. cfdump</a></li>
<li><a href="#orga03e379">4.11. Javascript</a></li>
</ul>
</li>
<li><a href="#org1151a52">5. CSS</a>
<ul>
<li><a href="#orga98438a">5.1. Position, box-sizing</a></li>
<li><a href="#org31b4592">5.2. Horizontal Center Absolute</a></li>
<li><a href="#org8b24a49">5.3. Transform, Transition</a>
<ul>
<li><a href="#org478ff52">5.3.1. Transition</a></li>
<li><a href="#orgb8cdd4a">5.3.2. Transform css:transform</a></li>
</ul>
</li>
<li><a href="#org397003a">5.4. Link</a></li>
<li><a href="#orge243238">5.5. Text</a>
<ul>
<li><a href="#org9e34c22">5.5.1. Ellipsis</a></li>
<li><a href="#orgc210116">5.5.2. Long Word</a></li>
<li><a href="#org0e781b1">5.5.3. Font size, line-height, letter-spacing</a></li>
<li><a href="#org16e170d">5.5.4. Prevent sup and sub affecting line height css:sup:line-height</a></li>
<li><a href="#orga69745c">5.5.5. Fluid Typography</a></li>
</ul>
</li>
<li><a href="#orgdf32d39">5.6. CSS Selectors CSS Selectors</a></li>
<li><a href="#orgb19f3c5">5.7. Specificity</a></li>
<li><a href="#org45d2a67">5.8. Functions</a>
<ul>
<li><a href="#orge92ccd9">5.8.1. attr(data-attr-1)</a></li>
<li><a href="#orgdc8b0e6">5.8.2. calc()</a></li>
<li><a href="#org9429a8f">5.8.3. counter</a></li>
</ul>
</li>
<li><a href="#org49367b3">5.9. border-image</a></li>
<li><a href="#org8457c76">5.10. background css:background</a>
<ul>
<li><a href="#org2b3106a">5.10.1. background-position</a></li>
<li><a href="#orgea29089">5.10.2. background-size</a></li>
<li><a href="#org1f1c878">5.10.3. background-clip, background-origin</a></li>
<li><a href="#org6538e55">5.10.4. background-attachment</a></li>
<li><a href="#org72f6a56">5.10.5. Add dark layer on a background image</a></li>
<li><a href="#org1e04109">5.10.6. Mobile background-attachment:fixed background-size:cover</a></li>
</ul>
</li>
<li><a href="#orga54c8a5">5.11. List style</a></li>
<li><a href="#orgdc82628">5.12. Color</a>
<ul>
<li><a href="#org6aa8e6e">5.12.1. CSS inherit color</a></li>
<li><a href="#orge7f6a14">5.12.2. rgb(), rgba() CSS rgba</a></li>
<li><a href="#orgdb3c773">5.12.3. hsl(), hsla()</a></li>
</ul>
</li>
<li><a href="#org4f9af99">5.13. Gradient CSS gradient</a></li>
<li><a href="#org508e7cc">5.14. opacity</a></li>
<li><a href="#orgc648075">5.15. Shadow</a></li>
<li><a href="#orgdac7f43">5.16. object-fit</a></li>
<li><a href="#org0489282">5.17. @font-face css:font-face</a>
<ul>
<li><a href="#orgf63eca6">5.17.1. font-display</a></li>
<li><a href="#org6b788af">5.17.2. Font Loading API</a></li>
<li><a href="#org20deccf">5.17.3. Bootstrap 3</a></li>
<li><a href="#org9cde1a1">5.17.4. Google Font :: local() unicode-range</a></li>
<li><a href="#org5cc6560">5.17.5. Web Safe Fonts css:font-face:web safe fonts</a></li>
</ul>
</li>
<li><a href="#org767ab60">5.18. CSS target IE 11 and IE10</a></li>
<li><a href="#orgae9d35d">5.19. @media</a>
<ul>
<li><a href="#org9e090ed">5.19.1. Syntax</a></li>
<li><a href="#orgac13263">5.19.2. Testing</a></li>
<li><a href="#org0cfcd11">5.19.3. Media Types css:@media:type</a></li>
<li><a href="#org2b475c4">5.19.4. meta viewport</a></li>
<li><a href="#orgc24560c">5.19.5. Features css:@media:features</a></li>
<li><a href="#orge5cf51c">5.19.6. Responsive Design</a>
<ul>
<li><a href="#org78b2c67">5.19.6.1. Mostly Fluid</a></li>
<li><a href="#orge9f95db">5.19.6.2. Column Drop</a></li>
<li><a href="#org9bd50cc">5.19.6.3. Layout shifter</a></li>
<li><a href="#org74ce28e">5.19.6.4. Off canvas</a></li>
</ul>
</li>
<li><a href="#org24c3228">5.19.7. Viewport sizes of device</a></li>
</ul>
</li>
<li><a href="#org18e7a81">5.20. @keyframes css:animation</a></li>
<li><a href="#org6ed610f">5.21. @import</a></li>
<li><a href="#org533db11">5.22. @viewport</a></li>
<li><a href="#org9a2894a">5.23. @supports</a></li>
<li><a href="#org039f485">5.24. Flexbox css:flex</a>
<ul>
<li><a href="#orgd2d0574">5.24.1. Basics</a></li>
<li><a href="#org6c12164">5.24.2. Insert a line break in flex items. Might not be easy..</a></li>
<li><a href="#org7f1867b">5.24.3. flex-grow:1</a></li>
<li><a href="#org30ebd1f">5.24.4. Examples</a></li>
</ul>
</li>
<li><a href="#org0f37bd4">5.25. Equal width for unknown number of child elements</a></li>
<li><a href="#org5ed73d1">5.26. Grid</a>
<ul>
<li><a href="#org9d3c290">5.26.1. container: display, grid-template-columns, grid-template-rows</a></li>
<li><a href="#org0219b19">5.26.2. container: grid-template-areas, items: grid-area</a></li>
<li><a href="#org795cf4c">5.26.3. container: grid-template</a></li>
<li><a href="#org8e3f58a">5.26.4. container: grid-column-gap, grid-row-gap, grid-gap css:grid-gap</a></li>
<li><a href="#orgf7cb9b4">5.26.5. container: justify-items, items: justify-self css:justify-items</a></li>
<li><a href="#org33ff107">5.26.6. container: align-items, items: align-self css:align-items</a></li>
<li><a href="#orge1d8653">5.26.7. container: justify-content</a></li>
<li><a href="#org608b540">5.26.8. container: align-content</a></li>
<li><a href="#org680b46a">5.26.9. container: grid-auto-columns, grid-auto-rows css:grid-auto-columns css:grid-auto-rows</a></li>
<li><a href="#orge33bd61">5.26.10. container: grid-auto-flow css:grid-auto-flow</a></li>
<li><a href="#org568ed3c">5.26.11. container: grid</a></li>
<li><a href="#org7ec7874">5.26.12. item: grid-column-start, grid-column-end, grid-row-start, grid-row-end</a></li>
<li><a href="#orgd914a91">5.26.13. items: grid-column, grid-row</a></li>
<li><a href="#orgdffcddb">5.26.14. items: grid-area</a></li>
<li><a href="#org35d828f">5.26.15. item: justify-self, align-self</a></li>
<li><a href="#orgb7a78bf">5.26.16. IE10, IE11</a></li>
</ul>
</li>
<li><a href="#org08ec0e0">5.27. Horizontal and Vertical Center</a></li>
<li><a href="#orgaded674">5.28. Column for text</a></li>
<li><a href="#org806217f">5.29. Shape</a></li>
<li><a href="#orgac623df">5.30. SVG</a>
<ul>
<li><a href="#orgbd03d45">5.30.1. Make SVG, Optimize SVG, IE 11</a></li>
<li><a href="#orgd4ccd86">5.30.2. SVG as background image IE 11 svg:ie11</a></li>
<li><a href="#org4250655">5.30.3. SVG as background image dynamic size</a></li>
<li><a href="#orgf0cd3c5">5.30.4. CSS in SVG</a></li>
<li><a href="#org897a03f">5.30.5. SVG Zoom and Pan</a></li>
<li><a href="#orgf7c971f">5.30.6. SVG Sprite</a></li>
</ul>
</li>
<li><a href="#org26c2b76">5.31. Use Cases</a>
<ul>
<li><a href="#orge88c36f">5.31.1. iOS Hover</a></li>
<li><a href="#org5e91bb0">5.31.2. Fix parent height less than total children height</a></li>
<li><a href="#org5de768e">5.31.3. Image inside a div</a></li>
<li><a href="#orgb8f9194">5.31.4. Transparent Image</a></li>
<li><a href="#org345733b">5.31.5. Image scaling</a></li>
<li><a href="#org70be3cc">5.31.6. Button Hover Double Quotes</a></li>
<li><a href="#org3f4f39d">5.31.7. Text Label</a></li>
<li><a href="#orgf40e0bb">5.31.8. Button with icon on the left</a></li>
<li><a href="#org7944460">5.31.9. Vertical Line Separator in &lt;li&gt;</a></li>
<li><a href="#orgebd5771">5.31.10. Wrap h1 around a div on the right, float right sequence</a></li>
<li><a href="#orgfa2ceb9">5.31.11. 100% width and with margin</a></li>
<li><a href="#orgcfdae02">5.31.12. Align text with elements</a></li>
<li><a href="#orgca39db3">5.31.13. Circle Number List</a></li>
<li><a href="#orgbf1d1a8">5.31.14. superscript, subscript uneven line height</a></li>
<li><a href="#org3859872">5.31.15. Swap image in @media</a></li>
<li><a href="#orgc5a679e">5.31.16. Hightlight element when the hash and id of element match</a></li>
<li><a href="#orgf6ebfd0">5.31.17. Go to anchor element with position:fixed header</a></li>
<li><a href="#org265d37d">5.31.18. Center position:absolute</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orga1f25f0">6. Bootstrap</a>
<ul>
<li><a href="#org8a5481b">6.1. Mobile Meta Setup</a></li>
<li><a href="#org54ec155">6.2. Global</a></li>
<li><a href="#orgb5a4fca">6.3. Content</a>
<ul>
<li><a href="#org16aac45">6.3.1. Native font stack</a></li>
<li><a href="#orgf894d9e">6.3.2. h1, h2 heading elements</a></li>
<li><a href="#org0b9a1cf">6.3.3. &lt;p&gt;</a></li>
<li><a href="#org5d7d2d8">6.3.4. Lists &lt;ul&gt; &lt;ol&gt; &lt;dl&gt;</a></li>
<li><a href="#org3700fb8">6.3.5. Horinzontal Center (text, truncate, block)</a></li>
<li><a href="#org5425a0e">6.3.6. Special Text</a></li>
<li><a href="#orgf4a49cc">6.3.7. Vertical Align</a></li>
<li><a href="#orge5e8490">6.3.8. Table</a></li>
<li><a href="#orgf8129bd">6.3.9. Image</a></li>
<li><a href="#orgbd1bdb1">6.3.10. Colors</a></li>
<li><a href="#org9fe2e88">6.3.11. Quick float content .pull-left, .pull-right</a></li>
</ul>
</li>
<li><a href="#orgc4ab822">6.4. Layout</a>
<ul>
<li><a href="#orgb15b62b">6.4.1. Grid</a></li>
<li><a href="#org64f24e4">6.4.2. Responsive Utility</a></li>
<li><a href="#org7bee775">6.4.3. Media Object</a></li>
</ul>
</li>
<li><a href="#org88ece7d">6.5. Utilities</a>
<ul>
<li><a href="#org95bcd9b">6.5.1. Spacing Utility (Boostrap 4)</a></li>
<li><a href="#org355a64a">6.5.2. Responsive Utility</a></li>
<li><a href="#org1d93231">6.5.3. Responsive helpers (embed and float) bootstrap:responsive helpers</a></li>
<li><a href="#org0320764">6.5.4. Border (BS4)</a></li>
<li><a href="#orgbf2721f">6.5.5. Text</a></li>
</ul>
</li>
<li><a href="#org2f2c463">6.6. Components</a>
<ul>
<li><a href="#org1a9ad38">6.6.1. Alert</a></li>
<li><a href="#org199937d">6.6.2. Jumbotron</a></li>
<li><a href="#orgf220d68">6.6.3. Tag (BS4) Label (BS3)</a></li>
<li><a href="#org4651eee">6.6.4. Progress</a></li>
<li><a href="#org57bdae9">6.6.5. Button, Button Group bs:button</a></li>
<li><a href="#org89397af">6.6.6. Form</a>
<ul>
<li><a href="#org7555957">6.6.6.1. .form-control</a></li>
<li><a href="#orgfeb5a6c">6.6.6.2. Help Text (after &lt;input&gt;)</a></li>
<li><a href="#org66a953a">6.6.6.3. .form-inline</a></li>
<li><a href="#org3a394b6">6.6.6.4. Checkbox and Radio</a></li>
<li><a href="#org2a3b6dc">6.6.6.5. .input-group bs:form:input-group</a></li>
<li><a href="#orgac2bd87">6.6.6.6. Align fields in columns</a></li>
<li><a href="#org5777a15">6.6.6.7. Validation and Feedback</a></li>
</ul>
</li>
<li><a href="#orgd86f920">6.6.7. Thumbnail (BS3)</a></li>
<li><a href="#orgc843f8e">6.6.8. List group bs:list group</a></li>
<li><a href="#orgcfca95f">6.6.9. Panel (BS3 only) bs:panel</a></li>
<li><a href="#org61871e6">6.6.10. Card, Card Group, Card Deck (BS4) bs:card</a></li>
<li><a href="#org2defce5">6.6.11. Dropdown (js)</a></li>
<li><a href="#org14265cf">6.6.12. Navigation (js), tab (js)</a>
<ul>
<li><a href="#org28ca06b">6.6.12.1. .nav, .nav-tabs, .nav-pills, tablist (js)</a></li>
<li><a href="#orgc5f38f9">6.6.12.2. Navbar (js)</a></li>
<li><a href="#orgcc20e96">6.6.12.3. Breadcrumb</a></li>
<li><a href="#orgd6ae1c3">6.6.12.4. Pagination and pager</a></li>
</ul>
</li>
<li><a href="#orgce6c11f">6.6.13. Carousel (js)</a></li>
<li><a href="#orgf5236be">6.6.14. Modal (js)</a></li>
<li><a href="#org108880e">6.6.15. Collapse (js)</a></li>
<li><a href="#org0b43ec4">6.6.16. Tooltip (js)</a></li>
<li><a href="#org7910879">6.6.17. Popover (js)</a></li>
<li><a href="#orgd42dc50">6.6.18. Scrollspy (js)</a></li>
</ul>
</li>
<li><a href="#org0de3eab">6.7. Mockup Tools</a></li>
<li><a href="#orged31273">6.8. v4</a>
<ul>
<li><a href="#org570da15">6.8.1. Display utilities .d-* .display-*</a></li>
<li><a href="#org895bdf5">6.8.2. p.lead</a></li>
<li><a href="#org08fabd4">6.8.3. Spacing</a></li>
<li><a href="#orgecdc84a">6.8.4. flex</a>
<ul>
<li><a href="#org6e78ad7">6.8.4.1. Use case</a></li>
<li><a href="#org9b0bc5a">6.8.4.2. display</a></li>
<li><a href="#orgcf5c5d6">6.8.4.3. flex-row</a></li>
<li><a href="#orgb2de683">6.8.4.4. flex-wrap</a></li>
<li><a href="#orgdccad40">6.8.4.5. justify-content</a></li>
<li><a href="#orgc43c5f6">6.8.4.6. align-items</a></li>
<li><a href="#org83ff015">6.8.4.7. auto margin</a></li>
<li><a href="#org2b2c67f">6.8.4.8. iOS 8 and lower</a></li>
</ul>
</li>
<li><a href="#orgd87d80d">6.8.5. color</a></li>
<li><a href="#org84ac53a">6.8.6. text</a></li>
<li><a href="#org4353545">6.8.7. Popover</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgd34859c">7. HTML</a>
<ul>
<li><a href="#org2931b40">7.1. DOM</a>
<ul>
<li><a href="#org9673069">7.1.1. Document Object</a></li>
<li><a href="#orge16faea">7.1.2. NodeList Object NodeList</a></li>
<li><a href="#org2b0c0b4">7.1.3. Element Object</a></li>
<li><a href="#org13ba2da">7.1.4. Event Object</a>
<ul>
<li><a href="#org804ad01">7.1.4.1. MouseEvent Object</a></li>
<li><a href="#org7d92c38">7.1.4.2. KeyboardEvent Object</a></li>
<li><a href="#org6dccf1f">7.1.4.3. HashChangeEvent Object</a></li>
<li><a href="#org65b0abc">7.1.4.4. PageTransitionEvent</a></li>
<li><a href="#org273e561">7.1.4.5. FocusEvent Object</a></li>
<li><a href="#orgef86ce5">7.1.4.6. AnimationEvent Object</a></li>
<li><a href="#org7833bec">7.1.4.7. HTML DOM Event</a></li>
</ul>
</li>
<li><a href="#org7ec8bdb">7.1.5. DOMTokenList Object</a></li>
<li><a href="#orgeb11946">7.1.6. NamedNodeMap Object</a></li>
<li><a href="#org71fc2c8">7.1.7. Attr Object</a></li>
<li><a href="#org3fae74b">7.1.8. PointerEvent</a></li>
</ul>
</li>
<li><a href="#org222ef74">7.2. Global Attributes</a></li>
<li><a href="#orgf6ae3d2">7.3. Event Attributes</a>
<ul>
<li><a href="#orgf7cee32">7.3.1. Windows Event in body tag</a></li>
<li><a href="#org07e230b">7.3.2. Form Event Attributes</a></li>
<li><a href="#org7e554d3">7.3.3. Mouse Events, Clipboard Events, Keyboard Events</a></li>
<li><a href="#orge4a8118">7.3.4. Media Events</a></li>
<li><a href="#orgbe7fb4a">7.3.5. Animation Events</a></li>
<li><a href="#orga777701">7.3.6. Transition Event</a></li>
<li><a href="#org13c4bc9">7.3.7. Misc events</a></li>
</ul>
</li>
<li><a href="#orgcc9a046">7.4. Canvas</a></li>
<li><a href="#org649f07b">7.5. Tags, HTML5 Elements</a>
<ul>
<li><a href="#orgce028d6">7.5.1. HTML Tags</a></li>
<li><a href="#org0a49548">7.5.2. &lt;picture&gt;, &lt;img srcset sizes&gt;</a>
<ul>
<li><a href="#orgc8c4d59">7.5.2.1. html:img:srcset html:img:sizes</a></li>
<li><a href="#org6a0c465">7.5.2.2. html:picture</a></li>
<li><a href="#org2dc1de6">7.5.2.3. srcset and sizes calculation</a></li>
</ul>
</li>
<li><a href="#org4a04059">7.5.3. Term/name in a list</a></li>
<li><a href="#orge8d9563">7.5.4. video html:video</a>
<ul>
<li><a href="#orgf4ea73f">7.5.4.1. Attribute preload</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org3b84a8c">7.6. Meta</a>
<ul>
<li><a href="#orga7120c9">7.6.1. Meta Refresh (redirect)</a></li>
<li><a href="#org059791d">7.6.2. Open Graph Protocol html:og</a></li>
<li><a href="#org03acf7f">7.6.3. Twitter Cards</a></li>
<li><a href="#orgeef71cf">7.6.4. Address Bar html:address bar</a></li>
</ul>
</li>
<li><a href="#orgdbb9fc2">7.7. Header</a>
<ul>
<li><a href="#org5cd904c">7.7.1. Age</a></li>
<li><a href="#orgf6096fd">7.7.2. Cache-Control, Pragma header:cache-control</a></li>
<li><a href="#org8433bc1">7.7.3. Expires header:expires</a></li>
<li><a href="#orgf32f233">7.7.4. Content-Security-Policy (CSP) - response header:content-security-policy</a></li>
<li><a href="#org8cb7506">7.7.5. X-Frame-Options</a></li>
<li><a href="#org4191386">7.7.6. X-Content-Type-Options - response</a></li>
<li><a href="#orgf00f5f7">7.7.7. X-XSS-Protection - response</a></li>
<li><a href="#orgc9574ce">7.7.8. Referer :: request header:referer</a></li>
<li><a href="#orgdbf58e7">7.7.9. Referrer-Policy - response header:referrer-policy</a></li>
<li><a href="#org7aaf9cd">7.7.10. Strict-Transport-Security - response header:strict-transport-security</a></li>
<li><a href="#org2e319c1">7.7.11. Vary - response header:vary</a></li>
<li><a href="#orga7458ef">7.7.12. Link html:link</a>
<ul>
<li><a href="#orgc326bae">7.7.12.1. html:hreflang</a></li>
</ul>
</li>
<li><a href="#orgbab4bf3">7.7.13. Accept-CH - response header:accept-ch</a></li>
<li><a href="#org6e71f2e">7.7.14. X-Powered-By</a></li>
</ul>
</li>
<li><a href="#org5f8648c">7.8. Cookie html:cookie</a></li>
<li><a href="#orgc9ae512">7.9. Email</a>
<ul>
<li><a href="#org94b4be7">7.9.1. View email source on Outlook</a></li>
<li><a href="#org4d95e0e">7.9.2. Doctype</a></li>
<li><a href="#org23ab4a6">7.9.3. Guidelines</a></li>
<li><a href="#orgf30ed0f">7.9.4. Responsive</a></li>
<li><a href="#org79cf3dd">7.9.5. Even 3 columns</a></li>
<li><a href="#orgb238bc7">7.9.6. My even 2 columns</a></li>
<li><a href="#org0a55c37">7.9.7. My template</a></li>
<li><a href="#org8fa21d4">7.9.8. Hybrid Responsive Design</a></li>
<li><a href="#org3086008">7.9.9. Inbox Preview</a></li>
<li><a href="#orge956c2b">7.9.10. Gmail Image Caching</a></li>
<li><a href="#orgded2fc8">7.9.11. CSS and HTML Support across Devices email:css:support</a></li>
<li><a href="#org059c952">7.9.12. MJML</a>
<ul>
<li><a href="#org3a8c8cc">7.9.12.1. Install &amp; Basics</a></li>
<li><a href="#org8a99ba9">7.9.12.2. mjml mjml:tag:mjml</a></li>
<li><a href="#orgce5002d">7.9.12.3. mj-head mjml:tag:mj-head</a></li>
<li><a href="#org2fbd23d">7.9.12.4. mj-head &gt; mj-preview mjml:tag:mj-preview</a></li>
<li><a href="#org53d0bf2">7.9.12.5. mj-head &gt; mj-attributes mjml:tag:mj-attributes</a></li>
<li><a href="#orgb42baef">7.9.12.6. mj-head &gt; mj-breakpoint</a></li>
<li><a href="#org14cfeb7">7.9.12.7. mj-head &gt; mj-style mjml:tag:mj-style</a></li>
<li><a href="#orgad94794">7.9.12.8. mj-head &gt; mj-font mjml:tag:mj-font</a></li>
<li><a href="#org0606867">7.9.12.9. mj-head &gt; mj-title mjml:tag:mj-title</a></li>
<li><a href="#org60c5cfa">7.9.12.10. mj-head &gt; mj-body &gt; mj-section (mj-container)</a></li>
<li><a href="#org466b63e">7.9.12.11. mj-body &gt; mj-include mjml:tag:mj-include</a></li>
<li><a href="#org734798f">7.9.12.12. mj-body &gt; mj-section mjml:tag:mj-section</a></li>
<li><a href="#org0990955">7.9.12.13. mj-wrapper &gt; mj-section mjml:tag:mj-wrapper</a></li>
<li><a href="#org9a3841b">7.9.12.14. mj-container &gt; mj-hero mjml:tag:mj-hero</a></li>
<li><a href="#org8a09ef3">7.9.12.15. mj-section &gt; mj-column mjml:tag:mj-column</a></li>
<li><a href="#org740162d">7.9.12.16. mj-elements inside mj-column</a></li>
<li><a href="#org9cb16df">7.9.12.17. mj-group to group columns</a></li>
<li><a href="#org31f2b70">7.9.12.18. Background Image</a></li>
<li><a href="#orgb60f84c">7.9.12.19. Hide for mobile</a></li>
<li><a href="#orge5bb0c8">7.9.12.20. Change default padding</a></li>
<li><a href="#orgb8a166b">7.9.12.21. Caveats</a></li>
</ul>
</li>
<li><a href="#org8927271">7.9.13. Non breaking</a></li>
<li><a href="#org6ac70e1">7.9.14. Don't use anchor link!</a></li>
</ul>
</li>
<li><a href="#org28e4846">7.10. Phone number</a></li>
<li><a href="#orgb9ee2b0">7.11. link html:link</a>
<ul>
<li><a href="#org5f5f7b9">7.11.1. rel="preload" html:link:rel:preload</a></li>
<li><a href="#org091bb85">7.11.2. rel="prefetch"</a></li>
<li><a href="#orgda31106">7.11.3. rel="canonical"</a></li>
<li><a href="#org3aaf91e">7.11.4. rel="dns-prefetch"</a></li>
<li><a href="#org379d74d">7.11.5. rel="manifest.json" html:link:rel:manifest</a></li>
<li><a href="#org71fb985">7.11.6. Stylesheet for a media</a></li>
<li><a href="#orgb4e73fc">7.11.7. rel="icon" rel="apple-touch-startup-image" rel="apple-touch-icon"</a></li>
</ul>
</li>
<li><a href="#orgfdcbe39">7.12. Autofill, Input Types</a>
<ul>
<li><a href="#orgd318977">7.12.1. Input Types</a></li>
</ul>
</li>
<li><a href="#org87aae35">7.13. Special Characters</a></li>
<li><a href="#org58a1e28">7.14. Geolocation</a>
<ul>
<li><a href="#orgdd944fa">7.14.1. .getCurrentPosition</a></li>
<li><a href="#org2fb69e3">7.14.2. watchPosition</a></li>
</ul>
</li>
<li><a href="#org66f211c">7.15. Storage</a></li>
<li><a href="#org521b4da">7.16. Application Cache</a></li>
<li><a href="#orga604811">7.17. Language lang="en"</a></li>
<li><a href="#orga65d086">7.18. ARIA</a>
<ul>
<li><a href="#orgebcb1a0">7.18.1. role attribute</a></li>
<li><a href="#org307bf84">7.18.2. aria-* attributes</a></li>
</ul>
</li>
<li><a href="#org7aa38c8">7.19. Display price</a></li>
<li><a href="#org7ef6664">7.20. Progressive Web App</a></li>
<li><a href="#org99b5caa">7.21. AMP</a>
<ul>
<li><a href="#org9ed59a4">7.21.1. Search Engine Discovery</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orge23112b">8. JavaScript</a>
<ul>
<li><a href="#orgac8ef03">8.1. Loading Sequence js:defer js:async</a></li>
<li><a href="#org11a01ce">8.2. External Script, document.write js:external script</a></li>
<li><a href="#orgc9c62be">8.3. Initialization</a></li>
<li><a href="#org5f5ae68">8.4. Variable Scope</a>
<ul>
<li><a href="#org590772b">8.4.1. Hoisting</a></li>
<li><a href="#org03ec287">8.4.2. let, const, var</a></li>
</ul>
</li>
<li><a href="#orge75864b">8.5. Closure, Javascript Singleton</a>
<ul>
<li><a href="#org6af9f90">8.5.1. Syntax, When to use closure?</a></li>
<li><a href="#org0a651a5">8.5.2. Singleton Javascript Singleton</a></li>
<li><a href="#org5c512e0">8.5.3. Regression</a></li>
</ul>
</li>
<li><a href="#org8bc08ad">8.6. Types, typeof, constructor</a>
<ul>
<li><a href="#org327e11a">8.6.1. All types, typeof, constructor</a></li>
<li><a href="#orgea2fc05">8.6.2. Number js:Number</a></li>
<li><a href="#orgf6f30cf">8.6.3. String js:String</a></li>
<li><a href="#org0bd3a0e">8.6.4. Array</a>
<ul>
<li><a href="#org23458fa">8.6.4.1. Basics</a></li>
<li><a href="#org69a1048">8.6.4.2. If variable is array</a></li>
<li><a href="#org2132946">8.6.4.3. array.pop(), array.shift(), array.push(), array.unshift()</a></li>
<li><a href="#org6a3a758">8.6.4.4. array.concat()</a></li>
<li><a href="#org50bce48">8.6.4.5. array.slice()</a></li>
<li><a href="#orga8191da">8.6.4.6. array.splice(), remove a value from array if exists</a></li>
<li><a href="#org565ac12">8.6.4.7. array.join(), array.toString(), array.valueOf()</a></li>
<li><a href="#orgd507f97">8.6.4.8. array.sort(), array.reverse()</a></li>
<li><a href="#org880f720">8.6.4.9. array loop: for, array.forEach()</a></li>
<li><a href="#org457b332">8.6.4.10. array.map(), array.filter()</a></li>
<li><a href="#org117364c">8.6.4.11. array.every(), array.some()</a></li>
<li><a href="#org1392259">8.6.4.12. array.reduce()</a></li>
</ul>
</li>
<li><a href="#org3088074">8.6.5. Date js:Date</a></li>
<li><a href="#org52ed56f">8.6.6. Math js:Math</a></li>
<li><a href="#org8a11d8a">8.6.7. RegExp</a>
<ul>
<li><a href="#org5b43225">8.6.7.1. search(), replace(), match()</a></li>
<li><a href="#org18617cf">8.6.7.2. RegExp</a></li>
</ul>
</li>
<li><a href="#orge73f13a">8.6.8. Function</a>
<ul>
<li><a href="#org0a3d660">8.6.8.1. arguments</a></li>
<li><a href="#org5b14f56">8.6.8.2. .apply(), .call()</a></li>
</ul>
</li>
<li><a href="#org698f346">8.6.9. Error js:Error</a></li>
<li><a href="#org264d20a">8.6.10. Prototype Object</a></li>
<li><a href="#org2758278">8.6.11. Type Conversion</a>
<ul>
<li><a href="#org0f1f9c5">8.6.11.1. Number to String</a></li>
<li><a href="#org4b6ede7">8.6.11.2. String to Number</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org76dd7fa">8.7. Loops and Breaks</a>
<ul>
<li><a href="#orgd195303">8.7.1. for, while, do&#x2026;while</a></li>
<li><a href="#orgadf38bf">8.7.2. for&#x2026;in js:for&#x2026;in</a></li>
<li><a href="#org82f70d6">8.7.3. for&#x2026;of</a></li>
<li><a href="#orgc2dc54e">8.7.4. forEach</a></li>
<li><a href="#org27c874e">8.7.5. break and continue</a></li>
</ul>
</li>
<li><a href="#org6f981c5">8.8. Enumerable js:Enumerable</a></li>
<li><a href="#org7666045">8.9. JSONP, JSON</a>
<ul>
<li><a href="#org20dd982">8.9.1. JSONP</a></li>
<li><a href="#orgbda5876">8.9.2. JSON</a>
<ul>
<li><a href="#org8c05b4d">8.9.2.1. Deep Keys</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2d6899d">8.10. DOM Manipulation</a>
<ul>
<li><a href="#org83643f9">8.10.1. If an element exists</a></li>
<li><a href="#orge18ea1a">8.10.2. Loop querySelectorAll</a></li>
<li><a href="#org12304df">8.10.3. Remove a class</a></li>
<li><a href="#org1362db5">8.10.4. Selected Option</a></li>
<li><a href="#org72af445">8.10.5. Element data attributes</a></li>
</ul>
</li>
<li><a href="#org0c9cebe">8.11. URI and URI Component Encode, Current URL, open, email link</a></li>
<li><a href="#orgca0f13d">8.12. Cookie js:cookie</a></li>
<li><a href="#org869b180">8.13. Object only, no Class</a>
<ul>
<li><a href="#orgb7b12e5">8.13.1. new, Object.create</a></li>
<li><a href="#orge20d8d5">8.13.2. instanceof</a></li>
<li><a href="#org19b7c83">8.13.3. Object.defineProperty</a></li>
<li><a href="#org889dfb3">8.13.4. Example</a></li>
</ul>
</li>
<li><a href="#orge3935cd">8.14. Extending Native Object</a></li>
<li><a href="#org01cf908">8.15. Classical Inheritance, Parasitic Inheritance</a>
<ul>
<li><a href="#org0d1145f">8.15.1. Classical inheritance</a>
<ul>
<li><a href="#org5c5f20a">8.15.1.1. Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org38ff7fc">8.16. OOP Pattern</a></li>
<li><a href="#orge3f0323">8.17. Promise</a></li>
<li><a href="#org26e8259">8.18. Observable js:observable</a></li>
<li><a href="#org551e4cc">8.19. Worker</a></li>
<li><a href="#org0235cd1">8.20. XMLHttpRequest XMLHttpRequest</a>
<ul>
<li><a href="#org32a79fe">8.20.1. application/x-www-form-urlencoded vs multipart/form-data</a></li>
<li><a href="#org63e5719">8.20.2. FormData to send file</a></li>
<li><a href="#org2c57c21">8.20.3. Receive binary as arraybuffer or blob</a></li>
</ul>
</li>
<li><a href="#org32bcfcd">8.21. File handling</a></li>
<li><a href="#orgb5ca85a">8.22. Apply XSLT on XML</a></li>
<li><a href="#orgda9ae83">8.23. Apply XPath</a></li>
<li><a href="#org0ed7a15">8.24. Web APIs</a>
<ul>
<li><a href="#orgdcd72c3">8.24.1. WebSocket js:ws</a></li>
<li><a href="#org8bed0ed">8.24.2. Mutation Observer js:MutationObserver</a></li>
<li><a href="#org7c3aad8">8.24.3. Intersection Observer js:intersection observer</a></li>
</ul>
</li>
<li><a href="#org81c90c6">8.25. Testing</a>
<ul>
<li><a href="#org81bc6e7">8.25.1. Unit Testing</a></li>
</ul>
</li>
<li><a href="#org8c9b043">8.26. Worker</a>
<ul>
<li><a href="#org4809293">8.26.1. Web Worker</a></li>
<li><a href="#org901a075">8.26.2. Service Worker</a>
<ul>
<li><a href="#org15878b2">8.26.2.1. Basics</a></li>
<li><a href="#orge7cfd63">8.26.2.2. PWA</a></li>
<li><a href="#org2862834">8.26.2.3. Caching strategies</a></li>
<li><a href="#org817e68f">8.26.2.4. Push (not yet available on Chrome)</a></li>
<li><a href="#org62d4729">8.26.2.5. Background sync (not yet available on Chrome)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2f40c1f">8.27. iFrame</a>
<ul>
<li><a href="#orga60f738">8.27.1. Communication Between Children Window and Parent Window</a></li>
<li><a href="#org338301f">8.27.2. Dynamic iframe height</a></li>
<li><a href="#orge075b71">8.27.3. Responsive iframe</a></li>
</ul>
</li>
<li><a href="#org96f0866">8.28. setTimeout recall</a></li>
<li><a href="#org235764c">8.29. CSS Media Viewport Size js:viewport size</a></li>
<li><a href="#org23ad331">8.30. Use Cases</a>
<ul>
<li><a href="#org1f6ee23">8.30.1. Click to anchor</a></li>
<li><a href="#orgb425a15">8.30.2. Get radio value, Event on radio buttons</a></li>
<li><a href="#org917ea53">8.30.3. Detect iOS version</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org0d4366d">9. jQuery</a>
<ul>
<li><a href="#orga8c7724">9.1. Version, Closure, document ready</a>
<ul>
<li><a href="#orgbcaacc3">9.1.1. jQuery.noConflict</a></li>
</ul>
</li>
<li><a href="#org5bf3a78">9.2. Ajax</a></li>
<li><a href="#orgc5d5330">9.3. jQuery Selectors, Loop through found elements</a></li>
<li><a href="#orgb79d036">9.4. iFrame refer to parent</a></li>
<li><a href="#org6e97d2f">9.5. Find elements</a>
<ul>
<li><a href="#org7d7650b">9.5.1. Get parent element, sibling, closet</a></li>
<li><a href="#org3aa9175">9.5.2. Find inside an element, .find, .first, .last</a></li>
</ul>
</li>
<li><a href="#org57121b8">9.6. Pass $(this) to javascript function</a></li>
<li><a href="#org5c83edb">9.7. General click to element</a></li>
<li><a href="#org7eeb401">9.8. Pointer Events</a></li>
<li><a href="#orge5928d3">9.9. Replace class</a></li>
<li><a href="#orga01afb0">9.10. Move element</a></li>
<li><a href="#org656add6">9.11. Add Style</a></li>
<li><a href="#org227d442">9.12. Form</a>
<ul>
<li><a href="#orgf25191e">9.12.1. serialize</a></li>
<li><a href="#org856a14b">9.12.2. Disabled Field</a></li>
</ul>
</li>
<li><a href="#orgc2ec904">9.13. Animate</a>
<ul>
<li><a href="#org52485d5">9.13.1. Scroll</a></li>
</ul>
</li>
<li><a href="#orgf3a1c3b">9.14. Viewport Change Event</a></li>
<li><a href="#orga0a0cda">9.15. jQuery UI: Dialog jqueryui:dialog</a></li>
<li><a href="#orgef25c3c">9.16. jQuery UI: Sortable</a></li>
</ul>
</li>
<li><a href="#org9fea8e1">10. JavaScript projects</a>
<ul>
<li><a href="#orgd61d0dc">10.1. TweenLite, TweenMax, Greensock</a>
<ul>
<li><a href="#org5d9ce82">10.1.1. TweenLite.to() TweenLite.from() TweenLite.fromTo()</a>
<ul>
<li><a href="#org8a71c17">10.1.1.1. dest:css, relative value</a></li>
<li><a href="#orga14d5fe">10.1.1.2. dest:ease, easeIn (begin), easeOut (the end), easeInOut (both)</a></li>
<li><a href="#org9c0364c">10.1.1.3. dest:delay in seconds, dest:paused bool, dest:immediateRender</a></li>
<li><a href="#orgfcb31d9">10.1.1.4. dest:onComplete onCompleteParams</a></li>
</ul>
</li>
<li><a href="#org01dc1ab">10.1.2. Use Case</a>
<ul>
<li><a href="#org532ebec">10.1.2.1. Slideshow</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org5bdafef">10.2. Select2</a>
<ul>
<li><a href="#org415562e">10.2.1. Basic</a></li>
<li><a href="#orgb69e997">10.2.2. Internal Option data, &lt;optgroup&gt;</a></li>
<li><a href="#orga887db2">10.2.3. config:ajax</a></li>
<li><a href="#org7f26cb3">10.2.4. config:data</a></li>
<li><a href="#org7405d31">10.2.5. config:templateResult, Template</a></li>
<li><a href="#org3431040">10.2.6. config:templateSelection, Change display of selected value</a></li>
<li><a href="#org191c66f">10.2.7. config:maximumSelectionLength</a></li>
<li><a href="#org8a3906a">10.2.8. config:placeholder</a></li>
<li><a href="#orgdb92d99">10.2.9. config:allowClear</a></li>
<li><a href="#org547bb27">10.2.10. config:width</a></li>
<li><a href="#orgbd1e9d9">10.2.11. config:tags</a></li>
<li><a href="#orgc4cbb3d">10.2.12. config:tokenSeparators</a></li>
<li><a href="#org4b7d8e1">10.2.13. config:createTag</a></li>
<li><a href="#orgcca5acb">10.2.14. config:insertTag</a></li>
<li><a href="#org2862aec">10.2.15. config:matcher, config:minimumInputLength, config:minimumResultsForSearch, Search</a></li>
<li><a href="#org5e78c11">10.2.16. Methods, add, select, clear</a></li>
<li><a href="#org7bc9fc8">10.2.17. Method, get</a></li>
<li><a href="#orga85d9d3">10.2.18. Method, open|close dropdown, if initialized, destroy</a></li>
<li><a href="#org97ada74">10.2.19. Example: Destroy and Initiate</a></li>
<li><a href="#org1a5c30d">10.2.20. Add down arrow to multiple &lt;select&gt;</a></li>
<li><a href="#org4b5f223">10.2.21. Events</a></li>
</ul>
</li>
<li><a href="#orgba7f9e1">10.3. Owl Carousel</a></li>
<li><a href="#org925adc2">10.4. Fine Uploader</a></li>
<li><a href="#org874c92d">10.5. Dropzone</a>
<ul>
<li><a href="#org5c7a7dd">10.5.1. Basics</a></li>
<li><a href="#orgc4402b2">10.5.2. option:function:accept(file, done)</a></li>
<li><a href="#orgd3816d0">10.5.3. option:previewsContainer null|string</a></li>
<li><a href="#org90740bb">10.5.4. option:autoProcessQueue</a></li>
<li><a href="#orgfc04ccf">10.5.5. option:previewTemplate String, option:dict*</a></li>
<li><a href="#orgdd8e3d7">10.5.6. option:addRemoveLInks null:true</a></li>
<li><a href="#org2d05930">10.5.7. option:translation</a>
<ul>
<li><a href="#org11aaebe">10.5.7.1. option:dictCancelUpload, dictCancelUploadConfirmation, dictRemoveFile</a></li>
</ul>
</li>
<li><a href="#orgefced44">10.5.8. option:maxFiles int</a></li>
<li><a href="#org8561328">10.5.9. option:maxFilesize int (MB)</a></li>
<li><a href="#org325a0f0">10.5.10. option:event:init, add events</a></li>
<li><a href="#org2da2065">10.5.11. option:clickable null|true|false|an html element|a CSS selector|array of html</a></li>
<li><a href="#orgd9a056e">10.5.12. option:acceptedFiles string of list</a></li>
<li><a href="#org8ffc5c0">10.5.13. option:maxThumbnailFilesize (MB), thumbnailWidth, thumbnailHeight, thumbnailMethod</a></li>
<li><a href="#orgf6edc97">10.5.14. event:addedfile</a></li>
<li><a href="#org59fa4a2">10.5.15. event:removedfile(file)</a></li>
<li><a href="#org8a730a1">10.5.16. event:thumbnail(file, dataUrl)</a></li>
<li><a href="#org20f3983">10.5.17. event:processing(file)</a></li>
<li><a href="#org7bcfe57">10.5.18. event:uploadprogress(file, progress, bytesSent)</a></li>
<li><a href="#orgbfa120e">10.5.19. event:error(file)</a></li>
<li><a href="#org6cc5f62">10.5.20. event:success(file, responseText)</a></li>
<li><a href="#orgdc8dd12">10.5.21. event:complete(file)</a></li>
<li><a href="#orge712f97">10.5.22. event:canceled(file)</a></li>
<li><a href="#orgbe34d21">10.5.23. event:maxfilesexceeded(file)</a></li>
<li><a href="#org6522601">10.5.24. event:maxfilesreached(file)</a></li>
<li><a href="#orga498e64">10.5.25. FAQ</a></li>
<li><a href="#org3f30521">10.5.26. Show error returned by server</a></li>
<li><a href="#org1a6b0a1">10.5.27. Show server response</a></li>
<li><a href="#org39d929f">10.5.28. Show files already stored on server</a></li>
<li><a href="#org02a2c25">10.5.29. Sortable</a></li>
</ul>
</li>
<li><a href="#org3d1e6e8">10.6. modernizr</a>
<ul>
<li><a href="#org0106505">10.6.1. Feature</a>
<ul>
<li><a href="#org9e252a7">10.6.1.1. flexbox, flexboxlegacy, flexboxtweener, flexwrap modernizr:flexbox</a></li>
<li><a href="#org5851555">10.6.1.2. touchevents</a></li>
<li><a href="#orgf217f58">10.6.1.3. videoautoplay</a></li>
<li><a href="#org41eb498">10.6.1.4. webp modernizr:webp</a></li>
</ul>
</li>
<li><a href="#orga0bf4ba">10.6.2. Option</a>
<ul>
<li><a href="#org3b3833c">10.6.2.1. .mq(mq)</a></li>
</ul>
</li>
<li><a href="#org78b3fd9">10.6.3. API</a>
<ul>
<li><a href="#orgd50d6bb">10.6.3.1. Modernizr.on(feature, cb)</a></li>
<li><a href="#orge01fda3">10.6.3.2. .addTest('customFeatureName', cb)</a></li>
<li><a href="#org961d4fc">10.6.3.3. .atRule(prop)</a></li>
<li><a href="#org074c1e8">10.6.3.4. ._domPrefixes, ._prefixes</a></li>
<li><a href="#orgc4083a7">10.6.3.5. .hasEvent(eventName, [element])</a></li>
<li><a href="#org7258bfb">10.6.3.6. .prefixedCSS(prop), .prefixed(prop, [obj], [elem])</a></li>
<li><a href="#org27b3bbb">10.6.3.7. .prefixedCSSValue(prop,value)</a></li>
<li><a href="#org0f2e1e0">10.6.3.8. .testAllProps(prop,[value], [skipValueTest]), .testProp(prop,[value], [useValue])</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org75ae016">10.7. UAParser.js</a></li>
<li><a href="#org7e7d379">10.8. flowpaper</a></li>
<li><a href="#org7aee24f">10.9. reveal.js</a>
<ul>
<li><a href="#orgf6c8f54">10.9.1. Plugins</a>
<ul>
<li><a href="#orga4be4d1">10.9.1.1. reveal.js-menu</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org8926495">10.10. BabylonJS</a>
<ul>
<li><a href="#org860625d">10.10.1. Shapes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org3c84e46">11. ES6-ES2015 js:es6</a>
<ul>
<li><a href="#orgbe9d99f">11.1. Generator Function</a></li>
<li><a href="#org2b7fd14">11.2. async/await js:async/await</a></li>
</ul>
</li>
<li><a href="#orga78c279">12. NodeJS</a>
<ul>
<li><a href="#orgf66126e">12.1. Install on Ubuntu</a></li>
<li><a href="#org9603ac5">12.2. Install on Windows</a></li>
<li><a href="#orgbfc183e">12.3. Basic</a></li>
<li><a href="#org8fa4c87">12.4. Global Object</a>
<ul>
<li><a href="#org1f14a83">12.4.1. __dirname, __filename</a></li>
<li><a href="#orga8ad78e">12.4.2. console nodejs:console</a></li>
<li><a href="#orgd23c6f0">12.4.3. process</a>
<ul>
<li><a href="#orgbc9c284">12.4.3.1. process.argv</a></li>
<li><a href="#org806a5eb">12.4.3.2. stdout</a></li>
</ul>
</li>
<li><a href="#org535f8b6">12.4.4. module</a></li>
<li><a href="#org5f4326b">12.4.5. Timing</a></li>
</ul>
</li>
<li><a href="#org018c15e">12.5. Modules, Packages, Frameworks</a>
<ul>
<li><a href="#org801f325">12.5.1. Get version</a></li>
<li><a href="#org8099fc5">12.5.2. Update Package</a></li>
<li><a href="#org67718d6">12.5.3. Global package and Scoped package</a></li>
<li><a href="#org37aa67b">12.5.4. Peer dependencies</a></li>
<li><a href="#org2cba9a1">12.5.5. v8</a></li>
<li><a href="#org05aa363">12.5.6. npx npm:npx</a></li>
<li><a href="#orgf20648e">12.5.7. readline</a></li>
<li><a href="#org49750a8">12.5.8. events</a></li>
<li><a href="#orgfd98d3d">12.5.9. util (native)</a></li>
<li><a href="#org8e3664f">12.5.10. lodash</a>
<ul>
<li><a href="#org9b8f0de">12.5.10.1. _.identity(value)</a></li>
<li><a href="#org7b09983">12.5.10.2. _.matches(source)</a></li>
<li><a href="#org6d13fe4">12.5.10.3. _.find, _.findLast</a></li>
<li><a href="#orga1f254c">12.5.10.4. _.iteratee</a></li>
<li><a href="#orgaf030b5">12.5.10.5. _.property(path)</a></li>
</ul>
</li>
<li><a href="#org13640c1">12.5.11. child_process</a></li>
<li><a href="#org85cd474">12.5.12. gulp npm:gulp</a>
<ul>
<li><a href="#org8b6c2ba">12.5.12.1. Example</a></li>
<li><a href="#orgf0d441a">12.5.12.2. gulp.src</a></li>
<li><a href="#org5a177e2">12.5.12.3. gulp-rename</a></li>
<li><a href="#org832c284">12.5.12.4. gulp-sourcemaps</a></li>
<li><a href="#orga36dc27">12.5.12.5. gulp-postcss npm:gulp-postcss Doc</a></li>
<li><a href="#org00ed5f1">12.5.12.6. gulp-responsive</a></li>
<li><a href="#orgcf70fbc">12.5.12.7. gulp-imagemin</a></li>
<li><a href="#org1176781">12.5.12.8. gulp-svg-sprite</a></li>
</ul>
</li>
<li><a href="#org527cd8d">12.5.13. grunt</a></li>
<li><a href="#org7c1e731">12.5.14. webpack npm:webpack</a>
<ul>
<li><a href="#orgfc2b999">12.5.14.1. Multiple bundles</a></li>
<li><a href="#org13de5c9">12.5.14.2. Rules</a></li>
<li><a href="#orgf53a14b">12.5.14.3. Plugins</a></li>
<li><a href="#orgcfc13fb">12.5.14.4. resolve</a></li>
<li><a href="#org1a118d6">12.5.14.5. webpack.(common|dev|prod).js</a></li>
<li><a href="#org5904adf">12.5.14.6. Use of webpack.(common|dev|prod).js</a></li>
</ul>
</li>
<li><a href="#org8e944e7">12.5.15. PostCSS, postcss-cli cssnano autoprefixer</a>
<ul>
<li><a href="#org9735edc">12.5.15.1. postcss-cli npm:postcss-cli</a></li>
<li><a href="#org1d483c1">12.5.15.2. autoprefixer npm:autoprefixer</a></li>
<li><a href="#orgcd23dcb">12.5.15.3. cssnano npm:cssnano</a></li>
<li><a href="#orga44f0c0">12.5.15.4. precss npm:precss</a></li>
</ul>
</li>
<li><a href="#orgca1f633">12.5.16. path nodejs:path</a></li>
<li><a href="#org4e109e8">12.5.17. fs</a></li>
<li><a href="#org38293ef">12.5.18. co-fs, co nodejs:co-fs nodejs:co</a></li>
<li><a href="#orgb05ba19">12.5.19. http, https nodejs:http</a>
<ul>
<li><a href="#orgea8728d">12.5.19.1. request</a></li>
<li><a href="#orgf4664e7">12.5.19.2. server</a></li>
</ul>
</li>
<li><a href="#org50e236c">12.5.20. cors</a></li>
<li><a href="#org6c4080f">12.5.21. xml2js</a></li>
<li><a href="#org36c4a91">12.5.22. crypto</a>
<ul>
<li><a href="#org9c112cf">12.5.22.1. HMAC</a></li>
<li><a href="#orgabd87b4">12.5.22.2. encrypt, decrypt nodejs:decrypt</a></li>
</ul>
</li>
<li><a href="#orgb41958b">12.5.23. body-parser</a></li>
<li><a href="#org901966f">12.5.24. httpster</a></li>
<li><a href="#orge79ec91">12.5.25. express nodejs:express</a>
<ul>
<li><a href="#orgfb0a61c">12.5.25.1. Sample</a></li>
<li><a href="#org4241cd7">12.5.25.2. Routing</a></li>
<li><a href="#org4bb82fd">12.5.25.3. Error-handling middleware</a></li>
<li><a href="#org661d5e7">12.5.25.4. Built-in middleware</a></li>
<li><a href="#orga973e3e">12.5.25.5. View Engine (ejs)</a></li>
</ul>
</li>
<li><a href="#org456dd0f">12.5.26. sails</a></li>
<li><a href="#orgba3eb14">12.5.27. koa</a></li>
<li><a href="#org43f8cf3">12.5.28. Promise</a>
<ul>
<li><a href="#org79dc4bb">12.5.28.1. Basics</a></li>
<li><a href="#orgdad69db">12.5.28.2. http server example</a></li>
</ul>
</li>
<li><a href="#org05e9cad">12.5.29. bluebird nodejs:bluebird</a></li>
<li><a href="#org5fa82cf">12.5.30. node-dev, nodemon, reload</a></li>
<li><a href="#org4d304b4">12.5.31. jshint</a></li>
<li><a href="#org3019be5">12.5.32. ws</a></li>
<li><a href="#org78bb957">12.5.33. socket.io</a></li>
<li><a href="#org383fc82">12.5.34. mocha, chai, nock, rewire, sinon</a></li>
<li><a href="#org3bc1520">12.5.35. supertest, cheerio</a></li>
<li><a href="#org1466f9c">12.5.36. istanbul</a></li>
<li><a href="#orga508829">12.5.37. svgo nodejs:svgo</a></li>
</ul>
</li>
<li><a href="#org26c5ec7">12.6. Custom Module</a>
<ul>
<li><a href="#orgb03ea4c">12.6.1. package.json, node-inspector</a></li>
</ul>
</li>
<li><a href="#org9bb4db1">12.7. node-gyp node-gyp</a></li>
<li><a href="#org02f63ee">12.8. npm dependency ~ vs ^ nodejs:semver</a></li>
</ul>
</li>
<li><a href="#org9ba9e80">13. Angular</a>
<ul>
<li><a href="#orgcf12062">13.1. Who use Angular?</a></li>
<li><a href="#org981294e">13.2. 1.x AngularJS</a>
<ul>
<li><a href="#org6507395">13.2.1. Structure</a></li>
<li><a href="#org3b3d93e">13.2.2. Calling Order</a></li>
<li><a href="#orge931669">13.2.3. Config ng:config</a></li>
<li><a href="#orgcbffa9d">13.2.4. Run</a></li>
<li><a href="#orgfca8245">13.2.5. Filter ng:filter</a></li>
<li><a href="#org62f358c">13.2.6. Factory ng:factory</a></li>
<li><a href="#org2179f5a">13.2.7. Service ng:service</a></li>
<li><a href="#orgda61c74">13.2.8. Provider ng:provider</a></li>
<li><a href="#orga704ce0">13.2.9. Change URL without reloading page</a></li>
</ul>
</li>
<li><a href="#org5f19a52">13.3. 2.x Angular</a>
<ul>
<li><a href="#org4ba9af1">13.3.1. QuickStart seed</a>
<ul>
<li><a href="#org92e876b">13.3.1.1. Install</a></li>
<li><a href="#orgbd1e67b">13.3.1.2. .gitignore</a></li>
<li><a href="#orge360b55">13.3.1.3. Files</a></li>
</ul>
</li>
<li><a href="#org05b9555">13.3.2. SystemJS vs Webpack</a></li>
<li><a href="#orgaa2ce37">13.3.3. package.json</a>
<ul>
<li><a href="#org998eec9">13.3.3.1. devDependencies</a></li>
<li><a href="#org9429c1d">13.3.3.2. dependencies</a></li>
<li><a href="#org2c0a988">13.3.3.3. scripts</a></li>
</ul>
</li>
<li><a href="#orgaf896f5">13.3.4. tsconfig.json, d.ts, lib.d.ts</a></li>
<li><a href="#orgac15fd3">13.3.5. lite-server</a></li>
<li><a href="#org7a10b2f">13.3.6. CLI</a>
<ul>
<li><a href="#orge764a00">13.3.6.1. Install &amp; Update</a></li>
<li><a href="#orgf4820d3">13.3.6.2. Generate Component, Directive, Pipes and Services</a></li>
<li><a href="#org3ca9c5a">13.3.6.3. New project</a></li>
<li><a href="#orgdda643e">13.3.6.4. build</a></li>
<li><a href="#orga579e0b">13.3.6.5. eject ng:cli:webpack</a></li>
</ul>
</li>
<li><a href="#orgf7b600d">13.3.7. Polyfills</a></li>
<li><a href="#org01f140d">13.3.8. Bootstrap ng:bootstrap</a></li>
<li><a href="#org50a724b">13.3.9. Root Module ng:root module</a></li>
<li><a href="#org4887cf9">13.3.10. ngModule</a></li>
<li><a href="#org73ec0ae">13.3.11. Component</a></li>
<li><a href="#orgec1b9a4">13.3.12. Template</a>
<ul>
<li><a href="#org4ef59d1">13.3.12.1. Files</a></li>
<li><a href="#org61e1a2e">13.3.12.2. <code>{{ }}</code></a></li>
<li><a href="#orgb80cc82">13.3.12.3. Styles</a></li>
<li><a href="#org248b412">13.3.12.4. Event <code>(eventType)</code></a></li>
<li><a href="#org443ff8a">13.3.12.5. Template Reference variable <code>#var</code></a></li>
<li><a href="#org0a37db9">13.3.12.6. One-way binding</a></li>
<li><a href="#org4c4ba63">13.3.12.7. Two-way binding <code>[(x)]</code> <code>[(ngModel)]</code> <code>[ngModel]</code> <code>(ngModelChange)</code></a></li>
<li><a href="#orgc8cf631">13.3.12.8. @Input, @Output ng:input output</a></li>
<li><a href="#org6799947">13.3.12.9. Structural directives (builtin) <code>ngIf</code> <code>ngFor</code> <code>ngSwitch</code> <code>&lt;ng-container&gt;</code></a></li>
<li><a href="#org129df1a">13.3.12.10. Attribute directives (builtin) <code>ngClass</code> <code>ngStyle</code></a></li>
</ul>
</li>
<li><a href="#org8ce0e94">13.3.13. Pipe ng:pipe</a>
<ul>
<li><a href="#org6892dcc">13.3.13.1. Builtin pipes</a></li>
<li><a href="#orgfd35288">13.3.13.2. Custom pipe</a></li>
</ul>
</li>
<li><a href="#org848d902">13.3.14. Directive ng:directive</a>
<ul>
<li><a href="#org1e5965b">13.3.14.1. Custom attribute directive <code>HostListener</code> <code>HostBinding</code></a></li>
</ul>
</li>
<li><a href="#org759b7f5">13.3.15. Model and Custom Component</a></li>
<li><a href="#orge7517f3">13.3.16. Form</a>
<ul>
<li><a href="#orgea1925c">13.3.16.1. Template driven <code>ngModel</code> <code>ngSubmit</code></a></li>
<li><a href="#orgbd94e58">13.3.16.2. Model driven, Validation</a></li>
</ul>
</li>
<li><a href="#org9912918">13.3.17. Service, Dependency Injection</a>
<ul>
<li><a href="#org29af6c0">13.3.17.1. FormBuilder</a></li>
<li><a href="#orgcc5925f">13.3.17.2. Custom service and inject variable</a></li>
<li><a href="#orgc1a6b1c">13.3.17.3. OpaqueToken, InjectionToken</a></li>
<li><a href="#org8f68c60">13.3.17.4. Http</a></li>
</ul>
</li>
<li><a href="#org0ad39a2">13.3.18. Route</a>
<ul>
<li><a href="#orgc6b8d67">13.3.18.1. base href, config and register routes</a></li>
<li><a href="#org82d8366">13.3.18.2. router-outlet</a></li>
<li><a href="#org79e66da">13.3.18.3. routerLink</a></li>
<li><a href="#orge9f9174">13.3.18.4. read route in component</a></li>
<li><a href="#org412669d">13.3.18.5. Navigate in code</a></li>
</ul>
</li>
<li><a href="#org561330d">13.3.19. API</a></li>
<li><a href="#org604529e">13.3.20. Style Guide</a>
<ul>
<li><a href="#org0c8c7bb">13.3.20.1. File Structure ng:file structure</a></li>
<li><a href="#orgf21383f">13.3.20.2. File name</a></li>
<li><a href="#org7548546">13.3.20.3. Symbol name and file name</a></li>
<li><a href="#org080579b">13.3.20.4. Bootstrapping</a></li>
<li><a href="#org1987408">13.3.20.5. Directive selectors (lower camel case)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#org378eaec">14. Vue.js</a>
<ul>
<li><a href="#org16f2ac8">14.1. Who use Vue.js</a></li>
<li><a href="#org4e44fa9">14.2. Builds</a></li>
<li><a href="#orga8c8a9d">14.3. Basics</a></li>
<li><a href="#org6b57345">14.4. Data and methods</a>
<ul>
<li><a href="#org9ee2dd2">14.4.1. Mutation, Vue.set</a></li>
</ul>
</li>
<li><a href="#org5ee6cd3">14.5. Instance Lifecycle Hooks</a>
<ul>
<li><a href="#org7609729">14.5.1. beforeCreate, created</a></li>
<li><a href="#orgab691b7">14.5.2. vm.$mount(el), beforeMount, mounted</a></li>
<li><a href="#org46d87d0">14.5.3. beforeUpdate, updated</a></li>
<li><a href="#orga71829f">14.5.4. beforeDestroy, destroyed</a></li>
</ul>
</li>
<li><a href="#org233c7a2">14.6. Component</a>
<ul>
<li><a href="#org0e1de28">14.6.1. Basics</a></li>
<li><a href="#orga8e3135">14.6.2. DOM Template Parsing Caveats</a></li>
<li><a href="#org7ccc927">14.6.3. Option data has to be a function</a></li>
<li><a href="#org14546c8">14.6.4. Option filters</a></li>
<li><a href="#orge271ad8">14.6.5. Props down</a>
<ul>
<li><a href="#org9be2f86">14.6.5.1. Don't mutate a prop of child component</a></li>
<li><a href="#org1ba1706">14.6.5.2. prop validation</a></li>
</ul>
</li>
<li><a href="#org2d386c7">14.6.6. Events Up</a></li>
<li><a href="#org190ef67">14.6.7. DOM template</a></li>
<li><a href="#org67c7253">14.6.8. Except class and style :: parent attributes overwrite child component</a></li>
<li><a href="#org17cd252">14.6.9. Slots</a>
<ul>
<li><a href="#org895eae6">14.6.9.1. Basics</a></li>
<li><a href="#org6b25895">14.6.9.2. Multiple slots</a></li>
<li><a href="#org36e38c9">14.6.9.3. Scoped slot</a></li>
<li><a href="#orgac4af8e">14.6.9.4. Destructuring for slot-scope</a></li>
</ul>
</li>
<li><a href="#orge1dec69">14.6.10. Dynamic component, v-bind:is, &lt;component&gt;, &lt;keep-alive&gt;</a></li>
<li><a href="#orgc162f9d">14.6.11. Get Child Component One Time</a></li>
<li><a href="#orgbfdffc3">14.6.12. Async Components</a>
<ul>
<li><a href="#orgba90e8f">14.6.12.1. Component factory function can return a Promise</a></li>
<li><a href="#org58c5ab1">14.6.12.2. Component factory function can also return an object</a></li>
</ul>
</li>
<li><a href="#org9e554eb">14.6.13. Recursive and Circular Reference</a>
<ul>
<li><a href="#orgd7bbda2">14.6.13.1. Recursive</a></li>
<li><a href="#org6a503b2">14.6.13.2. Circular reference</a></li>
</ul>
</li>
<li><a href="#org427cd80">14.6.14. inline-template</a></li>
<li><a href="#org909a554">14.6.15. X-Templates</a></li>
</ul>
</li>
<li><a href="#orgbf796b0">14.7. Template Syntax</a>
<ul>
<li><a href="#orged4dab3">14.7.1. String template vs DOM template</a></li>
<li><a href="#orgb78b947">14.7.2. v-once on text or element</a></li>
<li><a href="#orgc5bb8eb">14.7.3. v-html</a></li>
<li><a href="#org279ab92">14.7.4. v-bind:attributeName, :attributeName</a></li>
<li><a href="#org6193900">14.7.5. Expression</a></li>
<li><a href="#orgc469046">14.7.6. Arguments :: v-bind:href, v-bind:class, v-on:click</a>
<ul>
<li><a href="#orgb59934c">14.7.6.1. v-bind:href, v-on:click</a></li>
<li><a href="#org243625e">14.7.6.2. v-bind:class</a></li>
<li><a href="#org1bbab60">14.7.6.3. v-bind:style</a></li>
</ul>
</li>
<li><a href="#org5e01b72">14.7.7. Modifiers :: v-on:submit.prevent</a></li>
<li><a href="#org8e20913">14.7.8. v-if, key attribute, v-show</a></li>
<li><a href="#org422a0c1">14.7.9. List, v-for</a>
<ul>
<li><a href="#org9e63dfe">14.7.9.1. Basics</a></li>
<li><a href="#orge93b844">14.7.9.2. Filtered/Sorted</a></li>
<li><a href="#org6aaddeb">14.7.9.3. range</a></li>
<li><a href="#org87bf6d6">14.7.9.4. v-for on &lt;template&gt;</a></li>
<li><a href="#org92e0741">14.7.9.5. v-for with v-if</a></li>
<li><a href="#org9be46bc">14.7.9.6. v-for with a component</a></li>
<li><a href="#org9e7a5b4">14.7.9.7. Example</a></li>
</ul>
</li>
<li><a href="#orgcd55b5c">14.7.10. Event, v-on, @attributeName</a>
<ul>
<li><a href="#org1952938">14.7.10.1. Basics</a></li>
<li><a href="#orgdcd7548">14.7.10.2. Method calling</a></li>
<li><a href="#orgf3a8abb">14.7.10.3. Inline with $event</a></li>
<li><a href="#org7d23e01">14.7.10.4. Event Modifiers</a></li>
<li><a href="#org05680d3">14.7.10.5. Event Key Modifiers vue:event:key modifiers</a></li>
<li><a href="#org9ee7db3">14.7.10.6. Event from child component. .sync vue:event:component</a></li>
<li><a href="#org7774da0">14.7.10.7. Event in Form, v-model vue:event:v-model</a></li>
<li><a href="#org8b7f344">14.7.10.8. Use Event to transfer data between components that are not parent-child</a></li>
</ul>
</li>
<li><a href="#orgd34eab4">14.7.11. Form input, v-model</a>
<ul>
<li><a href="#org16886bf">14.7.11.1. textarea</a></li>
<li><a href="#orgf4d6eca">14.7.11.2. checkbox</a></li>
<li><a href="#orgf686592">14.7.11.3. radio</a></li>
<li><a href="#org40fec0f">14.7.11.4. select</a></li>
<li><a href="#org69b5104">14.7.11.5. Use v-bind with v-model to prepopulate</a></li>
<li><a href="#orgac20504">14.7.11.6. v-model modifiers</a></li>
<li><a href="#org380d49c">14.7.11.7. Event in v-model</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orge4f14f0">14.8. Computed Property, Watchers</a>
<ul>
<li><a href="#orge7a63a9">14.8.1. Computed property</a></li>
<li><a href="#org15e2399">14.8.2. Watchers</a></li>
</ul>
</li>
<li><a href="#org63a9f94">14.9. Transition &amp; Animation</a>
<ul>
<li><a href="#org4723f11">14.9.1. &lt;transition&gt; wrapper component</a>
<ul>
<li><a href="#org9e6c5e8">14.9.1.1. CSS Transition</a></li>
<li><a href="#orgd2f37bf">14.9.1.2. CSS Animations</a></li>
<li><a href="#org615cd97">14.9.1.3. Custom Transition Class</a></li>
<li><a href="#orgccde6a4">14.9.1.4. prop</a></li>
<li><a href="#org686a379">14.9.1.5. event hooks</a></li>
<li><a href="#org62c4a6e">14.9.1.6. Transition on Initial Render</a></li>
<li><a href="#orgc95f6bc">14.9.1.7. Transition between elements</a></li>
<li><a href="#org2bc950d">14.9.1.8. Transition modes</a></li>
<li><a href="#org208197e">14.9.1.9. Transition between dynamic components</a></li>
</ul>
</li>
<li><a href="#orga5c3a2b">14.9.2. List transition &lt;transition-group&gt;</a>
<ul>
<li><a href="#orge2a86b0">14.9.2.1. Animate entering and leaving</a></li>
<li><a href="#org67f2808">14.9.2.2. Animate when order is changed, v-move, *-move class</a></li>
<li><a href="#org857dda3">14.9.2.3. javascript hooks</a></li>
</ul>
</li>
<li><a href="#org7da19c8">14.9.3. Make transition reusable</a></li>
<li><a href="#org1e4e0aa">14.9.4. State Transition</a>
<ul>
<li><a href="#org544bf28">14.9.4.1. Watchers, Tween.js, Color.js</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org0fe71ad">14.10. Mixins</a>
<ul>
<li><a href="#org080e2bb">14.10.1. Local vs Global</a></li>
<li><a href="#org1e2ee49">14.10.2. Merge option with hook functions</a></li>
<li><a href="#org0cd000a">14.10.3. Merge option with Object value</a></li>
<li><a href="#org696926b">14.10.4. Custom Option Merge Strategies</a></li>
</ul>
</li>
<li><a href="#orgefe5614">14.11. Custom Directive</a>
<ul>
<li><a href="#orgf25797f">14.11.1. Basics</a></li>
<li><a href="#org0a4bfbd">14.11.2. Option - Hook Functions</a>
<ul>
<li><a href="#orgf6224e6">14.11.2.1. Hooks are passed these arguments</a></li>
</ul>
</li>
<li><a href="#org519f47b">14.11.3. Example</a></li>
</ul>
</li>
<li><a href="#org9fbae59">14.12. Render Functions &amp; JSX</a>
<ul>
<li><a href="#orgf2bdd70">14.12.1. Render function</a>
<ul>
<li><a href="#org55e9edc">14.12.1.1. createElement Arguments</a></li>
<li><a href="#orga183a4c">14.12.1.2. createElement Constraints</a></li>
<li><a href="#orgbbd94ee">14.12.1.3. render for v-if and v-for</a></li>
<li><a href="#org5096551">14.12.1.4. render for v-model</a></li>
<li><a href="#org565795a">14.12.1.5. redner for event &amp; key modifiers</a></li>
<li><a href="#org481d1c3">14.12.1.6. render for &lt;slot&gt;</a></li>
</ul>
</li>
<li><a href="#orgd34a8ba">14.12.2. JSX</a></li>
</ul>
</li>
<li><a href="#orgfd8e17f">14.13. Plugin</a>
<ul>
<li><a href="#org2a0fffc">14.13.1. Basics</a></li>
<li><a href="#orgf0573c8">14.13.2. vuex Namespace in Plugin</a></li>
</ul>
</li>
<li><a href="#org53efd35">14.14. Production Development</a></li>
<li><a href="#orgab0dbe5">14.15. vue-router</a>
<ul>
<li><a href="#orge69e039">14.15.1. &lt;router-view&gt;, &lt;router-link&gt;, option:routes, this.$router, this.$route</a></li>
<li><a href="#org391737c">14.15.2. option:routes, $route.params, regex, option:routes[]:name, option:routes[]:component</a>
<ul>
<li><a href="#org46946cb">14.15.2.1. regex pattern in option:routes</a></li>
<li><a href="#orgf5996ec">14.15.2.2. Named routes, option:routes[]:name</a></li>
</ul>
</li>
<li><a href="#org8218f98">14.15.3. option:routes[]:components, multiple &lt;router-view&gt;'s</a></li>
<li><a href="#orgbe455d2">14.15.4. option:routes[]:redirect, option:routes[]:alias</a></li>
<li><a href="#org7bacd1d">14.15.5. Route object, $route, this.$route, option:scrollBehavior vue:router:route</a></li>
<li><a href="#org674b5f4">14.15.6. option:scrollBehavior</a></li>
<li><a href="#org2997650">14.15.7. option:routes[]:props, component:props</a></li>
<li><a href="#orga4f01b1">14.15.8. React to params changes, component:watch, component:beforeRouteUpdate</a></li>
<li><a href="#orgfa40c99">14.15.9. Nested routes, &lt;router-view&gt;, option:routes:children</a>
<ul>
<li><a href="#org80a64c6">14.15.9.1. option:routes:children[]:meta</a></li>
</ul>
</li>
<li><a href="#org7506382">14.15.10. Programmatic Navigation, this.$router, router.*</a>
<ul>
<li><a href="#org31364e1">14.15.10.1. router.push, router.replace, router.push.onComplete, router.push.onAbort</a></li>
<li><a href="#org665dcc3">14.15.10.2. router.go(n)</a></li>
</ul>
</li>
<li><a href="#org4534500">14.15.11. option:mode</a></li>
<li><a href="#org0a7156b">14.15.12. Guards</a>
<ul>
<li><a href="#org5a798d6">14.15.12.1. global, router.beforeEach, router.beforeResolve, router.afterEach</a></li>
<li><a href="#orgbc92327">14.15.12.2. per-route, option:routes[]:beforeEnter</a></li>
<li><a href="#org7d5a398">14.15.12.3. in-component, component:beforeRouteEnter, component:beforeRouteUpdate, component:beforeRouteLeave</a></li>
</ul>
</li>
<li><a href="#org032da40">14.15.13. Fetch data</a></li>
<li><a href="#orgc9aef6b">14.15.14. Lazy loading</a></li>
</ul>
</li>
<li><a href="#org413a440">14.16. State Management, Vuex</a>
<ul>
<li><a href="#orga261e61">14.16.1. Basics, option:state</a></li>
<li><a href="#org4aa669a">14.16.2. mapState in component computed props</a></li>
<li><a href="#org3540c9e">14.16.3. option:getters, mapGetters in component computed props</a></li>
<li><a href="#org5ba0834">14.16.4. option:mutations, commit/mapMutations in component, Synchronous vue:plugin:vuex:mutations</a>
<ul>
<li><a href="#orgf2109fb">14.16.4.1. Mutation in store, commit in component</a></li>
<li><a href="#orgdd6fa03">14.16.4.2. mapMutations in component</a></li>
<li><a href="#org8ad67ae">14.16.4.3. Constant for Mutation</a></li>
</ul>
</li>
<li><a href="#orge9760f4">14.16.5. option:actions with context, dispatch/mapActions in component, Asynchronous</a>
<ul>
<li><a href="#org8348c9f">14.16.5.1. Basics</a></li>
<li><a href="#org3b02114">14.16.5.2. mapActions and Asynchronous</a></li>
<li><a href="#org20eb369">14.16.5.3. Series of actions, return Promise</a></li>
<li><a href="#orgbc4eb14">14.16.5.4. Series of actions, async/await</a></li>
</ul>
</li>
<li><a href="#org6b20db6">14.16.6. option:modules</a>
<ul>
<li><a href="#org97eaf6d">14.16.6.1. Module local state and rootState</a></li>
<li><a href="#org34f7fd9">14.16.6.2. Namespace</a></li>
<li><a href="#org267e6bb">14.16.6.3. rootGetters</a></li>
<li><a href="#orgb1a1e9d">14.16.6.4. Namespace in Plugin Development vue:plugin:vuex:namespace in plugin</a></li>
</ul>
</li>
<li><a href="#orgb772bc7">14.16.7. option:strict, strict mode</a></li>
<li><a href="#org0435b4b">14.16.8. option:watch</a></li>
<li><a href="#org2ef05b6">14.16.9. option:plugin</a></li>
<li><a href="#org35a0139">14.16.10. App Structure, Example</a></li>
</ul>
</li>
<li><a href="#orge312031">14.17. Dev - Webpack Template</a>
<ul>
<li><a href="#org877530b">14.17.1. Basics</a></li>
<li><a href="#org2025179">14.17.2. npm</a></li>
<li><a href="#org44afcdb">14.17.3. Structure</a></li>
<li><a href="#org8957d8e">14.17.4. Linter configuration</a></li>
<li><a href="#org9e5ee4d">14.17.5. CSS Pre-processor</a></li>
<li><a href="#org99d53e6">14.17.6. Processed Static Assets =&gt; /src/assets</a></li>
<li><a href="#orge66b767">14.17.7. Integrate with Backend vue:webpack:integrate backend</a>
<ul>
<li><a href="#orgd6bdc26">14.17.7.1. Proxy requests to a backend</a></li>
<li><a href="#org5bb7c81">14.17.7.2. Backend path</a></li>
</ul>
</li>
<li><a href="#org498f119">14.17.8. .vue file vue-loader</a>
<ul>
<li><a href="#org464786c">14.17.8.1. scoped css vue:loader:scoped css</a></li>
<li><a href="#orgc0f564c">14.17.8.2. CSS Modules</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgde58304">14.18. Ajax, axios</a></li>
</ul>
</li>
<li><a href="#org41ea313">15. Prerender.io</a></li>
<li><a href="#orga2dab1e">16. Social Media</a>
<ul>
<li><a href="#org1c433bd">16.1. Twitter</a>
<ul>
<li><a href="#orgc3a1c27">16.1.1. Compose link with prepopulated Tweet</a></li>
<li><a href="#org9bc5693">16.1.2. View a topic</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org090ce44">17. SEO</a>
<ul>
<li><a href="#org9726691">17.1. Starter Guide</a></li>
<li><a href="#orge06f7d7">17.2. Google Test Mobile Speed</a></li>
<li><a href="#org58d5422">17.3. Google My Business</a></li>
<li><a href="#org01da825">17.4. Google Analytics</a>
<ul>
<li><a href="#org74f2e57">17.4.1. Limits and Versions</a>
<ul>
<li><a href="#orgc7872dc">17.4.1.1. Hit limits</a></li>
</ul>
</li>
<li><a href="#org6d37d28">17.4.2. Views, Filters, Segments</a>
<ul>
<li><a href="#org88bf583">17.4.2.1. Filter</a></li>
<li><a href="#org80965cd">17.4.2.2. System Filters</a></li>
<li><a href="#orgf500bab">17.4.2.3. Include domain names (Custom Filter)</a></li>
</ul>
</li>
<li><a href="#org2ebd5b3">17.4.3. Dimensions vs Metrics ga:dimensions ga:metrics ga:scope</a>
<ul>
<li><a href="#org9535f4d">17.4.3.1. Custom dimensions and metrics ga:custom dimensions</a></li>
<li><a href="#orgf5362f3">17.4.3.2. Calculated Metric</a></li>
</ul>
</li>
<li><a href="#org7c87c81">17.4.4. Bounce</a></li>
<li><a href="#org2377d6c">17.4.5. Audience</a>
<ul>
<li><a href="#org950ef1f">17.4.5.1. User, New User, Session</a></li>
<li><a href="#orgcd3d9f8">17.4.5.2. Active user</a></li>
<li><a href="#orgc66b741">17.4.5.3. Cohort Analysis</a></li>
<li><a href="#org00b10c7">17.4.5.4. Interests ga:audience:interests</a></li>
<li><a href="#orgaaa1feb">17.4.5.5. Audiences</a></li>
<li><a href="#org07314ae">17.4.5.6. User Explorer</a></li>
<li><a href="#org2644152">17.4.5.7. Benchmarking</a></li>
<li><a href="#org15db1a4">17.4.5.8. Users Flow</a></li>
</ul>
</li>
<li><a href="#org7fcf32e">17.4.6. Acquisition ga:channel</a></li>
<li><a href="#org0ee58ce">17.4.7. Behavior</a>
<ul>
<li><a href="#org800f833">17.4.7.1. Content Grouping</a></li>
<li><a href="#orgf6673bc">17.4.7.2. Behavior Flow</a></li>
</ul>
</li>
<li><a href="#org8938d26">17.4.8. Conversions</a></li>
<li><a href="#orgc3e8c55">17.4.9. Add Google Search Console to a property</a></li>
<li><a href="#org1689160">17.4.10. Campaigns and Goals track across user session</a></li>
<li><a href="#orgda217f0">17.4.11. Goal vs Event</a></li>
<li><a href="#org4f79695">17.4.12. Segment ga:segment</a>
<ul>
<li><a href="#org2a06c02">17.4.12.1. Converter segment ga:segment:converter</a></li>
<li><a href="#org694d6a3">17.4.12.2. Custom segment - AdWords Search adwords:segment:search</a></li>
<li><a href="#org59fd01d">17.4.12.3. Create a segment ga:segment:create</a></li>
</ul>
</li>
<li><a href="#org3b644a7">17.4.13. Tracking Code :: gtag.js, analytics.js</a>
<ul>
<li><a href="#orgb1f994b">17.4.13.1. Custom parameters for dynamic remarketing ga:dynamic remarketing</a></li>
<li><a href="#orgd158de1">17.4.13.2. Send to multiple property id's</a></li>
<li><a href="#orgdfb24dd">17.4.13.3. ga Command Queue and Object Methods</a></li>
<li><a href="#orgb5ba662">17.4.13.4. ga Command Queue</a></li>
<li><a href="#orgd8900c8">17.4.13.5. ga Object Method</a></li>
</ul>
</li>
<li><a href="#org73c5bae">17.4.14. Tracker Object Methods</a>
<ul>
<li><a href="#org6a34a99">17.4.14.1. set</a></li>
<li><a href="#org396a30f">17.4.14.2. send ga:tracker:send</a></li>
</ul>
</li>
<li><a href="#org871b6a5">17.4.15. fieldsObject ga:fieldsObject</a>
<ul>
<li><a href="#orgad1efa9">17.4.15.1. page ga:fieldsObject:page</a></li>
<li><a href="#org00ce2de">17.4.15.2. Custom Dimensions and Metrics ga:fieldsObject:customs</a></li>
<li><a href="#orge5a6461">17.4.15.3. hitCallback</a></li>
</ul>
</li>
<li><a href="#org03c4cb0">17.4.16. Regular Expressions ga:regex</a>
<ul>
<li><a href="#orgb60f4b8">17.4.16.1. Include multiple words but order does not matter</a></li>
</ul>
</li>
<li><a href="#org735e801">17.4.17. TS: Too Many Self-referrals</a></li>
<li><a href="#orgdb77b1d">17.4.18. Analytics Solutions Gallery</a></li>
<li><a href="#org21a17f9">17.4.19. Email tracking, Measurement Protocol</a></li>
<li><a href="#org0631d04">17.4.20. Google Analytis Core Reporting API</a></li>
<li><a href="#org06d8d24">17.4.21. Learn</a></li>
<li><a href="#orgf8712af">17.4.22. Remarketing with Analytics ga:remarketing</a></li>
<li><a href="#orgc2a95fc">17.4.23. Dynamic Remarketing with Analytics ga:dynamic remarketing</a></li>
<li><a href="#org3778f83">17.4.24. Transfer a property</a></li>
<li><a href="#org0ce4e1f">17.4.25. Checklist</a></li>
</ul>
</li>
<li><a href="#org4aa9eca">17.5. Google Optimise</a></li>
<li><a href="#org73b3061">17.6. GA Dev Tools: Query Explorer</a></li>
<li><a href="#org8281e98">17.7. GA Dev Tools: Campaign URL Builder</a></li>
<li><a href="#orgf1fa90b">17.8. Google Search Console google:search console</a>
<ul>
<li><a href="#orgd57ed64">17.8.1. Search Traffic Report</a></li>
</ul>
</li>
<li><a href="#org63528d9">17.9. Google Trends</a></li>
<li><a href="#org3dfc567">17.10. Google Shopping Insights</a></li>
<li><a href="#org9c7033b">17.11. Google AdWords, Google Keyword Planner, Google Video Advertising</a>
<ul>
<li><a href="#orgae79de3">17.11.1. Keyword Planner</a></li>
<li><a href="#orgf4c1c9b">17.11.2. Google Ads - AdWords</a>
<ul>
<li><a href="#org57ca280">17.11.2.1. Campaign Goals</a></li>
<li><a href="#org77a3ba1">17.11.2.2. Keywords Match Type</a></li>
<li><a href="#org56249d6">17.11.2.3. Negative keywords</a></li>
<li><a href="#orga67a8ee">17.11.2.4. Campaigns, Ad groups</a></li>
<li><a href="#orgc69bc9c">17.11.2.5. Placement</a></li>
<li><a href="#org308d055">17.11.2.6. Quality Score, Ad Rank, Ad Position</a></li>
<li><a href="#org5082530">17.11.2.7. Media Cost Model</a></li>
<li><a href="#orgc1455c7">17.11.2.8. Networks, Campaign Types, Ad Formats</a></li>
<li><a href="#org446a3cf">17.11.2.9. Targeting options adwords:targeting</a></li>
<li><a href="#org8fc4783">17.11.2.10. Ad Group Automated Targeting</a></li>
<li><a href="#org4929ad2">17.11.2.11. Ad Formats in networks</a></li>
<li><a href="#orgdae68fb">17.11.2.12. Ad extension</a></li>
<li><a href="#orgbf48a3a">17.11.2.13. Ad customizers</a></li>
<li><a href="#org4c0f272">17.11.2.14. ValueTrack URL parameters</a></li>
<li><a href="#orgfc7556e">17.11.2.15. Supported Ad Sizes</a></li>
<li><a href="#orgba932c2">17.11.2.16. Conversion tracking</a></li>
<li><a href="#orgbfef2ea">17.11.2.17. Remarketing Audience, Customer Match</a></li>
<li><a href="#org3c7ae7e">17.11.2.18. Reports</a></li>
<li><a href="#orge7c65c8">17.11.2.19. Autotagging</a></li>
<li><a href="#orgc44037c">17.11.2.20. Automated Rules</a></li>
</ul>
</li>
<li><a href="#org4018ed5">17.11.3. Make ads</a></li>
<li><a href="#orgf26b081">17.11.4. Google Video Advertising</a>
<ul>
<li><a href="#org52e73fe">17.11.4.1. TrueView in-stream ads</a></li>
<li><a href="#orge36319c">17.11.4.2. Measure &amp; Solutions</a></li>
<li><a href="#org52a006f">17.11.4.3. Video Remarketing</a></li>
<li><a href="#org8682403">17.11.4.4. YouTube Advertising</a></li>
</ul>
</li>
<li><a href="#org6b76020">17.11.5. Google Rich Media Gallery</a></li>
</ul>
</li>
<li><a href="#orgc7c62ee">17.12. LinkedIn Marketing Solutions</a></li>
<li><a href="#orgd6cab99">17.13. Google Tag Manager</a></li>
<li><a href="#org05edbab">17.14. Keywords on websites</a></li>
<li><a href="#orgf40b708">17.15. Link building, Search Visibility</a></li>
<li><a href="#org1ee07ee">17.16. Site Audit Tools - check js errors, GA tagging, etc.</a>
<ul>
<li><a href="#org0afd4a1">17.16.1. ObservePoint</a></li>
</ul>
</li>
<li><a href="#orgb823a4b">17.17. SEO and PPC Strategy</a>
<ul>
<li><a href="#orgf8a90bc">17.17.1. SpyFu.com</a></li>
<li><a href="#orga81d464">17.17.2. SERanking.com</a></li>
<li><a href="#org4abc694">17.17.3. Moz.com</a>
<ul>
<li><a href="#org26a36b5">17.17.3.1. Free tools</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgb766110">17.18. Conversion Rate Optimization - CRO</a></li>
<li><a href="#org5a9d93a">17.19. Remarketing vs Retargeting</a></li>
<li><a href="#org3643f05">17.20. Competitive Marketing</a></li>
<li><a href="#orgbb108b8">17.21. Optimize Images</a></li>
<li><a href="#org04a5769">17.22. SERP Features</a></li>
<li><a href="#org670647f">17.23. Rich snippet, JSON-LD google:json-ld</a>
<ul>
<li><a href="#org76917b3">17.23.1. keywords and syntax tokens</a>
<ul>
<li><a href="#orgcbf9321">17.23.1.1. @id</a></li>
<li><a href="#org570b954">17.23.1.2. @graph</a></li>
</ul>
</li>
<li><a href="#org56ac3a9">17.23.2. Product</a></li>
<li><a href="#org89302d2">17.23.3. Organization, Website</a></li>
<li><a href="#org48a2128">17.23.4. ContactPoint</a></li>
<li><a href="#orge21821c">17.23.5. LocalBusiness</a></li>
<li><a href="#org623a0c6">17.23.6. OpeningHoursSpecification</a></li>
<li><a href="#orga65e267">17.23.7. CreativeWork</a></li>
</ul>
</li>
<li><a href="#org974f43e">17.24. Remove URL from Google Index</a></li>
<li><a href="#org6516fba">17.25. robots.txt</a></li>
<li><a href="#org7419a04">17.26. Design &amp; User Experience</a></li>
<li><a href="#orgb92a4a2">17.27. hreflang html:hreflang</a>
<ul>
<li><a href="#orgdf043e8">17.27.1. Inside <code>&lt;head&gt;</code></a></li>
</ul>
</li>
<li><a href="#org8a74fac">17.28. Market Research</a></li>
<li><a href="#org54267e3">17.29. Privacy Policy</a></li>
</ul>
</li>
<li><a href="#org1017bd2">18. UX and Design</a>
<ul>
<li><a href="#orgddb478f">18.1. Optimal Workshop</a></li>
<li><a href="#org5b1c800">18.2. Mobile Design</a></li>
<li><a href="#orgb84d9a4">18.3. Google Material Design</a></li>
</ul>
</li>
<li><a href="#orge8de443">19. Linux</a>
<ul>
<li><a href="#orgecc4987">19.1. Explain Shell</a></li>
<li><a href="#org528098b">19.2. System Version, Distro</a>
<ul>
<li><a href="#org28b6878">19.2.1. Debian</a></li>
<li><a href="#orgf82842e">19.2.2. Upgrade</a></li>
<li><a href="#org8e0ea99">19.2.3. Ubuntu upgrade to a newer release</a></li>
<li><a href="#org2fc8b7d">19.2.4. Kernal Bootloader</a></li>
<li><a href="#orgd504593">19.2.5. Shutdown Ubuntu</a></li>
</ul>
</li>
<li><a href="#org1bbec35">19.3. Environment and Shell Variables</a></li>
<li><a href="#org246e4fc">19.4. User Management, Superuser, sudo</a>
<ul>
<li><a href="#orge972dd6">19.4.1. Create and delete a user, Add user to sudo group linux:user</a></li>
<li><a href="#org7bb048c">19.4.2. Group sudo</a></li>
<li><a href="#orgad9c33a">19.4.3. Change a user's password</a></li>
<li><a href="#orgd4c1b90">19.4.4. List all users <code>cut -d: -f1 /etc/passwd</code> or <code>cat /etc/passwd</code></a></li>
<li><a href="#orgde47f45">19.4.5. Switch to superuser</a></li>
<li><a href="#org15db066">19.4.6. Login to another user, Run command as another user</a></li>
<li><a href="#orgdbb549f">19.4.7. Sudo run multiple commands</a></li>
<li><a href="#org10ce5b5">19.4.8. Pass password as a file to sudo</a></li>
<li><a href="#orgab9eed5">19.4.9. Require no password when sudo is run as another user linux:sudo:nopassword</a></li>
</ul>
</li>
<li><a href="#orgbd45e97">19.5. SSH, scp, sshpass linux:ssh bash:ssh bash:scp</a>
<ul>
<li><a href="#org088a543">19.5.1. Transfer Client Key to Host</a>
<ul>
<li><a href="#org4541b17">19.5.1.1. Manual way</a></li>
<li><a href="#org92a21d4">19.5.1.2. Fast way</a></li>
<li><a href="#org3667595">19.5.1.3. Remove passphrase for private key id_rsa</a></li>
</ul>
</li>
<li><a href="#orgbc13344">19.5.2. ssh config</a></li>
<li><a href="#org1e9979b">19.5.3. Use private key from SSH server to connect</a></li>
<li><a href="#orge8d0daf">19.5.4. Restart SSH linux:ssh:restart</a></li>
<li><a href="#orgf012090">19.5.5. Backup sshd_config file</a></li>
<li><a href="#org2ecd160">19.5.6. Disallow SSH as root user, SSH Daemon Config linux:ssh:disallow_root</a></li>
<li><a href="#org976e16b">19.5.7. Disable Password Authentication</a></li>
<li><a href="#org1fbfecc">19.5.8. Login without setting public keys bash:sshpass</a></li>
<li><a href="#org9709bcf">19.5.9. Random password</a></li>
<li><a href="#org06e814a">19.5.10. Run command</a></li>
<li><a href="#orgec172dc">19.5.11. SSH tunneling</a>
<ul>
<li><a href="#orge1e641b">19.5.11.1. Port Forwarding via a single intermediate host</a></li>
<li><a href="#org31629ee">19.5.11.2. SOCKS server</a></li>
<li><a href="#org236b321">19.5.11.3. SOCKS on Windows</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org272750c">19.6. fail2ban linux:fail2ban</a></li>
<li><a href="#org5d480b6">19.7. System</a></li>
<li><a href="#org4da0a6a">19.8. Filesystem</a>
<ul>
<li><a href="#org9f627d3">19.8.1. /dev /mnt /media</a></li>
<li><a href="#orgb1bf5e3">19.8.2. bindfs linux:bindfs</a></li>
<li><a href="#org3ee0a75">19.8.3. /etc system configuration files</a></li>
<li><a href="#org62cc9c3">19.8.4. Disk space linux:du</a>
<ul>
<li><a href="#org370478f">19.8.4.1. Large file deleted but still no space</a></li>
<li><a href="#org9cf43d9">19.8.4.2. /tmp is mounted as overflow (often sized at 1MB).</a></li>
<li><a href="#org48382cd">19.8.4.3. Swap</a></li>
</ul>
</li>
<li><a href="#orgd95c1c3">19.8.5. File permission</a>
<ul>
<li><a href="#org34be00b">19.8.5.1. Return list of files in Octal</a></li>
<li><a href="#org3be1141">19.8.5.2. Change permission - chmod</a></li>
<li><a href="#orgb5c697a">19.8.5.3. Change owner:group for a folder - chown</a></li>
<li><a href="#org78c7d30">19.8.5.4. Create several users for SFTP and final file permissions are www-data linux:permission:users</a></li>
</ul>
</li>
<li><a href="#org7037690">19.8.6. Symbolic Link</a></li>
<li><a href="#org6bf8606">19.8.7. Search files or directories, sort by size bash:find</a></li>
<li><a href="#orgc08c49e">19.8.8. Search Text in Files linux:grep</a></li>
<li><a href="#orgb9e5100">19.8.9. Folder structure linux:tree</a></li>
<li><a href="#orgb6d7b59">19.8.10. Compare files in 2 directories</a></li>
<li><a href="#org18a47ad">19.8.11. Compare text files</a></li>
<li><a href="#org672c510">19.8.12. Delete folders with a name</a></li>
<li><a href="#org79d7f11">19.8.13. ftp bash:ftp</a>
<ul>
<li><a href="#org2e85dac">19.8.13.1. Basics</a></li>
<li><a href="#org081b3ee">19.8.13.2. lftp</a></li>
<li><a href="#orgd25c5c4">19.8.13.3. Options for ftp command</a></li>
</ul>
</li>
<li><a href="#org2504008">19.8.14. cp bash:cp</a></li>
<li><a href="#org9f92982">19.8.15. tar bash:tar</a>
<ul>
<li><a href="#org219bd48">19.8.15.1. Compress and Read .tar file</a></li>
<li><a href="#org0620246">19.8.15.2. Uncompress</a></li>
</ul>
</li>
<li><a href="#orge73da65">19.8.16. rsync</a>
<ul>
<li><a href="#orge23909c">19.8.16.1. Basic</a></li>
<li><a href="#orgb9175b2">19.8.16.2. Change summary, compare 2 directories</a></li>
<li><a href="#org8bdbdf3">19.8.16.3. Filter rules (INCLUDE/EXCLUDE Patterns)</a></li>
<li><a href="#orgd4a84cd">19.8.16.4. Examples</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org4e77dc4">19.9. head, tail bash:head linux:tail</a></li>
<li><a href="#org0ff10d4">19.10. Processes</a>
<ul>
<li><a href="#orgc4b0ccc">19.10.1. pgrep, pkill</a></li>
<li><a href="#orga903db5">19.10.2. Parent process linux:process:parent</a></li>
<li><a href="#orgd2a5a0c">19.10.3. Run executable in background for all sessions</a></li>
<li><a href="#orgf62664b">19.10.4. jobs</a></li>
<li><a href="#org5be6594">19.10.5. top linux:top</a></li>
<li><a href="#org43dbe73">19.10.6. Multiple commands &amp;&amp; vs || vs ;</a></li>
</ul>
</li>
<li><a href="#org4930dc3">19.11. Memory</a></li>
<li><a href="#org48ef0bc">19.12. Service</a></li>
<li><a href="#org184999c">19.13. Network</a>
<ul>
<li><a href="#org744f604">19.13.1. /etc/network/interfaces file</a></li>
<li><a href="#org1198835">19.13.2. DNS linux:dns</a></li>
<li><a href="#org51bd95f">19.13.3. Get Server's Public IP linux:get public ip</a></li>
<li><a href="#orgf56984b">19.13.4. CIDR Netmask (Network Mask)</a></li>
<li><a href="#org112300e">19.13.5. Port network:port</a></li>
<li><a href="#org925545e">19.13.6. Wireless network adapters <code>iwconfig</code></a></li>
<li><a href="#orgcfbaf84">19.13.7. Gather monthly bandwidth</a></li>
<li><a href="#org4852d68">19.13.8. Test email address if valid without sending</a></li>
</ul>
</li>
<li><a href="#org6183d61">19.14. Firewall linux:firewall linux:ufw</a></li>
<li><a href="#org7d7f602">19.15. Timezone, NTP</a></li>
<li><a href="#org317f189">19.16. Hardware</a></li>
<li><a href="#orgaf1ccbc">19.17. Package &amp; Repository</a>
<ul>
<li><a href="#org84d95b9">19.17.1. Package Management</a>
<ul>
<li><a href="#orgdef8c75">19.17.1.1. Debian only <code>yum</code></a></li>
<li><a href="#org80b2824">19.17.1.2. <code>dpkg</code> lowest level Ubuntu, Debian</a></li>
<li><a href="#org6b68c20">19.17.1.3. <code>apt-get</code> <code>apt-cache</code> Ubuntu</a></li>
<li><a href="#org3ce5ed2">19.17.1.4. <code>aptitude</code> Highest Level Debian</a></li>
</ul>
</li>
<li><a href="#org352cbe5">19.17.2. Ubuntu Packages</a>
<ul>
<li><a href="#orgb80c4a1">19.17.2.1. openssh-client linux:package:openssh-client</a></li>
<li><a href="#orga511f21">19.17.2.2. sendmail linux:sendmail</a></li>
<li><a href="#org8b3375c">19.17.2.3. ssmtp linux:ssmtp</a></li>
<li><a href="#orgc481bd9">19.17.2.4. postfix linux:postfix</a></li>
<li><a href="#org3fe0b8d">19.17.2.5. rtorrent</a></li>
</ul>
</li>
<li><a href="#org1eebe2d">19.17.3. Ubuntu troubleshooting</a>
<ul>
<li><a href="#org7a96c9e">19.17.3.1. Unmet dependencies</a></li>
<li><a href="#org6a659b4">19.17.3.2. /boot directory is full linux:disk full</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org82e7448">19.18. Bash File, Input and Output</a>
<ul>
<li><a href="#org10c1d4d">19.18.1. File Descriptors</a></li>
<li><a href="#orgd047d97">19.18.2. Array</a>
<ul>
<li><a href="#orgb687f1d">19.18.2.1. Associative array</a></li>
</ul>
</li>
<li><a href="#org0296d2a">19.18.3. echo and print</a></li>
<li><a href="#orga0b62a3">19.18.4. printf</a></li>
<li><a href="#orgd497ab7">19.18.5. Read command output line by line</a></li>
<li><a href="#org325f414">19.18.6. Multiple lines of text</a></li>
<li><a href="#orga01d080">19.18.7. Date format bash:date</a></li>
<li><a href="#org5648560">19.18.8. Last executed command</a></li>
<li><a href="#org62afba7">19.18.9. Passing arguments to command</a></li>
<li><a href="#orgcba228c">19.18.10. String Operators</a></li>
<li><a href="#orgea548ce">19.18.11. String comparison</a></li>
<li><a href="#orgf9b3570">19.18.12. Numeric comparison</a></li>
<li><a href="#orgb961924">19.18.13. Bash: shell variable with default value</a></li>
<li><a href="#org44a4523">19.18.14. Bash if</a></li>
<li><a href="#orgcf879f7">19.18.15. Special Parameters</a></li>
</ul>
</li>
<li><a href="#org31a2b3b">19.19. curl, wget</a>
<ul>
<li><a href="#org52e26e1">19.19.1. curl linux:curl</a>
<ul>
<li><a href="#orgd2ef0ed">19.19.1.1. Basic</a></li>
<li><a href="#orgde960b5">19.19.1.2. Return HTTP response header only</a></li>
<li><a href="#org25993be">19.19.1.3. Download with HTTPS or HTTP authentication</a></li>
<li><a href="#org26c248c">19.19.1.4. cURL download only after or before a date</a></li>
<li><a href="#org4bc2a9f">19.19.1.5. HTTP POST linux:curl:post</a></li>
<li><a href="#org13a4043">19.19.1.6. Use different IP address from DNS</a></li>
<li><a href="#org8841a86">19.19.1.7. Fetch as Googlebot curl:ua:googlebot</a></li>
<li><a href="#org63912dc">19.19.1.8. Options</a></li>
</ul>
</li>
<li><a href="#orgc24ba3b">19.19.2. wget bash:wget</a></li>
</ul>
</li>
<li><a href="#org226e4de">19.20. Cron linux:cron</a>
<ul>
<li><a href="#orgba8de11">19.20.1. Cron table (crontab)</a></li>
<li><a href="#orgc2b2c58">19.20.2. User crontab syntax and system-wide syntax</a></li>
<li><a href="#orgbb8f48f">19.20.3. Sample</a></li>
</ul>
</li>
<li><a href="#org8367bd7">19.21. upx linux:upx</a></li>
<li><a href="#org9091641">19.22. Commands</a>
<ul>
<li><a href="#orgb66a3d0">19.22.1. screen bash:screen</a></li>
<li><a href="#org732f080">19.22.2. Run Sequentially</a></li>
<li><a href="#orgee6294e">19.22.3. man bash:man</a></li>
<li><a href="#orgc576586">19.22.4. <code>cd -</code> Navigate to previous directory (back)</a></li>
<li><a href="#org6dadcc0">19.22.5. <code>wc</code></a></li>
<li><a href="#orgc8a8d1e">19.22.6. Replace String  <code>sed</code> bash:sed</a></li>
<li><a href="#org999ce58">19.22.7. Concatenate String with File</a></li>
<li><a href="#org0c8adf5">19.22.8. Change Encoding</a></li>
<li><a href="#org6b11d63">19.22.9. Comment out every line in a file and save as a new file</a></li>
<li><a href="#orgb97e7ed">19.22.10. sudo</a></li>
<li><a href="#orgb1ab41b">19.22.11. SHA, salt hashing image:lucee:salt</a></li>
<li><a href="#orgc92440a">19.22.12. byobu</a></li>
<li><a href="#org37cac1a">19.22.13. <code>w3m</code> Command line web browser</a></li>
<li><a href="#org59fe73d">19.22.14. set, &gt;</a></li>
</ul>
</li>
<li><a href="#org88c5dbe">19.23. Cheat</a></li>
<li><a href="#org40c71c2">19.24. Makefile linux:makefile</a>
<ul>
<li><a href="#org93c0783">19.24.1. Characters to escape</a></li>
</ul>
</li>
<li><a href="#orgb7e0989">19.25. Nano linux:nano</a></li>
<li><a href="#orgc205a1b">19.26. Ubuntu Unity</a></li>
<li><a href="#org267f6c3">19.27. Ubuntu Personal Package Archive PPA</a></li>
<li><a href="#org2812dcb">19.28. Production Server Setup</a></li>
</ul>
</li>
<li><a href="#org1173e60">20. Domain Server, DNS Server, SSL/https</a>
<ul>
<li><a href="#orgfd047d7">20.1. DNS records: A AAAA ANAME CNAME TXT ALIAS URL</a></li>
<li><a href="#orgf45181b">20.2. MX records and SPF record dns:mx</a></li>
<li><a href="#org23a537e">20.3. SOA record</a></li>
<li><a href="#org77a9c38">20.4. redirect.center, redirect.name</a></li>
<li><a href="#orgc5ab235">20.5. Domain Forwarding</a></li>
<li><a href="#org019e11f">20.6. Domain Transfer</a></li>
<li><a href="#orgc64391a">20.7. Addon domain</a></li>
<li><a href="#org03ac48b">20.8. Park domain</a></li>
<li><a href="#orgb006e69">20.9. DNS History, IP location</a></li>
<li><a href="#orgf84a7ef">20.10. AXFR and Find subdomains</a></li>
<li><a href="#org4eded1e">20.11. AutoSSL in WHM/cPanel autossl:whm</a></li>
<li><a href="#orge1905d5">20.12. Install SSL linux:ssl</a></li>
<li><a href="#org3a19e8a">20.13. SSL Testing Tools ssl:test</a></li>
</ul>
</li>
<li><a href="#org3158307">21. Docker</a>
<ul>
<li><a href="#org9a8101a">21.1. Version, Info, Installation</a>
<ul>
<li><a href="#org2fb948f">21.1.1. Without sudo</a></li>
<li><a href="#orgca5d479">21.1.2. Install on Digital Ocean</a></li>
</ul>
</li>
<li><a href="#orgcb7b2c0">21.2. Command Help <code>docker docker-subcommand --help</code></a></li>
<li><a href="#orgf2b4344">21.3. Images</a>
<ul>
<li><a href="#orgb2f8fe6">21.3.1. docker build, docker tag</a></li>
</ul>
</li>
<li><a href="#orgb7e1511">21.4. run</a>
<ul>
<li><a href="#orgd78729d">21.4.1. Interactive mode with tty <code>-it</code></a></li>
<li><a href="#orgf497c9b">21.4.2. Run an image in a container and keep running in background</a></li>
<li><a href="#org2cca2bd">21.4.3. Run an image in a temp container only once, then remove the container</a></li>
<li><a href="#orgec15a04">21.4.4. Link</a></li>
<li><a href="#org90d566c">21.4.5. &#x2013;name and &#x2013;hostname</a></li>
<li><a href="#orgc01d699">21.4.6. &#x2013;privileged</a></li>
</ul>
</li>
<li><a href="#org2aa85cb">21.5. Containers cp logs stats start stop restart rm inspect</a>
<ul>
<li><a href="#org2184098">21.5.1. docker inspect</a></li>
<li><a href="#org1fbae5f">21.5.2. docker events - Show docker system log</a></li>
<li><a href="#orga390385">21.5.3. docker cp</a></li>
<li><a href="#orgc27f979">21.5.4. docker stats</a></li>
<li><a href="#org89a397a">21.5.5. Save a running container to an image</a></li>
<li><a href="#orgdc85810">21.5.6. Execute commands inside a running container</a></li>
</ul>
</li>
<li><a href="#org8d358c8">21.6. Network</a></li>
<li><a href="#orgc04c182">21.7. My Network</a></li>
<li><a href="#org7b9bbcf">21.8. Volume</a></li>
<li><a href="#org624bf73">21.9. Dockerfile</a>
<ul>
<li><a href="#org7dee04c">21.9.1. CMD, RUN, ENTRYPOINT</a></li>
<li><a href="#orgc174968">21.9.2. ADD vs COPY</a></li>
<li><a href="#orgcad304b">21.9.3. Timezone docker:timezone</a></li>
<li><a href="#org4af82e0">21.9.4. ARG Debian (Jessie)</a>
<ul>
<li><a href="#org108e1f8">21.9.4.1. Predefined ARG variables</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgf224f22">21.10. Docker Compose</a>
<ul>
<li><a href="#org5e48c78">21.10.1. Ubuntu 16.04 Installation</a></li>
<li><a href="#orga3da460">21.10.2. YML</a>
<ul>
<li><a href="#org1aab85e">21.10.2.1. version (top level)</a></li>
<li><a href="#org1e6a237">21.10.2.2. volumes (top level)</a></li>
<li><a href="#orgd9b07e9">21.10.2.3. networks (top level) links (deprecated)</a></li>
<li><a href="#org24da7be">21.10.2.4. services</a></li>
<li><a href="#org79b7cf7">21.10.2.5. Resources</a></li>
<li><a href="#orgd533dba">21.10.2.6. Pass arguments from Compose to Dockerfile</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orga62fa59">21.11. Docker for Windows</a>
<ul>
<li><a href="#orga753387">21.11.1. PowerShell Auto Complete</a></li>
</ul>
</li>
<li><a href="#orge777b25">21.12. Docker Cloud</a></li>
<li><a href="#org3f81fd7">21.13. Common DevOps</a>
<ul>
<li><a href="#org8f30d1a">21.13.1. Files are in container</a>
<ul>
<li><a href="#orgd7c72a6">21.13.1.1. Makefile at remote Prod/Live host /root/Makefile</a></li>
<li><a href="#org7b73fa9">21.13.1.2. Sql dump inside container</a></li>
<li><a href="#org59519d4">21.13.1.3. local dev /root/Makefile</a></li>
</ul>
</li>
<li><a href="#org62d23a1">21.13.2. Check container status and restart services</a></li>
<li><a href="#org2cf9139">21.13.3. Replace string in .sql</a></li>
<li><a href="#org07bb747">21.13.4. Download files</a></li>
</ul>
</li>
<li><a href="#org45a4c88">21.14. image:debian:jessie - Debian 8 image:debian:jessie</a></li>
<li><a href="#orgb7a3e4a">21.15. image:debian:stretch - Debian 9 image:debian:stretch</a></li>
<li><a href="#orgdd1e25c">21.16. image:buildpack-deps:jessie-scm</a></li>
<li><a href="#orgaf2bef2">21.17. image:buildpack-deps:stretch-curl</a></li>
<li><a href="#orgc40703c">21.18. image:php:5.6.31-apache-jessie image:php:apache</a>
<ul>
<li><a href="#org1aaf5f7">21.18.1. Sample</a></li>
</ul>
</li>
<li><a href="#org050e1e0">21.19. image:php53</a>
<ul>
<li><a href="#org2f512c9">21.19.1. image:bylexus:apache-php53</a></li>
<li><a href="#org9c0511e">21.19.2. image:orsolin/php:5.3-apache</a></li>
</ul>
</li>
<li><a href="#org704d292">21.20. image:php:7 image:php:7</a></li>
<li><a href="#orga922bd3">21.21. image:mysql:5.7.9 image:mysql</a>
<ul>
<li><a href="#org15f1828">21.21.1. Load configs</a></li>
<li><a href="#orgb5145c4">21.21.2. Environment vars</a></li>
<li><a href="#org76c13a0">21.21.3. Import .sql on image startup</a></li>
<li><a href="#org8058f15">21.21.4. Access, view logs, db dump</a></li>
<li><a href="#org25d7ac1">21.21.5. Persist data</a></li>
<li><a href="#org5a7bb8e">21.21.6. Example</a></li>
</ul>
</li>
<li><a href="#org546a432">21.22. image:wordpress</a>
<ul>
<li><a href="#org73fdc91">21.22.1. docker-compose.yml</a></li>
</ul>
</li>
<li><a href="#org058609c">21.23. image:drupal</a>
<ul>
<li><a href="#org7225e7c">21.23.1. docker-compose.yml</a></li>
</ul>
</li>
<li><a href="#org80bd8f8">21.24. image:tatemz/wp-cli image:tatemz/wp-cli</a></li>
<li><a href="#org66f5740">21.25. image:wordpress:cli image:wordpress:cli</a></li>
<li><a href="#orgbaa83f5">21.26. image:lucee docker:image:lucee</a>
<ul>
<li><a href="#org4988000">21.26.1. docker-compose.yml Dockerfile</a></li>
<li><a href="#org4128ac7">21.26.2. Add ucanaccess db driver to TomCat, Add M$ Access Datasources</a></li>
<li><a href="#org4c11974">21.26.3. Lucee server and web settings</a></li>
<li><a href="#org0968a01">21.26.4. Custom tags (.cfm|.cfc) under <i>opt/lucee/web/customtags</i></a></li>
<li><a href="#org0e7fa1e">21.26.5. Change Lucee Server Admin UI password</a></li>
<li><a href="#org996f068">21.26.6. How does it work with Nginx?</a></li>
<li><a href="#org2a2129a">21.26.7. Virtual Directory and TomCat</a></li>
<li><a href="#org7a74966">21.26.8. Add hosts</a></li>
<li><a href="#orge3d913d">21.26.9. Scheduled Tasks</a></li>
</ul>
</li>
<li><a href="#org92ac674">21.27. image:tomcat</a>
<ul>
<li><a href="#org8b2d81b">21.27.1. Settings</a></li>
<li><a href="#orgba8c2b2">21.27.2. Install UcanAccess JDBC driver to enable M$ Access datasource</a></li>
<li><a href="#org254325a">21.27.3. Setup Virtual Directory per Host docker:image:tomcat:vd</a></li>
<li><a href="#org6486f5f">21.27.4. Add host docker:image:tomcat:host</a></li>
<li><a href="#org29c98db">21.27.5. Restrict Access</a></li>
<li><a href="#orgd4c4ce9">21.27.6. Logging</a></li>
</ul>
</li>
<li><a href="#org1b9e76d">21.28. image:stilliard/pure-ftpd docker:image:ftp</a></li>
<li><a href="#org161d103">21.29. image:dockerfile-from-image</a></li>
<li><a href="#orgf3eeb01">21.30. image:ubuntu</a></li>
<li><a href="#org5ef07cc">21.31. image:node</a></li>
<li><a href="#org2ed8aa1">21.32. image:golang</a></li>
</ul>
</li>
<li><a href="#orgb943c13">22. Jenkins</a>
<ul>
<li><a href="#orgc65d1b5">22.1. Install</a></li>
<li><a href="#org2442c85">22.2. config</a></li>
<li><a href="#orgd352f72">22.3. Builds</a></li>
</ul>
</li>
<li><a href="#orga2be444">23. Go</a>
<ul>
<li><a href="#org0bad04f">23.1. Basics, Command</a>
<ul>
<li><a href="#orgef1545f">23.1.1. go run -race *.go</a></li>
</ul>
</li>
<li><a href="#orgcd79cb8">23.2. Syntax, Program Flow</a></li>
<li><a href="#orga0629a1">23.3. Standard Library of packages</a>
<ul>
<li><a href="#orgc5a863b">23.3.1. builtin</a>
<ul>
<li><a href="#org6dbf61e">23.3.1.1. new(), make()</a></li>
</ul>
</li>
<li><a href="#orgb86a478">23.3.2. fmt</a>
<ul>
<li><a href="#orgaff4996">23.3.2.1. Output</a></li>
<li><a href="#org14d5424">23.3.2.2. Input</a></li>
</ul>
</li>
<li><a href="#orgd8d718a">23.3.3. strings</a></li>
<li><a href="#orgd99589b">23.3.4. math</a></li>
<li><a href="#orgdc0e330">23.3.5. time</a></li>
<li><a href="#org715ea6b">23.3.6. sort</a></li>
<li><a href="#org4ba581e">23.3.7. io, os, path</a></li>
<li><a href="#orgab1ec6e">23.3.8. path/filepath</a></li>
<li><a href="#org9bce77f">23.3.9. encoding/json, encoding/csv</a></li>
<li><a href="#orgc086190">23.3.10. log</a></li>
<li><a href="#orgde312ed">23.3.11. os/exec</a>
<ul>
<li><a href="#org917e32c">23.3.11.1. Basics</a></li>
<li><a href="#orgab2160a">23.3.11.2. SSH command</a></li>
<li><a href="#org623070e">23.3.11.3. Cmd</a></li>
</ul>
</li>
<li><a href="#orgc9ad966">23.3.12. net/http</a>
<ul>
<li><a href="#org22ce0e9">23.3.12.1. HTTP request</a></li>
<li><a href="#org3dc4c32">23.3.12.2. HTTP server</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org3ae5abe">23.4. Custom package, Third Party Package</a></li>
<li><a href="#org4baffff">23.5. Types</a>
<ul>
<li><a href="#org85235fb">23.5.1. Basic</a></li>
<li><a href="#orga20fc80">23.5.2. array</a></li>
<li><a href="#org5b65f96">23.5.3. slice</a></li>
<li><a href="#orgb9c353f">23.5.4. map</a></li>
<li><a href="#orgf5fa869">23.5.5. struct, interface</a></li>
<li><a href="#org68738c1">23.5.6. pointer</a></li>
<li><a href="#org7cfe0c9">23.5.7. error</a></li>
</ul>
</li>
<li><a href="#org0af0273">23.6. Concurrency</a></li>
<li><a href="#org86ca163">23.7. Structure</a></li>
<li><a href="#orgbb8f39f">23.8. Shrink compiled binary file size</a></li>
<li><a href="#orga876e57">23.9. Project project:golang</a>
<ul>
<li><a href="#org3bd5901">23.9.1. Github Webhook</a></li>
</ul>
</li>
<li><a href="#orgc1b817b">23.10. To Learn</a></li>
</ul>
</li>
<li><a href="#org91cffc7">24. Vagrant</a>
<ul>
<li><a href="#org8cdbdac">24.1. Install</a></li>
<li><a href="#orgb5de0e9">24.2. Vagrant VM, VirtualBox</a></li>
<li><a href="#org4ba8232">24.3. Frequent commands</a></li>
<li><a href="#org9a80617">24.4. Vagrantfile</a></li>
<li><a href="#org5fb8eb4">24.5. Vagrant plugin</a></li>
<li><a href="#orgb25222a">24.6. Box</a>
<ul>
<li><a href="#org3a62840">24.6.1. bento/ubuntu-16.04</a></li>
</ul>
</li>
<li><a href="#org8b467b6">24.7. Custom Box</a></li>
<li><a href="#orga551849">24.8. SSH using Putty</a></li>
</ul>
</li>
<li><a href="#org8a6d88e">25. Apache</a>
<ul>
<li><a href="#org4ef2066">25.1. Basics</a></li>
<li><a href="#org2a700f8">25.2. Config loading apache:config</a>
<ul>
<li><a href="#org68182c4">25.2.1. Loaded Modules</a></li>
<li><a href="#orge2f8986">25.2.2. sites-enabled VirtualHost</a></li>
<li><a href="#orgd54b28e">25.2.3. Main Config files apache:config:main file</a></li>
<li><a href="#orgc0c4986">25.2.4. Restart apache:restart</a></li>
</ul>
</li>
<li><a href="#orgfdd122d">25.3. Modules</a>
<ul>
<li><a href="#orged61805">25.3.1. remoteip</a></li>
<li><a href="#org96fb9b1">25.3.2. mod_setenvif</a></li>
<li><a href="#orgc74c57f">25.3.3. mod_headers apache:mod_headers</a></li>
<li><a href="#org92ddf95">25.3.4. mod_include</a></li>
<li><a href="#orgddb5a4c">25.3.5. mod_rewrite</a>
<ul>
<li><a href="#org7c24a86">25.3.5.1. RewriteBase apache:RewriteBase</a></li>
<li><a href="#org8325cd5">25.3.5.2. RewriteCond apache:RewriteCond</a></li>
<li><a href="#orgeed3355">25.3.5.3. Server-Variables</a></li>
<li><a href="#org12c83c1">25.3.5.4. RewriteCond Flags</a></li>
<li><a href="#orge564208">25.3.5.5. RewriteRule apache:RewriteRule</a></li>
<li><a href="#org46aea7b">25.3.5.6. RewriteRule Flags apache:RewriteRule:flags</a></li>
<li><a href="#orgbedc6df">25.3.5.7. ReWrite a path to sub directory with .htaccess</a></li>
<li><a href="#org985090d">25.3.5.8. WordPress Example</a></li>
</ul>
</li>
<li><a href="#org36efa4a">25.3.6. mod_autoindex</a></li>
<li><a href="#orgc2b4790">25.3.7. mod_mime</a>
<ul>
<li><a href="#org6fd7bbc">25.3.7.1. AddType TypesConfig apache:mod_mime:addtype</a></li>
<li><a href="#org68d6a09">25.3.7.2. AddEncoding</a></li>
</ul>
</li>
<li><a href="#orga74c17e">25.3.8. mod_filter</a>
<ul>
<li><a href="#org322e2d7">25.3.8.1. AddOutputFilterByType apache:mod_filter:addoutputfilterbytype</a></li>
</ul>
</li>
<li><a href="#orgdd964fd">25.3.9. mod_alias</a>
<ul>
<li><a href="#org8f11d93">25.3.9.1. Redirect apache:mode_alias:Redirect</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org6418441">25.4. Directive Context apache:directive context</a></li>
<li><a href="#org22288cf">25.5. Core Directives</a>
<ul>
<li><a href="#org2ea2d55">25.5.1. AllowOverride apache:core:allowoverride</a></li>
<li><a href="#org630fd5c">25.5.2. FilesMatch</a></li>
</ul>
</li>
<li><a href="#org3258935">25.6. LogLevel</a></li>
<li><a href="#org695d97f">25.7. LogFormat</a></li>
<li><a href="#orge42bdb3">25.8. Basic authentication</a>
<ul>
<li><a href="#org63a45dd">25.8.1. Option 1: control access within Virutal Host Definition</a></li>
<li><a href="#org8f7bc6b">25.8.2. Option 2: control access with .htaccess</a></li>
</ul>
</li>
<li><a href="#orgbc12729">25.9. Production Setup apache:production</a></li>
<li><a href="#org0f1adec">25.10. Force redirect from non www to www</a></li>
<li><a href="#orgce08dc4">25.11. Force redirect to https .htaccess</a></li>
<li><a href="#orge68417b">25.12. Restrict access to a file or sub folder</a></li>
<li><a href="#orgf7b10af">25.13. WebP</a></li>
<li><a href="#org90c701c">25.14. SSL apache:ssl</a></li>
<li><a href="#org1688f4e">25.15. Redirect to HTTPS apache:https</a></li>
</ul>
</li>
<li><a href="#orga8fb584">26. Nginx</a>
<ul>
<li><a href="#org5954ffa">26.1. Install on Ubuntu 16.04</a>
<ul>
<li><a href="#org264f336">26.1.1. Config Firewall nginx:ufw</a></li>
<li><a href="#org523d915">26.1.2. Service Check, reload, restart, Check syntax</a></li>
</ul>
</li>
<li><a href="#org02a4b6d">26.2. /etc/nginx /var/log/nginx</a>
<ul>
<li><a href="#orgbc90dd3">26.2.1. <i>etc/nginx/sites-available</i></a></li>
<li><a href="#org24e80f1">26.2.2. <i>etc/nginx/sites-enabled</i></a></li>
<li><a href="#org3a7a49a">26.2.3. <i>etc/nginx/snippets</i></a></li>
<li><a href="#orgda2be27">26.2.4. /var/log/nginx/access.log</a></li>
<li><a href="#org47a0c54">26.2.5. /var/log/nginx/error.log</a></li>
</ul>
</li>
<li><a href="#orgf52423e">26.3. Config nginx.conf</a></li>
<li><a href="#orgbf9e181">26.4. server Block</a></li>
<li><a href="#org8cfb240">26.5. location block</a></li>
<li><a href="#orgf27379a">26.6. proxy_pass directive</a>
<ul>
<li><a href="#org6dbcc39">26.6.1. Basic</a></li>
<li><a href="#org208b527">26.6.2. Sample</a></li>
<li><a href="#org08bb710">26.6.3. Sample: Redirect a path to a different proxy nginx:redirect path to proxy</a></li>
</ul>
</li>
<li><a href="#org68ef768">26.7. Rewrite Directive</a></li>
<li><a href="#org0e463c4">26.8. listen Directive</a></li>
<li><a href="#org684e6bf">26.9. Server name redirect</a></li>
<li><a href="#org95261e2">26.10. Let's Encrypt SSL nginx:ssl</a>
<ul>
<li><a href="#orga1ff729">26.10.1. Challenges</a></li>
<li><a href="#org9e5875a">26.10.2. certbot nginx apache plugins</a></li>
<li><a href="#org36ec427">26.10.3. certbot manual plugin</a>
<ul>
<li><a href="#orgb72f852">26.10.3.1. Example usage for DNS-01</a></li>
</ul>
</li>
<li><a href="#orge2d7f18">26.10.4. certbot standalone plugin</a></li>
<li><a href="#orgdfdfc0c">26.10.5. certbot webroot plugin</a></li>
<li><a href="#orgd12940b">26.10.6. certbot manage and renew certificates</a>
<ul>
<li><a href="#org6beff1b">26.10.6.1. Hooks</a></li>
<li><a href="#org1a08841">26.10.6.2. Renewal conf</a></li>
</ul>
</li>
<li><a href="#orgc553016">26.10.7. A certificate nginx:ssl:example</a></li>
<li><a href="#orgc339acf">26.10.8. Windows IIS</a></li>
<li><a href="#org1c66384">26.10.9. Alternative clients (ACME Clients)</a></li>
<li><a href="#orgec54ba1">26.10.10. Limitation</a></li>
<li><a href="#orge325d20">26.10.11. SSL config nginx:ssl:config</a>
<ul>
<li><a href="#org8f3a729">26.10.11.1. Combine end-user and bundled intermediate certificates</a></li>
<li><a href="#orgb6c7a8d">26.10.11.2. Strengthen Nginx SSL Setup</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2d1e5e8">27. Web Application Firewall (WAF)</a>
<ul>
<li><a href="#orgcef89e5">27.1. ModSecurity waf:modsecurity</a></li>
</ul>
</li>
<li><a href="#orge2f8ec6">28. Git</a>
<ul>
<li><a href="#orgd8915bb">28.1. Show config</a></li>
<li><a href="#org3593eaa">28.2. Working Tree git:Working_Tree</a></li>
<li><a href="#org6aaed53">28.3. diff</a></li>
<li><a href="#orga42f680">28.4. Show file names only between 2 commits</a></li>
<li><a href="#orgfe7c3c2">28.5. Stash, Reset, Clean</a></li>
<li><a href="#orgd724276">28.6. Commit an empty folder</a></li>
<li><a href="#orgd71ce6d">28.7. Checkout vs Reset vs Revert</a></li>
<li><a href="#orgaa9a113">28.8. Checkout a folder from another branch to current branch</a></li>
<li><a href="#org9283883">28.9. Branch</a>
<ul>
<li><a href="#orgcd8042d">28.9.1. Duplicate current branch with changes and switch to it</a></li>
<li><a href="#orge1ae62b">28.9.2. Duplicate current branch to a commit and switch</a></li>
<li><a href="#orgd0a5eae">28.9.3. Delete branch</a></li>
<li><a href="#orgf97b937">28.9.4. Rename current branch</a></li>
<li><a href="#orgfc740de">28.9.5. Commit difference between 2 branches</a></li>
<li><a href="#org829529c">28.9.6. File difference between 2 branches</a></li>
<li><a href="#orgbb5303b">28.9.7. Find authors of all remote/local branches and tags</a></li>
<li><a href="#orgaba718d">28.9.8. Make current branch exactly as another branch</a></li>
<li><a href="#org503e295">28.9.9. Force push to remote branch</a></li>
<li><a href="#org9a1cacf">28.9.10. Find most recent ancestor of 2 branches</a></li>
<li><a href="#org45800ca">28.9.11. Revert to common ancestor</a></li>
<li><a href="#orgafabbc5">28.9.12. Orphan Branch with no parent</a></li>
</ul>
</li>
<li><a href="#orgcdffa89">28.10. Merge</a>
<ul>
<li><a href="#orgdebcd79">28.10.1. &#x2013;no-commit vs &#x2013;squash</a></li>
<li><a href="#org44ab724">28.10.2. Abort merge</a></li>
</ul>
</li>
<li><a href="#orgfc9ac08">28.11. Rebase</a>
<ul>
<li><a href="#org540f07b">28.11.1. Merge commits into one commit on local branch</a></li>
</ul>
</li>
<li><a href="#org4c827ca">28.12. Show merge commit</a></li>
<li><a href="#org8f9a726">28.13. Fork</a></li>
<li><a href="#org30a0159">28.14. Remove tracking for commited files</a></li>
<li><a href="#orge5a7e0c">28.15. Remove a commited file from file but leave in filesystem</a></li>
<li><a href="#orga1a2215">28.16. Remove large files and folders</a></li>
<li><a href="#orgec85d12">28.17. Commit History</a></li>
<li><a href="#org496e3a2">28.18. Head Detached Mode, checkout previous commit</a></li>
<li><a href="#orgda34908">28.19. Local Ignore, Global Ignore, git status -u</a>
<ul>
<li><a href="#orgaf6d555">28.19.1. WordPress .gitignore git:gitignore:wordpress</a></li>
<li><a href="#orge52a1f8">28.19.2. NodeJS, NPM .gitignore</a></li>
</ul>
</li>
<li><a href="#org68128a6">28.20. Customize Settings per folder</a></li>
<li><a href="#orgdf22964">28.21. Git Windows</a>
<ul>
<li><a href="#org6310a81">28.21.1. Line Feed, Long Path</a></li>
<li><a href="#orgb0746eb">28.21.2. Special characters in filename</a></li>
<li><a href="#org42e24d8">28.21.3. File name case-insensitive</a></li>
</ul>
</li>
<li><a href="#orgaad7bb5">28.22. Multiple Github accounts and https</a></li>
<li><a href="#org5c514da">28.23. Clone to an empty folder</a></li>
<li><a href="#orga7e04f6">28.24. Clone or Pull to existing repository</a>
<ul>
<li><a href="#org4154fe9">28.24.1. Existing repo is not git initialized</a></li>
<li><a href="#orge2b9fce">28.24.2. Existing repo is git initialized</a></li>
</ul>
</li>
<li><a href="#org373ef4a">28.25. Clone a subdirectory</a></li>
<li><a href="#org463d811">28.26. Track local branch with a remote branch git:upstream</a></li>
<li><a href="#orga607a18">28.27. List all remote repo</a></li>
<li><a href="#org21bb899">28.28. Repo size, maintenance git:repo size</a></li>
<li><a href="#org9e2dfaa">28.29. Number of tracked files</a></li>
<li><a href="#org262a868">28.30. GitHub Push to New Repo with local repo</a></li>
<li><a href="#org1bf664a">28.31. Add a remote, remove a remote and its branches, change upstream</a></li>
<li><a href="#org5b0bb6a">28.32. Push to 2 remotes</a></li>
<li><a href="#org89c2c16">28.33. Tag</a></li>
<li><a href="#org69fcc14">28.34. Submodule</a></li>
<li><a href="#org24a767c">28.35. Github API</a></li>
<li><a href="#orga595284">28.36. Github Pages</a>
<ul>
<li><a href="#org11000e6">28.36.1. SVG, View HTML</a></li>
<li><a href="#org481b834">28.36.2. Markdown</a></li>
</ul>
</li>
<li><a href="#org86d0f7d">28.37. Troubleshooting</a>
<ul>
<li><a href="#org74ad956">28.37.1. unable to create thread: Resource temporarily unavailable</a></li>
<li><a href="#org96169b8">28.37.2. warning: suboptimal pack - out of memory</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgcd6b261">29. BitBucket</a>
<ul>
<li><a href="#org6affe10">29.1. Basic</a></li>
</ul>
</li>
<li><a href="#org15f1c31">30. Pantheon hosting:pantheon</a>
<ul>
<li><a href="#orgef07ac2">30.1. Deploy</a></li>
<li><a href="#orgca7b1c6">30.2. pantheon.yml</a></li>
<li><a href="#orga7fd391">30.3. Drush Pantheon Drush</a></li>
<li><a href="#org781378f">30.4. WP CLI WP CLI Pantheon</a></li>
<li><a href="#orga2f3daf">30.5. Drupal Core Update</a>
<ul>
<li><a href="#orgea8b3af">30.5.1. UI</a></li>
<li><a href="#org6c42a00">30.5.2. Manual pull from upstream to resolve conflicts</a></li>
</ul>
</li>
<li><a href="#org7755ec9">30.6. Drupal Cron</a></li>
<li><a href="#orge8bb480">30.7. Determine Environment pantheon:environment</a></li>
<li><a href="#org54f5fba">30.8. Disable Newrelic</a></li>
<li><a href="#org77f8d75">30.9. Cookie pantheon:cookie</a></li>
<li><a href="#orgbf303e6">30.10. Domain</a></li>
<li><a href="#orgeb07af6">30.11. Global CDN</a></li>
<li><a href="#orgb467978">30.12. HTTPS</a>
<ul>
<li><a href="#org95e3de6">30.12.1. Redirect to HTTPS</a></li>
<li><a href="#org82c1956">30.12.2. HSTS: HTTP Header</a></li>
</ul>
</li>
<li><a href="#orgd2edb20">30.13. Varnish pantheon:varnish</a></li>
<li><a href="#orgd1107bb">30.14. Object Cache - Redis</a></li>
<li><a href="#org8d12f0e">30.15. Clear Cache</a></li>
</ul>
</li>
<li><a href="#org24ce206">31. AWS</a>
<ul>
<li><a href="#org67ceff6">31.1. SSH aws:ssh</a></li>
<li><a href="#org78f5306">31.2. Amazon Linux AMI</a>
<ul>
<li><a href="#orgf2e739c">31.2.1. Update an instance</a></li>
</ul>
</li>
<li><a href="#org4f03396">31.3. S3 aws:s3</a>
<ul>
<li><a href="#org3bfef1e">31.3.1. Storage Classes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org5e3993e">32. Database</a>
<ul>
<li><a href="#orgac47c13">32.1. Basics</a>
<ul>
<li><a href="#org1949048">32.1.1. Modeling Optimization</a></li>
<li><a href="#orgba596b4">32.1.2. Transaction and ACID</a></li>
<li><a href="#org5bdf24e">32.1.3. Index</a></li>
</ul>
</li>
<li><a href="#org85ae600">32.2. Access</a>
<ul>
<li><a href="#org12bd874">32.2.1. Null</a></li>
<li><a href="#orgc3de8c4">32.2.2. Coldfusion Datetime</a></li>
<li><a href="#org584defe">32.2.3. Random Order</a></li>
<li><a href="#orgaf071ce">32.2.4. Troubleshooting</a>
<ul>
<li><a href="#org9f78109">32.2.4.1. "Record is too large"</a></li>
<li><a href="#org01fad68">32.2.4.2. "Application uses a value of the wrong type for the current operation"</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org7e57eb1">32.3. MySQL</a>
<ul>
<li><a href="#org711f121">32.3.1. Version, Settings, Global variables mysql:config</a>
<ul>
<li><a href="#orgc1df9cf">32.3.1.1. Minimum</a></li>
<li><a href="#orgb374346">32.3.1.2. charset, collation mysql:charset mysql:collation</a></li>
<li><a href="#org46b169b">32.3.1.3. Memory, InnoDB Buffer, packet</a></li>
<li><a href="#orgd1f4f5f">32.3.1.4. Last Update time for a table in a database</a></li>
<li><a href="#org61b5143">32.3.1.5. Query Log</a></li>
</ul>
</li>
<li><a href="#orgcaa2e3a">32.3.2. Install</a>
<ul>
<li><a href="#org7e3fc1e">32.3.2.1. MySQL does not start after installation, Ubuntu</a></li>
<li><a href="#org800b577">32.3.2.2. Reset root password, Ubuntu</a></li>
</ul>
</li>
<li><a href="#org5eb5b12">32.3.3. Data Types</a>
<ul>
<li><a href="#orgc15bd87">32.3.3.1. MySQL Integer</a></li>
<li><a href="#orgbd5ea8c">32.3.3.2. MySQL Date and Time</a></li>
<li><a href="#org43f437c">32.3.3.3. MySQL String</a></li>
<li><a href="#org224c525">32.3.3.4. MySQL Null</a></li>
</ul>
</li>
<li><a href="#org0208743">32.3.4. REGEXP MySQL REGEX</a></li>
<li><a href="#org9f98c76">32.3.5. Update Fields in Multiple Tables</a></li>
<li><a href="#org9164d71">32.3.6. LIMIT in Sub Query</a></li>
<li><a href="#org0357da8">32.3.7. EXISTS</a></li>
<li><a href="#orgd3431de">32.3.8. UNION</a></li>
<li><a href="#org28c85ac">32.3.9. CASE, IF(), IFNULL(), NULLIF()</a></li>
<li><a href="#org5303d74">32.3.10. Concatenate values of a column across multiple rows about the same record mysql:concat columns</a>
<ul>
<li><a href="#org150afa6">32.3.10.1. Concatenate strings, use a different separator</a></li>
</ul>
</li>
<li><a href="#orga353345">32.3.11. User Variable</a></li>
<li><a href="#orgb453adf">32.3.12. Routines</a></li>
<li><a href="#org977d4c8">32.3.13. Procedure</a>
<ul>
<li><a href="#orgdef4d93">32.3.13.1. Syntax</a></li>
<li><a href="#org25a8239">32.3.13.2. Prepare Statement, Convert delimited string into temp table</a></li>
</ul>
</li>
<li><a href="#org4b10eec">32.3.14. User Defined Function mysql:udf</a></li>
<li><a href="#orgc8b0587">32.3.15. SQL Fiddle mysqlfiddle</a></li>
<li><a href="#orgab06f6f">32.3.16. Dump, Restore</a></li>
<li><a href="#orga135220">32.3.17. Binary Log</a></li>
<li><a href="#orge37776e">32.3.18. phpMyAdmin</a></li>
<li><a href="#org32c098d">32.3.19. Adminer db:adminer</a></li>
</ul>
</li>
<li><a href="#org4f8454b">32.4. MSSQL</a>
<ul>
<li><a href="#orge366d1c">32.4.1. Modify column values if exist (CASE WHEN)</a></li>
<li><a href="#org16f5302">32.4.2. Concatenate Multiple Columns to Single Column as String</a>
<ul>
<li><a href="#org9b9c678">32.4.2.1. STUFF</a></li>
</ul>
</li>
<li><a href="#org31faeb7">32.4.3. Export as CSV - BCP mssql:bcp</a>
<ul>
<li><a href="#org5e72105">32.4.3.1. Escape % if bcp is in batch file</a></li>
<li><a href="#org0e8b0a4">32.4.3.2. Save long query in Global Temporary table (GTT)</a></li>
<li><a href="#org399ee8f">32.4.3.3. Get all columns</a></li>
<li><a href="#orgdfd1c8f">32.4.3.4. Last step</a></li>
</ul>
</li>
<li><a href="#orgbf2a947">32.4.4. Export as XML</a>
<ul>
<li><a href="#org0d33a70">32.4.4.1. Query</a></li>
<li><a href="#org7e2b11d">32.4.4.2. Different modes</a></li>
<li><a href="#org7c294b2">32.4.4.3. bcp</a></li>
<li><a href="#orgfbf5106">32.4.4.4. bcp clean up</a></li>
</ul>
</li>
<li><a href="#orgf321339">32.4.5. Copy to Excel</a></li>
<li><a href="#org3aadb4b">32.4.6. Migrate to MySQL</a></li>
<li><a href="#org0a948ad">32.4.7. Connections</a></li>
<li><a href="#orga676a51">32.4.8. Last access</a></li>
<li><a href="#org308efb2">32.4.9. Backup</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org378bf2a">33. DFP</a>
<ul>
<li><a href="#org2a3477e">33.1. Why async is required</a></li>
<li><a href="#org6328bc3">33.2. Competition Calculation</a></li>
<li><a href="#orge0c7e6d">33.3. Key-Value Targeting</a></li>
<li><a href="#org0ec1c26">33.4. Exclusive Ads on Specific Page</a></li>
<li><a href="#org8d0d2c0">33.5. DFP in email</a></li>
<li><a href="#org1548af4">33.6. Responsive</a></li>
<li><a href="#orgcd8ba8e">33.7. Macro in Third Party Code, Custom Code</a></li>
<li><a href="#org827e156">33.8. Creative Type: Third Party Code - Video</a></li>
<li><a href="#orgdaa7c7e">33.9. Creative Type: HTML5</a></li>
<li><a href="#org2dc02ea">33.10. Creative Type: DoubleClick Tag, DCM Tag</a>
<ul>
<li><a href="#orga1123ff">33.10.1. Standard tags (ddm/jump, ddm/ad)</a></li>
<li><a href="#org95e9b19">33.10.2. iframe/javascript tags  (ddm/adi, ddm/adj)</a></li>
<li><a href="#orged30803">33.10.3. javascript (ddm/adj)</a></li>
<li><a href="#org3d2316f">33.10.4. Pre-fetch tags (ddm/pfadx)</a></li>
<li><a href="#orge63517f">33.10.5. Click tracker (ddm/clk)</a></li>
<li><a href="#orga5f0ded">33.10.6. Internal redirect tag</a></li>
<li><a href="#org47a19a9">33.10.7. Ins tag</a></li>
</ul>
</li>
<li><a href="#org03bae3e">33.11. Wallpaper, Site Skin</a></li>
<li><a href="#orgf75dc5c">33.12. Interstitial Ad</a></li>
<li><a href="#orgbc3c12e">33.13. Pre-roll or Linear Video Ad</a></li>
<li><a href="#orge5d4683">33.14. Native Ad, Native Styles, Custom Rendering</a></li>
<li><a href="#orgee323bd">33.15. SafeFrame API</a></li>
<li><a href="#org90c1c27">33.16. Events</a></li>
<li><a href="#org05f7102">33.17. Google Publisher Console</a></li>
<li><a href="#org7786f97">33.18. Passback tag</a></li>
<li><a href="#org28d5490">33.19. Downloaded impression</a></li>
<li><a href="#org793a1d8">33.20. Anti Adblocke</a></li>
<li><a href="#orgd4fd7c4">33.21. Benchmarks</a></li>
</ul>
</li>
<li><a href="#org39993d0">34. XML</a>
<ul>
<li><a href="#orgd5f2c2e">34.1. XML DOM</a>
<ul>
<li><a href="#org2f494bd">34.1.1. Navigate</a></li>
</ul>
</li>
<li><a href="#org0d46168">34.2. Do not parse &lt; and &amp;</a></li>
<li><a href="#orgae62668">34.3. Comment</a></li>
<li><a href="#org77f7634">34.4. XML newline is always LF</a></li>
<li><a href="#org351a401">34.5. XML Element node name can contain -, _ and . but not space</a></li>
<li><a href="#org78c8238">34.6. Attribute value should be HTML entity encoded</a></li>
<li><a href="#org97e9431">34.7. XML namespace</a></li>
<li><a href="#org761554e">34.8. XSLT</a></li>
<li><a href="#org37bd22e">34.9. Invalid characters xml:invalid_characters</a></li>
</ul>
</li>
<li><a href="#orgbcd9a82">35. DevOps</a>
<ul>
<li><a href="#orgc4da545">35.1. Knowledge</a></li>
<li><a href="#org096f367">35.2. Visual Regression Testing</a>
<ul>
<li><a href="#orge425b7a">35.2.1. Tools</a></li>
</ul>
</li>
<li><a href="#org5a709db">35.3. Code Linting</a></li>
<li><a href="#org8a2cd09">35.4. Security Scans</a></li>
<li><a href="#orgf571dec">35.5. Accessibility</a></li>
<li><a href="#org05cd0fb">35.6. Performance Testing</a></li>
<li><a href="#orge4a0851">35.7. Drupal</a></li>
<li><a href="#org8e5dec5">35.8. Ansible</a></li>
</ul>
</li>
<li><a href="#org762a3ed">36. Tools</a>
<ul>
<li><a href="#orgb9b0edb">36.1. phpStorm</a>
<ul>
<li><a href="#org7e1b1e9">36.1.1. Installation and 64 bit</a></li>
<li><a href="#org881daa3">36.1.2. Change config directories</a></li>
<li><a href="#org45c4a6e">36.1.3. Open big file</a>
<ul>
<li><a href="#orgad588d3">36.1.3.1. Plugin: JB SDK Bintray Downloader</a></li>
</ul>
</li>
<li><a href="#orgbbcd96a">36.1.4. Deployment</a></li>
<li><a href="#org0e9e86f">36.1.5. Find file</a></li>
<li><a href="#orga33ba41">36.1.6. HTML, CSS, Javascript</a>
<ul>
<li><a href="#org85c2a85">36.1.6.1. Show Applied Styles</a></li>
<li><a href="#orgc0375a7">36.1.6.2. CSS vendor prefix</a></li>
<li><a href="#orga2659e2">36.1.6.3. JavaScript version</a></li>
</ul>
</li>
<li><a href="#org2d5c2a6">36.1.7. Regex Find</a></li>
<li><a href="#org6d0ca35">36.1.8. XPath</a></li>
<li><a href="#org7fd9f13">36.1.9. Emmet</a>
<ul>
<li><a href="#org97f5616">36.1.9.1. How it works</a></li>
<li><a href="#org0cc3379">36.1.9.2. Surround with, wrap each line with a tag phpstorm:emmet:wrap</a></li>
<li><a href="#orga5036b0">36.1.9.3. Number $</a></li>
<li><a href="#orgeef9418">36.1.9.4. Repeat input * as $#</a></li>
<li><a href="#orgffcf158">36.1.9.5. Filters using Pipe(s)</a></li>
<li><a href="#org38ad528">36.1.9.6. HTML</a></li>
<li><a href="#org0083e82">36.1.9.7. CSS</a></li>
</ul>
</li>
<li><a href="#orgd851cc2">36.1.10. Show unprintable characters (TAB)</a></li>
<li><a href="#orgeffba08">36.1.11. Convert to Tab/Spaces for indentation</a></li>
<li><a href="#org7883dd4">36.1.12. Surround with&#x2026; - Shortcut Alt + Shift + Z or Ctrl + Alt + T phpstorm:surround with</a>
<ul>
<li><a href="#orgcea9435">36.1.12.1. Surround with Live Template</a></li>
<li><a href="#orga6a2684">36.1.12.2. Surround with Emmet phpstorm:emmet:wrap</a></li>
</ul>
</li>
<li><a href="#org365366f">36.1.13. File and Code Templates</a></li>
<li><a href="#org66599c2">36.1.14. Custom code folding regions</a></li>
<li><a href="#orgc779910">36.1.15. Multiple cursors, move cursor, selection</a></li>
<li><a href="#org4e0698f">36.1.16. Stop indexing for a directory</a></li>
<li><a href="#orgd72bb38">36.1.17. MySQL</a></li>
<li><a href="#org4d9d6da">36.1.18. Return all query results</a></li>
<li><a href="#orge557946">36.1.19. nodejs phpstorm:nodejs</a></li>
<li><a href="#orgd606f14">36.1.20. Golang Plugin phpstorm:golang</a></li>
<li><a href="#org437cb39">36.1.21. plugin - Makefile support</a></li>
<li><a href="#org9b1180b">36.1.22. plugin - Makefile Navigator</a></li>
<li><a href="#org75d0e97">36.1.23. Docker support</a></li>
<li><a href="#org979c6c1">36.1.24. Vue.js</a></li>
<li><a href="#org3ac70ac">36.1.25. TS: Reset Index</a></li>
</ul>
</li>
<li><a href="#orgf8996c8">36.2. Emacs</a>
<ul>
<li><a href="#orgac3dd27">36.2.1. Install &amp; Configuration</a></li>
<li><a href="#org8ec2e7e">36.2.2. MELPA packages</a></li>
<li><a href="#org544de7c">36.2.3. M-x</a></li>
<li><a href="#org56df70c">36.2.4. Basics</a></li>
<li><a href="#org115a8b9">36.2.5. Windows</a></li>
<li><a href="#org5bf1f58">36.2.6. Region (selection)</a></li>
<li><a href="#orgf5ef7fc">36.2.7. Copy &amp; Paste</a></li>
<li><a href="#org725cdd3">36.2.8. Search</a></li>
<li><a href="#org7aa6fc8">36.2.9. Headline emacs:headline</a>
<ul>
<li><a href="#orgee1edab">36.2.9.1. Drawer</a></li>
</ul>
</li>
<li><a href="#org9ca7356">36.2.10. Code Block</a></li>
<li><a href="#orgf0a3c24">36.2.11. Symbol and Escape emacs:escape</a></li>
<li><a href="#orgf22454e">36.2.12. <code>TODO</code></a></li>
<li><a href="#org89a8a90">36.2.13. Sparse Tree, Search</a></li>
<li><a href="#org06555a3">36.2.14. Link emacs:link</a></li>
<li><a href="#orgbe534d1">36.2.15. Superscript and Subscript</a></li>
<li><a href="#org388cc99">36.2.16. dot</a></li>
</ul>
</li>
<li><a href="#org0639215">36.3. Regex</a></li>
<li><a href="#org92ba2be">36.4. Chrome</a>
<ul>
<li><a href="#orgde445ab">36.4.1. Command Menu (DevTools &gt; C+S P)</a>
<ul>
<li><a href="#org4bf5002">36.4.1.1. Coverage (Show coverage)</a></li>
</ul>
</li>
<li><a href="#orgcc4d305">36.4.2. Console</a>
<ul>
<li><a href="#orgdf3c7b9">36.4.2.1. Console Commands</a></li>
<li><a href="#orga700842">36.4.2.2. Command Line API</a></li>
<li><a href="#org833eaa6">36.4.2.3. Inject CSS file in Console</a></li>
<li><a href="#org82dc1f2">36.4.2.4. Offload CSS file in Console</a></li>
</ul>
</li>
<li><a href="#org8371a46">36.4.3. Capture full size screenshot - Mobile View</a></li>
<li><a href="#org2cef034">36.4.4. Block Request or Domain - Network</a></li>
<li><a href="#org110bc3f">36.4.5. Get all events of an element in Console</a></li>
<li><a href="#org519057c">36.4.6. XPath XPath</a>
<ul>
<li><a href="#orgb8f7c6b">36.4.6.1. Axis Syntax</a></li>
<li><a href="#org7738d90">36.4.6.2. XPath Operators</a></li>
</ul>
</li>
<li><a href="#org0b2dff8">36.4.7. Turn on DevTools Experiment</a></li>
<li><a href="#orgc1f2da5">36.4.8. Elements</a>
<ul>
<li><a href="#org59378ea">36.4.8.1. Styles</a></li>
<li><a href="#org1e1f68f">36.4.8.2. Accessibility</a></li>
</ul>
</li>
<li><a href="#org2eb9c0b">36.4.9. Audits</a></li>
<li><a href="#org11d1248">36.4.10. Sources</a>
<ul>
<li><a href="#org791bc42">36.4.10.1. Local Overrides</a></li>
<li><a href="#org9f96474">36.4.10.2. Event Listener Breakpoints and Blackboxing</a></li>
</ul>
</li>
<li><a href="#org8194711">36.4.11. Extension</a>
<ul>
<li><a href="#org1d18a7d">36.4.11.1. Google Tag Assistant</a></li>
<li><a href="#org110082a">36.4.11.2. Postman</a></li>
<li><a href="#org17822bf">36.4.11.3. Save Page WE</a></li>
<li><a href="#org951e9bc">36.4.11.4. Ignore X-Frame headers</a></li>
<li><a href="#orgb8d1d3c">36.4.11.5. Requestly</a></li>
<li><a href="#org9c98907">36.4.11.6. aXe</a></li>
<li><a href="#orga91457d">36.4.11.7. jQuery Audit</a></li>
<li><a href="#orga58077a">36.4.11.8. Web Server for Chrome</a></li>
<li><a href="#orga122d64">36.4.11.9. Hosts file</a></li>
</ul>
</li>
<li><a href="#org0eaf9d1">36.4.12. Network</a>
<ul>
<li><a href="#orgcfe43a8">36.4.12.1. Filter Post Requests</a></li>
<li><a href="#org383ca60">36.4.12.2. Preserve log</a></li>
<li><a href="#org68df484">36.4.12.3. Capture Screeshots</a></li>
<li><a href="#orgd5a0db9">36.4.12.4. Network Performance</a></li>
</ul>
</li>
<li><a href="#org5198580">36.4.13. Performance</a></li>
<li><a href="#org1441fd5">36.4.14. Refresh Favicon</a></li>
<li><a href="#org3681fff">36.4.15. Flush DNS Caches in Chrome</a></li>
<li><a href="#org97c4e71">36.4.16. Flash Couldn't Load Plugin</a></li>
<li><a href="#org51ecefb">36.4.17. Allow XMLHttpRequest for local files</a></li>
<li><a href="#org83dac83">36.4.18. Allow CORS locally</a></li>
<li><a href="#orgd7f9bf9">36.4.19. Remote Debug Android Devices</a></li>
</ul>
</li>
<li><a href="#orgc7001d0">36.5. Firefox</a>
<ul>
<li><a href="#org88f6d0d">36.5.1. Make all new windows open in Private Mode</a></li>
</ul>
</li>
<li><a href="#orgd753382">36.6. BrowserStack</a></li>
<li><a href="#org3b81d2b">36.7. Device Market share, Metrics</a>
<ul>
<li><a href="#org32f717a">36.7.1. Browser</a></li>
<li><a href="#org5fad093">36.7.2. Device Metrics</a></li>
<li><a href="#orgfce12b1">36.7.3. Email Client Market Share</a></li>
</ul>
</li>
<li><a href="#org32f5d28">36.8. Windows</a>
<ul>
<li><a href="#org6085ffa">36.8.1. Win Shortcuts</a></li>
<li><a href="#org90452ff">36.8.2. Win 7</a></li>
<li><a href="#orgbd947ee">36.8.3. Win 10</a>
<ul>
<li><a href="#org06a01ba">36.8.3.1. Boot to Safe Mode with Boot Options Menu</a></li>
<li><a href="#org8b889b5">36.8.3.2. Install a printer loop in "Type a printer name"</a></li>
<li><a href="#orgb2ab0c3">36.8.3.3. Windows version Run `winver`</a></li>
<li><a href="#org1a42070">36.8.3.4. Upgrade from Windows 7</a></li>
<li><a href="#org9c648a4">36.8.3.5. Ubuntu Bash on Windows</a></li>
<li><a href="#org19786f9">36.8.3.6. Win 10 Build Update History</a></li>
<li><a href="#org295dfd5">36.8.3.7. Startup Programs and Change HOMEDRIVE, HOMEPATH</a></li>
<li><a href="#org8bb353e">36.8.3.8. Remove a keyboard</a></li>
<li><a href="#org67d4821">36.8.3.9. Move a window</a></li>
</ul>
</li>
<li><a href="#org74bfaed">36.8.4. Win Server 2003</a>
<ul>
<li><a href="#orgd75ab5d">36.8.4.1. System Information</a></li>
<li><a href="#orgdd504d2">36.8.4.2. Update_Windows.exe error</a></li>
</ul>
</li>
<li><a href="#org1eadb25">36.8.5. PowerSehll</a>
<ul>
<li><a href="#org93d9765">36.8.5.1. Get-Command - gcm</a></li>
<li><a href="#org686a5bd">36.8.5.2. Search text in files</a></li>
<li><a href="#orgcd913a3">36.8.5.3. Create script file</a></li>
</ul>
</li>
<li><a href="#org452d2f2">36.8.6. Wireless hotspot</a></li>
<li><a href="#org336f4df">36.8.7. SOCKS Proxy</a></li>
<li><a href="#org2d06278">36.8.8. Windows Virtual PC</a></li>
<li><a href="#org6664015">36.8.9. Find physical path by shared path</a></li>
<li><a href="#org349d795">36.8.10. Process Monitor procmon.exe</a></li>
<li><a href="#orgf96b8fb">36.8.11. Dosbox</a></li>
<li><a href="#orgd398f67">36.8.12. Batch Script</a>
<ul>
<li><a href="#org2ae8913">36.8.12.1. Setting</a></li>
<li><a href="#org844168c">36.8.12.2. Comment</a></li>
</ul>
</li>
<li><a href="#org53b1486">36.8.13. FART</a></li>
<li><a href="#org96c06e4">36.8.14. Windows Credential Store Panel Windows Credential Store Panel</a></li>
<li><a href="#orgd68d557">36.8.15. MAC address</a></li>
<li><a href="#orgf3a62e4">36.8.16. Meter an Ethernet Connection</a></li>
<li><a href="#org422f0d4">36.8.17. Troubleshoot "Installation Directory must be on a local hard drive"</a></li>
</ul>
</li>
<li><a href="#org85f043e">36.9. Exchange, Office</a>
<ul>
<li><a href="#orgee5d303">36.9.1. Exchange Online, Office 365</a>
<ul>
<li><a href="#orgc97c8d5">36.9.1.1. Shared Mailbox</a></li>
</ul>
</li>
<li><a href="#org0661aaa">36.9.2. SharePoint</a>
<ul>
<li><a href="#orgbbd57c7">36.9.2.1. Site Permissions</a></li>
</ul>
</li>
<li><a href="#org6ebdca7">36.9.3. Office 2016</a>
<ul>
<li><a href="#orgb29b816">36.9.3.1. One-time-purchase Office License</a></li>
<li><a href="#orge3b1033">36.9.3.2. Outlook</a></li>
<li><a href="#org8a7960e">36.9.3.3. OneNote</a></li>
<li><a href="#org05ed352">36.9.3.4. Troubleshooting</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org8f07dc1">36.10. Reflector, ILSpy and Reflexil</a></li>
<li><a href="#orgdfc2c96">36.11. Jira, YouTrack</a>
<ul>
<li><a href="#orgda2e65e">36.11.1. Jira</a>
<ul>
<li><a href="#org57d3c01">36.11.1.1. Agile</a></li>
<li><a href="#org2ef6909">36.11.1.2. Story</a></li>
<li><a href="#org25f5322">36.11.1.3. Kanban board</a></li>
</ul>
</li>
<li><a href="#org47bc81c">36.11.2. YouTrack</a>
<ul>
<li><a href="#orgdbecea6">36.11.2.1. Default field: State</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org9e1de58">36.12. Image</a>
<ul>
<li><a href="#org251f2fd">36.12.1. Sample Image</a>
<ul>
<li><a href="#org1f28d90">36.12.1.1. Placeholder.com</a></li>
<li><a href="#org6c00e07">36.12.1.2. Text with Transparency</a></li>
<li><a href="#org1a1ab18">36.12.1.3. Real Image - Picsum.photos</a></li>
<li><a href="#orgef30e7f">36.12.1.4. Free PNG with transparency</a></li>
</ul>
</li>
<li><a href="#orge2ce6d9">36.12.2. Convert image to favicon (.ico)</a></li>
<li><a href="#orge0bbb5a">36.12.3. WebP</a></li>
<li><a href="#org022d56c">36.12.4. Image Stock</a></li>
</ul>
</li>
<li><a href="#orgf49f82e">36.13. cPanel WHM</a>
<ul>
<li><a href="#org7c55b41">36.13.1. WHM Auto Backup</a></li>
<li><a href="#org1a1b9ae">36.13.2. WHM/cPanel DNS Record Files</a></li>
<li><a href="#org15c958b">36.13.3. WHM Add IP to Firewall - Permit SSH Access</a></li>
<li><a href="#org80b902e">36.13.4. WHM List of Accounts</a></li>
<li><a href="#orgd2e8b26">36.13.5. WHM Security Advisor</a></li>
<li><a href="#org7228c77">36.13.6. WHM Access</a></li>
<li><a href="#orgfdc99f1">36.13.7. SSH access</a></li>
<li><a href="#org7a79cb7">36.13.8. autossl:whm</a></li>
<li><a href="#org21cc965">36.13.9. Remote MySQL connection - cPanel</a></li>
<li><a href="#orge8a56a8">36.13.10. Access Log - cPanel</a></li>
<li><a href="#orgb7565a7">36.13.11. Root domain A record change - cPanel</a></li>
</ul>
</li>
<li><a href="#org36b618a">36.14. Hosting Comparison</a></li>
<li><a href="#org4ca45c2">36.15. Internet Trends, Internet Technology Trend</a></li>
<li><a href="#org0c3b936">36.16. Website Status</a></li>
<li><a href="#org0dfb71f">36.17. Website Security, Testing</a>
<ul>
<li><a href="#orgba8f124">36.17.1. XSS</a></li>
</ul>
</li>
<li><a href="#orgf0d9eb2">36.18. WCAG, AODA, Web Content Accessibility Guidelines</a>
<ul>
<li><a href="#org91dc0d0">36.18.1. &lt;a&gt;</a></li>
<li><a href="#org29d6999">36.18.2. iframe</a></li>
<li><a href="#org5d4f513">36.18.3. input, label</a></li>
<li><a href="#orgee886ce">36.18.4. pdf</a></li>
<li><a href="#org92cffd7">36.18.5. meta viewport</a></li>
<li><a href="#org23e144d">36.18.6. Skip to content link</a></li>
<li><a href="#org31a2290">36.18.7. Color Contrast Ratio</a></li>
</ul>
</li>
<li><a href="#orge2d5841">36.19. Screencast + Audio, FFmpeg</a></li>
<li><a href="#org8607bc5">36.20. Sketch Diagrams</a></li>
<li><a href="#org6eeb012">36.21. Video</a>
<ul>
<li><a href="#org5b2cdd3">36.21.1. Youtube Download</a></li>
<li><a href="#org474dc50">36.21.2. Kodi</a>
<ul>
<li><a href="#orga623b32">36.21.2.1. Settings</a></li>
<li><a href="#org2427b80">36.21.2.2. File Manager</a></li>
<li><a href="#org2022d9f">36.21.2.3. Addons</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgf0b03d2">36.22. Google</a>
<ul>
<li><a href="#orgfc88aaf">36.22.1. Google Public DNS</a></li>
<li><a href="#org7c4abe0">36.22.2. Google S2</a></li>
<li><a href="#org57a722e">36.22.3. Google reCaptcha</a>
<ul>
<li><a href="#org8a286b0">36.22.3.1. Client - Basic</a></li>
<li><a href="#orgfce6b57">36.22.3.2. Client - Defer loading, explict rendering one widget/instance</a></li>
<li><a href="#org28efb53">36.22.3.3. Client - Multiple reCaptcha widgets/instance</a></li>
<li><a href="#org4e66dcb">36.22.3.4. api.js options</a></li>
<li><a href="#orgb7d18fa">36.22.3.5. class="g-recaptcha" tag attributes</a></li>
<li><a href="#org2ca51d4">36.22.3.6. JavaScript API</a></li>
<li><a href="#org42fbf5f">36.22.3.7. Server Validation</a></li>
<li><a href="#org31aadc3">36.22.3.8. CSS</a></li>
</ul>
</li>
<li><a href="#org4182eb5">36.22.4. Google Search - Advanced</a></li>
<li><a href="#orga87c406">36.22.5. Google Ads Personalization Setting</a></li>
<li><a href="#org0bcbacc">36.22.6. Partners</a></li>
<li><a href="#org0f953bb">36.22.7. Gmail</a></li>
<li><a href="#org3608d46">36.22.8. Non-gmail email address as Google Account</a></li>
<li><a href="#orgb40b711">36.22.9. Google Surveys</a></li>
<li><a href="#org3aa16f7">36.22.10. Google Correlate</a></li>
<li><a href="#org3b205e8">36.22.11. Google Planning Tools</a></li>
<li><a href="#org5e1e84e">36.22.12. Tools for Web Developers</a>
<ul>
<li><a href="#orgfa1ff76">36.22.12.1. Lighthouse in DevTools chrome:lighthouse</a></li>
<li><a href="#org0e46073">36.22.12.2. Mobile-Friendly Test WebPageTest.org provided by Google</a></li>
<li><a href="#orgf9a2372">36.22.12.3. PageSpeed google:pagespeed</a></li>
<li><a href="#org39f536c">36.22.12.4. Fetch as Google google:search console</a></li>
<li><a href="#org5e73e6d">36.22.12.5. Rich Snippet Testing Tool, Structured Data Testing Tool google:json-ld</a></li>
<li><a href="#org45f6f2e">36.22.12.6. Google Site Status (security) google:site status</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org620acbd">36.23. Translation</a></li>
<li><a href="#org4e81463">36.24. HTML Minimizer, document.write</a></li>
<li><a href="#org88167ec">36.25. CloudConvert.com</a></li>
<li><a href="#orgba8ea2a">36.26. Online App Publishing</a>
<ul>
<li><a href="#org3162d4f">36.26.1. https://glitch.com</a></li>
<li><a href="#org417a56c">36.26.2. https://www.bitballoon.com</a></li>
<li><a href="#org813e068">36.26.3. https://zeit.co/</a></li>
</ul>
</li>
<li><a href="#org135c8fd">36.27. Email</a>
<ul>
<li><a href="#orgad4af4e">36.27.1. SendGrid</a>
<ul>
<li><a href="#org58a04db">36.27.1.1. Whitelabel</a></li>
<li><a href="#org2c1ff1f">36.27.1.2. PHPMailer</a></li>
</ul>
</li>
<li><a href="#orgad6b172">36.27.2. DMARC, SPF, DKIM</a></li>
<li><a href="#org769706a">36.27.3. Preview text</a></li>
<li><a href="#org6f02e31">36.27.4. Send test HTML email for free</a></li>
</ul>
</li>
<li><a href="#org336da96">36.28. Payment Gateway</a>
<ul>
<li><a href="#org76d7a80">36.28.1. Chase E-xact Gateway payment:chase</a></li>
<li><a href="#org7cfa7a5">36.28.2. Moneris Payment Gateway payment:moneris</a></li>
</ul>
</li>
<li><a href="#org601a867">36.29. Marketing Research &amp; Agency</a></li>
<li><a href="#orgf504b23">36.30. W3C</a></li>
<li><a href="#orge19fe14">36.31. Adobe</a>
<ul>
<li><a href="#orgd4f138b">36.31.1. Creative Cloud</a></li>
<li><a href="#org991604c">36.31.2. Photoshop</a>
<ul>
<li><a href="#org7d688a9">36.31.2.1. Image Resize</a></li>
</ul>
</li>
<li><a href="#org7fc051a">36.31.3. Illustrator</a>
<ul>
<li><a href="#org95fec3f">36.31.3.1. Setting</a></li>
<li><a href="#orge7b7d44">36.31.3.2. Panels, Workspace, Artboard</a></li>
<li><a href="#orgdce380b">36.31.3.3. Hand, Zoom, Screen mode, View, Rulers, Guides</a></li>
<li><a href="#orgb0b9a22">36.31.3.4. Repeat the previous action</a></li>
<li><a href="#org9181c82">36.31.3.5. Move, Select</a></li>
<li><a href="#org50a0b06">36.31.3.6. Pencil and Brush tools</a></li>
<li><a href="#orge932498">36.31.3.7. Basic Shapes</a></li>
<li><a href="#org71ea550">36.31.3.8. Drawing Modes</a></li>
<li><a href="#orgd8dfe67">36.31.3.9. Transform Object</a></li>
<li><a href="#orgf9ae840">36.31.3.10. Fill and Stroke</a></li>
<li><a href="#org42c9fa4">36.31.3.11. Color, Swatch</a></li>
<li><a href="#org0c80746">36.31.3.12. Appearance</a></li>
<li><a href="#org99d42ef">36.31.3.13. Complex Shapes, Compound Path, Pathfinder, Shape Builder</a></li>
<li><a href="#org890d955">36.31.3.14. Eraser</a></li>
<li><a href="#orgd0d4213">36.31.3.15. Pen Tool</a></li>
<li><a href="#org9962c26">36.31.3.16. Type Tool</a></li>
<li><a href="#orgf1f4438">36.31.3.17. Copy from InDesign</a></li>
<li><a href="#orga293b49">36.31.3.18. Resize canvas to selection</a></li>
<li><a href="#org64ab6ac">36.31.3.19. Raster Image</a></li>
<li><a href="#org64d7fe5">36.31.3.20. Crop image</a></li>
<li><a href="#org84170d6">36.31.3.21. Export Assets</a></li>
<li><a href="#org969282c">36.31.3.22. Export SVG</a></li>
<li><a href="#orgc892e03">36.31.3.23. Scripts</a></li>
</ul>
</li>
<li><a href="#orge8da260">36.31.4. Color CC</a></li>
</ul>
</li>
<li><a href="#orga742a69">36.32. Training</a>
<ul>
<li><a href="#org8a5345b">36.32.1. Microsoft Virtual Academy MVA</a></li>
<li><a href="#org7d8baf4">36.32.2. Microsoft Certification exam list</a></li>
<li><a href="#orga1fcf28">36.32.3. Microsoft Certification List and Study Group</a></li>
<li><a href="#org9fc8a09">36.32.4. Microsoft Online Proctored Exams</a></li>
</ul>
</li>
<li><a href="#org23c4ed2">36.33. Work Ethics</a>
<ul>
<li><a href="#orgb8c5727">36.33.1. Remove Credentials</a></li>
</ul>
</li>
<li><a href="#orgc270878">36.34. TeamViewer</a></li>
<li><a href="#org9585592">36.35. Font</a>
<ul>
<li><a href="#org4940841">36.35.1. Abbreviations Foundary</a></li>
<li><a href="#orgd267a68">36.35.2. Not a valid font file Windows</a></li>
<li><a href="#org40ebc4b">36.35.3. Line height</a></li>
<li><a href="#orga82edd5">36.35.4. Windows Font List</a></li>
<li><a href="#orgc3ceb46">36.35.5. iOS Font List</a></li>
<li><a href="#orgfff6a43">36.35.6. FontForge</a></li>
<li><a href="#org1db173e">36.35.7. Google Font (GF)</a></li>
<li><a href="#org285f3ce">36.35.8. Material Font, GF</a></li>
<li><a href="#orgae18af9">36.35.9. Open source alternative, identify font</a></li>
<li><a href="#org8d276c7">36.35.10. Extensis</a></li>
<li><a href="#org960bb3a">36.35.11. Monoid</a></li>
<li><a href="#org72e4c24">36.35.12. Hasklig</a></li>
<li><a href="#org6025760">36.35.13. Poppin, GF</a></li>
<li><a href="#org3f4f8b2">36.35.14. Museo, GF</a></li>
<li><a href="#org845e3bd">36.35.15. Roboto Slab, GF</a></li>
<li><a href="#org861a39a">36.35.16. IcoMoon</a></li>
<li><a href="#org7944819">36.35.17. Fontello</a></li>
</ul>
</li>
<li><a href="#org2c1624e">36.36. Digital Agency</a></li>
</ul>
</li>
<li><a href="#org512cfb2">37. <span class="todo TODO">TODO</span> s</a>
<ul>
<li><a href="#org762edd9">37.1. <span class="todo TODO">TODO</span> Inspectlet.com</a></li>
<li><a href="#orgdea0815">37.2. <span class="todo TODO">TODO</span> QUnit</a></li>
<li><a href="#org577cbc5">37.3. <span class="todo TODO">TODO</span> Lynda Bootstrap Layout Responsive Single-Page Design</a></li>
<li><a href="#org6199956">37.4. <span class="todo TODO">TODO</span> Lynda Bootstrap 3: Advanced Web Development</a></li>
<li><a href="#org4cf0ebc">37.5. <span class="todo TODO">TODO</span> Learn Continuous Integration "Pantheon Build Drupal with Composer on Travis"</a></li>
<li><a href="#org07f99ff">37.6. <span class="todo TODO">TODO</span> Learn tool Zeplin</a></li>
<li><a href="#org33a1640">37.7. <span class="todo TODO">TODO</span> Blowfish hashing algorithm using random salt which is stored in db</a></li>
<li><a href="#orgeaaa790">37.8. <span class="todo TODO">TODO</span> Lynda Web Project Workflows with Gulp.js, Git, and Browserify</a></li>
<li><a href="#org428c6a1">37.9. <span class="todo TODO">TODO</span> Lynda Agile Project Management</a></li>
<li><a href="#orgd803996">37.10. <span class="todo TODO">TODO</span> Lynda Javascript: Enhancing the DOM</a></li>
<li><a href="#org9042aff">37.11. <span class="todo TODO">TODO</span> Lynda Firebase, Travis CI, Heroku</a></li>
<li><a href="#orgac260ae">37.12. <span class="todo TODO">TODO</span> Lynda: Foundations of Programming: Object-Oriented Design</a></li>
<li><a href="#orgd1e3b5f">37.13. <span class="todo TODO">TODO</span> JavaScript HTML5 Animation Framework: GSAP or Tween https://greensock.com/</a></li>
<li><a href="#orge4ad0ff">37.14. <span class="todo TODO">TODO</span> Lynda: MVC Frameworks for Building PHP Web Applications with Drew Falkman</a></li>
<li><a href="#orgebed0e9">37.15. <span class="todo TODO">TODO</span> Book: Design Patterns: Elements of Reusable Object-Oriented Software (Addison-Wesley)</a></li>
<li><a href="#org6f437fb">37.16. <span class="todo TODO">TODO</span> Book: Code Complete (2nd Edition, Microsoft Press)</a></li>
<li><a href="#org6a653e1">37.17. <span class="todo TODO">TODO</span> custom-elements-everywhere.com, williams sonoma</a></li>
<li><a href="#org58c7716">37.18. <span class="todo TODO">TODO</span> gridbyexample.com</a></li>
<li><a href="#org23212f4">37.19. <span class="todo TODO">TODO</span> BrowserStack and BeHat</a></li>
<li><a href="#org3806daf">37.20. <span class="todo TODO">TODO</span> SearchKings.ca</a></li>
<li><a href="#org312b79d">37.21. <span class="todo TODO">TODO</span> Agency DriveDigital.ca</a></li>
<li><a href="#org419a8fc">37.22. <span class="todo TODO">TODO</span> Front End Design</a>
<ul>
<li><a href="#org31f6b9b">37.22.1. https://codekitapp.com/</a></li>
<li><a href="#org4f8776b">37.22.2. https://webpack.js.org/</a></li>
<li><a href="#org9242890">37.22.3. http://postcss.org/</a></li>
</ul>
</li>
<li><a href="#org01b55fc">37.23. <span class="todo TODO">TODO</span> Web agencies backed by WP Engine</a></li>
<li><a href="#org8d01f48">37.24. <span class="todo TODO">TODO</span> https://developers.google.com/training/</a></li>
<li><a href="#org4a1870a">37.25. <span class="todo TODO">TODO</span> https://grow.google/</a></li>
<li><a href="#orgea000c4">37.26. <span class="todo TODO">TODO</span> https://www.thinkwithgoogle.com/intl/en-ca/</a></li>
<li><a href="#org1b72e9a">37.27. <span class="todo TODO">TODO</span> https://experiments.withgoogle.com/chrome</a></li>
<li><a href="#org7ea6085">37.28. <span class="todo TODO">TODO</span> https://www.sitepoint.com/nuxt-js-universal-vue-js/</a></li>
<li><a href="#org1ca581d">37.29. <span class="todo TODO">TODO</span> https://generalassemb.ly/ Course on Product Management</a></li>
<li><a href="#org922ac65">37.30. <span class="todo TODO">TODO</span> https://www.roberthalf.com/ Job Hunt</a></li>
<li><a href="#orge245d89">37.31. <span class="todo TODO">TODO</span> https://developers.google.com/experts/ https://abrah.am/</a></li>
<li><a href="#org20945a9">37.32. <span class="todo TODO">TODO</span> http://grow.io/</a></li>
<li><a href="#org2a930cf">37.33. <span class="todo TODO">TODO</span> https://www.ontario.ca/page/digital-government https://medium.com/ontariodigital</a></li>
<li><a href="#orgf0f2bc9">37.34. <span class="done DONE">DONE</span> Chase Payment</a></li>
<li><a href="#orgb5eacda">37.35. <span class="done DONE">DONE</span> Lynda Behance.net</a></li>
<li><a href="#org86a3673">37.36. <span class="done DONE">DONE</span> Lynda Illustrator CC for Web Design: Core Concepts, Aesthetics, Image Optimization, Wireframing, SVG</a></li>
<li><a href="#orgb50b479">37.37. <span class="done DONE">DONE</span> Lynda Adobe Illustrator Essential</a></li>
<li><a href="#org319b18e">37.38. <span class="done DONE">DONE</span> Learn Bootstrap CSS framework</a></li>
<li><a href="#org887d8c3">37.39. <span class="done DONE">DONE</span> learn emacs org mode</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgb416898" class="outline-2">
<h2 id="orgb416898"><span class="section-number-2">1</span> PHP</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgf9f5b0c" class="outline-3">
<h3 id="orgf9f5b0c"><span class="section-number-3">1.1</span> Configuration <a id="org593aa6f">php:config</a></h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-org8c10304" class="outline-4">
<h4 id="org8c10304"><span class="section-number-4">1.1.1</span> Basics</h4>
<div class="outline-text-4" id="text-1-1-1">
<dl class="org-dl">
<dt>Get php configuration files location</dt><dd><code>php --ini</code></dd>
<dt>CLI <code>php -i</code></dt><dd>equivalent to <code>phpinfo()</code></dd>
<dt>Get loaded extensions</dt><dd><code>php -r "print_r(get_loaded_extensions());"</code></dd>
<dt>Get a php config variable</dt><dd><code>php -i | grep --color -n "memory_limit"</code></dd>
</dl>

<p>
Changing php.ini requires restarting apache
</p>
</div>

<div id="outline-container-org9fce66e" class="outline-5">
<h5 id="org9fce66e"><span class="section-number-5">1.1.1.1</span> PHP Version</h5>
<div class="outline-text-5" id="text-1-1-1-1">
<p>
Other than phpinfo(); use
</p>
<pre class="example">
echo phpversion();
echo PHP_VERSION;
</pre>
</div>
</div>

<div id="outline-container-orgc0f88fb" class="outline-5">
<h5 id="orgc0f88fb"><span class="section-number-5">1.1.1.2</span> Possible places for php.ini</h5>
<div class="outline-text-5" id="text-1-1-1-2">
<dl class="org-dl">
<dt>7.x</dt><dd>/etc/php/7.0/apache2/php.ini, /etc/php/7.0/apache2/conf.d/*.ini</dd>
<dt>5.6</dt><dd>/usr/local/etc/php/php.ini, /usr/local/etc/php/conf.d/*.ini</dd>
<dt>5.3</dt><dd>/etc/php5/apache/php.ini, /etc/php5/cli/php.ini</dd>
</dl>
</div>
</div>

<div id="outline-container-org67cd321" class="outline-5">
<h5 id="org67cd321"><span class="section-number-5">1.1.1.3</span> php.ini vs .user.ini</h5>
<div class="outline-text-5" id="text-1-1-1-3">
<p>
Put .user.ini in website root directory. Only place php.ini in main config or conf.d directory or a directory that is setup to scan php.ini files. Placing php.ini in website root directory only works for that directory but not recursively in sub directories.
</p>
</div>
</div>

<div id="outline-container-org8f6684d" class="outline-5">
<h5 id="org8f6684d"><span class="section-number-5">1.1.1.4</span> Apache</h5>
<div class="outline-text-5" id="text-1-1-1-4">
<p>
Set PHP via Apache directives e.g. httpd.conf .htaccess
Require <code>AllowOverride Options</code> or <code>AllowOverride All</code>
</p>

<p>
And then
</p>
<pre class="example">
// for value. Can be used only with PHP_INI_ALL and PHP_INI_PERDIR type directives
php_value name value

// for boolean. Can be used only with PHP_INI_ALL and PHP_INI_PERDIR type directives
php_flag name on|off

// This cannot be set in .htaccess file and cannot be overriden by .htaccess or ini_set()
php_admin_value name value

// This cannot be set in .htaccess file and cannot be overriden by .htaccess or ini_set()
php_admin_flag name on|off
</pre>
</div>
</div>

<div id="outline-container-org0a796f4" class="outline-5">
<h5 id="org0a796f4"><span class="section-number-5">1.1.1.5</span> Configuration Mode</h5>
<div class="outline-text-5" id="text-1-1-1-5">
<dl class="org-dl">
<dt>PHP_INI_USER</dt><dd>Entry can be set in user scripts (like with ini_set()) or in the Windows registry. Since PHP 5.3, entry can be set in .user.ini</dd>
<dt>PHP_INI_PERDIR</dt><dd>Entry can be set in php.ini, .htaccess, httpd.conf or .user.ini (since PHP 5.3)</dd>
<dt>PHP_INI_SYSTEM</dt><dd>Entry can be set in php.ini or httpd.conf</dd>
<dt>PHP_INI_ALL</dt><dd>Entry can be set anywhere</dd>
</dl>
</div>
</div>

<div id="outline-container-org4fee0b1" class="outline-5">
<h5 id="org4fee0b1"><span class="section-number-5">1.1.1.6</span> Directive Value</h5>
<div class="outline-text-5" id="text-1-1-1-6">
<p>
Value can be a string, a number, a PHP constant (e.g. E_ALL or M_PI), one of the INI constants (On, Off, True, False, Yes, No and None) or an expression (e.g. E_ALL &amp; ~E_NOTICE), a quoted string ("bar"), or a reference to a previously set variable or directive (e.g. ${foo})
</p>

<p>
Expression
Expressions in the INI file are limited to bitwise operators and parentheses:
</p>
<ul class="org-ul">
<li>|  bitwise OR</li>
<li>^  bitwise XOR</li>
<li>&amp;  bitwise AND</li>
<li>~  bitwise NOT</li>
<li>!  boolean NOT</li>
</ul>

<p>
Boolean
</p>
<dl class="org-dl">
<dt>True</dt><dd>use 1, On, True or Yes</dd>
<dt>False</dt><dd>use 0, Off, False or No</dd>
</dl>

<p>
Empty string
</p>
<pre class="example">
foo =         
; sets foo to an empty string
foo = None
; sets foo to an empty string
foo = "None"
; sets foo to the string 'None'
</pre>

<p>
Sample production
</p>
<pre class="example">
[PHP]
; copy from https://github.com/php/php-src/blob/master/php.ini-production

;;;;;;;;;;;;;;;;;;;
; Custom php.ini  ;
;;;;;;;;;;;;;;;;;;;

memory_limit = 128M
post_max_size = 100M
upload_max_filesize = 100M
session.cookie_lifetime = 2000000

[mail function]
; For Win32 only.
; http://php.net/smtp
;SMTP = localhost
; http://php.net/smtp-port
;smtp_port = 25

; For Win32 only.
; http://php.net/sendmail-from
;sendmail_from = me@example.com

; For Unix only.  You may supply arguments as well (default: "sendmail -t -i").
; http://php.net/sendmail-path
;sendmail_path =

; Force the addition of the specified parameters to be passed as extra parameters
; to the sendmail binary. These parameters will always replace the value of
; the 5th parameter to mail().
;mail.force_extra_parameters =
</pre>
</div>
</div>
</div>

<div id="outline-container-org8ca756c" class="outline-4">
<h4 id="org8ca756c"><span class="section-number-4">1.1.2</span> [PHP] <a id="org5245ada">php.ini:directives</a></h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
<a href="http://php.net/manual/en/ini.list.php">http://php.net/manual/en/ini.list.php</a>
</p>
</div>

<div id="outline-container-orgf8d48c4" class="outline-5">
<h5 id="orgf8d48c4"><span class="section-number-5">1.1.2.1</span> magic quotes</h5>
<div class="outline-text-5" id="text-1-1-2-1">
<pre class="example">
; Magic quotes for incoming GET/POST/Cookie data.
magic_quotes_gpc = Off

; Magic quotes for runtime-generated data, e.g. data from SQL, from exec(), etc.
magic_quotes_runtime = Off

; Use Sybase-style magic quotes (escape ' with '' instead of \').
magic_quotes_sybase = Off
</pre>
</div>
</div>

<div id="outline-container-org453a9aa" class="outline-5">
<h5 id="org453a9aa"><span class="section-number-5">1.1.2.2</span> allow_url_fopen <a id="org7d327c1">php.ini:allow_url_fopen</a></h5>
<div class="outline-text-5" id="text-1-1-2-2">
<p>
Default is 1 to enable. If disabled, file_get_contents is not possible. This setting can only be set PHP_INI_SYSTEM
</p>
</div>
</div>

<div id="outline-container-org5cb7399" class="outline-5">
<h5 id="org5cb7399"><span class="section-number-5">1.1.2.3</span> auto_prepend_file</h5>
<div class="outline-text-5" id="text-1-1-2-3">
<pre class="example">
// default
auto_prepend_file =

auto_prepend_file = /var/www/prepend.php
if (isset($_SERVER['HTTP_X_FORWARDED_FOR'])) {
    $_SERVER['REMOTE_ADDR'] = $_SERVER['HTTP_X_FORWARDED_FOR'];
}
</pre>
</div>
</div>

<div id="outline-container-orgd0b4e95" class="outline-5">
<h5 id="orgd0b4e95"><span class="section-number-5">1.1.2.4</span> expose_php <a id="org69a58a1">php.ini:expose_php</a></h5>
<div class="outline-text-5" id="text-1-1-2-4">
<p>
expose_php = On
</p>
</div>
</div>

<div id="outline-container-orgb8894db" class="outline-5">
<h5 id="orgb8894db"><span class="section-number-5">1.1.2.5</span> session <a id="org423809f">php.ini:session</a></h5>
<div class="outline-text-5" id="text-1-1-2-5">
<p>
<a href="http://us3.php.net/manual/en/session.configuration.php">http://us3.php.net/manual/en/session.configuration.php</a>
</p>

<p>
Most of them are PHP_INI_ALL
</p>
<dl class="org-dl">
<dt>session.cookie_secure</dt><dd>bool <a id="orgbb189d5">php.ini:session:cookie_secure</a></dd>
<dt>session.cookie_httponly</dt><dd>bool</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org7d497da" class="outline-4">
<h4 id="org7d497da"><span class="section-number-4">1.1.3</span> Enable extension <a id="orgb0f9a65">php.ini:extension</a></h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
php.ini can also enable module. e.g. to enable module intl
</p>
<pre class="example">
;   extension=modulename
; For example:
;
;   extension=mysqli
;   extension=/path/to/extension/mysqli.so
</pre>

<p>
<a href="http://php.net/manual/en/extensions.alphabetical.php">http://php.net/manual/en/extensions.alphabetical.php</a>
<a href="https://pecl.php.net/packages.php">https://pecl.php.net/packages.php</a>
</p>
</div>
</div>

<div id="outline-container-orgeb8ccfb" class="outline-4">
<h4 id="orgeb8ccfb"><span class="section-number-4">1.1.4</span> <a href="https://github.com/php/php-src/blob/master/php.ini-production">prod</a> <a id="org70f12bb">php.ini:prod</a></h4>
<div class="outline-text-4" id="text-1-1-4">
<p>
error_reporint=E_ALL &amp; ~E_DEPRECATED (22527)
display_errors=Off
log_errors=On
error_log not set go to Apache error log
</p>
</div>
</div>

<div id="outline-container-org3fdfdce" class="outline-4">
<h4 id="org3fdfdce"><span class="section-number-4">1.1.5</span> <a href="https://github.com/php/php-src/blob/master/php.ini-development">dev</a> <a id="orgde3c2ce">php.ini:dev</a></h4>
</div>
<div id="outline-container-org3b25e18" class="outline-4">
<h4 id="org3b25e18"><span class="section-number-4">1.1.6</span> Mail <a id="org48d9813">php:ini:mail</a></h4>
<div class="outline-text-4" id="text-1-1-6">
<p>
<a href="http://php.net/manual/en/mail.configuration.php">http://php.net/manual/en/mail.configuration.php</a>
</p>

<pre class="example">
[mail function]
; For Win32 only.
; http://php.net/smtp
SMTP = localhost
; http://php.net/smtp-port
smtp_port = 25

; For Win32 only.
; http://php.net/sendmail-from
;sendmail_from = me@example.com

; For Unix only.  You may supply arguments as well (default: "sendmail -t -i").
; http://php.net/sendmail-path
;sendmail_path =

; Force the addition of the specified parameters to be passed as extra parameters
; to the sendmail binary. These parameters will always replace the value of
; the 5th parameter to mail().
;mail.force_extra_parameters =

; Add X-PHP-Originating-Script: that will include uid of the script followed by the filename
mail.add_x_header = On

; The path to a log file that will log all mail() calls. Log entries include
; the full path of the script, line number, To address and headers.
;mail.log =
; e.g. change to 
; mail.log = /var/log/phpmaillog

; Log mail to syslog (Event Log on Windows).
;mail.log = syslog
</pre>

<p>
Enable mail.log, make sure /var/log/phpmaillog has www-data:www-data as the apache
</p>

<p>
You may need to change the sendmail_path to a php wrapper instead of just adding mail.log location
<a href="http://www.matteomattei.com/how-to-log-email-sent-from-php-through-mail-function/">http://www.matteomattei.com/how-to-log-email-sent-from-php-through-mail-function/</a>
<a href="https://www.howtoforge.com/how-to-log-emails-sent-with-phps-mail-function-to-detect-form-spam">https://www.howtoforge.com/how-to-log-emails-sent-with-phps-mail-function-to-detect-form-spam</a>
</p>
</div>
</div>

<div id="outline-container-orgb3cd4c8" class="outline-4">
<h4 id="orgb3cd4c8"><span class="section-number-4">1.1.7</span> Error log <a id="org6dbb679">php:show error</a></h4>
<div class="outline-text-4" id="text-1-1-7">
<p>
<a href="#org2791321">d7:show error</a> <a href="#org27235a1">d7:debug</a> <a href="#org91aa88e">wp:show error</a>
<a href="http://php.net/manual/en/errorfunc.configuration.php">Runtime configuration for error handling</a>
</p>

<pre class="example">
ini_set('display_errors', 1);
ini_set('display_startup_errors', 1);
error_reporting(E_ALL);
</pre>

<dl class="org-dl">
<dt>display_errors, display_startup_errors bool or stderr</dt><dd>prod always use Off</dd>
<dt>log_errors bool</dt><dd>prod needs to log error instead of display_errors. If true, either to server's system log or error_log</dd>
<dt>log_errors_max_len</dt><dd>(1024) in bytes. 0 to no limit</dd>
<dt>error_log</dt><dd>(NULL) place to store error log. If not set, errors are sent to SAPI error logger e.g. Apache error log or stderr in CLI.</dd>
<dt>error_reporting :: E_ALL &amp; ~E_DEPRECATED &amp; ~E_NOTICE</dt><dd>show all except deprecated and notice
<dl class="org-dl">
<dt>22527</dt><dd>E_ALL &amp; ~E_DEPRECATED</dd>
</dl></dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org2f6f552" class="outline-3">
<h3 id="org2f6f552"><span class="section-number-3">1.2</span> <a href="http://php.net/manual/en/reserved.constants.php">Predefined Constants</a> and <a href="http://php.net/manual/en/language.constants.predefined.php">Magic Constants</a></h3>
</div>
<div id="outline-container-orgb2d4f26" class="outline-3">
<h3 id="orgb2d4f26"><span class="section-number-3">1.3</span> $_SERVER <a id="org7048e12">php:$_SERVER</a></h3>
<div class="outline-text-3" id="text-1-3">
<p>
<a href="https://stackoverflow.com/questions/6474783/which-server-variables-are-safe">Which are safe?</a>
</p>

<p>
GATEWAY_INTERFACE
SERVER_ADDR
SERVER_SOFTWARE
DOCUMENT_ROOT
SERVER_ADMIN
SERVER_SIGNATURE
</p>
</div>

<div id="outline-container-org95b71a0" class="outline-4">
<h4 id="org95b71a0"><span class="section-number-4">1.3.1</span> Partyly safe</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
HTTPS
</p>

<p>
HTTP_HOST :: see below
</p>

<p>
REQUEST_TIME
REQUEST_URI :: /abc/xyz.html?abc=xyz without hash
</p>

<p>
REMOTE_ADDR
REMOTE_HOST :: 
</p>
<ul class="org-ul">
<li>relies on reverse DNS lookups and may hence be spoofed by DNS attacks against server (at that time you have bigger problems anyway)</li>
<li>Its value may be a proxy, which is a simple reality of the TCP/IP protocol and nothing you can do.</li>
</ul>
<p>
REMOTE_PORT
</p>

<p>
SERVER_PROTOCOL
SERVER_NAME :: see below
SERVER_PORT
</p>

<p>
SCRIPT_FILENAME
</p>


<p>
REMOTE_* :: values are guaranteed to be the valid address of the client as verified by a TCP/IP handshake. Because it's the address the response will be sent to
</p>
</div>
</div>

<div id="outline-container-org67593e6" class="outline-4">
<h4 id="org67593e6"><span class="section-number-4">1.3.2</span> HTTP_HOST and SERVER_NAME</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
curl -H "Host: notyourdomain.com" <a href="http://yoursite.com/">http://yoursite.com/</a>
By default, HTTP_HOST or SERVER_NAME is notyourdomain.com
Attackers might trigger a lot of requests and cause your website that is cached by a proxy (Varnish, Cloudflare) to have wrong cache that has content which points to the attacker's domain. Cache poisoning.
</p>

<p>
Solution
Never display $_SERVER['HTTP_HOST'] or $_SERVER['SERVER_NAME']
</p>

<pre class="example">
$config['site_url'] = 'http://' . $_SERVER['HTTP_HOST'] . '/index.php';
$config['cp_url']   = 'http://' . $_SERVER['HTTP_HOST'] . '/system/index.php';

$domain = 'example.com';
$config['site_url'] = 'http://' . $domain . '/index.php';
$config['cp_url']   = 'http://' . $domain . '/system/index.php';

$domains = array('domain.com', 'dev.domain.com', 'staging.domain.com', 'localhost');
if (in_array($_SERVER['HTTP_HOST'], $domains)) {
    $domain = $_SERVER['HTTP_HOST'];
}
else {
    $domain = 'localhost';
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org784e88b" class="outline-3">
<h3 id="org784e88b"><span class="section-number-3">1.4</span> $_FILES POST method uploads</h3>
<div class="outline-text-3" id="text-1-4">
<p>
<a href="http://www.php.net/manual/en/features.file-upload.post-method.php">http://www.php.net/manual/en/features.file-upload.post-method.php</a>
</p>

<p>
enctype="multipart/form-data"
</p>

<p>
'userfile' is the &lt;input&gt; name attribute. If no name, then it's 'file' &gt; $_FILES['file']
</p>

<p>
$_FILES['userfile']['name']
The original name of the file on the client machine.
</p>

<p>
$_FILES['userfile']['type']
The mime type of the file, if the browser provided this information. An example would be "image/gif". This mime type is however not checked on the PHP side and therefore don't take its value for granted.
</p>

<p>
$_FILES['userfile']['size']
The size, in bytes, of the uploaded file.
</p>

<p>
$_FILES['userfile']['tmp_name']
The temporary filename of the file in which the uploaded file was stored on the server.
</p>

<p>
$_FILES['userfile']['error']
The error code associated with this file upload.
</p>

<p>
POST as array
</p>
<pre class="example">
&lt;form action="" method="post" enctype="multipart/form-data"&gt;
&lt;p&gt;Pictures:
&lt;input type="file" name="pictures[]" /&gt;
&lt;input type="file" name="pictures[]" /&gt;
&lt;input type="file" name="pictures[]" /&gt;
&lt;input type="submit" value="Send" /&gt;
&lt;/p&gt;
&lt;/form&gt;

foreach ($_FILES["pictures"]["error"] as $key =&gt; $error) {
    if ($error == UPLOAD_ERR_OK) {
        $tmp_name = $_FILES["pictures"]["tmp_name"][$key];
        // basename() may prevent filesystem traversal attacks;
        // further validation/sanitation of the filename may be appropriate
        $name = basename($_FILES["pictures"]["name"][$key]);
        move_uploaded_file($tmp_name, "data/$name");
    }
}
</pre>
</div>
</div>

<div id="outline-container-orgf241a2c" class="outline-3">
<h3 id="orgf241a2c"><span class="section-number-3">1.5</span> Filesystem</h3>
<div class="outline-text-3" id="text-1-5">
<p>
<a href="http://php.net/manual/en/ref.filesystem.php">http://php.net/manual/en/ref.filesystem.php</a>
</p>
</div>

<div id="outline-container-org6b2e319" class="outline-4">
<h4 id="org6b2e319"><span class="section-number-4">1.5.1</span> Delete file - unlink</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
Use absolute path. See dirname
</p>
<pre class="example">
$files = [
    './first.jpg',
    './second.jpg',
    './third.jpg'
];

foreach ($files as $file) {
    if (file_exists($file)) {
        unlink($file);
    } else {
        // File not found.
    }
}
</pre>
</div>
</div>

<div id="outline-container-org6ffdb45" class="outline-4">
<h4 id="org6ffdb45"><span class="section-number-4">1.5.2</span> File Modification time</h4>
<div class="outline-text-4" id="text-1-5-2">
<pre class="example">
filemtime(__DIR__. "/wp-content/themes/a.css")) // int
</pre>
</div>
</div>

<div id="outline-container-org07fd439" class="outline-4">
<h4 id="org07fd439"><span class="section-number-4">1.5.3</span> Include file - <span class="underline"><span class="underline">DIR</span></span> dirname(<span class="underline"><span class="underline">FILE</span></span>)</h4>
<div class="outline-text-4" id="text-1-5-3">
<pre class="example">
include __DIR__ . "/../abc.";

// PHP version &lt; 5
include dirname(__FILE__) . "/../../../../../wp-content/themes/a-theme/includes/thank-you.php"; 
</pre>
</div>
</div>
</div>

<div id="outline-container-org3e2d5ff" class="outline-3">
<h3 id="org3e2d5ff"><span class="section-number-3">1.6</span> Module, Extension</h3>
<div class="outline-text-3" id="text-1-6">
</div>
<div id="outline-container-org61ec849" class="outline-4">
<h4 id="org61ec849"><span class="section-number-4">1.6.1</span> bz2</h4>
</div>
<div id="outline-container-org4229f9a" class="outline-4">
<h4 id="org4229f9a"><span class="section-number-4">1.6.2</span> bcmath</h4>
</div>
<div id="outline-container-org6974d3c" class="outline-4">
<h4 id="org6974d3c"><span class="section-number-4">1.6.3</span> calendar</h4>
</div>
<div id="outline-container-orga0c3089" class="outline-4">
<h4 id="orga0c3089"><span class="section-number-4">1.6.4</span> enchant</h4>
</div>
<div id="outline-container-orge004411" class="outline-4">
<h4 id="orge004411"><span class="section-number-4">1.6.5</span> exif</h4>
</div>
<div id="outline-container-org525fbad" class="outline-4">
<h4 id="org525fbad"><span class="section-number-4">1.6.6</span> gd</h4>
<div class="outline-text-4" id="text-1-6-6">
<dl class="org-dl">
<dt>XPM Suport</dt><dd>libXpm</dd>
</dl>
</div>
</div>

<div id="outline-container-orgf7737c9" class="outline-4">
<h4 id="orgf7737c9"><span class="section-number-4">1.6.7</span> gettext</h4>
</div>
<div id="outline-container-org614fc28" class="outline-4">
<h4 id="org614fc28"><span class="section-number-4">1.6.8</span> intl</h4>
<div class="outline-text-4" id="text-1-6-8">
<p>
require debian pkg libicu-dev
</p>
</div>
</div>

<div id="outline-container-org8d9169f" class="outline-4">
<h4 id="org8d9169f"><span class="section-number-4">1.6.9</span> pspell</h4>
</div>
<div id="outline-container-org6bd79e1" class="outline-4">
<h4 id="org6bd79e1"><span class="section-number-4">1.6.10</span> soap</h4>
<div class="outline-text-4" id="text-1-6-10">
<p>
require debian pkg libxml2-dev
</p>
</div>
</div>

<div id="outline-container-org84b7bbc" class="outline-4">
<h4 id="org84b7bbc"><span class="section-number-4">1.6.11</span> sockets</h4>
</div>
<div id="outline-container-org26d3c33" class="outline-4">
<h4 id="org26d3c33"><span class="section-number-4">1.6.12</span> tidy</h4>
</div>
<div id="outline-container-org506e7bf" class="outline-4">
<h4 id="org506e7bf"><span class="section-number-4">1.6.13</span> xmlrpc</h4>
</div>
</div>
<div id="outline-container-orgf444497" class="outline-3">
<h3 id="orgf444497"><span class="section-number-3">1.7</span> Locale</h3>
<div class="outline-text-3" id="text-1-7">
<p>
In Linux, you can run <code>locale -a</code> to get a list of codes
Linux return multi-letter codes. You can use 3-letter or 2-letter codes as a backup.
<a href="https://www.w3.org/WAI/ER/IG/ert/iso639.htm">ISO 639 3-letter codes</a>
</p>
</div>
</div>

<div id="outline-container-orgfe7529b" class="outline-3">
<h3 id="orgfe7529b"><span class="section-number-3">1.8</span> Date</h3>
<div class="outline-text-3" id="text-1-8">
</div>
<div id="outline-container-orgeec9e21" class="outline-4">
<h4 id="orgeec9e21"><span class="section-number-4">1.8.1</span> Create a custom date</h4>
<div class="outline-text-4" id="text-1-8-1">
</div>
<div id="outline-container-orgb10c221" class="outline-5">
<h5 id="orgb10c221"><span class="section-number-5">1.8.1.1</span> mktime return Unix timestamp</h5>
<div class="outline-text-5" id="text-1-8-1-1">
<p>
$_u_time = mktime(11,0,0,11,22,2016); // hour, min, sec, month, day, year, $is_dst(daylight saving, 0 or 1)
</p>
</div>
</div>

<div id="outline-container-orgbd1cc76" class="outline-5">
<h5 id="orgbd1cc76"><span class="section-number-5">1.8.1.2</span> String to Time</h5>
<div class="outline-text-5" id="text-1-8-1-2">
<pre class="example">
$_u_time = strtotime('2016-11-01');

// ISO date string. Refer to js:time:iso
$_u_time = strtotime('2011-10-05T14:48:00.000Z')

Compare if($start &gt; $end) {}

// difference in seconds
$end - $start

// Format differences
$interval = date_diff($end, $start);
echo $interval-&gt;format('%R%a days');

</pre>
</div>
</div>

<div id="outline-container-org3a53349" class="outline-5">
<h5 id="org3a53349"><span class="section-number-5">1.8.1.3</span> Unix timestamp (int) to datetime object</h5>
<div class="outline-text-5" id="text-1-8-1-3">
<p>
$_u_time = strtotime('2016-11-01');
</p>

<p>
$a = new DateTime();
$a-&gt;setTimestamp($_u_time);
</p>

<p>
$now = new DateTime();
</p>
</div>
</div>

<div id="outline-container-orgf6872b8" class="outline-5">
<h5 id="orgf6872b8"><span class="section-number-5">1.8.1.4</span> Format difference between 2 Datetime objects</h5>
<div class="outline-text-5" id="text-1-8-1-4">
<p>
$interval = $now-&gt;diff($a);
echo $interval-&gt;format('%R%a days');
</p>
</div>
</div>
</div>

<div id="outline-container-org6f9de6a" class="outline-4">
<h4 id="org6f9de6a"><span class="section-number-4">1.8.2</span> Date in Other Languages (Locale)</h4>
<div class="outline-text-4" id="text-1-8-2">
<p>
$_u_time = mktime (11, 0, 0, 11, 22, 2016);
setlocale(LC_TIME, 'fr_FR.utf8','fra'); // try fr_FR.utf8 first, if fail, try fra
$_fr_time = array();
$_fr_time[] = strftime('%A', $_u_time); <i>/ format a date/time according to locale settings
$_fr_time[] = trim(strftime('%e', $_u_time)); /</i> day of month, single digit with leading space if it's single digit..
$_fr_time[] = strftime('%B', $_u_time);
$_fr_time[] = strftime('%Y', $_u_time);
$_fr_time = ucwords(implode(' ', $_fr_time));
echo $_fr_time;
</p>
</div>
</div>

<div id="outline-container-orgbe14da7" class="outline-4">
<h4 id="orgbe14da7"><span class="section-number-4">1.8.3</span> Change timezone</h4>
<div class="outline-text-4" id="text-1-8-3">
<pre class="example">
$timezone = date_default_timezone_get(); // UTC
var_dump($timezone); // UTC

var_dump(date('Y/m/d h:i:s a',time())); // e.g. 7pm

date_default_timezone_set('America/Toronto');

var_dump(date('Y/m/d h:i:s a',time())); // e.g. 7pm +4 = 11pm
date_default_timezone_set($timezone); // UTC
var_dump(date('Y/m/d h:i:s a',time())); // e.g. 7pm
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcd93790" class="outline-3">
<h3 id="orgcd93790"><span class="section-number-3">1.9</span> Multibyte</h3>
<div class="outline-text-3" id="text-1-9">
</div>
<div id="outline-container-org6d1abe3" class="outline-4">
<h4 id="org6d1abe3"><span class="section-number-4">1.9.1</span> Remove 4 byte characters <a id="org5611c79">php:4byte</a></h4>
<div class="outline-text-4" id="text-1-9-1">
<p>
PHP UTF-8 character range is wider than MySQL utf8. MySQL's true UTF-8 is utf8mb4 but sometimes it's hard change.
<a href="#org545f6c8">mysql:charset</a> <a href="#orge0e3cd2">d7:mysql:charset</a> 
</p>

<p>
Here's how to remove any 4 byte character.
</p>

<pre class="example">
function replace4byte( $string ) {
  return preg_replace( '%(?:
          \xF0[\x90-\xBF][\x80-\xBF]{2}      # planes 1-3
        | [\xF1-\xF3][\x80-\xBF]{3}          # planes 4-15
        | \xF4[\x80-\x8F][\x80-\xBF]{2}      # plane 16
    )%xs', '', $string );
}

var_dump( 
  replace4byte( 'd' ), 
  replace4byte( 'd_Emoji_d' ) 
);
</pre>
</div>
</div>
</div>

<div id="outline-container-org3094fda" class="outline-3">
<h3 id="org3094fda"><span class="section-number-3">1.10</span> Array</h3>
<div class="outline-text-3" id="text-1-10">
</div>
<div id="outline-container-org6a55f4b" class="outline-4">
<h4 id="org6a55f4b"><span class="section-number-4">1.10.1</span> array_merge, array_merge_recursive</h4>
<div class="outline-text-4" id="text-1-10-1">
<p>
array_merge
</p>
<ul class="org-ul">
<li>only merge on the first level</li>
<li>If key is the same, value at later array will overwrite the first array's value.</li>
<li>However, if key is numeric, values will always be appended (not overwriting) disregarding the values are the same.</li>
</ul>

<p>
array_merge_recursive
</p>
<ul class="org-ul">
<li>If key is the same, values will be appended as array</li>
<li>Very different from array_merge</li>
</ul>
</div>
</div>

<div id="outline-container-org060a39b" class="outline-4">
<h4 id="org060a39b"><span class="section-number-4">1.10.2</span> Last element</h4>
<div class="outline-text-4" id="text-1-10-2">
<p>
$_last = end($target_array);
reset($target_array);
</p>
</div>
</div>

<div id="outline-container-orga3bf0eb" class="outline-4">
<h4 id="orga3bf0eb"><span class="section-number-4">1.10.3</span> Search Value and Return Key</h4>
<div class="outline-text-4" id="text-1-10-3">
<p>
Case insensitive search
</p>
<pre class="example">
$a= array(
'k1'=&gt; 'one',
'k2' =&gt; 'one1',
'k3' =&gt; 'three',
);

print_r( preg_grep( "/ONe$/i" , $a ) );
// return all matches
// Array ( [k1] =&gt; one, ... )
// empty array if no match
</pre>

<p>
Use <code>in_array('string', $a)</code> for case sensitive search
</p>
</div>
</div>

<div id="outline-container-org622c133" class="outline-4">
<h4 id="org622c133"><span class="section-number-4">1.10.4</span> Change Case for All Keys</h4>
<div class="outline-text-4" id="text-1-10-4">
<pre class="example">
$_lower_GET = array_change_key_case($_GET, CASE_LOWER);
// Or CASE_UPPER
</pre>
</div>
</div>

<div id="outline-container-orgc703577" class="outline-4">
<h4 id="orgc703577"><span class="section-number-4">1.10.5</span> Get values of a column in a multidimensional array</h4>
<div class="outline-text-4" id="text-1-10-5">
<p>
You have this array
</p>
<pre class="example">
$records = array(
    array(
        'id' =&gt; 2135,
        'first_name' =&gt; 'John',
        'last_name' =&gt; 'Doe'
    ),
    array(
        'id' =&gt; 3245,
        'first_name' =&gt; 'Sally',
        'last_name' =&gt; 'Smith'
    ),
    array(
        'id' =&gt; 5342,
        'first_name' =&gt; 'Jane',
        // Notice! there's no last_name     
    ),
    array(
        'id' =&gt; 5623,
        'first_name' =&gt; 'Peter',
        'last_name' =&gt; 'Doe'
    )
);
</pre>

<p>
array_column($records, 'last_name') is
</p>
<pre class="example">
['Doe', 'Smith', 'Doe']
</pre>

<p>
array_column($records, 'last_name', 'id') is
</p>
<pre class="example">
[ 2135 =&gt; 'Doe', 3245 =&gt; 'Smith', 5623=&gt;'Doe']
</pre>

<p>
Require PHP 5.5+
</p>
</div>
</div>

<div id="outline-container-orga4fc77f" class="outline-4">
<h4 id="orga4fc77f"><span class="section-number-4">1.10.6</span> Remove values</h4>
<div class="outline-text-4" id="text-1-10-6">
<p>
Single dimension
</p>
<pre class="example">
$arr = ['nice_item', 'remove_me', 'another_liked_item', 'remove_me', 'remove_me_also'];
$arr = array_diff($arr, ['remove_me', 'remove_me_also']);
</pre>
</div>
</div>

<div id="outline-container-org822aac0" class="outline-4">
<h4 id="org822aac0"><span class="section-number-4">1.10.7</span> Change values of all elements <a id="org5a16b65">php:array_map</a></h4>
<div class="outline-text-4" id="text-1-10-7">
<pre class="example">
function sanitize($s) {
  return htmlspecialchars($s);
}
$a = array('harmless', '&lt;bad&gt;', '&gt;&gt;click here!&lt;&lt;');
$a = array_map('sanitize', $a);
// trim each element
$a = array_map('trim', $a);
echo implode(' ', $a);
</pre>
</div>
</div>

<div id="outline-container-org42380b1" class="outline-4">
<h4 id="org42380b1"><span class="section-number-4">1.10.8</span> Insert to any position of an array</h4>
<div class="outline-text-4" id="text-1-10-8">
<pre class="example">
$original = array( 'a', 'b', 'c', 'd', 'e' );
$inserted = array( 'x' ); // Not necessarily an array

array_splice( $original, 3, 0, $inserted ); // splice in at position 3
// $original is now a b c x d e
</pre>
</div>
</div>

<div id="outline-container-orgc05d81b" class="outline-4">
<h4 id="orgc05d81b"><span class="section-number-4">1.10.9</span> array_filter</h4>
<div class="outline-text-4" id="text-1-10-9">
<p>
callback function should return true or false. By default, only value is passed to the callback function.
Unless flag is used
</p>
<pre class="example">
$arr = ['a' =&gt; 1, 'b' =&gt; 2, 'c' =&gt; 3, 'd' =&gt; 4];

var_dump(array_filter($arr, function($k) {
    return $k == 'b';
}, ARRAY_FILTER_USE_KEY));

var_dump(array_filter($arr, function($v, $k) {
    return $k == 'b' || $v == 4;
}, ARRAY_FILTER_USE_BOTH));
</pre>

<p>
Original index number is used!
</p>
</div>
</div>

<div id="outline-container-org881053c" class="outline-4">
<h4 id="org881053c"><span class="section-number-4">1.10.10</span> Sort arrays</h4>
<div class="outline-text-4" id="text-1-10-10">
<p>
<a href="http://php.net/manual/en/array.sorting.php">http://php.net/manual/en/array.sorting.php</a>
</p>
<ul class="org-ul">
<li>All functions act directly on the input array</li>
<li>Maintain key association means the keys are not modified otherwise the keys are reset numerically (0,1,2)</li>
</ul>
</div>

<div id="outline-container-org57d3eee" class="outline-5">
<h5 id="org57d3eee"><span class="section-number-5">1.10.10.1</span> usort uasort - value sort</h5>
<div class="outline-text-5" id="text-1-10-10-1">
<p>
usort doesn't maintain key association but uasort does. If callback function returns negative integer, means the comparison is less than.
</p>

<pre class="example">
Array
(
    [0] =&gt; Array
        (
            [hashtag] =&gt; a7e87329b5eab8578f4f1098a152d6f4
            [title] =&gt; Flower
            [order] =&gt; 3
        )

    [1] =&gt; Array
        (
            [hashtag] =&gt; b24ce0cd392a5b0b8dedc66c25213594
            [title] =&gt; Free
            [order] =&gt; 2
        )

    [2] =&gt; Array
        (
            [hashtag] =&gt; e7d31fc0602fb2ede144d18cdffd816b
            [title] =&gt; Ready
            [order] =&gt; 1
        )
)

// PHP 5.2 and lower
function sortByOrder($a, $b) {
    return $a['order'] - $b['order']; // ascending order
}
usort($myArray, 'sortByOrder');

// PHP 5.3 and above
usort($myArray, function($a, $b) {
    return $a['order'] - $b['order'];
});

// PHP 7 and above
usort($myArray, function($a, $b) {
    return $a['order'] &lt;=&gt; $b['order'];
});

// Order by multiple values
usort($myArray, function($a, $b) {
    $retval = $a['order'] &lt;=&gt; $b['order'];
    if ($retval == 0) {
        $retval = $a['suborder'] &lt;=&gt; $b['suborder'];
        if ($retval == 0) {
            $retval = $a['details']['subsuborder'] &lt;=&gt; $b['details']['subsuborder'];
        }
    }
    return $retval;
});
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0379ec1" class="outline-3">
<h3 id="org0379ec1"><span class="section-number-3">1.11</span> String</h3>
<div class="outline-text-3" id="text-1-11">
</div>
<div id="outline-container-org1964ec6" class="outline-4">
<h4 id="org1964ec6"><span class="section-number-4">1.11.1</span> String to HTML, <a id="org1cf7efd">php:DOMDocument</a></h4>
<div class="outline-text-4" id="text-1-11-1">
<p>
Refer to <a href="#orgbbac9d8">d7:ellipsis</a>
</p>

<pre class="example">
$dom = new DOMDocument;
$dom-&gt;loadHTML($xml);
$imgs = $dom-&gt;getElementsByTagName('img');
foreach ( $imgs as $img ) {
  echo $img-&gt;nodeValue, PHP_EOL;
  echo $img-&gt;getAttribute('src');
}
// To get the first img
$_first_img = $imgs-&gt;item(0);

echo $_first_img-&gt;getAttribute('src');
</pre>

<p>
Strip one specific HTML tag
</p>
<pre class="example">
$dom = new DOMDocument;
$dom-&gt;loadHTML($htmlString);
$xPath = new DOMXPath($dom);
$nodes = $xPath-&gt;query('//*[@id="anotherDiv"]');
if($nodes-&gt;item(0)) {
    $nodes-&gt;item(0)-&gt;parentNode-&gt;removeChild($nodes-&gt;item(0));
}

$list = $doc-&gt;getElementsByTagName("p");
while ($list-&gt;length &gt; 0) {
    $p = $list-&gt;item(0);
    $p-&gt;parentNode-&gt;removeChild($p);
}

echo $dom-&gt;saveHTML();
</pre>

<p>
The above will add &lt;!doctype&gt;&lt;html&gt;&lt;body&gt; tags, use this to do fragment
</p>
<pre class="example">
$dom = new DOMDocument;
$fragment = $dom-&gt;createDocumentFragment();
$fragment-&gt;appendXML($form);
$dom-&gt;appendChild($fragment);
$noscripts = $dom-&gt;getElementsByTagName('noscript');
while ($noscripts-&gt;length &gt; 0) {
  $i = $noscripts-&gt;item(0);
  $i-&gt;parentNode-&gt;removeChild($i);
}
return $dom-&gt;saveHTML();
</pre>
</div>
</div>

<div id="outline-container-orge6c73b7" class="outline-4">
<h4 id="orge6c73b7"><span class="section-number-4">1.11.2</span> Remove HTML tag, regex</h4>
<div class="outline-text-4" id="text-1-11-2">
<pre class="example">
$tags = ['noscript', 'p'];
return preg_replace('@&lt;('. implode('|', $tags) .')[^&gt;]*?&gt;.*?&lt;/\\1&gt;@si', '',$html);
</pre>
</div>
</div>

<div id="outline-container-org86fdffb" class="outline-4">
<h4 id="org86fdffb"><span class="section-number-4">1.11.3</span> Remove an attribute from string, regex</h4>
<div class="outline-text-4" id="text-1-11-3">
<p>
remove attribute style
</p>
<pre class="example">
$output = preg_replace('/(&lt;[^&gt;]+) style=".*?"/si', '$1', $input);
</pre>
</div>
</div>

<div id="outline-container-orgf4c43fa" class="outline-4">
<h4 id="orgf4c43fa"><span class="section-number-4">1.11.4</span> String Ellipsis, Trim</h4>
<div class="outline-text-4" id="text-1-11-4">
<p>
<a href="#org2fea5b6">wp:ellipsis</a> <a href="#orgbbac9d8">d7:ellipsis</a>
</p>
</div>
</div>

<div id="outline-container-orgbcdc27b" class="outline-4">
<h4 id="orgbcdc27b"><span class="section-number-4">1.11.5</span> Encode HTML <a id="org78b41e1">php:htmlspecialchars</a></h4>
<div class="outline-text-4" id="text-1-11-5">
<p>
htmlspecialchars produces less code than htmlentities
</p>
<pre class="example">
echo htmlentities('&lt;Il était une fois un être&gt;.');
// Output: &amp;lt;Il &amp;eacute;tait une fois un &amp;ecirc;tre&amp;gt;.
//                ^^^^^^^^                 ^^^^^^^

echo htmlspecialchars('&lt;Il était une fois un être&gt;.');
// Output: &amp;lt;Il était une fois un être&amp;gt;.
//                ^                 ^
</pre>

<p>
<a href="#org8878b79">d7:functions:check_plain</a> is <code>htmlspecialchars($text, ENT_QUOTES, 'UTF-8');</code> which can also be used in sanitize HTML attribute values.
</p>

<p>
&amp; (ampersand) :: &amp;amp;
" (double quote) :: &amp;quot;, unless ENT_NOQUOTES is set
' (single quote) :: &amp;#039; (for ENT_HTML401) or &amp;apos; (for ENT_XML1, ENT_XHTML or ENT_HTML5), but only when ENT_QUOTES is set
&lt; (less than) :: &amp;lt;
&gt; (greater than) :: &amp;gt;
</p>

<pre class="example">
// Sanitize $_POST value to safe html text
if (!function_exists("check_plain")) {
  function check_plain($text) {
    return htmlspecialchars($text, ENT_QUOTES, 'UTF-8');
  }
}
</pre>

<p>
Flags
</p>
<dl class="org-dl">
<dt><code>ENT_QUOTES</code></dt><dd>convert both double and single quotes</dd>
</dl>
</div>
</div>

<div id="outline-container-org91800fa" class="outline-4">
<h4 id="org91800fa"><span class="section-number-4">1.11.6</span> UTF-8 encoding <a id="orga7a10dd">php:string:encoding</a> <a id="org8236fa4">php:mb_convert_encoding</a> <a id="orgaea9658">php:mb_detect_encoding</a></h4>
<div class="outline-text-4" id="text-1-11-6">
<p>
Make sure the string is UTF-8 encoded especially after <a href="#org6dcec15">php:file_get_contents</a>
</p>
<pre class="example">
$twitterHTML = mb_convert_encoding($twitterHTML, 'UTF-8',
  mb_detect_encoding($twitterHTML)
);
echo $twitterHTML;
</pre>
</div>
</div>

<div id="outline-container-orgb8c8aa3" class="outline-4">
<h4 id="orgb8c8aa3"><span class="section-number-4">1.11.7</span> Replace last</h4>
<div class="outline-text-4" id="text-1-11-7">
<pre class="example">
function str_lreplace($search, $replace, $subject) {
    $pos = strrpos($subject, $search);

    if($pos !== false) {
        $subject = substr_replace($subject, $replace, $pos, strlen($search));
    }

    return $subject;
}
</pre>
</div>
</div>

<div id="outline-container-orgfd12617" class="outline-4">
<h4 id="orgfd12617"><span class="section-number-4">1.11.8</span> Start with</h4>
<div class="outline-text-4" id="text-1-11-8">
<pre class="example">
$target_prefix = '/inventory/';
// case-insensitive compare
if( strcasecmp(substr($request_uri, 0, strlen($target_prefix)), $target_prefix) === 0 ){
  // it has that prefix and remove the prefix
  // $new_uri = substr($request_uri, strlen($target_prefix));
}
</pre>
</div>
</div>

<div id="outline-container-org13184b0" class="outline-4">
<h4 id="org13184b0"><span class="section-number-4">1.11.9</span> Random bash64 string</h4>
<div class="outline-text-4" id="text-1-11-9">
<pre class="example">
$str = substr(base64_encode(sha1(mt_rand())), 0, 16);
</pre>
</div>
</div>
</div>

<div id="outline-container-org36bc2a3" class="outline-3">
<h3 id="org36bc2a3"><span class="section-number-3">1.12</span> URL</h3>
<div class="outline-text-3" id="text-1-12">
<pre class="example">
$query_string = 'foo=' . urlencode($foo) . '&amp;bar=' . urlencode($bar);
echo '&lt;a href="mycgi?' . htmlentities($query_string) . '"&gt;';
</pre>

<p>
To encode path
</p>
<pre class="example">
echo '&lt;a href="ftp://user:', rawurlencode('foo @+%/'),
     '@ftp.example.com/x.txt"&gt;';
echo '&lt;a href="http://example.com/department_list_script/',
    rawurlencode('sales and marketing/Miami'), '"&gt;';
</pre>

<p>
urlencode encodes spaces as plus signs current URL
</p>
<pre class="example">
$url = $_SERVER['REQUEST_URI'];
$parts = parse_url($url);
parse_str($parts['query'], $query);
echo $query['email'];

$str = "first=value&amp;arr[]=foo+bar&amp;arr[]=baz";

parse_str($str, $output);
echo $output['first'];  // value
echo $output['arr'][0]; // foo bar
echo $output['arr'][1]; // baz
</pre>

<p>
Current URL path. Refer to <a href="#orgbda1163">php:parse_url</a>
</p>
<pre class="example">
$path_only = parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH);
</pre>

<p>
The last component of path
</p>
<pre class="example">
basename("/etc/passwd") // passwd
basename("/etc/sudoers.d") // sudoers.d
basename("/etc/sudoers.d", ".d") // sudoers
</pre>
</div>
</div>

<div id="outline-container-orged819bd" class="outline-3">
<h3 id="orged819bd"><span class="section-number-3">1.13</span> Random Integer Number</h3>
<div class="outline-text-3" id="text-1-13">
<p>
There're several ways
</p>

<pre class="example">
$numbers = range(0,12); // 0, 1, 2, ..., 12
shuffle($numbers);
echo $numbers[0];
</pre>

<pre class="example">
echo(mt_rand(10,100)); // min: 0, max: 100
$rnd = rand(pow(10, 8-1), pow(10, 8)-1); // random 7 digits integer
</pre>
</div>
</div>

<div id="outline-container-org1d3623f" class="outline-3">
<h3 id="org1d3623f"><span class="section-number-3">1.14</span> encrypt, decrypt</h3>
<div class="outline-text-3" id="text-1-14">
<pre class="example">
$data = "hello";
$method = "aes-256-cbc";
$key = "123455";
$iv = "1234567890123456"; // has to be 16 bytes or 16 text characters
$iv = openssl_random_pseudo_bytes(16); // $iv should be different every time

$options = 0; // If $data, $key and $iv are normal text like above, 0 can be used. Output is base64 encoded string
// Otherwise use OPENSSL_RAW_DATA. Output is binary

$encryptedMessage = openssl_encrypt($data, $method, $key, $options, $iv);

echo $encryptedMessage.PHP_EOL; // because $options is 0, the encrypted message is base64 encoded

$decryptedMessage = openssl_decrypt($encryptedMessage, $method, $key, $options, $iv);
</pre>

<p>
If $encryptedMessage, $key and $iv are all hex, you need to convert them to binary to decrypt
<a id="org07a95a9">php:openssl_decrypt</a>
Refer to <a href="#orgd04953f">nodejs:decrypt</a>
</p>
<pre class="example">
$fromNode = 'encryptedString$intializedVector';
$fromNode = explode('$', $fromNode);
$key = '64 hex characters'; // same as in nodejs

$data = hex2bin($fromNode[0]);
$keyAES = hex2bin($key);
$iv = hex2bin($fromNode[1]);
$options = OPENSSL_RAW_DATA; // Input are all binary, output is binary, too. 
// But because the encrypted message is a string, the decrypted message is a string.

$decrypted = openssl_decrypt($data, 'aes-256-cbc', $keyAES, $options, $iv);

// If $data, $keyAES and $iv are raw data (bytes), use OPENSSL_RAW_DATA as $options
// if all 3 of them are string, use 0 as $options
</pre>
</div>
</div>

<div id="outline-container-org00f67cb" class="outline-3">
<h3 id="org00f67cb"><span class="section-number-3">1.15</span> HTML encode and decode</h3>
<div class="outline-text-3" id="text-1-15">
<pre class="example">
$t = '&lt;a href="http://expample.com"&gt;Hello L\'automobile from "Me"&lt;/a&gt;';
var_dump(htmlentities($t, ENT_QUOTES, 'UTF-8'));
var_dump(html_entity_decode($t, ENT_QUOTES, 'UTF-8'));
// The same as D7 decode_entities($t)
</pre>

<p>
ENT_QUOTES is to convert both single <code>&amp;#039;</code> and double <code>&amp;quot;</code> quotes.
</p>
</div>
</div>

<div id="outline-container-org831f0b7" class="outline-3">
<h3 id="org831f0b7"><span class="section-number-3">1.16</span> Heredoc, Nowdoc</h3>
<div class="outline-text-3" id="text-1-16">
<p>
Heredoc result is a double-quoted string
</p>
<pre class="example">
$html = &lt;&lt;&lt;HTML
&lt;span&gt;{$obj-&gt;name[1]}&lt;/span&gt;
HTML;
</pre>

<pre class="example">
$string = &lt;&lt;&lt; heredoc
plain text and now a function: %s
heredoc;
$string = sprintf($string, testfunction());
</pre>

<p>
Nowdoc can't expand variables and the result is single quoted string
</p>
<pre class="example">
echo &lt;&lt;&lt;'EOT'
&lt;span&gt;{$obj-&gt;name[1]}&lt;/span&gt;
EOT;
</pre>
</div>
</div>

<div id="outline-container-orgaf01cea" class="outline-3">
<h3 id="orgaf01cea"><span class="section-number-3">1.17</span> Buffer <a id="org1536946">php:buffer</a></h3>
<div class="outline-text-3" id="text-1-17">
<p>
<a href="http://php.net/manual/en/book.outcontrol.php">http://php.net/manual/en/book.outcontrol.php</a>
<a href="https://phpfashion.com/everything-about-output-buffering-in-php">https://phpfashion.com/everything-about-output-buffering-in-php</a>
Send headers to browser after php has begun outputting data.
</p>

<div class="org-src-container">
<pre class="src src-php"><span style="color: #74af68;">// </span><span style="color: #74af68;">set header</span>
ob_start();
<span style="color: #ffad29; font-weight: bold;">echo</span> <span style="color: #e67128;">"Hello\n"</span>;

setcookie(<span style="color: #e67128;">"cookiename"</span>, <span style="color: #e67128;">"cookiedata"</span>);

<span style="color: #74af68;">// </span><span style="color: #74af68;">the same header cannot be set because it's already been sent</span>
ob_end_flush();
</pre>
</div>

<p>
ob_start() can be stacked
</p>

<p>
Flush means send to output
</p>

<dl class="org-dl">
<dt>ob_end_flush</dt><dd>send and turn off output buffering</dd>
<dt>ob_get_flush</dt><dd>send, return and turn off</dd>
<dt>ob_flush</dt><dd>send</dd>
<dt>ob_clean</dt><dd>erase the output buffer</dd>
<dt>ob_end_clean</dt><dd>erase and turn off</dd>
<dt>ob_get_clean</dt><dd>return and erase = ob_get_contents + ob_end_clean</dd>
<dt>ob_get_contents</dt><dd>return</dd>
</dl>

<p>
ob_get_length
</p>

<div class="org-src-container">
<pre class="src src-php">ob_start();
<span style="color: #23d7d7;">?&gt;</span>
    &lt;div id=<span style="color: #e67128;">"site_header"</span>&gt;
  &lt;div id=<span style="color: #e67128;">"site_header_inner"</span>&gt;
      &lt;div id=<span style="color: #e67128;">"site_header_logo"</span>&gt;<span style="color: #23d7d7;">&lt;?php</span> <span style="color: #ffad29; font-weight: bold;">echo</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">PhpVar</span>; <span style="color: #23d7d7;">?&gt;</span>&lt;/div&gt;
      &lt;div id=<span style="color: #e67128;">"site_header_countdown"</span>&gt;<span style="color: #008b8b;">BARE</span> <span style="color: #008b8b;">XX</span> <span style="color: #008b8b;">DAGER</span> <span style="color: #008b8b;">IGJEN</span>&lt;/div&gt;
  &lt;/div&gt;
    &lt;/div&gt;
<span style="color: #23d7d7;">&lt;?php</span>
<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">output</span> = ob_get_clean();
<span style="color: #74af68;">//</span><span style="color: #74af68;">ob_flush();</span>

<span style="color: #ffad29; font-weight: bold;">return</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">output</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgefd6cac" class="outline-3">
<h3 id="orgefd6cac"><span class="section-number-3">1.18</span> Template System</h3>
<div class="outline-text-3" id="text-1-18">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffad29; font-weight: bold;">static</span> <span style="color: #ffad29; font-weight: bold;">public</span> <span style="color: #ffad29; font-weight: bold;">function</span> <span style="color: #00ede1; font-weight: bold;">renderHeader</span>(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">data</span> = <span style="color: #ffad29; font-weight: bold;">array</span>()) {
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">localData</span> = <span style="color: #ffad29; font-weight: bold;">array</span>();
  <span style="color: #ffad29; font-weight: bold;">return</span> <span style="color: #ffad29; font-weight: bold;">self</span><span style="color: #e1e1e0; background-color: #2d3743;">::</span>renderView(<span style="color: #008b8b;">__DIR__</span> . <span style="color: #e67128;">'/../views/header.php'</span>, <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">localData</span>);
}

<span style="color: #ffad29; font-weight: bold;">static</span> <span style="color: #ffad29; font-weight: bold;">private</span> <span style="color: #ffad29; font-weight: bold;">function</span> <span style="color: #00ede1; font-weight: bold;">renderView</span>(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">path</span>, <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">data</span>=<span style="color: #ffad29; font-weight: bold;">array</span>()) {
  ob_start();
  <span style="color: #ffad29; font-weight: bold;">if</span> (file_exists(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">path</span>)) {
    <span style="color: #ffad29; font-weight: bold;">include</span> (<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">path</span>);
  }
  <span style="color: #74af68;">// </span><span style="color: #74af68;">else throw new TemplateNotFoundException();</span>
  <span style="color: #ffad29; font-weight: bold;">return</span> ob_get_clean();
}
</pre>
</div>

<dl class="org-dl">
<dt>header.php</dt><dd></dd>
</dl>
</div>
</div>

<div id="outline-container-orgcd5fa6b" class="outline-3">
<h3 id="orgcd5fa6b"><span class="section-number-3">1.19</span> Image</h3>
<div class="outline-text-3" id="text-1-19">
</div>
<div id="outline-container-org05138cb" class="outline-4">
<h4 id="org05138cb"><span class="section-number-4">1.19.1</span> GD vs Imagick</h4>
<div class="outline-text-4" id="text-1-19-1">
<p>
GD is the oldest. Imagick might not exist in some hosting.
</p>

<pre class="example">
if(extension_loaded('gd')) {
    print_r(gd_info());
}
else {
    echo 'GD is not available.';
}

if(extension_loaded('imagick')) {
    $imagick = new Imagick();
    print_r($imagick-&gt;queryFormats());
}
else {
    echo 'ImageMagick is not available.';
}
</pre>

<p>
GD only supports JPG, PNG, GIF, WBMP, WebP, XBM and XPM.
If TIFF needs to be supported, use Imagick.
</p>
</div>
</div>

<div id="outline-container-org60815d7" class="outline-4">
<h4 id="org60815d7"><span class="section-number-4">1.19.2</span> Create image in memory and output</h4>
<div class="outline-text-4" id="text-1-19-2">
<pre class="example">
$data = 'iVBORw0KGgoAAAANSUhEUgAAABwAAAASCAMAAAB/2U7WAAAABl'
       . 'BMVEUAAAD///+l2Z/dAAAASUlEQVR4XqWQUQoAIAxC2/0vXZDr'
       . 'EX4IJTRkb7lobNUStXsB0jIXIAMSsQnWlsV+wULF4Avk9fLq2r'
       . '8a5HSE35Q3eO2XP1A1wQkZSgETvDtKdQAAAABJRU5ErkJggg==';
$data = base64_decode($data);

$im = imagecreatefromstring($data);
if ($im !== false) {
  header('Content-Type: image/png');
  imagepng($im);
  imagedestroy($im);
}
else {
    echo 'An error occurred.';
}
</pre>

<p>
I think <a href="#org754d9a8">header:cache-control</a> is automatically set to no cache
To set Content-Length, do this
</p>
<pre class="example">
ob_start();
imagejpeg($img);

header('Content-Type: image/jpg');
header("Content-length: " . ob_get_length()); 
// images do not compression e.g. gzip

imagedestroy($im);
// send it
ob_flush();
</pre>
</div>
</div>

<div id="outline-container-org8890d7c" class="outline-4">
<h4 id="org8890d7c"><span class="section-number-4">1.19.3</span> Resize image</h4>
<div class="outline-text-4" id="text-1-19-3">
<p>
<a href="https://github.com/claviska/SimpleImage">SimpleImage - GD library</a>
</p>

<pre class="example">
require 'SimpleImage.php';
try {
  // Create a new SimpleImage object
  $image = new \claviska\SimpleImage();
  //$new_file = __DIR__ . '/'.$file_path.$file_no_ext.'_200x200f.'.$ext;
  $new_file = $file_path.$file_no_ext.'_200x200f.'.$ext;

  $image
    -&gt;fromFile($file_orig_full)              // load parrot.jpg
    //-&gt;autoOrient()                        // adjust orientation based on exif data
    -&gt;bestFit(200, 200)
    -&gt;toFile($new_file);                         // output to the screen
  $localW = $image-&gt;getWidth();
  $localH = $image-&gt;getHeight();
  var_dump($localW, $localH);
} catch(Exception $err) {
  // Handle errors
  echo $err-&gt;getMessage();
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd762c44" class="outline-3">
<h3 id="orgd762c44"><span class="section-number-3">1.20</span> Apply XSLT on XML</h3>
<div class="outline-text-3" id="text-1-20">
<pre class="example">
$xml = new DOMDocument;
$xml-&gt;load('cdcatalog.xml');

$xsl = new DOMDocument;
$xsl-&gt;load('cdcatalog.xsl');

$proc = new XSLTProcessor;
$proc-&gt;importStyleSheet($xsl);

echo $proc-&gt;transformToXML($xml);
</pre>
</div>
</div>

<div id="outline-container-orge727870" class="outline-3">
<h3 id="orge727870"><span class="section-number-3">1.21</span> Block Referral Traffic</h3>
<div class="outline-text-3" id="text-1-21">
<pre class="example">
if ( isset( $_SERVER['HTTP_REFERER'] ) ) {
  $_referer_domain = array(
    "~timebie\.com~i",
    "~ana-white\.com~i",
    "~mlizcochico\.com~i",
    "~adishofdailylife\.com~i",
    "~techvibes\.com~i",
    "~sociableblog\.com~i",
    "~laurenconrad\.com~i",
    "~gingerhotels\.com~i",
    "~grammarist\.com~i",
    "~dobbersports\.com~i",
    "~netsidebar\.com~i",
    "~myhomeideas\.com~i",
    "~fhm\.com~i",
    "~gamezebo\.com~i"
  );

  foreach ( $_referer_domain as $_referer ) {
    if ( preg_match( $_referer, $_SERVER['HTTP_REFERER'] ) ) {
      exit;
    }
  }
  // php:parse_url
  $_referrer = parse_url($_SERVER['HTTP_REFERER']);
  if ($_referrer !== false &amp;&amp; !is_null($_referrer['host'])
      &amp;&amp; preg_match( "~oralhealthgroup\.com~i", $_referrer['host'] )) {
    $_p = (isset($_GET['p'])) ? $_GET['p'] : '';
    $_subid = (isset($_GET['subid'])) ? $_GET['subid'] : '';
    $_uid = (isset($_GET['uid'])) ? $_GET['uid'] : '';
    if ($_p !== '' &amp;&amp; $_subid !== '' &amp;&amp; $_uid !== '') {
      exit;
    }
  }
}
</pre>
</div>
</div>

<div id="outline-container-org44ffd64" class="outline-3">
<h3 id="org44ffd64"><span class="section-number-3">1.22</span> <a href="#org924f46f">PHPDoc</a> <a id="org924f46f">PHPDoc</a></h3>
<div class="outline-text-3" id="text-1-22">
<p>
<a href="https://www.drupal.org/coding-standards/docs">https://www.drupal.org/coding-standards/docs</a>
<a href="https://www.drupal.org/node/1354">https://www.drupal.org/node/1354</a>
The docblock has to be immediately above the code.
</p>

<pre class="example">
/**
 * One-line summary, ending in a period (.).
 *
 * Additional paragraph of explanation.
 * Additional paragraph of explanation.
 *
 * @since 3.1.0
 * @param string $mail
 *   The email address. The description can be longer if necessary, and if so,
 *   you can wrap it to another line. Indented by 2 spaces
 * @param string $from
 *   (optional) The email address to send the mail from, if different from
 *   the site-wide address.
 * @param string $bcc One line description.
 * @return int One line description.
 */
</pre>

<p>
Order of sections
</p>
<ul class="org-ul">
<li>One-line summary ending in a period .</li>
<li>Addtional paragraphs of explanation</li>
<li id="@var"><a href="#org5c79c93">PHPDoc:@var</a></li>
<li id="@param">only for function</li>
<li>@return</li>
<li>@throws</li>
<li>@ingroup</li>
<li>@deprecated</li>
<li id="@see"><a href="#orgb22522a">PHPDoc:@see</a></li>
<li>@todo</li>
<li>@Plugin</li>
</ul>

<p>
Separate different-type sections by a blank line
</p>
<pre class="example">
// blank line
@param first param
@param second param
// blank line
@return
</pre>
</div>

<div id="outline-container-org9b11e4f" class="outline-4">
<h4 id="org9b11e4f"><span class="section-number-4">1.22.1</span> Tag reference</h4>
<div class="outline-text-4" id="text-1-22-1">
</div>
<div id="outline-container-org745bee0" class="outline-5">
<h5 id="org745bee0"><span class="section-number-5">1.22.1.1</span> @code</h5>
<div class="outline-text-5" id="text-1-22-1-1">
<pre class="example">
* Example usage:
* @code
* mymodule_print('Hello World!');
* @endcode
* Text to immediately follow the code block.
</pre>
</div>
</div>
</div>

<div id="outline-container-org8d94b21" class="outline-4">
<h4 id="org8d94b21"><span class="section-number-4">1.22.2</span> datatype <a id="org8aa7289">PHPDoc:datatype</a></h4>
<div class="outline-text-4" id="text-1-22-2">
<pre class="example">
int
string|bool
\Drupal\Core\Database\StatementInterface
int[]
\Drupal\node\NodeInterface[]
$this
static
null
object
resource
true
false
float
</pre>

<p>
Examples
</p>
<pre class="example">
@return $this
@return static
</pre>
</div>
</div>

<div id="outline-container-org01c355d" class="outline-4">
<h4 id="org01c355d"><span class="section-number-4">1.22.3</span> @var <a id="org5c79c93">PHPDoc:@var</a></h4>
<div class="outline-text-4" id="text-1-22-3">
<p>
@var [<a href="#org8aa7289">PHPDoc:datatype</a>]
</p>
<pre class="example">
class FooBar {

  /**
   * The database connection object for this statement's DatabaseConnection.
   *
   * @var \Drupal\Core\Database\Connection
   */
  public $dbh;

}
</pre>
</div>
</div>

<div id="outline-container-org0e3bd21" class="outline-4">
<h4 id="org0e3bd21"><span class="section-number-4">1.22.4</span> @see <a id="orgb22522a">PHPDoc:@see</a></h4>
<div class="outline-text-4" id="text-1-22-4">
<pre class="example">
@see AnotherClassName::Methodname() or AnotherClassName::$varname
@see elementname() =&gt; to search a function or method
@see $elementname =&gt; to search var in the current class
</pre>
</div>
</div>

<div id="outline-container-org3072b35" class="outline-4">
<h4 id="org3072b35"><span class="section-number-4">1.22.5</span> @example</h4>
<div class="outline-text-4" id="text-1-22-5">
<p>
It can be used to demo by presenting the contents of files that use them.
</p>

<pre class="example">
@example [location] [&lt;start-line&gt; [&lt;number-of-lines&gt;] ] [&lt;description&gt;]
@example example1.php Some Description
</pre>
</div>
</div>
</div>

<div id="outline-container-org018fa41" class="outline-3">
<h3 id="org018fa41"><span class="section-number-3">1.23</span> mysqli</h3>
<div class="outline-text-3" id="text-1-23">
<pre class="example">
$mysqli = new mysqli("localhost", "my_user", "my_password", "world");

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$mysqli-&gt;query("CREATE TEMPORARY TABLE myCity LIKE City");

$city = "'s Hertogenbosch";

$city = $mysqli-&gt;real_escape_string($city);

if ($mysqli-&gt;query("INSERT into myCity (Name) VALUES ('$city')")) {
    printf("%d Row inserted.\n", $mysqli-&gt;affected_rows);
}


// You don't have to close it
// $mysqli-&gt;close();

$query = &lt;&lt;&lt;SQL
INSERT INTO   abc_inv_tbl (
...
      ) VALUES (
        NOW(),
        '{$db-&gt;real_escape_string($vehicle_name)}',
        '{$db-&gt;real_escape_string($vehicle_cond)}',
        '',
        {$vehicle_year},
        {$vehicle_type},
        {$vehicle_model},
        {$run_hours},
        '{$db-&gt;real_escape_string($trans)}',
        '{$db-&gt;real_escape_string($horsepower)}',
        '{$db-&gt;real_escape_string($desc)}'
      )
SQL;
</pre>
</div>
</div>

<div id="outline-container-org73ed4f7" class="outline-3">
<h3 id="org73ed4f7"><span class="section-number-3">1.24</span> OOP</h3>
<div class="outline-text-3" id="text-1-24">
<p>
OOP Features
</p>
<ul class="org-ul">
<li>Abstraction</li>
<li>Encapsulation (expose functionality and access control)
<dl class="org-dl">
<dt>protected</dt><dd>accessed within class, inherited (parent) / inheriting (child) classes</dd>
<dt>private</dt><dd>only the current class can access</dd>
<dt>(no term)</dt><dd>prefix underscore for protected and private properties' names</dd>
</dl></li>
<li>Hierarchy (inheritance)</li>
<li>Modularity (accomplish one task)</li>
<li id="Polymorphism (interface">interact with classes without knowing what class it is)</li>
</ul>
</div>

<div id="outline-container-org1c6c795" class="outline-4">
<h4 id="org1c6c795"><span class="section-number-4">1.24.1</span> Sample</h4>
<div class="outline-text-4" id="text-1-24-1">
<p>
RestJson.php
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">rest</span> = <span style="color: #ffad29; font-weight: bold;">new</span> <span style="color: #34cae2;">RestJson</span>(<span style="color: #e67128;">'12345'</span>, <span style="color: #e67128;">'trucks'</span>, <span style="color: #e67128;">'new'</span>);
<span style="color: #74af68;">// </span><span style="color: #74af68;">Class name should use UpperCamel, can have underscores and numbers</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">SampleXmlClass, not SampleXMLClass</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">Names should not include Drupal, Class</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">Interface should always prefix "Interface"</span>
<span style="color: #ffad29; font-weight: bold;">class</span> <span style="color: #34cae2;">RestJson</span> {
  <span style="color: #74af68;">// </span><span style="color: #74af68;">constant: strings, booleans, integers</span>
  <span style="color: #ffad29; font-weight: bold;">const</span> <span style="color: #34cae2;">MY_CONSTANT_VAR</span> = 1;

  <span style="color: #ffad29; font-weight: bold;">public</span> <span style="color: #ffad29; font-weight: bold;">static</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">valid_address_types</span> = [
     <span style="color: #008b8b;">RestJson</span><span style="color: #e1e1e0; background-color: #2d3743;">::</span><span style="color: #008b8b;">MY_CONSTANT_VAR</span> =&gt; <span style="color: #e67128;">'Residence'</span>,
  ];

  <span style="color: #ffad29; font-weight: bold;">public</span> <span style="color: #ffad29; font-weight: bold;">static</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">filterables</span>; <span style="color: #74af68;">// </span><span style="color: #74af68;">singleton. same for every instance.</span>

  <span style="color: #ffad29; font-weight: bold;">public</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">lwp_options</span>, <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">listings</span>; <span style="color: #74af68;">// </span><span style="color: #74af68;">can be different for each instance</span>

  <span style="color: #74af68;">// </span><span style="color: #74af68;">Can only be updated by static function/method</span>

  <span style="color: #74af68;">// </span><span style="color: #74af68;">variable and function names should be lowerCamel and avoid underscores</span>

  <span style="color: #74af68;">// </span><span style="color: #74af68;">variable can have default value that is static. e.g. value of time() is not allowed or reference to another varialbe $a = $b</span>

  <span style="color: #ffad29; font-weight: bold;">public</span> <span style="color: #ffad29; font-weight: bold;">function</span> <span style="color: #00ede1; font-weight: bold;">__construct</span>(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">did</span>, <span style="color: #34cae2;">array</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">industry</span>, <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">condition</span>)  {
    <span style="color: #74af68;">// </span><span style="color: #74af68;">Call a static function</span>
    <span style="color: #008b8b;">$</span><span style="color: #008b8b;">this</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #dbdb95;">lwp_options</span> = <span style="color: #ffad29; font-weight: bold;">self</span><span style="color: #e1e1e0; background-color: #2d3743;">::</span>getLwpOptions();
    <span style="color: #74af68;">// </span><span style="color: #74af68;">Call a instance function</span>
    <span style="color: #008b8b;">$</span><span style="color: #008b8b;">this</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #dbdb95;">listings</span> = <span style="color: #008b8b;">$</span><span style="color: #008b8b;">this</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #e1e1e0; background-color: #2d3743;">getListings</span>();

  }

  <span style="color: #ffad29; font-weight: bold;">public</span> <span style="color: #ffad29; font-weight: bold;">static</span> getLwpOptions() {
    <span style="color: #74af68;">// </span><span style="color: #74af68;">A static function can return a value</span>
    <span style="color: #74af68;">// </span><span style="color: #74af68;">can change a static property</span>
    <span style="color: #74af68;">// </span><span style="color: #74af68;">self::$filterables[] = '123';</span>
    <span style="color: #74af68;">// </span><span style="color: #74af68;">But can't access the instance $this</span>
    <span style="color: #74af68;">// </span><span style="color: #74af68;">Can't modify instance value $this-&gt;aPropertyName</span>
    <span style="color: #74af68;">// </span><span style="color: #74af68;">Can't call instance method $this-&gt;aMethod();</span>
  }

  <span style="color: #74af68;">// </span><span style="color: #74af68;">Private and protected properties/methods prefixed with a single underscore</span>
}

<span style="color: #74af68;">// </span><span style="color: #74af68;">Class::method()</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">Class::$property</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0894207" class="outline-4">
<h4 id="org0894207"><span class="section-number-4">1.24.2</span> Inheritance</h4>
<div class="outline-text-4" id="text-1-24-2">
<p>
Child can override parent's constants but not constants declared in interface
Child can override parent's methods but with the same name and arguments (except constructors)
Child can override parent's methods and make them have the same or less restricted visibility
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #74af68;">// </span><span style="color: #74af68;">class ParentChild extends Parent {}</span>
<span style="color: #ffad29; font-weight: bold;">class</span> <span style="color: #34cae2;">AddressResidence</span> <span style="color: #ffad29; font-weight: bold;">extends</span> <span style="color: #34cae2;">Address</span> {}
</pre>
</div>
</div>
</div>

<div id="outline-container-org98ae469" class="outline-4">
<h4 id="org98ae469"><span class="section-number-4">1.24.3</span> Abstract Class</h4>
<div class="outline-text-4" id="text-1-24-3">
<p>
Abstract class cannot be instantiated
If a method is abstract, any class (not abstract class) that extends that abstract class containing the method must also declare a method with the same name and arguments.
If a class has an abstract method, then the class itself must be abstract.
</p>

<pre class="example">
abstract class Address {
  public function __construct() {
    $this-&gt;_init();
  }

  /**
   * Force extending classes to implement init method.
   */
  abstract protected function _init();
}

class AddressBusiness extends Address {
  // Methods that implement abastract method
  // must have the same scope OR less restrictive
  protected function _init() {
    $this-&gt;_setAddressTypeId(Address::ADDRESS_TYPE_BUSINESS);
  }
}
</pre>
</div>
</div>

<div id="outline-container-orgd9fc18d" class="outline-4">
<h4 id="orgd9fc18d"><span class="section-number-4">1.24.4</span> Interface</h4>
<div class="outline-text-4" id="text-1-24-4">
<p>
Specify what methods must be implemented but not how
A class can implement multiple interfaces
Use <code>final</code> in parent class to prevent child class from overriding the method/property
</p>

<pre class="example">
final public function load() {}
</pre>
</div>
</div>

<div id="outline-container-org1105a16" class="outline-4">
<h4 id="org1105a16"><span class="section-number-4">1.24.5</span> Interface vs Abstract Class</h4>
<div class="outline-text-4" id="text-1-24-5">
<ul class="org-ul">
<li>Interfaces  can have no state or implementation</li>
<li>a class that implements an interface must provide an implementation of all the methods of the interface</li>
<li>abstract classes may contain state (data members) and/or implementation (methods)</li>
<li>abstract classes can be inherited without implementing the abstract methods</li>
<li>interfaces may be multiple-inherited, abstract classes may not. Biggest difference.</li>
</ul>
</div>
</div>

<div id="outline-container-org2398b95" class="outline-4">
<h4 id="org2398b95"><span class="section-number-4">1.24.6</span> Use trait with interface</h4>
<div class="outline-text-4" id="text-1-24-6">
<p>
Always use a trait that fulfils one, all or extra capabilities that are
</p>
<ul class="org-ul">
<li>required by an interface that the current class implements</li>
<li>or required by an abstract class that the current class extends</li>
</ul>

<pre class="example">
interface Person {
    public function greet();
    public function eat($food);
}

trait EatingTrait {
    public function eat($food)
    {
        $this-&gt;putInMouth($food);
    }

    private function putInMouth($food)
    {
        // digest delicious food
    }
}

class NicePerson implements Person {
    use EatingTrait;

    public function greet()
    {
        echo 'Good day, good sir!';
    }
}

class MeanPerson implements Person {
    use EatingTrait;

    public function greet()
    {
        echo 'Your mother was a hamster!';
    }
}
</pre>
</div>
</div>

<div id="outline-container-orga363b74" class="outline-4">
<h4 id="orga363b74"><span class="section-number-4">1.24.7</span> Magic Methods</h4>
<div class="outline-text-4" id="text-1-24-7">
<p>
<a href="http://php.net/manual/en/language.oop5.magic.php">http://php.net/manual/en/language.oop5.magic.php</a>
Starts with 2 underscores. They are for:
</p>
<ul class="org-ul">
<li>Trigger custom behavior</li>
<li>Customize object creation</li>
<li id="Ignore scope">access or change hidden properties</li>
<li>With magic method, the performance is about 3 to 10 times slower..</li>
</ul>
</div>

<div id="outline-container-org98a73f0" class="outline-5">
<h5 id="org98a73f0"><span class="section-number-5">1.24.7.1</span> Overloading</h5>
<div class="outline-text-5" id="text-1-24-7-1">
<p>
These are to dynamically "create" a property or method of an instance that has not been declared, or is not visible in the current scope.
</p>

<p>
Can't be used in static properties.
</p>

<p>
__set() is triggered when writing data to inaccessible properties
__get() is triggered when reading data from inaccessible properties.
</p>

<p>
They are all public functions
</p>

<pre class="example">
protected $_postal_code;

function __get($name) {
  
  if (!$this-&gt;_postal_code) {
    $this-&gt;_postal_code = $this-&gt;_postal_code_guess();
  }
  $protected_property_name = '_' . $name;
  if (property_exists($this, $proteced_property_name)) {
   return $this-&gt;$protected_property_name;
  }

  trigger_error('Undefined property via __get:' . $name);
  return NULL;
}
</pre>
</div>
</div>

<div id="outline-container-org19d862a" class="outline-5">
<h5 id="org19d862a"><span class="section-number-5">1.24.7.2</span> __construct, __destruct</h5>
<div class="outline-text-5" id="text-1-24-7-2">
<pre class="example">
class BaseClass {
  function __construct() {
    print "In BaseClass constructor\n";
  }
}

class SubClass extends BaseClass {
  function __construct() {
    parent::__construct();
    print "In SubClass constructor\n";
  }
}
</pre>
</div>
</div>

<div id="outline-container-org192eb39" class="outline-5">
<h5 id="org192eb39"><span class="section-number-5">1.24.7.3</span> __toString()</h5>
<div class="outline-text-5" id="text-1-24-7-3">
<p>
Turn an object to a string when <code>echo $obj;</code> Exception cannot be thrown within __toString() method.
</p>
</div>
</div>

<div id="outline-container-orgccad83e" class="outline-5">
<h5 id="orgccad83e"><span class="section-number-5">1.24.7.4</span> __clone()</h5>
<div class="outline-text-5" id="text-1-24-7-4">
<pre class="example">
class SubObject
{
  static $instances = 0;
  public $instance;

  public function __construct() {
    $this-&gt;instance = ++self::$instances;
  }

  public function __clone() {
    $this-&gt;instance = ++self::$instances;
  }
}

class MyCloneable
{
  public $object1;
  public $object2;

  function __clone()
  {
    // Force a copy of this-&gt;object, otherwise
    // it will point to same object. (shallow copy)
    $this-&gt;object1 = clone $this-&gt;object1;
  }
}

$obj = new MyCloneable();

$obj-&gt;object1 = new SubObject();
$obj-&gt;object2 = new SubObject();

$obj2 = clone $obj;


print("Original Object:\n");
print_r($obj);

print("Cloned Object:\n");
print_r($obj2);


Original Object:
MyCloneable Object
(
  [object1] =&gt; SubObject Object
(
  [instance] =&gt; 1
        )

    [object2] =&gt; SubObject Object
(
  [instance] =&gt; 2
        )

)
Cloned Object:
MyCloneable Object
(
  [object1] =&gt; SubObject Object
(
  [instance] =&gt; 3
        )

    [object2] =&gt; SubObject Object
(
  [instance] =&gt; 2
        )

)
</pre>
</div>
</div>
</div>

<div id="outline-container-orge96cbea" class="outline-4">
<h4 id="orge96cbea"><span class="section-number-4">1.24.8</span> Clone, copy and reference</h4>
<div class="outline-text-4" id="text-1-24-8">
<p>
$obj1 <code>= $obj2 :: do 2 objects have the same property names and values
$obj1 ==</code> $obj2 :: do 2 objects have the same properties and also are those 2 instances of the same class
get_class($obj1) ::
$obj1 instanceof AddressBusiness ::
</p>

<p>
Clone, rather than just $obj1=$obj2, __clone magic method can be used.
Reference is faster than clone and direct copy. But when <code>===</code> is used to compare the two, they are different.
</p>

<pre class="example">
$address_business = new AddressBusiness(array(
  'street_address_1' =&gt; '123 Phony Ave',
  'city_name' =&gt; 'Villageland',
  'subdivision_name' =&gt; 'Region',
  'country_name' =&gt; 'Canada',
));

$address_park = new AddressPark(array(
  'street_address_1' =&gt; '789 Missing Circle',
  'street_address_2' =&gt; 'Suite 0',
  'city_name' =&gt; 'Hamlet',
  'subdivision_name' =&gt; 'Territory',
  'country_name' =&gt; 'Australia',
));
echo $address_park;

echo '&lt;h2&gt;Cloning AddressPark&lt;/h2&gt;';

$address_park_clone = clone $address_park;

echo '$address_park_clone is ' . ($address_park == $address_park_clone ?
  '' : 'not ') . ' a copy of $address_park.';
// $address_park_clone is a copy of $address_park

echo '&lt;h2&gt;Copying AddressBusiness reference&lt;/h2&gt;';

$address_business_copy = &amp;$address_business;

echo '$address_business_copy is ' . ($address_business === $address_business_copy ?
  '' : 'not ') . ' a copy of $address_business.';
// $address_business_copy is a copy of $address_business

echo '&lt;h2&gt;Setting address_business_copy as a new AddressPark&lt;/h2&gt;';
$address_business = new AddressPark();

echo '$address_business_copy is ' . ($address_business === $address_business_copy ?
  '' : 'not ') . ' a copy of $address_business.';

// $address_business_copy is not a copy of $address_business

echo '&lt;br/&gt;$address_business is class ' . get_class($address_business) . '.';

// $address_business is class AddressPark.

echo '&lt;br/&gt;$address_business_copy is ' . ($address_business_copy instanceof
AddressBusiness ? '' : 'not ') . ' an AddressBusiness.';

// $address_business_copy is an AddressPark
</pre>
</div>
</div>

<div id="outline-container-orgad965a3" class="outline-4">
<h4 id="orgad965a3"><span class="section-number-4">1.24.9</span> Autoload Classes</h4>
<div class="outline-text-4" id="text-1-24-9">
<pre class="example">
function my_autoloader($class) {
    include 'classes/' . $class . '.class.php';
}

spl_autoload_register('my_autoloader');

// Or, using an anonymous function as of PHP 5.3.0
spl_autoload_register(function ($class) {
    include 'classes/' . $class . '.class.php';
});
</pre>

<pre class="example">
namespace Foobar;

class Foo {
    static public function test($name) {
        print '[['. $name .']]';
    }
}

spl_autoload_register(__NAMESPACE__ .'\Foo::test'); // As of PHP 5.3.0
</pre>
</div>
</div>

<div id="outline-container-org0a6b9d2" class="outline-4">
<h4 id="org0a6b9d2"><span class="section-number-4">1.24.10</span> Design Pattern</h4>
<div class="outline-text-4" id="text-1-24-10">
</div>
<div id="outline-container-org12df92a" class="outline-5">
<h5 id="org12df92a"><span class="section-number-5">1.24.10.1</span> Singleton Pattern</h5>
<div class="outline-text-5" id="text-1-24-10-1">
<p>
e.g. database connection
</p>
</div>
</div>

<div id="outline-container-orge8ecf5c" class="outline-5">
<h5 id="orge8ecf5c"><span class="section-number-5">1.24.10.2</span> Lazy Initialization</h5>
<div class="outline-text-5" id="text-1-24-10-2">
<ul class="org-ul">
<li>at the beginning properties are null and populated on demand</li>
<li>If null, set and return</li>
<li>If value, just return</li>
</ul>
</div>
</div>

<div id="outline-container-org08c858f" class="outline-5">
<h5 id="org08c858f"><span class="section-number-5">1.24.10.3</span> Factory Method</h5>
<div class="outline-text-5" id="text-1-24-10-3">
<p>
Creat objects without specifying class
</p>
<pre class="example">
class Address {
  const ADDRESS_TYPE_RESIDENCE = 2;
  
  static public $valid_address_types = array(
    Address::ADDRESS_TYPE_RESIDENCE =&gt; 'Residence',
    Address::ADDRESS_TYPE_BUSINESS =&gt; 'Business',
    Address::ADDRESS_TYPE_PARK =&gt; 'Park',
  );

  final public static function getInstance($address_type_id, $data = []) {
    $class_name = 'Address'. self::$valid_address_types[$address_type_id];
    if (!class_exists($class_name)) {
      throw new ExceptionAddress('Address subclass not found. cannot create: ', self::ADDRESS_ERROR_UNKNOWN_SUBCLASS);
    }
    return new $class_name($data);
  }
}

// end class

$address_residence = AddressFactory::getInstance(Address::ADDRESS_TYPE_RESIDENCE);
</pre>
</div>
</div>

<div id="outline-container-orgc1caa8c" class="outline-5">
<h5 id="orgc1caa8c"><span class="section-number-5">1.24.10.4</span> Strategy Pattern</h5>
<div class="outline-text-5" id="text-1-24-10-4">
<ul class="org-ul">
<li>Finite number of strategies, check each one if it can be satisfied in a loop, the last strategy is the best preferred one</li>
<li>Each strategy implements a common interface which has a check method: isAvailable and a action-method: display</li>
<li>Each strategy is singleton</li>
<li>The best strategy is chosen in an Lazy Initialization process</li>
</ul>

<pre class="example">
class Address {
  const ADDRESS_ERROR_NO_DISPLAY_STRATEGY = 1002;

  private static $_display_strategies = [
    'AddressDisplayNoCountry', 'AddressDisplayFull', 'AddressDisplayPark'
  ];

  private $_display_strategy;

  function display() {
    // Lazy initialization
    if (is_null($this-&gt;_display_strategy)) {
      foreach (self::$_display_strategies as $strategy_class_name) {
        if ($strategy_class_name::isAvailable($this)) {
          $this-&gt;_display_strategy = $strategy_class_name;
        }
      }
    }
    if (!$this-&gt;_display_strategy) {
      throw new Exception('No display strategy found', self::ADDRESS_ERROR_NO_DISPLAY_STRATEGY);
    }
    $display_strategy = $this-&gt;_display_strategy;
    return $display_strategy::display($this);

  }

}
</pre>

<pre class="example">
interface AddressDisplay {
  /**
   * AddressDisplay an Address.
   * @return string
   */
  public static function display($address);

  /**
   * Is this method of display available?
   * @return boolean
   */
  public static function isAvailable($address);
}
</pre>

<pre class="example">
class AddressDisplayFull implements AddressDisplay {
  /**
   * Display an addess with a country.
   */
  public static function display($address) {
    $output = AddressDisplayNoCountry::display($address);
    $output .= '&lt;br/&gt;';
    $output .= $address-&gt;country_name;
    return $output;
  }

  /**
   * Is this method of display available?
   * @return boolean
   */
  public static function isAvailable($address) {
    return $address-&gt;country_name ? TRUE : FALSE;
  }
}
</pre>
</div>
</div>

<div id="outline-container-org29d31a9" class="outline-5">
<h5 id="org29d31a9"><span class="section-number-5">1.24.10.5</span> Dependency Injection</h5>
<div class="outline-text-5" id="text-1-24-10-5">
<pre class="example">
class StoreService {
    private $geolocationService;

    public function __construct(GeolocationService $geolocationService) {
        $this-&gt;geolocationService = $geolocationService;
    }

    public function getStoreCoordinates($store) {
        return $this-&gt;geolocationService-&gt;getCoordinatesFromAddress($store-&gt;getAddress());
    }
}
</pre>

<pre class="example">
interface GeolocationService {
    public function getCoordinatesFromAddress($address);
}

class GoogleMaps implements GeolocationService { ...

class OpenStreetMap implements GeolocationService { ...
</pre>
</div>
</div>

<div id="outline-container-org356ad7c" class="outline-5">
<h5 id="org356ad7c"><span class="section-number-5">1.24.10.6</span> Decorator</h5>
<div class="outline-text-5" id="text-1-24-10-6">
<p>
Class Book has 3 methods: getAuthor, getTitle, getAuthorAndTitle
</p>

<p>
Decorator BookTitleDecorator adds methods: resetTitle and showTitle. When it instaniates, it resets the title of an instance of Book (in this example, the original title is not changed)
Decorator BookTitleStarDecorator extends BookTitleDecorator and adds method <code>starTitle</code> which outputs title in a different format
Decorator BookTitleExclaimDecorator extends BookTitleDecorator and adds metod <code>exclaimTitle</code> which outputs title in another different format
</p>

<p>
Decorator adds a wrapper on top of the original class Book with extra functions. This way it doesn't change other instances of the Book class.
</p>

<p>
Because the base decorator BookTitleDecorator has dependency injection of class Book, it also has Dependency Injection design pattern.
</p>

<p>
Moreover, a decorator has to know which class the decorator decorates. But this class can be abstract (superclass).
</p>

<pre class="example">
$patternBook = new Book('Gamma, Helm, Johnson, and Vlissides', 'Design Patterns');
$decorator = new BookTitleDecorator($patternBook);
$starDecorator = new BookTitleStarDecorator($decorator);
$exclaimDecorator = new BookTitleExclaimDecorator($decorator);
 
  writeln('showing title : ');
  writeln($decorator-&gt;showTitle());
  writeln('');
 
  writeln('showing title after two exclaims added : ');
  $exclaimDecorator-&gt;exclaimTitle();
  $exclaimDecorator-&gt;exclaimTitle();
  writeln($decorator-&gt;showTitle());
  writeln('');
 
  writeln('showing title after star added : ');
  $starDecorator-&gt;starTitle();
  writeln($decorator-&gt;showTitle());
  writeln('');
 
  writeln('showing title after reset: ');
  writeln($decorator-&gt;resetTitle());
  writeln($decorator-&gt;showTitle());
  writeln('');

  writeln('END TESTING DECORATOR PATTERN');

  function writeln($line_in) {
    echo $line_in."&lt;br/&gt;";
  }
</pre>

<pre class="example">
class Book {
    private $author;
    private $title;
    function __construct($title_in, $author_in) {
        $this-&gt;author = $author_in;
        $this-&gt;title  = $title_in;
    }
    function getAuthor() {
        return $this-&gt;author;
    }
    function getTitle() {
        return $this-&gt;title;
    }
    function getAuthorAndTitle() {
      return $this-&gt;getTitle().' by '.$this-&gt;getAuthor();
    }
}

class BookTitleDecorator {
    protected $book;
    protected $title;
    public function __construct(Book $book_in) {
        $this-&gt;book = $book_in;
        $this-&gt;resetTitle();
    }   
    //doing this so original object is not altered
    function resetTitle() {
        $this-&gt;title = $this-&gt;book-&gt;getTitle();
    }
    function showTitle() {
        return $this-&gt;title;
    }
}

class BookTitleExclaimDecorator extends BookTitleDecorator {
    private $btd;
    public function __construct(BookTitleDecorator $btd_in) {
        $this-&gt;btd = $btd_in;
    }
    function exclaimTitle() {
        $this-&gt;btd-&gt;title = "!" . $this-&gt;btd-&gt;title . "!";
    }
}

class BookTitleStarDecorator extends BookTitleDecorator {
    private $btd;
    public function __construct(BookTitleDecorator $btd_in) {
        $this-&gt;btd = $btd_in;
    }
    function starTitle() {
        $this-&gt;btd-&gt;title = Str_replace(" ","*",$this-&gt;btd-&gt;title);
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org42941e9" class="outline-4">
<h4 id="org42941e9"><span class="section-number-4">1.24.11</span> Namespace</h4>
<div class="outline-text-4" id="text-1-24-11">
<p>
./index.php
</p>
<pre class="example">
include_once __DIR__."/../app/config.php";
include_once __DIR__."/../app/controllers/sys-curl.php"
</pre>

<p>
./../app/config.php
</p>
<pre class="example">
namespace MyApp\Abc;
class CONFIG {
  static public function config() {
    return 'abc';
  }
}
</pre>

<p>
./../app/controllers/sys-curl.php
</p>
<pre class="example">
namespace MyApp\Abc;
class SYS_CURL {
  public function PULL() {
    $config = CONFIG::config();
  }
}
</pre>
</div>
</div>

<div id="outline-container-org2d537a1" class="outline-4">
<h4 id="org2d537a1"><span class="section-number-4">1.24.12</span> Cannot redeclare class</h4>
<div class="outline-text-4" id="text-1-24-12">
<p>
class_exists is case-insensitive match. Better to restart PHP first.
</p>
<pre class="example">
if (!class_exists('MyClass')) {
  class MyClass {...}
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org536edb6" class="outline-3">
<h3 id="org536edb6"><span class="section-number-3">1.25</span> Http Request - cURL, file_get_contents</h3>
<div class="outline-text-3" id="text-1-25">
</div>
<div id="outline-container-org8542db2" class="outline-4">
<h4 id="org8542db2"><span class="section-number-4">1.25.1</span> cURL-less <a id="org6dcec15">php:file_get_contents</a></h4>
<div class="outline-text-4" id="text-1-25-1">
<p>
Use file_get_contents for PHP5. Some host might disable file_get_contents. Use cURL method
Make sure <a href="#org7d327c1">php.ini:allow_url_fopen</a> is enabled.
</p>

<div class="org-src-container">
<pre class="src src-php"><span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">url</span> = <span style="color: #e67128;">'http://server.com/path'</span>;
<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">data</span> = <span style="color: #ffad29; font-weight: bold;">array</span>(<span style="color: #e67128;">'key1'</span> =&gt; <span style="color: #e67128;">'value1'</span>, <span style="color: #e67128;">'key2'</span> =&gt; <span style="color: #e67128;">'value2'</span>);

<span style="color: #74af68;">// </span><span style="color: #74af68;">use key 'http' even if you send the request to https://...</span>
<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">options</span> = <span style="color: #ffad29; font-weight: bold;">array</span>(
    <span style="color: #e67128;">'http'</span> =&gt; <span style="color: #ffad29; font-weight: bold;">array</span>(
  <span style="color: #e67128;">'header'</span>  =&gt; <span style="color: #e67128;">"Content-type: application/x-www-form-urlencoded\r\n"</span>,
  <span style="color: #e67128;">'method'</span>  =&gt; <span style="color: #e67128;">'POST'</span>,
  <span style="color: #e67128;">'content'</span> =&gt; http_build_query(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">data</span>)
    )
);
<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">context</span>  = stream_context_create(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">options</span>);
<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">result</span> = file_get_contents(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">url</span>, <span style="color: #008b8b;">false</span>, <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">context</span>);

<span style="color: #ffad29; font-weight: bold;">if</span> (<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">result</span> === <span style="color: #008b8b;">FALSE</span>) { <span style="color: #74af68;">/* </span><span style="color: #74af68;">Handle error */</span> }

<span style="color: #74af68;">// </span><span style="color: #74af68;">need to make sure string is UTF-8 php:string:encoding</span>

var_dump(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">result</span>);
</pre>
</div>
</div>
</div>

<div id="outline-container-org15bef2a" class="outline-4">
<h4 id="org15bef2a"><span class="section-number-4">1.25.2</span> cURL <a id="org76352d0">php:curl</a></h4>
<div class="outline-text-4" id="text-1-25-2">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">url</span> = <span style="color: #e67128;">'http://www.someurl.com'</span>; <span style="color: #74af68;">// </span><span style="color: #74af68;">if this url is external, then it's safe to use.</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">usually don't ever refer back to the same server because there might be firewall setting to prevent curl the local server</span>

<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">myvars</span> = <span style="color: #e67128;">'myvar1='</span> . <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">myvar1</span> . <span style="color: #e67128;">'&amp;myvar2='</span> . <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">myvar2</span>;

<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">ch</span> = curl_init();
<span style="color: #74af68;">// </span><span style="color: #74af68;">use curl_setopt to set each one</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">curl_setopt( $ch, CURLOPT_POST, 1);</span>

<span style="color: #74af68;">// </span><span style="color: #74af68;">use curl_setopt_array to set multiple</span>

<span style="color: #74af68;">// </span><span style="color: #74af68;">$verbose = fopen('php://temp', 'w+'); // enable debug</span>

<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">options</span> = <span style="color: #ffad29; font-weight: bold;">array</span>(
 <span style="color: #008b8b;">CURLOPT_URL</span> =&gt; <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">url</span>,
 <span style="color: #008b8b;">CURLOPT_POSTFIELDS</span> =&gt; <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">myvars</span>,
 <span style="color: #008b8b;">CURLOPT_FOLLOWLOCATION</span> =&gt;  1,
 <span style="color: #008b8b;">CURLOPT_HEADER</span> =&gt; 0,
 <span style="color: #008b8b;">CURLOPT_RETURNTRANSFER</span> =&gt; 1,
 <span style="color: #74af68;">// </span><span style="color: #74af68;">CURLOPT_VERBOSE =&gt; true, // enable debug</span>
 <span style="color: #74af68;">// </span><span style="color: #74af68;">CURLOPT_STDERR =&gt; $verbose, // enable debug</span>
 <span style="color: #74af68;">// </span><span style="color: #74af68;">CURLOPT_USERAGENT =&gt; 'cPanel-Cron' // refer to waf:modsecurity, only works for GET request</span>
);

curl_setopt_array(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">ch</span>, <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">options</span>);

<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">response</span> = curl_exec( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">ch</span> );

<span style="color: #74af68;">// </span><span style="color: #74af68;">catch debug BEFORE close</span>
<span style="color: #74af68;">/*</span>
<span style="color: #74af68;">if (curl_errno($ch)) { var_dump(curl_errno($ch)); }</span>
<span style="color: #74af68;">rewind($verbose);</span>
<span style="color: #74af68;">$verboseLog = stream_get_contents($verbose);</span>
<span style="color: #74af68;">echo "Verbose information:\n&lt;pre&gt;", htmlspecialchars($verboseLog), "&lt;/pre&gt;\n";</span>
<span style="color: #74af68;">*/</span>

curl_close(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">ch</span>);
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgcfa5b6e" class="outline-3">
<h3 id="orgcfa5b6e"><span class="section-number-3">1.26</span> PHP HTTP Header <a id="orga1d37b6">php:header</a></h3>
<div class="outline-text-3" id="text-1-26">
<p>
Refer to <a href="#org754d9a8">header:cache-control</a>
</p>
<div class="org-src-container">
<pre class="src src-php">header(<span style="color: #e67128;">"Cache-Control: no-store, no-cache, must-revalidate, max-age=0"</span>);
header(<span style="color: #e67128;">"Cache-Control: post-check=0, pre-check=0"</span>, <span style="color: #008b8b;">false</span>);
header(<span style="color: #e67128;">"Pragma: no-cache"</span>);
</pre>
</div>

<p>
Set amount of time to cache
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">seconds_to_cache</span> = 3600;
<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">ts</span> = gmdate(<span style="color: #e67128;">"D, d M Y H:i:s"</span>, time() + <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">seconds_to_cache</span>) . <span style="color: #e67128;">" GMT"</span>;
header(<span style="color: #e67128;">"Expires: </span><span style="color: #dbdb95;">$ts</span><span style="color: #e67128;">"</span>);
header(<span style="color: #e67128;">"Pragma: cache"</span>);
header(<span style="color: #e67128;">"Cache-Control: max-age=</span><span style="color: #dbdb95;">$seconds_to_cache</span><span style="color: #e67128;">"</span>);
</pre>
</div>
</div>
</div>

<div id="outline-container-org273dcd0" class="outline-3">
<h3 id="org273dcd0"><span class="section-number-3">1.27</span> Troubleshooting</h3>
<div class="outline-text-3" id="text-1-27">
</div>
<div id="outline-container-org129d15a" class="outline-4">
<h4 id="org129d15a"><span class="section-number-4">1.27.1</span> Parse error: syntax error, unexpected end of file</h4>
<div class="outline-text-4" id="text-1-27-1">
<p>
Or <code>Parse error: syntax error, unexpected 'endwhile' (t_endwhile)</code>
</p>

<p>
Check if php <code>short_open_tag</code> is enabled. Default is not enabled. 
Then search <code>&lt;? ~ with a space and replace them with ~&lt;?php</code>
</p>
</div>
</div>
</div>

<div id="outline-container-orgb5e33b9" class="outline-3">
<h3 id="orgb5e33b9"><span class="section-number-3">1.28</span> Naming Convention</h3>
<div class="outline-text-3" id="text-1-28">
<p>
ClassNamesLike
methodName
propertyName
function_name (global function)
FunctionNamesLike (local function) 
$variable_name
$localVariableName
</p>

<p>
CONSTANTS_LIKE_THIS
</p>

<p>
Global names must be prefixed or use namespace.
</p>
</div>
</div>

<div id="outline-container-orgcb0c1f1" class="outline-3">
<h3 id="orgcb0c1f1"><span class="section-number-3">1.29</span> Shell Exec Command</h3>
<div class="outline-text-3" id="text-1-29">
<pre class="example">
echo shell_exec("whoami");
</pre>
</div>
</div>

<div id="outline-container-org3ca6afc" class="outline-3">
<h3 id="org3ca6afc"><span class="section-number-3">1.30</span> Session</h3>
<div class="outline-text-3" id="text-1-30">
<p>
PHP relies on client cookie PHPSESSID to identify session.
</p>

<p>
Javascript <a href="#org88b9832">XMLHttpRequest</a> made on the same domain always transfer all cookies.
</p>

<pre class="example">
// need to start session. check if session is already started.
if (session_id() == "")
  session_start();
</pre>
</div>
</div>

<div id="outline-container-org9f95be7" class="outline-3">
<h3 id="org9f95be7"><span class="section-number-3">1.31</span> Development mode determined by url parameter</h3>
<div class="outline-text-3" id="text-1-31">
<pre class="example">
if (is_dev('demo-aap')) {
  // add class prefix
  // *-demo-aap
  // add class to id
  // *-demo-aap
}

function is_dev($app) {
  return (isset($_GET['edemo']) &amp;&amp; $_GET['edemo'] == $app) ? true : false;
  // for production always return true;
}

.orig-class {...}
.orig-class-demo-aap {...}
;; #element-id {...}
;; #element-id.element-id-demo-aap {...}
</pre>
</div>
</div>

<div id="outline-container-org16934c7" class="outline-3">
<h3 id="org16934c7"><span class="section-number-3">1.32</span> RESTful</h3>
<div class="outline-text-3" id="text-1-32">
<p>
GET /tickets - Retrieves a list of tickets
GET /tickets/12 - Retrieves a specific ticket
POST /tickets - Creates a new ticket
PUT /tickets/12 - Updates ticket #12
PATCH /tickets/12 - Partially updates ticket #12
DELETE /tickets/12 - Deletes ticket #12
</p>

<p>
Read Put request
</p>
<pre class="example">
$method = $_SERVER['REQUEST_METHOD'];
if ('PUT' === $method) {
    parse_str(file_get_contents('php://input'), $_PUT);
    var_dump($_PUT); //$_PUT contains put fields 
}
</pre>
</div>
</div>

<div id="outline-container-orge164938" class="outline-3">
<h3 id="orge164938"><span class="section-number-3">1.33</span> Libraries</h3>
<div class="outline-text-3" id="text-1-33">
</div>
<div id="outline-container-org5e532d2" class="outline-4">
<h4 id="org5e532d2"><span class="section-number-4">1.33.1</span> mPDF</h4>
<div class="outline-text-4" id="text-1-33-1">
<p>
Convert HTML to PDF <a href="https://github.com/mpdf/mpdf">https://github.com/mpdf/mpdf</a>
<a href="https://mpdf.github.io/css-stylesheets/supported-css.html">https://mpdf.github.io/css-stylesheets/supported-css.html</a>
</p>
</div>

<div id="outline-container-org9e389a7" class="outline-5">
<h5 id="org9e389a7"><span class="section-number-5">1.33.1.1</span> @page</h5>
<div class="outline-text-5" id="text-1-33-1-1">
<p>
<a href="https://mpdf.github.io/paging/using-page.html">https://mpdf.github.io/paging/using-page.html</a>
</p>

<pre class="example">
@page {
      margin-top: 1cm;
      margin-bottom: 3cm;
      margin-left: 2cm;
      margin-right: 2cm;
}

body {
     background-image: url(paper-size-ratio.jpg);
     background-repeat:no-repeat;
     background-position:top center;
     background-image-resize:6;
}
</pre>

<p>
Paper size
</p>
<dl class="org-dl">
<dt>A4</dt><dd>210 × 297 millimeters or 8.27 × 11.69 inches</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org92edc53" class="outline-4">
<h4 id="org92edc53"><span class="section-number-4">1.33.2</span> Mobile-Detect</h4>
<div class="outline-text-4" id="text-1-33-2">
<p>
Device tect, browser detect :: <a href="https://github.com/serbanghita/Mobile-Detect">GitHub</a> <a href="https://github.com/serbanghita/Mobile-Detect/wiki/Code-examples">Examples</a>
</p>

<pre class="example">
require_once 'Mobile_Detect.php';
$detect = new Mobile_Detect;

$detect-&gt;isIphone();
$detect-&gt;isSamsung();
$detect-&gt;is('iphone');
$detect-&gt;version('Android');

if ($detect-&gt;isMobile()) {}

if ($detect-&gt;isTablet()) {}

// Check for any mobile device, excluding tablets.
if ($detect-&gt;isMobile() &amp;&amp; !$detect-&gt;isTablet()) {}

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb355d57" class="outline-2">
<h2 id="orgb355d57"><span class="section-number-2">2</span> Drupal</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org8595050" class="outline-3">
<h3 id="org8595050"><span class="section-number-3">2.1</span> Install Drupal on Windows</h3>
<div class="outline-text-3" id="text-2-1">
<p>
<a href="https://www.drupal.org/node/970492">https://www.drupal.org/node/970492</a>
</p>
</div>
</div>

<div id="outline-container-org0d10c43" class="outline-3">
<h3 id="org0d10c43"><span class="section-number-3">2.2</span> Update Core</h3>
<div class="outline-text-3" id="text-2-2">
<p>
<a href="#orgdf7b140">pantheon:drupal:core</a>
</p>

<p>
For Windows, you may need to stop and do the file changes and then start again. Restart IIS
</p>
<pre class="example">
iisreset -stop
iisreset -start

// this stops and starts
iisreset
</pre>

<p>
<a href="https://www.drupal.org/docs/7/updating-your-drupal-site/how-to-update-drupal-core">https://www.drupal.org/docs/7/updating-your-drupal-site/how-to-update-drupal-core</a>
Summary
</p>
<ul class="org-ul">
<li>Make backup</li>
<li>Download and Extract</li>
<li>Set website on maintenance mode</li>
<li>Delete all files and folders 
<ul class="org-ul">
<li>don't delete folder <code>/sites</code></li>
<li>delete folders <code>/profiles/minimal</code> <code>/profiles/standard</code> <code>/profiles/testing</code></li>
<li>delete folders <code>/includes</code> <code>/misc</code> <code>/modules</code> <code>/scripts</code> <code>/themes</code></li>
<li>reapply <code>.htaccess</code> <code>robots.txt</code> <code>web.config</code> <code>settings.php</code></li>
<li>reapply any modified files and folders</li>
</ul></li>
<li>Some updates don't include settings.php. If it includes, replace the old one in <i>sites/default</i> with the new one and apply your previous changes</li>
<li>replace favicon.ico</li>
<li>Login as user 1 and run update.php</li>

<li>If you are unable to access update.php do the following: (allow update.php to be run when not logged in as admin)
<ul class="org-ul">
<li>Open settings.php with a text editor.</li>
<li>Find the line that says: <code>$update_free_access = FALSE;</code> Change it into: <code>$update_free_access = TRUE;</code></li>
<li>Try again to run update.php.</li>
<li>Once the update is done, $update_free_access must be reverted to FALSE.</li>
<li>In a multi-site installation, run update.php again for each site.</li>
</ul></li>

<li>Navigate to Administration &gt; Configuration &gt; Development &gt; Performance and clear all cache</li>
<li>Admin &gt; Reports &gt; Status to Verify everything is working as expected.</li>
<li>Ensure that $update_free_access is FALSE in settings.php.</li>
<li>Disable maintenance mode</li>
</ul>

<p>
<a href="https://www.drupal.org/project/module_missing_message_fixer">https://www.drupal.org/project/module_missing_message_fixer</a> to overcome these errors
</p>

<pre class="example">
The following module is missing from the file system: MODULE NAME. In order to fix this, put the module back in its original location. For more information, see the documentation page.
</pre>

<p>
Or
</p>

<pre class="example">
User warning: The following module is missing from the file system: MODULE NAME. In order to fix this, put the module back in its original location. For more information, see the the documentation page. in _drupal_trigger_error_with_delayed_logging()
</pre>

<p>
In order to check available updates for core and modules, module Update Manager needs to be enabled.
</p>
</div>

<div id="outline-container-org8067c5b" class="outline-4">
<h4 id="org8067c5b"><span class="section-number-4">2.2.1</span> 7.x</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
Legend
</p>
<ul class="org-ul">
<li>If no changes for .htaccess, web.config, robots.txt nor settings.php, then there's no description. Otherwise, it will indicate which ones to update.</li>
</ul>
<p>
7.50 :: <a href="#orgeaaad02">d7:ts:module is missing</a> robots.txt, default.settings.php, add .editorconfig file
7.51, 7.52
<a href="https://www.drupal.org/project/drupal/releases/7.53">7.53</a> :: update jQuery to 1.7-1.11.0
<a href="https://www.drupal.org/project/drupal/releases/7.54">7.54</a>
<a href="https://www.drupal.org/project/drupal/releases/7.55">7.55</a>
<a href="https://www.drupal.org/project/drupal/releases/7.56">7.56</a> :: security
<a href="https://www.drupal.org/project/drupal/releases/7.57">7.57</a> :: security
<a href="https://www.drupal.org/project/drupal/releases/7.58">7.58</a> :: security
</p>
</div>
</div>

<div id="outline-container-org844409f" class="outline-4">
<h4 id="org844409f"><span class="section-number-4">2.2.2</span> Troubleshoot</h4>
<div class="outline-text-4" id="text-2-2-2">
</div>
<div id="outline-container-org36251d4" class="outline-5">
<h5 id="org36251d4"><span class="section-number-5">2.2.2.1</span> The following module is missing from the file system</h5>
<div class="outline-text-5" id="text-2-2-2-1">
<p>
<a id="orgeaaad02">d7:ts:module is missing</a>
<a href="https://www.drupal.org/node/2487215">https://www.drupal.org/node/2487215</a>
</p>

<p>
My situation is that a module is installed but removed from file system without disabling and uninstalling it
Because the module code no longer exists, so I need to manually remove traces in db.
D7
</p>
<pre class="example">
drush sql-query "DELETE from system where name = 'old_module1' AND type = 'module';"
</pre>

<p>
If module name is not found in db, most likely the code incorrectly refers to a non-existing module such as drupal_get_path('module', 'deletedmodname'). Do backtrace to identify.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org9b5037d" class="outline-3">
<h3 id="org9b5037d"><span class="section-number-3">2.3</span> Update Module</h3>
<div class="outline-text-3" id="text-2-3">
<ul class="org-ul">
<li>Read module README first</li>
<li>Usually just remove the module directory and put the new one in</li>
<li>And run update.php</li>
</ul>
</div>
</div>

<div id="outline-container-org4cc9383" class="outline-3">
<h3 id="org4cc9383"><span class="section-number-3">2.4</span> Module</h3>
<div class="outline-text-3" id="text-2-4">
</div>
<div id="outline-container-org52b4314" class="outline-4">
<h4 id="org52b4314"><span class="section-number-4">2.4.1</span> Custom Module</h4>
<div class="outline-text-4" id="text-2-4-1">
</div>
<div id="outline-container-org4d5b948" class="outline-5">
<h5 id="org4d5b948"><span class="section-number-5">2.4.1.1</span> .info file</h5>
<div class="outline-text-5" id="text-2-4-1-1">
<p>
<a href="https://www.drupal.org/node/542202#files">Instructions</a>
</p>

<p>
Module name must contain only lower-case and undersocre
sites/all/modules/custom/my_module or sites/all/themes/custom/my_theme
my_module.info, my_module.module
</p>

<p>
Use <code>;</code> at the beginning of a line to mark as comment
<code>name = A Human Readable Name</code>
<code>description = More is &lt;a href=""&gt;here&lt;/a&gt;.</code> It can only one line with 255 characters and it's HTML (e.g. accented characters)!
<code>core = 7.x</code> Can't specify minor version.
<code>package = Views</code> <code>package = Example modules</code>
If your module comes with other modules or it's meant to be used exclusively with other modules, provide the package name here. 
More than 4 modules that depend on each other can make a package.
</p>

<p>
<code>files[] = includes/context.inc</code> This .inc file should be class or interface. To include .inc with plain functions
</p>

<p>
Clear cache when .info is changed
</p>

<p>
A submodule under a package may not add parent module to dependencies and submodule names can be anything given the parent module is <code>examples</code>:
</p>
<ul class="org-ul">
<li>action_example</li>
<li>action_examples</li>
<li>example_action</li>
</ul>

<pre class="example">
dependencies[] = entity
dependencies[] = views (&gt;=3.12)
dependencies[] = exampleapi (1.x)
dependencies[] = exampleapi (&gt;7.x-1.5)
dependencies[] = exampleapi (&gt;1.0, &lt;=3.2, !=3.0)
dependencies[] = system (&gt;=7.53)
</pre>

<p>
Optional
</p>
<pre class="example">
configure = admin/config/content/my_mymodule

; hide on modules page. e.g. SimpleTest where end-users should never enable the testing modules
hidden = TRUE
</pre>
</div>
</div>

<div id="outline-container-orgcd8f048" class="outline-5">
<h5 id="orgcd8f048"><span class="section-number-5">2.4.1.2</span> Refactor, include .inc files</h5>
<div class="outline-text-5" id="text-2-4-1-2">
<pre class="example">
function ctools_include($file, $module = 'ctools', $dir = 'includes') {
  static $used = array();

  $dir = '/' . ($dir ? $dir . '/' : '');

  if (!isset($used[$module][$dir][$file])) {
    require_once DRUPAL_ROOT . '/' . drupal_get_path('module', $module) . "$dir$file.inc";
    $used[$module][$dir][$file] = TRUE;
  }
}

// ctools_include('utility', 'ctools', 'includes');
// ctools_include('macro', 'mymodule', 'includes');
</pre>
</div>
</div>

<div id="outline-container-orgc149e39" class="outline-5">
<h5 id="orgc149e39"><span class="section-number-5">2.4.1.3</span> lili.api.php</h5>
<div class="outline-text-5" id="text-2-4-1-3">
<p>
Just include this in module root directory and all hooks will be defined
</p>
</div>
</div>
</div>

<div id="outline-container-org8333abb" class="outline-4">
<h4 id="org8333abb"><span class="section-number-4">2.4.2</span> sqlsrv</h4>
<div class="outline-text-4" id="text-2-4-2">
<p>
Install PDO Microsoft Drivers for PHP for SQL Server
<a href="https://docs.microsoft.com/en-us/sql/connect/php/system-requirements-for-the-php-sql-driver?view=sql-server-2017">https://docs.microsoft.com/en-us/sql/connect/php/system-requirements-for-the-php-sql-driver?view=sql-server-2017</a>
</p>

<p>
For PHP 5.x, use PDO 3.2
For PHP 7.x, use PDO 5.2
</p>

<p>
PDO 4.x and 5.x supports PHP 7 only.
<a href="https://docs.microsoft.com/en-us/sql/connect/php/system-requirements-for-the-php-sql-driver?view=sql-server-2017#driver-versions">https://docs.microsoft.com/en-us/sql/connect/php/system-requirements-for-the-php-sql-driver?view=sql-server-2017#driver-versions</a>
</p>

<p>
Download 4.0, 3.2, 3.1, 3.0 <a href="https://www.microsoft.com/en-us/download/details.aspx?id=20098">https://www.microsoft.com/en-us/download/details.aspx?id=20098</a>
run SQLSRV32.EXE on the real server, select the version and any place to extract the drivers.
</p>

<p>
To download other versions for PHP 7 :: <a href="https://docs.microsoft.com/en-us/sql/connect/php/download-drivers-php-sql-server?view=sql-server-2017">https://docs.microsoft.com/en-us/sql/connect/php/download-drivers-php-sql-server?view=sql-server-2017</a>
</p>

<p>
To find out which PHP version is used in IIS :: Your website &gt; Handler Mappings &gt; FastCgiModule
Setup PHP on IIS <a href="https://docs.microsoft.com/en-us/iis/web-hosting/web-server-for-shared-hosting/fastcgi-with-php">https://docs.microsoft.com/en-us/iis/web-hosting/web-server-for-shared-hosting/fastcgi-with-php</a>
</p>

<p>
If php5.dll is used, then it's non-threaded, if php5ts.dll (thread safe), then it is threaded. Use the correct version of the SQLSERV and PDO_SQLSERV drivers.
</p>

<p>
Non-thread safe :: php_sqlsrv_54_nts.dll php_pdo_sqlsrv_54_nts.dll
</p>

<p>
Put those into ext folder. Check extension_dir in php.ini.
</p>

<p>
Change these lines in php.ini
</p>
<pre class="example">
;extension=php_pdo_sqlsrv.dll
;extension=php_sqlsrv.dll

extension=php_pdo_sqlsrv_54_nts.dll
extension=php_sqlsrv_54_nts.dll
</pre>

<p>
Run <code>iisreset</code> to restart IIS.
</p>
</div>
</div>

<div id="outline-container-org9905517" class="outline-4">
<h4 id="org9905517"><span class="section-number-4">2.4.3</span> Feeds - Package: Feeds</h4>
<div class="outline-text-4" id="text-2-4-3">
<p>
Requires <a href="#org570c9d3">d7:ctools</a> d7:job_scheduler
Test requires: date:date entity_translation:entity_translation feeds_xpathparser:feeds_xpathparser i18n:i18n_taxonomy link:link rules:rules variable:variable
Submodules: 
</p>
<ul class="org-ul">
<li>feeds_import</li>
<li>feeds_news</li>
<li>feeds_ui</li>
</ul>

<pre class="example">
$feed_obj = feeds_source($feed_id,$feed-&gt;feed_nid);
$feed_obj-&gt;existing()-&gt;import(); // Use this so no jobs are inserted in batch

// Sequence
$this = feeds_source;
hook_feeds_before_import($this)
hook_feeds_after_parse($this, $parser_result)
FeedsProcessor.inc-&gt;process parser_result
releaseLock()
hook_feeds_after_import($this)
</pre>

<p>
Import drush command runtime can be long. Output something every 5 minutes to prevent drush command timeout
Do this in one of the hooks: 
</p>
<ul class="org-ul">
<li>hook_feeds_before_update</li>
<li>hook_feeds_presave</li>
<li>hook_feeds_after_save</li>
</ul>

<pre class="example">
function lili_feeds_presave(FeedsSource $source, $entity, $item) {

 $request_time = lili_custom_cache('timecounter');
 $interval = 60 * 5;
 if (!is_null($request_time)) {
  $row_counter = lili_custom_cache('rowcounter');
  lili_custom_cache('rowcounter',++$row_counter);
  $current_time = time();
  $seconds = $current_time - $request_time;
  if (floor($seconds/$interval) &gt; 0) {
   lili_custom_cache('timecounter', $current_time);
   print "Presave row #$row_counter. $seconds seconds have passed.\n";
  } 
 }
 else {
  lili_custom_cache('timecounter', REQUEST_TIME);
  lili_custom_cache('rowcounter', 1);
 }

}
</pre>
</div>

<div id="outline-container-orgc63c75b" class="outline-5">
<h5 id="orgc63c75b"><span class="section-number-5">2.4.3.1</span> New Feed Tamper Plugin</h5>
<div class="outline-text-5" id="text-2-4-3-1">
<p>
The plugin does this: <a href="#org15c3fff">Drupal download file with real file extension</a>
</p>

<pre class="example">
// Implements hook_ctools_plugin_directory()
function lili_ctools_plugin_directory($module, $plugin) {
 if ($module == 'feeds_tamper') {
  return 'plugins'; // path_to_lili_module/plugins/lili_*.inc
 }
}

// lili_change_image_extension.inc
// You can refer to path_to_feeds_tamper_module/plugins/explode.inc
$plugin = array(
  'form' =&gt; 'lili_image_extension_form',
  'callback' =&gt; 'lili_image_extension_callback',
  'validate' =&gt; 'lili_image_extension_validate', // optional
  'name' =&gt; 'Convert Image URL Extension',
  'category' =&gt; 'T and T', // group name
  'multi' =&gt; 'direct',
  // If multiple values are injected to the plugin,
  // 'direct' will pass the whole array as $field to callback
  // while 'loop' will loop over and pass each value to callback
);

function lili_image_extension_form($importer, $element_key, $settings) {
  $form = array();
  $form['info'] = array(
    '#markup' =&gt; t('Converts source image URLs that don\'t have regular image extension: jpg, png, etc.'),
  );

  // Extra variables to pass to $settings in callback
  $form['importer_name'] = array(
      '#type' =&gt; 'hidden',
      '#title' =&gt; t('Importer machine name'),
      '#default_value' =&gt; isset($settings['importer_name']) ? $settings['importer_name'] : $importer-&gt;id,
  );

  return $form;
}

function lili_image_extension_validate(&amp;$settings) {
  // Validate $settings.
}

function lili_image_extension_callback($result, $item_key, $element_key, &amp;$field, $settings, $source) {
  //settings has the importer name
  //$settings['importer_name']
  //$field has the importing field text value
  if (!is_array($field)) {
    $field = array($field);
  }

  $val = array();

  foreach ($field as $f) {
    $val[] = _lili_save_file_with_extension($f);
  }
  $field = $val;
}
</pre>
</div>
</div>

<div id="outline-container-org7965a97" class="outline-5">
<h5 id="org7965a97"><span class="section-number-5">2.4.3.2</span> <a href="#orgc0cbc97">XPath</a></h5>
<div class="outline-text-5" id="text-2-4-3-2">
<p>
Children nodes Photo under Images node.
Simply Images/Photo, the result is already array
Concate multiple nodes
<code>concat(photo1,';',photo2)</code> then explode
</p>
</div>
</div>
</div>

<div id="outline-container-org2a83ac9" class="outline-4">
<h4 id="org2a83ac9"><span class="section-number-4">2.4.4</span> Feeds Tamper - feeds_tamper - Package: Feeds</h4>
<div class="outline-text-4" id="text-2-4-4">
<p>
Requires feeds
Submodule: feeds_tamper_ui
</p>
</div>
</div>

<div id="outline-container-org1b1cbb1" class="outline-4">
<h4 id="org1b1cbb1"><span class="section-number-4">2.4.5</span> Feeds Tamper Importer - feeds_tamper_importer - Package: Feeds</h4>
<div class="outline-text-4" id="text-2-4-5">
<p>
Requires feeds_tamper
</p>
</div>
</div>

<div id="outline-container-org0eee24a" class="outline-4">
<h4 id="org0eee24a"><span class="section-number-4">2.4.6</span> Feeds <a href="#orgc0cbc97">XPath</a> Parser - feeds_xpathparser - Package: Feeds</h4>
<div class="outline-text-4" id="text-2-4-6">
<p>
Requires feeds
</p>
</div>
</div>

<div id="outline-container-org30b3497" class="outline-4">
<h4 id="org30b3497"><span class="section-number-4">2.4.7</span> Feeds entity processor - feeds_entity_processor - Package: Feeds</h4>
<div class="outline-text-4" id="text-2-4-7">
<p>
Requires feeds <a href="#orgf487b62">d7:entity</a>
</p>
</div>
</div>

<div id="outline-container-org46499f4" class="outline-4">
<h4 id="org46499f4"><span class="section-number-4">2.4.8</span> XML Sitemap</h4>
<div class="outline-text-4" id="text-2-4-8">
<p>
<i>admin/config/search/xmlsitemap/settings
Uncheck /Prefetch URL aliases during sitemap generation</i>
</p>
</div>
</div>

<div id="outline-container-orge1d9d84" class="outline-4">
<h4 id="orge1d9d84"><span class="section-number-4">2.4.9</span> ThemeKey</h4>
<div class="outline-text-4" id="text-2-4-9">
<p>
<a id="org7c59f42">d7:module:themekey</a>
</p>

<p>
You can switch to a different based on some rules!
If you are not clear about some rules, you can just search in code. e.g. search 'system:query_string'
</p>
</div>
</div>

<div id="outline-container-orgc79bd5d" class="outline-4">
<h4 id="orgc79bd5d"><span class="section-number-4">2.4.10</span> Devel</h4>
<div class="outline-text-4" id="text-2-4-10">
<p>
devel requires nothing
sub modules :: devel_generate, devel_node_access (off)
</p>

<p>
<a href="http://ratatosk.net/drupal/tutorials/debugging-drupal.html">http://ratatosk.net/drupal/tutorials/debugging-drupal.html</a>
</p>

<p>
dpm($input, $name = null) use drupal_set_message and Krumo to dispaly in 'message' area
kpr($input, $return = FALSE, $name=NULL) uses Krumo print in page header not 'message' area.
dvm($input, $name = NULL) use Krumo to var_dump in 'message' area. Good for copy and paste
dpr($input, $return = FALSE, $name = NULL) print in page header not in 'message' area.
</p>
</div>
</div>

<div id="outline-container-orgcb23d1a" class="outline-4">
<h4 id="orgcb23d1a"><span class="section-number-4">2.4.11</span> Administrator menu - admin_menu - Package: Administration</h4>
<div class="outline-text-4" id="text-2-4-11">
<p>
Requires nothing
Submodules: admin_devel, admin_menu_toolbar
</p>
</div>
</div>

<div id="outline-container-orgf1dd0ea" class="outline-4">
<h4 id="orgf1dd0ea"><span class="section-number-4">2.4.12</span> Administration Views - admin_views - Package: Administration</h4>
<div class="outline-text-4" id="text-2-4-12">
<p>
Requies <a href="#org7f5d88f">d7:views</a> <a href="#org77ee0ab">d7:views_bulk_operations</a>
</p>
</div>
</div>

<div id="outline-container-org26c7983" class="outline-4">
<h4 id="org26c7983"><span class="section-number-4">2.4.13</span> Administer Users by Role - administerusersbyrole</h4>
<div class="outline-text-4" id="text-2-4-13">
<p>
Requires chain_menu_access
</p>

<p>
Allow users to edit/delete other users
</p>
</div>
</div>

<div id="outline-container-org6bb21e3" class="outline-4">
<h4 id="org6bb21e3"><span class="section-number-4">2.4.14</span> Variable</h4>
<div class="outline-text-4" id="text-2-4-14">
<p>
<a href="https://www.drupal.org/project/variable">variable</a> requires nothing <a id="orgfe0086e">d7:m:variable</a>
</p>
</div>
</div>

<div id="outline-container-orgf52e34a" class="outline-4">
<h4 id="orgf52e34a"><span class="section-number-4">2.4.15</span> Libraries</h4>
<div class="outline-text-4" id="text-2-4-15">
<p>
requires nothing
</p>
</div>
</div>

<div id="outline-container-org3f03fc6" class="outline-4">
<h4 id="org3f03fc6"><span class="section-number-4">2.4.16</span> Module Filter</h4>
<div class="outline-text-4" id="text-2-4-16">
<p>
<a href="https://www.drupal.org/project/module_filter">module_filter</a> :: requires nothing
</p>
</div>
</div>

<div id="outline-container-org4e23154" class="outline-4">
<h4 id="org4e23154"><span class="section-number-4">2.4.17</span> Geocoder</h4>
<div class="outline-text-4" id="text-2-4-17">
<p>
Requires d7:geophp <a href="#org570c9d3">d7:ctools</a> <a href="#orgf487b62">d7:entity</a> <a id="org13f7642">d7:geocoder</a>
An API and widget to geocode text field into GIS data types.
</p>
</div>
</div>

<div id="outline-container-org5083909" class="outline-4">
<h4 id="org5083909"><span class="section-number-4">2.4.18</span> Entity View Modes - entity_view_mode</h4>
<div class="outline-text-4" id="text-2-4-18">
<p>
Requires nothing <a id="org3f97ae5">d7:entity_view_mode</a>
Recommends d7:field_ui
Create custom View Mode: Default, Teaser under Manage Display
<a href="#org68aad47">d7:ds</a> can also create view mode
</p>
</div>
</div>

<div id="outline-container-orgcf1b01c" class="outline-4">
<h4 id="orgcf1b01c"><span class="section-number-4">2.4.19</span> wysiwyg</h4>
<div class="outline-text-4" id="text-2-4-19">
<p>
requires nothing
Allows the use of client-side editors to edit content
7.x-2.2 to 7.x-2.4 (support TinyMCE from 3.3.9.2 to 4.5.7)
</p>
</div>

<div id="outline-container-orga45d428" class="outline-5">
<h5 id="orga45d428"><span class="section-number-5">2.4.19.1</span> Installation &amp; Config</h5>
<div class="outline-text-5" id="text-2-4-19-1">
<p>
Setup assign text format to trusted roles: admin/config/content/formats
Follow README.md to config Text Format (e.g. Full HTML). Basically remove any restrictions.
Installation Instructions on config page: /admin/config/content/wysiwyg
TinyMCE installation instructions are missing.. Refer to this <a href="https://www.drupal.org/docs/7/modules/wysiwyg/installation">https://www.drupal.org/docs/7/modules/wysiwyg/installation</a>
Basically, download from TinyMCE and put it in sites/all/libraries/tinymce
</p>

<p>
If TinyMCE editor is upgraded, make sure the options for the Wysiwyg profile using TinyMCE is the same as before
admin/config/content/wysiwyg/profile e.g. <a href="https://www.todaystrucking.com/admin/config/content/wysiwyg/profile/full_html/edit">https://www.todaystrucking.com/admin/config/content/wysiwyg/profile/full_html/edit</a>
You need to save the profile after the TinyMCE editor is updated.
</p>

<p>
Supported editor versions: <a href="https://www.drupal.org/project/wysiwyg">https://www.drupal.org/project/wysiwyg</a>
</p>
</div>

<ol class="org-ol">
<li><a id="orgf530ce5"></a><a href="https://www.tinymce.com/docs/configure/">All TinyMCE settings</a><br />
<div class="outline-text-6" id="text-2-4-19-1-1">
<p>
To config other TinyMCE settings and the Wysiwyg module UI doesn't provide, use hook_wysiwyg_editor_settings_alter()
</p>
</div>

<ol class="org-ol">
<li><a id="org0ee1f85"></a>HTML elements are stripped off<br />
<div class="outline-text-7" id="text-2-4-19-1-1-1">
<p>
In /admin/config/content/wysiwyg/profile/full_html/edit, keep Verify HTML on.
</p>
<pre class="example">
function lili_wysiwyg_editor_settings_alter( &amp;$settings, $context ) {
  dpm($settings,  'settings');
  dpm($context, 'context');
  $settings['extended_valid_elements'] .= ',script[language|type|src]';
}
</pre>

<p>
verify_html (bool) :: clean up HTML elements that are allowed for <code>valid_elements</code>, <code>extended_valid_elements</code> and <code>invalid_elements</code>
valid_elements (string) :: there're some but &lt;script&gt; is not allowed
</p>
</div>
</li>
</ol>
</li>
</ol>
</div>

<div id="outline-container-org100ec36" class="outline-5">
<h5 id="org100ec36"><span class="section-number-5">2.4.19.2</span> Troubleshoot</h5>
<div class="outline-text-5" id="text-2-4-19-2">
<p>
Fields in node or block configuration might be empty or some elements are missing after save. 
To see the HTML, disable javascript in Chrome.
</p>
</div>
</div>
</div>

<div id="outline-container-org1843b14" class="outline-4">
<h4 id="org1843b14"><span class="section-number-4">2.4.20</span> IMCE Wysiwyg bridge: imce_wysiwyg</h4>
<div class="outline-text-4" id="text-2-4-20">
<p>
<a href="https://www.drupal.org/project/imce_wysiwyg">https://www.drupal.org/project/imce_wysiwyg</a>
7.x-1.0
requires imce and wysiwyg
</p>
</div>
</div>

<div id="outline-container-org10423a4" class="outline-4">
<h4 id="org10423a4"><span class="section-number-4">2.4.21</span> IMCE</h4>
<div class="outline-text-4" id="text-2-4-21">
<p>
requires nothing
7.x-1.10 to 7.x-1.11
IMCE is an image/file uploader and browser that supports personal directories and quota.
</p>
</div>
</div>

<div id="outline-container-org52af3db" class="outline-4">
<h4 id="org52af3db"><span class="section-number-4">2.4.22</span> ckeditor</h4>
<div class="outline-text-4" id="text-2-4-22">
<p>
requires nothing
</p>
</div>
</div>

<div id="outline-container-orgc519f57" class="outline-4">
<h4 id="orgc519f57"><span class="section-number-4">2.4.23</span> nodeblock</h4>
<div class="outline-text-4" id="text-2-4-23">
<p>
create a block for a node 
</p>
</div>
</div>

<div id="outline-container-org37884df" class="outline-4">
<h4 id="org37884df"><span class="section-number-4">2.4.24</span> Block Group</h4>
<div class="outline-text-4" id="text-2-4-24">
<p>
<a href="https://www.drupal.org/project/blockgroup">blockgroup</a> :: requires core Block <a id="org7a58fc0">d7:blockgroup</a>
This module extends the standard drupal block system with block groups. Each block group provides a new block as well as a corresponding region. Child blocks can be moved into any group region. The position and the settings of the parent block are propagated to its children. Also block groups are nestable.
</p>
</div>
</div>

<div id="outline-container-org395d427" class="outline-4">
<h4 id="org395d427"><span class="section-number-4">2.4.25</span> MultiBlock</h4>
<div class="outline-text-4" id="text-2-4-25">
<p>
<a id="orga3b0f03">d7:multiblock</a> <a href="https://www.drupal.org/project/multiblock">multiblock</a> :: Built-in in D8. Requires core Block
</p>
</div>
</div>

<div id="outline-container-org32dfa0c" class="outline-4">
<h4 id="org32dfa0c"><span class="section-number-4">2.4.26</span> <a href="https://www.drupal.org/project/conditional_fields">Conditional Fields</a></h4>
<div class="outline-text-4" id="text-2-4-26">
<p>
<a href="https://www.drupal.org/project/conditional_fields">conditional_fields</a> :: <a id="org63e5a07">d7:module:conditional fields</a>
</p>

<p>
Conditional Fields for Drupal 7 is an user interface to the new <a href="https://api.drupal.org/api/drupal/includes%21common.inc/function/drupal_process_states/7.x">States API</a>, plus the ability to modify fields appearance and behavior on certain conditions when viewing content.
</p>

<p>
Conditional Fields allows you to manage sets of dependencies between fields. When a field is “dependent”, it will only be available for editing and displayed if the state of the “dependee” field matches the right condition.
When editing a node (or any other entity type that supports fields, like users and categories), the dependent fields are dynamically modified with the States API.
A simple use case would be defining a custom “Article teaser" field that is shown only if a "Has teaser" checkbox is checked, but much more complex options are available.
</p>

<p>
It works on AJAX node edit/new form
</p>
</div>
</div>

<div id="outline-container-org1c5762b" class="outline-4">
<h4 id="org1c5762b"><span class="section-number-4">2.4.27</span> Search404</h4>
<div class="outline-text-4" id="text-2-4-27">
<p>
<a href="https://www.drupal.org/project/search404">search404</a> :: requires core search
</p>

<p>
If a user goes to <a href="http://example.com/does/not/exist">http://example.com/does/not/exist</a>, this module will do a search for "does not exist" and shows the result of the search instead of the 404 page. 
</p>
</div>
</div>

<div id="outline-container-orgda27a63" class="outline-4">
<h4 id="orgda27a63"><span class="section-number-4">2.4.28</span> Google Analytics</h4>
<div class="outline-text-4" id="text-2-4-28">
<p>
<a href="https://www.drupal.org/project/google_analytics">google_analytics</a> :: requires nothing
</p>
</div>
</div>

<div id="outline-container-org29eedd8" class="outline-4">
<h4 id="org29eedd8"><span class="section-number-4">2.4.29</span> Elysia Cron</h4>
<div class="outline-text-4" id="text-2-4-29">
<p>
<a href="https://www.drupal.org/project/elysia_cron">elysia_cron</a> :: Requires nothing.
Don't put a cron key in Elysia otherwise the cron run in drush will not work.
</p>
</div>
</div>

<div id="outline-container-orgea958d6" class="outline-4">
<h4 id="orgea958d6"><span class="section-number-4">2.4.30</span> SMTP Authentication Support</h4>
<div class="outline-text-4" id="text-2-4-30">
<p>
<a href="https://www.drupal.org/project/smtp">smtp</a> :: requires nothing
</p>
</div>
</div>

<div id="outline-container-orgc8fef40" class="outline-4">
<h4 id="orgc8fef40"><span class="section-number-4">2.4.31</span> Entity API - entity</h4>
<div class="outline-text-4" id="text-2-4-31">
<p>
<a href="https://www.drupal.org/project/entity">entity</a> : sub module entity_token <a id="orgf487b62">d7:entity</a>
Requires nothing
1.5 
1.9 no db
</p>
</div>
</div>

<div id="outline-container-orgafd09a8" class="outline-4">
<h4 id="orgafd09a8"><span class="section-number-4">2.4.32</span> Chaos Tools - ctools</h4>
<div class="outline-text-4" id="text-2-4-32">
<p>
<a href="https://www.drupal.org/project/ctools">ctools</a> :: no dependencies <a id="org570c9d3">d7:ctools</a>
From <a href="https://www.drupal.org/project/ctools/releases/7.x-1.10">7.x-1.10</a> to <a href="https://www.drupal.org/project/ctools/releases/7.x-1.12">7.x-1.12</a>
</p>

<p>
$modulepath/help/
$modulepath/help/plugins-creating.html :: all plugin types
</p>
</div>
</div>

<div id="outline-container-orgf4a2353" class="outline-4">
<h4 id="orgf4a2353"><span class="section-number-4">2.4.33</span> Address Field - addressfield - Package: Fields</h4>
<div class="outline-text-4" id="text-2-4-33">
<p>
Requires <a href="#org570c9d3">d7:ctools</a>
</p>

<p>
Field List: admin/reports/fields
</p>

<p>
/moduels/field/field.api.php
<a href="https://api.drupal.org/api/drupal/modules!field!field.api.php/7.x">https://api.drupal.org/api/drupal/modules!field!field.api.php/7.x</a>
</p>
</div>
</div>

<div id="outline-container-org7ba646e" class="outline-4">
<h4 id="org7ba646e"><span class="section-number-4">2.4.34</span> Email - email - Package: Fields</h4>
<div class="outline-text-4" id="text-2-4-34">
<p>
Requires nothing
</p>
</div>
</div>

<div id="outline-container-orgffdc4b1" class="outline-4">
<h4 id="orgffdc4b1"><span class="section-number-4">2.4.35</span> Geofield - Package: Fields</h4>
<div class="outline-text-4" id="text-2-4-35">
<p>
Requires d7:geophp <a href="#org570c9d3">d7:ctools</a>
Used with <a href="#org13f7642">d7:geocoder</a>
</p>
</div>
</div>

<div id="outline-container-org0c531ef" class="outline-4">
<h4 id="org0c531ef"><span class="section-number-4">2.4.36</span> Viewfield - Package: Fields</h4>
<div class="outline-text-4" id="text-2-4-36">
<p>
Requires <a href="#org7f5d88f">d7:views</a>
e.g. An order has multiple items, store those items into a field
</p>
</div>
</div>

<div id="outline-container-org6ddc1aa" class="outline-4">
<h4 id="org6ddc1aa"><span class="section-number-4">2.4.37</span> Field collection - field_collection - Package: Fields</h4>
<div class="outline-text-4" id="text-2-4-37">
<p>
Requires <a href="#orgf487b62">d7:entity</a>
Test require <a href="#orgf487b62">d7:entity</a>_translation
Any number of fields can be attached to a field-collection field which is an entity.
</p>
</div>
</div>

<div id="outline-container-org49e77c6" class="outline-4">
<h4 id="org49e77c6"><span class="section-number-4">2.4.38</span> Social Field - socialfield - Package: Fields</h4>
<div class="outline-text-4" id="text-2-4-38">
<p>
Requires nothing
</p>
</div>
</div>

<div id="outline-container-org1502171" class="outline-4">
<h4 id="org1502171"><span class="section-number-4">2.4.39</span> Video Embed Field - video_embed_field - Package: Media</h4>
<div class="outline-text-4" id="text-2-4-39">
<p>
Requires <a href="#org570c9d3">d7:ctools</a> core image
New field type
Used with video_embed_* modules
</p>

<p>
Have to install other modules to support different providers e.g. video_embed_facebook, video_embed_brightcove
</p>
</div>
</div>

<div id="outline-container-orga21532b" class="outline-4">
<h4 id="orga21532b"><span class="section-number-4">2.4.40</span> Display Suite - ds - Package: Display Suite</h4>
<div class="outline-text-4" id="text-2-4-40">
<p>
Requires <a href="#org570c9d3">d7:ctools</a> <a id="org68aad47">d7:ds</a>
Submoduels
</p>
<dl class="org-dl">
<dt>ds_devel</dt><dd>requires devel</dd>
<dt>ds_extras</dt><dd>admin/structure/ds/list/extras
<dl class="org-dl">
<dt>Field Templates</dt><dd>theme a field. To theme a display field, you don't need to enable it</dd>
<dt>(no term)</dt><dd>Extra Fields</dd>
<dt>(no term)</dt><dd>Other
<dl class="org-dl">
<dt>Region to block</dt><dd>Create a region and move fields into that region Content Type &gt; Manage Display &gt; Block regions
This will create a block which can be used in other places/regions in Blocks setting</dd>
<dt>View mode per node</dt><dd>specify a view mode for each node</dd>
</dl></dd>
</dl></dd>
<dt>(no term)</dt><dd>ds_format</dd>
<dt>(no term)</dt><dd>ds_forms</dd>
<dt>(no term)</dt><dd>ds_search
Integrate search engine such as module apachesolr and <a href="#orgbe2cc79">d7:search_api_solr</a> to display the search results for a content type</dd>
<dt>(no term)</dt><dd>ds_ui</dd>
</dl>

<p>
<a href="https://www.youtube.com/playlist?list=PL7E361A55994F1648">https://www.youtube.com/playlist?list=PL7E361A55994F1648</a>
</p>

<p>
Can display fields of a content type into a layout which has several regions under Manage Display
</p>

<p>
A display field can be created for a content type display. This field is for theming only not physically create a field in db.
Field value can be PHP code and Token can be used.
</p>
<dl class="org-dl">
<dt>Field</dt><dd>custom field with PHP and Token</dd>
<dt>Block field</dt><dd>display a block</dd>
<dt>Dynamic field</dt><dd>choose a variable to display e.g. node_body, menu</dd>
<dt>Preprocess field</dt><dd>display a variable e.g. Node Url (machine name node_url)</dd>
</dl>

<p>
Later theme that display field using ds_extras 
</p>

<p>
View Mode :: Default, Teaser
Create a view mode. <a href="#orgf487b62">d7:entity</a>_view_mode can also create view modes.
To display a view that returns multiple nodes of a content type, go to Format &gt; Show &gt; Display suite &gt; Settings
Choose the custom view mode and also specify the first item to use View Mode #1 and the second item to use View Mode #2, etc.
Custom hook can be selected in this setting to make customization
</p>
</div>
</div>

<div id="outline-container-org557989b" class="outline-4">
<h4 id="org557989b"><span class="section-number-4">2.4.41</span> Meta Tag - metatag</h4>
<div class="outline-text-4" id="text-2-4-41">
<p>
metatag :: requires ctools and token
</p>

<p>
Add metadata tags such as meta description, meta keywords, social media Open Graph
</p>
</div>
</div>

<div id="outline-container-orgbec2115" class="outline-4">
<h4 id="orgbec2115"><span class="section-number-4">2.4.42</span> Entity Reference - entityreference</h4>
<div class="outline-text-4" id="text-2-4-42">
<p>
entityreference :: requires <a href="#org570c9d3">d7:ctools</a> <a href="#orgf487b62">d7:entity</a> <a id="org31d3ec9">d7:entityreference</a>
In D8 core
Add a entity reference field which you can use an entity reference view as a list of values to select from as values in that field.
Refer to <a href="#org5e8b56d">d7:entity reference view</a>
</p>
</div>
</div>

<div id="outline-container-orgb21c9ca" class="outline-4">
<h4 id="orgb21c9ca"><span class="section-number-4">2.4.43</span> File Entity</h4>
<div class="outline-text-4" id="text-2-4-43">
<p>
<a href="https://www.drupal.org/project/file_entity">file_entity</a> <a id="org0f74c68">d7:file entity</a>
Requires: <a href="#org570c9d3">d7:ctools</a>, core: Field, Field SQL storage, File
</p>

<p>
From 7.x-2.0-beta2 to 7.x-2.3
</p>
</div>
</div>

<div id="outline-container-org91f278f" class="outline-4">
<h4 id="org91f278f"><span class="section-number-4">2.4.44</span> Webform</h4>
<div class="outline-text-4" id="text-2-4-44">
<p>
<a id="org3e03f0d">d7:webform</a> <a href="https://www.drupal.org/project/webform">webform</a> :: 7.x-3.x requires nothing. 7.x-4.x requries <a href="#org570c9d3">d7:ctools</a> <a href="#org7f5d88f">d7:views</a> 3
</p>

<p>
hook_form_alter, hook_form_webform_client_form_alter, (&gt; 7.x-4.4 use hook_form_webform_client_form_NID_alter) 
Modify in $form['submitted']
</p>
</div>
</div>

<div id="outline-container-org5fcfa51" class="outline-4">
<h4 id="org5fcfa51"><span class="section-number-4">2.4.45</span> Webform Validation</h4>
<div class="outline-text-4" id="text-2-4-45">
<p>
<a href="https://www.drupal.org/project/webform_validation">webform_validation</a> :: requires <a href="#org3e03f0d">d7:webform</a>
</p>
</div>
</div>

<div id="outline-container-org0e343d6" class="outline-4">
<h4 id="org0e343d6"><span class="section-number-4">2.4.46</span> Panels</h4>
<div class="outline-text-4" id="text-2-4-46">
<p>
<a href="https://www.drupal.org/project/panels">panels</a> :: drag-and-drop layout for admin
Requires: <a href="#org570c9d3">d7:ctools</a>
Has a lot of security updates
From 7.x-3.6 to 7.x-3.9
</p>
</div>
</div>

<div id="outline-container-org6d2b0ce" class="outline-4">
<h4 id="org6d2b0ce"><span class="section-number-4">2.4.47</span> Facet API</h4>
<div class="outline-text-4" id="text-2-4-47">
<p>
<a id="org7215fab">d7:facetapi</a> facetapi :: requires <a href="#org570c9d3">d7:ctools</a>
Sub modules: current_search, facetapi_bonus
</p>
</div>
</div>

<div id="outline-container-org2706599" class="outline-4">
<h4 id="org2706599"><span class="section-number-4">2.4.48</span> Search API - search_api</h4>
<div class="outline-text-4" id="text-2-4-48">
<p>
Requires entity <a id="org0f0cfd5">d7:search_api</a>
sub modules :: search_api_views (views), search_api_facetapi (<a href="#org7215fab">d7:facetapi</a>)
<a href="https://www.drupal.org/docs/7/modules/search-api">https://www.drupal.org/docs/7/modules/search-api</a>
<a href="https://www.youtube.com/watch?v=hcAM0HrEk4c">https://www.youtube.com/watch?v=hcAM0HrEk4c</a>
</p>
</div>

<div id="outline-container-orge8d79d5" class="outline-5">
<h5 id="orge8d79d5"><span class="section-number-5">2.4.48.1</span> Glossary</h5>
<div class="outline-text-5" id="text-2-4-48-1">
<p>
For example, a "Node index" for indexing nodes. It would contain the fields that should be indexed and their types, the data alterations and processors to use and some other settings. The details of how to index data are independent of these settings, and server-specific. Index settings are independent of the inner mechanics of the search server.
</p>

<p>
A server is a concrete way to index and search data. It could, e.g., represent a certain database, a connection to an external search server, etc.
How exactly the data is stored is determined by the server's service class, but is not important for the overall functionality of the Search API.
A server can have an arbitrary number of indexes attached to it, whose search data is then indexed on that server.
</p>

<p>
When creating a server, a service class has to be chosen
</p>
</div>
</div>

<div id="outline-container-org28ea9c1" class="outline-5">
<h5 id="org28ea9c1"><span class="section-number-5">2.4.48.2</span> Index</h5>
<div class="outline-text-5" id="text-2-4-48-2">
<p>
If an index is updated, reindex all content.
</p>
</div>
<ol class="org-ol">
<li><a id="orgd8a2db0"></a>Select index fields<br />
<div class="outline-text-6" id="text-2-4-48-2-1">
<p>
Indexed for those fields for which you want to store data on the search server. These fields can then be searched, used for filtering and sorting, and maybe also used for other purposes.
</p>

<p>
Note that only fields of type Fulltext can be used in fulltext searches. So when you want to find individual words contained in this field, not just the whole field value, use this type. Other types can be used, e.g., for filtering and sorting.
</p>

<p>
Fields indexed with type "Fulltext" and multi-valued fields (marked with 1) cannot be used for sorting. The boost is used to give additional weight to certain fields, e.g. titles or tags. It only takes effect for fulltext fields.
</p>
</div>
</li>

<li><a id="org2cedfbd"></a>Add Related Fields<br />
<div class="outline-text-6" id="text-2-4-48-2-2">
<p>
Items of a certain type might be connected to, or might reference, other kinds of data. For instance, content will always have an author, could also contain references to taxonomy terms, etc. With the Add related fields form at the bottom of the page you can add the fields of those related items to the list, so they can be indexed, too. Use this if you want, e.g., to index the user roles of a node's author. You can also add nested related fields, e.g., the node's author's profile's image's file type.
</p>
</div>
</li>

<li><a id="orgd0e3435"></a>Customize Workflow (Filters Tab)<br />
<div class="outline-text-6" id="text-2-4-48-2-3">
<p>
<a href="https://www.drupal.org/node/1254452">https://www.drupal.org/node/1254452</a>
</p>
</div>

<ol class="org-ol">
<li><a id="orgcea0cc8"></a>Data alterations<br />
<div class="outline-text-7" id="text-2-4-48-2-3-1">
<p>
Bundle filter
Lets you to prevent entities from being indexed based on their bundle (content type for nodes, vocabulary for taxonomy terms, etc.). This way you can, for instance, create an index solely for news.
Language control
Allows you to control the language of items stored in the index. This is done by providing two different functionalities:
Normally, the content of the Item language property (which is automatically added by the Search API for all indexed items) is determined by the item's language property, if available, and otherwise set to undefined. With this data alteration, you can select any other property as an alternative source for the item language, which will then be used instead. Note that the selected field has to contain a single valid ISO language code for each item for this to work, though.
You can then also select the languages items in this index may have. Items with any other language (defined by the Item language property) will be rejected during indexing.
</p>

<p>
Node access
Adds node access checks to searches on this index. This is done by adding a new field, Node access information that stores the relevant access data. When the Node access information, author, and Status fields are present and indexed, appropriate filters will be automatically added to all searches so that they only return results that the current user is allowed to view. Some searches (e.g., search views) provide the option to override this behaviour on a per-search basis, though. Check the corresponding module's documentation for details.
In any case, you have to keep in mind that these access checks are solely based on the indexed data. If a node is edited in a way that changes its accessibility (e.g., by being unpublished), this change will only take effect once the node is indexed in its latest state. This means that there is potentially a gap between changing the node and the update of the access checks on search results, meaning that—depending on the data displayed for search results—users could in that time see data that should not be accessible to them. If you need to avoid that, use the index's Index items immediately option.
</p>

<p>
Also note that access on the individual fields is never checked — don't include them in the display, if they contain sensitive data. Refer to hook_node_access_records() and hook_node_grants() on implementing node access checks. The node access data stored in the index is based on the node_access table which is affected by hook_node_access_records().
The data alteration is only available for node indexes.
</p>

<p>
Search views do not filter based on node access by default. There is a simple option in the query settings called "Additional access checks on result entities" that will do an access check after the actual query is run, but this option should only be used as a last result. Search results counts and facets will not reflect the further restriction applied by views.
</p>

<p>
The proper way to do the node access checks in views is to add a filter on Indexed Node: Node access information. This can be complicated because it is important to know what values the field will hold, and this information can not be output through fields in the view itself. One must look to the data stored in the search server. In the case of Solr, this can be accomplished by examining the sm_search_api_access_node field in the schema browser. A sample value for one configuration of taxonomy access control was node_access_taxonomy_access_role:2. One could make a views search display for authenticated users for example that included all results, and a display for anonymous users that checked that the Node Access Information value is not equal to node_access_taxonomy_access_role:2 in the example above. A brief example can be found in this Drupal Answers answer
</p>

<p>
URL field
Adds a field containing the URL at which the entity can be displayed. For some item types, like nodes, this URL is already available, but this data alteration can be used to also add them for other types.
</p>

<p>
Aggregated fields
Offers the ability to add additional fields to the entity, containing the data from one or more other fields. Use this, e.g., to have a single field containing all data that should be searchable, or to make the text from a string field, like a taxonomy term, also fulltext-searchable.
The type of aggregation can be selected from a set of values: you can, e.g., collect the text data of all contained fields, or add them up, count their values, etc.
</p>

<p>
Complete entity view
Adds a field containing the whole HTML content of the entity as it is viewed on the site. The view mode used can be selected. This allows you to index exactly „what the user sees“, which is often what is expected, but might differ from just indexing the contents of other fields.
Note that this might not work for items of all types. All core entity types except files are supported, though.
</p>

<p>
Index hierarchy
Allows you to index hierarchical fields along with all their parents. Most importantly, this can be used to index taxonomy term references along with all parent terms. This way, when an item, e.g., has the term New York, it will also be matched when filtering for USA or North America.
</p>
</div>
</li>

<li><a id="org80ac563"></a>Processors<br />
<div class="outline-text-7" id="text-2-4-48-2-3-2">
<p>
A processor can do preprocess data that is being indexed, preprocess search queries, and postprocess search results
Refer to service class documentation of the server.
</p>

<p>
Ignore case
Makes searches on selected fields case-insensitive. Some servers might do this automatically, for all others this should probably always be activated, at least for fulltext fields.
</p>

<p>
HTML filter
Strips HTML tags from selected fields and decodes HTML entities. If you are indexing HTML content (like node bodies) and the search server doesn't handle HTML on its own, this should be activated to avoid indexing HTML tags, as well as to give e.g. terms appearing in a heading a higher boost.
</p>

<p>
Tokenizer
This processor allows you to specify how indexed fulltext content is split into seperate tokens – which characters are ignored and which treated as white-space that seperates words.
</p>

<p>
Stopwords
Enables the admin to specify a stopwords file, the words contained in which will be filtered out of the text data indexed. This can be used to exclude too common words from indexing, for servers not supporting this natively.
</p>

<p>
Highlighting
Adds highlighting of search terms to the search results.
</p>
</div>
</li>
</ol>
</li>
</ol>
</div>

<div id="outline-container-org758782b" class="outline-5">
<h5 id="org758782b"><span class="section-number-5">2.4.48.3</span> <a href="https://www.drupal.org/docs/7/modules/search-api/getting-started/search-forms-and-results-pages/search-api-views/creating-a">Create a search view</a> or a search page</h5>
<div class="outline-text-5" id="text-2-4-48-3">
<p>
<a href="https://www.drupal.org/docs/7/modules/search-api/getting-started/search-forms-and-results-pages/search-api-views">https://www.drupal.org/docs/7/modules/search-api/getting-started/search-forms-and-results-pages/search-api-views</a>
Admin &gt; Structure &gt; Views &gt; Add new view (admin/structure/views/add)
</p>

<p>
View name: Search
Show: [the name of the Search index] (in the case of fuzzysearch the default is "Default fuzzysearch index")
Create a page [tick]
Page title: Search
Path: search
Display format: Unformatted list of Rendered entity
Items to display: 10, use pager
Continue &amp; edit (the new View)
</p>

<p>
Format: Show: Rendered entity | Settings
</p>

<p>
View mode: Search results
Filter criteria
</p>

<p>
Fulltext search: Expose this filter, Required, Remember the last selection, Use as: search keys
Sort criteria
</p>

<p>
Search: Relevance, descending (if you don’t have an order with fuzzysearch you will get a PDO exception)
Page settings
</p>

<p>
Access: Permission: view published content
Advanced
</p>

<p>
No results behaviour: Global: Text area “No results matched your search.”
Exposed form
</p>

<p>
Exposed form in block: Yes (This option will only show up on Page displays.)
Exposed form style settings: Submit button text: Search
Save the View. Add the exposed form block to a region.
Note that you will only receive results for partial matches that are longer than the minimum word length specified in the Index configuration.
</p>

<p>
Views based on Search API use as base table a search_api_index_* table, not the usual node table or other ones supported by Views. That is why the Search views are selected at the views' creation moment, and it can not be changed later.
</p>
</div>
</div>

<div id="outline-container-org1c20077" class="outline-5">
<h5 id="org1c20077"><span class="section-number-5">2.4.48.4</span> <a href="https://www.drupal.org/docs/7/modules/search-api/getting-started/search-forms-and-results-pages/search-api-views/convert-an">Convert an existing view to search api</a></h5>
<div class="outline-text-5" id="text-2-4-48-4">
<p>
If the views to be converted use the row plugins Content (node), Fields or Rendered entity, the conversion may be easier (see further). If not (the selected row plugins were others), then unfortunately the views should be fully recreated manually: create a brand new search_api view and recreate all the elements from your old view by hand.
</p>

<p>
For views using Content, Fields or Rendered entity row plugins:
Export the view to be converted. Save this code as a backup.
Modify the view, removing all the Filters (contextual or not), all the Sort criteria and all the Relationships. Write down the removed items: you will need to recreate them manually using the indexed versions.
When the view is clean of filters and sort criteria, export it again.
In the export code, the 5th line will contain the
$view-&gt;base_table
variable. Change it to the search api index to be used in the view (the index must have been created before):
</p>

<p>
$view-&gt;base_table = 'search_api_index_&lt;name_of_your_index&gt;';
Maybe fiddle around with fields (see below).
Go to admin/structure/views/import and import the modified code. Do not forget to select the option Replace an existing view if one exists with the same name. (NOTE: currently there is a bug in Ctools 1.x that makes the Import option not to be shown for administrator users different than uid=1, here is the issue: #870938: Add new permission for controlling imports ).
Add the previously removed Filters, Sort criteria and Relationships, selecting them from the now available indexed versions.
Process will be easy if the views to be converted used the Rendered entity row plugin, since no changes will be required for the row contents.
</p>

<p>
Field fiddling
</p>

<p>
For fields there is no general recipe, although these hints should catch most cases:
</p>

<p>
Care that your index contains all needed fields or create them when import errors bug you.
Look for lines that look like this:
$handler-&gt;display-&gt;display_options['fields']['field_FOO']['table'] = 'TABLE'
If TABLE is 'views', don't change.
If TABLE is 'node' (or your base table) or 'field_data_FOO', change to 'search_api_index_&lt;name_of_your_index&gt;'
</p>
</div>
</div>

<div id="outline-container-orgaffe350" class="outline-5">
<h5 id="orgaffe350"><span class="section-number-5">2.4.48.5</span> Configure Facet, Facet Blocks</h5>
<div class="outline-text-5" id="text-2-4-48-5">
<p>
A block is created for each facet configured. Even though it's set to appear on all pages, it won't display for a search view or a search page.
</p>
</div>
</div>

<div id="outline-container-orgfe240e8" class="outline-5">
<h5 id="orgfe240e8"><span class="section-number-5">2.4.48.6</span> Views Filter &gt; Search: Fulltext search</h5>
</div>
<div id="outline-container-orgffb65ee" class="outline-5">
<h5 id="orgffb65ee"><span class="section-number-5">2.4.48.7</span> Current Search Block</h5>
<div class="outline-text-5" id="text-2-4-48-7">
<p>
current_search is installed with <a href="#org7215fab">d7:facetapi</a>. /admin/config/search/current_search
</p>
</div>
</div>

<div id="outline-container-org10d6a14" class="outline-5">
<h5 id="org10d6a14"><span class="section-number-5">2.4.48.8</span> Other useful modules</h5>
<div class="outline-text-5" id="text-2-4-48-8">
<p>
<a href="https://www.drupal.org/node/1999262">https://www.drupal.org/node/1999262</a>
<a href="https://www.drupal.org/docs/7/modules/search-api/extension-modules">https://www.drupal.org/docs/7/modules/search-api/extension-modules</a>
</p>
</div>
</div>

<div id="outline-container-orgcd21a41" class="outline-5">
<h5 id="orgcd21a41"><span class="section-number-5">2.4.48.9</span> Developer Documentation</h5>
<div class="outline-text-5" id="text-2-4-48-9">
<p>
<a href="https://www.drupal.org/docs/7/modules/search-api/developer-documentation">https://www.drupal.org/docs/7/modules/search-api/developer-documentation</a>
<a href="https://www.drupal.org/docs/7/modules/search-api/advanced-site-building-tutorials">https://www.drupal.org/docs/7/modules/search-api/advanced-site-building-tutorials</a>
</p>
</div>

<ol class="org-ol">
<li><a id="orgcb73617"></a>Execute a search in code<br />
<div class="outline-text-6" id="text-2-4-48-9-1">
<pre class="example">
// Replace "node_index" with you index's machine name.
$query = search_api_query('node_index');

$query-&gt;condition('type', 'product', '=');
$filter = $query-&gt;createFilter('OR');
$filter-&gt;condition('field_category', 'book', '=');
$filter-&gt;condition('field_category', 'magazine', '=');
$query-&gt;filter($filter); 

$data=$query-&gt;execute();
$results=$data['results'];
print_r($results);
</pre>
</div>
</li>

<li><a id="orgbe555a9"></a>Combined fields to do IN or OR across multiple fields<br />
<div class="outline-text-6" id="text-2-4-48-9-2">
<p>
<a href="https://www.drupal.org/docs/7/modules/search-api/advanced-site-building-tutorials/combining-fields">https://www.drupal.org/docs/7/modules/search-api/advanced-site-building-tutorials/combining-fields</a>
<a href="https://www.drupal.org/project/search_api_combined">https://www.drupal.org/project/search_api_combined</a>
</p>

<p>
Limitation
At present the module has been tested for multiple term references and not with any other field type. It is currently set to index all combined fields as lists of items so it will not work with multiple fields that have single values that expect to stay as single values &#x2013; where this is important is in sorting, for instance, since you cannot sort by multiple values with Solr.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-orge625c5d" class="outline-5">
<h5 id="orge625c5d"><span class="section-number-5">2.4.48.10</span> API of Search API</h5>
<div class="outline-text-5" id="text-2-4-48-10">
<p>
<a href="http://www.drupalcontrib.org/api/drupal/contributions!search_api!search_api.api.php/7">http://www.drupalcontrib.org/api/drupal/contributions!search_api!search_api.api.php/7</a>
path-to-mod/search_api/search_api.api.php
</p>

<p>
Search search_api*.api.php
search_api_solr.api.php
</p>
</div>
</div>
</div>

<div id="outline-container-org8571462" class="outline-4">
<h4 id="org8571462"><span class="section-number-4">2.4.49</span> Search API Solr - search_api_solr - Package: Search</h4>
<div class="outline-text-4" id="text-2-4-49">
<p>
<a href="https://www.drupal.org/project/search_api_solr">search_api_solr</a> requires <a href="#org0f0cfd5">d7:search_api</a> and core Search <a id="orgbe2cc79">d7:search_api_solr</a>
It's more powerful than module apachesolr
It creates View Mode called Search Index in each content type
</p>

<p>
Setup an account and create an index on Opensolr.com
</p>

<p>
On OpenSolr UI, upload the 4.x or corresponding Solr version based on OpenSolr version.
path-to-mod/search_api_solr/solr-conf/4.x
<a href="https://opensolr.com/blog/2011/09/how-to-use-with-drupal">https://opensolr.com/blog/2011/09/how-to-use-with-drupal</a>
</p>

<p>
Lucene version :: search lucene in solr-conf/4.x, e.g. solr.luceneMatchVersion=LUCENE_40
&lt;luceneMatchVersion&gt;${solr.luceneMatchVersion:LUCENE_40}&lt;/luceneMatchVersion&gt;
</p>

<p>
In bundle (e.g. node type abc), setup Manage Display for the Search Index.
</p>
</div>

<div id="outline-container-org6fb97aa" class="outline-5">
<h5 id="org6fb97aa"><span class="section-number-5">2.4.49.1</span> Debug</h5>
<div class="outline-text-5" id="text-2-4-49-1">
<p>
In OpenSolr UI for an index (tnt_dev), there's a button Browse Data.
<a href="https://path-to-aws.opensolr.com/solr/tnt_dev/select?q=*:*&amp;wt=json&amp;indent=true&amp;start=0&amp;rows=5">https://path-to-aws.opensolr.com/solr/tnt_dev/select?q=*:*&amp;wt=json&amp;indent=true&amp;start=0&amp;rows=5</a>
</p>

<p>
Insert a key-value pair to search
<a href="https://path-to-aws.opensolr.com/solr/tnt_dev/select?q=im_field_industry:337&amp;wt=json&amp;indent=true&amp;start=0&amp;rows=5">https://path-to-aws.opensolr.com/solr/tnt_dev/select?q=im_field_industry:337&amp;wt=json&amp;indent=true&amp;start=0&amp;rows=5</a>
</p>

<p>
Retrieve the request made to Solr and response from Solr
In <code>search_api_solr/includes/solr_connection.inc</code> add a line below <code>protected function makeHttpRequest</code>
</p>

<pre class="example">
drupal_set_message(check_plain($url)); // &lt;-- Add this line to retrieve request
$result = drupal_http_request($url, $options);
drupal_set_message(check_plain($result-&gt;data)); // &lt;-- Add this line to retrieve response
</pre>
</div>
</div>
</div>

<div id="outline-container-org09db53c" class="outline-4">
<h4 id="org09db53c"><span class="section-number-4">2.4.50</span> Search API Solr Overrides - search_api_solr_overrides</h4>
<div class="outline-text-4" id="text-2-4-50">
<p>
Requires <a href="#orgbe2cc79">d7:search_api_solr</a>
Provides site/environment specific overrides for search_api_solr configuration in settings.php
</p>
</div>
</div>

<div id="outline-container-orgefa216e" class="outline-4">
<h4 id="orgefa216e"><span class="section-number-4">2.4.51</span> Views</h4>
<div class="outline-text-4" id="text-2-4-51">
<p>
<a href="https://www.drupal.org/project/views">Views</a>, sub module Views UI <a id="org7f5d88f">d7:views</a> <a href="#orge112026">d7:viewsapi</a>
Requires <a href="#org570c9d3">d7:ctools</a>
From <a href="https://www.drupal.org/project/views/releases/7.x-3.12">7.x-3.12</a> to <a href="https://www.drupal.org/project/views/releases/7.x-3.15">7.x-3.16</a>
</p>
</div>
</div>

<div id="outline-container-org9aa132e" class="outline-4">
<h4 id="org9aa132e"><span class="section-number-4">2.4.52</span> Better Exposed Filters</h4>
<div class="outline-text-4" id="text-2-4-52">
<p>
<a href="https://www.drupal.org/project/better_exposed_filters">better_exposed_filters</a> <a href="#orge1b8450">d7:better exposed filters</a>
Requires <a href="#org570c9d3">d7:ctools</a> <a href="#org7f5d88f">d7:views</a>
Group under Views
<a href="https://www.drupal.org/project/better_exposed_filters/releases/7.x-3.3">7.x-3.3</a>, <a href="https://www.drupal.org/project/better_exposed_filters/releases/7.x-3.4">7.x-3.4</a>
</p>
</div>
</div>

<div id="outline-container-orgbcc8ed6" class="outline-4">
<h4 id="orgbcc8ed6"><span class="section-number-4">2.4.53</span> Views Bulk Operations</h4>
<div class="outline-text-4" id="text-2-4-53">
<p>
<a href="https://www.drupal.org/project/views_bulk_operations">views_bulk_operations</a> : sub module actions_permissions <a id="org77ee0ab">d7:views_bulk_operations</a>
Requires: <a href="#orgf487b62">d7:entity</a> <a href="#org7f5d88f">d7:views</a>
</p>
</div>
</div>

<div id="outline-container-orga8aa201" class="outline-4">
<h4 id="orga8aa201"><span class="section-number-4">2.4.54</span> Administration views</h4>
<div class="outline-text-4" id="text-2-4-54">
<p>
<a href="https://www.drupal.org/project/admin_views">admin_views</a>: <a href="#org7f5d88f">d7:views</a> <a href="#org77ee0ab">d7:views_bulk_operations</a>
</p>
</div>
</div>

<div id="outline-container-orgfe7bfb2" class="outline-4">
<h4 id="orgfe7bfb2"><span class="section-number-4">2.4.55</span> Media</h4>
<div class="outline-text-4" id="text-2-4-55">
<p>
<a href="https://www.drupal.org/project/media">media</a>
Requires: <a href="#org0f74c68">d7:file entity</a>, <a href="#org570c9d3">d7:ctools</a>, <a href="#org7f5d88f">d7:views</a>
</p>

<p>
From 7.x-2.0-beta1 to 7.x-2.9
</p>
</div>
</div>

<div id="outline-container-org91854ae" class="outline-4">
<h4 id="org91854ae"><span class="section-number-4">2.4.56</span> Internationalization - i18n</h4>
<div class="outline-text-4" id="text-2-4-56">
<p>
<a href="https://www.drupal.org/project/i18n">i18n</a> requires core locale and <a href="#orgfe0086e">d7:m:variable</a>
</p>

<p>
<a id="orgfe1228a">d7:m:i18n</a>
</p>

<dl class="org-dl">
<dt>Add a language</dt><dd>admin/config/regional/language</dd>
<dt>(no term)</dt><dd>Go to pages that use t('string to translate', [], ['langcode'=&gt;"fr"]) with non default options</dd>
</dl>

<p>
Once a language is added (default language is chosen), node created will have $node-&gt;language = 'en'
</p>
</div>
</div>

<div id="outline-container-org84f5460" class="outline-4">
<h4 id="org84f5460"><span class="section-number-4">2.4.57</span> S3 File System - s3fs</h4>
<div class="outline-text-4" id="text-2-4-57">
<p>
requires module libraries, library <code>AWS SDK for PHP 2.x</code>, PHP 5.3.3+ with <code>allow_url_fopen = On</code> in <code>php.ini</code>
</p>

<pre class="example">
drush dl s3fs
drush en s3fs
;; update.php is not necessary
</pre>

<p>
Download library
</p>
<pre class="example">
;;  In Pantheon, 
drush make --no-core code/sites/all/modules/s3fs/s3fs.make code

;; Or 
drush make --no-core sites/all/modules/s3fs/s3fs.make
</pre>

<p>
Check if library is downloaded <code>sites/all/libraries/awssdk2/aws-autoloader.php</code>
</p>

<p>
Drupal setting :: /admin/config/media/s3fs/settings or in settings.php
Set Cache-Control header to be <code>public, max-age=604800</code>
Refer to <a href="#org754d9a8">header:cache-control</a>
</p>

<p>
settings.php
</p>
<pre class="example">
$conf['awssdk2_access_key'] = 'YOUR ACCESS KEY'; 
$conf['awssdk2_secret_key'] = 'YOUR SECRET KEY'; 
$conf['s3fs_root_folder'] = 'thenyourroot'; // bucketroot/thenyourroot/*
$conf['s3fs_bucket'] = 'YOUR BUCKET NAME'; 
$conf['s3fs_region'] = 'YOUR REGION'';
</pre>

<p>
Go to <code>admin/config/media/file-system</code> and set the Default download method to Amazon Simple Storage Service
Refer to <a href="#org2a48924">aws:s3</a> about how to setup user with correct permission policy
</p>
</div>
</div>

<div id="outline-container-orga0f1b76" class="outline-4">
<h4 id="orga0f1b76"><span class="section-number-4">2.4.58</span> Password Policy - password_policy</h4>
<div class="outline-text-4" id="text-2-4-58">
<p>
Change password required length, etc.
</p>
</div>
</div>

<div id="outline-container-org1c92d1f" class="outline-4">
<h4 id="org1c92d1f"><span class="section-number-4">2.4.59</span> Secure Login - securelogin</h4>
<div class="outline-text-4" id="text-2-4-59">
<p>
It enforces secure authenticated session cookies and ensures the user login page, any pages with the user login block and other forms you configure are submitted securely via HTTPS.
</p>
</div>
</div>

<div id="outline-container-org412f509" class="outline-4">
<h4 id="org412f509"><span class="section-number-4">2.4.60</span> Secure Review - security_review</h4>
<div class="outline-text-4" id="text-2-4-60">
<p>
Automate testing
</p>
</div>
</div>

<div id="outline-container-orge1d616c" class="outline-4">
<h4 id="orge1d616c"><span class="section-number-4">2.4.61</span> Security Kit - seckit</h4>
<div class="outline-text-4" id="text-2-4-61">
<p>
<a href="https://www.drupal.org/project/seckit">https://www.drupal.org/project/seckit</a>
Content Security Policy implementation via HTTP response header Content-Security-Policy
</p>

<p>
Control over Internet Explorer / Apple Safari / Google Chrome internal XSS filter via X-XSS-Protection HTTP response header
</p>

<p>
Prevent content upsniffing and serving files with incorrect MIME-type via X-Content-Type-Options: nosniff HTTP response header
</p>
</div>
</div>
</div>

<div id="outline-container-org2403e14" class="outline-3">
<h3 id="org2403e14"><span class="section-number-3">2.5</span> Debug <a id="org27235a1">d7:debug</a></h3>
<div class="outline-text-3" id="text-2-5">
<p>
Enable module Database Logging and Syslog if necessary.
</p>

<p>
watchdog('LOG_TYPE','message');
watchdog('LOG_TYPE', $message, array(), WATCHDOG_ERROR);
array() is to t() $message. Don't forget to put empty array otherwise you will have to manually clean up the watchdog table!
</p>

<p>
If error or warning messages are printed using drupal_set_message, 
modify the `drupal_set_message` function so that it prints debug_backtrace
</p>
<pre class="example">
if ($type == 'error') {
  $message .= ' '. print_r(debug_backtrace(DEBUG_BACKTRACE_PROVIDE_OBJECT,3),1);
}
</pre>

<p>
You can throw an Exception
</p>
<pre class="example">
throw new Exception(print_r($val));
</pre>

<pre class="example">
if (ip_address() === '123.456.789.123') {
  var_dump();
}
</pre>
</div>
</div>

<div id="outline-container-orgaf0b062" class="outline-3">
<h3 id="orgaf0b062"><span class="section-number-3">2.6</span> Configuration, Setting, Maintenance Mode</h3>
<div class="outline-text-3" id="text-2-6">
<p>
Override configuration and setting based on the current dev environment
settings.php
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">conf</span>[<span style="color: #e67128;">'admin_theme'</span>] = <span style="color: #e67128;">'seven'</span>;
<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">conf</span>[<span style="color: #e67128;">'maintenance_mode'</span>] = <span style="color: #008b8b;">FALSE</span>;
</pre>
</div>

<dl class="org-dl">
<dt>To determine which environment</dt><dd><a href="#orge388abe">pantheon:environment</a></dd>
</dl>

<p>
When site is under maintenance and you want to login:
</p>
<ul class="org-ul">
<li>Turn off javascript in browser</li>
<li>a.com/?q=user</li>
<li><code>UPDATE `variable` SET `value`='0' WHERE `name` = 'maintenance_mode'</code></li>
</ul>

<p>
For assigning permissions to roles, e.g. enable anonymous for Devel, you have to do it manually  
</p>

<p>
<a href="https://www.drupal.org/node/1525472">Variable name and its default value</a>
</p>
<dl class="org-dl">
<dt>admin_theme</dt><dd>'seven'</dd>
<dt>preprocess_css</dt><dd>"1"/"0", aggregate.</dd>
<dt>preprocess_js</dt><dd>"1"/"0", aggregate.</dd>
<dt>cache</dt><dd>"1"/"0", cache pages for anonymous users</dd>
<dt>block_cache</dt><dd>"1"/"0", cache blocks</dd>
<dt>cache_lifetime</dt><dd>"0", none. Minimum cache lifetime</dd>
<dt>error_level</dt><dd>"0"<i>"1"</i>"2", none/error and warnings/all messages. Logging and errors.</dd>
</dl>

<p>
If setting is an array, you have to override the whole array. Can't override a key value.
</p>
</div>

<div id="outline-container-org76abcb2" class="outline-4">
<h4 id="org76abcb2"><span class="section-number-4">2.6.1</span> <a id="orge0e3cd2">d7:mysql:charset</a></h4>
<div class="outline-text-4" id="text-2-6-1">
<p>
Since Drupal 7.50, Drupal now supports 4 byte UTF-8 with MySQL.
You will first need to run a custom drush command provided by a <a href="https://www.drupal.org/project/utf8mb4_convert">utf8mb4_convert module</a> to convert
all Drupal database, tables and fields to charset utf8mb4 and collation utf8mb4_general_ci
Then change the database connection settings in settings.php
<a href="https://www.drupal.org/node/2754539">Drupal Doc</a>
</p>

<p>
The utf8mb4_convert module requires inno_large_prefix=true when MySQL server is bootup.
Otherwise a test (-&gt;utf8mb4IsSupported) can't pass before any actions.
To bypass the test, re-create any string index columns varchar(255) to varchar(191)
For example:
ALTER TABLE cache_block CHANGE cid cid VARCHAR(191) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
</p>

<p>
Do this for any problematic column the module returns.
</p>

<p>
For new website, changing the database connectio settings in settings.php is good enough.
</p>

<p>
If MySQL server doesn't bootup with inno_large_prefix=true, all indexed columns will have max varchar(191)
</p>

<p>
As a quick workaround, you can remove all <a href="#org5611c79">php:4byte</a> characters.
</p>

<p>
Refer to <a href="#org545f6c8">mysql:charset</a> for important info
</p>
</div>
</div>

<div id="outline-container-orgfd5b8de" class="outline-4">
<h4 id="orgfd5b8de"><span class="section-number-4">2.6.2</span> Show error <a id="org2791321">d7:show error</a></h4>
<div class="outline-text-4" id="text-2-6-2">
<p>
Refer to <a href="#org27235a1">d7:debug</a>
</p>
<div class="org-src-container">
<pre class="src src-php">error_reporting(<span style="color: #34cae2;">E_ALL</span>);
ini_set(<span style="color: #e67128;">'display_errors'</span>, <span style="color: #008b8b;">TRUE</span>);
ini_set(<span style="color: #e67128;">'display_startup_errors'</span>, <span style="color: #008b8b;">TRUE</span>);
<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">conf</span>[<span style="color: #e67128;">'error_level'</span>] = 2;
<span style="color: #74af68;">// </span><span style="color: #74af68;">UI &gt; Administration &gt; Configuration &gt; Development &gt; logging &gt; 'All messages'</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb6354ac" class="outline-4">
<h4 id="orgb6354ac"><span class="section-number-4">2.6.3</span> Session Timeout, Session Cookie Timeout</h4>
<div class="outline-text-4" id="text-2-6-3">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #74af68;">// </span><span style="color: #74af68;">these 2 lines are to make sure PHP has the settings to enable gc</span>
ini_set(<span style="color: #e67128;">'session.gc_probability'</span>, 1);
ini_set(<span style="color: #e67128;">'session.gc_divisor'</span>, 100);

<span style="color: #74af68;">// </span><span style="color: #74af68;">about 2 days for session timeout</span>
ini_set(<span style="color: #e67128;">'session.gc_maxlifetime'</span>, 200000);

<span style="color: #74af68;">// </span><span style="color: #74af68;">about 20 days for session cookie timeout</span>
ini_set(<span style="color: #e67128;">'session.cookie_lifetime'</span>, 2000000);
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org1220ef8" class="outline-3">
<h3 id="org1220ef8"><span class="section-number-3">2.7</span> URL Alias</h3>
<div class="outline-text-3" id="text-2-7">
<p>
Setup pattern for each node type
Configuration &gt; Search and metadata &gt; URL Aliases &gt; Patterns
</p>
</div>
</div>

<div id="outline-container-org5735c86" class="outline-3">
<h3 id="org5735c86"><span class="section-number-3">2.8</span> Link, Module Path, Theme Path</h3>
<div class="outline-text-3" id="text-2-8">
</div>
<div id="outline-container-org9dfc129" class="outline-4">
<h4 id="org9dfc129"><span class="section-number-4">2.8.1</span> Link</h4>
<div class="outline-text-4" id="text-2-8-1">
<p>
Empty link!
</p>
<pre class="example">
// Basic syntax: l($text, $path, array $options = array())
l($text, 
  '', 
  array('fragment'=&gt;' ', 
        'html'=&gt;TRUE, // if $text is HTML, set this to true
        'external'=&gt;TRUE,
  //    'attributes' =&gt; array(
  //       'target'=&gt; '_blank'
  //       'class' =&gt; ['classA'],
  //     ),
  )
);
</pre>

<p>
Function l add class="active" when the path is current_path(). Use url() instead.
</p>

<pre class="example">
url($path = NULL, $options = array())
</pre>

<p>
Get URL alias
url() just returns a url. $options are the same as l().
url('taxonomy/term/1');
</p>

<p>
To embed a url directly to HTML href, you should check_url($url)
To embed a url directly as a URL parameter, echo 'http://abc.com/?t='.urlencode($url);
</p>
</div>
</div>

<div id="outline-container-org948ec95" class="outline-4">
<h4 id="org948ec95"><span class="section-number-4">2.8.2</span> Current External URL, <a id="orgb9422b0">d7:url</a> <a id="orga2ea54a">d7:current_path</a></h4>
<div class="outline-text-4" id="text-2-8-2">
<pre class="example">
url(current_path(), array('absolute' =&gt; TRUE));

;; With query parameters
url(current_path(), array('absolute' =&gt; TRUE, 'query' =&gt; drupal_get_query_parameters()));
</pre>

<p>
current_path still works when 404. Don't var_dump or print current_path() directly as it might have XSS
</p>

<p>
url
</p>
<dl class="org-dl">
<dt>absolute</dt><dd>append http</dd>
<dt>base_url</dt><dd>override the default $base_url with a custom base url, e.g. <a href="http://abc.com">http://abc.com</a> without trailing stash</dd>
</dl>
</div>
</div>

<div id="outline-container-orgcb4ac75" class="outline-4">
<h4 id="orgcb4ac75"><span class="section-number-4">2.8.3</span> Module Path, Theme Path</h4>
<div class="outline-text-4" id="text-2-8-3">
<p>
global $base_url;
$mod_path =  $base_url.base_path().drupal_get_path('module', 'lili_mod_name');
$theme_pat = $base_url.base_path().drupal_get_path('theme', 'lili_theme_name');
</p>

<p>
Both have no trailing slash
</p>
</div>
</div>

<div id="outline-container-orgb939cc7" class="outline-4">
<h4 id="orgb939cc7"><span class="section-number-4">2.8.4</span> global $base_url</h4>
<div class="outline-text-4" id="text-2-8-4">
<p>
No trailing slash
<a href="http://abc.com">http://abc.com</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org393ce25" class="outline-3">
<h3 id="org393ce25"><span class="section-number-3">2.9</span> Translate</h3>
<div class="outline-text-3" id="text-2-9">
</div>
<div id="outline-container-org95d70de" class="outline-4">
<h4 id="org95d70de"><span class="section-number-4">2.9.1</span> t()</h4>
<div class="outline-text-4" id="text-2-9-1">
<p>
$text = t("This is !name's website", array('!name' =&gt; $username));
$text = t("This is @name's website", array('@name' =&gt; $username));
$text = t("This is %name's website", array('%name' =&gt; $username));
$text = t(check_plain($text));
$link = l(t("Link text"), "node/123");
$link = t('Visit the &lt;a href="@url"&gt;settings&lt;/a&gt; page', array('@url' =&gt; url('admin')));
</p>

<p>
<i>/ `%` and `@` use `check_plain()`
/</i> `%` adds `&lt;em class="placehoder"&gt;&lt;/em&gt;`
// `!` straight output.
</p>

<p>
t('Thursday',[],['langcode'=&gt;'fr']);
t('Thursday',[],['context'=&gt; 'some context', 'langcode'=&gt;'fr']);
</p>

<p>
<a href="#orgfe1228a">d7:m:i18n</a>
</p>
</div>
</div>

<div id="outline-container-org4bcca99" class="outline-4">
<h4 id="org4bcca99"><span class="section-number-4">2.9.2</span> Translate Date and Time</h4>
<div class="outline-text-4" id="text-2-9-2">
<pre class="example">
// Have to load all terms then Translate Interface can show up admin/config/regional/translate/translate

$_fr_days_translation = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
$_fr_months_translation = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
foreach ($_fr_days_translation as $_t_i) {
  t($_t_i, [],['langcode'=&gt;'fr']);
}

// format_date with F (long month name) adds context..
foreach ($_fr_months_translation as $_t_i) {
  t($_t_i, [],['context'=&gt;'Long month name','langcode'=&gt;'fr']);
}

$_u_time = mktime (11, 0, 0, $_u_time['month'], $_u_time['day'], $_u_time['year']);
$_fr_time = format_date($_u_time, 'custom', 'l j F Y', NULL, 'fr');

echo $_fr_time;
</pre>
</div>
</div>
</div>

<div id="outline-container-org8f92453" class="outline-3">
<h3 id="org8f92453"><span class="section-number-3">2.10</span> Global Variables</h3>
<div class="outline-text-3" id="text-2-10">
<p>
<a href="https://api.drupal.org/api/drupal/globals/7.x">https://api.drupal.org/api/drupal/globals/7.x</a>
</p>

<dl class="org-dl">
<dt>$base_url</dt><dd>'http://www.yoursite.com' wihtout trailing slash</dd>
</dl>

<p>
<a href="https://www.drupal.org/node/2537572">https://www.drupal.org/node/2537572</a>
</p>

<p>
<a href="https://www.drupal.org/node/2537572">Drupal Properties</a>
$_SERVER['*']
</p>
<dl class="org-dl">
<dt>QUERY_STRING</dt><dd>query string without q e.g. 'foo=bar&amp;koo=hoo'</dd>
</dl>
</div>
</div>

<div id="outline-container-orga49fb5b" class="outline-3">
<h3 id="orga49fb5b"><span class="section-number-3">2.11</span> Common Functions <a id="orgc8aa747">d7:functions</a></h3>
<div class="outline-text-3" id="text-2-11">
</div>
<div id="outline-container-orgdb2e83c" class="outline-4">
<h4 id="orgdb2e83c"><span class="section-number-4">2.11.1</span> drupal_add_html_head</h4>
<div class="outline-text-4" id="text-2-11-1">
<p>
drupal_add_html_head($tag, 'unique-name');
// $head in html.tpl.php
$tag = array(
  '#tag'        =&gt; 'meta',
  '#attributes' =&gt; array(
    'property' =&gt; 'og:url',
    'content'  =&gt; $base_url,
  ),
);
drupal_add_html_head( $meta_og, 'lili_og_url' );
</p>
</div>
</div>

<div id="outline-container-org91dd984" class="outline-4">
<h4 id="org91dd984"><span class="section-number-4">2.11.2</span> drupal_set_title</h4>
<div class="outline-text-4" id="text-2-11-2">
<p>
drupal_set_title($title = NULL, $output = CHECK_PLAIN);
</p>
<dl class="org-dl">
<dt>$title</dt><dd>if NULL, leave the current unchanged</dd>
</dl>
</div>
</div>

<div id="outline-container-orgb606a27" class="outline-4">
<h4 id="orgb606a27"><span class="section-number-4">2.11.3</span> drupal_goto</h4>
<div class="outline-text-4" id="text-2-11-3">
<p>
drupal_goto($path = '', array $options= array(), $http_response_code= 302)
</p>

<dl class="org-dl">
<dt>$path</dt><dd>a drupal path 'node/123' or a full url</dd>
<dt>$options</dt><dd>URL optoins to pass to url()</dd>
</dl>

<p>
Redirect to homepage
drupal_goto('&lt;front&gt;'); 
</p>
</div>
</div>

<div id="outline-container-org39c478f" class="outline-4">
<h4 id="org39c478f"><span class="section-number-4">2.11.4</span> drupal_valid_path($path, $dynamic_allow= TRUE)</h4>
<div class="outline-text-4" id="text-2-11-4">
<p>
$_path = current_path();
</p>

<p>
if (drupal_valid_path($_path)) {
  // Current user has access to this path/page
}
</p>
</div>
</div>

<div id="outline-container-org6b3e8f4" class="outline-4">
<h4 id="org6b3e8f4"><span class="section-number-4">2.11.5</span> drupal_clean_css_identifier</h4>
<div class="outline-text-4" id="text-2-11-5">
<p>
Convert string to CSS ready element name, class and ID in selectors.
</p>
<pre class="example">
echo drupal_clean_css_identifier(drupal_strtolower($class));
</pre>
</div>
</div>

<div id="outline-container-org5d15591" class="outline-4">
<h4 id="org5d15591"><span class="section-number-4">2.11.6</span> Sanitization functions <a id="org3484a79">d7:functions:sanitization</a></h4>
<div class="outline-text-4" id="text-2-11-6">
<p>
<a href="https://api.drupal.org/api/drupal/includes!common.inc/group/sanitization/7.x">https://api.drupal.org/api/drupal/includes!common.inc/group/sanitization/7.x</a>
</p>

<dl class="org-dl">
<dt>check_plain($text)</dt><dd>refer to <a href="#org78b41e1">php:htmlspecialchars</a>. Can be used to sanitize HTML attribute value. <a id="org8878b79">d7:functions:check_plain</a></dd>
<dt>drupal_strip_dangerous_protocols($uri)</dt><dd>not for display.</dd>
<dt>drupal_attributes(array $attributes = [])</dt><dd>Each array key and its value will be formatted into an attribute string. Attr. values are check_plain() but not the key (attribute name).</dd>
<dt>check_url($uri)</dt><dd>strip and encode a uri for output to HTML. eq. to check_plain(drupal_strip_dangerous_protocols)</dd>
<dt>filter_xss($string, $allowed_tags = ['a', 'em', &#x2026;])</dt><dd>Filtes HTML to prevent XSS vulnerabilities.</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-orgbfdc36d" class="outline-3">
<h3 id="orgbfdc36d"><span class="section-number-3">2.12</span> Theme API</h3>
<div class="outline-text-3" id="text-2-12">
</div>
<div id="outline-container-orgced9ba7" class="outline-4">
<h4 id="orgced9ba7"><span class="section-number-4">2.12.1</span> render() vs drupal_render()</h4>
<div class="outline-text-4" id="text-2-12-1">
<p>
render(&amp;$element)
render is a wrapper for durpal_render which
</p>
<ul class="org-ul">
<li>makes sure the element passed in is set to be shown show()</li>
<li>only renders array. If what's passed in is not an array, it will return as it is.</li>
</ul>

<p>
show() :: $element['#printed'] = FALSE;
</p>

<p>
drupal_render(&amp;$elements)
</p>
<ul class="org-ul">
<li>if #access == false, return ''</li>
<li>if #printed = true, return ''</li>
<li>if #cached is set, load and return cache drupal_render_cache_get($elements)</li>
<li>#markup is set but not #type, #type is set to markup</li>
<li></li>

<li id="#pre_render">array of pre_render function names to modify</li>
<li>pre_render functions might set #printed to some value to indicate not to print, if so return ''</li>
<li>get children $children and initialize #children</li>
<li>if #theme is set, theme all children and save to #children</li>
<li>if #children is still empty, concatenate drupal_render for each child</li>
<li>if #theme_wrappers is defined, run each theme_wrapper function for #children</li>
<li>if #post_render is defined, run each function for #children</li>
<li>if #states is defined, attach JavaScript state drupal_process_states</li>
<li>if #attached is defined, drupal_process_attached</li>
<li>#prefix . #children . #suffix</li>
<li>drupal_render_cache_set</li>
<li>#printed set to true</li>
</ul>
</div>
</div>

<div id="outline-container-org91b2595" class="outline-4">
<h4 id="org91b2595"><span class="section-number-4">2.12.2</span> theme()</h4>
<div class="outline-text-4" id="text-2-12-2">
<p>
<a href="https://api.drupal.org/api/drupal/includes!theme.inc/function/theme/7.x">https://api.drupal.org/api/drupal/includes!theme.inc/function/theme/7.x</a>
theme($hook, $variables = array())
Use $variables to merge with defaults from the theme registry
</p>
</div>
</div>

<div id="outline-container-org4bd6610" class="outline-4">
<h4 id="org4bd6610"><span class="section-number-4">2.12.3</span> System Theme</h4>
<div class="outline-text-4" id="text-2-12-3">
<p>
Default theme files (*.tpl.php) are located at 
<code>/modules/mod_name/mod-name-component-name.tpl.php</code>
</p>

<p>
e.g. /modules/node/node.tpl.php
</p>

<p>
For custom theme, better to put *.tpl.php files under <code>/sites/all/themes/theme_name/templates/</code>
</p>

<p>
<a href="#orgf9371c1">d7:View_Theming</a>
</p>
</div>

<div id="outline-container-orga068e27" class="outline-5">
<h5 id="orga068e27"><span class="section-number-5">2.12.3.1</span> Fast detect if it's a node page</h5>
<div class="outline-text-5" id="text-2-12-3-1">
<p>
if (arg(0)=='node') {
  $node_id = arg(1);
} 
</p>
</div>
</div>

<div id="outline-container-orgb100cec" class="outline-5">
<h5 id="orgb100cec"><span class="section-number-5">2.12.3.2</span> Include file in *.tpl.php</h5>
<div class="outline-text-5" id="text-2-12-3-2">
<p>
include(drupal_get_path('theme', 'theme_name').'/example-file-template.tpl.php');
</p>

<p>
If the file is in the same folder
&lt;?php include 'abc.php'; ?&gt;
</p>
</div>
</div>

<div id="outline-container-org222f013" class="outline-5">
<h5 id="org222f013"><span class="section-number-5">2.12.3.3</span> .info (required)</h5>
</div>
<div id="outline-container-org0707062" class="outline-5">
<h5 id="org0707062"><span class="section-number-5">2.12.3.4</span> html.tpl.php</h5>
<div class="outline-text-5" id="text-2-12-3-4">
<p>
Get node if it's a node page
$node = menu_get_object();
if (isset($node-&gt;type)) { &#x2026; }
</p>
</div>
</div>

<div id="outline-container-org9e0051a" class="outline-5">
<h5 id="org9e0051a"><span class="section-number-5">2.12.3.5</span> page.tpl.php</h5>
<div class="outline-text-5" id="text-2-12-3-5">
<p>
Get node if it's a node page
hook_preprocess_page(&amp;$variables) {
  if (!empty($variables['node']) &amp;&amp; $variables['node']-&gt;type == 'NODETYPE') {
    $variables['greeting'] = 'Custom Greeting';
  }
}
</p>

<p>
<a href="https://api.drupal.org/api/drupal/modules%21system%21page.tpl.php/7.x">Available variables in page.tpl.php</a>
$node
</p>
</div>
</div>

<div id="outline-container-org8397e23" class="outline-5">
<h5 id="org8397e23"><span class="section-number-5">2.12.3.6</span> region.tpl.php</h5>
</div>
<div id="outline-container-org907aafd" class="outline-5">
<h5 id="org907aafd"><span class="section-number-5">2.12.3.7</span> block.tpl.php</h5>
</div>
<div id="outline-container-orge7f31be" class="outline-5">
<h5 id="orge7f31be"><span class="section-number-5">2.12.3.8</span> node.tpl.php</h5>
<div class="outline-text-5" id="text-2-12-3-8">
<p>
<a id="org3aa36dc">d7:template:node</a>
<a href="https://api.drupal.org/api/drupal/modules%21node%21node.tpl.php/7.x">Available variables</a>
</p>

<p>
$title :: sanitized title of the node
$content['field_example']
</p>

<p>
$node
$type :: node type
</p>

<p>
Node status variables
$view_mode :: 'full'
</p>
</div>

<ol class="org-ol">
<li><a id="org0bee296"></a>Check if a field is empty<br />
<div class="outline-text-6" id="text-2-12-3-8-1">
<p>
<a href="#org701912d">d7:api:field:hook_field_is_empty</a>
</p>
</div>
</li>

<li><a id="orgafa68b2"></a>$content['field_name']<br />
<div class="outline-text-6" id="text-2-12-3-8-2">
<p>
print render($content['field_name']) is based on the view mode that the entity is currently used to display and then the field formatter.
</p>

<p>
If field_name is not a field of the $node, then $content['field_name] is not set.
If field_name is defined but it has no value, then $content['field_name'] is not set.
So you can't directly render($content['field_name']) because the field_name might not be defined or has value.
</p>

<pre class="example">
render($content['field_name']);

//Raw value
$delta = 0; // first value. Even for text field
$item = $content['field_name']['#items'][$delta]
$item['target-id'] // for entity reference field
$item['entity']-&gt;title // entity title
$aField = $item['entity']-&gt;field_entity_field_name // array
$aField['und'][0]['value'] // raw value of a field of that entity
$aField['und'][0]['safe_value']
</pre>
</div>
</li>
</ol>
</div>

<div id="outline-container-org7b92481" class="outline-5">
<h5 id="org7b92481"><span class="section-number-5">2.12.3.9</span> field.tpl.php</h5>
</div>
<div id="outline-container-org21252a0" class="outline-5">
<h5 id="org21252a0"><span class="section-number-5">2.12.3.10</span> comment-wrapper.tpl.php</h5>
</div>
<div id="outline-container-org231ebab" class="outline-5">
<h5 id="org231ebab"><span class="section-number-5">2.12.3.11</span> comment.tpl.php</h5>
</div>
<div id="outline-container-org6782c15" class="outline-5">
<h5 id="org6782c15"><span class="section-number-5">2.12.3.12</span> template.php</h5>
</div>
<div id="outline-container-org5411437" class="outline-5">
<h5 id="org5411437"><span class="section-number-5">2.12.3.13</span> logo.png</h5>
</div>
<div id="outline-container-org4c5f8c9" class="outline-5">
<h5 id="org4c5f8c9"><span class="section-number-5">2.12.3.14</span> screenshot.png</h5>
</div>
</div>
<div id="outline-container-org37c5261" class="outline-4">
<h4 id="org37c5261"><span class="section-number-4">2.12.4</span> Form Theme</h4>
<div class="outline-text-4" id="text-2-12-4">
<p>
$form['#theme'][] = 'lili_form';
If no custom theme function, <a href="#org081ccd5">d7:hook_theme</a> <a href="#org3ef74ea">d7:theme_*</a>, is defined, then the default template file is
/sites/all/themes/your_theme/templates/form/lili_form.tpl.php
</p>
</div>
</div>

<div id="outline-container-orgce6dbf8" class="outline-4">
<h4 id="orgce6dbf8"><span class="section-number-4">2.12.5</span> Region</h4>
<div class="outline-text-4" id="text-2-12-5">
<p>
Region can hold multiple blocks. If module <a href="#org7a58fc0">d7:blockgroup</a> is installed, a block group is a region but it can be included in other region or block group.
Define a region in mytheme.info e.g. <code>regions[header] = Header</code>
Render a region in template files <code>print render($page['header'])</code>
</p>
</div>
</div>

<div id="outline-container-org149f834" class="outline-4">
<h4 id="org149f834"><span class="section-number-4">2.12.6</span> Block</h4>
<div class="outline-text-4" id="text-2-12-6">
</div>
<div id="outline-container-orge8885f6" class="outline-5">
<h5 id="orge8885f6"><span class="section-number-5">2.12.6.1</span> <a href="https://api.drupal.org/api/drupal/modules%21block%21block.api.php/function/hook_block_info/7.x">hook_block_info</a></h5>
<div class="outline-text-5" id="text-2-12-6-1">
<pre class="example">
function hook_block_info() {
  $blocks             = array();
  $blocks['my_block'] = array(
    'info'  =&gt; t( 'My Custom Block' ),
    'cache' =&gt; DRUPAL_CACHE_PER_ROLE,
  );

  return $blocks;
}
</pre>

<p>
Use `DRUPAL_NO_CACHE` for development, then `DRUPAL_CACHE_GLOBAL`. Default is `DRUPAL_CACHE_PER_ROLE`
</p>

<p>
If `Cache Block` is disabled and unchecked in Drupal Performance setting, all blocks will not be cached. Refer to <a href="#org8a399ff">d7:cache block</a>
</p>

<p>
The delta `my_block` only needs to be unique within the module. HTML ID is `block-MODULENAME-DELTA`
</p>

<p>
Now the block can be seen in the default theme Blocks admin page /admin/structure/block
Place the new block to a region. To assign a block to multiple regions, install <a href="#orga3b0f03">d7:MultiBlock</a> module:
Then go /admin/structure/block/instances to create another instance of the newly created block type.
</p>
</div>
</div>

<div id="outline-container-org927ab36" class="outline-5">
<h5 id="org927ab36"><span class="section-number-5">2.12.6.2</span> <a href="https://api.drupal.org/api/drupal/modules%21block%21block.api.php/function/hook_block_view/7.x">hook_block_view</a></h5>
<div class="outline-text-5" id="text-2-12-6-2">
<pre class="example">
&lt;?php
/**
 * Implements hook_block_view().
 */
function lili_block_view( $delta = '' ) {
  $block = array();

  switch ( $delta ) {
    case 'my_block' :
      $block['content'] = _lili_my_block_view();
      break;
  }

  return $block;
}

/**
 * Custom function to assemble renderable array for block content.
 * Returns a renderable array with the block content.
 * @return
 *   returns a renderable array of block content.
 */
function _lili_my_block_view() {
  $block = array();

  // Capture the image file path and form into HTML with attributes
  $image_file = file_load( variable_get( 'block_image_fid', '' ) );
  $image_path = '';

  if ( isset( $image_file-&gt;uri ) ) {
    $image_path = $image_file-&gt;uri;
  }

  $image = theme_image( array(
    'path'       =&gt; ( $image_path ),
    'alt'        =&gt; t( 'Image description here.' ),
    'title'      =&gt; t( 'This is our block image.' ),
    'attributes' =&gt; array( 'class' =&gt; 'class_name' ),
  ) );

  // Capture WYSIWYG text from the variable
  $text = variable_get( 'text_variable', '' );

  // Block output in HTML with div wrapper
  $block = array(
    'image'   =&gt; array(
      '#prefix' =&gt; '',
      '#type'   =&gt; 'markup',
      '#markup' =&gt; $image,
    ),
    'message' =&gt; array(
      '#type'   =&gt; 'markup',
      '#markup' =&gt; $text,
      '#suffix' =&gt; '',
    ),
  );

  // directly return a form as block
  // return drupal_get_form('lili_another_form');
  // or return ['some thing' =&gt; drupal_get_form('lili_another_form')];
  return $block;
}
</pre>
</div>
</div>

<div id="outline-container-org8b7e7d2" class="outline-5">
<h5 id="org8b7e7d2"><span class="section-number-5">2.12.6.3</span> <a href="https://api.drupal.org/api/drupal/modules%21block%21block.api.php/function/hook_block_view_alter/7.x">hook_block_view_alter</a></h5>
<div class="outline-text-5" id="text-2-12-6-3">
<pre class="example">
function lili_block_view_alter( &amp;$data, $block ) {
  if ( $block-&gt;module == 'block' &amp;&amp; $block-&gt;delta == '3' ) {
    // $data['subject']: title of the block

    $data['content'] = '';
  }
}
</pre>
</div>
</div>

<div id="outline-container-orgb4dcce2" class="outline-5">
<h5 id="orgb4dcce2"><span class="section-number-5">2.12.6.4</span> Configurable Block: <a href="https://api.drupal.org/api/drupal/modules%21block%21block.api.php/function/hook_block_configure/7.x">hook_block_configure</a>, <a href="https://api.drupal.org/api/drupal/modules%21block%21block.api.php/function/hook_block_save/7.x">hook_block_save</a></h5>
<div class="outline-text-5" id="text-2-12-6-4">
<p>
hook_block_configure
</p>
<pre class="example">
/**
 * Implements hook_block_configure().
 */
function lili_block_configure( $delta = '' ) {
  $form = array();

  switch ( $delta ) {
    case 'my_block' :
      // Text field form element
      $form['text_body'] = array(
        '#type'          =&gt; 'text_format',
        '#title'         =&gt; t( 'Enter your text here in WYSIWYG format' ),
        '#default_value' =&gt; variable_get( 'text_variable', '' ),
      );

      // File selection form element
      $form['file'] = array(
        '#name'              =&gt; 'block_image',
        '#type'              =&gt; 'managed_file',
        '#title'             =&gt; t( 'Choose an Image File' ),
        '#description'       =&gt; t( 'Select an Image for the custom block.  Only *.gif, *.png, *.jpg, and *.jpeg images allowed.' ),
        '#default_value'     =&gt; variable_get( 'block_image_fid', '' ),
        '#upload_location'   =&gt; 'public://block_image/',
        '#upload_validators' =&gt; array(
          'file_validate_extensions' =&gt; array( 'gif png jpg jpeg' ),
        ),
      );
      break;
  }

  return $form;
}

/**
 * Implements hook_block_save().
 */
function lili_block_save( $delta = '', $edit = array() ) {
  switch ( $delta ) {
    case 'my_block' :
      // Saving the WYSIWYG text
      variable_set( 'text_variable', $edit['text_body']['value'] );

      // Saving the file, setting it to a permanent state, setting a FID variable
      $file         = file_load( $edit['file'] );
      $file-&gt;status = FILE_STATUS_PERMANENT;
      file_save( $file );
      $block = block_load( 'lili', $delta );
      file_usage_add( $file, 'lili', 'block', $block-&gt;bid );
      variable_set( 'block_image_fid', $file-&gt;fid );
      break;
  }
}
</pre>
</div>
</div>

<div id="outline-container-orged989c5" class="outline-5">
<h5 id="orged989c5"><span class="section-number-5">2.12.6.5</span> Block API Sequence</h5>
<div class="outline-text-5" id="text-2-12-6-5">
<p>
hook_block_configure: Define a configuration form for a block.
hook_block_info: Define all blocks provided by the module.
hook_block_info_alter: Change block definition before saving to the database.
hook_block_save: Save the configuration options from hook_block_configure().
block_list
</p>
<ul class="org-ul">
<li>_block_load_blocks
<ul class="org-ul">
<li>hook_block_list_alter</li>
</ul></li>
<li>_block_render_blocks: render a set of blocks for one region. Check if it's cacheable, then get and set cache_block
<ul class="org-ul">
<li>_block_get_cache_id</li>
<li>hook_block_view: Return a rendered or renderable view of a block.</li>
<li>hook_block_view_alter: Perform alterations to the content of a block.</li>
<li>hook_block_view_MODULE_DELTA_alter: Perform alterations to a specific block.</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org36b41f1" class="outline-5">
<h5 id="org36b41f1"><span class="section-number-5">2.12.6.6</span> Render a block</h5>
<div class="outline-text-5" id="text-2-12-6-6">
<p>
If a block is assigned to a region "content"
Markup of the the block is $page['content']['block_123']
</p>

<pre class="example">
$SIDEBAR_CONTENT = json_encode($page['content']['block_'.$block_id]);
$SIDEBAR_CONTENT = json_decode($SIDEBAR_CONTENT,true);
$SIDEBAR_CONTENT = $SIDEBAR_CONTENT['#markup'];
</pre>
</div>
</div>
</div>

<div id="outline-container-org61b4922" class="outline-4">
<h4 id="org61b4922"><span class="section-number-4">2.12.7</span> Custom Theme Function</h4>
<div class="outline-text-4" id="text-2-12-7">
<p>
Module theme: <code>theme('modname_theme-name',$data)</code>
<a id="org081ccd5">d7:hook_theme</a> 
</p>
<dl class="org-dl">
<dt>$existing</dt><dd>array. existing themes</dd>
<dt>$type</dt><dd>string. Whether a theme, module, etc. is being processed. e.g. Is it a parent theme?</dd>
<dt>$theme</dt><dd>the name of theme, module, etc. is being processed</dd>
<dt>$path</dt><dd>the directory path of theme or module</dd>
</dl>

<p>
Return an array
</p>
<dl class="org-dl">
<dt>variables</dt><dd>theme function takes no parameter array(). Assign null to key-value for default values.</dd>
<dt>path</dt><dd>Use with 'template'
<ul class="org-ul">
<li>If theme_* function is used, you don't need to specify 'path' and 'template'</li>
<li>Whether or not hook_theme is defined in template.php or in a module, the path default is to the module or theme</li>
<li>But you should make the path to sites/all/themes/your_theme/templates/ or sites/all/modules/mod_path/modname/templates</li>
<li>e.g. 'path' =&gt; drupal_get_path('module', 'panels') . '/templates', 'path' =&gt; drupal_get_path('theme', 'panels') . '/templates',</li>
<li>if path is not defined but template is defined as a path to file (theme/template_file_name), then
<dl class="org-dl">
<dt>hook_theme defined in template.php</dt><dd>path_to_theme/theme/template_file_name.tpl.php</dd>
<dt>hook_theme defined in a module</dt><dd>path_to_module/theme/template_file_name.tpl.php</dd>
</dl></li>
<li>if path is not defined but template is defined as a file (template_file_name), then
<dl class="org-dl">
<dt>hook_theme defined in template.php</dt><dd>path_to_theme/template_file_name.tpl.php</dd>
<dt>hook_theme defined in a module</dt><dd>path_to_module/template_file_name.tpl.php</dd>
</dl></li>
</ul></dd>

<dt>template</dt><dd><ul class="org-ul">
<li>Assuming the theme function name is theme_lili_flair</li>
<li>Default file name is lili_flair and the actual file is lili_flair.tpl.php</li>
</ul></dd>
</dl>

<p>
<a id="org3ef74ea">d7:theme_*</a>
</p>

<pre class="example">
function lili_theme( $existing, $type, $theme, $path ) {
  return array(
    'lili_flair' =&gt; array(
      'variables' =&gt; array(
        'text' =&gt; NULL,
      ),
    ),
  );
}

function theme_lili_flair( $variables ) {
  if ( ! empty( $variables['text'] ) ) {
    return '&lt;span class="li-tag li-tag-pill li-tag-color"&gt;' . $variables['text'] . '&lt;/span&gt;';
  } else {
    return '';
  }
}

echo theme('lili_flair',array('text'=&gt;'hi'));

// In xxx.tpl.php use $text directly
</pre>
</div>
</div>

<div id="outline-container-orgeb7d26f" class="outline-4">
<h4 id="orgeb7d26f"><span class="section-number-4">2.12.8</span> Sub theme</h4>
<div class="outline-text-4" id="text-2-12-8">
<p>
<a href="https://www.drupal.org/docs/7/theming/creating-a-sub-theme">https://www.drupal.org/docs/7/theming/creating-a-sub-theme</a>
</p>

<p>
The name of your sub-theme must start with an alphabetic character and can only contain lowercase letters, numbers and underscores. 
</p>

<p>
Folder my_subtheme
name = My Subtheme
</p>

<p>
parent theme's .info file
base theme = theme_name
</p>

<p>
The sub-theme inherits most properties of the base theme. The important exceptions are 
</p>
<ul class="org-ul">
<li>regions</li>
<li>core version</li>
<li>color info</li>
<li>features</li>
<li>parent theme's logo (logo.png/logo.jpg)</li>
<li>parent theme's favicon.ico</li>
<li>theme-settings.php</li>
</ul>

<p>
You probably want to copy the regions section of your base theme's info file, along with its core version declaration.
</p>

<p>
If your base theme supports the color module and you'd like your sub-theme to support it, you probably also want to copy the color folder from your base theme and add the line from your base theme's info file to your sub-themes info file that looks like:
</p>
<pre class="example">
stylesheets[all][] = css/colors.css
</pre>

<p>
and then copy the colors.css from base theme to the css folder of the sub-theme.
</p>

<p>
Style sheets and JavaScripts are inherited. If you want to override, create relevant files and add these to .info
</p>
<pre class="example">
stylesheets[all][] = style.css
scripts[] = script.js
features[] = logo
</pre>

<p>
Template.php funciton inheritance
</p>
<ul class="org-ul">
<li>Anything defined in the parent theme's template.php file will be inherited. This includes theme function overrides, preprocess functions and anything else in that file. Each sub-theme should also have its own template.php file, where you can add additional functions or override functions from the parent theme.</li>
<li>theme functions, e.g. theme('[hook]', $var,&#x2026;), When a sub-theme overrides a theme function, no other version of that is called.</li>
<li>preprocess functions, e.g. [theme]_preprocess_page is called before page.tpl.php is rendered. 
<ul class="org-ul">
<li>Unlike theme functions, preprocess functions are not overriden in a sub-theme.</li>
<li>Instead, the parent theme preprocess function will be called first, and the sub-theme preprocess function will be called next</li>
<li>There is no way to prevent all functions in the parent theme from being inherited. The only way to remove a parent themes' preprocess function is through hook_theme_registry_alter().</li>
</ul></li>
</ul>

<p>
Page, node, block and other template (.tpl.php) file inheritance
e.g. node&#x2013;blog.tpl.php building on an inherited node.tpl.php
A single hyphen is still used to separate words. The double hyphen always indicates a more targeted override of what comes before the "&#x2013;".
e.g. node&#x2013;long-content-type-name.tpl.php
</p>

<p>
Add a template file with the same name in sub-theme folder to have it override the template from the parent theme.
</p>

<p>
Screen shots inheritance
</p>

<pre class="example">
name = Jean
description = A subtheme of Bartik, which is a flexible, recolorable theme with many regions.
core = 7.x
base theme = bartik

stylesheets[all][] = css/jean.css
stylesheets[all][] = css/colors.css

regions[header] = Header
regions[help] = Help
regions[page_top] = Page top
regions[page_bottom] = Page bottom
regions[highlighted] = Highlighted

regions[featured] = Featured
regions[content] = Content
regions[sidebar_first] = Sidebar first
regions[sidebar_second] = Sidebar second

regions[triptych_first] = Triptych first
regions[triptych_middle] = Triptych middle
regions[triptych_last] = Triptych last

regions[footer_firstcolumn] = Footer first column
regions[footer_secondcolumn] = Footer second column
regions[footer_thirdcolumn] = Footer third column
regions[footer_fourthcolumn] = Footer fourth column
regions[footer] = Footer

settings[shortcut_module_link] = 0
</pre>

<p>
Create the folder: /sites/all/themes/jean
Create the file /sites/all/themes/jean/jean.info
Create a blank file named: /sites/all/themes/jean/css/jean.css
Copy from bartik or create your own: /sites/all/themes/jean/logo.png
In order to get the color module to work with your subtheme, you will need to do the following:
</p>
<ul class="org-ul">
<li>Copy the file /themes/bartik/css/colors.css to /sites/all/themes/jean/css/colors.css</li>
<li>Copy the folder and its contents <i>themes/bartik/color</i> to <i>sites/all/themes/jean/color</i></li>
<li>Go to the Administration &gt; Appearance page to enable your new subtheme called Jean. Now you can add CSS to your jean.css file, and it will apply to your new subtheme.</li>
</ul>
</div>
</div>

<div id="outline-container-orgb2553de" class="outline-4">
<h4 id="orgb2553de"><span class="section-number-4">2.12.9</span> 404 page</h4>
<div class="outline-text-4" id="text-2-12-9">
<p>
page&#x2013;404.tpl.php could be in theme folder or theme's templates folder
</p>
<pre class="example">
function jean_preprocess_page(&amp;$vars) {
  $header = drupal_get_http_header('status');
  if ($header == '404 Not Found') {
    $vars['theme_hook_suggestions'][] = 'page__404';
  }
}
</pre>
</div>
</div>

<div id="outline-container-org929ff5b" class="outline-4">
<h4 id="org929ff5b"><span class="section-number-4">2.12.10</span> Contributed themes</h4>
<div class="outline-text-4" id="text-2-12-10">
</div>
<div id="outline-container-org856bae5" class="outline-5">
<h5 id="org856bae5"><span class="section-number-5">2.12.10.1</span> Omega</h5>
<div class="outline-text-5" id="text-2-12-10-1">
<p>
<a href="https://www.drupal.org/project/omega">https://www.drupal.org/project/omega</a>
</p>
</div>
</div>

<div id="outline-container-org248c047" class="outline-5">
<h5 id="org248c047"><span class="section-number-5">2.12.10.2</span> Corolla</h5>
<div class="outline-text-5" id="text-2-12-10-2">
<p>
<a href="https://www.drupal.org/project/corolla">https://www.drupal.org/project/corolla</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org75b13e7" class="outline-4">
<h4 id="org75b13e7"><span class="section-number-4">2.12.11</span> Render a field of a node, a term</h4>
<div class="outline-text-4" id="text-2-12-11">
</div>
<div id="outline-container-org26ade1f" class="outline-5">
<h5 id="org26ade1f"><span class="section-number-5">2.12.11.1</span> field_get_items, field_view_value, field_view_field</h5>
<div class="outline-text-5" id="text-2-12-11-1">
<p>
field_view_field returns a renderable array that has everything: lable and value.
field_view_value returns a renderable array that only has the formatted value. Such as text field simply returns text
</p>

<pre class="example">
$delta = 0; // first value
$field = field_get_items('node', $node, 'field_youtube_link');
// 
$output = field_view_value('node', $node, 'field_youtube_link', $field[$delta]);
// $output is an array
print render($output);

// it seams field_view_value can't render node title
</pre>

<p>
$output
</p>
<pre class="example">
[ 
  "#markup" =&gt; "...",
  "#access" =&gt; true
]
</pre>

<p>
Taxonomy term field
</p>
<pre class="example">
$eventField = field_get_items('node', $node, 'field_event_category');
$eventTerm = field_view_value('node', $node, 'field_event_category', $eventField[0]);
$titleImLookingFor = $eventTerm['#title'];
</pre>

<p>
Change value before rendering
</p>
<pre class="example">
$image = field_get_items('node', $node, 'field_image');
$output = field_view_value('node', $node, 'field_image', $image[0], array(
  'type' =&gt; 'image',
  'settings' =&gt; array(
    'image_style' =&gt; 'thumbnail',
    'image_link' =&gt; 'content',
  ),
));
</pre>
</div>
</div>

<div id="outline-container-org1406470" class="outline-5">
<h5 id="org1406470"><span class="section-number-5">2.12.11.2</span> Using node template</h5>
<div class="outline-text-5" id="text-2-12-11-2">
<p>
node&#x2013;[node-type-machine-name].tpl.php
</p>

<p>
Refer to <a href="#org3aa36dc">d7:template:node</a>
</p>

<p>
In page.tpl.php
</p>
<pre class="example">
$node_view = node_view($node);
// different view mode, default is 'full'
// node_view($node, 'custom-view-mode');
// different language, default is the global content language of the current request
// node_view($node, 'full', 'fr');
print drupal_render($test);
</pre>

<p>
Add a view mode
</p>
<pre class="example">
/**/
 * Implements hook_entity_info_alter().
 */
function MODULE_entity_info_alter(&amp;$entity_info) {
  $entity_info['node']['view modes']['block_feature'] = array(
    'label' =&gt; t('Block feature'),
    'custom settings' =&gt; TRUE,
  );
}

/**
 * Implements hook_preprocess_node().
 */
function MODULE_preprocess_node(&amp;$variables) {
  if($variables['view_mode'] == 'block_feature') {
    $variables['theme_hook_suggestions'][] = 'node__' . $variables['type'] . '__block_feature';
  }

  // add css files
  $node = $variables['node'];
  if (in_array($node-&gt;type, ['nodetype1','nodetype2','nodetype3'])) {
    drupal_add_css(drupal_get_path('theme', 'mytheme') . "/css/owl-carousel/owl.carousel.min.css");
    drupal_add_css(drupal_get_path('theme', 'mytheme') . "/css/owl-carousel/owl.theme.default.min.css");
  }
}
</pre>

<p>
Get raw value
</p>
<pre class="example">
$content['field_youtube_link']['#items']['0']['value']
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0f97127" class="outline-3">
<h3 id="org0f97127"><span class="section-number-3">2.13</span> Drush</h3>
<div class="outline-text-3" id="text-2-13">
</div>
<div id="outline-container-orgb3595e8" class="outline-4">
<h4 id="orgb3595e8"><span class="section-number-4">2.13.1</span> version <code>drush version</code></h4>
</div>
<div id="outline-container-org01cb1fc" class="outline-4">
<h4 id="org01cb1fc"><span class="section-number-4">2.13.2</span> Debug <code>-vd</code></h4>
</div>
<div id="outline-container-orgf56cb80" class="outline-4">
<h4 id="orgf56cb80"><span class="section-number-4">2.13.3</span> Alias</h4>
<div class="outline-text-4" id="text-2-13-3">
<p>
<code>drush sa</code> list all aliases
<a href="#org2fea9d7">pantheon:drupal:alias</a>
</p>
</div>
</div>

<div id="outline-container-org7c93854" class="outline-4">
<h4 id="org7c93854"><span class="section-number-4">2.13.4</span> User</h4>
<div class="outline-text-4" id="text-2-13-4">
<p>
drush user-login yourusername
drush user-create newuser &#x2013;mail="a@b.com" &#x2013;password="password"
drush user-add-role "administrator" newuser
</p>
</div>
</div>

<div id="outline-container-orgb4a6b14" class="outline-4">
<h4 id="orgb4a6b14"><span class="section-number-4">2.13.5</span> Module</h4>
<div class="outline-text-4" id="text-2-13-5">
<p>
<code>drush vset maintenance_mode 1</code> set to maintenance mode
<code>drush vset maintenance_mode 0</code> remove maintenance mode
<code>drush dl devel</code> Download a module
<code>drush en devel</code> Enable a module
<code>drush dis devel</code> Disable a module
<code>drush pmu devel</code> Uninstall a module. Won't delete code files
<code>drush up &lt;modulename&gt; -y</code> Update a module. Don't need to visit update.php
<code>drush up --no-core</code> Update all modules.
<code>drush pml</code> List all modules that are enabled, disabled, not installed, installed.
<code>drush pml --pipe</code> list modules in code name
</p>

<pre class="example">
drush up &lt;modulename&gt; = drush upc &lt;modulename&gt; + drush updb
</pre>

<p>
Remove incorrectly removed modules in db <a href="#orgeaaad02">d7:ts:module is missing</a>
</p>
</div>
</div>

<div id="outline-container-orgb973845" class="outline-4">
<h4 id="orgb973845"><span class="section-number-4">2.13.6</span> Detect if it's drush</h4>
<div class="outline-text-4" id="text-2-13-6">
<pre class="example">
if (drupal_is_cli() &amp;&amp; function_exists('drush_main')) return true;
return false;
</pre>
</div>
</div>

<div id="outline-container-org73752b9" class="outline-4">
<h4 id="org73752b9"><span class="section-number-4">2.13.7</span> Watchdog</h4>
<div class="outline-text-4" id="text-2-13-7">
</div>
<div id="outline-container-org4432a2d" class="outline-5">
<h5 id="org4432a2d"><span class="section-number-5">2.13.7.1</span> Delete</h5>
<div class="outline-text-5" id="text-2-13-7-1">
<pre class="example">
;; delete all logs
drush wd-del all

drush wd-del --type=cron

drush wd-del --severity=notice
</pre>
</div>
</div>

<div id="outline-container-org4a74aaf" class="outline-5">
<h5 id="org4a74aaf"><span class="section-number-5">2.13.7.2</span> Tail Recent Log Messages</h5>
<div class="outline-text-5" id="text-2-13-7-2">
<pre class="example">
drush watchdog-show --tail --full --count=50
</pre>
</div>
</div>
</div>

<div id="outline-container-org9f347a4" class="outline-4">
<h4 id="org9f347a4"><span class="section-number-4">2.13.8</span> SQL Query</h4>
<div class="outline-text-4" id="text-2-13-8">
<pre class="example">
drush sql-query "SELECT * FROM users WHERE uid=1"
</pre>
</div>
</div>

<div id="outline-container-orgd5e072e" class="outline-4">
<h4 id="orgd5e072e"><span class="section-number-4">2.13.9</span> Drupal Cache</h4>
<div class="outline-text-4" id="text-2-13-9">
<p>
Clear all Drupal Cache
</p>
<pre class="example">
drush cc all
</pre>
</div>
</div>

<div id="outline-container-orgcb5f0be" class="outline-4">
<h4 id="orgcb5f0be"><span class="section-number-4">2.13.10</span> Fields</h4>
<div class="outline-text-4" id="text-2-13-10">
<p>
// Field Name, Feild Type, Bundles
drush field-info fields
</p>

<p>
// Field type, Default widget, Widgets
drush field-info types
</p>
</div>
</div>

<div id="outline-container-orgf972c9f" class="outline-4">
<h4 id="orgf972c9f"><span class="section-number-4">2.13.11</span> Custom Drush</h4>
<div class="outline-text-4" id="text-2-13-11">
<p>
hook_drush_command() and drush_hook_your_command() in hook.drush.inc
</p>

<pre class="example">
function li_drush_command() {
  $items['feeds-import-tnt']=[
    'description' =&gt; '...',
    'options' =&gt; [
      'feed-id' =&gt; ['description' =&gt; dt('Feed ID to import') ]
    ], // if there is no param, don't include 'options'
    'examples' =&gt; [
      'drush feeds-import-tnt --feed-id=123' =&gt; "Test example",
    ]
  ];
  return $items;
}

function drush_li_feeds_import_tnt() {
  $feed_id = drush_get_option('feed-id');
}
// drush feeds-import-tnt --feed-id=123
</pre>

<p>
drupal_set_message()
</p>
<ul class="org-ul">
<li>stdout. No logging. Can be used multiple times in a drush command.</li>
<li><code>[status]</code> at the end of each line</li>
<li>not print out immediately</li>
</ul>

<p>
Use the following every 3 minutes to prevent drush command timeout
</p>
<pre class="example">
print "hello\n"; // print out immediately
drush_print(); // drush_print uses print
drush_print_r($array);
</pre>
</div>
</div>

<div id="outline-container-org4c3efd2" class="outline-4">
<h4 id="org4c3efd2"><span class="section-number-4">2.13.12</span> <a href="#org41f4e6a">Pantheon Drush</a></h4>
</div>
</div>

<div id="outline-container-org71b1f18" class="outline-3">
<h3 id="org71b1f18"><span class="section-number-3">2.14</span> Node API <a id="org4d686f9">d7:api:node</a></h3>
<div class="outline-text-3" id="text-2-14">
<p>
<a href="https://api.drupal.org/api/drupal/modules!node!node.api.php/7.x">https://api.drupal.org/api/drupal/modules!node!node.api.php/7.x</a>
<a href="https://api.drupal.org/api/drupal/modules!node!node.api.php/group/node_api_hooks/7.x">https://api.drupal.org/api/drupal/modules!node!node.api.php/group/node_api_hooks/7.x</a>
</p>

<p>
<a href="https://www.drupal.org/node/49768">Node object</a>
</p>

<p>
$node-&gt;nid :: node id
$node-&gt;type
</p>
</div>

<div id="outline-container-org3eb3223" class="outline-4">
<h4 id="org3eb3223"><span class="section-number-4">2.14.1</span> Update a node</h4>
<div class="outline-text-4" id="text-2-14-1">
<pre class="example">
$node = node_load($nid);
$node-&gt;fieldname['und'][0]['value'] = 'field value';
node_save($node);
</pre>

<p>
<a href="#orgafb2b25">d7:field_attach_update</a> doens't trigger hook_node_presave and other node hooks
</p>
<pre class="example">
$article_nodes = node_load_multiple(array(), array('type' =&gt; 'article'));
foreach ($article_nodes as $article_node) {
  $article_node-&gt;body[LANGUAGE_NONE][0]['value'] = 'body value';
  field_attach_update('node', $article_node);
}
</pre>

<p>
Recommended: use <a href="#orgdfc0833">d7:entity_metadata_wrapper</a> to update to avoid putting language code
</p>
</div>
</div>
</div>

<div id="outline-container-org5afd88a" class="outline-3">
<h3 id="org5afd88a"><span class="section-number-3">2.15</span> Views <a id="orge112026">d7:viewsapi</a></h3>
<div class="outline-text-3" id="text-2-15">
</div>
<div id="outline-container-org7a3fd71" class="outline-4">
<h4 id="org7a3fd71"><span class="section-number-4">2.15.1</span> UI</h4>
<div class="outline-text-4" id="text-2-15-1">
</div>
<div id="outline-container-orgd75e66b" class="outline-5">
<h5 id="orgd75e66b"><span class="section-number-5">2.15.1.1</span> Contextual filter with term name not term id</h5>
<div class="outline-text-5" id="text-2-15-1-1">
<p>
Choose <code>Content: Has taxonomy term ID</code>
Check <code>Specify validation criteria</code>
Validator <code>Taxonomy Term</code>, Filter value type <code>Term name converted to Term ID</code>
Check <code>Transform dashes in URL to spaces in term name filter values</code>
</p>
</div>
</div>
<div id="outline-container-org9c5cfb2" class="outline-5">
<h5 id="org9c5cfb2"><span class="section-number-5">2.15.1.2</span> Path vs Link</h5>
<div class="outline-text-5" id="text-2-15-1-2">
<p>
Content: Path with Rewrite Result option "Use absolute link" is the raw path.
</p>
</div>
</div>
<div id="outline-container-org2b71f11" class="outline-5">
<h5 id="org2b71f11"><span class="section-number-5">2.15.1.3</span> Field value is taxonomy ID not taxonomy name</h5>
<div class="outline-text-5" id="text-2-15-1-3">
<p>
Use Rewrite Result "[field_name-tid]" 
</p>
</div>
</div>
<div id="outline-container-org6519b78" class="outline-5">
<h5 id="org6519b78"><span class="section-number-5">2.15.1.4</span> Row Class</h5>
<div class="outline-text-5" id="text-2-15-1-4">
<p>
Use token [field_my_field_name] in row class. For taxonomy term to show id, you will have to create another field [field_my_field_name_1] shown as plain text and don't create label and rewrite the field to show Raw id and then reference [field_my_field_name_1] in row class
</p>
</div>
</div>

<div id="outline-container-orgcb8a157" class="outline-5">
<h5 id="orgcb8a157"><span class="section-number-5">2.15.1.5</span> Sort Tax Term Field</h5>
<div class="outline-text-5" id="text-2-15-1-5">
<p>
node has a field called Category which is Tax Term Cat123
In Views, add relationship Content:Category (the node field) and under SORT CRITERIA in View setting, add Taxonomy Term either Weight or Name and select the Taxonomy term Cat123.
</p>
</div>
</div>
</div>

<div id="outline-container-org1f0f639" class="outline-4">
<h4 id="org1f0f639"><span class="section-number-4">2.15.2</span> Entity Reference View</h4>
<div class="outline-text-4" id="text-2-15-2">
<p>
Require <a href="#org31d3ec9">d7:entityreference</a> module <a id="org5e8b56d">d7:entity reference view</a>
</p>
</div>
</div>

<div id="outline-container-org56a77d3" class="outline-4">
<h4 id="org56a77d3"><span class="section-number-4">2.15.3</span> View Object</h4>
<div class="outline-text-4" id="text-2-15-3">
<p>
Hooks use $view object.
</p>
</div>
<div id="outline-container-orga43ba16" class="outline-5">
<h5 id="orga43ba16"><span class="section-number-5">2.15.3.1</span> Properties</h5>
<div class="outline-text-5" id="text-2-15-3-1">
<p>
args :: array(
 0 =&gt; '37',
)
name :: 'tt_taxonomy'
current_display :: 'page'
</p>
</div>
</div>
<div id="outline-container-org470537f" class="outline-5">
<h5 id="org470537f"><span class="section-number-5">2.15.3.2</span> Methods</h5>
<div class="outline-text-5" id="text-2-15-3-2">
<p>
$v-&gt;get_items_per_page(); <i>/ Return nothong in hook_views_pre_build
$v-&gt;set_items_per_page(10); /</i> hook_views_pre_build
</p>
</div>
</div>
</div>

<div id="outline-container-org5c8881b" class="outline-4">
<h4 id="org5c8881b"><span class="section-number-4">2.15.4</span> hook_views_api</h4>
<div class="outline-text-4" id="text-2-15-4">
<pre class="example">
Views 3.x
/**
 * Implements hook_views_api().
 */
function my_module_views_api() {
  return array(
    'api' =&gt; 3,
  );
}
</pre>

<p>
All Views hook code should be placed in my_module.views.inc which is located in module root directory if 'path' is not defined.
All hooks' callbacks (Class definition) such as plugin and custom filter callback should be included in my_module.info as separate files
</p>
</div>
</div>

<div id="outline-container-orga372c78" class="outline-4">
<h4 id="orga372c78"><span class="section-number-4">2.15.5</span> hook_views_query_alter</h4>
<div class="outline-text-4" id="text-2-15-5">
<p>
Put it in MODULENAME.views.inc based on hook_views_api. But I had success to just include this hook in .module file
One way to avoid setup the *.views.inc is to use Views GUI to assign an Query Tag then use <a href="#org53e550e">hook_query_TAG_alter</a> but it runs twice.. So stick with hook_views_query_alter
</p>

<pre class="example">
// dpm($query-&gt;where);
// One condition
$c1 = [
 'field' =&gt; 'node.status',
 'value' =&gt; 1,
 'operator' =&gt; '='
];

$c2 = [
 'field' =&gt; 'node_search_index.word',
 'value' =&gt; '% burger %',
 'operator' =&gt; 'LIKE'
];

$c3 = [
 'field' =&gt; 'node.uid = :node_uid',
 'value' =&gt; [':node_uid' =&gt; '5'],
 'operator' =&gt; 'formula'
];

$c4 = [
 'field' =&gt; 'node.type',
 'value' =&gt; ['ns_newsletter'],
 'operator' =&gt; 'in'
];

// a condition group
$cg1 = [
  'field' =&gt; object::Drupal\Core\Database\Query\Condition
];

[ 'conditions' =&gt; [ $c1, $c2 ]
  'args' =&gt; [],
  'type' =&gt; 'AND'
],
[ 'conditions' =&gt; [ $c3, $c4 ]
  'args' =&gt; [],
  'type' =&gt; 'AND'
],
[ 'conditions' =&gt; [ $cg1 ]
  'args' =&gt; [],
  'type' =&gt; 'AND'
]
</pre>

<pre class="example">
function mymod_views_query_alter(&amp;$view, &amp;$query) {
  dpm($view, __FUNCTION__);
  dpm($query, __FUNCTION__);
  if ($view-&gt;name == 'lili_view' &amp;&amp; $view-&gt;current_display == 'page') {
    foreach ($query-&gt;where as &amp;$condition_group) {
      _recursively_alter_query_conditions($condition_group['conditions']);
    }
  }
  // add a where condition group
  // views_plugin_query_default::add_where($group, $field, $value = NULL, $operator = NULL)
  $cg_count = count($query-&gt;where);
  $query-&gt;add_where($cg_count, '0', '1', '=');
}

// helper function: (takes in conditions group argument)
function _recursively_alter_query_conditions(&amp;$conditions) {
  // foreach condition in condition group
  foreach ($conditions as &amp;$condition) {
    // if condition is itself a condition group
    if (isset($condition['field']) &amp;&amp; is_a($condition['field'], 'Drupal\Core\Database\Query\Condition')) {
      // call the helper function on it
      _recursively_alter_query_conditions($condition['field']-&gt;conditions());
    }
    else {
      // check if we want to alter the condition and if so alter it
      _alter_query_condition($condition);
    }
  }
}

// separate helper function to determine if the condition is one we want to alter
function _alter_query_condition(&amp;$condition) {
  if (isset($condition['field']) &amp;&amp; ($condition['field'] === 'node_search_index.word')) {
    $condition['value'] = "%{$condition['value']}%";
    $condition['operator'] = 'LIKE';
  }
  if (isset($condition['field']) &amp;&amp; ($condition['field'] === 'node_search_dataset.data')) {
    // here we're using trim to eliminate both the unwanted whitespace and the '%' symbols,
    // which then get added back via string concatenation
    $condition['value'] = "%" . trim($condition['value'], " \t\n\r\0\x0B%") . "%";
  }
}
</pre>
</div>
</div>

<div id="outline-container-org81d1d99" class="outline-4">
<h4 id="org81d1d99"><span class="section-number-4">2.15.6</span> hook_views_pre_build</h4>
</div>
<div id="outline-container-org8432f59" class="outline-4">
<h4 id="org8432f59"><span class="section-number-4">2.15.7</span> hook_views_pre_render</h4>
<div class="outline-text-4" id="text-2-15-7">
</div>
<div id="outline-container-org4222d27" class="outline-5">
<h5 id="org4222d27"><span class="section-number-5">2.15.7.1</span> Change Global Custom Text</h5>
<div class="outline-text-5" id="text-2-15-7-1">
<p>
Change the field value with tokens in Views UI
</p>
<pre class="example">
function lili_views_pre_render(&amp;$view) {
        if ($view-&gt;name == 'lili_view' &amp;&amp; $view-&gt;current_display == 'page') {

                // Change value for specific rows
                foreach ($view-&gt;result as $k =&gt; $r) {
                        if ($f = &amp;$r-&gt;field_field_flag) {
                                $o = $f[0]['rendered']['#markup'];
                                $o = theme('lili_theme_flair', array('text'=&gt;$o));
                                $f[0]['rendered']['#markup'] = $o;
                        }

                        // Taxonomy field
                        if ($f = &amp;$r-&gt;field_field_category) {
                                $exclude_tids = array(1,2,3);
                                foreach ($f as $k =&gt; $v) {
                                        if (!in_array($v['raw']['tid'], $exclude_tids)) {
                                                // Remove from display
                                                unset($f[$k]);
                                        }
                                }
                        }

                }

                // Only change global custom text for a subset of contextual filter value
                // The first context filter value
                if ($view-&gt;args[0] == 'filter_value') {
                        // Check View UI Theme Information to get the Global Custom Text field ID
                        if (isset($view-&gt;field['field_thumbnail']-&gt;options['exclude'])) {
                                // Exclude display
                                $view-&gt;field['field_thumbnail']-&gt;options['exclude'] = 1;
                        }
                        if (isset($view-&gt;field['nothing']-&gt;options['alter']['text'])) {
                                // Change a field's CSS Class setting for all records
                                $view-&gt;field['nothing']-&gt;options['element_class'] = '';
                                $o = $view-&gt;field['nothing']-&gt;options['alter']['text'];
                                $view-&gt;field['nothing']-&gt;options['alter']['text'] = 'hello'.$o;
                        }
                }
        }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org897bbe8" class="outline-4">
<h4 id="org897bbe8"><span class="section-number-4">2.15.8</span> Custom View Filter hook_views_data_alter</h4>
<div class="outline-text-4" id="text-2-15-8">
<p>
<a href="http://precessionmedia.com/blog/how-create-custom-filter-handler-views">http://precessionmedia.com/blog/how-create-custom-filter-handler-views</a>
</p>

<pre class="example">
/**
 * Implements hook_views_data_alter().
 */
function my_module_views_data_alter(&amp;$data) {
  $data['node']['title_count']['title'] = 'Title word count';
  $data['node']['title_count']['help'] = 'Count the number of words in titles.';
  $data['node']['title_count']['filter']['handler'] = 'my_module_handler_filter_field_count';
}
</pre>

<p>
my_module.info
</p>
<pre class="example">
files[] = my_module_handler_filter_field_count.inc
</pre>

<p>
my_module_handler_filter_field_count.inc
</p>
<pre class="example">
class my_module_handler_filter_field_count extends views_handler_filter_numeric {
  function operators() {
    $operators = parent::operators();
    // We won't be using regex in our example
    unset($operators['regular_expression']);

    return $operators;
  }

  // Helper function to return a sql expression
  // for counting words in a field.
  function field_count() {
    // Set the real field to the title of the node
    $this-&gt;real_field = 'title';

    $field = "$this-&gt;table_alias.$this-&gt;real_field";
    return "LENGTH($field)-LENGTH(REPLACE($field,' ',''))+1";
  }

  // Override the op_between function
  // adding our field count function as parameter
  function op_between($field) {
    $field_count = $this-&gt;field_count();

    $min = $this-&gt;value['min'];
    $max = $this-&gt;value['max'];

    if ($this-&gt;operator == 'between') {
      $this-&gt;query-&gt;add_where_expression($this-&gt;options['group'], "$field_count BETWEEN $min AND $max");
    }
    else {
      $this-&gt;query-&gt;add_where_expression($this-&gt;options['group'], "($field_count &lt;= $min) OR ($field_count &gt;= $max)");
    }
  }

  // Override the op_simple function
  // adding our field count function as parameter
  function op_simple($field) {
    $field_count = $this-&gt;field_count();

    $value = $this-&gt;value['value'];

    $this-&gt;query-&gt;add_where_expression($this-&gt;options['group'], "$field_count $this-&gt;operator $value");
  }
}
</pre>

<p>
In Views UI, add a filter with name "Title word count" with descript "Count the number of words in titles."
</p>
</div>
</div>

<div id="outline-container-orge637db3" class="outline-4">
<h4 id="orge637db3"><span class="section-number-4">2.15.9</span> Better Exposed Filters Module <a id="orge1b8450">d7:better exposed filters</a></h4>
<div class="outline-text-4" id="text-2-15-9">
<p>
If you want checkboxes or radio buttons instead of the Views Basic Exposed Form which is dropdown select.
</p>

<p>
Change BEF form hook_form_views_exposed_form_alter
</p>
<pre class="example">
function lili_form_views_exposed_form_alter(&amp;$form, &amp;$form_state) {
  if (isset($form['#id'])) {
    switch ($form['#id']) {
      case 'views-exposed-form-your-form-name':
        // ...
        break;
    }
  }
}
</pre>
<p>
The form id is views-exposed-form-view&#x2013;machine-name-display-machine-name
</p>
</div>
</div>

<div id="outline-container-org8d73bfb" class="outline-4">
<h4 id="org8d73bfb"><span class="section-number-4">2.15.10</span> Custom Views Plugin hook_views_plugins</h4>
</div>
<div id="outline-container-orgdc9b5ef" class="outline-4">
<h4 id="orgdc9b5ef"><span class="section-number-4">2.15.11</span> Views API Order</h4>
<div class="outline-text-4" id="text-2-15-11">
<p>
hook_views_pre_view
hook_views_pre_build
hook_views_post_build
hook_views_pre_execute
hook_views_post_execute
hook_views_pre_render
hook_views_post_render
</p>
</div>
</div>

<div id="outline-container-org1d00242" class="outline-4">
<h4 id="org1d00242"><span class="section-number-4">2.15.12</span> Embed View and Display</h4>
<div class="outline-text-4" id="text-2-15-12">
<p>
views_embed_view('view_name','display_id'); Doesn't display view title
</p>
<pre class="example">
$arg1 = $arg2 = '123';
print views_embed_view('view_name','display_id',$arg1,$arg2);
</pre>

<pre class="example">
$my_view_name = 'magazines';
$my_display_name = 'block_1';
$my_view = views_get_view($my_view_name);
if (is_object($my_view)) {
  $my_view-&gt;set_display($my_display_name);
  $my_view-&gt;pre_execute();
  echo $my_view-&gt;render($my_display_name);
}
</pre>
</div>
</div>

<div id="outline-container-org4f8f953" class="outline-4">
<h4 id="org4f8f953"><span class="section-number-4">2.15.13</span> View Theming</h4>
<div class="outline-text-4" id="text-2-15-13">
<p>
<a id="orgf9371c1">d7:View_Theming</a>
</p>

<p>
View, named foobar. Style: unformatted. Row styel: Fields. Display: Page.
</p>

<ul class="org-ul">
<li>views-view-foobar&#x2013;page.tpl.php</li>
<li>views-view-page.tpl.php</li>
<li>views-view&#x2013;foobar.tpl.php</li>
<li>views-view.tpl.php</li>

<li>views-view-unformatted&#x2013;foobar&#x2013;page.tpl.php</li>
<li>views-view-unformatted&#x2013;page.tpl.php</li>
<li>views-view-unformatted&#x2013;foobar.tpl.php</li>
<li>views-view-unformatted.tpl.php</li>

<li>views-view-fields&#x2013;foobar&#x2013;page.tpl.php</li>
<li>views-view-fields&#x2013;page.tpl.php</li>
<li>views-view-fields&#x2013;foorbar.tpl.php</li>
<li>views-view-fields.tpl.php</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org217f3e3" class="outline-3">
<h3 id="org217f3e3"><span class="section-number-3">2.16</span> Ellipsis <a id="orgbbac9d8">d7:ellipsis</a></h3>
<div class="outline-text-3" id="text-2-16">
<p>
Use truncate_utf8 for plain text string
</p>
<pre class="example">
truncate_utf8($string, $max_length, $wordsafe = FALSE, $add_ellipsis = FALSE, $min_wordsafe_length = 1)
</pre>

<p>
This can be used in custom module. Trim first, then remove scraps of html
e.g. <code>&lt;a&gt;fda&lt;/</code>, <code>&lt;a&gt;fda&lt;/a</code> and <code>&lt;a&gt;fda&lt;</code> will become <code>&lt;a&gt;fda</code>
'html' =&gt; true will close any unclosed html tags.
</p>
<pre class="example">
views_trim_text(array(
            'max_length' =&gt; 200,
            'word_boundary' =&gt; TRUE,
            'ellipsis' =&gt; TRUE,
            'html' =&gt; TRUE, // optional
          ), 'Long String');
// Output
Long String&lt;span class="ellipsis"&gt;...&lt;/span&gt;
</pre>

<p>
Source code
</p>
<pre class="example">
function views_trim_text($alter, $value) {
  if (drupal_strlen($value) &gt; $alter['max_length']) {
    $value = drupal_substr($value, 0, $alter['max_length']);
    // TODO: replace this with cleanstring of ctools
    if (!empty($alter['word_boundary'])) {
      $regex = "(.*)\b.+";
      if (function_exists('mb_ereg')) {
        mb_regex_encoding('UTF-8');
        $found = mb_ereg($regex, $value, $matches);
      }
      else {
        $found = preg_match("/$regex/us", $value, $matches);
      }
      if ($found) {
        $value = $matches[1];
      }
    }
    // Remove scraps of HTML entities from the end of a strings
    $value = rtrim(preg_replace('/(?:&lt;(?!.+&gt;)|&amp;(?!.+;)).*$/us', '', $value));

    if (!empty($alter['ellipsis'])) {
      $value .= t('...');
    }
  }
  if (!empty($alter['html'])) {
    $value = _filter_htmlcorrector($value);
  }

  return $value;
}

function _filter_htmlcorrector($text) {
  return filter_dom_serialize(filter_dom_load($text));
}
function filter_dom_load($text) {
  $dom_document = new DOMDocument();
  // Ignore warnings during HTML soup loading.
  @$dom_document-&gt;loadHTML('&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;&lt;head&gt;&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;&lt;/head&gt;&lt;body&gt;' . $text . '&lt;/body&gt;&lt;/html&gt;');

  return $dom_document;
}

function filter_dom_serialize($dom_document) {
  $body_node = $dom_document-&gt;getElementsByTagName('body')-&gt;item(0);
  $body_content = '';

  if ($body_node !== NULL) {
    foreach ($body_node-&gt;getElementsByTagName('script') as $node) {
      filter_dom_serialize_escape_cdata_element($dom_document, $node);
    }

    foreach ($body_node-&gt;getElementsByTagName('style') as $node) {
      filter_dom_serialize_escape_cdata_element($dom_document, $node, '/*', '*/');
    }

    foreach ($body_node-&gt;childNodes as $child_node) {
      $body_content .= $dom_document-&gt;saveXML($child_node);
    }
    return preg_replace('|&lt;([^&gt; ]*)/&gt;|i', '&lt;$1 /&gt;', $body_content);
  }
  else {
    return $body_content;
  }
}

// Adds comments around the &lt;!CDATA section in a dom element.
function filter_dom_serialize_escape_cdata_element($dom_document, $dom_element, $comment_start = '//', $comment_end = '') {
  foreach ($dom_element-&gt;childNodes as $node) {
    if (get_class($node) == 'DOMCdataSection') {
      // See drupal_get_js().  This code is more or less duplicated there.
      $embed_prefix = "\n&lt;!--{$comment_start}--&gt;&lt;![CDATA[{$comment_start} &gt;&lt;!--{$comment_end}\n";
      $embed_suffix = "\n{$comment_start}--&gt;&lt;!]]&gt;{$comment_end}\n";

      // Prevent invalid cdata escaping as this would throw a DOM error.
      // This is the same behavior as found in libxml2.
      // Related W3C standard: http://www.w3.org/TR/REC-xml/#dt-cdsection
      // Fix explanation: http://en.wikipedia.org/wiki/CDATA#Nesting
      $data = str_replace(']]&gt;', ']]]]&gt;&lt;![CDATA[&gt;', $node-&gt;data);

      $fragment = $dom_document-&gt;createDocumentFragment();
      $fragment-&gt;appendXML($embed_prefix . $data . $embed_suffix);
      $dom_element-&gt;appendChild($fragment);
      $dom_element-&gt;removeChild($node);
    }
  }
}
</pre>
</div>
</div>

<div id="outline-container-orgef70685" class="outline-3">
<h3 id="orgef70685"><span class="section-number-3">2.17</span> Form</h3>
<div class="outline-text-3" id="text-2-17">
</div>
<div id="outline-container-org6cfe556" class="outline-4">
<h4 id="org6cfe556"><span class="section-number-4">2.17.1</span> Form API</h4>
<div class="outline-text-4" id="text-2-17-1">
<p>
<a href="https://api.drupal.org/api/drupal/developer!topics!forms_api_reference.html/7.x">https://api.drupal.org/api/drupal/developer!topics!forms_api_reference.html/7.x</a>
</p>
</div>
</div>

<div id="outline-container-orgea10218" class="outline-4">
<h4 id="orgea10218"><span class="section-number-4">2.17.2</span> Form alter hooks</h4>
<div class="outline-text-4" id="text-2-17-2">
<p>
Called in order, from general to specific
<code>hook_form_alter</code> 
<code>hook_form_BASE_FORM_ID_alter</code>, Refer BASE_FORM_ID to <code>$form_state['build_info']['base_form_id']</code>
<code>hook_form_FORM_ID_alter</code>. Refer FORM_ID to <code>$form['#id']</code>
</p>

<p>
Set default value and hide a form from display or filling
</p>
<pre class="example">
// Entity reference form field
$form['field_dealer'][LANGUAGE_NONE][0]['target_id']['#default_value'] = 123;
$form['field_dealer'][LANGUAGE_NONE][0]['#printed'] = TRUE;
</pre>

<pre class="example">
hook_form_FORM_ID_alter(&amp;$form, &amp;$form_state, $form_id)
</pre>
</div>
</div>

<div id="outline-container-org56c2a37" class="outline-4">
<h4 id="org56c2a37"><span class="section-number-4">2.17.3</span> Form IDs of system forms</h4>
<div class="outline-text-4" id="text-2-17-3">
<p>
<code>node</code> :: node new/edit
<code>user_profile</code> :: page/user/&lt;uid&gt;
</p>

<p>
lili_node_form_alter
</p>

<p>
node type (content type) ad_listing, that node's new/edit form is
lili_form_ad_listing_node_form_alter using hook_form_FORM_ID_alter hook
</p>

<p>
Some modules alter the form before your custom alters. Such as field dependency module <a href="#org63e5a07">d7:module:conditional fields</a>
</p>
</div>
</div>

<div id="outline-container-org0dab3cc" class="outline-4">
<h4 id="org0dab3cc"><span class="section-number-4">2.17.4</span> Confirm Form</h4>
<div class="outline-text-4" id="text-2-17-4">
<p>
e.g. Confirm before delete
</p>
<pre class="example">
// Menu
$items['dealer_user/%/delete'] = array(
        'title' =&gt; 'Delete a user',
        'page callback' =&gt; 'drupal_get_form',
        'page arguments' =&gt; array('lili_delete_dealer_user_confirm',1),
        'access callback' =&gt; 'lili_user_has_delete_right',
        'access arguments' =&gt; array(1, array('Dealer Admin')),
        'type' =&gt; MENU_LOCAL_TASK,
);

function lili_delete_dealer_user_confirm($form, &amp;$form_state, $id) {
        $form['delete'] = array(
                '#type' =&gt; 'value',
                '#value' =&gt; $id,
        );
        return confirm_form($form,
                t('Are you sure you want to delete this user?'), // Question
                'dealer_manage_users',  // Path to go to if No
                t('This action cannot be undone.'), // Description
                t('Delete Button'), // Yes: text
                t('Cancel Button') // No: text
                //, $name default 'confirm': internal name used to refer to the confirmation item.
        );
}

function lili_delete_dealer_user_confirm_submit($form, &amp;$form_state) {
        if ($uid = $form_state['values']['delete']) {
                $u = user_load($uid);
                user_cancel();
                drupal_set_message(t('The user account has been deleted!'));
        }
        $form_state['redirect'] = 'dealer_manager_users';
}

function lili_user_has_delete_right($uid = 0, array $roles) {
        global $user;
        // If user is anonymous
        if (user_is_anonymous()) {
                return FALSE;
        }
        if (in_array('administrator', $user-&gt;roles)) {
                return TRUE;
        }
        if (array_intersect($roles, $user-&gt;roles)) {
                return TRUE;
        }
}
</pre>
</div>
</div>

<div id="outline-container-orgc7f8af7" class="outline-4">
<h4 id="orgc7f8af7"><span class="section-number-4">2.17.5</span> form_load_include</h4>
<div class="outline-text-4" id="text-2-17-5">
<p>
Include files whenever a form is loaded.
form_load_include(&amp;$form_state, $type, $module, $name = NULL) {}
<i>/ if name is omitted, then $module.$type is loaded.
/</i> return The filepath of the loaded include file, or FALSE if the include file was
<i>/ not found or has been loaded already.
/</i> file is always included even the form is cached.
form_load_include($form_state, 'inc', 'tnt', 'tnt.pages');
</p>
</div>
</div>

<div id="outline-container-org1d03837" class="outline-4">
<h4 id="org1d03837"><span class="section-number-4">2.17.6</span> Form Ajax</h4>
<div class="outline-text-4" id="text-2-17-6">
<p>
<a href="https://www.drupal.org/docs/7/api/javascript-api/ajax-forms-in-drupal-7">https://www.drupal.org/docs/7/api/javascript-api/ajax-forms-in-drupal-7</a>
</p>

<p>
<a href="https://api.drupal.org/api/drupal/developer!topics!forms_api_reference.html/7.x#ajax">https://api.drupal.org/api/drupal/developer!topics!forms_api_reference.html/7.x#ajax</a>
</p>

<pre class="example">
/**
 * Ajax-enabled select element causes replacement of a set of checkboxes
 * based on the selection.
 */
function ajax_example_autocheckboxes($form, &amp;$form_state) {

  $default = !empty($form_state['values']['howmany_select']) ? $form_state['values']['howmany_select'] : 1;

  $form['howmany_select'] = array(
    '#title' =&gt; t('How many checkboxes do you want?'),
    '#type' =&gt; 'select',
    '#options' =&gt; array(1 =&gt; 1, 2 =&gt; 2, 3 =&gt; 3, 4 =&gt; 4),
    '#default_value' =&gt; $default,
    '#ajax' =&gt; array(
      'callback' =&gt; 'ajax_example_autocheckboxes_callback',
      'wrapper' =&gt; 'checkboxes-div',
      'method' =&gt; 'replace',
      'effect' =&gt; 'fade',
    ),

  );


  $form['checkboxes_fieldset'] = array(
    '#title' =&gt; t("Generated Checkboxes"),
    // The prefix/suffix provide the div that we're replacing, named by
    // #ajax['wrapper'] above.
    '#prefix' =&gt; '&lt;div id="checkboxes-div"&gt;',
    '#suffix' =&gt; '&lt;/div&gt;',
    '#type' =&gt; 'fieldset',
    '#description' =&gt; t('This is where we get automatically generated checkboxes'),
  );

  $num_checkboxes = !empty($form_state['values']['howmany_select']) ? $form_state['values']['howmany_select'] : 1;
  for ($i = 1; $i &lt;= $num_checkboxes; $i++) {
    $form['checkboxes_fieldset']["checkbox$i"] = array(
      '#type' =&gt; 'checkbox',
      '#title' =&gt; "Checkbox $i",
    );
  }

  $form['submit'] = array(
    '#type' =&gt; 'submit',
    '#value' =&gt; t('Submit'),
  );

  return $form;
}

/**
 * Callback element needs only select the portion of the form to be updated.
 * Since #ajax['callback'] return can be HTML or a renderable array (or an
 * array of commands), we can just return a piece of the form.
 */
function ajax_example_autocheckboxes_callback($form, $form_state) {
  return $form['checkboxes_fieldset'];
}
</pre>

<dl class="org-dl">
<dt>#ajax['event']</dt><dd>which jquery event triggers AJAX. Don't need to set. Default is fine.</dd>
<dt>#ajax['callback']</dt><dd>return HTML or renderable array to replace #ajax['wrapper']. By the time it gets called, the form is recalculated/rebuilt in PHP and you can return $form['the_field_name'] directly. The callback function can't change any state or form settings. Do it in form builder functions: hook_form, hook_form_alter. Callback function is called after all the form processing fuctions.</dd>
<dt>#ajax['wrapper']</dt><dd>HTML container.</dd>
</dl>
</div>
</div>

<div id="outline-container-org4a44cf2" class="outline-4">
<h4 id="org4a44cf2"><span class="section-number-4">2.17.7</span> Form field loaded with terms of a taxonomy fields <a id="orgdab2d91">d7:form:taxonomy field</a></h4>
<div class="outline-text-4" id="text-2-17-7">
<pre class="example">
$parts_makes = ['0' =&gt; t('Make')]; // First option
$_terms = taxonomy_allowed_values(field_info_field('field_parts_make'));

// [123] =&gt; term123_name, [345] =&gt; term345_name, ...

if ($language-&gt;language == 'en') {
  $parts_makes += $_terms;
}
else {
  $parts_make_terms = $_terms;
  foreach ($parts_make_terms as $tid =&gt; $name) {
    $i18n_object = i18n_get_object('taxonomy_term', $tid);
    if ($translated_term = $i18n_object-&gt;localize($language-&gt;language)) {
      $parts_makes[$tid] = (!empty($translated_term-&gt;name)) ? $translated_term-&gt;name : $parts_make_terms[$tid];
    }
  }
}

$form['make'] = [
  '#type' =&gt; 'select',
  '#options' =&gt; $parts_makes,
];
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcd2f422" class="outline-3">
<h3 id="orgcd2f422"><span class="section-number-3">2.18</span> Action</h3>
<div class="outline-text-3" id="text-2-18">
<p>
hook_info_action
return ['action_name' =&gt; $an_action];
</p>

<p>
$an_action :: array
</p>
<dl class="org-dl">
<dt>'permissions'</dt><dd>this is specific for View Bulk Operations (VBO). e.g. array('switch users')</dd>
<dt>'behavior'</dt><dd>array. VBO uses one of views_property, changes_property, creates_property, deletes_property</dd>
</dl>

<p>
<a href="https://www.drupal.org/node/2052067#permissions">VBO Permissions</a>
</p>
</div>
</div>

<div id="outline-container-org2e6600f" class="outline-3">
<h3 id="org2e6600f"><span class="section-number-3">2.19</span> Field API <a id="org9ca226e">d7:api:field</a></h3>
<div class="outline-text-3" id="text-2-19">
<p>
When a field associates with an entity, a widget can be specified
A field with an entity can have one formatter for each view mode.
</p>
</div>

<div id="outline-container-org318a82d" class="outline-4">
<h4 id="org318a82d"><span class="section-number-4">2.19.1</span> hook_field_is_empty <a id="org701912d">d7:api:field:hook_field_is_empty</a></h4>
<div class="outline-text-4" id="text-2-19-1">
<p>
<i>modules/field/field.api.php hook_field_is_empty($item, $field)
/modules/field/modules</i>[fieldtype]/[fieldtype].module
Or any modules that implements hook_field_is_empty
</p>

<p>
Core fieldtype:
</p>
<ul class="org-ul">
<li>field_sql_storage</li>
<li>list</li>
<li>number</li>
<li>options</li>
<li>text</li>
<li>taxonomy</li>
<li>image</li>
<li>file</li>
</ul>

<pre class="example">
$info = field_info_field($field_name);
$function = $info['module'] . '_field_is_empty';

if (function_exists($function)) {
  $value = field_get_items('node', $node, $field_name);
  $is_empty = $function($value, $info);
}
</pre>
</div>
</div>

<div id="outline-container-org737ba70" class="outline-4">
<h4 id="org737ba70"><span class="section-number-4">2.19.2</span> Field Formatter <a id="orgfe0d2dc">d7:api:field:formatter</a></h4>
<div class="outline-text-4" id="text-2-19-2">
<p>
Content Type &gt; Manage Display &gt; Format for a field
hook_field_formatter_info tells Drupal a new field formatter that will apply to what field types.
If a formatter has a setting, a summary and a form needs to be defined in order to show a gear icon next to summary in Manage Display
</p>

<p>
hook_field_formatter_info :: hook_field_formatter_info_alter
</p>

<pre class="example">
function text_field_formatter_info() {
  return array(
    'text_default' =&gt; array(
      'label' =&gt; t('Default'),
      'field types' =&gt; array('text', 'text_long', 'text_with_summary'),
    ),
    'text_plain' =&gt; array(
      'label' =&gt; t('Plain text'),
      'field types' =&gt; array('text', 'text_long', 'text_with_summary'),
    ),

    'text_trimmed' =&gt; array(
      'label' =&gt; t('Trimmed'),
      'field types' =&gt; array('text', 'text_long', 'text_with_summary'),
      'settings' =&gt; array('trim_length' =&gt; 600),
    ),

    'text_summary_or_trimmed' =&gt; array(
      'label' =&gt; t('Summary or trimmed'),
      'field types' =&gt; array('text_with_summary'),
      'settings' =&gt; array('trim_length' =&gt; 600),
    ),
  );
}
</pre>

<p>
hook_field_formatter_settings_summary
</p>
<pre class="example">
function text_field_formatter_settings_summary($field, $instance, $view_mode) {
  $display = $instance['display'][$view_mode];
  $settings = $display['settings'];

  $summary = '';

  if (strpos($display['type'], '_trimmed') !== FALSE) {
    $summary = t('Trimmed limit: @trim_length characters', array('@trim_length' =&gt; $settings['trim_length']));
  }

  return $summary;
}
</pre>

<p>
hook_field_formatter_settings_form
</p>
<pre class="example">
function text_field_formatter_settings_form($field, $instance, $view_mode, $form, &amp;$form_state) {
  $display = $instance['display'][$view_mode];
  $settings = $display['settings'];

  $element = array();

  if (strpos($display['type'], '_trimmed') !== FALSE) {
    $element['trim_length'] = array(
      '#title' =&gt; t('Trimmed limit'),
      '#type' =&gt; 'textfield',
      '#field_suffix' =&gt; t('characters'),
      '#size' =&gt; 10,
      '#default_value' =&gt; $settings['trim_length'],
      '#element_validate' =&gt; array('element_validate_integer_positive'),
      '#description' =&gt; t('If the summary is not set, the trimmed %label field will be shorter than this character limit.', array('%label' =&gt; $instance['label'])),
      '#required' =&gt; TRUE,
    );
  }

  return $element;
}
</pre>

<p>
hook_field_formatter_view :: use settings to return result (HTML). Use hook_field_formatter_prepare_view to add info for field values being displayed.
</p>
<pre class="example">
function text_field_formatter_view($entity_type, $entity, $field, $instance, $langcode, $items, $display) {
  $element = array();

  switch ($display['type']) {
    case 'text_default':
    case 'text_trimmed':
      foreach ($items as $delta =&gt; $item) {
        $output = _text_sanitize($instance, $langcode, $item, 'value');
        if ($display['type'] == 'text_trimmed') {
          $output = text_summary($output, $instance['settings']['text_processing'] ? $item['format'] : NULL, $display['settings']['trim_length']);
        }
        $element[$delta] = array('#markup' =&gt; $output);
      }
      break;

    case 'text_summary_or_trimmed':
      foreach ($items as $delta =&gt; $item) {
        if (!empty($item['summary'])) {
          $output = _text_sanitize($instance, $langcode, $item, 'summary');
        }
        else {
          $output = _text_sanitize($instance, $langcode, $item, 'value');
          $output = text_summary($output, $instance['settings']['text_processing'] ? $item['format'] : NULL, $display['settings']['trim_length']);
        }
        $element[$delta] = array('#markup' =&gt; $output);
      }
      break;

    case 'text_plain':
      foreach ($items as $delta =&gt; $item) {
        $element[$delta] = array('#markup' =&gt; strip_tags($item['value']));
      }
      break;
  }

  return $element;
}
</pre>

<p>
Usage
</p>

<pre class="example">
$node = node_load($view-&gt;result[0]-&gt;_field_data['nid']['entity']-&gt;nid);
$settings = array(
  'label'    =&gt; 'hidden',
  'type'     =&gt; 'text_summary_or_trimmed',
  'settings' =&gt; array('trim_length' =&gt; 800),
);
$node_summary = field_view_field('node', $node, 'body', $settings);
print render($node_summary);
</pre>
</div>
</div>

<div id="outline-container-org2287ba5" class="outline-4">
<h4 id="org2287ba5"><span class="section-number-4">2.19.3</span> field_get_items <a id="org3b0cdf2">d7:field_get_items</a></h4>
<div class="outline-text-4" id="text-2-19-3">
<p>
Return the field items in the language they currently would be displayed.
$items = field_get_items($entity_type, $entity, $field_name, $langcode = NULL)
</p>

<p>
If there is no field associated with $entity or the field is not a field belongs to $entity, it will return false.
</p>

<pre class="example">
function hasValues($field_name,$entity, $entity_type='node', $langcode = NULL) {
    $r     = [
      'has'   =&gt; FALSE,
      'count' =&gt; 0
    ];
    $value = field_get_items($entity_type, $entity, $field_name, $langcode);
    if (is_array($value)) {
      $r = [
        'has' =&gt; true,
        'count' =&gt; count($value)
      ];
    }
    return $r;
}
</pre>

<p>
To check if a field value is empty <a href="#org701912d">d7:api:field:hook_field_is_empty</a>
</p>

<p>
After checking it has values, then you can render($content['field_name']) in node.tpl.php
</p>
</div>

<div id="outline-container-org5272e1e" class="outline-5">
<h5 id="org5272e1e"><span class="section-number-5">2.19.3.1</span> Image field</h5>
<div class="outline-text-5" id="text-2-19-3-1">
<p>
fid =&gt; "768"
uid =&gt; "1"
filename =&gt; "splash-photo.jpg"
uri =&gt; "public://splash-photo.jpg"
filemime =&gt; "image/jpeg"
filesize =&gt; "129265"
status =&gt; "1"
timestamp =&gt; "1518792000"
alt =&gt; ""
title=&gt; ""
width =&gt; "727"
height =&gt; "426"
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc6c2456" class="outline-3">
<h3 id="orgc6c2456"><span class="section-number-3">2.20</span> Database</h3>
<div class="outline-text-3" id="text-2-20">
</div>
<div id="outline-container-org4013776" class="outline-4">
<h4 id="org4013776"><span class="section-number-4">2.20.1</span> Close Comment for Existing Nodes</h4>
<div class="outline-text-4" id="text-2-20-1">
<p>
0 = No, 1 = Closed (read only), 2 = Open (Read/Write)
</p>
<pre class="example">
UPDATE node, node_revision
SET node.comment = 1, node_revision.comment = 1
WHERE node_revision.nid = node AND node.type = 'article'
</pre>
</div>
</div>

<div id="outline-container-org6eeb37b" class="outline-4">
<h4 id="org6eeb37b"><span class="section-number-4">2.20.2</span> Structure</h4>
<div class="outline-text-4" id="text-2-20-2">
</div>
<div id="outline-container-orge874ddd" class="outline-5">
<h5 id="orge874ddd"><span class="section-number-5">2.20.2.1</span> node</h5>
<div class="outline-text-5" id="text-2-20-2-1">
<p>
nid* :: INT
vid :: The current node_revision.vid version id
uid :: author id
type :: string, e.g. article, 
title
created :: 
sticky :: int, 0. 1 means to show on top of query result
promote :: int, 0. 1 means to show on homepage
</p>
</div>
</div>

<div id="outline-container-org8023299" class="outline-5">
<h5 id="org8023299"><span class="section-number-5">2.20.2.2</span> field_data_body</h5>
<div class="outline-text-5" id="text-2-20-2-2">
<p>
entity_type* :: string, e.g. node
deleted* :: int, 0 not deleted
entity_id* :: int, e.g. node id
language* :: string
delta* :: int, multiple values, start as 0
bundle :: string, e.g. node type article
revision_id :: int
</p>

<p>
body_value :: longtext
body_summary :: longtext
</p>
</div>
</div>

<div id="outline-container-orgba65d21" class="outline-5">
<h5 id="orgba65d21"><span class="section-number-5">2.20.2.3</span> field_data_field_custom_term_reference</h5>
<div class="outline-text-5" id="text-2-20-2-3">
<p>
field_custom_term_referecen_tid :: int
</p>
</div>
</div>

<div id="outline-container-orga2d131d" class="outline-5">
<h5 id="orga2d131d"><span class="section-number-5">2.20.2.4</span> taxonomy_term_data</h5>
<div class="outline-text-5" id="text-2-20-2-4">
<p>
tid* :: int
vid :: int, vocabulary id. see taxonomy_vocabulary
name :: string, term name
weight :: int
</p>
</div>
</div>

<div id="outline-container-org225b027" class="outline-5">
<h5 id="org225b027"><span class="section-number-5">2.20.2.5</span> taxonomy_vocabular</h5>
<div class="outline-text-5" id="text-2-20-2-5">
<p>
vid* ::
name ::
machine_name
</p>
</div>
</div>

<div id="outline-container-org6173e53" class="outline-5">
<h5 id="org6173e53"><span class="section-number-5">2.20.2.6</span> field_data_field_contributor (entity reference)</h5>
<div class="outline-text-5" id="text-2-20-2-6">
<p>
field_contributor_target_id :: int
</p>
</div>
</div>

<div id="outline-container-orga3b465f" class="outline-5">
<h5 id="orga3b465f"><span class="section-number-5">2.20.2.7</span> url_alias</h5>
<div class="outline-text-5" id="text-2-20-2-7">
<p>
pid* :: int, path id
source :: string, e.g. node/2, taxonomy/term/11
alias :: string
language :: string, e.g. und
</p>
</div>
</div>

<div id="outline-container-org4059c05" class="outline-5">
<h5 id="org4059c05"><span class="section-number-5">2.20.2.8</span> Export Query</h5>
<div class="outline-text-5" id="text-2-20-2-8">
<pre class="example">
SELECT n.title,
  b.body_value,
  GROUP_CONCAT(t.name SEPARATOR ', ') AS Category,
  IFNULL(na.title,'') AS author,
  CONCAT('http://domain.com/',u.alias) as url,
  FROM_UNIXTIME(n.created) as post_date

FROM node AS n
  INNER JOIN field_data_body b ON b.entity_id=n.nid AND b.delta=0
  INNER JOIN field_data_field_category c ON c.entity_id=n.nid AND c.deleted=0
  LEFT JOIN taxonomy_term_data t ON t.tid = c.field_category_tid
  INNER JOIN field_data_field_contributor a ON a.entity_id=n.nid AND a.deleted=0
  LEFT JOIN node as na ON na.nid=a.field_contributor_target_id
  INNER JOIN url_alias u ON u.source = concat('node/',n.nid)

WHERE FROM_UNIXTIME(n.created)
      BETWEEN '2014-01-01 00:00:00' AND '2014-12-31 23:59:59'
  AND n.type ='article'
GROUP BY n.nid
ORDER BY n.created DESC
</pre>

<p>
Export taxonomy vocabular
</p>
<pre class="example">
SELECT
  t.tid                                         AS tid,
  t.name,
  h.parent                                      AS parent_tid,
  t.weight,
  CONCAT('http://yourweb.com/', u.alias)                        AS url

FROM taxonomy_vocabulary v
  LEFT JOIN taxonomy_term_data t ON t.vid = v.vid
  LEFT JOIN taxonomy_term_hierarchy h ON h.tid = t.tid
  LEFT JOIN field_data_field_mega_title mega_title
    ON mega_title.entity_id = t.tid
  LEFT JOIN field_data_field_mega_story_title mega_story_title
    ON mega_story_title.entity_id = t.tid
  LEFT JOIN field_data_field_landing_page_type splash
    ON splash.entity_id = t.tid
  LEFT JOIN url_alias u ON u.source = concat('taxonomy/term/', t.tid)
WHERE
  0 = 0
  AND v.machine_name = 'articles'

ORDER BY h.parent, t.weight
</pre>
</div>
</div>

<div id="outline-container-orgcd7455a" class="outline-5">
<h5 id="orgcd7455a"><span class="section-number-5">2.20.2.9</span> Export File URI, file_managed <a id="org31d1761">d7:db:file uri</a></h5>
<div class="outline-text-5" id="text-2-20-2-9">
<pre class="example">
SELECT n.nid, n.title
,ds_i_fm.uri AS splash_image -- e.g. public://abc.jpg
,REGEXP_REPLACE(ds_i_fm.uri, "^(s3://)(.*)", 'http://s3.amazonaws.com/abc.com/\\2') AS splash_image, -- s3://abc.jpg
FROM node AS n
LEFT JOIN field_data_field_image ds_i ON ds_i.entity_id=n.nid AND ds_i.deleted=0
LEFT JOIN file_managed ds_i_fm ON ds_i_fm.fid = ds_i.field_image_fid
WHERE n.type = 'article'
  AND n.nid = 123
</pre>
</div>
</div>

<div id="outline-container-orgb15f22e" class="outline-5">
<h5 id="orgb15f22e"><span class="section-number-5">2.20.2.10</span> file_usage</h5>
<div class="outline-text-5" id="text-2-20-2-10">
<p>
fid
id :: e.g. node id
</p>
</div>
</div>

<div id="outline-container-org57e8ce6" class="outline-5">
<h5 id="org57e8ce6"><span class="section-number-5">2.20.2.11</span> system</h5>
<div class="outline-text-5" id="text-2-20-2-11">
<p>
<a href="#orgeaaad02">d7:ts:module is missing</a>
</p>
</div>
</div>

<div id="outline-container-org4971254" class="outline-5">
<h5 id="org4971254"><span class="section-number-5">2.20.2.12</span> users</h5>
<div class="outline-text-5" id="text-2-20-2-12">
<p>
*uid :: int(10)
name :: 
pass ::
mail :: email
init :: initial email
created :: int(11), unix time
access :: int(11), unix time. previous time user accessed the site
login :: int(11), unix time
status :: tinyint(4)
</p>
</div>
</div>

<div id="outline-container-orgbe43f3c" class="outline-5">
<h5 id="orgbe43f3c"><span class="section-number-5">2.20.2.13</span> users_role</h5>
<div class="outline-text-5" id="text-2-20-2-13">
<p>
uid
rid
</p>
</div>
</div>

<div id="outline-container-org015a567" class="outline-5">
<h5 id="org015a567"><span class="section-number-5">2.20.2.14</span> role</h5>
<div class="outline-text-5" id="text-2-20-2-14">
<p>
rid*
name
weight
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb35fff7" class="outline-3">
<h3 id="orgb35fff7"><span class="section-number-3">2.21</span> Query</h3>
<div class="outline-text-3" id="text-2-21">
<p>
Use <a href="https://www.drupal.org/docs/7/api/database-api/static-queries">db_query</a> as much as possible. db_select is slow because it calls alter hooks.
Both can only be looped once using foreach
</p>

<p>
Use db_query or db_select to get all nids, load all nodes at once and then manipulate fields.
</p>

<p>
db_query is meant for simple select query. <a href="https://www.drupal.org/node/310075">db_select</a> is dynamic query
</p>
</div>
<div id="outline-container-org17cfd9a" class="outline-4">
<h4 id="org17cfd9a"><span class="section-number-4">2.21.1</span> db_select</h4>
<div class="outline-text-4" id="text-2-21-1">
<pre class="example">
$q = db_select( 'node', 'n' );
$q-&gt;join( 'field_data_body', 'b', 'n.nid=b.entity_id AND b.delta=0' );
$q-&gt;innerJoin( 'field_data_field_category', 'nc'
  , 'n.nid=nc.entity_id AND nc.deleted=0' );
$q-&gt;innerJoin( 'taxonomy_term_hierarchy', 'tH', 'tH.tid=nc.field_category_tid' );

if ( ! is_null( $termID ) ) {
  $articleCats = array( $termID );
}

$q-&gt;fields( 'n', array( 'nid', 'title', 'created' ) )
  -&gt;fields( 'b', array( 'body_summary', 'body_value' ) )
  -&gt;condition( 'n.status', 1 )// Published.
  -&gt;condition( 'n.type', 'article' )// article not page.
  -&gt;condition(
    db_or()
      -&gt;condition( 'nc.field_category_tid', $articleCats, 'IN' )
      -&gt;condition( 'tH.parent', $articleCats, 'IN' )
  )
  -&gt;range( $i_start, $i_length )
  -&gt;groupBy( 'n.nid' )
  -&gt;orderBy( 'created', 'DESC' );

// debug a query
print_r($query-&gt;__toString());
print_r($query-&gt;arguments());

$r = $q-&gt;execute();

$nids = [ ];
foreach ( $result as $n ) {
  $nids[] = $n-&gt;nid;
}
$nodes = node_load_multiple( $nids );

foreach ( $nodes as $node ) {
  $nodeID    = $node-&gt;nid;
  $nodeTitle = $node-&gt;title;
  $nodeBody  = lili_getFieldSafe( $node, 'body' );
  $nodeURL   = url( "node/" . $node-&gt;nid );

  $nodeSplashObj = field_get_items( 'node', $node, 'field_splash_image' );

  if ( is_array( $nodeSplashObj ) ) {
    // $nodeSplashObj['#item']['uri'];
    // $nodeSplashObj['#item']['width'];
    // $nodeSplashObj['#item']['height'];
  }

  // Entity Reference
  $nodeFlag = field_get_items('node',$nodeObj,'field_flag');
  if ($nodeFlag) {
    $nodeFlag = field_view_value('node', $node, 'field_flag', $nodeFlag[0]);
    $nodeFlag = $nodeFlag['#markup'];
    $nodeFlag = theme_infscroll_flair(array('text'=&gt;$nodeFlag));
  }
  else {
    $nodeFlag = '';
  }

}

function lili_getFieldSafe( $node, $field ) {
  $s = field_get_items( 'node', $node, $field );
  if ( $s ) {
    $s = ( $s[0]['safe_value'] ) ? $s[0]['safe_value'] : '';
  } else {
    $s = '';
  }

  return $s;
}
</pre>
</div>
</div>

<div id="outline-container-orgfbe915f" class="outline-4">
<h4 id="orgfbe915f"><span class="section-number-4">2.21.2</span> db_query</h4>
<div class="outline-text-4" id="text-2-21-2">
<p>
<a href="https://www.drupal.org/docs/7/api/database-api/static-queries">https://www.drupal.org/docs/7/api/database-api/static-queries</a>
<a href="https://api.drupal.org/api/drupal/includes!database!database.inc/function/db_query/7.x">https://api.drupal.org/api/drupal/includes!database!database.inc/function/db_query/7.x</a>
</p>

<pre class="example">
$query = db_query("SELECT nid, title FROM {node}");
$records = $query-&gt;fetchAll(); // get all records into an indexed array of stdClass
$records = $query-&gt;rowCount();
foreach ($records as $record) {
  // Do something.
}

// placeholders should not be escaped or quoted
$result = db_query("SELECT nid, title FROM {node} WHERE created &gt; :created", 
array(
  ':created' =&gt; REQUEST_TIME - 3600,
));

db_query("SELECT * FROM {node} WHERE nid IN (:nids)", array(':nids' =&gt; array(13, 42, 144)));

// query options, use 'target' and 'fetch' only
'target' =&gt; 'default', // or 'slave'
'fetch' =&gt; PDO::FETCH_OBJ // or PDO::FETCH_ASSOC, PDO::FETCH_NUM, PDO::FETCH_BOTH or a string of a class name

$sql = "SELECT name, quantity FROM goods WHERE vid = :vid";
$result = db_query($sql, array(':vid' =&gt; $vid));
if ($result) {
  while ($row = $result-&gt;fetchAssoc()) {
    // fetch next row as an associative array
    // vs fetch next row as an object $result-&gt;fetchObject()
    // Do something with:
    // $row['name']
    // $row['quantity']
  }
}

// Get the first column result set as one single array
$nids = $result-&gt;fetchCol();
// Column number can be specified otherwise default to first column
$nids = $result-&gt;fetchCol(2);

// say first column is node id, then load all nodes
$nodes = node_load_multiple( $nids );
</pre>

<p>
Other fetch usage
</p>
<pre class="example">
// Fetch data from specific column from next row
// Defaults to first column if not specified as argument
$data = $result-&gt;fetchColumn(1); // Grabs the title from the next row

// Retrieve all records as stdObjects into an associative array 
// keyed by the field in the result specified. 
// (in this example, the title of the node)
$result-&gt;fetchAllAssoc('title');

// Retrieve a 2-column result set as an associative array of field 1 =&gt; field 2.
$result-&gt;fetchAllKeyed();
// Also good to note that you can specify which two fields to use
// by specifying the column numbers for each field
$result-&gt;fetchAllKeyed(0,2); // would be nid =&gt; created
$result-&gt;fetchAllKeyed(1,0); // would be title =&gt; nid

</pre>
</div>
</div>

<div id="outline-container-orge70419c" class="outline-4">
<h4 id="orge70419c"><span class="section-number-4">2.21.3</span> db_delete</h4>
<div class="outline-text-4" id="text-2-21-3">
<p>
Same syntax as db_select
</p>

<pre class="example">
$num_deleted = db_delete('node')
  -&gt;condition('nid', 5)
  -&gt;execute();
</pre>

<p>
Clear cache is needed if field_data_field_xxx are deleted.
Delete a required field for node (nid) <a id="org3ca3e02">d7:db:delete required field</a>
</p>
<pre class="example">
$q = db_delete('field_data_field_trailer_make');
$q-&gt;condition('entity_id', $node-&gt;nid);
$r = $q-&gt;execute();
</pre>
</div>
</div>

<div id="outline-container-orgcf045ed" class="outline-4">
<h4 id="orgcf045ed"><span class="section-number-4">2.21.4</span> <a href="#org53e550e">hook_query_TAG_alter</a> <a id="org53e550e">hook_query_TAG_alter</a></h4>
<div class="outline-text-4" id="text-2-21-4">
<pre class="example">
function mymod_query_node_is_not_tagged_alter(QueryAlterableInterface $query) {
  $query-&gt;leftJoin('field_data_field_tags', 'o', 'node.nid = o.entity_id AND o.entity_type = :entity_type');
  $query-&gt;isNull('o.field_tags_tid');
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org1a4d154" class="outline-3">
<h3 id="org1a4d154"><span class="section-number-3">2.22</span> Entity</h3>
<div class="outline-text-3" id="text-2-22">
<p>
Node, user, taxonomy are all entities.
</p>
</div>

<div id="outline-container-org2c9de92" class="outline-4">
<h4 id="org2c9de92"><span class="section-number-4">2.22.1</span> EntityFieldQuery <a id="org7b43c16">d7:efq</a></h4>
<div class="outline-text-4" id="text-2-22-1">
<p>
Use this to get entities of one type that have certain:
</p>
<ul class="org-ul">
<li>entity properties (propertyCondition: status, changed, etc)</li>
<li>field values (fieldCondition)</li>
<li>entity meta data (entityCondition: bundle, entity_type, entity_id and revision_id)</li>
<li>It's essentially db_select except EFQ can't do joins</li>
<li>It's a lot slower</li>
<li>But it provides simple syntax</li>
<li>It's good for quick filtering entities by basic field values and return entity ids</li>
<li>Preferred over db_select</li>
<li>EFQ can return any type of entities including nodes of various types</li>
<li>EFQ can only return essential fields such as node nid, vid and type</li>
<li>Use EFQ result nids and node_load_multiple or entity_load</li>
<li>Use EFQ result nids and get values of a field for all nodes (load only one field for all nodes)</li>
<li>If you want custom fields and node-&gt;title, better to use node_load_multiple or entity_load</li>
<li>By default without addMetaData, EFQ requires permissions of all the fields!</li>
</ul>

<pre class="example">
$_q = new EntityFieldQuery();
$_r = $_q
-&gt;entityCondition('entity_type', 'node') // taxonomy_term, user
-&gt;entityCondition('bundle', 'newsletter') // node type or content type
-&gt;fieldCondition('field_active','value',1,'=') // boolean field, only 1 or 0
-&gt;fieldCondition('field_news_publishdate', 'value', $year . '%', 'like') // Text LIKE
-&gt;fieldOrderBy('field_ns_newsletter_unique_id', 'value', 'DESC') // Sort. refer to propertyOrderBy for created date
-&gt;fieldCondition('field_a_term_reference_field', 'tid', 123) // field Term Reference
-&gt;fieldCondition('field_a_term_reference_field', 'tid', $tids) // field Term Reference multiple has at least one value in array $tids
-&gt;fieldCondition('field_dealer', 'target_id', 12345, '=') // field Entity Reference, single value
-&gt;fieldCondition('field_contacts', 'target_id', 12345) // field Entity Reference, multiple values have one 12345
/* NOT IN
12345 not in mutliple target_id: you have to do one query to show all and do one with 'IN' and 
get the difference
$_r_all = (!empty($_r_all['node'])) ? $_r_all['node'] : array();
$_r_in_12345 = (!empty($_r_in_12345['node'])) ? $_r_in12345['node'] : array();
$_r = array_diff_key($_r_all, $_r_in_12345);
*/

-&gt;propertyCondition('status',1) 
// status, type, nid, uid, rui, type, created
// search for "Implements hook_entity_info()" will show all entity properties

// Operators
// Default '='
// &lt;&gt;, &gt;, &gt;=, &lt;, &lt;=
// STARTS_WITH, CONTAINS
// IN, NOT IN (does not work)
// BETWEEN :: propertyCondtion('created', array($start, $end), 'BETWEEN')

-&gt;propertyOrderBy('created', 'DESC') // sort by created date

-&gt;range(0,10)
// Random order. hook_query_TAG_alter
-&gt;addTag('random')

/* If you run EFQ in Drupal Cron, by default the user is anonymous
   You should run EFQ as a user
*/
-&gt;addMetaData('account', user_load(1))
-&gt;execute();

/* array(
 'node' =&gt; // follow the entity_type: e.g. node, taxonomy_term, user 
 array(
  28912 =&gt; obj(nid =&gt; 28912) // could be uid, nid, tid
  ...
 )
)
*/

// or $_r['user']
if (!empty($_r['node'])) {
  $nodes = node_load_multiple(array_keys($_r['node']));
  // If you just want to load a handful of fields, you don't have to load the whole nodes
  // $stories = $_r['node'];
  // Get all fields of the entity type first
  // $fields = field_info_instances('node', 'story'); // node type is story
  // Get the field id
  // $field_id = $fields['field_story_image']['field_id'];
  // Attach the field to the entities loaded by EFQ
  // field_attach_load('node', $stories, FIELD_LOAD_CURRRENT,
  //  array('field_id' =&gt; $field_id));
  // All the values of field_story_image of all nodes
  // $output = field_get_items('node', $stories, 'field_story_image');
}
</pre>
</div>
</div>

<div id="outline-container-orgc5462fa" class="outline-4">
<h4 id="orgc5462fa"><span class="section-number-4">2.22.2</span> Update a field of an entity only <a id="orgafb2b25">d7:field_attach_update</a></h4>
<div class="outline-text-4" id="text-2-22-2">
<p>
Recommend <a href="#orgdfc0833">d7:entity_metadata_wrapper</a>
node_save could invoke other hooks and hence cause errors in saving a field value
</p>
<pre class="example">
$node = node_load($nid);
$node-&gt;field_fieldname[LANGUAGE_NONE][0]['value'] = 'some value';
node_save($node);
</pre>

<p>
Use field_attach_update() instead
</p>
<pre class="example">
$node = node_load($nid);
$node-&gt;field_fieldname[LANGUAGE_NONE][0]['value'] = 'some value';

unset($node-&gt;field_unwanted_1); // remove unwanted fields
field_attach_update('node', $node);
</pre>

<p>
Without node_load
</p>
<pre class="example">
$node = new stdClass();
$node-&gt;id = $id_value; // node id
$node-&gt;type = $content_type; // aka content type

$node-&gt;field_fieldname[LANGUAGE_NONE][0]['value'] = 'some value';
field_attach_update('node', $node);
</pre>

<p>
May be better to call field_attach_presave which node_save does
</p>
<pre class="example">
field_attach_presave('node', $node); // call hook_field_attach_presave
field_attach_update('node', $node);
</pre>
</div>
</div>

<div id="outline-container-orgaede518" class="outline-4">
<h4 id="orgaede518"><span class="section-number-4">2.22.3</span> entity_metadata_wrapper <a id="orgdfc0833">d7:entity_metadata_wrapper</a></h4>
<div class="outline-text-4" id="text-2-22-3">
<p>
Get a field value of an entity (node)
</p>
<ul class="org-ul">
<li>Add a wrapper first <code>$_wrapper=entity_metadata_wrapper('node',$node);</code></li>
<li>$node can be a node/entity object or the node/entity id.</li>
<li>Entity API module is needed.</li>
<li>List all fields using <code>$_wrapper-&gt;getPropertyInfo();</code></li>
<li>Get a specific field <code>$_wrapper-&gt;field_name-&gt;value();</code> or <code>-&gt;raw();</code></li>
</ul>

<pre class="example">
// Unified way of getting $node-&gt;title, $user-&gt;name, ...
$wrapper-&gt;label(); or $wrapper-&gt;title-&gt;value();

// Unified way of getting $node-&gt;nid, $user-&gt;uid, ...
$wrapper-&gt;getIdentifier();

// Unified way of getting $node-&gt;type, ...
$wrapper-&gt;getBundle();

// Text field
$old_value = $wrapper-&gt;field_my_text-&gt;value();
if (isset($old_value)) {
  // non-null, could be empty or 0
}
$wrapper-&gt;field_my_text = 'new value';

// Longtext
$wrapper-&gt;body-&gt;value(); // Array of: value, safe_value, format, and optionally summary + safe_summary.
$wrapper-&gt;body-&gt;value-&gt;value(); // Filtered value.
$wrapper-&gt;body-&gt;value-&gt;raw(); // Unfiltered value.
$wrapper-&gt;body-&gt;format-&gt;value(); // The selected text format.
$wrapper-&gt;body-&gt;value = 'new value';

// Link
$wrapper-&gt;field_my_link-&gt;value(); // Array of: url, title, attributes.
$wrapper-&gt;field_my_link-&gt;url-&gt;value(); // Hyperlink destination.
$wrapper-&gt;field_my_link-&gt;title-&gt;value(); // Hyperlink text.
$wrapper-&gt;field_my_link-&gt;attributes-&gt;value(); // Array of: target, title, etc.
$wrapper-&gt;field_my_link-&gt;url = 'http://mediacurrent.com';
$wrapper-&gt;field_my_link-&gt;title = 'Do Drupal Right';

// Radio and Checkbox
$v = $wrapper-&gt;field_my_radio-&gt;value(); // on = 1, off = 0
$info = field_info_field('field_my_radio'); // on = New, off = Used
$allowed_values = $info['settings']['allowed_values'];
$label = $allowed_values[$v]; // on = New, off = Used

// Delete a value, unset a field, taxonomy in selectlist is different
$wrapper-&gt;field_foobar = NULL;

// Save
$wrapper-&gt;save();

// Select list of taxonomy or entity reference, General Usage
Append index
`$term = $_wrapper-&gt;field_taxonomy_a[0]-&gt;value();`
If only one value is allowed, it doesn't have index.
Loop
foreach ($_wrapper-&gt;field_list_of_values as $item) {
//  do something
}

// Taxonomy in select list
For taxonomy term field which can be multiple values, you still need to specify the index
`$term = $_wrapper-&gt;field_taxonomy_a[0]-&gt;value();` // this might be wrong..
</pre>

<p>
Multiple Tax Terms
</p>
<pre class="example">
$a = $wrapper-&gt;$field-&gt;value();
if (isset($a)) {
  echo $a[0]-&gt;name;
  echo $a[0]-&gt;tid;
}
</pre>

<p>
Single Tax Term
</p>
<pre class="example">
$a = $wrapper-&gt;$field-&gt;value();
if (isset($a)) {
  echo $a-&gt;name;
  echo $a-&gt;tid;
}
</pre>

<p>
Multiple Files
</p>
<pre class="example">
$a = $wrapper-&gt;$field-&gt;value();
if (isset($a)) {
  $r=$a;
  foreach ($r as $k =&gt; $v) {
    $r[$k]['url'] = file_create_url($r[$k]['uri']);
    // convert URI to public URL
    // Drupal doesn't provide public 'url'
  }
  echo $r[0]['uri'];
  echo $r[1]['uri'];
}
</pre>

<p>
Term id of the first value of a multiple value field <code>$tid = $_wrapper-&gt;field_taxonomy_a[0]-&gt;raw();</code>
For taxonomy term field which can only have one value:
Term ID: <code>$_wrapper-&gt;field_tax_1-&gt;raw();</code>
Check empty <code>if (isset($tid))</code>
</p>

<p>
Term name: <code>$_wrapper-&gt;field_tax_1-&gt;name-&gt;value();</code>
Or in a multi value list <code>$v = $_wrapper-&gt;field_tax_1[0]-&gt;value(); echo $v-&gt;name;</code>
</p>

<p>
Add a term or entity reference: <code>$_w-&gt;field_tax_1[] = 42; $_w-&gt;save();</code>
Set as a whole <code>$_w-&gt;field_tax_1-&gt;set(array(42,43)); $_w-&gt;save();</code>
</p>

<p>
Change a term for a single tax field $_w-&gt;field_tax_1-&gt;set(42); $_w-&gt;save();
</p>

<p>
A required field can't be unset. Refer to <a href="#org3ca3e02">d7:db:delete required field</a>
Unset a term for a single tax field unset($_w-&gt;field_tax_1)
Unset a term for a multi tax field 
</p>
<pre class="example">
foreach($wrapper-&gt;field_foobar as $delta =&gt; $item)  {
  if ($item-&gt;nid-&gt;value() == $my_id) {
    unset($wrapper-&gt;field_foobar[$delta]);
    $wrapper-&gt;save();
    break;
  }
}
</pre>

<p>
Set empty value for tax term field
</p>
<pre class="example">
$wrapper-&gt;field_example_multiple-&gt;set();
$wrapper-&gt;field_example_multiple = array();
$wrapper-&gt;field_example_multiple = NULL;
</pre>

<p>
Loop
</p>
<pre class="example">
foreach ($_wrapper-&gt;field_industry as $taxonomy_wrapper) {
  $industry = $taxonomy_wrapper-&gt;tid-&gt;value();
}
</pre>

<p>
A list of text
</p>
<pre class="example">
// All values in a list text as an array
$wrapper-&gt;field_list_text-&gt;value();

foreach ($wrapper-&gt;field_taxonomy_terms-&gt;getIterator() as $delta =&gt; $term_wrapper) {
  // $term_wrapper may now be accessed as a taxonomy term wrapper.
  $label = $term_wrapper-&gt;name-&gt;value();
  // list text, delta is 0, 1
  // List text value $term_wrapper-&gt;value();
}
</pre>

<p>
If the list of text field only allows one value, then the value is
<code>$w-&gt;field_list_text-&gt;value();</code> The same as getting a text field
</p>

<p>
// Entity reference in select list
Single value. Tid is $tid = $wrapper-&gt;field_list_entity-&gt;raw();
Check empty `if (isset($tid)) { echo $wrapper-&gt;field_list_entity-&gt;value()-&gt;title}`
Multiple values.
</p>

<p>
<a href="https://www.drupal.org/documentation/entity-metadata-wrappers">https://www.drupal.org/documentation/entity-metadata-wrappers</a>
<a href="http://www.mediacurrent.com/blog/entity-metadata-wrapper">http://www.mediacurrent.com/blog/entity-metadata-wrapper</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org68d6f55" class="outline-3">
<h3 id="org68d6f55"><span class="section-number-3">2.23</span> Entityform</h3>
<div class="outline-text-3" id="text-2-23">
<p>
D7 uses entityform module. D8 is called EForm.
Load an entityform
</p>
<pre class="example">
// Load the module file. Optional
// module_load_include('inc', 'entityform', 'entityform-admin');
$_contact_form = entityform_empty_load('entityform_id');
$mode = 'submit'; 
// Default. Other: 'edit'
$form_context = 'page'; 
// Default. Ohter: 'embedded'
$_renderable_form = entityform_form_wrapper($_contact_form, $mode, $form_context );
</pre>

<p>
Try to prefill entityform in hook_form_FORM_ID_alter(). Say the entityform is named dealer_contact
The hook is lili_form_dealer_contact_entityform_edit_form_alter
</p>

<p>
Use modal in CTools, you will need t:
</p>
<ul class="org-ul">
<li><a href="https://www.drupal.org/project/entityform">Entityform</a></li>
<li><a href="https://www.drupal.org/project/modal">Modal operations</a></li>
<li><a href="https://www.drupal.org/project/modal_forms">Modal forms (with ctools)</a></li>
<li>Enable the Modal entityforms module</li>
<li>Create a link (e.g. in View)</li>
</ul>
<pre class="example">
&lt;a href="/modal/entityform/YOUR_FORM_IDENTIFIER/nojs/0" 
   class="ctools-use-modal ctools-modal-modal-popup-small"&gt;Open Entity Form in Popup!&lt;/a&gt;
</pre>
</div>
</div>

<div id="outline-container-org9205fcc" class="outline-3">
<h3 id="org9205fcc"><span class="section-number-3">2.24</span> User</h3>
<div class="outline-text-3" id="text-2-24">
</div>
<div id="outline-container-org37f131d" class="outline-4">
<h4 id="org37f131d"><span class="section-number-4">2.24.1</span> Get user fields</h4>
<div class="outline-text-4" id="text-2-24-1">
<p>
global $user
</p>

<p>
<code>$account = user_load($user-&gt;uid)</code> to load all fields
</p>

<p>
or use <a href="#orgdfc0833">d7:entity_metadata_wrapper</a> to get a couple fields
</p>

<p>
$user_wrapper = entity_metadata_wrapper('user', $user);
drupal_set_message('&lt;pre&gt;'.var_export($user_wrapper-&gt;field_node-&gt;raw(),1).'&lt;/pre&gt;'); // Raw value
drupal_set_message('&lt;pre&gt;'.var_export($user_wrapper-&gt;field_node-&gt;value(),1).'&lt;/pre&gt;'); 
</p>
</div>
</div>

<div id="outline-container-org618cc43" class="outline-4">
<h4 id="org618cc43"><span class="section-number-4">2.24.2</span> user_access</h4>
<div class="outline-text-4" id="text-2-24-2">
<p>
<a id="org2c2bfe5">d7:user_access</a>
user_access($string, $account = NULL)
$account
</p>
<ul class="org-ul">
<li>NULL. current logged in user</li>
</ul>
</div>
</div>

<div id="outline-container-orge10bfd5" class="outline-4">
<h4 id="orge10bfd5"><span class="section-number-4">2.24.3</span> user_is_logged_in, user_has_role</h4>
<div class="outline-text-4" id="text-2-24-3">
<p>
user_is_logged_in &amp;&amp; user_has_role(3) :: check if current user is admin
</p>

<p>
anonymous :: 1
authenticated user :: 2
administrator :: 3
</p>
</div>
</div>
</div>

<div id="outline-container-org032de29" class="outline-3">
<h3 id="org032de29"><span class="section-number-3">2.25</span> Menu</h3>
<div class="outline-text-3" id="text-2-25">
</div>
<div id="outline-container-orgf3cd567" class="outline-4">
<h4 id="orgf3cd567"><span class="section-number-4">2.25.1</span> hook_menu: 'page callback'</h4>
<div class="outline-text-4" id="text-2-25-1">
<p>
You can print or echo some rendered HTML and then drupal_exit() or exit().
drupal_exit() prevents hoo_exit() from running.
Or print and echo some HTML and return NULL;
No header or footer will be added. The page is pure what you output here.
</p>

<p>
Or you can return a renderable array. Header and footer will be included.
</p>
<ul class="org-ul">
<li>return $form. You may theme the form by $form['#theme'][] = 'custom_theme_name'; and return $form</li>
<li>return theme('custom_theme_name', ['vars'=&gt;&#x2026;]);</li>
</ul>

<p>
In page callback function, you can manipulate some variables used in html.tpl.php and page.tpl.php
Such as change the page title drupal_set_title
Refer to <a href="#orgc8aa747">d7:functions</a>
</p>
</div>
</div>

<div id="outline-container-org8fec258" class="outline-4">
<h4 id="org8fec258"><span class="section-number-4">2.25.2</span> hook_menu: 'file'</h4>
<div class="outline-text-4" id="text-2-25-2">
<p>
You can local the page callback function in a different file. e.g. 'lili.pages.inc'
The path is the current module path
</p>
</div>
</div>

<div id="outline-container-org3cb8aa6" class="outline-4">
<h4 id="org3cb8aa6"><span class="section-number-4">2.25.3</span> hook_menu: 'type'</h4>
<div class="outline-text-4" id="text-2-25-3">
<dl class="org-dl">
<dt>MENU_CALLBACK</dt><dd>A hidden internal callback. Best for return plain text in API calls.</dd>
<dt>MENU_LOCAL_ACTION</dt><dd>An action specific to the parent, usually rendered as a link</dd>
<dt>MENU_LOCAL_TASK</dt><dd>A task specific to the parent item, usually rendered as a tab.</dd>
<dt>MENU_NORMAL_ITEM</dt><dd>Shown in menu and breadcrumbs</dd>
<dt>MENU_SUGGESTED_ITEM</dt><dd>A normal menu item, hidden until enabled by an administrator</dd>
</dl>
</div>
</div>

<div id="outline-container-orgfaf13d2" class="outline-4">
<h4 id="orgfaf13d2"><span class="section-number-4">2.25.4</span> hook_menu: 'access callback', 'access arguments'</h4>
<div class="outline-text-4" id="text-2-25-4">
<p>
access callback
</p>
<ul class="org-ul">
<li>default is 'user_access' <a href="#org2c2bfe5">d7:user_access</a></li>
<li>custom callback must return boolean</li>
<li>Often used callbacks: 'user_is_logged_in'</li>
<li>TRUE is for anyone to access</li>
</ul>

<p>
access arguments
</p>
<ul class="org-ul">
<li>e.g. ['administer nodes']</li>
</ul>
</div>
</div>

<div id="outline-container-orgcf05069" class="outline-4">
<h4 id="orgcf05069"><span class="section-number-4">2.25.5</span> Embed a View Page</h4>
<div class="outline-text-4" id="text-2-25-5">
<pre class="example">
function lili_menu() {
  $items['path-different-from-view/%'] = array(
    'title' =&gt; t('page title');
    'page callback' =&gt; 'views_embed_view',
    'page arguments' =&gt; array('view_id', 'dispaly_id', 1),
    'type' =&gt; MENU_CALLBACK,
    'access callback' =&gt; TRUE,
  );
  return $items;
}
</pre>
</div>
</div>

<div id="outline-container-orgda00790" class="outline-4">
<h4 id="orgda00790"><span class="section-number-4">2.25.6</span> Array to CSV</h4>
<div class="outline-text-4" id="text-2-25-6">
<p>
page callback
drupal_add_http_header('Content-Type', 'text/csv; utf-8');
drupal_add_http_header('Content-Disposition', 'attachment;filename=csvfile.csv');
</p>

<p>
$fp = fopen('php://output', 'w');
fputcsv($fp, [$year. ' Ranking of Top 100 Carriers']);
$_columns = '#,Company,Web Site,Total,Trucks,Tractors,Trailers,O/OS,Employees';
$_columns = explode(',',$_columns);
fputcsv($fp, $_columns);
</p>

<p>
foreach ($data as $d) {
  $line   = [ ];
  $line[] = $d-&gt;this_rank;
  $line[] = $d-&gt;company_name;
  $line[] = $d-&gt;web_address;
  $line[] = $d-&gt;total_vehicles;
  $line[] = $d-&gt;trucks;
  $line[] = $d-&gt;tractors;
  $line[] = $d-&gt;trailers;
  $line[] = $d-&gt;owner_operators;
  $line[] = $d-&gt;full_time_employees;
</p>

<p>
  fputcsv( $fp, $line );
}
</p>

<p>
fclose($fp);
drupal_exit();
</p>
</div>
</div>

<div id="outline-container-org27e908e" class="outline-4">
<h4 id="org27e908e"><span class="section-number-4">2.25.7</span> Json</h4>
<div class="outline-text-4" id="text-2-25-7">
<pre class="example">
function lili_menu() {
  $items['newsletter/archive/%/%'] = array(
    'title' =&gt; "",
    'page callback' =&gt; '_lili_archive_by_newsletter_json',
    'page arguments' =&gt; array(2,3),
    'access callback' =&gt; TRUE,
    'type' =&gt; MENU_CALLBACK,
  );

  return $items;
}

function _lili_archive_by_newsletter_json($pub_id,$newsletter_name, $page = 1, $items = 20) {
  drupal_add_http_header('Access-Control-Allow-Origin','*'); // CORS            
  $_result['total'] = '...';
  $_result['items'] = array('...');

  drupal_json_output($_result);
  //return 'hello';
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orga364eb3" class="outline-3">
<h3 id="orga364eb3"><span class="section-number-3">2.26</span> Taxonomy</h3>
<div class="outline-text-3" id="text-2-26">
<p>
A node or an entity has a taxonomy term means the node has a category. Categories may have hierarchy.
</p>
</div>

<div id="outline-container-org4a42d1c" class="outline-4">
<h4 id="org4a42d1c"><span class="section-number-4">2.26.1</span> Get taxonomy terms of a node, ready for display with language</h4>
<div class="outline-text-4" id="text-2-26-1">
<pre class="example">
$categories = field_get_items('node', $node, 'field_category');
array(
0 =&gt; array(
  'tid' =&gt; 17,
  'taxonomy_term' =&gt; obj
),
...
)
</pre>
</div>
</div>

<div id="outline-container-orgb0f33cd" class="outline-4">
<h4 id="orgb0f33cd"><span class="section-number-4">2.26.2</span> Get multiple terms by id, taxonomy_term_load_multiple</h4>
<div class="outline-text-4" id="text-2-26-2">
<pre class="example">
$tids = array(1,2,3); // Default:array()
$conditions = array(); // Default
taxonomy_term_load_multiple($tids, $conditions);
array(
17 =&gt; obj(
  tid =&gt; '17',
  ...
)
...
)
</pre>
</div>
</div>

<div id="outline-container-orgd545812" class="outline-4">
<h4 id="orgd545812"><span class="section-number-4">2.26.3</span> Get term by name, taxonomy_get_term_by_name</h4>
<div class="outline-text-4" id="text-2-26-3">
<pre class="example">
$_limit_to_vocab = 'vocab_name'; // Default NULL.
$term_is_parent = taxonomy_get_term_by_name('video', $_limit_to_vocab);
</pre>
</div>
</div>

<div id="outline-container-org4671c4c" class="outline-4">
<h4 id="org4671c4c"><span class="section-number-4">2.26.4</span> Get all children of a term, taxonomy_get_children</h4>
<div class="outline-text-4" id="text-2-26-4">
<p>
Get a term that is parent
</p>
<pre class="example">
$_limit_to_vocab = 'vocab_name'; // Default NULL.
$term_is_parent = taxonomy_get_term_by_name('video', $_limit_to_vocab);

// Get the first item in array
$term_is_parent = reset($term_is_parent);

echo $term_is_parent-&gt;tid; // parent term id

// Get all children of a term
$children = taxonomy_get_children($term-&gt;tid);
$children_tids = array_keys($children);
</pre>
</div>
</div>

<div id="outline-container-org72dcfcb" class="outline-4">
<h4 id="org72dcfcb"><span class="section-number-4">2.26.5</span> Get a vocabulary by name and all terms</h4>
<div class="outline-text-4" id="text-2-26-5">
<pre class="example">
$_vocab = taxonomy_vocabulary_machine_name_load('vocab_name');

// Get all terms of a vocabulary without extra fields
$_terms = taxonomy_get_tree($_vocab-&gt;vid);

// Get term ids only of all terms under a vocabulary
$_q = new EntityFieldQuery();
$_term_ids = $_q 
-&gt;entityCondition('entity_type', 'taxonomy_term')
-&gt;propertyCondition('vid', $_vocab-&gt;vid)
-&gt;execute();
foreach ($_term_ids['taxonomy_term'] as $term) {
  $term-&gt;id;
}

// Get all fields of all terms under a vocabulary
$_terms_with_all_fields = entity_load('taxonomy_term', FALSE, array('vid' =&gt; $_vocab-&gt;vid));
/* array(
17 =&gt; obj(
 tid =&gt; '17',
 ...
),
...
)
*/

// Or

$parent = 0; // Default
$max_depth = NULL; // Default
$load_entities = TRUE; // Default:False
$_terms_with_all_fields = taxonomy_get_tree($_vocab-&gt;vid, $parent, $max_depth, $load_entities);
array(
0 =&gt; obj(
  tid =&gt; '17',
  ...
)
...
)
</pre>
</div>
</div>

<div id="outline-container-orga7494c7" class="outline-4">
<h4 id="orga7494c7"><span class="section-number-4">2.26.6</span> Get terms of a vocabulary ready for form</h4>
<div class="outline-text-4" id="text-2-26-6">
<p>
<a href="#orgdab2d91">d7:form:taxonomy field</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orgfc594d3" class="outline-3">
<h3 id="orgfc594d3"><span class="section-number-3">2.27</span> Cache</h3>
<div class="outline-text-3" id="text-2-27">
</div>
<div id="outline-container-org6d4423e" class="outline-4">
<h4 id="org6d4423e"><span class="section-number-4">2.27.1</span> Setting</h4>
<div class="outline-text-4" id="text-2-27-1">
<p>
Configuration &gt; Peformance (/admin/config/development/performance)
</p>
<ul class="org-ul">
<li>Always check <code>Cache pages for anonymous users</code> which is <code>cache</code>
<ul class="org-ul">
<li>External cache system e.g. Varnish may still cache the page even when this is disabled</li>
</ul></li>

<li>Check <code>Cache blocks</code> which is <code>block_cache</code> for logged-in users.</li>
<li><code>Minimum Cache Lifetime</code> which is <code>cache_lifetime</code>
<ul class="org-ul">
<li>If you're not sure, better leave it as 0</li>
<li>It applies to all pages and cache objects</li>
<li>The value is <code>It's ok to serve cache objects which are stale for this value amount of time</code></li>
<li>The cache clearing is triggered by events e.g. Drupal Cron. If these events are not triggered, the cache will not be regenerated even if the expiration has passed</li>
<li>e.g. If it's set to 5 mins and a new post is created, the new post appears on the homepage at least after 5 mins and Drupal Cron is run</li>
<li><code>cache_set()</code> with no <code>$expire</code> time will take <code>cache_lifetime</code>. Set <code>$expire</code> in <code>cache_set</code> to overide.</li>
<li>When <code>cache_lifetime</code> is reached in Redis, cache key and value will be removed from Redis.</li>
<li></li>
</ul></li>
<li>Start with 15 mins and go up as you need for <code>Expiration of cached pages</code> which is <code>page_cache_maximum_age</code>
<ul class="org-ul">
<li>It has nothing to do with cache objects or Drupal Database</li>
<li>It sets an HTTP response header <code>Cache-Control: public, max-age=&lt;...&gt;</code>. Refer to <a href="#orgc4cf7dc">header:cache-control:public max-age</a></li>
</ul></li>
</ul>

<p>
Bandwidth Optimization:
</p>
<dl class="org-dl">
<dt><code>Compress cached pages</code></dt><dd>If your server (Pantheon) already delivers content in gzip, then don't check it</dd>
<dt>(no term)</dt><dd>Always check <code>Aggregate and compress CSS files</code> and <code>Aggregate JavaScript files</code></dd>
</dl>

<p>
External cache system may include Varnish and other proxy servers.
</p>
</div>
</div>

<div id="outline-container-orgbe144da" class="outline-4">
<h4 id="orgbe144da"><span class="section-number-4">2.27.2</span> Same page request</h4>
<div class="outline-text-4" id="text-2-27-2">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffad29; font-weight: bold;">function</span> <span style="color: #00ede1; font-weight: bold;">lili_cache</span>(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">field</span>, <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">set</span> = <span style="color: #008b8b;">NULL</span>) {
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">custom_cache</span> = &amp;drupal_static(<span style="color: #008b8b;">__FUNCTION__</span>);
  <span style="color: #ffad29; font-weight: bold;">if</span> (!<span style="color: #ffad29; font-weight: bold;">isset</span>(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">custom_cache</span>)) {
    <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">custom_cache</span> = <span style="color: #ffad29; font-weight: bold;">array</span>();
  }
  <span style="color: #ffad29; font-weight: bold;">if</span> (<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">set</span> !== <span style="color: #008b8b;">NULL</span> &amp;&amp; <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">field</span> !== <span style="color: #008b8b;">NULL</span> ) {
    <span style="color: #74af68;">// </span><span style="color: #74af68;">$set_field_value = lili_cache('field_name', 123);</span>
    <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">custom_cache</span>[<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">field</span>] = <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">set</span>;
  } 
  <span style="color: #ffad29; font-weight: bold;">elseif</span> (<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">field</span> !==  <span style="color: #008b8b;">NULL</span> &amp;&amp; <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">set</span> == <span style="color: #008b8b;">NULL</span> &amp;&amp;
      ( !<span style="color: #ffad29; font-weight: bold;">isset</span>(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">custom_cache</span>[<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">field</span>]) || <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">custom_cache</span>[<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">field</span>] == <span style="color: #008b8b;">NULL</span> ) 
     ) {
    <span style="color: #74af68;">// </span><span style="color: #74af68;">Set default</span>
    <span style="color: #74af68;">// </span><span style="color: #74af68;">$set_field_value = lili_cache('field_name');</span>
    <span style="color: #ffad29; font-weight: bold;">switch</span> (<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">field</span>) {
      <span style="color: #ffad29; font-weight: bold;">case</span> <span style="color: #e67128;">"field_name"</span>:
  <span style="color: #74af68;">// </span><span style="color: #74af68;">complicated</span>
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">custom_cache</span>[<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">field</span>] = <span style="color: #e67128;">''</span>;
  <span style="color: #ffad29; font-weight: bold;">break</span>;
      <span style="color: #ffad29; font-weight: bold;">case</span> <span style="color: #e67128;">"truck_makes_array"</span>:
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_terms</span> = lili_cache(<span style="color: #e67128;">'truck_makes_obj'</span>);
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">a</span> = [];
  <span style="color: #ffad29; font-weight: bold;">foreach</span> (<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_terms</span> <span style="color: #ffad29; font-weight: bold;">as</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">k</span> =&gt; <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">v</span>) {
    <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">a</span>[<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">v</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #dbdb95;">name</span>] = (<span style="color: #34cae2;">tid</span>) <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">v</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #dbdb95;">tid</span>;
  }
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">custom_cache</span>[<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">field</span>] = <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">a</span>;
  <span style="color: #ffad29; font-weight: bold;">break</span>;
      <span style="color: #ffad29; font-weight: bold;">case</span> <span style="color: #e67128;">"truck_makes_obj"</span>:
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">vocab</span> = taxonomy_vocabulary_machine_name_load(<span style="color: #e67128;">'truck_makes'</span>);
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">terms</span> = taxonomy_get_tree(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">vocab</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #dbdb95;">vid</span>);
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">custom_cache</span>[<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">field</span>] = (!<span style="color: #ffad29; font-weight: bold;">empty</span>(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">terms</span>)) ? <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">terms</span> : [];
  <span style="color: #ffad29; font-weight: bold;">break</span>;
    } 
  }

  <span style="color: #ffad29; font-weight: bold;">if</span> (!<span style="color: #ffad29; font-weight: bold;">isset</span>(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">custom_cache</span>[<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">field</span>])) {
    <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">custom_cache</span>[<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">field</span>] = <span style="color: #008b8b;">NULL</span>;
  }

  <span style="color: #ffad29; font-weight: bold;">return</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">custom_cache</span>[<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">field</span>];
}

<span style="color: #74af68;">// </span><span style="color: #74af68;">Set</span>
lili_cache(<span style="color: #e67128;">'current_node'</span>,<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">node</span>);
<span style="color: #74af68;">// </span><span style="color: #74af68;">Get lili_cache('current_node');</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfa8ff79" class="outline-4">
<h4 id="orgfa8ff79"><span class="section-number-4">2.27.3</span> Cache variables in cache table, and clear them</h4>
<div class="outline-text-4" id="text-2-27-3">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffad29; font-weight: bold;">function</span> <span style="color: #00ede1; font-weight: bold;">my_module_function</span>() {
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">my_data</span> = &amp;drupal_static( <span style="color: #008b8b;">__FUNCTION__</span> );
  <span style="color: #ffad29; font-weight: bold;">if</span> ( ! <span style="color: #ffad29; font-weight: bold;">isset</span>( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">my_data</span> ) ) {
    <span style="color: #ffad29; font-weight: bold;">if</span> ( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">cache</span> = cache_get( <span style="color: #e67128;">'my_module_data'</span> ) ) {
      <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">my_data</span> = <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">cache</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #dbdb95;">data</span>;
    } <span style="color: #ffad29; font-weight: bold;">else</span> {
      <span style="color: #74af68;">// </span><span style="color: #74af68;">Do your expensive calculations here, and populate $my_data</span>
      <span style="color: #74af68;">// </span><span style="color: #74af68;">with the correct stuff..</span>
      cache_set( <span style="color: #e67128;">'my_module_data'</span>, <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">my_data</span>, <span style="color: #e67128;">'cache'</span> );
      <span style="color: #74af68;">// </span><span style="color: #74af68;">Set cache with an expiry time</span>
      <span style="color: #74af68;">// </span><span style="color: #74af68;">cache_set('my_module_data', $my_data, 'cache', time() + 360);</span>
    }
  }
  <span style="color: #ffad29; font-weight: bold;">return</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">my_data</span>;
}
</pre>
</div>

<dl class="org-dl">
<dt>Clear one variable cache</dt><dd><code>cache_clear_all('my_module_data', 'cache');</code></dd>
<dt>Clear all variables start with <code>my_module</code></dt><dd><code>cache_clear_all('my_module', 'cache', TRUE);</code></dd>
</dl>
</div>
</div>

<div id="outline-container-org6e89155" class="outline-4">
<h4 id="org6e89155"><span class="section-number-4">2.27.4</span> Cache block <a id="org8a399ff">d7:cache block</a></h4>
<div class="outline-text-4" id="text-2-27-4">
<p>
If there're modules setup node_grants, variable block_cache in Performance will be FALSE and disabled. 
You will see table cache_block is empty. In Pantheon, cache is in Redis
Here's how to Enable caching for specific blocks only.
In settings.php
</p>
<pre class="example">
$conf['block_cache_bypass_node_grants'] = "TRUE";
$conf['block_cache'] = "TRUE";
</pre>

<p>
Set all blocks to DRUPAL_NO_CACHE (_block_get_cache_id($block))
Set the blocks to cache to have any one of
</p>
<ul class="org-ul">
<li>DRUPAL_CACHE_GLOBAL</li>
<li>DRUPAL_CACHE_PER_PAGE</li>
<li>DRUPAL_CACHE_PER_ROLE</li>
<li>DRUPAL_CACHE_PER_USER</li>
<li>DRUPAL_CACHE_CUSTOM (in this case you need to setup own caching in hook_block_view or hook_block_view_MODULE_DELTA)</li>
</ul>
<p>
But not DRUPAL_NO_CACHE
</p>
</div>
</div>
</div>

<div id="outline-container-orgb54f82c" class="outline-3">
<h3 id="orgb54f82c"><span class="section-number-3">2.28</span> File</h3>
<div class="outline-text-3" id="text-2-28">
<p>
Read local or remote file to an object of strings
</p>
<pre class="example">
$result = drupal_http_request($url);
/*
obj(
 code // int 200
 headers
)
*/

$path = 'public://afolder/';
$replace = FILE_EXISTS_RENAME; // Default
// FILE_EXISTS_REPLACE, FILE_EXISTS_ERROR
file_unmanaged_save_data($result-&gt;data, $path, $replace);
</pre>

<p>
<a id="org414e9a4">file_unmanaged_save_data</a>($data, $destination, $replace)
</p>
<pre class="example">
// $destination is folder path not folder path + filename
$temp_name = 'temporary://auniquefilename'
file_put_contents($temp_name,$data); // return number of bytes or false
file_unmanaged_move($temp_name,$destination, $replace); // rename
</pre>

<p>
<a id="org15c3fff">Drupal download file with real file extension</a>
</p>
<pre class="example">
/**
 * Download external file to temporary filesystem
 * with correct file extension based on content-type in http response header
 *
 * @param $url string Full external URL of a file
 *
 * @return string Local file path with correct file extension
 */
function _lili_save_file_with_extension( $url ) {
  $filename  = $url;
  $extension = '';
  $result    = drupal_http_request( $url );

  if ( $result-&gt;code == 200 &amp;&amp; isset( $result-&gt;headers['content-type'] ) ) {
    $mime_type_extension = array(
      'image/jpeg'  =&gt; 'jpg',
      'image/jpg'   =&gt; 'jpg',
      'image/png'   =&gt; 'png',
      'image/x-png' =&gt; 'png',
      'image/gif'   =&gt; 'gif'
    );

    foreach ( $mime_type_extension as $k =&gt; $v ) {
      if ( strcasecmp( $k, $result-&gt;headers['content-type'] ) == 0 ) {
        $extension = $v;
        break;
      }
    }

    if ( $extension !== '' ) {
      // Save file with correct file extension
      $filename = 'temporary://import_' . str_replace( ".", "_", microtime( TRUE ) ) . "." . $extension;
      file_put_contents( $filename, $result-&gt;data );
    }
  }

  return $filename;
}
</pre>
</div>
</div>

<div id="outline-container-org99a5042" class="outline-3">
<h3 id="org99a5042"><span class="section-number-3">2.29</span> Image Handling (Core)</h3>
<div class="outline-text-3" id="text-2-29">
</div>
<div id="outline-container-orgd945f55" class="outline-4">
<h4 id="orgd945f55"><span class="section-number-4">2.29.1</span> Setting</h4>
<div class="outline-text-4" id="text-2-29-1">
<p>
Define Image Styles <code>/admin/config/media/image-style</code>
Use it in image field display or in code.
Image toolkit <code>/admin/config/media/image-toolkit</code> reduces the JPEG quality if Image Styles is applied.
</p>

<p>
Both Image Styles and Image toolkit don't modify the original images but instead create new images in real time.
</p>
</div>
</div>

<div id="outline-container-orge5d4201" class="outline-4">
<h4 id="orge5d4201"><span class="section-number-4">2.29.2</span> Code</h4>
<div class="outline-text-4" id="text-2-29-2">
<p>
An image is a file. Get a image field:
</p>
<pre class="example">
$w = entity_metadata_wrapper('node', $node);
$images = $w-&gt;field_images-&gt;value();
if (isset($images)) {
  // If the image field is set to only hold one image, then
  // $images is ['uri'=&gt;'...']
  foreach ($r as $k =&gt; $v) {
    $r[$k]['url'] = file_create_url($v['uri']);
    // convert internal URI to public URL. Drupal doens't provide public url by default.
    // This step doesn't create a file, just create a link
    // Get the image style public url
    $r[$k]['thumbnail'] = image_style_url('thumbnail', $v['uri']);
    // It creates an image styled link in db, when requesting the public url, the image will be created
  }
}
</pre>
</div>
</div>

<div id="outline-container-org852e931" class="outline-4">
<h4 id="org852e931"><span class="section-number-4">2.29.3</span> Get File URI from db <a href="#org31d1761">d7:db:file uri</a></h4>
</div>
</div>
<div id="outline-container-orga1b8e7c" class="outline-3">
<h3 id="orga1b8e7c"><span class="section-number-3">2.30</span> Basic Ajax</h3>
<div class="outline-text-3" id="text-2-30">
<pre class="example">
// Create a menu to receive ajax
$items['newsletter/builder_entry/%'] = array(
    'title' =&gt; "",
    'page callback' =&gt; '_lili_add_session_handler',
    'page arguments' =&gt; array(2),
    'access callback' =&gt; 'user_access',
    'access arguments' =&gt; array('newsletter builder access'),
    'type' =&gt; MENU_CALLBACK,
);

function _lili_add_session_handler($command) {
if (!isset($_POST['ids'])) {
    return drupal_not_found();
  }

  if ($command === "manage") {
    // Add to the session variable detailing what items are added
    $_SESSION['session_name'] = array();

    $ids = json_decode($_POST['ids']);
    foreach ($ids as $id) {
      $id = trim($id);
      $_SESSION['session_name']["item_" . $id] = $id;
    }
  }
  else {
    return drupal_not_found();
  }
}

// Javascript
$.ajax({
 type: "POST",
 url: '?q=newsletter/builder_entry/manage',
 data: "ids=" + 'some string',
 success: function(e) {
   // do something
 },
 dataType: "json"
});
</pre>
</div>
</div>

<div id="outline-container-org8edd429" class="outline-3">
<h3 id="org8edd429"><span class="section-number-3">2.31</span> Javascript API</h3>
<div class="outline-text-3" id="text-2-31">
<p>
<a href="https://www.drupal.org/docs/7/api/javascript-api/javascript-api-overview">Javascript API Overview</a>
</p>

<p>
{
 'settings': {},
 'behaviors': {},
 'themes': {},
 'locale': {}
}
</p>
</div>

<div id="outline-container-org9120d09" class="outline-4">
<h4 id="org9120d09"><span class="section-number-4">2.31.1</span> Settings</h4>
<div class="outline-text-4" id="text-2-31-1">
<p>
Pass PHP variable to javascript
</p>

<p>
PHP. Use camelCasing.
</p>
<pre class="example">
$my_settings = array(
  'basePath' =&gt; $base_path,
  'animationEffect' =&gt; variable_get('effect', 'none')
);
drupal_add_js(array('myModule'=&gt;$my_settings), 'setting');
</pre>

<p>
Javascript
</p>
<pre class="example">
var basePath = Drupal.settings.myModule.basePath;
var effect = Drupal.settings.myModule.animationEffect;
</pre>
</div>
</div>

<div id="outline-container-orgb0eb6b7" class="outline-4">
<h4 id="orgb0eb6b7"><span class="section-number-4">2.31.2</span> Behaviors</h4>
<div class="outline-text-4" id="text-2-31-2">
<p>
<a href="https://www.lullabot.com/articles/understanding-javascript-behaviors-in-drupal">https://www.lullabot.com/articles/understanding-javascript-behaviors-in-drupal</a>
<a href="https://www.amazeelabs.com/en/blog/drupal-behaviors-quick-how">https://www.amazeelabs.com/en/blog/drupal-behaviors-quick-how</a>
<a href="https://www.drupal.org/node/756722">https://www.drupal.org/node/756722</a>
</p>

<p>
Any property defined in Drupal.behaviors will get called when DOM is ready or when Drupal.attachBehaviors() runs.
Drupal.attachBehaviors(); means attach all behaviors. When DOM is ready, Drupal runs:
</p>

<pre class="example">
// Attach all behaviors.
$(function () {
  Drupal.attachBehaviors(document, Drupal.settings);
});

// Syntax: Drupal.attachBehanviors(context, settings);
// When context is not defined, it's the document object in javascript
// when settings is not defined, Drupal.settings is used
// So Drupal.attachBehaviors(); is the same as Drupal.attachBehaviors(document, Drupal.settings);
</pre>

<p>
Other modules might run multiple Drupal.attachBehaviors(); or Drupal.attachBehaviors(custom_context, custom_settings);
</p>

<p>
All properties defined in Drupal.behaviors will get called when Drupa.attachBehaviors(&#x2026;, &#x2026;); runs! Some common situations:
</p>

<ul class="org-ul">
<li>After an admin overlay has been loaded into the page.</li>
<li>After AJAX Form API has submitted a form</li>
<li>When an AJAX request returns a command that modifies HTML, such as ajax_command_replace()</li>
<li>CTools calls it after a modal has been loaded</li>
<li>Media calls it after media browser has been loaded</li>
<li>Panels calls it after in-place editing has been completed</li>
<li>Views calls it after loading a new page that uses AJAX</li>
<li>Views Load More calls it after loading the next chunk of items</li>
<li>Javascript from custom modules may call Drupal.attahcBehaviors() when they add or change parts of the page.
<ul class="org-ul">
<li>Such as drupal_add_js('jQuery(document).ready(function () { Drupal.attachBehaviors(); });', 'inline');</li>
</ul></li>
</ul>

<p>
So you need to attach any event once using $('',context).once() !
</p>

<p>
This is mymod_path/js/drupal.behaviors.js
</p>
<pre class="example">
(function ($) {
  Drupal.behaviors.MODULENAME = {
    attach: function (context, settings) {
      console.log('This runs every time Drupal.attachBehaviors(); is called');
      // Run something only once (e.g. set jQuery event)
      $('.nav-flyout', context).once('remove-modals', function () {
        // After this is run, all elements selected will have a new class 'remove-modals-processed'
        $(document).keyup(function (e) {
          if (e.keyCode == 27) {
            $('.nav-flyout', context).removeClass('js-flyout-active');
          }
        });
      });
    }
  }
}(jQuery));
</pre>

<p>
In Drupal
</p>
<pre class="example">
function hook_preprocess_page(&amp;$vars) {
  // Append a property in Drupal.settings only. And before a behavior is attached and it will be run e.g. when DOM is ready
  drupal_add_js(array('MODULENAME' =&gt; array('php_var_1' =&gt; variable_get('php_var_1', ''))), 'setting');
  drupal_add_js(drupal_get_path('module', 'MODULENAME') . '/js/drupal.behaviors.js');
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org6293cbb" class="outline-3">
<h3 id="org6293cbb"><span class="section-number-3">2.32</span> Email</h3>
<div class="outline-text-3" id="text-2-32">
<p>
Define an email template using hook_mail()
</p>
<pre class="example">
function lili_mail($key, &amp;$message, $params) {
 // Need to overwrite headers content type if email is html
 $message['headers']['Content-Type'] = 'text/html; charset=UTF-8; format=flowed';

 // $message['from'] is initially set by $from from drupal_mail(). 
 // If not provided, will use sidewide setting
 // $message['to'] and 'language' are set by $to from drupal_mail().

 switch ($key) {
  case 'template_1':
    // Use $params
    $message['subject'] = 'This is subject';
    $message['body'][] = 'Extra';
    $message['headers']['Bcc'] = 'bcc@abc.com';
    break;
 } 
}

// Send email
$module = 'lili'; // module name that the template is defined hook_mail
$to = 'to@abc.com';
$from = 'from@abc.com'; // Default Null
$language = language_default();
$send = TRUE; // Default TRUE 
$params = array(); // Extra params to pass to hook_mail() as $params
// hook_mail_alter can change to false so that it doesn't get sent out
$result = drupal_mail($module, 'template_1', $to, $language, $params, $from, $send);
/*
$result =&gt; array(
 'result' =&gt; NULL (cancelled by hook_mail_alter())
            or $system-&gt;mail($message) (!$result['result'] is true means fail)
)
*/
</pre>
</div>
</div>

<div id="outline-container-org72fea26" class="outline-3">
<h3 id="org72fea26"><span class="section-number-3">2.33</span> OOP</h3>
<div class="outline-text-3" id="text-2-33">
<p>
D7 refers to <a href="https://www.drupal.org/project/oop_examples">oop_examples module</a>.
</p>

<p>
One quick way to include a class is to put the class inside any file e.g. $moddir/lib/reader.inc
And include when it's needed using module_load_include('inc', 'modename', 'lib/reader');
</p>
</div>
</div>
</div>

<div id="outline-container-org8c66b27" class="outline-2">
<h2 id="org8c66b27"><span class="section-number-2">3</span> WordPress</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orge4e0a60" class="outline-3">
<h3 id="orge4e0a60"><span class="section-number-3">3.1</span> Core Update</h3>
<div class="outline-text-3" id="text-3-1">
<p>
<a href="https://codex.wordpress.org/WordPress_Versions">https://codex.wordpress.org/WordPress_Versions</a>
</p>

<p>
<a href="https://codex.wordpress.org/Configuring_Automatic_Background_Updates">https://codex.wordpress.org/Configuring_Automatic_Background_Updates</a>
</p>

<dl class="org-dl">
<dt>Look version in files</dt><dd><code>wp-includes/version.php</code> or <code>readme.html</code></dd>
</dl>

<p>
<code>wp-includes/version.php</code> also has
</p>
<ul class="org-ul">
<li>wp db version</li>
<li>required php version</li>
<li>required mysql version</li>
<li>local package (language)</li>
<li>tinymce version</li>

<li id="Enable auto core update in wp-config.php"><code>define( 'WP_AUTO_UPDATE_CORE', true );</code>
<ul class="org-ul">
<li>Value of true – Development, minor, and major updates are all enabled</li>
<li>Value of false – Development, minor, and major updates are all disabled</li>
<li>Value of 'minor' – Minor updates are enabled, development, and major updates are disabled</li>
</ul></li>
</ul>

<p>
Fine tune
</p>
<div class="org-src-container">
<pre class="src src-php">add_filter( <span style="color: #e67128;">'allow_dev_auto_core_updates'</span>, <span style="color: #e67128;">'__return_true'</span> );           <span style="color: #74af68;">// </span><span style="color: #74af68;">Enable development updates </span>
add_filter( <span style="color: #e67128;">'allow_minor_auto_core_updates'</span>, <span style="color: #e67128;">'__return_true'</span> );         <span style="color: #74af68;">// </span><span style="color: #74af68;">Enable minor updates</span>
add_filter( <span style="color: #e67128;">'allow_major_auto_core_updates'</span>, <span style="color: #e67128;">'__return_true'</span> );         <span style="color: #74af68;">// </span><span style="color: #74af68;">Enable major updates</span>
</pre>
</div>
</div>

<div id="outline-container-orgcad6f5d" class="outline-4">
<h4 id="orgcad6f5d"><span class="section-number-4">3.1.1</span> Manual Update Core</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
<a href="https://codex.wordpress.org/Upgrading_WordPress">https://codex.wordpress.org/Upgrading_WordPress</a>
<a href="https://codex.wordpress.org/Upgrading_WordPress_Extended">https://codex.wordpress.org/Upgrading_WordPress_Extended</a>
</p>
<ul class="org-ul">
<li>Backup</li>
<li>Disable all plugins</li>
<li>Delete old wp-includes and wp-admin and replace with new ones</li>
<li>Go to new wp-content and copy and replace existing files and directories</li>
<li>Replace files at root directory</li>
<li>Visit /wp-admin and it will give you a link</li>
<li><a href="http://example.com/wp-admin/upgrade.php">http://example.com/wp-admin/upgrade.php</a></li>
<li>Update Permalinks and .htaccess from wp-admin UI</li>
<li>Install updated Plugins and Themes</li>
<li>Reactivate plugins</li>
</ul>
</div>
</div>

<div id="outline-container-org4d5c6ba" class="outline-4">
<h4 id="org4d5c6ba"><span class="section-number-4">3.1.2</span> Release</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
See if wp-config.php .htaccess files are modified
3.8.6 &gt; 4.5.10 &gt; (db) 4.9.1 &gt; 4.9.4
</p>
</div>
</div>

<div id="outline-container-org841492a" class="outline-4">
<h4 id="org841492a"><span class="section-number-4">3.1.3</span> TS: update-core.php blank</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
Add this to disable WP to check FTP
</p>
<pre class="example">
define('FS_METHOD', 'direct');
</pre>
<p>
Refer to <a href="#org1635023">wp:ftp</a> <a href="https://stackoverflow.com/questions/28598547/wordpress-core-update-fail-4-1-to-4-1-1">https://stackoverflow.com/questions/28598547/wordpress-core-update-fail-4-1-to-4-1-1</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orga1483e4" class="outline-3">
<h3 id="orga1483e4"><span class="section-number-3">3.2</span> Migrate database</h3>
<div class="outline-text-3" id="text-3-2">
<p>
At your previous host, access phpMyAdmin.
Load your WordPress database by clicking the database name in the left hand menu pane.
Click the "export" tab at the top right.
Under "export, highlight all the tables and select "SQL". These are the default settings.
Under "options" make sure that "add DROP TABLE/ VIEW/ PROCEDURE/ FUNCTION" is selected.
Ensure that "Save as File" towards the bottom of the page is selected.
Click Go
</p>

<p>
For import, just hit Import tab and import. Watch out for the timeout limit.
</p>

<p>
Change website url
Open wp_options table, change siteurl to <a href="http://yourwebsite.com">http://yourwebsite.com</a>
</p>

<p>
Do it on code level
</p>
<pre class="example">
define('WP_HOME','http://'.$_SERVER[HTTP_HOST].'/');
define('WP_SITEURL','http://'.$_SERVER[HTTP_HOST].'/');
</pre>

<p>
Go to wp-admin &gt; Settings &gt; Permalink and save to update the permalink
</p>
</div>
</div>

<div id="outline-container-org493c062" class="outline-3">
<h3 id="org493c062"><span class="section-number-3">3.3</span> Redirect a path a Wordpress website <a id="org3bca9eb">wp:redirect path to wp</a></h3>
<div class="outline-text-3" id="text-3-3">
<p>
abc.com/enterprise to another Wordpress website abc.com
DB is abc_enterprise and abc
</p>

<p>
abc.com is inside a docker container using apache2
</p>

<p>
abc.com uses Nginx and initial setup is
</p>
<pre class="example">
server {
   listen 80;
   server_name abc.com www.abc.com;

   location / {
      proxy_set_header   X-Real-IP   $remote_addr;
      proxy_set_header   Host        $http_host;
      proxy_pass         http://127.0.0.1:9977;
   }

}
</pre>
</div>

<div id="outline-container-org07b2c1c" class="outline-4">
<h4 id="org07b2c1c"><span class="section-number-4">3.3.1</span> Method 1: Apache</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
Directly create or copy a sub directory under abc.com root
/var/www/html/enterprise
</p>

<p>
Create a new database called abc_enterprise and import the db
/var/www/html/enterprise/wp-config.php
</p>

<p>
If the enterprise site is a complete new wp installation, you don't need to do this
</p>
<pre class="example">
define( 'WP_HOME', '/enterprise' );
define( 'WP_SITEURL', '/enterprise' );

// for localhost
// define('WP_HOME','http://'.$_SERVER[HTTP_HOST].'/enterprise');
// define('WP_SITEURL','http://'.$_SERVER[HTTP_HOST].'/enterprise');

// Change the db setting
define('DB_NAME', 'abc_enterprise');
</pre>

<p>
<i>var/www/html/enterprise</i>.htaccess
</p>
<pre class="example">
# BEGIN WordPress
&lt;IfModule mod_rewrite.c&gt;
RewriteEngine On
RewriteBase /enterprise/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /enterprise/index.php [L]
&lt;/IfModule&gt;

# END WordPress
</pre>

<p>
Then go to wp-admin and save the permalink
</p>

<p>
abc.com/enterprise/abc has $_SERVER['REQUEST_URI'] appear as <code>/abc</code> on /var/www/html/enterprise/index.php
</p>

<ul class="org-ul">
<li>Redirect abc.com/xyz to abc.com/enterprise/ijk use <i>var/www/html</i>.htaccess</li>
</ul>
<pre class="example">
RedirectMatch 302 ^/psup/?$ /enterprise/ijk/
</pre>

<ul class="org-ul">
<li>Rewrite abc.com/ijk to abc.com/enterprise/real-page so that URL remains abc.com/ijk in address bar</li>
</ul>
<p>
use <i>var/www/html</i>.htaccess
</p>
<pre class="example">
&lt;IfModule mod_rewrite.c&gt;
RewriteEngine On
RewriteBase /
RewriteRule ^ijk/?(.*)$ /enterprise/ijk [L]
&lt;/IfModule&gt;
</pre>

<p>
Then in /var/www/html/enterprise/wp-content/themes/your-theme/functions.php
</p>

<p>
NOTE: $_SERVER['REQUEST_URI'] is /ijk in ./enterprise/index.php
</p>
<pre class="example">
function cs_rewrite_request($query){

  $request_uri = urldecode($_SERVER['REQUEST_URI']);
  //var_dump($request_uri);
  /* for pages */
  if( 0 === strpos($request_uri, '/ijk') ){
    $query['pagename'] = urlencode('real-page');
    unset($query['name']);
  }

  return $query;
}
add_filter( 'request', 'cs_rewrite_request', 9999, 1 );
</pre>

<p>
If you want abc.com/enterprise/real-page to redirect to abc.com/ijk which shows the real-page
<i>var/www/html</i>.htaccess
</p>
<pre class="example">
RedirectMatch 302 ^/enterprise/real-page/?$ /ijk/
</pre>

<p>
Fix image urls
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #ffad29; font-weight: bold;">UPDATE</span> wp_posts <span style="color: #ffad29; font-weight: bold;">SET</span> post_content=(REPLACE (post_content, <span style="color: #e67128;">'&lt;old url&gt;'</span>,<span style="color: #e67128;">'&lt;new url&gt;'</span>));
<span style="color: #ffad29; font-weight: bold;">UPDATE</span> wp_posts <span style="color: #ffad29; font-weight: bold;">SET</span> post_content=(REPLACE (post_content, <span style="color: #e67128;">'abc-ent-dev.com'</span>,<span style="color: #e67128;">'abc.com/enterprise'</span>));
</pre>
</div>
</div>
</div>

<div id="outline-container-org7d4d12e" class="outline-4">
<h4 id="org7d4d12e"><span class="section-number-4">3.3.2</span> Method 2: (Not working..) Nginx proxy to another</h4>
<div class="outline-text-4" id="text-3-3-2">
<p>
Refer to <a href="#orgf3adc36">nginx:redirect path to proxy</a>
</p>

<p>
abc.com Nginx becomes
</p>
<pre class="example">
server {
   listen 80;
   server_name alectraconservation.com www.alectraconservation.com;

   location ^~ /enterprise/ {
     proxy_set_header   X-Real-IP   $remote_addr;
     proxy_set_header   Host        $http_host;
     proxy_pass http://127.0.0.1:8787/;
   }

    location / {
      proxy_set_header   X-Real-IP   $remote_addr;
      proxy_set_header   Host        $http_host;
      proxy_pass         http://127.0.0.1:9977;
   }

}
</pre>

<p>
Refer to <a href="http://www.ur-ban.com/2015/07/27/nginx-proxy_pass-wordpress-in-a-sub-directory/">http://www.ur-ban.com/2015/07/27/nginx-proxy_pass-wordpress-in-a-sub-directory/</a>
Change WP_HOME and WP_SITEURL
</p>
<pre class="example">
$_SERVER['REQUEST_URI'] = str_replace("/wp-admin/", "/enterprise/wp-admin/",  $_SERVER['REQUEST_URI']);
define( 'WP_SITEURL', '/enterprise' );
define( 'WP_HOME', '/enterprise' );
</pre>
</div>
</div>
</div>

<div id="outline-container-org36568a8" class="outline-3">
<h3 id="org36568a8"><span class="section-number-3">3.4</span> Load WP Core in sub directory under same domain</h3>
<div class="outline-text-3" id="text-3-4">
<p>
sub directory has a customized PHP application and it needs to use WP Core to determine if a user is logged in
</p>

<p>
<a href="https://www.webhostinghero.com/wordpress-authentication-integration-with-php/">https://www.webhostinghero.com/wordpress-authentication-integration-with-php/</a>
<a href="http://dovy.io/wordpress/authenticating-outside-of-wordpress-on-diff-domain/">http://dovy.io/wordpress/authenticating-outside-of-wordpress-on-diff-domain/</a>
</p>

<p>
subfolder/index.php
</p>
<pre class="example">
define( 'WP_USE_THEMES', false ); // NOT load the theme at all or any of that content.
define( 'COOKIE_DOMAIN', false ); // NOT verify the cookie domain. We just want to take the cookie as it is.
define( 'DISABLE_WP_CRON', true ); // Optional

// load less core files. Good for wp REST API request. e.g. global $wp, $wp_query, $wp_the_query are set to NULL
// define( 'SHORTINIT', TRUE );

// if(!session_id()) session_start(); // I find this not necessary

require_once(__DIR__ . "/../wp-load.php");
// You will find some errors, fix errors in your custom themes and plugins
// clear cache and try again

// see wp:user
</pre>
</div>
</div>

<div id="outline-container-org5747bb5" class="outline-3">
<h3 id="org5747bb5"><span class="section-number-3">3.5</span> Global Variables</h3>
<div class="outline-text-3" id="text-3-5">
<p>
<a href="https://codex.wordpress.org/Global_Variables">https://codex.wordpress.org/Global_Variables</a>
</p>

<pre class="example">
global $wp_version;
if ( version_compare( $GLOBALS['wp_version'], '4.7-alpha', '&lt;' ) ) {
        require get_template_directory() . '/inc/back-compat.php';
        return;
}
</pre>
</div>

<div id="outline-container-org9e4ae6e" class="outline-4">
<h4 id="org9e4ae6e"><span class="section-number-4">3.5.1</span> $_GET, $_POST, $_COOKIE, $_SERVER</h4>
<div class="outline-text-4" id="text-3-5-1">
<p>
WP first detects if <a href="http://php.net/manual/en/security.magicquotes.php">Magic Quotes</a>, if so, remove them using stripslashes_deep (wp function) and then add slashes using add_magic_quotes which uses php:addslashes function. In order to get values, use stripslashes_deep again.
</p>
<pre class="example">
$value = stripslashes_deep($_POST['name']);
// or simply
$myPost = stripslashes_deep($_POST);

// in custom PHP app, detect if WP already defines the function and later remove the slashes
 $myPost = $_POST;
if (function_exists('stripslashes_deep')) {
  // This means WP has already added slashes to $_POST. Remove slashes
  $myPost = stripslashes_deep($myPost);
}
</pre>
</div>
</div>

<div id="outline-container-orgc138238" class="outline-4">
<h4 id="orgc138238"><span class="section-number-4">3.5.2</span> $post <a id="orge8bb12f">wp:global:post</a></h4>
<div class="outline-text-4" id="text-3-5-2">
<p>
<a href="https://codex.wordpress.org/Class_Reference/WP_Post">https://codex.wordpress.org/Class_Reference/WP_Post</a>
</p>

<pre class="example">
global $post;
$post_slug=$post-&gt;post_name;
</pre>
</div>
</div>

<div id="outline-container-org5c9470c" class="outline-4">
<h4 id="org5c9470c"><span class="section-number-4">3.5.3</span> $wpdb <a id="orga002216">wp:global:wpdb</a></h4>
<div class="outline-text-4" id="text-3-5-3">
<p>
If wp-content/db.php exists and creates an instance of global $wpdb, $wpdb will be defined as in this custom file.
<a href="#org24854a2">wp:plugin:w3-total-cache</a>
</p>

<p>
If wp core doesn't support msql_connect but mysqli and the environment doesn't have msql extension (since PHP 7.0), then you can replace wp-includes/wp-db.php with the latest wp version without upgrading wp core. Although upgrading wp core is recommended.
</p>
</div>
</div>
</div>

<div id="outline-container-org65f8e90" class="outline-3">
<h3 id="org65f8e90"><span class="section-number-3">3.6</span> wp-config.php</h3>
<div class="outline-text-3" id="text-3-6">
<p>
<a href="https://codex.wordpress.org/Editing_wp-config.php">https://codex.wordpress.org/Editing_wp-config.php</a>
</p>
</div>

<div id="outline-container-org2a7daaf" class="outline-4">
<h4 id="org2a7daaf"><span class="section-number-4">3.6.1</span> <a id="orgfcb47c7">wp:wp-config:DISALLOW_FILE_EDIT</a></h4>
<div class="outline-text-4" id="text-3-6-1">
<p>
define( 'DISALLOW_FILE_EDIT', true );
</p>
</div>
</div>
</div>

<div id="outline-container-orgdb0f92b" class="outline-3">
<h3 id="orgdb0f92b"><span class="section-number-3">3.7</span> Email PHPMailer</h3>
<div class="outline-text-3" id="text-3-7">
<p>
Add this after <code>require_once(ABSPATH . 'wp-settings.php');</code> in wp-config.php
This way you don't need to have <a href="#org1ca1f0d">linux:sendmail</a> installed on Linux
</p>

<p>
<a href="https://codex.wordpress.org/Plugin_API/Action_Reference/phpmailer_init">Doc</a>
</p>

<pre class="example">
// configure phpmailer
add_action( 'phpmailer_init', 'mail_relay' );
function mail_relay( $phpmailer ) {
    $phpmailer-&gt;isSMTP();
    $phpmailer-&gt;Host = 'smtp.gmail.com';
    $phpmailer-&gt;SMTPAutoTLS = true;
    $phpmailer-&gt;SMTPAuth = true; 
    $phpmailer-&gt;Port = 465;
    $phpmailer-&gt;Username = '&lt;admin email&gt;';
    $phpmailer-&gt;Password = '&lt;app password&gt;';

    // Additional settings
    $phpmailer-&gt;SMTPSecure = "ssl"; 
    $phpmailer-&gt;From = "&lt;admin email&gt;";
    $phpmailer-&gt;FromName = "&lt;your name&gt;";
}
// configure phpmailer.
</pre>

<p>
Without bootstrap wp, assuming test.php file is at root
</p>
<pre class="example">
&lt;?php
error_reporting(E_ALL);
ini_set('display_errors', 1);

echo 'hello';

// PHPMailer Gmail Example
// https://github.com/PHPMailer/PHPMailer/blob/master/examples/gmail.phps

$recipient_email = 'a@b.com';
$recipient_name = 'First Last';
$sender_name = 'Sender Name';
$subject = 'Testing';
$html = ('
    &lt;html&gt;
    &lt;head&gt;
      &lt;title&gt;This is a test&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
      &lt;h1&gt;Testing headline&lt;/h1&gt; 
      &lt;p&gt;Testing body content&lt;/p&gt;
    &lt;/body&gt;
    &lt;/html&gt;
  ');
$text = 'pure text testing';

// php's native mail
// mail($recipient_email, $subject, $text);

require("wp-includes/class-phpmailer.php");
$mail = new PHPMailer();

$mail-&gt;isSMTP(); // Set mailer to use SMTP
//Enable SMTP debugging
// 0 = off (for production use)
// 1 = client messages
// 2 = client and server messages
$mail-&gt;SMTPDebug = 2;

$mail-&gt;Host = 'smtp.gmail.com';
// use
// $mail-&gt;Host = gethostbyname('smtp.gmail.com');
// if your network does not support SMTP over IPv6

$mail-&gt;SMTPAuth = true; // set to false if Username, Password, SMTPSecure are empty
$mail-&gt;Username = 'username@gmail.com';
$mail-&gt;Password = 'password';
$mail-&gt;SMTPSecure = 'tls'; // Enable TLS encryption, `ssl` also accepted

$mail-&gt;Port = 587; // 587 for tls

$mail-&gt;CharSet = 'UTF-8';

$mail-&gt;SetFrom('donotreply@b.com', $sender_name);

$mail-&gt;AddAddress($recipient_email, $recipient_name);

$mail-&gt;Subject = $subject;

//$mail-&gt;addReplyTo('replyto@example.com', 'First Last');

//Replace the plain text body with one created manually
// $mail-&gt;AltBody = 'This is a plain-text message body';

//Attach an image file
//$mail-&gt;addAttachment('images/phpmailer_mini.png');

$mail-&gt;MsgHTML($html);

if (!$mail-&gt;Send()) {
  echo "Mailer Error: " . $mail-&gt;ErrorInfo;
}
else {
  echo "successful!";
}
</pre>
</div>
</div>

<div id="outline-container-org830cccb" class="outline-3">
<h3 id="org830cccb"><span class="section-number-3">3.8</span> PHP redirect <a id="orga610319">wp:php:redirect</a></h3>
<div class="outline-text-3" id="text-3-8">
<p>
<a href="https://rudrastyh.com/wordpress/change-specific-urls.html">https://rudrastyh.com/wordpress/change-specific-urls.html</a>
Use functions.php to achieve
</p>

<p>
Redirect, same can be achieved using .htaccess
</p>
<pre class="example">
function rudr_url_redirects() {
        /* in this array: old URLs=&gt;new URLs  */
        $redirect_rules = array(
                array('old'=&gt;'/category/uncategorized/','new'=&gt;'/category/Uncategorized/'), // category
                array('old'=&gt;'/contacts/','new'=&gt;'/Contacts/'), // page
                array('old'=&gt;'/hello-world/','new'=&gt;'/hello-planet/'), // post
                array('old'=&gt;'/tag/wordpress/','new'=&gt;'/tag/WordPress/') // post tag
        );
        foreach( $redirect_rules as $rule ) :
                // if URL of request matches with the one from the array, then redirect
                if( urldecode($_SERVER['REQUEST_URI']) == $rule['old'] ) :
                        wp_redirect( site_url( $rule['new'] ), 301 );
                        exit();
                endif;
        endforeach;
}

add_action('template_redirect', 'rudr_url_redirects');
</pre>

<p>
Redirect by changing request based on the $_SERVER['REQUEST_URI']
</p>
<pre class="example">
function rudr_rewrite_request($query){

        $request_uri = urldecode($_SERVER['REQUEST_URI']);

        /* for categories */
        if ( $request_uri == '/category/Uncategorized/' )
                $query['category_name'] = 'uncategorized';

        /* for pages */
        if ( $request_uri == '/Contacts/' ){
                $query['pagename'] = urlencode('contacts');
                unset($query['name']);
        }

        /* for posts */
        if ( $request_uri == '/hello-planet/' )
                $query['name'] = 'hello-world';

        /* for tags */
        if( $request_uri == '/tag/WordPress/' )
                $query['tag'] = 'wordpress';

        return $query;
}

add_filter( 'request', 'rudr_rewrite_request', 9999, 1 );
</pre>

<p>
Change permalink
For posts and pages
</p>
<pre class="example">
function rudr_post_permalink( $url, $post ){
        if( !is_object( $post ) )
                $post = get_post( $post_id );

        $replace = $post-&gt;post_name;

        /* We should use a post ID to make a replacement. It is required if you use urf-8 characters in your URLs */

        if( $post-&gt;ID == 1 ) 
                $replace = 'hello-planet';
        if( $post-&gt;ID == 12 ) 
                $replace = 'Contacts';

        $url = str_replace($post-&gt;post_name, $replace, $url );
        return $url;
}

add_filter( 'post_link', 'rudr_post_permalink', 'edit_files', 2 );
add_filter( 'page_link', 'rudr_post_permalink', 'edit_files', 2 );
add_filter( 'post_type_link', 'rudr_post_permalink', 'edit_files', 2 );
</pre>

<p>
For categories and tags
</p>
<pre class="example">
function rudr_term_permalink( $url, $term, $taxonomy ){
        $replace = $term-&gt;slug;

        /* by ID as well */
        if( $term-&gt;term_id == 5 ) 
                $replace = 'Uncategorized';
        if( $term-&gt;term_id == 55 ) 
                $replace = 'WordPress';

        $url = str_replace($term-&gt;slug, $replace, $url );

        return $url;
}

add_filter( 'term_link', 'rudr_term_permalink', 10, 3 );
</pre>
</div>
</div>

<div id="outline-container-org5ff9f70" class="outline-3">
<h3 id="org5ff9f70"><span class="section-number-3">3.9</span> <a href="#org8496abc">WP-CLI</a> <a id="org8496abc">wp-cli</a></h3>
<div class="outline-text-3" id="text-3-9">
<p>
<a href="https://wp-cli.org/commands">Wordpress CLI Commands</a>
<a href="#org41e2f94">WP CLI Pantheon</a>
</p>

<p>
<a href="https://github.com/wp-cli/wp-cli/releases">https://github.com/wp-cli/wp-cli/releases</a>
</p>
</div>

<div id="outline-container-org46e23cb" class="outline-4">
<h4 id="org46e23cb"><span class="section-number-4">3.9.1</span> WP CLI Install, Upgrade</h4>
<div class="outline-text-4" id="text-3-9-1">
<pre class="example">
# Assuming you are at ~ folder
curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar
# Check phar
php wp-cli.phar --info
chmod +x wp-cli.phar

# GoDaddy Shared Hosting doesn't allow sudo. Ignore this for GoDaddy
# sudo mv wp-cli.phar /usr/local/bin/wp
alias wp='~/wp-cli.phar'
echo "alias wp='~/wp-cli.phar'" &gt;&gt; .bashrc
source .bashrc
</pre>

<p>
Set Global parameters in <a href="#org8496abc">wp-cli</a>.yml under WordPress root folder <a href="http://wp-cli.org/config/">http://wp-cli.org/config/</a>
</p>
<ul class="org-ul">
<li><a href="#org8496abc">wp-cli</a>.local.yml or <a href="#org8496abc">wp-cli</a>.yml in WordPress website folder</li>
<li>~/.<a href="#org8496abc">wp-cli</a>/config.yml</li>
</ul>

<p>
Use &#x2013; in front for wp command
</p>
<pre class="example">
# Very important. To avoid error: $_SERVER['HTTP_HOST'] 
url: http://www.yourwebsite.com
</pre>

<p>
Use &#x2013;skip-plugins to avoid errors while loading plugins that cause this kind of error
Fatal error: Uncaught Error: Call to a member function xxx on null
</p>

<p>
Check <a href="#org8496abc">wp-cli</a> installation
<code>wp --info</code>, <code>wp plugin list --debug</code> or <code>wp plugin list --skip-plugins --debug</code>
</p>

<p>
If you see this error, time to upgrade WP CLI
Fatal error: Class 'WP_Post_Type' not found in /Applications/MAMP/htdocs/wp-includes/post.php on line 1031
</p>

<p>
<code>sudo wp cli update</code>
</p>
</div>
</div>

<div id="outline-container-org89397f4" class="outline-4">
<h4 id="org89397f4"><span class="section-number-4">3.9.2</span> Global Parameters</h4>
<div class="outline-text-4" id="text-3-9-2">
<ul class="org-ul">
<li>&#x2013;debug</li>
<li>&#x2013;quiet</li>
<li>&#x2013;user=&lt;id|login|email&gt;</li>
<li id="&#x2013;require=&lt;path&gt;">Load PHP file, can be used multiple times</li>
</ul>
</div>
</div>

<div id="outline-container-org43a9b59" class="outline-4">
<h4 id="org43a9b59"><span class="section-number-4">3.9.3</span> User</h4>
<div class="outline-text-4" id="text-3-9-3">
<pre class="example">
# List users
terminus wp 'user list' --site=&lt;site&gt; --env=&lt;env&gt;=

wp user list

# Add a user
wp user create lili li@xxx.ca --user_pass='letterandnumbers' --role=administrator

# Update password
wp user update lili --user_pass='lettersandnumbers'

# Give role
wp user add-role lili administrator
</pre>

<pre class="example">
UPDATE wp_users SET user_pass=MD5('yourpassword') WHERE ID=2;

# Then login through wp-admin and the user_pass field will be updated to SHA-1 after a successful login of that user.
</pre>
</div>
</div>

<div id="outline-container-orge4cf021" class="outline-4">
<h4 id="orge4cf021"><span class="section-number-4">3.9.4</span> Core</h4>
<div class="outline-text-4" id="text-3-9-4">
<p>
wp core version
wp core update
</p>
</div>
</div>

<div id="outline-container-orged56414" class="outline-4">
<h4 id="orged56414"><span class="section-number-4">3.9.5</span> Plugin</h4>
<div class="outline-text-4" id="text-3-9-5">
<p>
<a href="https://wordpress.org/plugins">Wordpress Official Plugin Directory</a>
</p>

<p>
wp plugin install <a href="#org264c07b">fly-dynamic-image-resizer</a>
</p>

<p>
Options
</p>
<dl class="org-dl">
<dt>&#x2013;activate</dt><dd>activate after installation</dd>
</dl>

<pre class="example">
# List installed plugins
wp plugin list

wp plugin status
wp plugin update akismet
wp plugin activate plugin_name
wp plugin uninstall Plugin_name

</pre>
</div>
</div>

<div id="outline-container-orga3d74cc" class="outline-4">
<h4 id="orga3d74cc"><span class="section-number-4">3.9.6</span> CLI Package</h4>
<div class="outline-text-4" id="text-3-9-6">
<p>
<a href="http://wp-cli.org/package-index/">All packages</a>
</p>

<pre class="example">
# List installed packages
wp package list

# Install a package
wp package install aaemnnosttv/wp-cli-login-command
</pre>
</div>
</div>

<div id="outline-container-orgc8f0e00" class="outline-4">
<h4 id="orgc8f0e00"><span class="section-number-4">3.9.7</span> Theme</h4>
<div class="outline-text-4" id="text-3-9-7">
<p>
wp theme status
</p>
</div>
</div>

<div id="outline-container-orgf030fb5" class="outline-4">
<h4 id="orgf030fb5"><span class="section-number-4">3.9.8</span> login</h4>
<div class="outline-text-4" id="text-3-9-8">
<p>
<a href="https://github.com/aaemnnosttv/wp-cli-login-command">GitHub</a>
</p>

<dl class="org-dl">
<dt>user</dt><dd>can be a User ID, username/login or email address.</dd>
</dl>

<pre class="example">
wp package install aaemnnosttv/wp-cli-login-command

# find a user
wp user list

# create a temp login url for a user
wp login create &lt;user&gt; [options]

# Will ask you to install a plugin which contain only one .php file
wp login install --activate --allow-root

# run create again

# Make all exisiting magic links to fail
wp login invalidate

# Deactivate the plugin
wp login toggle off --allow-root
</pre>

<p>
Options
</p>
<dl class="org-dl">
<dt>&#x2013;expires=&lt;seconds&gt;</dt><dd>default 900 (15 minutes)</dd>
</dl>
</div>
</div>

<div id="outline-container-org3555a46" class="outline-4">
<h4 id="org3555a46"><span class="section-number-4">3.9.9</span> db check</h4>
</div>
<div id="outline-container-orgf7b0f3f" class="outline-4">
<h4 id="orgf7b0f3f"><span class="section-number-4">3.9.10</span> db search</h4>
<div class="outline-text-4" id="text-3-9-10">
<p>
<a href="https://developer.wordpress.org/cli/commands/db/search/">https://developer.wordpress.org/cli/commands/db/search/</a>
</p>
<div class="org-src-container">
<pre class="src src-bash">wp db search <span style="color: #e67128;">'your search string'</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">regex</span>
wp db search <span style="color: #e67128;">'https?://'</span> --regex --stats
</pre>
</div>
</div>
</div>

<div id="outline-container-org8eae8de" class="outline-4">
<h4 id="org8eae8de"><span class="section-number-4">3.9.11</span> db export</h4>
<div class="outline-text-4" id="text-3-9-11">
<p>
<a href="https://developer.wordpress.org/cli/commands/db/export/">https://developer.wordpress.org/cli/commands/db/export/</a>
</p>
<pre class="example">
# Export database with drop query included
$ wp db export --add-drop-table
Success: Exported to 'wordpress_dbase-db72bb5.sql'.

wp db export --add-drop-table /var/www/html/devops/db/dump.sql
</pre>
</div>
</div>

<div id="outline-container-org0c4e331" class="outline-4">
<h4 id="org0c4e331"><span class="section-number-4">3.9.12</span> db size</h4>
<div class="outline-text-4" id="text-3-9-12">
<pre class="example">
wp db size --tables --size_format=mb
</pre>
</div>
</div>

<div id="outline-container-orge3d0b28" class="outline-4">
<h4 id="orge3d0b28"><span class="section-number-4">3.9.13</span> db query</h4>
<div class="outline-text-4" id="text-3-9-13">
<div class="org-src-container">
<pre class="src src-bash">wp db query <span style="color: #e67128;">'SELECT id FROM wp_posts WHERE post_content LIKE "%trans.gif%" AND post_type NOT IN ('</span>revision<span style="color: #e67128;">')'</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">In PowerShell, you need to escape "</span>

wp db query <span style="color: #e67128;">'SELECT id FROM wp_posts WHERE post_content LIKE \"%trans.gif%\" AND post_type NOT IN ('</span>revision<span style="color: #e67128;">')'</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org402f9e1" class="outline-4">
<h4 id="org402f9e1"><span class="section-number-4">3.9.14</span> Search and replace <a id="org9b5498f">wp-cli:search-replace</a></h4>
<div class="outline-text-4" id="text-3-9-14">
<p>
Used in <a href="#org47dc20d">image:tatemz/wp-cli</a>
<a href="https://developer.wordpress.org/cli/commands/search-replace/">https://developer.wordpress.org/cli/commands/search-replace/</a>
</p>

<p>
Search/replace intelligently handles PHP serialized data, and does not change primary key values.
</p>

<pre class="example">
# Search and replace but skip one column
$ wp search-replace 'http://example.dev' 'http://example.com' --skip-columns=guid

# Run search/replace operation but dont save in database
$ wp search-replace 'foo' 'bar' wp_posts wp_postmeta wp_terms --dry-run

# Run case-insensitive regex search/replace operation (slow)
$ wp search-replace '\[foo id="([0-9]+)"' '[bar id="\1"' --regex --regex-flags='i'

# Turn your production multisite database into a local dev database
$ wp search-replace --url=example.com example.com example.dev 'wp_*options' wp_blogs

# Search/replace to a SQL file without transforming the database
# Current database is not changed. The change result is output to a file
$ wp search-replace foo bar --export=database.sql

# Bash script: Search/replace production to development url (multisite compatible)

#!/bin/bash
if $(wp --url=http://example.com core is-installed --network); then
    wp search-replace --url=http://example.com 'http://example.com' 'http://example.dev' --recurse-objects --network --skip-columns=guid --skip-tables=wp_users
else
    wp search-replace 'http://example.com' 'http://example.dev' --recurse-objects --skip-columns=guid --skip-tables=wp_users
fi
</pre>
</div>
</div>

<div id="outline-container-org6a86ca6" class="outline-4">
<h4 id="org6a86ca6"><span class="section-number-4">3.9.15</span> Common Issues</h4>
<div class="outline-text-4" id="text-3-9-15">
<p>
<a href="https://make.wordpress.org/cli/handbook/common-issues">All common issues</a>
</p>
</div>

<div id="outline-container-orgc178d51" class="outline-5">
<h5 id="orgc178d51"><span class="section-number-5">3.9.15.1</span> Can't connect to database</h5>
<div class="outline-text-5" id="text-3-9-15-1">
<p>
<a href="https://make.wordpress.org/cli/handbook/common-issues/#error-cant-connect-to-the-database">https://make.wordpress.org/cli/handbook/common-issues/#error-cant-connect-to-the-database</a>
</p>

<p>
Make sure this line is exactly like this and wp-config.php shouldn't run any WP functions but only define constants
</p>
<pre class="example">
require_once(ABSPATH . 'wp-settings.php');
</pre>

<p>
Latest version of WordPress Docker is PHP 7 and hence has some extensions removed like mysql_connect. Make sure your PHP environment is the same for WordPress and <a href="#org8496abc">wp-cli</a>.
</p>
</div>
</div>

<div id="outline-container-org0792d06" class="outline-5">
<h5 id="org0792d06"><span class="section-number-5">3.9.15.2</span> Out of memory</h5>
<div class="outline-text-5" id="text-3-9-15-2">
<pre class="example">
php -i | grep php.ini

# /usr/local/etc/php/conf.d/myphp.ini
memory_limit=512M

# apache:restart

# Or you can run this to temporarily change the memory limit
php -d memory_limit=512M "$(which wp)" package install &lt;package-name&gt;
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3025ad3" class="outline-3">
<h3 id="org3025ad3"><span class="section-number-3">3.10</span> Conditional Tags <a id="org96268f1">wp:conditional tags</a></h3>
<div class="outline-text-3" id="text-3-10">
<p>
<a href="https://codex.wordpress.org/Conditional_Tags">These</a> are related the <a href="#orgbcfa6d5">wp:query:main</a> only.
</p>

<p>
is_page() :: any page
is_page(42)
is_page('slug')
is_page( array(42, 'about-me', 'Page title')) :: either one of those id, slug or title
is_page( array(42, 54, 6) )
</p>

<p>
is_page_template() :: any page template
is_page_template( 'about.php' ) :: 'page-templates/about.php'
</p>

<p>
is_admin_bar_showing() :: <a href="#orgdeac6e1">wp:admin:toolbar</a>
</p>
</div>
</div>

<div id="outline-container-org1328ee8" class="outline-3">
<h3 id="org1328ee8"><span class="section-number-3">3.11</span> Template Tags <a id="orga23f509">wp:template tags</a></h3>
<div class="outline-text-3" id="text-3-11">
<p>
wp-includes/xxx-template.php
<a href="https://codex.wordpress.org/Template_Tags">https://codex.wordpress.org/Template_Tags</a>
</p>
</div>

<div id="outline-container-org29b352a" class="outline-4">
<h4 id="org29b352a"><span class="section-number-4">3.11.1</span> post-thumbnail-template.php <a id="org59d668b">wp:t:thumbnail</a></h4>
<div class="outline-text-4" id="text-3-11-1">
<p>
get_post_thumbnail_id($post = null);
</p>

<p>
the_post_thumbnail_* :: has to be current post, calls get_the_post_thumbnail_*
get_the_post_thumbnail_* :: can specify which post, calls wp_get_attachment_image_src
</p>

<p>
You can <a href="#org8cd1ea8">wp:f:add_image_size</a>
Image size :: $size
NOTICE: If the thumbnail has no physical file that has corresponding size, the_post_thumbnail_url will 
get the original image file, the_post_thumbnail will use the original file with in src and apply width/height attributes
in HTML to achieve the purpose.
</p>
<dl class="org-dl">
<dt>'post-thumbnail'</dt><dd>default</dd>
<dt>array(100, 100)</dt><dd>Grab the biggest size in width and height image file possible.</dd>
<dt>array(100, 9999)</dt><dd>Grab the biggest size in width and height image file possible.</dd>
</dl>

<p>
You can resize an image file on the fly using <a href="#org264c07b">fly-dynamic-image-resizer</a>
</p>

<p>
the_post_thumbnail($size, $attr='') :: echo html
the_post_thumbnail_url($size) :: echo url
the_post_thumbnail_caption($post = null) :: echo thumbnail caption
</p>

<p>
wp_get_attachment_image_src( $attachment_id, $size = 'thumbnail', $icon = false ) is just like the_post_thumbnail but returns an array [url, width, height, is_intermediate]. url is $thumb[0]
</p>
</div>
</div>

<div id="outline-container-org7b907c9" class="outline-4">
<h4 id="org7b907c9"><span class="section-number-4">3.11.2</span> post-template.php <a id="org9ce37f6">wp:t:post</a></h4>
</div>
<div id="outline-container-orga7b98c1" class="outline-4">
<h4 id="orga7b98c1"><span class="section-number-4">3.11.3</span> category-template.php <a id="org84e3f52">wp:t:category</a></h4>
</div>
<div id="outline-container-org56e7fef" class="outline-4">
<h4 id="org56e7fef"><span class="section-number-4">3.11.4</span> general-template <a id="org0de6ad7">wp:t:general</a></h4>
</div>
<div id="outline-container-org7b12932" class="outline-4">
<h4 id="org7b12932"><span class="section-number-4">3.11.5</span> author-template.php</h4>
</div>
</div>
<div id="outline-container-orgc65e235" class="outline-3">
<h3 id="orgc65e235"><span class="section-number-3">3.12</span> Functions</h3>
<div class="outline-text-3" id="text-3-12">
</div>
<div id="outline-container-org0f29e99" class="outline-4">
<h4 id="org0f29e99"><span class="section-number-4">3.12.1</span> get_bloginfo, bloginfo, Site tagline, Sitetitle</h4>
<div class="outline-text-4" id="text-3-12-1">
<p>
retrieves info about the current site
<a href="https://developer.wordpress.org/reference/functions/get_bloginfo/">https://developer.wordpress.org/reference/functions/get_bloginfo/</a>
</p>

<pre class="example">
&lt;img src="&lt;?php bloginfo('template_url'); ?&gt;/assets/images/a.jpg" alt="" /&gt;
</pre>

<p>
version :: '4.9.4'
</p>
</div>
</div>

<div id="outline-container-orgc2cac9b" class="outline-4">
<h4 id="orgc2cac9b"><span class="section-number-4">3.12.2</span> get_the_ID() the_ID() - ID of current item or false</h4>
</div>
<div id="outline-container-orgc9ad5eb" class="outline-4">
<h4 id="orgc9ad5eb"><span class="section-number-4">3.12.3</span> get_post <a id="org2de2593">wp:f:get_post</a></h4>
<div class="outline-text-4" id="text-3-12-3">
<p>
get_post( int|WP_Post|null $post = null, string $output = OBJECT, string $filter = 'raw' )
</p>

<p>
Default is global $post
Return <a href="#orgf6b0e20">wp:post</a> object
</p>
</div>
</div>

<div id="outline-container-org96d9298" class="outline-4">
<h4 id="org96d9298"><span class="section-number-4">3.12.4</span> get_post_meta, get_metadata <a id="orgd91f193">wp:f:get_post_meta</a> <a id="orgb59a899">wp:f:get_metadata</a></h4>
<div class="outline-text-4" id="text-3-12-4">
<p>
<code>get_post_meta( int $post_id, string $key = '', bool $single = false )</code>
<code>get_metadata( string $meta_type, int $object_id, string $meta_key = '', bool $single = false )</code>
</p>

<p>
<code>get_post_meta</code> is a wrapper of <code>get_metadata</code> and specify the object type is a <code>post</code>
</p>

<dl class="org-dl">
<dt><code>$key</code></dt><dd>default to return data for all keys</dd>
<dt><code>$single</code></dt><dd>wheter to return single value. return array if it's false</dd>
</dl>

<p>
Return post thumbnail alt text
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #74af68;">// </span><span style="color: #74af68;">return post thumbnail alt text</span>
<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">thumb_id</span> = get_post_thumbnail_id(get_the_ID());
<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">alt</span> = get_post_meta(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">thumb_id</span>, <span style="color: #e67128;">'_wp_attachment_image_alt'</span>, <span style="color: #008b8b;">true</span>);
<span style="color: #ffad29; font-weight: bold;">if</span>( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">alt</span> ):
    <span style="color: #ffad29; font-weight: bold;">echo</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">alt</span>;
<span style="color: #ffad29; font-weight: bold;">endif</span>;

<span style="color: #74af68;">// </span><span style="color: #74af68;">return a post metadata</span>
<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">meta</span> = get_post_meta(get_the_ID());
<span style="color: #ffad29; font-weight: bold;">echo</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">meta</span>[<span style="color: #e67128;">'header-title'</span>][0];
</pre>
</div>
</div>
</div>

<div id="outline-container-org0c42afa" class="outline-4">
<h4 id="org0c42afa"><span class="section-number-4">3.12.5</span> wp_get_post_terms($post_id, $tax, $args)</h4>
<div class="outline-text-4" id="text-3-12-5">
<p>
Get the slugs of the terms under taxonomy publication
<code>wp_get_post_terms($post_id, 'publication', ['field' =&gt; 'slugs'])</code>
</p>
</div>
</div>
<div id="outline-container-org598ee0d" class="outline-4">
<h4 id="org598ee0d"><span class="section-number-4">3.12.6</span> wp_editor</h4>
<div class="outline-text-4" id="text-3-12-6">
<p>
<a id="org42678ed">wp:f:wp_editor</a>
Render an editor for field in a page in the typical fashion used in Posts and Pages.
<a href="https://codex.wordpress.org/Function_Reference/wp_editor">Doc</a>
</p>

<p>
May be used in <a href="#orga551a76">wp:action:edit_page_form</a> <a href="#org81a7be8">wp:action:edit_form_advanced</a>
Use <a href="#orgf5f6f3c">wp:f:update_post_meta</a> in <a href="#org19d1e0e">wp:action:save_post</a> for storing the new field
</p>
</div>
</div>

<div id="outline-container-org4d947b8" class="outline-4">
<h4 id="org4d947b8"><span class="section-number-4">3.12.7</span> Translate</h4>
<div class="outline-text-4" id="text-3-12-7">
<p>
Use <a href="#org3bd4eca">tool:Poedit</a>
</p>
</div>

<div id="outline-container-org9722e94" class="outline-5">
<h5 id="org9722e94"><span class="section-number-5">3.12.7.1</span> Translate Functions</h5>
<div class="outline-text-5" id="text-3-12-7-1">
<p>
$text can't be a variable. And use single quotes instead of "".
</p>

<p>
Use sprintf() and printf for subsitutions. The msgid is "You have chosen the %s theme"
</p>
<pre class="example">
echo sprintf( __( 'You have chosen the %s theme.' ) , the_color() );
printf( __( 'You have chosen the %s theme.' ) , the_color() );
</pre>

<p>
echo __('some text', 'textdomain'); // return
'textdomain' is optional but it has to be a string not a variable! Default it's 'default'
</p>

<p>
_e() is the same as __() but echoes
</p>

<p>
Plural or single
echo _n('There is a comment', 'There are comments', get_comments_number());
</p>

<p>
Context
echo _x('post a link', 'A link to the post');
'A link to the post' matches msgctxt "A link to the post" in .po file.
</p>

<p>
_ex is the same as _x but echoes
echo _ex('post link', 'Submit a link');
</p>
</div>
</div>

<div id="outline-container-org07928ca" class="outline-5">
<h5 id="org07928ca"><span class="section-number-5">3.12.7.2</span> Setup, .po and .mo files</h5>
<div class="outline-text-5" id="text-3-12-7-2">
<p>
Load textdomain in child theme which overwrites the textdomain defined in parent theme
Do this in theme functions.php
</p>
<pre class="example">
function smart_mag_child_theme_locale() {
  $_r = load_child_theme_textdomain( 'textdomain-name', get_stylesheet_directory() . '/languages' );
  // textdomain-name can be defined in parent theme or a new textdomain
  // if textdomain-name has been defined earlier, then this will overwrite

  // Check if textdomain inclusion is successful
  //if ( $_r ) var_dump( 'success!' );

  if ( is_admin() ) {
    // load another textdomain
  }
}
add_action( 'after_setup_theme', 'smart_mag_child_theme_locale' );
</pre>

<p>
Usually translate-ready theme will provide a .pot file which is a template file for .po and .mo files.
Open .pot in <a href="#org3bd4eca">tool:Poedit</a>, generate a new translation. What Poedit saves is 2 files: .po and .mo.
</p>

<p>
Open .po file later, make changes and save to overwrite .po and .mo files. File .pot is no longer needed.
</p>

<p>
Catalog &gt; Properties &gt; Translation properties
Specifiy the language
Plural Forms by default is
</p>
<pre class="example">
nplurals=2; plural=n != 1;
</pre>

<p>
Might need to specify the path in code for .po file. '.' means the current path.
</p>
<pre class="example">
"X-Poedit-SearchPath-0: .\n"
</pre>

<p>
Catalog &gt; Properties &gt; Sources keywords contain all the Wordpress translation functions
</p>

<pre class="example">
__
_e
_n:1,2
_x:1,2c
_ex:1,2c
</pre>

<p>
<code>:1,2</code> indicates the function has 2 parts. <code>2c</code> means the 2nd argument is a context/comment.
</p>

<p>
<a href="#org3bd4eca">tool:Poedit</a> can help you change most of the fields except that it can't specify context msgctxt.
</p>

<p>
For those situations, directly edit .po and open .po in Poedit and save to get the .mo file.
</p>

<p>
Some examples
</p>

<p>
Comments :: <code>#. Author of the plugin/theme</code> Due to emacs, <code>;; #.</code> is <code>#.</code> in the following examples
Reference :: <code>#: woocommerce/loop/orderby.php:23</code> Due to emacs, <code>;; #:</code> is <code>#:</code> in the following examples
</p>

<p>
Concatenate multiple lines
</p>
<pre class="example">
#: 404.php:18
msgid ""
"We're sorry, but we can't find the page you were looking for. It's probably "
"some thing we've done wrong but now we know about it and we'll try to fix "
"it. In the meantime, try one of these options:"
msgstr ""
</pre>

<p>
sprintf and printf subsitutions
</p>
<pre class="example">
#: archive.php:101
msgid "Yearly Archives: %s"
msgstr ""
</pre>

<p>
Context
</p>
<pre class="example">
#: bbpress/auth-modal.php:69
msgctxt "bbPress"
msgid "Favorites"
msgstr ""
</pre>

<p>
Complex context
</p>
<pre class="example">
#: comments.php:53
msgid ""
"Logged in as &lt;a href=\"%1$s\"&gt;%2$s&lt;/a&gt;. &lt;a href=\"%3$s\" title=\"Log out of "
"this account\"&gt;Log out?&lt;/a&gt;"
msgstr ""
</pre>

<p>
Poedit save fr_CA.po and fr_CA.mo files. Copy and place them into the right place and then on Wordpress
Settings &gt; General &gt; Site Lanuage to match fr_CA
</p>
</div>
</div>
</div>

<div id="outline-container-org4788ab2" class="outline-4">
<h4 id="org4788ab2"><span class="section-number-4">3.12.8</span> add_theme_support <a id="orga8e6038">wp:f:add_theme_support</a></h4>
<div class="outline-text-4" id="text-3-12-8">
<p>
<a id="org9694afa">wp:f:add_theme_support:post-thumbnails</a>
Features are usually added in <a href="#org55ee70d">wp:action:after_setup_theme</a>
</p>

<div class="org-src-container">
<pre class="src src-php">add_theme_support( <span style="color: #e67128;">'post-thumbnails'</span> );

<span style="color: #74af68;">// </span><span style="color: #74af68;">refer to wp:f:add_image_size</span>

add_theme_support( <span style="color: #e67128;">'automatic-feed-links'</span> );
<span style="color: #74af68;">// </span><span style="color: #74af68;">adds</span>
<span style="color: #74af68;">//</span><span style="color: #74af68;">&lt;link rel="alternate" type="application/rss+xml" title="Website Name Feed" href="http://myweb.io/feed/" /&gt;</span>
<span style="color: #74af68;">//</span><span style="color: #74af68;">&lt;link rel="alternate" type="application/rss+xml" title="Website Name Comments Feed" href="http://myweb.io/comments/feed/" /&gt;</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">If it's a page, add one more</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">&lt;link rel="alternate" type="application/rss+xml" title="Website Name Page Name Comments Feed" href="http://myweb.io/2016/07/20/page-name/feed/" /&gt;</span>

add_theme_support( <span style="color: #e67128;">'title-tag'</span> ); <span style="color: #74af68;">// </span><span style="color: #74af68;">wp will provide &lt;title&gt; not hard coded in template file using wp_title()</span>

add_theme_support( <span style="color: #e67128;">'html5'</span>, <span style="color: #ffad29; font-weight: bold;">array</span>(
  <span style="color: #e67128;">'search-form'</span>,
  <span style="color: #e67128;">'comment-form'</span>,
  <span style="color: #e67128;">'comment-list'</span>,
  <span style="color: #e67128;">'gallery'</span>,
  <span style="color: #e67128;">'caption'</span>,
) );
<span style="color: #74af68;">// </span><span style="color: #74af68;">use the default html5 markup instead of the default html4 file</span>

add_theme_support( <span style="color: #e67128;">'post-formats'</span>, <span style="color: #ffad29; font-weight: bold;">array</span>(
  <span style="color: #e67128;">'aside'</span>,
  <span style="color: #e67128;">'image'</span>,
  <span style="color: #e67128;">'video'</span>,
  <span style="color: #e67128;">'quote'</span>,
  <span style="color: #e67128;">'link'</span>,
  <span style="color: #e67128;">'gallery'</span>,
  <span style="color: #e67128;">'audio'</span>,
) );
<span style="color: #74af68;">// </span><span style="color: #74af68;">wp provides a list of formats for admin users to choose to display a post</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">refer to wp:f:has_post_format</span>

add_theme_support( <span style="color: #e67128;">'custom-logo'</span>, <span style="color: #ffad29; font-weight: bold;">array</span>(
    <span style="color: #e67128;">'width'</span>       =&gt; 250,
    <span style="color: #e67128;">'height'</span>      =&gt; 250,
    <span style="color: #e67128;">'flex-width'</span>  =&gt; <span style="color: #008b8b;">true</span>,
) );
<span style="color: #74af68;">// </span><span style="color: #74af68;">provide a place to upload theme logo in wp-admin</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">https://developer.wordpress.org/themes/functionality/custom-logo/</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">refer to wp:custom logo:display</span>

add_theme_support( <span style="color: #e67128;">'customize-selective-refresh-widgets'</span> );
<span style="color: #74af68;">// </span><span style="color: #74af68;">https://make.wordpress.org/core/2016/03/22/implementing-selective-refresh-support-for-widgets/</span>

add_theme_support( <span style="color: #e67128;">'starter-content'</span>, <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">starter_content</span> );
<span style="color: #74af68;">// </span><span style="color: #74af68;">https://make.wordpress.org/core/2016/11/30/starter-content-for-themes-in-4-7/</span>

<span style="color: #74af68;">//</span><span style="color: #74af68;">add_theme_support( 'custom-background' ); // simple enable</span>
<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">defaults</span> = <span style="color: #ffad29; font-weight: bold;">array</span>(
  <span style="color: #e67128;">'default-color'</span>          =&gt; <span style="color: #e67128;">''</span>,
  <span style="color: #e67128;">'default-image'</span>          =&gt; <span style="color: #e67128;">''</span>,
  <span style="color: #e67128;">'default-repeat'</span>         =&gt; <span style="color: #e67128;">'repeat'</span>,
  <span style="color: #e67128;">'default-position-x'</span>     =&gt; <span style="color: #e67128;">'left'</span>,
  <span style="color: #e67128;">'default-position-y'</span>     =&gt; <span style="color: #e67128;">'top'</span>,
  <span style="color: #e67128;">'default-size'</span>           =&gt; <span style="color: #e67128;">'auto'</span>,
  <span style="color: #e67128;">'default-attachment'</span>     =&gt; <span style="color: #e67128;">'scroll'</span>,
  <span style="color: #e67128;">'wp-head-callback'</span>       =&gt; <span style="color: #e67128;">'_custom_background_cb'</span>,
  <span style="color: #e67128;">'admin-head-callback'</span>    =&gt; <span style="color: #e67128;">''</span>,
  <span style="color: #e67128;">'admin-preview-callback'</span> =&gt; <span style="color: #e67128;">''</span>
);
add_theme_support( <span style="color: #e67128;">'custom-background'</span>, <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">defaults</span> );
<span style="color: #74af68;">// </span><span style="color: #74af68;">https://codex.wordpress.org/Custom_Backgrounds</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf2e1139" class="outline-4">
<h4 id="orgf2e1139"><span class="section-number-4">3.12.9</span> add_image_size</h4>
<div class="outline-text-4" id="text-3-12-9">
<p>
<a id="org8cd1ea8">wp:f:add_image_size</a>
Use <a href="#org55ee70d">wp:action:after_setup_theme</a>
Every newly uploaded image will have image files with all defined image sizes.
</p>

<pre class="example">
function lili_theme_setup() {
 add_image_size('lili-w700', 700, 9999); // fixed width, unlimited height
 add_image_size('lili-w700h600', 700, 600, true); // crop in exact dimension 
}
</pre>
</div>
</div>

<div id="outline-container-org636735d" class="outline-4">
<h4 id="org636735d"><span class="section-number-4">3.12.10</span> add_management_page</h4>
<div class="outline-text-4" id="text-3-12-10">
<p>
<a href="#orge697b11">wp:action:admin_menu</a>
Add sub menu to Tools admin menu
</p>

<p>
add_management_page(
 'Page title', <i>/ string
 'Menu title', /</i> string
 'manage_options', <i>/ string. Capability that is required.
 'menu_slug', /</i> string
 'callbackFunct', // string or array($this, 'options_page')
);
</p>
</div>
</div>

<div id="outline-container-org446aa2f" class="outline-4">
<h4 id="org446aa2f"><span class="section-number-4">3.12.11</span> add_post_type_support</h4>
<div class="outline-text-4" id="text-3-12-11">
<p>
<a id="org34afa3b">wp:f:add_post_type_support</a>
</p>

<p>
add_post_type_support($post_type, $supports);
</p>

<dl class="org-dl">
<dt>$post_type</dt><dd>string</dd>
<dt>$supports</dt><dd>string/array
<ul class="org-ul">
<li>title</li>
<li id="editor">content</li>
<li>author</li>
<li id="thumbnail">current theme must support Post Thumbnails</li>
<li>excerpt</li>
<li>trackbacks</li>
<li id="custom-fields"><a href="#org28d778d">wp:Custom_Fields</a>. Don't have to add 'custom-fields' in order to use <a href="#orgb00414c">wp:plugin:acf</a></li>
<li>comments</li>
<li>revisions</li>
<li id="page-attributes">menu order, hierarchical must be true</li>
<li id="post-formats">add post formats</li>
</ul></dd>
</dl>

<p>
add_action('init', 'lili_custom_post_type');
function lili_custom_post_type() {
  $labels = [
    // array, <a href="#orgf6823bb">wp:register_post_type:labels</a>
  ];
</p>

<p>
$args = [
  'label' =&gt; 'Plural Name', // string. required.
  'labels' =&gt; $labels,
  'description' =&gt; '', // string, optional
  'public' =&gt; false,
  /* Default. bool.
</p>
<ul class="org-ul">
<li>exclude_from_search, publicly_queryable, show_in_nav_menus, show_ui</li>
<li>true:               false,               true,              true, true</li>
<li>false:               true,              false,             false, false</li>
</ul>
<p>
 */
'exclude_from_search' =&gt; false, <i>/ default. optional. 'site</i>?s=search-term'
'publicly_queryable' =&gt; true, // optional. take 'public' value.
/* ?post_type={post_type_key},
</p>
<ul class="org-ul">
<li>?{post_type_key}={single_post_slug},</li>
<li>?{post_type_query_var}={single_post_slug}</li>
</ul>
<p>
 */
'show_ui' =&gt; true, <i>/ optional. bool. default take 'public' value.
'show_in_nav_menus' =&gt; true, /</i> optional. bool. inherits 'public' value.
'show_in_menu' =&gt; true, <i>/ optional, bool or string. default inherits show_ui
/</i> false :: do not display in admin menu
<i>/ true :: display as a top level menu
/</i> 'some string' :: display as a submenu of a menu 'some string'
'show_in_admin_bar' =&gt; true, <i>/ optional, bool, default inherits show_in_
'supports' =&gt; ['title', 'editor'], /</i> optional. array/bool. <a href="#org34afa3b">wp:f:add_post_type_support</a>
</p>

<p>
];
</p>

<p>
register_post_type('movies', $args );
</p>

<p>
}
</p>

<p>
Use <a href="#orgbd389b2">wp:action:pre_get_posts</a> to enable query for this new post type
</p>
</div>
</div>

<div id="outline-container-orgd428609" class="outline-4">
<h4 id="orgd428609"><span class="section-number-4">3.12.12</span> add_rewrite_rule, add_rewrite_tag <a id="orga736876">wp:f:add_rewrite_rule</a> <a id="org0a1ed3a">wp:f:add_rewrite_tag</a></h4>
<div class="outline-text-4" id="text-3-12-12">
<p>
<a href="#org6822133">wp:action:init</a>
</p>

<p>
Need to flush Settings -&gt; Permalinks and just click Save Changes without any changes to add into db:wp_options:rewrite_rules
</p>
<pre class="example">
// add_rewrite_rule($regex, $redirect, $after = 'bottom');
function custom_rewrite_basic() {
  add_rewrite_rule('^leaf/([0-9]+)/?', 'index.php?page_id=$matches[1]', 'top');
}
add_action('init', 'custom_rewrite_basic');
</pre>

<p>
$after :: This can either be 'top' or 'bottom'. 'top' will take precedence over WordPress's existing rules, where 'bottom' will check all other rules match first.
</p>

<p>
$matches[] to retrieve the values of a matched URL, capture group data starts at 1, not 0.
</p>

<pre class="example">
function custom_rewrite_tag() {
  add_rewrite_tag('%food%', '([^&amp;]+)');
  add_rewrite_tag('%variety%', '([^&amp;]+)');
}
add_action('init', 'custom_rewrite_tag', 10, 0);

function custom_rewrite_rule() {
  add_rewrite_rule('^nutrition/([^/]*)/([^/]*)/?','index.php?page_id=12&amp;food=$matches[1]&amp;variety=$matches[2]','top');
}
add_action('init', 'custom_rewrite_rule', 10, 0);
</pre>

<p>
Create a page called Nutrition with page id 12 and use a custom template my-custom-template.php:
</p>
<pre class="example">
/**
 * Template Name: Nutritional Information
 */
get_header(); 

global $wp_query;
echo 'Food : ' . $wp_query-&gt;query_vars['food'];
echo '&lt;br /&gt;';
echo 'Variety : ' . $wp_query-&gt;query_vars['variety'];
// ... more ...
get_footer();
</pre>
</div>
</div>

<div id="outline-container-org9ffcc1e" class="outline-4">
<h4 id="org9ffcc1e"><span class="section-number-4">3.12.13</span> add_editor_style</h4>
<div class="outline-text-4" id="text-3-12-13">
<p>
Used in <a href="#org86105c8">wp:action:admin_init</a> <a href="#org55ee70d">wp:action:after_setup_theme</a>
</p>

<p>
Add stylesheets for TinyMCE
add_editor_style( array|string $stylesheet = 'editor-style.css' )
Stylesheet name or array thereof, relative to theme root
This function automatically adds another stylesheet with -rtl prefix, e.g. editor-style-rtl.css. If that file doesn’t exist, it is removed before adding the stylesheet(s) to TinyMCE. If an array of stylesheets is passed to add_editor_style(), RTL is only added for the first stylesheet.
</p>

<p>
Since version 3.4 the TinyMCE body has .rtl CSS class. It is a better option to use that class and add any RTL styles to the main stylesheet.
</p>

<pre class="example">
add_editor_style( array( 'assets/css/editor-style.css', twentyseventeen_fonts_url() ) );
</pre>
</div>
</div>

<div id="outline-container-org343c8af" class="outline-4">
<h4 id="org343c8af"><span class="section-number-4">3.12.14</span> has_post_format <a id="org9c2111c">wp:f:has_post_format</a></h4>
<div class="outline-text-4" id="text-3-12-14">
<p>
In template
</p>
<pre class="example">
if ( has_post_format( 'aside' )) {
  // code to display the aside format post here
} else if (has_post_format('gallery')) {
   // stuff to display the gallery format post here
} else if (has_post_format('link')) {
   // stuff to display the link format post here
}else {
   // code to display the normal format post here
}
</pre>
</div>
</div>

<div id="outline-container-org74f9b8a" class="outline-4">
<h4 id="org74f9b8a"><span class="section-number-4">3.12.15</span> has_custom_logo, get_custom_logo, the_custom_logo <a id="orgcbcf0a4">wp:custom logo:display</a></h4>
<div class="outline-text-4" id="text-3-12-15">
<p>
get_custom_logo returns markup
the_custom_logo displays markup
</p>

<pre class="example">
$custom_logo_id = get_theme_mod( 'custom_logo' );
$logo = wp_get_attachment_image_src( $custom_logo_id , 'full' );
if ( has_custom_logo() ) {
        echo '&lt;img src="'. esc_url( $logo[0] ) .'"&gt;';
} else {
        echo '&lt;h1&gt;'. get_bloginfo( 'name' ) .'&lt;/h1&gt;';
}
</pre>
</div>
</div>

<div id="outline-container-org8213403" class="outline-4">
<h4 id="org8213403"><span class="section-number-4">3.12.16</span> remove_meta_box</h4>
<div class="outline-text-4" id="text-3-12-16">
<p>
<a id="orgccd0947">wp:f:remove_meta_box</a>
</p>

<p>
remove_meta_box( $id, $page, $context);
</p>
<ul class="org-ul">
<li>Return</li>
<li id="$id">string
<ul class="org-ul">
<li>authordiv</li>
<li>categorydiv</li>
<li>comemntstatusdiv</li>
<li>commentsdiv</li>
<li>formatdiv</li>
<li>pageparentdiv</li>
<li>postcustom</li>
<li>postexcerpt</li>
<li>postimagediv</li>
<li>revisionsdiv</li>
<li>slugdiv</li>
<li>submitdiv</li>
<li>tagsdiv-post_tag</li>
<li>tagsdiv-{$tax-name}</li>
<li>{$tax-name}div</li>
<li>trackbacksdiv</li>
<li>&#x2026;</li>
</ul></li>
<li id="$page">string. Type of screen
<ul class="org-ul">
<li>post</li>
<li>page</li>
<li>attachment</li>
<li>link</li>
<li>dashboard</li>
<li>any custom post type e.g. 'my-product'</li>
</ul></li>
<li id="$context">string. 'normal', 'advanced', or 'side'
<dl class="org-dl">
<dt>Post edit screen</dt><dd>normal, side and advanced</dd>
<dt>Comments screen</dt><dd>normal and side</dd>
<dt>Menu meta boxes</dt><dd>side</dd>
</dl></li>
<li>Return nothing</li>
</ul>
</div>
</div>

<div id="outline-container-orgdf96eb6" class="outline-4">
<h4 id="orgdf96eb6"><span class="section-number-4">3.12.17</span> get_header, get_footer, get_sidebar, get_search_form, comments_template</h4>
<div class="outline-text-4" id="text-3-12-17">
<p>
<a id="org7c3e5a3">wp:f:get_header</a> <a id="orgb113c75">wp:f:get_footer</a> <a id="org900ea80">wp:f:get_sidebar</a> <a id="orgbf31dbc">wp:f:get_search_form</a> <a id="org7743d03">wp:f:comments_template</a>
</p>

<p>
System default load paths:
wp-includes/theme-compat/header.php, footer.php, sidebar.php, comments.php
</p>

<pre class="example">
header-{name}.php
footer-{name}.php
sidebar-{name}.php
{slug}-{name}.php
searchform.php
comment.php

// 404.php sample

&lt;?php get_header( $name ); 
//get_template_part( $slug, $name );
get_template_part( 'nav' );
?&gt;
&lt;h2&gt;Error - 404 - Not Found&lt;/h2&gt;
&lt;?php
get_sidebar();
get_footer( $name );
?&gt;
</pre>
</div>
</div>

<div id="outline-container-org8ba0a6d" class="outline-4">
<h4 id="org8ba0a6d"><span class="section-number-4">3.12.18</span> get_template_part, get_theme_file_uri, get_theme_file_path <a id="org48505a2">wp:f:get_template_part</a></h4>
<div class="outline-text-4" id="text-3-12-18">
<p>
<code>get_template_part( string $slug, string $name = null )</code>
It includes file {slug.php} or {slug}-{name}.php
</p>

<div class="org-src-container">
<pre class="src src-php"><span style="color: #23d7d7;">&lt;?php</span> get_template_part( <span style="color: #e67128;">'template-parts/header/header'</span>, <span style="color: #e67128;">'image'</span> ); <span style="color: #23d7d7;">?&gt;</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">echo path-to-theme/template-parts/header/header-image.php</span>
</pre>
</div>

<p>
<a id="orgbb6b624">wp:f:get_theme_file_uri</a>
get_theme_file_uri checks for file existance and returns URL.
</p>
<div class="org-src-container">
<pre class="src src-php">wp_enqueue_script( <span style="color: #e67128;">'my-script'</span>, get_theme_file_uri( <span style="color: #e67128;">'js/my-script.js'</span> ) );
</pre>
</div>

<p>
Get from child theme first js/my-scripts.js. Fall back to parent theme.
</p>

<p>
<a id="orgecb3889">wp:f:get_theme_file_path</a> returns the path in filesystem so that you can use filemtime
</p>
<div class="org-src-container">
<pre class="src src-php">wp_enqueue_script(
    <span style="color: #e67128;">'my-script'</span>,
    get_theme_file_uri( <span style="color: #e67128;">'js/my-script.js'</span> ),
    <span style="color: #ffad29; font-weight: bold;">array</span>(),
    filemtime( get_theme_file_path( <span style="color: #e67128;">'js/my-script.js'</span> ) )
);
</pre>
</div>
</div>
</div>

<div id="outline-container-org06cf52f" class="outline-4">
<h4 id="org06cf52f"><span class="section-number-4">3.12.19</span> get_template_directory, get_template_directory_uri, get_stylesheet_directory_uri, get_stylesheet_uri</h4>
<div class="outline-text-4" id="text-3-12-19">
<dl class="org-dl">
<dt>get_template_directory</dt><dd>the filesystem path of the current parent theme</dd>
<dt>get_template_directory_uri</dt><dd>URI e.g. protocol://domain of the current parent theme</dd>
<dt>get_stylesheet_directory_uri</dt><dd>URI of the stylesheet directory. grab child and then parent theme.</dd>
<dt>get_stylesheet_uri</dt><dd>URI of style.css</dd>
</dl>

<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffad29; font-weight: bold;">include</span>( get_template_directory() . <span style="color: #e67128;">'/includes/myfile.php'</span>);
wp_enqueue_script( <span style="color: #e67128;">'twentyfifteen-skip-link-focus-fix'</span>, get_template_directory_uri() . <span style="color: #e67128;">'/js/skip-link-focus-fix.js'</span>, <span style="color: #ffad29; font-weight: bold;">array</span>(), <span style="color: #e67128;">'20141010'</span>, <span style="color: #008b8b;">true</span> );
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb492f99" class="outline-4">
<h4 id="orgb492f99"><span class="section-number-4">3.12.20</span> wp_upload_dir</h4>
<div class="outline-text-4" id="text-3-12-20">
<p>
Return an array to describe location of wp upload directory
</p>

<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffad29; font-weight: bold;">array</span> (
    <span style="color: #e67128;">'path'</span> =&gt; <span style="color: #e67128;">'/var/www/html/wp-content/uploads/2018/09'</span>, <span style="color: #74af68;">// </span><span style="color: #74af68;">next upload will go to this path</span>
    <span style="color: #e67128;">'url'</span> =&gt; <span style="color: #e67128;">'http://localhost:32006/wp-content/uploads/2018/09'</span>, <span style="color: #74af68;">// </span><span style="color: #74af68;">next upload </span>
    <span style="color: #e67128;">'subdir'</span> =&gt; <span style="color: #e67128;">'/2018/09'</span>, 
    <span style="color: #e67128;">'basedir'</span> =&gt; <span style="color: #e67128;">'/var/www/html/wp-content/uploads'</span>,
    <span style="color: #e67128;">'baseurl'</span> =&gt; <span style="color: #e67128;">'http://localhost:32006/wp-content/uploads'</span>,
    <span style="color: #e67128;">'error'</span> =&gt; <span style="color: #008b8b;">false</span>
)
</pre>
</div>
</div>
</div>

<div id="outline-container-org7aaa75d" class="outline-4">
<h4 id="org7aaa75d"><span class="section-number-4">3.12.21</span> get_the_excerpt, the_excerpt</h4>
<div class="outline-text-4" id="text-3-12-21">
<p>
the_excerpt() echoes current post and it calls get_the_excerpt($post=null)
If no excerpt is set in UI, it pulls the first 55 words. If it's set, it displays the whole manually set text.
</p>
</div>
</div>

<div id="outline-container-org2056e21" class="outline-4">
<h4 id="org2056e21"><span class="section-number-4">3.12.22</span> wp_remote_get, wp_remote_post, wp_remote_head, wp_remote_request</h4>
<div class="outline-text-4" id="text-3-12-22">
<pre class="example">
$response = wp_remote_get( 'http://www.example.com/index.html' );
// url has to include protocal e.g. http://
if ( is_array( $response ) ) {
  $header = $response['headers']; // array of http header lines
  $body = $response['body']; // use the content
}

wp_remote_get( 'http://www.example.com/index.php?action=foo', array( 'timeout' =&gt; 120, 'httpversion' =&gt; '1.1' ) );
</pre>

<p>
Methods to work with $response
</p>
<ul class="org-ul">
<li>wp_remote_retrieve_body() - Retrieves just the body from the response.</li>
<li>wp_remote_retrieve_header() - Gives you a single HTTP header based on name from the response.</li>
<li>wp_remote_retrieve_headers() - Returns all of the HTTP headers in an array for processing.</li>
<li>wp_remote_retrieve_response_code() - Gives you the number for the HTTP response. This should be 200, but could be 4xx or even 3xx on failure.</li>
<li>wp_remote_retrieve_response_message() - Returns the response message based on the response code.</li>
</ul>

<p>
Default options
</p>
<pre class="example">
global $wp_version;
$args = array(
    'timeout'     =&gt; 5, // seconds
    'redirection' =&gt; 5, // how many times
    'httpversion' =&gt; '1.0',
    'user-agent'  =&gt; 'WordPress/' . $wp_version . '; ' . home_url(),
    'blocking'    =&gt; true, // php will stop until the request is processed. false to just ping but wp_remote_get will return false
    'headers'     =&gt; array(),
    'cookies'     =&gt; array(),
    'body'        =&gt; null,
    'compress'    =&gt; false,
    'decompress'  =&gt; true,
    'sslverify'   =&gt; true,
    'stream'      =&gt; false,
    'filename'    =&gt; null
); 
</pre>
</div>
</div>

<div id="outline-container-org0a1e13e" class="outline-4">
<h4 id="org0a1e13e"><span class="section-number-4">3.12.23</span> register_post_type <a id="org82fa6bc">wp:f:register_post_type</a></h4>
<div class="outline-text-4" id="text-3-12-23">
<p>
<a href="#org6822133">wp:action:init</a> <a href="#orgbd389b2">wp:action:pre_get_posts</a> <a href="#orgb00414c">wp:plugin:acf</a>
</p>

<p>
Remember to refresh Permalink from UI.
<a href="https://codex.wordpress.org/Function_Reference/register_post_type">https://codex.wordpress.org/Function_Reference/register_post_type</a>
</p>
<dl class="org-dl">
<dt>$post_type</dt><dd>string. &lt; 20 characters. All lowercase and no space</dd>
<dt>$args</dt><dd>array of arguments</dd>
</dl>

<pre class="example">
add_action('init', 'lili_custom_post_type');
function lili_custom_post_type() {
  $labels = [
    // array, wp:register_post_type:labels
  ];

  $args = [
    'label' =&gt; 'Plural Name', // string, optional, default labels['name']
    'labels' =&gt; $labels,
    'description' =&gt; '', // string, optional

    'public' =&gt; false,
    /* Default false
     *       exclude_from_search, publicly_queryable, show_in_nav_menus, show_ui
     * true:               false,               true,              true, true
     * false:               true,              false,             false, false
     */

    'exclude_from_search' =&gt; false, // default. optional. 'site/?s=search-term'

    'publicly_queryable' =&gt; true, // optional. take 'public' value.
    /* ?post_type={post_type_key},
     * ?{post_type_key}={single_post_slug},
     * ?{post_type_query_var}={single_post_slug}
     */

    // 'query_var' =&gt; true, // Default. Set to false means the post type cannot be loaded at /?{query_var}={single_post_slug}. It has no effect when public_queryable is false.

    'show_ui' =&gt; true, // optional. bool. default take 'public' value.
    'show_in_nav_menus' =&gt; true, // optional. bool. inherits 'public' value.
    'show_in_menu' =&gt; true, // optional, bool or string. default inherits show_ui
    // false :: do not display in admin menu
    // true :: display as a top level menu
    // 'some string' :: display as a submenu of a menu 'some string'
    'show_in_admin_bar' =&gt; true, // optional, bool, default inherits show_in_menu

    'supports' =&gt; ['title', 'editor'], 
    // optional. array/bool. wp:f:add_post_type_support
    // 'custom-fields' :: don't have to add in order to use wp:plugin:acf
    // 'title', 'editor' (content) this is the default
    // 'author','excerpt', 'trackbacks',
    // 'thumbnail' (featured image, current theme must also support post-thumbnails)
    // 'comments' (also will see comment count balloon on edit screen)
    // 'revisions' (will store revisions)
    // 'page-attributes' (menu order, hierarchical must be true to show Parent option)
    // 'post-formats' add post formats, see Post Formats

    // 'hierarchical' =&gt; true
    // default false, when true 'supports' should contain 'page-attributes'  

    // 'has_archive' =&gt; true // default false

  ];

  register_post_type('movies', $args);

}

add_action( 'pre_get_posts', 'lili_pre_get_posts' );
// Should not call this in template because in template the $query is already run
function lili_pre_get_posts( $query ) {
  if ( ! is_page() &amp;&amp; ! is_home() &amp;&amp; $query-&gt;is_main_query() ) {
    $query-&gt;set( 'post_type', array( 'post', 'movies' ) );
  }
  // this function should return nothing.
}
</pre>
</div>

<div id="outline-container-org5c339fa" class="outline-5">
<h5 id="org5c339fa"><span class="section-number-5">3.12.23.1</span> labels</h5>
<div class="outline-text-5" id="text-3-12-23-1">
<p>
<a id="orgf6823bb">wp:register_post_type:labels</a>
</p>

<pre class="example">
'labels' =&gt; array(
  'name' =&gt; __( 'Jobs' ),
  'singular_name' =&gt; __( 'Job' )
)
</pre>
</div>
</div>

<div id="outline-container-org0023c8c" class="outline-5">
<h5 id="org0023c8c"><span class="section-number-5">3.12.23.2</span> menu_icon</h5>
<div class="outline-text-5" id="text-3-12-23-2">
<p>
optional, default null &gt; posts icon
'dashicons-video-alt' (Uses the video icon from <a href="https://developer.wordpress.org/resource/dashicons/">Dashicons</a>)
'get_template_directory_uri() . "/images/cutom-posttype-icon.png"' (Use a image located in the current theme)
'data:image/svg+xml;base64,' . base64_encode( "&lt;svg version="1.1" xmlns="<a href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>" xmlns:xlink="<a href="http://www.w3.org/1999/xlink">http://www.w3.org/1999/xlink</a>" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 459 459"&gt; &lt;path fill="black" d="POINTS"/&gt;&lt;/svg&gt;" )' (directly embedding a svg with 'fill="black"' will allow correct colors.)
</p>
</div>
</div>
</div>

<div id="outline-container-org37d427a" class="outline-4">
<h4 id="org37d427a"><span class="section-number-4">3.12.24</span> register_nav_menus, register_nav_menu, wp_nav_menu</h4>
<div class="outline-text-4" id="text-3-12-24">
<p>
<a id="orgdb09de9">wp:f:register_nav_menus</a> used in <a href="#org6822133">wp:action:init</a> or <a href="#org55ee70d">wp:action:after_setup_theme</a>
<a href="https://codex.wordpress.org/Function_Reference/register_nav_menus">Register custom nav menus</a>
This is to create a theme location. Each theme location can have one menu created from wp-admin.
Menu created from wp-admin can associate with multiple theme locations.
The following registers 3 theme locations.
Other translation plugins like Polylang can create theme locations for each extra language based on the already defined theme locations.
</p>

<pre class="example">
function register_my_menus() {
  register_nav_menus(
    array(
      'main-menu' =&gt; __('Main Menu'),
      'about-menu' =&gt; __('About Menu'),
      'services-menu' =&gt; __('Services Menu')
    )
  );
}
</pre>

<p>
Display in template
<a href="https://developer.wordpress.org/reference/functions/wp_nav_menu/">https://developer.wordpress.org/reference/functions/wp_nav_menu/</a>
</p>
<pre class="example">
// already echo
wp_nav_menu( array( 'theme_location' =&gt; 'header-menu' ) );
</pre>
</div>
</div>

<div id="outline-container-org47f762a" class="outline-4">
<h4 id="org47f762a"><span class="section-number-4">3.12.25</span> register_widget <a id="org20b9c0b">wp:f:register_widget</a></h4>
<div class="outline-text-4" id="text-3-12-25">
<p>
Used in <a href="#org67f6a0c">wp:action:widgets_init</a>
System widgets wp-includes/widgets/class-wp-widget-*.php and they're registered at wp-includes/widgets.php
</p>

<pre class="example">
&lt;?php
// Register and load the widget
function wpb_load_widget() {
  register_widget( 'wpb_widget' );
}

add_action( 'widgets_init', 'wpb_load_widget' );

// Creating the widget 
class wpb_widget extends WP_Widget {

  function __construct() {
    // PHP 5.x
    //$this-&gt;WP_Widget( 'dokan-category-menu', 'Dokan: Product Category', $widget_ops );

    parent::__construct(

    // Base ID of your widget
      'wpb_widget',

      // Widget name will appear in UI
      __( 'WPBeginner Widget', 'wpb_widget_domain' ),

      // Widget description
      [ 'description' =&gt; __( 'Sample widget based on WPBeginner Tutorial', 'wpb_widget_domain' ), ]
    );
  }

  // Creating widget front-end

  public function widget( $args, $instance ) {
    $title = apply_filters( 'widget_title', $instance['title'] );

    // before and after widget arguments are defined by themes
    echo $args['before_widget'];
    if ( ! empty( $title ) ) {
      echo $args['before_title'] . $title . $args['after_title'];
    }

    // This is where you run the code and display the output
    echo __( 'Hello, World!', 'wpb_widget_domain' );
    echo $args['after_widget'];
  }

  // Widget Backend 
  public function form( $instance ) {
    if ( isset( $instance['title'] ) ) {
      $title = $instance['title'];
    } else {
      $title = __( 'New title', 'wpb_widget_domain' );
    }
    // Widget admin form
    ?&gt;
    &lt;p&gt;
      &lt;label
        for="&lt;?php echo $this-&gt;get_field_id( 'title' ); ?&gt;"&gt;&lt;?php _e( 'Title:' ); ?&gt;&lt;/label&gt;
      &lt;input class="widefat"
             id="&lt;?php echo $this-&gt;get_field_id( 'title' ); ?&gt;"
             name="&lt;?php echo $this-&gt;get_field_name( 'title' ); ?&gt;"
             type="text" value="&lt;?php echo esc_attr( $title ); ?&gt;"/&gt;
    &lt;/p&gt;
    &lt;?php
  }

  // Updating widget replacing old instances with new
  public function update( $new_instance, $old_instance ) {
    $instance          = [];
    $instance['title'] = ( ! empty( $new_instance['title'] ) ) ? strip_tags( $new_instance['title'] ) : '';

    return $instance;
  }
} // Class wpb_widget ends here


class MyNewWidget extends WP_Widget {

        function __construct() {
                // Instantiate the parent object

        }

        function widget( $args, $instance ) {
                // Widget output
        }

        function update( $new_instance, $old_instance ) {
                // Save widget options
        }

        function form( $instance ) {
                // Output admin widget options form
        }
}

function myplugin_register_widgets() {
        register_widget( 'MyNewWidget' );
}

add_action( 'widgets_init', 'myplugin_register_widgets' );
</pre>
</div>
</div>

<div id="outline-container-orgf7975a1" class="outline-4">
<h4 id="orgf7975a1"><span class="section-number-4">3.12.26</span> wpautop <a id="orgef67050">wp:f:wpautop</a></h4>
<div class="outline-text-4" id="text-3-12-26">
<p>
Used in <a href="#org384ba84">wp:filter:the_content</a> wp:filter:the_excerpt
Change double line-breaks in text into &lt;p&gt;&#x2026;&lt;/p&gt;
</p>

<p>
Turn off wpautop for specific pages
</p>
<pre class="example">
function remove_p_on_pages() {
    if ( is_page() ) {
        remove_filter( 'the_content', 'wpautop' );
        remove_filter( 'the_excerpt', 'wpautop' );

    }
}
add_action( 'wp_head', 'remove_p_on_pages' );
</pre>
</div>
</div>

<div id="outline-container-orgfc80ca9" class="outline-4">
<h4 id="orgfc80ca9"><span class="section-number-4">3.12.27</span> shortcode_unautop <a id="org878c855">wp:f:shortcode_unautop</a></h4>
<div class="outline-text-4" id="text-3-12-27">
<p>
Used in <a href="#org384ba84">wp:filter:the_content</a>
Ensure shortcodes are not wrapped in &lt;p&gt;&#x2026;&lt;/p&gt;
</p>

<p>
Refer to <a href="#org384ba84">wp:filter:the_content</a> <a href="#org149eafb">wp:filter:tiny_mce_before_init</a>
</p>

<pre class="example">
add_filter( 'the_content', 'shortcode_unautop'  );
</pre>
</div>
</div>

<div id="outline-container-orgcabe15a" class="outline-4">
<h4 id="orgcabe15a"><span class="section-number-4">3.12.28</span> show_admin_bar <a id="org9a7116a">wp:f:show_admin_bar</a></h4>
<div class="outline-text-4" id="text-3-12-28">
<p>
Use it in functions.php or <a href="#orgc76329c">wp:filter:show_admin_bar</a>
</p>
<pre class="example">
if ( ! current_user_can( 'manage_options' ) ) {
    show_admin_bar( false );
}
</pre>
</div>
</div>

<div id="outline-container-orgf0fcdf5" class="outline-4">
<h4 id="orgf0fcdf5"><span class="section-number-4">3.12.29</span> wp_get_image_editor</h4>
<div class="outline-text-4" id="text-3-12-29">
<p>
wp_get_image_editor( string $path, array $args = array() )
Returns WP_Error or <a href="https://developer.wordpress.org/reference/classes/wp_image_editor/">WP_Image_Editor</a>
</p>
<pre class="example">
function image_resize( $file, $max_w, $max_h, $crop = false, $suffix = null, $dest_path = null, $jpeg_quality = 90 ) {
    _deprecated_function( __FUNCTION__, '3.5.0', 'wp_get_image_editor()' );

    $editor = wp_get_image_editor( $file );
    if ( is_wp_error( $editor ) )
        return $editor;
    $editor-&gt;set_quality( $jpeg_quality );

    $resized = $editor-&gt;resize( $max_w, $max_h, $crop );
    if ( is_wp_error( $resized ) )
        return $resized;

    $dest_file = $editor-&gt;generate_filename( $suffix, $dest_path );
    $saved = $editor-&gt;save( $dest_file );

    if ( is_wp_error( $saved ) )
        return $saved;

    return $dest_file;
}
</pre>
</div>
</div>

<div id="outline-container-org360348c" class="outline-4">
<h4 id="org360348c"><span class="section-number-4">3.12.30</span> wp_reset_postdata <a id="org2b03e95">wp:f:wp_reset_postdata</a></h4>
<div class="outline-text-4" id="text-3-12-30">
<p>
After <code>global $post</code> is modified by <a href="#org654b03d">wp:query:secondary</a>, reset it to the original that was set by <a href="#orgbcfa6d5">wp:query:main</a>
</p>

<pre class="example">
&lt;?php
// example args
$args = array( 'posts_per_page' =&gt; 3 );

// the query
$the_query = new WP_Query( $args );
?&gt;

&lt;?php if ( $the_query-&gt;have_posts() ) : ?&gt;

        &lt;!-- start of the loop --&gt;
        &lt;?php while ( $the_query-&gt;have_posts() ) : $the_query-&gt;the_post(); ?&gt;
                &lt;?php the_title(); ?&gt;
                &lt;?php the_excerpt(); ?&gt;
        &lt;?php endwhile; ?&gt;&lt;!-- end of the loop --&gt;

        &lt;!-- put pagination functions here --&gt;
        &lt;?php wp_reset_postdata(); ?&gt;

&lt;?php else:  ?&gt;

&lt;p&gt;&lt;?php _e( 'Sorry, no posts matched your criteria.' ); ?&gt;&lt;/p&gt;

&lt;?php endif; ?&gt;
</pre>
</div>
</div>

<div id="outline-container-org1d644c5" class="outline-4">
<h4 id="org1d644c5"><span class="section-number-4">3.12.31</span> wp_reset_query <a id="org1c268d6">wp:f:wp_reset_query</a></h4>
<div class="outline-text-4" id="text-3-12-31">
<p>
Restore the $<a href="#orgb1cd342">wp_query</a> and global post data to the original main query.
Should be called after query_posts().
</p>

<p>
Avoid to use it. To alter main query parameters before it's made, use wp:filter:pre_get_posts
</p>

<pre class="example">
&lt;?php

$args = array ( 'post_parent' =&gt; 5 );
query_posts( $args );

if ( have_posts() ):
    while ( have_posts() ) :
        the_post();

        // Do stuff with the post content.
        the_title();
        the_permalink(); // Etc.

    endwhile;
else:
    // Insert any content or load a template for no posts found.
endif;

wp_reset_query();

?&gt;
</pre>
</div>
</div>

<div id="outline-container-org08a03a3" class="outline-4">
<h4 id="org08a03a3"><span class="section-number-4">3.12.32</span> update_post_meta</h4>
<div class="outline-text-4" id="text-3-12-32">
<p>
<a id="orgf5f6f3c">wp:f:update_post_meta</a>
</p>
</div>
</div>

<div id="outline-container-org476eb11" class="outline-4">
<h4 id="org476eb11"><span class="section-number-4">3.12.33</span> wp_enqueue_style, wp_style_add_data <a id="org6d3f0ae">wp:f:wp_enqueue_style</a> <a id="org1919e6f">wp:f:wp_style_add_data</a></h4>
<div class="outline-text-4" id="text-3-12-33">
<p>
Used in <a href="#orge50be40">wp:action:wp_enqueue_scripts</a>.
Use <a href="#org7f7f512">wp:filter:script_loader_src</a>
</p>

<p>
wp_enqueue_style( string $handle, string $src = '', array $deps = array(), string|bool|null $ver = false, string $media = 'all' )
</p>

<p>
$deps :: (array) (Optional) An array of registered stylesheet handles this stylesheet depends on.
         Default value: array()
</p>

<p>
$ver :: (string|bool|null) (Optional) String specifying stylesheet version number, if it has one, which is added to the URL as a query string for cache busting purposes. If version is set to false, a version number is automatically added equal to current installed WordPress version. If set to null, no version is added.
        Default value: false
</p>

<p>
$media :: (string) (Optional) The media for which this stylesheet has been defined. Accepts media types like 'all', 'print' and 'screen', or media queries like '(orientation: portrait)' and '(max-width: 640px)'.
          Default value: 'all'
</p>

<p>
Conditional statements are removed from IE 10 or IE 11. Refer to <a href="#org0eea7ac">css:font-face</a>
</p>

<pre class="example">
// Load the main stylesheet
        wp_enqueue_style( 'my-theme', get_stylesheet_uri() );

/**
 * Load our IE-only stylesheet for all versions of IE:
 * &lt;!--[if IE]&gt; ... &lt;![endif]--&gt;
 */
wp_enqueue_style( 'my-theme-ie', get_stylesheet_directory_uri() . "/css/ie.css", array( 'my-theme' ) );
wp_style_add_data( 'my-theme-ie', 'conditional', 'IE' );

/**
 * Load our IE version-specific stylesheet:
 * &lt;!--[if IE 7]&gt; ... &lt;![endif]--&gt;
 */
wp_enqueue_style( 'my-theme-ie7', get_stylesheet_directory_uri() . "/css/ie7.css", array( 'my-theme' ) );
wp_style_add_data( 'my-theme-ie7', 'conditional', 'IE 7' );

/**
 * Load our IE specific stylesheet for a range of older versions:
 * &lt;!--[if lt IE 9]&gt; ... &lt;![endif]--&gt;
 * &lt;!--[if lte IE 8]&gt; ... &lt;![endif]--&gt;
 * NOTE: You can use the 'less than' or the 'less than or equal to' syntax here interchangeably.
 */
wp_enqueue_style( 'my-theme-old-ie', get_stylesheet_directory_uri() . "/css/old-ie.css", array( 'my-theme' ) );
wp_style_add_data( 'my-theme-old-ie', 'conditional', 'lt IE 9' );

/**
 * Load our IE specific stylesheet for a range of newer versions:
 * &lt;!--[if gt IE 8]&gt; ... &lt;![endif]--&gt;
 * &lt;!--[if gte IE 9]&gt; ... &lt;![endif]--&gt;
 * NOTE: You can use the 'greater than' or the 'greater than or equal to' syntax here interchangeably.
 */
wp_enqueue_style( 'my-theme-new-ie', get_stylesheet_directory_uri() . "/css/new-ie.css", array( 'my-theme' ) );
wp_style_add_data( 'my-theme-ie', 'conditional', 'gt IE 8' );
</pre>
</div>
</div>

<div id="outline-container-orga334c1c" class="outline-4">
<h4 id="orga334c1c"><span class="section-number-4">3.12.34</span> wp_enqueue_script, wp_script_add_data <a id="org255d6b5">wp:f:wp_enqueue_script</a></h4>
<div class="outline-text-4" id="text-3-12-34">
<p>
Used in <a href="#orge50be40">wp:action:wp_enqueue_scripts</a>
Use <a href="#org94266fd">wp:filter:style_loader_src</a>
wp_enqueue_script( string $handle, string $src = '', array $deps = array(), string|bool|null $ver = false, bool $in_footer = false )
</p>

<pre class="example">
wp_enqueue_script( 'html5', get_theme_file_uri( '/assets/js/html5.js' ), array(), '3.7.3' );
wp_script_add_data( 'html5', 'conditional', 'lt IE 9' );
</pre>

<p>
When a script is added with dependency on jQuery, jQuery is auto loaded by wp. Change jQuery
</p>
<pre class="example">
wp_deregister_script('jquery');
wp_enqueue_script('jquery', 'https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js', array(), null, true);
wp_enqueue_script('my-custom-script', get_template_directory_uri() .'/js/my-custom-script.js', array('jquery'), null, true);
</pre>
</div>
</div>

<div id="outline-container-orgad706d7" class="outline-4">
<h4 id="orgad706d7"><span class="section-number-4">3.12.35</span> wp_localize_script</h4>
<div class="outline-text-4" id="text-3-12-35">
<p>
This must be called after the script has been registered using wp_register_script() or wp_enqueue_script()
It is used to define variables as an object.
</p>

<pre class="example">
wp_register_script('unique_handle', 'path/to/myscript.js' );

$translation_array = array(
  'some_string' =&gt; 'hello';
  'a_value' =&gt; '10'
);

// Pass vars in $translation_array to file path/to/myscript.js
wp_localize_script( 'unique_handle', 'object_name', $translation_array );
wp_enqueue_script( 'unique_handle' );

// Then you can use it in all enqueued javascript files
&lt;script&gt;
  console.log( object_name.some_string);
&lt;/script&gt;
</pre>

<p>
If you just want to define pass PHP variables and don't want to create empty js files
</p>
<pre class="example">
wp_localize_script( 'jquery', 'mynamesapce', array('ajaxurl' =&gt; admin_url( 'admin-ajax.php' ) ) );
</pre>

<pre class="example">
wp_enqueue_script( 'twentyseventeen-skip-link-focus-fix', get_theme_file_uri( '/assets/js/skip-link-focus-fix.js' ), array(), '1.0', true );
wp_localize_script( 'twentyseventeen-skip-link-focus-fix', 'twentyseventeenScreenReaderText', $twentyseventeen_l10n );
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf197a8b" class="outline-3">
<h3 id="orgf197a8b"><span class="section-number-3">3.13</span> Current URL, and slug <a id="org5e9fa90">wp:current url</a></h3>
<div class="outline-text-3" id="text-3-13">
<p>
Current URL on your website
<a id="orgbda1163">php:parse_url</a>
</p>
<pre class="example">
global $wp;
$current_url = home_url(add_query_arg(array(), $wp-&gt;request)); 
// echo esc_url($current_url);

$url = 'http://username:password@hostname:9090/path?arg=value#anchor';
$_url_array = parse_url($url); 
// keys are scheme, host, port, user, pass, path, query (after ?), fragment (after #)

if ($_url_array !== false &amp;&amp; !is_null($_url_array['host']) {}
</pre>

<p>
Slug
</p>
<pre class="example">
$_post = get_post();
if (!empty($_post) &amp;&amp; $_post-&gt;post_name == 'your-slug') {
  // do something
}
</pre>

<p>
Site url
</p>
<pre class="example">
// http://google.com without trailing slash
get_site_url();
</pre>
</div>
</div>

<div id="outline-container-orgcb45005" class="outline-3">
<h3 id="orgcb45005"><span class="section-number-3">3.14</span> WP_Post Post Object <a id="orgf6b0e20">wp:post</a></h3>
<div class="outline-text-3" id="text-3-14">
<p>
<a href="https://developer.wordpress.org/reference/classes/wp_post/">https://developer.wordpress.org/reference/classes/wp_post/</a>
</p>
</div>
</div>

<div id="outline-container-orgcce5aec" class="outline-3">
<h3 id="orgcce5aec"><span class="section-number-3">3.15</span> WP_User, user object <a id="orgc71c44a">wp:user</a></h3>
<div class="outline-text-3" id="text-3-15">
<p>
<a href="https://codex.wordpress.org/Class_Reference/WP_User">https://codex.wordpress.org/Class_Reference/WP_User</a>
</p>

<p>
Public properties
ID (int) - the user's ID.
caps (array) - the individual capabilities the user has been given.
cap_key (string) -
roles (array) - the roles the user is part of.
allcaps (array) - all capabilities the user has, including individual and role based.
first_name (string) - first name of the user.
last_name (string) - last name of the user.
</p>

<p>
Public Methods
has_cap :: has role name or capability
</p>

<pre class="example">
if ( is_user_logged_in() ) {
  $user = wp_get_current_user();
  // $user-&gt;ID public properties

  if ($user-&gt;has_cap('administrator')) {
    // user is admin
  }
} 
</pre>
</div>
</div>

<div id="outline-container-orgf799a92" class="outline-3">
<h3 id="orgf799a92"><span class="section-number-3">3.16</span> WP Custom Fields <a id="org28d778d">wp:Custom_Fields</a></h3>
<div class="outline-text-3" id="text-3-16">
</div>
<div id="outline-container-orgb5117fb" class="outline-4">
<h4 id="orgb5117fb"><span class="section-number-4">3.16.1</span> Get Custom Fields</h4>
<div class="outline-text-4" id="text-3-16-1">
<p>
Normal
</p>
<pre class="example">
print_r(get_post_custom_keys()); // Get all keys as an array
print_r(get_post_custom()); // Get keys and values as an array
print_r(get_post_custom_values('fieldkey')); // Get values as an array

// get all meta
$meta = get_post_meta(get_the_ID());
global $post;
echo get_post_meta($post-&gt;ID, 'my-ad', true);
</pre>

<p>
Plugin is different :: <a href="#org0b59abb">wp:plugin:types</a>
</p>
</div>
</div>

<div id="outline-container-org9abfc8e" class="outline-4">
<h4 id="org9abfc8e"><span class="section-number-4">3.16.2</span> Custom Fields in <a href="#org4df3ab4">WP_Meta_Query</a></h4>
<div class="outline-text-4" id="text-3-16-2">
<p>
Custom fields created by <a href="#orgb00414c">wp:plugin:acf</a> can use <a href="#org4df3ab4">WP_Meta_Query</a> as normal.
</p>

<p>
Custome fields creasted by <a href="#org0b59abb">wp:plugin:types</a>, like a set of checkboxes, in <a href="#orgb1cd342">WP_Query</a>, you should use the LIKE operator. 
Refer to <a href="#org28d05fc">WP Types Custom Field Checkbox and WP Meta Query</a>
</p>
</div>
</div>

<div id="outline-container-orged1685a" class="outline-4">
<h4 id="orged1685a"><span class="section-number-4">3.16.3</span> Create Custom Fields for Custom Post Type</h4>
<div class="outline-text-4" id="text-3-16-3">
<p>
Use <a href="#orgb00414c">wp:plugin:acf</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org5570f1b" class="outline-3">
<h3 id="org5570f1b"><span class="section-number-3">3.17</span> <a href="#orgb1cd342">WP_Query</a> The Loop <a id="orgbe729c9">wp:The_Loop</a> <a id="orgbcfa6d5">wp:query:main</a></h3>
<div class="outline-text-3" id="text-3-17">
<p>
The main query/loop is based on the URL request and is processed before templates are loaded
Only the <a href="#org96268f1">wp:conditional tags</a> use the main query/loop
</p>

<p>
<a id="org654b03d">wp:query:secondary</a>
</p>

<p>
The secondary query/loop is <code>new WP_Query</code> in theme template or plugin files. It's also caled The Loop.
<a href="#orga23f509">wp:template tags</a> use the secondary query/loop.
</p>

<p>
By default, The Loop uses the main query's current post to set global $post.
</p>

<p>
<code>new WP_Query()</code> and <code>the_post</code> (called in <code>have_posts()</code>) modify The Loop and hence global $post is modified. 
</p>

<p>
When these functions are used, you need to run <a href="#org2b03e95">wp:f:wp_reset_postdata</a> to reset global $post to the original.
</p>

<p>
Notice :: <code>new WP_Query()</code> doesn't change <a href="#orgbcfa6d5">wp:query:main</a>
</p>
</div>

<div id="outline-container-org353578a" class="outline-4">
<h4 id="org353578a"><span class="section-number-4">3.17.1</span> Syntax</h4>
<div class="outline-text-4" id="text-3-17-1">
<pre class="example">
&lt;?php 
 $query = new WP_Query('cat=-3,-8'); 
 // Use query_posts($query_array | $string) instead of creating a new WP_Query then you don't have to prefix $query for methods
 // But query_posts change the global $wp_query 
?&gt;

&lt;?php if ( $query-&gt;have_posts() ) : while ( $query-&gt;have_posts() ) : $query-&gt;the_post(); ?&gt;
 &lt;?php //  set the global $post to individual one in $query ?&gt;
 &lt;div&gt;&lt;?php the_content(); ?&gt;&lt;/div&gt;

 &lt;?php if ( has_post_thumbnail() ): ?&gt;
  &lt;img src="&lt;?php the_post_thumbnail_url('large'); ?&gt;"&gt;
  &lt;?php the_post_thumbnail(); ?&gt;
 &lt;?php endif; ?&gt;

&lt;?php endwhile; ?&gt;
&lt;?php wp_reset_postdata(); // set back global $post to original ?&gt;
&lt;?php endif; ?&gt;

&lt;?php $query-&gt;rewind_posts(); // in order to loop $query again ?&gt;
</pre>
</div>
</div>

<div id="outline-container-orgfad9ec2" class="outline-4">
<h4 id="orgfad9ec2"><span class="section-number-4">3.17.2</span> <a id="orgb1cd342">WP_Query</a></h4>
<div class="outline-text-4" id="text-3-17-2">
<p>
Generator: <a href="https://generatewp.com/wp_query/">https://generatewp.com/wp_query/</a>
</p>

<p>
Use: <a href="#org4df3ab4">WP_Meta_Query</a>, <a href="#org958fd5e">WP Tax Query</a>, <a href="#org9e1f16c">WP Order and Orderby</a>
Use filters: 
</p>
<ul class="org-ul">
<li><a href="#org7c52e9b">wp:filter:post_limits</a></li>
<li>pre_option_posts_per_rss <a href="#org838fa34">wp:filter:pre_option</a></li>
<li><a href="#org9728fe9">wp:filter:posts_clauses</a></li>
</ul>
<p>
Use actions: <a href="#orgbd389b2">wp:action:pre_get_posts</a>
</p>

<pre class="example">
$args = array(
 'post_type' =&gt; array('editorial', 'blog'), // blog or editorial
 'post_status' =&gt; array('publish'),
 'posts_per_page' =&gt; -1, // int. -1 shows all posts. Doesn't work in feed (Default 10). Use wp:filter:post_limits
 'meta_query' =&gt; $meta_query, // $meta_query is a nested array parsed by WP_Meta_Query
 'tax_query' =&gt; $tax_query,
 'order' =&gt; 'DESC', // default, 'ASC'
 'orderby' =&gt; 'date', // default, which is post_date. Others are publish_date
);

$query = new WP_Query($args);
</pre>
</div>
</div>

<div id="outline-container-orgeac9585" class="outline-4">
<h4 id="orgeac9585"><span class="section-number-4">3.17.3</span> <a id="org4df3ab4">WP_Meta_Query</a></h4>
<div class="outline-text-4" id="text-3-17-3">
</div>
<div id="outline-container-org7596858" class="outline-5">
<h5 id="org7596858"><span class="section-number-5">3.17.3.1</span> Fields for <a href="#orgb1cd342">WP_Query</a></h5>
<div class="outline-text-5" id="text-3-17-3-1">
<p>
Use these fields directly in <a href="#orgb1cd342">WP_Query</a>
</p>
</div>
</div>

<div id="outline-container-orgf6ffc55" class="outline-5">
<h5 id="orgf6ffc55"><span class="section-number-5">3.17.3.2</span> Nesting</h5>
<div class="outline-text-5" id="text-3-17-3-2">
<p>
Nested: key1=value1 OR (key2=value2 AND key3=value3)
</p>

<pre class="example">
$meta_args = array(
 'relation' =&gt; 'OR', // Optional.
 array(
   'key' =&gt; 'key1',
   'value' =&gt; 'value1',
   'compare' =&gt; '=', //default
 ),

 array(
   'relation' =&gt; 'AND',
   array(
     'key' =&gt; 'key2',
     'value' =&gt; 'value2',
     'compare' =&gt; '=',
   ),
   array(
     'key' =&gt; 'key3',
     'value' =&gt; 'value3',
     'compare' =&gt; '=',
   ),
 ),

);

$meta_query = new WP_Meta_Query($meta_args); // parse args array

</pre>
</div>
</div>

<div id="outline-container-orgadded40" class="outline-5">
<h5 id="orgadded40"><span class="section-number-5">3.17.3.3</span> Operators</h5>
<div class="outline-text-5" id="text-3-17-3-3">
<p>
compare
</p>
<ul class="org-ul">
<li><code>, !</code></li>
<li>&gt;, &gt;=, &lt;, &lt;=</li>
<li>LIKE, NOT LIKE</li>
<li>IN, NOT IN</li>
<li>BETWEEN, NOT BETWEEN</li>
<li>EXISTS, NOT EXISTS</li>
<li id="REGEXP, NOT REGEXP"><a href="#org48be5c2">MySQL REGEX</a></li>
<li>RLIKE (synonym of REGEXP)</li>
</ul>

<p>
type 
In MySQL, it means CAST(the field, to a type)
</p>
<ul class="org-ul">
<li>NUMERIC</li>
<li>BINARY</li>
<li>CHAR</li>
<li id="DATE">works with 'compare' value BETWEEN only if the date is stored as YYYY-MM-DD</li>
<li>DATETIME</li>
<li>DECIMAL</li>
<li id="SIGNED, UNSIGNED"><a href="#org217f492">MySQL Integer</a></li>
<li id="TIME"><a href="#org1295bee">MySQL Date and Time</a></li>
</ul>

<p>
<a id="org28d05fc">WP Types Custom Field Checkbox and WP Meta Query</a>
Say the wpcf-newsletters custom field created by WP Types has 2 checkboxes are selected: enligne and pw.
The following 2 strings will appear in the serialized json string as value in <a href="#org4df3ab4">WP_Meta_Query</a>
</p>
<pre class="example">
a:1:{i:0;s:7:"enligne";}
a:1:{i:0;s:2:"pw";}
</pre>

<p>
Select the posts that have checkbox enligne checked.
</p>
<pre class="example">
$meta_query = array(
 array(
  'key' =&gt; 'wpcf-newsletters',
  'value' =&gt; 'a:1:{i:0;s:7:"enligne";}',
  'compare' =&gt; 'LIKE',
 ),
);
</pre>
</div>
</div>
</div>

<div id="outline-container-org8968dff" class="outline-4">
<h4 id="org8968dff"><span class="section-number-4">3.17.4</span> <a id="org958fd5e">WP Tax Query</a></h4>
<div class="outline-text-4" id="text-3-17-4">
<pre class="example">
$tax_query = array(
 'relation' =&gt; 'AND', // Optional 
 array(),
 array(
   'taxonomy' =&gt; '',
   'field' =&gt; 'term_id', // string :: term_id (default), name, slug or term_taxonomy_id
   'terms' =&gt; 'bob', // int/string/array :: multiple terms
   'operator' =&gt; 'IN', // string :: IN (default), NOT IN, AND, EXISTS, NOT EXISTS
 ),
);
</pre>
</div>
</div>

<div id="outline-container-org3d5f801" class="outline-4">
<h4 id="org3d5f801"><span class="section-number-4">3.17.5</span> <a id="org9e1f16c">WP Order and Orderby</a></h4>
<div class="outline-text-4" id="text-3-17-5">
<p>
2 parameters: order and orderby. They are strings not arrays.
</p>
</div>

<div id="outline-container-orgf96afc6" class="outline-5">
<h5 id="orgf96afc6"><span class="section-number-5">3.17.5.1</span> order</h5>
<div class="outline-text-5" id="text-3-17-5-1">
<dl class="org-dl">
<dt>DESC</dt><dd>default</dd>
<dt>(no term)</dt><dd>ASC</dd>
</dl>
</div>
</div>

<div id="outline-container-org42f79ae" class="outline-5">
<h5 id="org42f79ae"><span class="section-number-5">3.17.5.2</span> orderby</h5>
<div class="outline-text-5" id="text-3-17-5-2">
<dl class="org-dl">
<dt>date</dt><dd>default, which is post_date</dd>
<dt>modified</dt><dd>modified date</dd>
<dt>ID</dt><dd>post id</dd>
<dt>parent</dt><dd>parent id</dd>
<dt>rand</dt><dd>random order</dd>
<dt>(no term)</dt><dd>comment_count</dd>
<dt>(no term)</dt><dd>author</dd>
<dt>(no term)</dt><dd>title</dd>
<dt>name</dt><dd>post name post slug</dd>
<dt>type</dt><dd>post type</dd>
</dl>
<p>
List goes on&#x2026;
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org4e8a10b" class="outline-3">
<h3 id="org4e8a10b"><span class="section-number-3">3.18</span> RSS</h3>
<div class="outline-text-3" id="text-3-18">
<p>
<a href="#org48505a2">wp:f:get_template_part</a> includes any template in child theme
</p>

<pre class="example">
function lili_RSS() {
 add_feed('lili-editorial', 'lili_editorial_RSS');
}
add_action('init', 'lili_editorial_RSS');
function lili_editorial_RSS() {
 get_template_part('rss','feedname');
 // rss is slug and feedname is an extra name
 // Search in order
 // /themes/child/rss-feedname.php
 // /themes/parent/rss-feedname.php
 // /themes/child/rss.php
 // /themes/parent/rss.php

 // the feed url is http://you.com/feed/lili-editorial which is the feed name defined in add_feed
}
</pre>

<p>
Default template /wp-includes/feed-rss2.php
Functions to use in The Loop: /wp-includes/feed.php
</p>

<pre class="example">
&lt;?php
$args = array(
        'post_type' =&gt; array('blog'), // e.g. any
        'tag' =&gt; 'editors-choice',
        'orderby' =&gt; 'date', // Default. e.g. title
        'order' =&gt; 'DESC', // Default. e.g. ASC
);
?&gt;
query_posts($args);
&lt;?php while (have_posts()) : the_post(); ?&gt;
&lt;item&gt;
  &lt;title&gt;&lt;?php the_title_rss(); ?&gt;&lt;/title&gt;
  &lt;?php if (has_post_thumbnail($post-&gt;ID)) : ?&gt;
  &lt;?php
    $image = wp_get_attachment_image_src(
    get_post_thumbnail_id( $post-&gt;ID ),
    'thumbnail'
    );
  ?&gt;
  &lt;feature_image&gt;&lt;?php echo $image[0]; ?&gt;&lt;/feature_image&gt;
  &lt;?php endif; ?&gt;
  &lt;pubDate&gt;&lt;?php echo mysql2date('D, d M Y H:i:s +0000',
                                get_post_time('Y-m-d H:i:s', true),
                                false); ?&gt;&lt;/pubDate&gt;
  &lt;?php // Text Version ?&gt;
  &lt;excerpt&gt;&lt;![CDATA[&lt;&lt;?php echo get_the_exerpt(); ?&gt;]]&gt;&lt;/excerpt&gt;
  &lt;excerpt_html&gt;&lt;![CDATA[&lt;&lt;?php echo the_exerpt_rss(); ?&gt;]]&gt;&lt;/excerpt_html&gt;
  &lt;?php echo the_category_rss('rss2'); // categories and tags ?&gt;
&lt;/item&gt;  
&lt;?php endwhile; ?&gt;
</pre>
</div>
</div>

<div id="outline-container-org445e891" class="outline-3">
<h3 id="org445e891"><span class="section-number-3">3.19</span> Default filters and actions</h3>
<div class="outline-text-3" id="text-3-19">
<p>
<a id="org49b1cf6">wp:default filters</a> wp-includes/default-filters.php
</p>
</div>
</div>

<div id="outline-container-orgafee97b" class="outline-3">
<h3 id="orgafee97b"><span class="section-number-3">3.20</span> add_filter</h3>
<div class="outline-text-3" id="text-3-20">
</div>
<div id="outline-container-orgbae279f" class="outline-4">
<h4 id="orgbae279f"><span class="section-number-4">3.20.1</span> Syntax, remove_filter</h4>
<div class="outline-text-4" id="text-3-20-1">
<p>
Modify internal data / function returned
</p>

<p>
For example, <a href="#orgb1cd342">WP_Query</a> gets internal settings for building a query.
You can temporary add_filter to change the internal settings, then build a <a href="#orgb1cd342">WP_Query</a>, later remove_filter 
so that you only change the internal setting for that query building without affecting other usage.  
</p>

<p>
add_filter( 
 'tagname', 
 'lili_funct',
  10, <i>/ int. Priority, lower number sooner
  2, /</i> int. Accepted args, default is 1! Be careful
)
</p>

<p>
apply_filters( 'tagname', $result, $var1);
</p>

<p>
// callback should take 2 variables
function lili_funct($result, $var1) {
 $new = $result . 'abc';
 return $new;
}
</p>

<p>
remove_filter(
  'tagname',
  'lili_funct',
  10 // priority, must match the add_filter priority, default is 10
)
</p>

<pre class="example">
function remove_filter_the_title() {
        remove_filter('the_title', 'before_post_title', 10);
}
add_action( 'wp_head', 'remove_filter_the_title', 1 );

function add_filter_the_title() {
        add_filter('the_title', 'before_post_title', 10, 2);
}
add_action( 'wp_head', 'add_filter_the_title', 3 );
</pre>
</div>
</div>

<div id="outline-container-org87f3f28" class="outline-4">
<h4 id="org87f3f28"><span class="section-number-4">3.20.2</span> post_limits <a id="org7c52e9b">wp:filter:post_limits</a></h4>
<div class="outline-text-4" id="text-3-20-2">
<p>
For feed, use pre_option_posts_per_rss <a href="#org838fa34">wp:filter:pre_option</a>
</p>

<p>
function lili_f_post_limits($limit, $query) {
 return 'LIMIT 0, 25';
 return $limit;
}
</p>
</div>
</div>

<div id="outline-container-org5054d6a" class="outline-4">
<h4 id="org5054d6a"><span class="section-number-4">3.20.3</span> posts_clauses <a id="org9728fe9">wp:filter:posts_clauses</a></h4>
<div class="outline-text-4" id="text-3-20-3">
<p>
Modify <a href="#orgb1cd342">WP_Query</a> object before it runs
</p>
<pre class="example">
function lili_posts_clauses($clauses, $query) {
  /*
  $clauses =&gt; [
    'where' =&gt; '...',
    'groupby' =&gt; '',
    'join' =&gt; '',
    'orderby' =&gt; 'wp_posts.post_date DESC',
    'distinct' =&gt; '',
    'fields' =&gt; 'wp_posts.*',
    'limits' =&gt; 'LIMIT 0, 20',
  ]
  $query is WP_Query object
  */
  // Identify a certain WP_Query
  $_s = lili_request_cache('trigger_posts_clauses');
  if ($_s == 'situationA') {
    $_old = $clauses['where'];
    $clauses['orderby'] = '';
    $_limit = explode(",",$clauses['limits']);
    $clauses['limits']='';
    $_limit_feature = end($_limit) - 3;
    reset($_limit);
    $_features_and_news = &lt;&lt;&lt;SQL
SELECT * FROM
(SELECT p2.ID
FROM wp_posts p2
WHERE p2.post_type IN ('en-vedette')
ORDER BY p2.post_date DESC
LIMIT {$_limit_feature}
) AS sq1

UNION

SELECT * FROM
(SELECT p2.ID
FROM wp_posts p2
INNER JOIN wp_term_relationships tr ON tr.object_id = p2.ID
INNER JOIN wp_terms t ON t.term_id = tr.term_taxonomy_id
WHERE p2.post_type = 'nouvelles' AND t.slug = 'homepage-3-squares'
ORDER BY p2.post_date DESC
LIMIT 3) AS sq2
SQL;
    $clauses['where'] = $_old." AND wp_posts.ID IN ($_features_and_news)";
    // reset cache
    lili_request_cache('trigger_posts_clauses', '');
  }

  return $clauses;
}
</pre>
</div>
</div>

<div id="outline-container-org7a35062" class="outline-4">
<h4 id="org7a35062"><span class="section-number-4">3.20.4</span> page_link</h4>
<div class="outline-text-4" id="text-3-20-4">
<p>
<a id="org9d84365">wp:filter:page_link</a> =&gt; get_permalink
</p>

<pre class="example">
// When set to true, a structural link will be returned, rather than the actual URI. Example: http://www.example.com/%postname% 
// instead of http://www.example.com/my-post

function append_query_string( $url, $post, $leavename=false ) {

  if ( $post-&gt;post_type == 'post' ) {
    $url = add_query_arg( 'foo', 'bar', $url );
  }
  return $url;
}
add_filter( 'post_link', 'append_query_string', 10, 3 );
</pre>
</div>
</div>

<div id="outline-container-orgf117955" class="outline-4">
<h4 id="orgf117955"><span class="section-number-4">3.20.5</span> url_to_postid</h4>
<div class="outline-text-4" id="text-3-20-5">
<p>
url_to_postid can take full url. But it may not work for custom post type even though get_permalink and rewrite works.
</p>

<p>
When URL has url parameter p or other special parameters, it will directly return the post id.
</p>

<pre class="example">
echo url_to_postid(get_permalink()); // the current post id.

function lili_get_post_id($custom_permalink) {
  global $wpdb;
  $post_id = $wpdb-&gt;get_col($wpdb-&gt;prepare("SELECT post_id FROM $wpdb-&gt;postmeta WHERE meta_key= 'custom_permalink' AND meta_value = '%s';", $custom_permalink ));
  return $post_id[0];
}

function lili_url_to_postid($url) {
  $url_parse = wp_parse_url($url);
  if ($url_parse !== false &amp;&amp; !empty($url_parse['path'])) {
    $post_id = lili_get_post_id(ltrim(strtolower($url_parse['path']), '/'));
    if ($post_id) {
      $post_id = (int) $post_id;
      return '?p='.$post_id;
    }
  }
  return $url;
}
add_filter( 'url_to_postid', 'lili_url_to_postid', 10, 1);
</pre>
</div>
</div>

<div id="outline-container-org40a0e45" class="outline-4">
<h4 id="org40a0e45"><span class="section-number-4">3.20.6</span> pre_option_(option_name)</h4>
<div class="outline-text-4" id="text-3-20-6">
<p>
<a id="org838fa34">wp:filter:pre_option</a>
Temporarily alter an option without changing in database.
</p>
</div>
</div>

<div id="outline-container-orgeb63f64" class="outline-4">
<h4 id="orgeb63f64"><span class="section-number-4">3.20.7</span> template_include <a id="org93d7a17">wp:filter:template_include</a></h4>
<div class="outline-text-4" id="text-3-20-7">
<pre class="example">
function pubx_cuw_template_include($template) {
  global $wp;
  try {
    $_url = explode('/',$wp-&gt;request);
    if (!empty($_url) &amp;&amp; count($_url) == 3) {
      $adunit=$_url[1];
      $adsize=$_url[2];
      $dfp = array(
        'em_CUW_BB_1' =&gt; ['95740733/'.$adunit, '300x250'],
        'em_CUW_BB_2' =&gt; ['95740733/'.$adunit, '300x250'],
        'em_CUW_BB_3' =&gt; ['95740733/'.$adunit, '300x250'],
        'em_CUW_LB_1' =&gt; ['95740733/'.$adunit, $adsize], // 640x90, 300x90
        'em_CUW_LB_2' =&gt; ['95740733/'.$adunit, $adsize], // 640x90, 300x90
      );

      if (isset($dfp[$adunit]) &amp;&amp; strlen($adsize) &lt; 10) {
        $_ad_unit = $dfp[$adunit][0];
        $_ad_size = $dfp[$adunit][1];
        $htmlFile = &lt;&lt;&lt;HTML
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
&lt;title&gt;Canadian Underwriter Partnership&lt;/title&gt;
&lt;script src="//code.jquery.com/jquery-1.10.2.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;script&gt;
    var rnd=Math.floor(Math.random() * (999999 - 10 +1)) + 10;
    var theUrl="//pubads.g.doubleclick.net/gampad/adx?iu=/{$_ad_unit}&amp;sz={$_ad_size}&amp;c=" + rnd;
    var xmlHttp = null;
    xmlHttp = new XMLHttpRequest();
    xmlHttp.open( "GET", theUrl );
    xmlHttp.send();
    xmlHttp.onreadystatechange = function() {
      if (xmlHttp.readyState==4 &amp;&amp; xmlHttp.status==200) {
        var xmlDoc = $.parseHTML( xmlHttp.response );
        var adlink = $(xmlDoc).find('a').attr('href');
        if (typeof adlink == "undefined") adlink = "//www.example.com";
        window.location = adlink;
      }
    }
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
HTML;

        global $wp_query;
        $wp_query-&gt;is_404 = false;
        status_header(200);
        echo $htmlFile;
        $new_template = locate_template( ['empty_page.php'] );
        return $new_template;
      }
    }
    elseif (other_situation) {
      // you can just flush a buffer or output something 
      // then set some headers
      // and a response code
      // then exit();
    }
  }
  catch (Exception $e) {
    return $template;
  }

  return $template;

}
add_filter('template_include', 'pubx_cuw_template_include',99);
</pre>
</div>
</div>

<div id="outline-container-orga945192" class="outline-4">
<h4 id="orga945192"><span class="section-number-4">3.20.8</span> flush_rewrite_rules_hard <a id="org9f0e8ec">wp:filter:flush_rewrite_rules_hard</a></h4>
<div class="outline-text-4" id="text-3-20-8">
<p>
Stop wp to modify .htaccess inside the Wordpress block
</p>
<pre class="example">
add_filter( 'flush_rewrite_rules_hard', '__return_false' );

// __return_false is a wp function

// remove the filter 
remove_filter( 'flush_rewrite_rules_hard', 'filter_flush_rewrite_rules_hard', 10, 1 ); 
</pre>
</div>
</div>

<div id="outline-container-org49aca44" class="outline-4">
<h4 id="org49aca44"><span class="section-number-4">3.20.9</span> tiny_mce_before_init <a id="org149eafb">wp:filter:tiny_mce_before_init</a></h4>
<div class="outline-text-4" id="text-3-20-9">
<p>
<a href="https://codex.wordpress.org/Plugin_API/Filter_Reference/tiny_mce_before_init">Change TinyMCE settings</a>
<a href="https://codex.wordpress.org/TinyMCE">https://codex.wordpress.org/TinyMCE</a> Default setting
<a href="https://www.tinymce.com/docs/configure/">https://www.tinymce.com/docs/configure/</a>
</p>

<div class="org-src-container">
<pre class="src src-php">add_filter( <span style="color: #e67128;">'tiny_mce_before_init'</span>, <span style="color: #e67128;">'myformatTinyMCE'</span> );
<span style="color: #ffad29; font-weight: bold;">function</span> <span style="color: #00ede1; font-weight: bold;">myformatTinyMCE</span>( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">in</span> ) {
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">in</span>[<span style="color: #e67128;">'wordpress_adv_hidden'</span>] = <span style="color: #008b8b;">FALSE</span>; <span style="color: #74af68;">// </span><span style="color: #74af68;">enable advanced edit mode</span>

  <span style="color: #74af68;">//</span><span style="color: #74af68;">region elements that are not included will be removed. Add all elements.</span>
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">opts</span> = <span style="color: #e67128;">'*[*]'</span>;
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">in</span>[<span style="color: #e67128;">'valid_elements'</span>] = <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">opts</span>;
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">in</span>[<span style="color: #e67128;">'extended_valid_elements'</span>] = <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">opts</span>;
  <span style="color: #74af68;">//</span><span style="color: #74af68;">endregion</span>

  <span style="color: #74af68;">//</span><span style="color: #74af68;">region To ensure p tag is not removed when switching between Visual and Text modes</span>
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">in</span>[<span style="color: #e67128;">'wpautop'</span>] = <span style="color: #008b8b;">false</span>;
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">in</span>[<span style="color: #e67128;">'indent'</span>] = <span style="color: #008b8b;">true</span>;
  <span style="color: #74af68;">//</span><span style="color: #74af68;">endregion</span>

  <span style="color: #74af68;">//</span><span style="color: #74af68;">region p tag will not be added for any new line.</span>
  <span style="color: #74af68;">// </span><span style="color: #74af68;">To create a paragraph in Visual mode, Shift+Enter. Otherwise, enter will simply create a &lt;br&gt;</span>
  <span style="color: #74af68;">// </span><span style="color: #74af68;">This helps TinyMCE wraps shortcode on any line with p tag.</span>
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">in</span>[<span style="color: #e67128;">'force_p_newlines'</span>] = <span style="color: #008b8b;">false</span>;
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">in</span>[<span style="color: #e67128;">'forced_root_block'</span>] = <span style="color: #e67128;">''</span>;
  <span style="color: #74af68;">//</span><span style="color: #74af68;">endregion</span>

  <span style="color: #ffad29; font-weight: bold;">return</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">in</span>;
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org23fb668" class="outline-4">
<h4 id="org23fb668"><span class="section-number-4">3.20.10</span> the_content <a id="org384ba84">wp:filter:the_content</a></h4>
<div class="outline-text-4" id="text-3-20-10">
<p>
Refer to <a href="#org878c855">wp:f:shortcode_unautop</a> <a href="#orgef67050">wp:f:wpautop</a> <a href="#org149eafb">wp:filter:tiny_mce_before_init</a>
Change the content of the post after retrieved from db and before it's printed to the screen.
<a href="https://codex.wordpress.org/Plugin_API/Filter_Reference/the_content">Doc</a>
</p>
<pre class="example">
add_filter( 'the_content', 'wpautop');
// remove_filter( 'the_content', 'wpautop');
add_filter( 'the_content', 'shortcode_unautop'  );
</pre>
</div>
</div>

<div id="outline-container-orgf6b6bee" class="outline-4">
<h4 id="orgf6b6bee"><span class="section-number-4">3.20.11</span> upload_mimes <a id="org0c41fdf">wp:filter:upload_mimes</a></h4>
<div class="outline-text-4" id="text-3-20-11">
<p>
Add mime type so that wp can handle its content-type header to browser for upload and sending.
</p>
<pre class="example">
function cc_mime_types($mimes) {
  $mimes['svg'] = 'image/svg+xml';
  return $mimes;
}
add_filter('upload_mimes', 'cc_mime_types');
</pre>
</div>
</div>

<div id="outline-container-orgd6c616a" class="outline-4">
<h4 id="orgd6c616a"><span class="section-number-4">3.20.12</span> widget_text <a id="org313252b">wp:filter:widget_text</a></h4>
<div class="outline-text-4" id="text-3-20-12">
<p>
Display <a href="#org7ee2ec1">wp:f:add_shortcode</a> in widget. Filter content output
</p>

<pre class="example">
function exam_plug_text_replace($content) {
  $new_content = '';
  $new_content.= $content . ':)';
  return $new_content;
}
add_filter('widget_text', 'exam_plug_text_replace');
</pre>
</div>
</div>

<div id="outline-container-org13cf7de" class="outline-4">
<h4 id="org13cf7de"><span class="section-number-4">3.20.13</span> sidebars_widgets <a id="org894c5be">wp:filter:sidebars_widgets</a></h4>
<div class="outline-text-4" id="text-3-20-13">
<p>
Filters the list of sidebars and their widgets. Changing this will change the widget registeration on db.
</p>
<pre class="example">
function disable_all_widgets($sidebars_widgets) {
  //var_dump($sidebars_widgets);
  // disable all widget areas
  // $sidebars_widgets = array(false);
  $sidebars_widgets['sidebar-id-1'] = ['widget_name-1'];
  return $sidebars_widgets;
}
add_filter('sidebars_widgets', 'disable_all_widgets');
</pre>

<p>
In order to have an instance of a widget, the easiest way is to create another sidebar with the widget in wp-admin
</p>
</div>
</div>

<div id="outline-container-org14aad39" class="outline-4">
<h4 id="org14aad39"><span class="section-number-4">3.20.14</span> show_admin_bar <a id="orgc76329c">wp:filter:show_admin_bar</a></h4>
<div class="outline-text-4" id="text-3-20-14">
<p>
<a href="#org9a7116a">wp:f:show_admin_bar</a>
</p>
<pre class="example">
add_filter('show_admin_bar', '__return_false');
</pre>
</div>
</div>

<div id="outline-container-orge330183" class="outline-4">
<h4 id="orge330183"><span class="section-number-4">3.20.15</span> excerpt_more</h4>
<div class="outline-text-4" id="text-3-20-15">
<p>
Default is  echo '[…]'
</p>

<pre class="example">
function twentyseventeen_excerpt_more( $link ) {
        if ( is_admin() ) {
                return $link;
        }

        $link = sprintf( '&lt;p class="link-more"&gt;&lt;a href="%1$s" class="more-link"&gt;%2$s&lt;/a&gt;&lt;/p&gt;',
                esc_url( get_permalink( get_the_ID() ) ),
                /* translators: %s: Name of current post */
                sprintf( __( 'Continue reading&lt;span class="screen-reader-text"&gt; "%s"&lt;/span&gt;', 'twentyseventeen' ), get_the_title( get_the_ID() ) )
        );
        return ' &amp;hellip; ' . $link;
}
add_filter( 'excerpt_more', 'twentyseventeen_excerpt_more' );
</pre>
</div>
</div>

<div id="outline-container-org48bd914" class="outline-4">
<h4 id="org48bd914"><span class="section-number-4">3.20.16</span> wp_calculate_image_sizes</h4>
<div class="outline-text-4" id="text-3-20-16">
<p>
wp_calculate_image_sizes( array|string $size, string $image_src = null, array $image_meta = null, int $attachment_id )
</p>

<p>
Creates a ‘sizes’ attribute value for an image. <a href="#org36aa389">html:img:srcset</a> <a href="#org1b1c640">html:img:sizes</a>
</p>

<pre class="example">
function twentyseventeen_content_image_sizes_attr( $sizes, $size ) {
        $width = $size[0];

        if ( 740 &lt;= $width ) {
                $sizes = '(max-width: 706px) 89vw, (max-width: 767px) 82vw, 740px';
        }

        if ( is_active_sidebar( 'sidebar-1' ) || is_archive() || is_search() || is_home() || is_page() ) {
                if ( ! ( is_page() &amp;&amp; 'one-column' === get_theme_mod( 'page_options' ) ) &amp;&amp; 767 &lt;= $width ) {
                         $sizes = '(max-width: 767px) 89vw, (max-width: 1000px) 54vw, (max-width: 1071px) 543px, 580px';
                }
        }

        return $sizes;
}
add_filter( 'wp_calculate_image_sizes', 'twentyseventeen_content_image_sizes_attr', 10, 2 );
</pre>
</div>
</div>

<div id="outline-container-orgdbd8ae0" class="outline-4">
<h4 id="orgdbd8ae0"><span class="section-number-4">3.20.17</span> wp_resource_hints</h4>
<div class="outline-text-4" id="text-3-20-17">
<p>
apply_filters( 'wp_resource_hints', array $urls, string $relation_type )
</p>

<p>
relation_type :: dns-prefetch, preconnect, prefetch, and prerender
</p>

<p>
<a href="https://make.wordpress.org/core/2016/07/06/resource-hints-in-4-6/">https://make.wordpress.org/core/2016/07/06/resource-hints-in-4-6/</a>
</p>

<pre class="example">
function twentyseventeen_resource_hints( $urls, $relation_type ) {
        if ( wp_style_is( 'twentyseventeen-fonts', 'queue' ) &amp;&amp; 'preconnect' === $relation_type ) {
                $urls[] = array(
                        'href' =&gt; 'https://fonts.gstatic.com',
                        'crossorigin',
                );
        }

        return $urls;
}
add_filter( 'wp_resource_hints', 'twentyseventeen_resource_hints', 10, 2 );
</pre>
</div>
</div>

<div id="outline-container-org1f0081f" class="outline-4">
<h4 id="org1f0081f"><span class="section-number-4">3.20.18</span> script_loader_src style_loader_src <a id="org7f7f512">wp:filter:script_loader_src</a> <a id="org94266fd">wp:filter:style_loader_src</a></h4>
<div class="outline-text-4" id="text-3-20-18">
<p>
Remove current site url from script and style files
</p>
<pre class="example">
add_filter( 'script_loader_src', 'wpse47206_src' );
add_filter( 'style_loader_src', 'wpse47206_src' );
function wpse47206_src( $url ) {
        if( is_admin() ) return $url;
        return str_replace( site_url(), '', $url );
}
</pre>
</div>
</div>

<div id="outline-container-org27b6eb1" class="outline-4">
<h4 id="org27b6eb1"><span class="section-number-4">3.20.19</span> get_header_image_tag</h4>
<div class="outline-text-4" id="text-3-20-19">
<p>
apply_filters( 'get_header_image_tag', string $html, object $header, array $attr )
</p>
<pre class="example">
function twentyseventeen_header_image_tag( $html, $header, $attr ) {
        if ( isset( $attr['sizes'] ) ) {
                $html = str_replace( $attr['sizes'], '100vw', $html );
        }
        return $html;
}
add_filter( 'get_header_image_tag', 'twentyseventeen_header_image_tag', 10, 3 );
</pre>

<p>
In template
</p>
<pre class="example">
&lt;img src="&lt;?php header_image(); ?&gt;" height="&lt;?php echo get_custom_header()-&gt;height; ?&gt;" width="&lt;?php echo get_custom_header()-&gt;width; ?&gt;" alt="" /&gt;
</pre>
</div>
</div>

<div id="outline-container-org75d1dbf" class="outline-4">
<h4 id="org75d1dbf"><span class="section-number-4">3.20.20</span> wp_get_attachment_image_attributes</h4>
<div class="outline-text-4" id="text-3-20-20">
<p>
apply_filters( 'wp_get_attachment_image_attributes', array $attr, WP_Post $attachment, string|array $size )
</p>

<p>
$attr :: (array) Attributes for the image markup.
</p>

<p>
$attachment :: (WP_Post) Image attachment post.
</p>

<p>
$size :: (string|array) Requested size. Image size or array of width and height values (in that order). Default 'thumbnail'.
</p>

<pre class="example">
function twentyseventeen_post_thumbnail_sizes_attr( $attr, $attachment, $size ) {
        if ( is_archive() || is_search() || is_home() ) {
                $attr['sizes'] = '(max-width: 767px) 89vw, (max-width: 1000px) 54vw, (max-width: 1071px) 543px, 580px';
        } else {
                $attr['sizes'] = '100vw';
        }

        return $attr;
}
add_filter( 'wp_get_attachment_image_attributes', 'twentyseventeen_post_thumbnail_sizes_attr', 10, 3 );
</pre>
</div>
</div>

<div id="outline-container-orgb1afbf2" class="outline-4">
<h4 id="orgb1afbf2"><span class="section-number-4">3.20.21</span> widget_tag_cloud_args</h4>
<div class="outline-text-4" id="text-3-20-21">
<pre class="example">
function twentyseventeen_widget_tag_cloud_args( $args ) {
        $args['largest']  = 1;
        $args['smallest'] = 1;
        $args['unit']     = 'em';
        $args['format']   = 'list';

        return $args;
}
add_filter( 'widget_tag_cloud_args', 'twentyseventeen_widget_tag_cloud_args' );
</pre>
</div>
</div>

<div id="outline-container-orgd984808" class="outline-4">
<h4 id="orgd984808"><span class="section-number-4">3.20.22</span> comments_open</h4>
<div class="outline-text-4" id="text-3-20-22">
<p>
<a href="#org0fad66f">wp:plugin:disable-comments</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org8fda514" class="outline-3">
<h3 id="org8fda514"><span class="section-number-3">3.21</span> add_action, do_action, do_action_ref_array</h3>
<div class="outline-text-3" id="text-3-21">
</div>
<div id="outline-container-orgecff097" class="outline-4">
<h4 id="orgecff097"><span class="section-number-4">3.21.1</span> Basic</h4>
<div class="outline-text-4" id="text-3-21-1">
<p>
Event based
add_action( string $tag,
  string $function_name,
  int $priority = 10,
  int $accepted_args = 1 // number of args the function accepts
)
</p>

<p>
add_action( 'atag' is called by do_action( 'atag' or do_action_ref_array( 'atag'
</p>
</div>
</div>

<div id="outline-container-orga90c709" class="outline-4">
<h4 id="orga90c709"><span class="section-number-4">3.21.2</span> Action Sequence <a id="orga9d5ad0">wp:action:loading sequence</a></h4>
<div class="outline-text-4" id="text-3-21-2">
<p>
<a href="https://codex.wordpress.org/Plugin_API/Action_Reference">https://codex.wordpress.org/Plugin_API/Action_Reference</a>
</p>
</div>
</div>

<div id="outline-container-orgeda44d5" class="outline-4">
<h4 id="orgeda44d5"><span class="section-number-4">3.21.3</span> after_setup_theme</h4>
<div class="outline-text-4" id="text-3-21-3">
<p>
<a id="org55ee70d">wp:action:after_setup_theme</a>
Called each page load after the theme is initialized. 
Do basic setup, registration and init actions for a theme
</p>

<p>
These may be used
<a href="#orga8e6038">wp:f:add_theme_support</a>
<a href="#org8cd1ea8">wp:f:add_image_size</a>
<a href="#orgdb09de9">wp:f:register_nav_menus</a>
</p>
</div>
</div>

<div id="outline-container-orgf7a3348" class="outline-4">
<h4 id="orgf7a3348"><span class="section-number-4">3.21.4</span> init</h4>
<div class="outline-text-4" id="text-3-21-4">
<p>
<a id="org6822133">wp:action:init</a>
Fires after Wordpress has finished loading but before any headers are sent.
User is already authenticated.
Useful for intercepting $_GET or $_POST
</p>

<p>
<a href="#orgdb09de9">wp:f:register_nav_menus</a>
<a href="#orga736876">wp:f:add_rewrite_rule</a>
</p>
</div>
</div>

<div id="outline-container-org1464611" class="outline-4">
<h4 id="org1464611"><span class="section-number-4">3.21.5</span> widgets_init <a id="org67f6a0c">wp:action:widgets_init</a></h4>
<div class="outline-text-4" id="text-3-21-5">
<p>
Refer to <a href="#org894c5be">wp:filter:sidebars_widgets</a> to modify registered sidebars and their widgets.
Refer to <a href="#org20b9c0b">wp:f:register_widget</a> to create a widget
</p>
<pre class="example">
function lili_widgets_init() {
  $args = array(
        'name'          =&gt; __( 'Sidebar name', 'theme_text_domain' ),
        'id'            =&gt; 'unique-sidebar-id', // %1$s
        'description'   =&gt; '',
        'class'         =&gt; '', // %2$s, will have ~sidebar-~ prepended
        'before_widget' =&gt; '&lt;li id="%1$s" class="widget %2$s"&gt;',
        'after_widget'  =&gt; '&lt;/li&gt;',
        'before_title'  =&gt; '&lt;h2 class="widgettitle"&gt;',
        'after_title'   =&gt; '&lt;/h2&gt;' );
  register_sidebar( $args );

  // register_sidebar( $args2 );

  // Create multiple sidebars with the same config
  $args = array(
        'name'          =&gt; __('Sidebar %d'),
        'id'            =&gt; 'sidebar',          
        'description'   =&gt; '',
        'class'         =&gt; '',
        'before_widget' =&gt; '&lt;li id="%1$s" class="widget %2$s"&gt;',
        'after_widget'  =&gt; '&lt;/li&gt;',
        'before_title'  =&gt; '&lt;h2 class="widgettitle"&gt;',
        'after_title'   =&gt; '&lt;/h2&gt;' );

  // register_sidebars( 2, $args );

}
add_action('widgets_init', 'lili_widgets_init');
</pre>

<p>
Display
</p>
<pre class="example">
&lt;?php if ( is_active_sidebar( 'home_right_1' ) ) : ?&gt;
  &lt;div id="primary-sidebar" class="primary-sidebar widget-area" role="complementary"&gt;
    &lt;?php dynamic_sidebar( 'home_right_1' ); ?&gt;
  &lt;/div&gt;&lt;!-- #primary-sidebar --&gt;
&lt;?php endif; ?&gt;
</pre>
</div>
</div>

<div id="outline-container-org6987586" class="outline-4">
<h4 id="org6987586"><span class="section-number-4">3.21.6</span> admin_menu</h4>
<div class="outline-text-4" id="text-3-21-6">
<p>
<a id="orge697b11">wp:action:admin_menu</a>
</p>
</div>
</div>

<div id="outline-container-org97fd6c9" class="outline-4">
<h4 id="org97fd6c9"><span class="section-number-4">3.21.7</span> admin_init <a id="org86105c8">wp:action:admin_init</a></h4>
<div class="outline-text-4" id="text-3-21-7">
<p>
It's triggered before any other hook when a user accesses the admin area. This hook doesn't provide any parameters, so it can only be used to callback a specified function.
</p>

<p>
These core functions are called:
register_admin_color_schemes
send_frame_options_header
_wp_check_for_scheduled_split_terms
_wp_admin_bar_init
_maybe_update_core
_maybe_update_plugins
_maybe_update_themes
</p>
</div>
</div>

<div id="outline-container-org28549ab" class="outline-4">
<h4 id="org28549ab"><span class="section-number-4">3.21.8</span> pre_get_posts <a id="orgbd389b2">wp:action:pre_get_posts</a></h4>
<div class="outline-text-4" id="text-3-21-8">
<p>
Provide a chance to modify $query object (or do something else) before it's run. $query can be any main or secondary query.
Do not use this to alter query for single Page requests.
</p>

<p>
add_action( 'pre_get_posts', 'lili_pre_get_posts' );
// Should not call this in template because in template the $query is already run
function lili_pre_get_posts( $query ) {
  if ( ! is_page() &amp;&amp; ! is_home() 
       &amp;&amp; $query-&gt;is_main_query() ) {
    $query-&gt;set( 'post_type', array( 'post', 'movies' ) );
  }
  // this function should return nothing.
}
</p>
</div>
</div>

<div id="outline-container-orgd446e00" class="outline-4">
<h4 id="orgd446e00"><span class="section-number-4">3.21.9</span> wp_enqueue_scripts <a id="orge50be40">wp:action:wp_enqueue_scripts</a></h4>
<div class="outline-text-4" id="text-3-21-9">
<p>
Can use <a href="#org6d3f0ae">wp:f:wp_enqueue_style</a> and <a href="#org255d6b5">wp:f:wp_enqueue_script</a>. Priority might be needed to change to greater 10 to load after default theme/style.css
Use <a href="#org7f7f512">wp:filter:script_loader_src</a> and <a href="#org94266fd">wp:filter:style_loader_src</a> to change the source of scripts and styles
</p>
<pre class="example">
function lili_scripts() {
  wp_enqueue_style('lili-custom-styles', get_stylesheet_directory_uri().'/css/style.css');
}
add_action( 'wp_enqueue_scripts', 'lili_scripts', 20);
</pre>
</div>
</div>

<div id="outline-container-org6d8b53e" class="outline-4">
<h4 id="org6d8b53e"><span class="section-number-4">3.21.10</span> admin_head</h4>
<div class="outline-text-4" id="text-3-21-10">
<p>
<a id="org28c27d9">wp:action:admin_head</a>
</p>

<pre class="example">
function my_custom_admin_head() {
  echo '&lt;style&gt;[for="wp_welcome_panel-hide"] {display: none !important;}&lt;/style&gt;';
}
add_action( 'admin_head', 'my_custom_admin_head' );

// Add inline JS in the admin head with the &lt;script&gt; tag

function my_custom_admin_head() {
  echo '&lt;script type=""text/javascript"&gt;console.log('admin script')&lt;/script&gt;';
}
add_action( 'admin_head', 'my_custom_admin_head' );
</pre>
</div>
</div>

<div id="outline-container-orgcaeeee9" class="outline-4">
<h4 id="orgcaeeee9"><span class="section-number-4">3.21.11</span> template_redirect <a id="orgf352200">wp:action:template_redirect</a></h4>
<div class="outline-text-4" id="text-3-21-11">
<p>
Refer to <a href="#orga610319">wp:php:redirect</a>
</p>
</div>
</div>

<div id="outline-container-orge10c2a7" class="outline-4">
<h4 id="orge10c2a7"><span class="section-number-4">3.21.12</span> wp_head, wp_footer, get_footer <a id="org1c50dd1">wp:action:wp_head</a></h4>
<div class="outline-text-4" id="text-3-21-12">
<p>
These actions are good for adding inline CSS and JavaScripts
Refer to <a href="#org49b1cf6">wp:default filters</a>
wp_head(); and wp_footer(); are usually called in header/footer.php
get_footer action is called at the beginning of the get_footer(); function, which will include footer.php file later.
</p>

<p>
If a parameter is passed, footer-[$name].php is also included and you can play around $name in the get_footer hook like this
</p>
<pre class="example">
function themeslug_footer_hook( $name ) {
        if ( 'new' == $name ) { ?&gt;
                &lt;script&gt;
                        (function($) {
                                //put all your jQuery goodness in here.
                        })(jQuery);
                &lt;/script&gt;
        &lt;?php
        }
  // you can also print
  if ( is_singular() &amp;&amp; pings_open() ) {
    printf( '&lt;link rel="pingback" href="%s"&gt;' . "\n", get_bloginfo( 'pingback_url' ) );
  }

}
add_action( 'get_footer', 'themeslug_footer_hook' );
</pre>

<p>
Remove emoji javascript and style
</p>
<pre class="example">
remove_action('wp_head', 'print_emoji_detection_script', 7);
remove_action('wp_print_styles', 'print_emoji_styles');

remove_action('wp_head', 'wlwmanifest_link'); // Windows Live Writer support

remove_action('wp_head', 'wp_generator'); // wp version

remove_action ('wp_head', 'rsd_link'); // remove EditURI/RSD Really Simple Directory and xmlrpc.php

remove_action( 'wp_head', 'wp_shortlink_wp_head'); // e.g. http://yoursite.com/?p=7

// By default, wp:f:add_theme_support automatic-feed-links is not enabled and the feed links are not inserted 
remove_action( 'wp_head', 'feed_links', 2 ); // e.g. &lt;link rel="alternate" type="application/rss+xml" title="WP Site &amp;raquo; Feed" href="http://localhost/wp/feed/" /&gt;
remove_action('wp_head', 'feed_links_extra', 3 ); // remove comment feeds e.g. Like: &lt;link rel="alternate" type="application/rss+xml" title="WP Site &amp;raquo; Comments Feed" href="http://localhost/wp/comments/feed/" /&gt;

remove_action('wp_head', 'adjacent_posts_rel_link'); // remove PREV and NEXT links e.g. &lt;link rel='prev' title='The Post Before This One' href='http://localhost/wp/?p=4' /&gt;

remove_action( 'wp_head','rest_output_link_wp_head'); // wp-json
</pre>
</div>
</div>

<div id="outline-container-org369c1a4" class="outline-4">
<h4 id="org369c1a4"><span class="section-number-4">3.21.13</span> add_meta_boxes, add_meta_boxes<sub>post_type</sub></h4>
<div class="outline-text-4" id="text-3-21-13">
<p>
lili_add_meta_boxes($post_type, $post) takes 2 arguments, no return. 
lili_add_meta_boxes<sub>post_type</sub>($post) takes 1 argument, no return.
</p>

<p>
Use wp:f:add_meta_box, <a href="#orgccd0947">wp:f:remove_meta_box</a> or modify global $wp_meta_boxes;
</p>

<p>
$wp_meta_boxes['post-type']['normal']['core']['postexcerpt']['title'] = 'Your title';
</p>

<p>
You can change the title, callback (complete change to another function) and different context. 
The callback most likely outputs a label, form field and some description.
</p>

<p>
You can either completely change the callback or use wp:filter:gettext to change the translation
</p>
</div>
</div>

<div id="outline-container-orgc2d19e2" class="outline-4">
<h4 id="orgc2d19e2"><span class="section-number-4">3.21.14</span> edit_page_form <a id="orga551a76">wp:action:edit_page_form</a></h4>
<div class="outline-text-4" id="text-3-21-14">
<p>
Fires after 'normal' context meta boxes have been output for the 'page' post type.
Control admin Edit Page form.
</p>

<p>
<a href="#org42678ed">wp:f:wp_editor</a>
</p>

<pre class="example">
function volunteer_hours_editor() {
  $content = get_post_meta(get_the_ID(), 'volunteer-hours', true);
  $settings = array('textarea_name' =&gt; 'volunteer-hours');
  //wpautop($content);
  wp_editor( $content, 'volunteer-hours', $settings);
}
</pre>
</div>
</div>

<div id="outline-container-org86f8b2d" class="outline-4">
<h4 id="org86f8b2d"><span class="section-number-4">3.21.15</span> edit_form_advanced</h4>
<div class="outline-text-4" id="text-3-21-15">
<p>
<a id="org81a7be8">wp:action:edit_form_advanced</a>
Same as <a href="#orga551a76">wp:action:edit_page_form</a> but for all post types other than 'page'
</p>
</div>
</div>

<div id="outline-container-org544feed" class="outline-4">
<h4 id="org544feed"><span class="section-number-4">3.21.16</span> save_post <a id="org19d1e0e">wp:action:save_post</a></h4>
<div class="outline-text-4" id="text-3-21-16">
<p>
Called when a post or page is created or updated, which could be from an import, post/page edit form, xmlrpc, or post by email. The data for the post is stored in $_POST, $_GET or the global $post_data, depending on how the post was edited. For example, quick edits use $_POST.
</p>

<p>
<a href="#orgf5f6f3c">wp:f:update_post_meta</a>
</p>

<pre class="example">
add_action( 'save_post', 'save_post', 10, 2 );
function save_post( $post_id, $post ) {
  if ( !current_user_can( 'edit_post', $post_id ) )
    return $post_id;
    update_post_meta( $post_id, 'volunteer-hours', stripslashes( wpautop($_POST['volunteer-hours']) ) );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org7cc92b1" class="outline-3">
<h3 id="org7cc92b1"><span class="section-number-3">3.22</span> add_shortcode <a id="org7ee2ec1">wp:f:add_shortcode</a></h3>
<div class="outline-text-3" id="text-3-22">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #74af68;">// </span><span style="color: #74af68;">[bartag foo="foo-value"]</span>

<span style="color: #74af68;">// </span><span style="color: #74af68;">Use underscore instead of hyphen e.g. bar_tag</span>
<span style="color: #ffad29; font-weight: bold;">function</span> <span style="color: #00ede1; font-weight: bold;">bartag_func</span>( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">atts</span>, <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">content</span>, <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">tag</span> ) {
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">a</span> = shortcode_atts( <span style="color: #ffad29; font-weight: bold;">array</span>(
    <span style="color: #e67128;">'class'</span> =&gt; <span style="color: #e67128;">'something'</span>, <span style="color: #74af68;">// </span><span style="color: #74af68;">default value</span>
    <span style="color: #e67128;">'attr_2'</span> =&gt; <span style="color: #e67128;">'something else'</span>, <span style="color: #74af68;">// </span><span style="color: #74af68;">2nd attribute</span>
  ), <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">atts</span> );

  <span style="color: #74af68;">// </span><span style="color: #74af68;">get current post</span>
  <span style="color: #74af68;">// </span><span style="color: #74af68;">global $post; $post-&gt;ID</span>

  <span style="color: #74af68;">// </span><span style="color: #74af68;">Use return not echo</span>
  <span style="color: #ffad29; font-weight: bold;">return</span> <span style="color: #e67128;">'&lt;span class="'</span>.esc_attr(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">a</span>[<span style="color: #e67128;">'class'</span>]).<span style="color: #e67128;">'"&gt;'</span>
   .<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">content</span>
   <span style="color: #74af68;">// </span><span style="color: #74af68;">or</span>
   <span style="color: #74af68;">// </span><span style="color: #74af68;">.do_shortcode($content)</span>
   .<span style="color: #e67128;">"foo = </span><span style="color: #dbdb95;">{$a['foo']}</span><span style="color: #e67128;">"</span>
   .<span style="color: #e67128;">'&lt;/span&gt;'</span>;

<span style="color: #74af68;">/*</span>
<span style="color: #74af68;">ob_start();</span>
<span style="color: #74af68;">?&gt; &lt;HTML&gt; &lt;here&gt; ... &lt;?php</span>
<span style="color: #74af68;">return ob_get_clean();</span>
<span style="color: #74af68;">*/</span>

<span style="color: #74af68;">/*</span>
<span style="color: #74af68;">ob_start();</span>
<span style="color: #74af68;">get_template_part( 'template-parts/form/contact-us');</span>
<span style="color: #74af68;">return ob_get_clean();</span>
<span style="color: #74af68;">*/</span>

}
add_shortcode( <span style="color: #e67128;">'bartag'</span>, <span style="color: #e67128;">'bartag_func'</span> );

<span style="color: #74af68;">// </span><span style="color: #74af68;">In order to run shortcode in Widgets, add this</span>
add_filter(<span style="color: #e67128;">'widget_text'</span>,<span style="color: #e67128;">'do_shortcode'</span>);
<span style="color: #74af68;">// </span><span style="color: #74af68;">wp:filter:widget_text</span>
</pre>
</div>

<p>
Pass array to shortcode attribute
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">data</span> = [
    [],[],[]
];

var_dump(serialize(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">data</span>));

<span style="color: #74af68;">// </span><span style="color: #74af68;">use single quotes</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">[your-shortcode data='serialized-string']</span>

<span style="color: #ffad29; font-weight: bold;">function</span> <span style="color: #00ede1; font-weight: bold;">your_shortcode_cb</span>() {
    <span style="color: #74af68;">// </span><span style="color: #74af68;">...</span>
    <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">data</span> = unserialize(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">a</span>[<span style="color: #e67128;">'data'</span>]);
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaf37c6c" class="outline-3">
<h3 id="orgaf37c6c"><span class="section-number-3">3.23</span> Options, Settings <a id="org45e8ee3">WP All Options</a></h3>
<div class="outline-text-3" id="text-3-23">
<p>
/wp-admin/options.php
</p>

<p>
<a href="https://codex.wordpress.org/Option_Reference">Option Reference</a>
</p>

<p>
noindex, nofollow
Settings &gt; Reading &gt; toggle Search Engine Visibility - Discourage search engines from indexing this site
</p>
</div>
</div>

<div id="outline-container-org01c037c" class="outline-3">
<h3 id="org01c037c"><span class="section-number-3">3.24</span> FTP setting <a id="org1635023">wp:ftp</a></h3>
<div class="outline-text-3" id="text-3-24">
<p>
WordPress is usually run using Apache or Nginx user which might not have permission to write files.
docker container map /host/path/to/html:/var/www
Setup these in wp-config.php
</p>
<div class="org-src-container">
<pre class="src src-php">define(<span style="color: #e67128;">'FTP_BASE'</span>, <span style="color: #e67128;">'/host/path/to/html/'</span>);
define(<span style="color: #e67128;">'FS_METHOD'</span>, <span style="color: #e67128;">'direct'</span>);
define(<span style="color: #e67128;">'FTP_HOST'</span>, <span style="color: #e67128;">'8.8.8.8'</span>); <span style="color: #74af68;">// </span><span style="color: #74af68;">public ip</span>
define(<span style="color: #e67128;">'FTP_USER'</span>, <span style="color: #e67128;">'ftpuser'</span>);
define(<span style="color: #e67128;">'FTP_PASS'</span>, <span style="color: #e67128;">'ftppassword'</span>);
define(<span style="color: #e67128;">'FTP_SSL'</span>, <span style="color: #008b8b;">true</span>);
</pre>
</div>

<p>
<a href="https://codex.wordpress.org/Editing_wp-config.php#WordPress_Upgrade_Constants">https://codex.wordpress.org/Editing_wp-config.php#WordPress_Upgrade_Constants</a>
</p>
</div>
</div>

<div id="outline-container-orgd5fc684" class="outline-3">
<h3 id="orgd5fc684"><span class="section-number-3">3.25</span> Sanitizing and Escaping User Data</h3>
<div class="outline-text-3" id="text-3-25">
<p>
<a href="https://codex.wordpress.org/Validating_Sanitizing_and_Escaping_User_Data">https://codex.wordpress.org/Validating_Sanitizing_and_Escaping_User_Data</a>
</p>

<p>
Sanitize data before it's saved
</p>
<pre class="example">
&lt;input type="text" id="title" name="title" /&gt;

$title = sanitize_text_field( $_POST['title'] );
update_post_meta( $post-&gt;ID, 'title', $title );

sanitize_email()
sanitize_file_name()
sanitize_html_class()
sanitize_key()
sanitize_meta()
sanitize_mime_type()
sanitize_option()
sanitize_sql_orderby()
sanitize_text_field()
sanitize_textarea_field()
sanitize_title()
sanitize_title_for_query()
sanitize_title_with_dashes()
sanitize_user()
</pre>

<p>
Escape
</p>
<pre class="example">
&lt;h4&gt;&lt;?php echo esc_html( $title ); ?&gt;&lt;/h4&gt;
&lt;img src="&lt;?php echo esc_url( $great_user_picture_url ); ?&gt;" /&gt;
&lt;a href="#" onclick="&lt;?php echo esc_js( $custom_js ); ?&gt;"&gt;Click me&lt;/a&gt;
&lt;ul class="&lt;?php echo esc_attr( $stored_class ); ?&gt;"&gt;
&lt;textarea&gt;&lt;?php echo esc_textarea( $text ); ?&gt;&lt;/textarea&gt;
</pre>
</div>

<div id="outline-container-orgee4b554" class="outline-4">
<h4 id="orgee4b554"><span class="section-number-4">3.25.1</span> Ellipsis and trim, strip HTML and PHP tags <a id="org2fea5b6">wp:ellipsis</a></h4>
<div class="outline-text-4" id="text-3-25-1">
<p>
wp_trim_words($text) :: strip HTML and PHP tags and truncate string in words
</p>
<pre class="example">
function wp_trim_words( $text, $num_words = 55, $more = null ) {
  if ( null === $more ) {
    $more = __( '&amp;hellip;' );
  }

  $original_text = $text;
  $text = wp_strip_all_tags( $text );

  /*
   * translators: If your word count is based on single characters (e.g. East Asian characters),
   * enter 'characters_excluding_spaces' or 'characters_including_spaces'. Otherwise, enter 'words'.
   * Do not translate into your own language.
   */
  if ( strpos( _x( 'words', 'Word count type. Do not translate!' ), 'characters' ) === 0 &amp;&amp; preg_match( '/^utf\-?8$/i', get_option( 'blog_charset' ) ) ) {
    $text = trim( preg_replace( "/[\n\r\t ]+/", ' ', $text ), ' ' );
    preg_match_all( '/./u', $text, $words_array );
    $words_array = array_slice( $words_array[0], 0, $num_words + 1 );
    $sep = '';
  } else {
    $words_array = preg_split( "/[\n\r\t ]+/", $text, $num_words + 1, PREG_SPLIT_NO_EMPTY );
    $sep = ' ';
  }

  if ( count( $words_array ) &gt; $num_words ) {
    array_pop( $words_array );
    $text = implode( $sep, $words_array );
    $text = $text . $more;
  } else {
    $text = implode( $sep, $words_array );
  }

  /**
   * Filters the text content after words have been trimmed.
   *
   * @since 3.3.0
   *
   * @param string $text          The trimmed text.
   * @param int    $num_words     The number of words to trim the text to. Default 55.
   * @param string $more          An optional string to append to the end of the trimmed text, e.g. &amp;hellip;.
   * @param string $original_text The text before it was trimmed.
   */
  return apply_filters( 'wp_trim_words', $text, $num_words, $more, $original_text );
}
</pre>

<p>
wp_strip_all_tags($string)
</p>
<pre class="example">
function wp_strip_all_tags($string, $remove_breaks = false) {
  $string = preg_replace( '@&lt;(script|style)[^&gt;]*?&gt;.*?&lt;/\\1&gt;@si', '', $string );
  $string = strip_tags($string);

  if ( $remove_breaks )
    $string = preg_replace('/[\r\n\t ]+/', ' ', $string);

  return trim( $string );
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgca8541b" class="outline-3">
<h3 id="orgca8541b"><span class="section-number-3">3.26</span> Ajax <a id="org65e2e34">wp:ajax</a></h3>
<div class="outline-text-3" id="text-3-26">
</div>
<div id="outline-container-orgc8b59a4" class="outline-4">
<h4 id="orgc8b59a4"><span class="section-number-4">3.26.1</span> Ajax on wp admin pages</h4>
<div class="outline-text-4" id="text-3-26-1">
<p>
Javascript global variable ajaxurl is defined on admin pages
</p>

<p>
functions.php
</p>
<pre class="example">
add_action( 'admin_enqueue_scripts', 'add_ajax_file');
function add_ajax_file() {
  wp_enqueue_script( 'ajax_custom_script', plugins_url( '/js/my.js' , __FILE___), array('jquery') );
}

add_action( 'wp_ajax_my_action', 'my_action');

function my_action() {
  global $wpdb;
  $data = intval($_POST['data']);
  echo $data;
  // echo json_encde($data);
  wp_die();
} 
</pre>

<p>
my.js
</p>
<pre class="example">
jQuery(document).ready(function($) {
  var data = {
    'action': 'my_action',
    'data': 'some data'
  }
  $.post(ajaxurl, data, function(r) {
    console.log('response:', r);
  });
})
</pre>
</div>
</div>

<div id="outline-container-orgda51e00" class="outline-4">
<h4 id="orgda51e00"><span class="section-number-4">3.26.2</span> Ajax on wp front end pages</h4>
<div class="outline-text-4" id="text-3-26-2">
<p>
Define global variable mynamespace.ajaxurl
functions.php
</p>
<pre class="example">
add_action( 'wp_enqueue_scripts', 'add_custom_namespace' );

function add_custom_namespace() {
  wp_localize_script( 'jquery', 'mynamespace', 
   array(
    'ajaxurl' =&gt; admin_url('admin-ajax.php'),
    'data' =&gt; 'some data'
   ) 
  );
}
</pre>

<p>
my.js
</p>
<pre class="example">
jQuery(document).ready(function($) {
  var data = {
    'action': 'my_action',
    'data': mynamespace.data
  }
  $.post(mynamespace.ajaxurl, data, function(r) {
    console.log('response:', r);
  });
})
</pre>

<p>
functions.php
</p>
<pre class="example">
add_action( 'wp_ajax_my_action', 'my_action');
add_action( 'wp_ajax_nopriv_my_action', 'my_action'); // non-logged in users

// same my_action
</pre>
</div>
</div>
</div>

<div id="outline-container-org90e478b" class="outline-3">
<h3 id="org90e478b"><span class="section-number-3">3.27</span> Theme</h3>
<div class="outline-text-3" id="text-3-27">
</div>
<div id="outline-container-orgfa8f2c4" class="outline-4">
<h4 id="orgfa8f2c4"><span class="section-number-4">3.27.1</span> child theme</h4>
<div class="outline-text-4" id="text-3-27-1">
<p>
<a href="https://codex.wordpress.org/Child_Themes">https://codex.wordpress.org/Child_Themes</a>
wp-content/themes/parent-theme-name-child
wp-content/themes/parent-theme-name-child/style.css
</p>

<p>
For new theme, index.php is required
</p>

<pre class="example">
/*
 Theme Name:   Twenty Fifteen Child
 Theme URI:    http://example.com/twenty-fifteen-child/
 Description:  Twenty Fifteen Child Theme
 Author:       John Doe
 Author URI:   http://example.com
 Template:     twentyfifteen
 Version:      1.0.0
 License:      GNU General Public License v2 or later
 License URI:  http://www.gnu.org/licenses/gpl-2.0.html
 Tags:         light, dark, two-columns, right-sidebar, responsive-layout, accessibility-ready
 Text Domain:  twenty-fifteen-child
*/
</pre>

<p>
Only Theme Name and Template (the name of the parent theme directory) are required
</p>

<p>
functions.php in child loads first then the parent's
</p>
<pre class="example">
add_action( 'wp_enqueue_scripts', 'my_theme_enqueue_styles' );
function my_theme_enqueue_styles() {
  $parent_style = 'parent-style'; // This is 'twentyfifteen-style' for the Twenty Fifteen theme.

  wp_enqueue_style( $parent_style, get_template_directory_uri() . '/style.css' );

  // child theme style.css is loaded after parent's style.css
  wp_enqueue_style( 'child-style',
        get_stylesheet_directory_uri() . '/style.css',
        array( $parent_style ),
        wp_get_theme()-&gt;get('Version')
  );
}
</pre>

<p>
That requires parent functions.php to have
</p>
<pre class="example">
if ( ! function_exists( 'theme_special_nav' ) ) {
    function theme_special_nav() {
        //  Do something.
    }
}
</pre>
</div>
</div>

<div id="outline-container-org1127c9b" class="outline-4">
<h4 id="org1127c9b"><span class="section-number-4">3.27.2</span> functions.php <a id="org6c13867">wp:theme:functions</a></h4>
</div>
<div id="outline-container-org2ca5f21" class="outline-4">
<h4 id="org2ca5f21"><span class="section-number-4">3.27.3</span> Template Files</h4>
<div class="outline-text-4" id="text-3-27-3">
<p>
<a href="https://codex.wordpress.org/Theme_Development#Template_Files">All Template Files</a>
<a href="https://developer.wordpress.org/themes/basics/template-hierarchy/">https://developer.wordpress.org/themes/basics/template-hierarchy/</a>
<a href="https://wphierarchy.com/">Another WordPress Template Hierarchy</a>
</p>

<p>
single.php
single-{post-type}.php
archive.php
archive-{post-type}.php
</p>

<p>
if single.php and archive.php don't exist, wp looks for index.php
</p>
</div>
</div>

<div id="outline-container-orgeafc286" class="outline-4">
<h4 id="orgeafc286"><span class="section-number-4">3.27.4</span> Page template</h4>
<div class="outline-text-4" id="text-3-27-4">
<p>
Hierarchy
</p>
<dl class="org-dl">
<dt>Global Custom Page Template</dt><dd>can be applied to multiple pages. Set in Edit Post &gt; Page Attributes &gt; Template</dd>
<dt>page-{slug}.php</dt><dd>for one specific page. Directly put them in theme folder</dd>
<dt>page-{id}.php</dt><dd>for one specific page. Directly put them in theme folder</dd>
<dt>page.php</dt><dd>refer to conditional tags</dd>
<dt>(no term)</dt><dd>singular.php</dd>
<dt>(no term)</dt><dd>index.php</dd>
</dl>
</div>

<div id="outline-container-orgd8fc932" class="outline-5">
<h5 id="orgd8fc932"><span class="section-number-5">3.27.4.1</span> Global Custom Page Template</h5>
<div class="outline-text-5" id="text-3-27-4-1">
<p>
Put these global template files in theme subfolder page-templates (or any .php files)
File name can be anything but follow page_two-columns.php. Don't use <code>page-</code> as prefix!
Make a copy of page.php to start
</p>

<pre class="example">
&lt;?php
/**
 * Template Name: Full Width Page
 *
 * @package WordPress
 * @subpackage Twenty_Fourteen
 * @since Twenty Fourteen 1.0
 */
</pre>
</div>
</div>

<div id="outline-container-org5e1a5ac" class="outline-5">
<h5 id="org5e1a5ac"><span class="section-number-5">3.27.4.2</span> archive.php</h5>
<div class="outline-text-5" id="text-3-27-4-2">
<pre class="example">
&lt;?php
/**
 * The template for displaying archive pages
 *
 * @link https://codex.wordpress.org/Template_Hierarchy
 *
 * @package WordPress
 * @subpackage Twenty_Seventeen
 * @since 1.0
 * @version 1.0
 */

get_header(); ?&gt;

&lt;div class="wrap"&gt;

        &lt;?php if ( have_posts() ) : ?&gt;
                &lt;header class="page-header"&gt;
                        &lt;?php
                                the_archive_title( '&lt;h1 class="page-title"&gt;', '&lt;/h1&gt;' );
                                the_archive_description( '&lt;div class="taxonomy-description"&gt;', '&lt;/div&gt;' );
                        ?&gt;
                &lt;/header&gt;&lt;!-- .page-header --&gt;
        &lt;?php endif; ?&gt;

        &lt;div id="primary" class="content-area"&gt;
                &lt;main id="main" class="site-main" role="main"&gt;

                &lt;?php
                if ( have_posts() ) : ?&gt;
                        &lt;?php
                        /* Start the Loop */
                        while ( have_posts() ) : the_post();

                                /*
                                 * Include the Post-Format-specific template for the content.
                                 * If you want to override this in a child theme, then include a file
                                 * called content-___.php (where ___ is the Post Format name) and that will be used instead.
                                 */
                                get_template_part( 'template-parts/post/content', get_post_format() );

                        endwhile;

                        the_posts_pagination( array(
                                'prev_text' =&gt; twentyseventeen_get_svg( array( 'icon' =&gt; 'arrow-left' ) ) . '&lt;span class="screen-reader-text"&gt;' . __( 'Previous page', 'twentyseventeen' ) . '&lt;/span&gt;',
                                'next_text' =&gt; '&lt;span class="screen-reader-text"&gt;' . __( 'Next page', 'twentyseventeen' ) . '&lt;/span&gt;' . twentyseventeen_get_svg( array( 'icon' =&gt; 'arrow-right' ) ),
                                'before_page_number' =&gt; '&lt;span class="meta-nav screen-reader-text"&gt;' . __( 'Page', 'twentyseventeen' ) . ' &lt;/span&gt;',
                        ) );

                else :

                        get_template_part( 'template-parts/post/content', 'none' );

                endif; ?&gt;

                &lt;/main&gt;&lt;!-- #main --&gt;
        &lt;/div&gt;&lt;!-- #primary --&gt;
        &lt;?php get_sidebar(); ?&gt;
&lt;/div&gt;&lt;!-- .wrap --&gt;

&lt;?php get_footer();
</pre>
</div>
</div>
</div>

<div id="outline-container-org59524b5" class="outline-4">
<h4 id="org59524b5"><span class="section-number-4">3.27.5</span> Setup</h4>
<div class="outline-text-4" id="text-3-27-5">
<p>
<a href="#orga8e6038">wp:f:add_theme_support</a>
</p>
</div>
</div>

<div id="outline-container-org675a87a" class="outline-4">
<h4 id="org675a87a"><span class="section-number-4">3.27.6</span> Include header, footer, sidebar and other, search form</h4>
<div class="outline-text-4" id="text-3-27-6">
<p>
<a href="#org7c3e5a3">wp:f:get_header</a>
</p>
</div>
</div>

<div id="outline-container-org6ebd40d" class="outline-4">
<h4 id="org6ebd40d"><span class="section-number-4">3.27.7</span> Widgets</h4>
<div class="outline-text-4" id="text-3-27-7">
</div>
<div id="outline-container-org4122718" class="outline-5">
<h5 id="org4122718"><span class="section-number-5">3.27.7.1</span> Create sidebar</h5>
<div class="outline-text-5" id="text-3-27-7-1">
<p>
<a href="#org67f6a0c">wp:action:widgets_init</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org3de40ba" class="outline-4">
<h4 id="org3de40ba"><span class="section-number-4">3.27.8</span> Functions used in template</h4>
<div class="outline-text-4" id="text-3-27-8">
<p>
Core functions used in templates :: /wp-includes/general-template.php
</p>

<pre class="example">
// In template
&lt;?php wp_head(); ?&gt;

// In plugin
add_action('wp_head', 'lili_wphead_dfp');
function lili_wphead_dfp() {
 // add inline script to header
 $o = "&lt;script&gt;...&lt;/script&gt;";
 echo $o;
}

// Load with dependancy (jQuery is loaded)
function lili_wphead_dfp() {
 if ( wp_script_is( 'jquery', 'done' ) ) {
?&gt;
&lt;script type="text/javascript"&gt;
// jQuery code 
&lt;/script&gt;
&lt;?php
 }
}
</pre>
</div>
</div>

<div id="outline-container-org1f65e08" class="outline-4">
<h4 id="org1f65e08"><span class="section-number-4">3.27.9</span> Good themes</h4>
<div class="outline-text-4" id="text-3-27-9">
<p>
<a href="https://themeforest.net/item/newspapaer/5489609">Newspaper</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orgf908e0c" class="outline-3">
<h3 id="orgf908e0c"><span class="section-number-3">3.28</span> Admin Screens</h3>
<div class="outline-text-3" id="text-3-28">
</div>
<div id="outline-container-orge40f48e" class="outline-4">
<h4 id="orge40f48e"><span class="section-number-4">3.28.1</span> Admin bar now is called Toolbar <a id="orgdeac6e1">wp:admin:toolbar</a></h4>
<div class="outline-text-4" id="text-3-28-1">
<p>
In order to show
</p>
<ul class="org-ul">
<li>wp_footer is called. &lt;body&gt; will have class admin-bar and /wp-includes/css/admin-bar.min.css is added</li>
<li><code>show_admin_bar( false );</code> is not run in functions.php</li>
<li>In newer version of wp, <a href="#orgc76329c">wp:filter:show_admin_bar</a> can be used to turn off the admin bar</li>
</ul>

<p>
If you have sticky or position:fixed element .sticky-header
</p>
<pre class="example">
.sticky-header {
  position: fixed;
  top: 0;
}
.admin-bar .sticky-header {
  top: 46px; /* 0 + 46 */
}
@media screen and (min-width: 783px) {
  .admin-bar .sticky-header {
    top: 32px; /* 0 + 32 */
  }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgccb970f" class="outline-3">
<h3 id="orgccb970f"><span class="section-number-3">3.29</span> Transient API</h3>
<div class="outline-text-3" id="text-3-29">
<p>
WordPress cache API in database.
<code>DELETE FROM wp_options WHERE option_name LIKE ('%\_transient\_%')</code>
</p>
</div>
</div>

<div id="outline-container-org9f7bf8d" class="outline-3">
<h3 id="org9f7bf8d"><span class="section-number-3">3.30</span> Custom Cache</h3>
<div class="outline-text-3" id="text-3-30">
<p>
Same page request custom cache
</p>

<pre class="example">
function lili_request_cache($field, $set = NULL) {
  static $custom_cache;
  if (!isset($custom_cache)) {
    $custom_cache = [];
  }
  if ($set !== NULL &amp;&amp; $field !== NULL ) {
    // $set_field_value = _f('field_name', 123);
    $custom_cache[$field] = $set;
  }
  elseif ($field !==  NULL &amp;&amp; $set == NULL &amp;&amp;
          ( !isset($custom_cache[$field]) || $custom_cache[$field] == NULL )
  ) {
    // Set default
    // $set_field_value = _f('field_name');
    switch ($field) {
      case "trigger_posts_clauses":
        $custom_cache[$field] = '';
        break;
    }
  }

  if (!isset($custom_cache[$field])) {
    $custom_cache[$field] = NULL;
  }

  return $custom_cache[$field];
}
</pre>
</div>
</div>

<div id="outline-container-orgf62ee6e" class="outline-3">
<h3 id="orgf62ee6e"><span class="section-number-3">3.31</span> Custom page</h3>
<div class="outline-text-3" id="text-3-31">
<p>
<a href="#org93d7a17">wp:filter:template_include</a>
</p>
</div>
</div>

<div id="outline-container-orgac7061c" class="outline-3">
<h3 id="orgac7061c"><span class="section-number-3">3.32</span> Database</h3>
<div class="outline-text-3" id="text-3-32">
<p>
<a href="https://codex.wordpress.org/Database_Description">Database Description</a>
</p>
</div>

<div id="outline-container-org9fc4e8e" class="outline-4">
<h4 id="org9fc4e8e"><span class="section-number-4">3.32.1</span> wp_posts</h4>
<div class="outline-text-4" id="text-3-32-1">
<p>
ID :: int
post_type :: varchar(20), 'post'
post_status :: varchar(20), 'publish'
</p>
</div>
</div>

<div id="outline-container-org58ac668" class="outline-4">
<h4 id="org58ac668"><span class="section-number-4">3.32.2</span> wp_terms, wp_term_relationships</h4>
<div class="outline-text-4" id="text-3-32-2">
<ul class="org-ul">
<li>wp_terms</li>
</ul>
<p>
term_id :: int, auto_increment
name :: varchar(200)
slug :: varchar(200)
term_group :: int
</p>

<ul class="org-ul">
<li>wp_term_relationships</li>
</ul>
<p>
object_id :: int, (e.g. ID in wp_posts), 0
term_taxonomy_id :: int, 0
term_order :: int, 0
</p>
</div>
</div>
</div>

<div id="outline-container-org9ad18d2" class="outline-3">
<h3 id="org9ad18d2"><span class="section-number-3">3.33</span> Plugins</h3>
<div class="outline-text-3" id="text-3-33">
</div>
<div id="outline-container-org2fa869e" class="outline-4">
<h4 id="org2fa869e"><span class="section-number-4">3.33.1</span> Custom Plugin</h4>
<div class="outline-text-4" id="text-3-33-1">
<p>
<a href="https://codex.wordpress.org/Plugin_Resources">https://codex.wordpress.org/Plugin_Resources</a>
<a href="https://codex.wordpress.org/Writing_a_Plugin">https://codex.wordpress.org/Writing_a_Plugin</a>
<a href="https://developer.wordpress.org/plugins/the-basics/#getting-started">https://developer.wordpress.org/plugins/the-basics/#getting-started</a>
</p>

<p>
<a href="https://github.com/DevinVinson/WordPress-Plugin-Boilerplate">https://github.com/DevinVinson/WordPress-Plugin-Boilerplate</a>
</p>

<p>
<a href="https://github.com/levonlee/gridli-vue">https://github.com/levonlee/gridli-vue</a>
</p>

<p>
Use hyphen for plugin name and folder `wp_content/plugins/li-custom/li-custom.php`
</p>

<p>
<a href="https://developer.wordpress.org/plugins/wordpress-org/how-your-readme-txt-works/">readme.txt</a>
</p>
</div>
</div>

<div id="outline-container-orgff4f5e8" class="outline-4">
<h4 id="orgff4f5e8"><span class="section-number-4">3.33.2</span> polylang <a id="orgf8be1fc">wp:plugin:polylang</a></h4>
<div class="outline-text-4" id="text-3-33-2">
<p>
<a href="https://polylang.wordpress.com/documentation/">https://polylang.wordpress.com/documentation/</a>
</p>

<p>
Manage multilingual posts in one post per language (e.g. WPML - paid, xili-language, Polylang, Bogo or Sublanguage). Translations are then linked together, indicating that one page is the translation of another.
</p>

<p>
There are other types of multilingual plugins:
</p>
<ul class="org-ul">
<li>Store all languages alternatives for each post in the same post (e.g. qTranslate-X, WPGlobus).</li>
<li>Manage translations on the generated page instead of using a post context (e.g. Transposh and Global Translator).</li>
<li>Plugins like Multisite Language Switcher, Multilingual Press, and Zanto, link together separate WordPress network (multisite) installations for each language by pinging back and forth.</li>
</ul>

<p>
Add languages including English (the first language)
Click on a post/page, click on + for another language and then create the translation page.
You can select another existing page and add that page to the current page's translation.
Posts in different languages will be created with different URLs. Go to edit one post and you can go to different translated pages.
</p>

<p>
URLs
</p>
<pre class="example">
/sample-page
/zh/chinese-sample-page
</pre>

<p>
You can create a different menu for each language
</p>

<p>
Determine the locale of current page
</p>
<pre class="example">
//get_locale() :: 'en_US'
//get_bloginfo('language') :: 'en-US'

// in template
&lt;div class="nav-previous alignleft"&gt;
&lt;?php
$currentlang = get_bloginfo('language');
if($currentlang=="en-US"):?&gt;
This is English
&lt;?php else: ?&gt;
This is Spanish
&lt;?php endif; ?&gt;
&lt;/div&gt;
</pre>

<p>
Display links to posts translations within the loop
</p>
<pre class="example">
&lt;?php while ( have_posts() ) : the_post(); ?&gt;
&lt;ul class='translations'&gt;&lt;?php pll_the_languages( array( 'post_id' =&gt; $post-&gt;ID ) ); ?&gt;&lt;/ul&gt;
&lt;?php the_content(); ?&gt;
&lt;?php endwhile; ?&gt;
</pre>

<p>
Other functions
<a href="https://polylang.wordpress.com/documentation/documentation-for-developers/functions-reference/">https://polylang.wordpress.com/documentation/documentation-for-developers/functions-reference/</a>
</p>
<pre class="example">
&lt;?php // outputs a list of languages names ?&gt;
&lt;ul&gt;&lt;?php pll_the_languages(); ?&gt;&lt;/ul&gt;

&lt;?php // outputs a flags list (without languages names) ?&gt;
&lt;ul&gt;&lt;?php pll_the_languages(array('show_flags'=&gt;1,'show_names'=&gt;0)); ?&gt;&lt;/ul&gt;

&lt;?php // outputs a dropdown list of languages names ?&gt;
&lt;?php pll_the_languages(array('dropdown'=&gt;1));  ?&gt;
</pre>
</div>

<div id="outline-container-orgb71e57e" class="outline-5">
<h5 id="orgb71e57e"><span class="section-number-5">3.33.2.1</span> String translation is possible</h5>
<div class="outline-text-5" id="text-3-33-2-1">
<p>
There're 3 ways to register a string to translate
</p>
</div>
<ol class="org-ol">
<li><a id="orgc8e4265"></a>pll_register_string($name, $string, $group, $multiline);<br />
<div class="outline-text-6" id="text-3-33-2-1-1">
<ul class="org-ul">
<li>$name =&gt; (required) name provided for sorting convenience (ex: ‘myplugin’)</li>
<li>$string =&gt; (required) the string to translate</li>
<li>$group =&gt; (optional) the group in which the string is registered, default is ‘polylang’</li>
<li>$multiline =&gt; (optional) if set to true, the translation text field will be multiline, default is false</li>
</ul>

<pre class="example">
function register_strings() {
  pll_register_string('mytheme', 'some_string');
}
add_action('init','register_strings');

// in template to echo
pll_e('some_string');

// to return
pll__('some_string');

// return in another language that might not be the current language
pll_translate_string($string, $lang);
</pre>
</div>
</li>

<li><a id="org55466c4"></a>WPML API<br />
<div class="outline-text-6" id="text-3-33-2-1-2">
<p>
for example icl_register_string($context, $name, $string);
</p>
</div>
</li>

<li><a id="org4232d85"></a>wpml-config.xml<br />
<div class="outline-text-6" id="text-3-33-2-1-3">
<p>
Some plugin or theme might include this WPML plugin xml in its root directory.
<a href="https://polylang.pro/doc/the-wpml-config-xml-file/">https://polylang.pro/doc/the-wpml-config-xml-file/</a>
</p>
<pre class="example">
&lt;wpml-config&gt;
    &lt;custom-fields&gt;
        &lt;custom-field action="copy"&gt;quantity&lt;/custom-field&gt;
        &lt;custom-field action="translate"&gt;custom-title&lt;/custom-field&gt;
    &lt;/custom-fields&gt;
    &lt;custom-types&gt;
        &lt;custom-type translate="1"&gt;book&lt;/custom-type&gt;
        &lt;custom-type translate="1"&gt;DVD&lt;/custom-type&gt;
    &lt;/custom-types&gt;
    &lt;taxonomies&gt;
        &lt;taxonomy translate="1"&gt;genre&lt;/taxonomy&gt;
    &lt;/taxonomies&gt;
    &lt;admin-texts&gt;
        &lt;key name="my_plugins_options"&gt;
            &lt;key name="option_name_1" /&gt;
            &lt;key name="option_name_2" /&gt;
            &lt;key name="options_group_1"&gt;
                &lt;key name="sub_option_name_11" /&gt;
                &lt;key name="sub_option_name_12" /&gt;
            &lt;/key&gt;
        &lt;/key&gt;
        &lt;key name="simple_string_option" /&gt;
    &lt;/admin-texts&gt;
&lt;/wpml-config&gt;
</pre>

<p>
custom-fields: the custom field name needs to be provided and also the action
</p>
<dl class="org-dl">
<dt>ignore</dt><dd>no action</dd>
<dt>translate</dt><dd>value is copied from the source but may be modified</dd>
<dt>copy</dt><dd>value is copied from the source and synchronized across translations</dd>
</dl>

<p>
custom-types: the custom post types that Polylang should manage. Once translate attribute is set, it cannot be changed in Polylang settings. 1 is to manage, 0 is not to manage.
</p>

<p>
taxonomies: the custom tax that Polylang should manage.
</p>

<p>
admin-texts: when get_option is called in themes or plugins, Polylang can filter these calls and provide translation to the values of these options.
</p>
<ul class="org-ul">
<li>Add a key name. A key can have children for serialization.</li>
</ul>
</div>
</li>
</ol>
</div>

<div id="outline-container-org40e59f2" class="outline-5">
<h5 id="org40e59f2"><span class="section-number-5">3.33.2.2</span> Sitemap and Permalink</h5>
<div class="outline-text-5" id="text-3-33-2-2">
<p>
After adding new language, the sitemap will be empty including the default language.
<a href="#orgc590ec0">wp:plugin:all-in-one-seo-pack</a> has to have Polylang set to "The language is set from different domains".
originaldomain.com/page1
fr.originaldomain.com/page1-french-name
</p>

<p>
Even the domain is different, the permalinks of the 2 pages in 2 different languages have to be different.
</p>

<p>
originaldomain.com/sitemap.xml
fr.originaldomain.com/sitemap.xml
</p>
</div>
</div>
</div>

<div id="outline-container-org4e50b22" class="outline-4">
<h4 id="org4e50b22"><span class="section-number-4">3.33.3</span> Resize image on the fly</h4>
<div class="outline-text-4" id="text-3-33-3">
<p>
<a id="org264c07b">fly-dynamic-image-resizer</a>
</p>

<p>
$image = fly_get_attachment_image_src(
 get_post_thumbnail_id(),
 array(160, 9999),
 false // true to crop to exact dimension
);
</p>

<p>
$image :: array(
 'src',
 'width',
 'height'
);
</p>

<p>
fly_add_image_size('lili-w600', 600, 9999, true);
$image = fly_get_attachment_image($post-&gt;id, 'lili-w600'); // HTML
</p>
</div>
</div>
<div id="outline-container-orgf0ae9b9" class="outline-4">
<h4 id="orgf0ae9b9"><span class="section-number-4">3.33.4</span> advanced-custom-fields - ACF <a id="orgb00414c">wp:plugin:acf</a></h4>
<div class="outline-text-4" id="text-3-33-4">
<p>
<a href="https://wordpress.org/plugins/advanced-custom-fields/">https://wordpress.org/plugins/advanced-custom-fields/</a>
</p>

<p>
Add a field group and then add custom fields under the group.
Use Location to define rules to assign the field group to a custom post type.
You can hide the default post fields (Content editor, comments, categories, etc.)
Make custom fields required
</p>

<p>
In <a href="#orgbe729c9">wp:The_Loop</a>, to display a custom field :: the_field('field_name')
To get the value :: get_field('field_name'); 
</p>
</div>
</div>
<div id="outline-container-org5b33b7d" class="outline-4">
<h4 id="org5b33b7d"><span class="section-number-4">3.33.5</span> types :: Toolset Types <a id="org0b59abb">wp:plugin:types</a></h4>
<div class="outline-text-4" id="text-3-33-5">
<p>
WP Types is different! Use <a id="orgb676416">types_render_field</a>
</p>

<pre class="example">
$newsletters = types_render_field('newsletters', array('output'=&gt;'raw'));
// the real field name is actually wpcf-newsletters
// For single line (text) field, use 'output'=&gt;'raw'
// For WYSIWYG field, use 'output'=&gt;'html'. 'raw' might be plain text
// For Image field

$_image = types_render_field('field-image', array('output'=&gt;'raw'));
// Output original full image url
// If 'output' =&gt; 'raw', 'size' and 'resize' will be ignored

// use 'url' =&gt; 'true' to output the url of the resized image.
$args = array('output'=&gt;'normal', 'url'=&gt;'true', 'width'=&gt; 300, 'resize'=&gt;'proportional');
// Output image url of a fixed width and dynamic height

$args = array('output'=&gt;'normal', 'url'=&gt;'true', 'size'=&gt;'medium', 'resize'=&gt;'proportional' );
// Output image url of a max width and height
// if 'size' is set, 'width' and 'height' will be ignored

/* 
 * 'size' =&gt; 'custom_image_size' | 'full' | 'large' | 'medium' | 'thumbnail'
 * Set 'size' and also 'resize' =&gt; 'crop' | 'proportional' | 'stretch' | 'pad'
 * If resize is necessary, set 'output' =&gt; 'normal'
 * 'padding_color' =&gt; 'transparent' | hex when resize=&gt;pad
 */
// For Image field.
</pre>

<p>
Refer to <a href="#org28d05fc">WP Types Custom Field Checkbox and WP Meta Query</a>
</p>
</div>

<div id="outline-container-org552d487" class="outline-5">
<h5 id="org552d487"><span class="section-number-5">3.33.5.1</span> Release</h5>
<div class="outline-text-5" id="text-3-33-5-1">
<p>
WP 3.7+
2.0
2.2.22 :: dropped support for PHP 5.2
</p>
</div>
</div>
</div>

<div id="outline-container-org06b0fb5" class="outline-4">
<h4 id="org06b0fb5"><span class="section-number-4">3.33.6</span> BackUpWordPress <a id="org00a129d">wp:plugin:backupwordpress</a></h4>
</div>
<div id="outline-container-org803fc16" class="outline-4">
<h4 id="org803fc16"><span class="section-number-4">3.33.7</span> backupbuddy (iThemes) <a id="org77a6175">wp:plugin:backupbuddy</a></h4>
</div>
<div id="outline-container-org5410e56" class="outline-4">
<h4 id="org5410e56"><span class="section-number-4">3.33.8</span> WP Migrate DB <a id="org775f196">wp:plugin:wp-migrate-db</a></h4>
<div class="outline-text-4" id="text-3-33-8">
<p>
With some string replace function. e.g.
//dev.bradt.ca =&gt; //bradt.ca
/sites/bradt.ca/public_html =&gt; /sites/bradt.ca/public_html
</p>

<p>
wp_options table keep track of recently_edited files that are edited on WP-admin and some other plugins might keep the filepath info.
</p>
</div>
</div>

<div id="outline-container-org684e643" class="outline-4">
<h4 id="org684e643"><span class="section-number-4">3.33.9</span> wordpress-importer</h4>
</div>
<div id="outline-container-orgf5750de" class="outline-4">
<h4 id="orgf5750de"><span class="section-number-4">3.33.10</span> wp-optimize</h4>
</div>
<div id="outline-container-org5415430" class="outline-4">
<h4 id="org5415430"><span class="section-number-4">3.33.11</span> duplicate-post <a id="orgdbc0e00">wp:plugin:duplicate-post</a></h4>
</div>
<div id="outline-container-org636a890" class="outline-4">
<h4 id="org636a890"><span class="section-number-4">3.33.12</span> Super Cache (SuperCache)</h4>
<div class="outline-text-4" id="text-3-33-12">
<p>
Warning: include(/var/www/html/wp-content/plugins/wp-super-cache/wp-cache-base.php): failed to open stream
</p>

<p>
If you encounter this problem, your WP_CACHE cache folder is not set properly. Check `wp-config.php`. You should see 
</p>

<pre class="example">
define('WP_CACHE',true);
define('WPCACHEHOME', ABSPATH. 'wp-content/plugins/wp-super-cache/');
</pre>

<p>
There's another place where the cache folder is defined: `$cache_path` in `wp-content/wp-cache-config.php` 
</p>

<p>
Uninstall
To manually uninstall:
</p>

<p>
• Turn off caching on the plugin settings page and clear the cache.
• Deactivate the plugin on the plugins page.
• Remove the WP_CACHE define from wp-config.php. It looks like define( 'WP_CACHE', true );
• Remove the Super Cache mod_rewrite rules from your .htaccess file.
• Remove the files wp-content/advanced-cache.php and wp-content/wp-cache-config.php
• Remove the directory wp-content/cache/
• Remove the directory wp-super-cache from your plugins directory.
</p>

<p>
If all else fails and your site is broken
	• Remove the WP_CACHE define from wp-config.php. It looks like define( 'WP_CACHE', true );
	• Remove the rules (see above) that the plugin wrote to the .htaccess file in your root directory.
	• Delete the wp-super-cache folder in the plugins folder.
	• Optionally delete advanced-cache.php, wp-cache-config.php and the cache folder in wp-content/.
</p>
</div>
</div>
<div id="outline-container-org6bed495" class="outline-4">
<h4 id="org6bed495"><span class="section-number-4">3.33.13</span> W3 Total Cache <a id="org24854a2">wp:plugin:w3-total-cache</a></h4>
<div class="outline-text-4" id="text-3-33-13">
</div>
<div id="outline-container-org06f9063" class="outline-5">
<h5 id="org06f9063"><span class="section-number-5">3.33.13.1</span> Manually remove</h5>
<div class="outline-text-5" id="text-3-33-13-1">
<p>
Files :: global search W3TC_ADDIN_FILE_
</p>

<p>
Backup and remove wp-content/plugins/w3-total-cache
Rename or remove wp-content/cache
Rename or remove wp-content/w3tc-config and maybe wp-content/w3tc
Rename or remove Files above under wp-content root :: advanced-cache.php db.php object-cache.php and maybe wp-total-cache-config.php
Remove lines related to w3tc in .htaccess
Remove line from wp-config.php define('WP_CACHE', true)
</p>
</div>
</div>

<div id="outline-container-orga0b0e5a" class="outline-5">
<h5 id="orga0b0e5a"><span class="section-number-5">3.33.13.2</span> Releases</h5>
<div class="outline-text-5" id="text-3-33-13-2">
<p>
0.9.5.1 &gt; 0.9.6 &gt; 0.9.7
</p>
</div>
</div>
</div>

<div id="outline-container-orga7d46a4" class="outline-4">
<h4 id="orga7d46a4"><span class="section-number-4">3.33.14</span> Yoast SEO wordpress-seo <a id="org1398647">wp:plugin:wordpress-seo</a></h4>
<div class="outline-text-4" id="text-3-33-14">
<p>
How to SEO? <a href="https://yoast.com/wordpress-seo/">https://yoast.com/wordpress-seo/</a>
</p>

<p>
API and fitlers <a href="https://yoast.com/wordpress/plugins/seo/api/">https://yoast.com/wordpress/plugins/seo/api/</a>
</p>

<p>
Link Google Search Console <a href="#org5e9364e">google:search console</a>
</p>
</div>

<div id="outline-container-org0824245" class="outline-5">
<h5 id="org0824245"><span class="section-number-5">3.33.14.1</span> Version</h5>
<div class="outline-text-5" id="text-3-33-14-1">
<p>
7 - UI
</p>
</div>
</div>

<div id="outline-container-org29310ba" class="outline-5">
<h5 id="org29310ba"><span class="section-number-5">3.33.14.2</span> Open Graph</h5>
<div class="outline-text-5" id="text-3-33-14-2">
<p>
Use at least 200x200 pixels image for `og:image`
You need to resave the post/article on WP first (to prevent WP Super Cache as FB crawler gets to the page differently) and then run Facebook Open Graph Object Debugger
</p>
</div>
</div>

<div id="outline-container-org88a379a" class="outline-5">
<h5 id="org88a379a"><span class="section-number-5">3.33.14.3</span> Turn off json-ld <a id="org5639fed">wp:plugin:wordpress-seo:json-ld</a></h5>
<div class="outline-text-5" id="text-3-33-14-3">
<p>
Once SEO &gt; Search Appearance &gt; General &gt; Knowledge Graph &gt; Company name and logo are specified, Plugin inserts Oranization and Website by default
</p>
<pre class="example">
{
  "@context": "http:\/\/schema.org",
  "@type": "WebSite",
  "@id": "#website",
  "url": "https:\/\/mywebsite.com\/",
  "name": "My Website Name",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https:\/\/mywebsite.com\/?s={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</pre>

<pre class="example">
{
  "@context": "http:\/\/schema.org",
  "@type": "Organization",
  "url": "https:\/\/mywebsite.com\/",
  "sameAs": [],
  "@id": "#organization",
  "name": "My Organization Name",
  "logo": "http:\/\/mywebsite.com\/wp-content\/uploads\/2018\/02\/logo.jpg"
}
</pre>

<p>
Use filter to turn it off and customize it
<a href="https://www.bybe.net/yoast-seo-guide-disable-schema-json-ld-wordpress/">https://www.bybe.net/yoast-seo-guide-disable-schema-json-ld-wordpress/</a>
</p>
<pre class="example">
function bybe_remove_yoast_json($data){
  $data = array();
  return $data;
}
add_filter('wpseo_json_ld_output', 'bybe_remove_yoast_json', 10, 1);
</pre>
</div>
</div>

<div id="outline-container-orgff70d11" class="outline-5">
<h5 id="orgff70d11"><span class="section-number-5">3.33.14.4</span> Turn off canonical</h5>
<div class="outline-text-5" id="text-3-33-14-4">
<p>
add_filter( 'wpseo_canonical', '__return_false' );
</p>
</div>
</div>

<div id="outline-container-orgddd4a6d" class="outline-5">
<h5 id="orgddd4a6d"><span class="section-number-5">3.33.14.5</span> Setting: turn off Author Archives</h5>
<div class="outline-text-5" id="text-3-33-14-5">
<p>
SEO &gt; Search Appearance &gt; Archives &gt; disable Author archive
Otherwise /author-sitemap.xml will show the admin name
</p>
</div>
</div>

<div id="outline-container-org4ca55d6" class="outline-5">
<h5 id="org4ca55d6"><span class="section-number-5">3.33.14.6</span> Release</h5>
<div class="outline-text-5" id="text-3-33-14-6">
<p>
1.5.2.7, 7.1, 7.5
</p>
</div>
</div>
</div>

<div id="outline-container-orgc50ecfb" class="outline-4">
<h4 id="orgc50ecfb"><span class="section-number-4">3.33.15</span> all-in-one-seo-pack <a id="orgc590ec0">wp:plugin:all-in-one-seo-pack</a></h4>
<div class="outline-text-4" id="text-3-33-15">
</div>
<div id="outline-container-orgee9cc24" class="outline-5">
<h5 id="orgee9cc24"><span class="section-number-5">3.33.15.1</span> Release</h5>
<div class="outline-text-5" id="text-3-33-15-1">
<p>
2.3.11.2
2.4.5 :: WP v4.0 to 4.4
2.4.6.1
</p>
</div>
</div>
</div>
<div id="outline-container-org83362fa" class="outline-4">
<h4 id="org83362fa"><span class="section-number-4">3.33.16</span> jetpack</h4>
<div class="outline-text-4" id="text-3-33-16">
<p>
Build wp with themes, unlimited image CDN from Photon, lazy loading images, brute force attack protection, downtime monitoring, automated social media posting. Paid plans: $3.5,9,29/month
</p>
</div>
</div>

<div id="outline-container-org5238064" class="outline-4">
<h4 id="org5238064"><span class="section-number-4">3.33.17</span> Disqus</h4>
<div class="outline-text-4" id="text-3-33-17">
<p>
If you receive a lot of errors about dsq_sync_forum in Apache logs, it is caused by Disqus tries to sync with WP comments so frequently.
</p>

<p>
First in WP Disqus setting, check "Disable automated comment importing"
</p>

<p>
Empty all cron rows in wp-options table `UPDATE wp_options SET option_value='' WHERE option_name='cron';"`
</p>

<p>
<a href="https://wordpress.org/support/topic/high-server-load-and-dsq_sync_forum-problem?replies=6">https://wordpress.org/support/topic/high-server-load-and-dsq_sync_forum-problem?replies=6</a>
</p>
</div>
</div>

<div id="outline-container-org826a04b" class="outline-4">
<h4 id="org826a04b"><span class="section-number-4">3.33.18</span> captcha (dead)</h4>
</div>
<div id="outline-container-orge558f27" class="outline-4">
<h4 id="orge558f27"><span class="section-number-4">3.33.19</span> disable-comments <a id="org0fad66f">wp:plugin:disable-comments</a></h4>
<div class="outline-text-4" id="text-3-33-19">
<p>
It provides and requires comment to be deleted. If you want to keep comments in db, use this custom code
</p>

<pre class="example">
function filter_media_comment_status( $open, $post_id ) {
  $post = get_post( $post_id );

  if( in_array($post-&gt;post_type, array('attachment', 'post')) ) {
   return false;
  }
  // or simply return false;
  return $open;
}
add_filter( 'comments_open', 'filter_media_comment_status', 10 , 2 );

// other actions might be needed
</pre>

<p>
Because in themes
</p>
<pre class="example">
if( comments_open() || get_comments_number() ) {
  // open or there's at least one comment
  comments_template();
}

// or for custom post types
if( post_type_supports( get_post_type(), 'comments' ) ) {
        // put comment related code here, including...
        if( comments_open() ) {
                // ...a comment form, maybe
        }
}
else {
        // sit back and relax
}
</pre>

<p>
wp UI &gt; Settings &gt; Discussion &gt; disable Allow People to post comments on new articles and disable "Allow link notifications from other blogs (pingbacks and trackbacks) on new articles"
</p>

<p>
Maybe useful to set "Automatically close comments on articles older than 0 days"
</p>
</div>
</div>

<div id="outline-container-org79d74c0" class="outline-4">
<h4 id="org79d74c0"><span class="section-number-4">3.33.20</span> disable-embeds <a id="orgc32620f">wp:plugin:disable-embeds</a></h4>
<div class="outline-text-4" id="text-3-33-20">
<p>
Disable embed, oEmbed and remove wp-embed.js <a href="https://kinsta.com/knowledgebase/disable-embeds-wordpress/">https://kinsta.com/knowledgebase/disable-embeds-wordpress/</a>
</p>
</div>
</div>

<div id="outline-container-org47c064a" class="outline-4">
<h4 id="org47c064a"><span class="section-number-4">3.33.21</span> all-in-one-event-calendar</h4>
<div class="outline-text-4" id="text-3-33-21">
<p>
Create a content type Event
</p>

<p>
<a href="https://wordpress.org/plugins/all-in-one-event-calendar/">https://wordpress.org/plugins/all-in-one-event-calendar/</a>
Shortcode to view all events
[ai1ec view="monthly"]
</p>

<p>
Create a blank page and associate it with Events &gt; Settings &gt; Viewing Events to show events and customize view
</p>

<p>
May create JavaScript script to embed on external websites
</p>
</div>
</div>

<div id="outline-container-orgbbdaf34" class="outline-4">
<h4 id="orgbbdaf34"><span class="section-number-4">3.33.22</span> contact-form-7</h4>
<div class="outline-text-4" id="text-3-33-22">
</div>
<div id="outline-container-org51665bf" class="outline-5">
<h5 id="org51665bf"><span class="section-number-5">3.33.22.1</span> Shortcode</h5>
<div class="outline-text-5" id="text-3-33-22-1">
<p>
Add html id
</p>
<pre class="example">
contact-form-7 id="1234" title="Contact form 1" html_id="contact-form-1234" html_class="form contact-form"]
</pre>
</div>
</div>

<div id="outline-container-org5d278e1" class="outline-5">
<h5 id="org5d278e1"><span class="section-number-5">3.33.22.2</span> autop <a id="org4b106c1">wp:p:contact-form-7:autop</a></h5>
<div class="outline-text-5" id="text-3-33-22-2">
<p>
wp-config.php
</p>
<pre class="example">
define( 'WPCF7_AUTOP', false );
</pre>
</div>
</div>

<div id="outline-container-orga2893b8" class="outline-5">
<h5 id="orga2893b8"><span class="section-number-5">3.33.22.3</span> hooks - reCaptcha</h5>
<div class="outline-text-5" id="text-3-33-22-3">
<p>
Default template
</p>
<pre class="example">
[response]

&lt;p&gt;&lt;label for="your-name"&gt;Your Name (required)&lt;/label&gt;&lt;br&gt;
[text* your-name id:your-name]&lt;/p&gt;

&lt;p&gt;&lt;label for="your-email"&gt;Your Email (required)&lt;/label&gt;&lt;br&gt;
[email* your-email id:your-email]&lt;/p&gt;

&lt;p&gt;&lt;label for="your-message"&gt;Your Message&lt;/label&gt;&lt;br&gt;
[textarea* your-message id:your-message]&lt;/p&gt;

&lt;p&gt;[submit "Send"]&lt;/p&gt;
</pre>

<p>
Turn off <a href="#org4b106c1">wp:p:contact-form-7:autop</a>
</p>
</div>

<ol class="org-ol">
<li><a id="org50f740c"></a>filter:wpcf7_form_elements<br />
<div class="outline-text-6" id="text-3-33-22-3-1">
<p>
Remove &lt;noscript&gt; for reCaptcha which has an iframe that is not WCAG ready
</p>
<pre class="example">
function csWpcf7FormElements($form) {
  try {
    $dom = new DOMDocument;
    $dom-&gt;loadHTML($form);
    $noscripts = $dom-&gt;getElementsByTagName('noscript');
    while ($noscripts-&gt;length &gt; 0) {
      $i = $noscripts-&gt;item(0);
      $i-&gt;parentNode-&gt;removeChild($i);
    }
    return $dom-&gt;saveHTML();
  }
  catch (Exception $err) {
    return $form;
  }

  return $form;

}
add_filter( 'wpcf7_form_elements', 'csWpcf7FormElements');
</pre>
</div>
</li>

<li><a id="orgdb6476c"></a>filter:shortcode_atts_wpcf7 <a id="org384e35b">wp:p:contact-form-7:f:shortcode_atts_wpcf7</a><br />
<div class="outline-text-6" id="text-3-33-22-3-2">
<pre class="example">
add_filter( 'shortcode_atts_wpcf7', 'custom_shortcode_atts_wpcf7_filter', 10, 3 );

function custom_shortcode_atts_wpcf7_filter( $out, $pairs, $atts ) {
    $my_attr = 'destination-email';

    if ( isset( $atts[$my_attr] ) ) {
        $out[$my_attr] = $atts[$my_attr];
    }

    return $out;
}
</pre>
</div>
</li>

<li><a id="org9aba474"></a>action:wpcf7_before_send_mail <a id="org8866e5b">wp:p:contact-form-7:a:wpcf7_before_send_mail</a><br /></li>
</ol>
</div>
<div id="outline-container-org7d7f3dc" class="outline-5">
<h5 id="org7d7f3dc"><span class="section-number-5">3.33.22.4</span> DOM Events</h5>
<div class="outline-text-5" id="text-3-33-22-4">
<p>
<a href="https://contactform7.com/dom-events/">https://contactform7.com/dom-events/</a>
</p>

<p>
wpcf7invalid — Fires when an Ajax form submission has completed successfully, but mail hasn’t been sent because there are fields with invalid input.
wpcf7spam — Fires when an Ajax form submission has completed successfully, but mail hasn’t been sent because a possible spam activity has been detected.
wpcf7mailsent — Fires when an Ajax form submission has completed successfully, and mail has been sent.
wpcf7mailfailed — Fires when an Ajax form submission has completed successfully, but it has failed in sending mail.
wpcf7submit — Fires when an Ajax form submission has completed successfully, regardless of other incidents.
</p>

<p>
event.detail
detail.inputs
detail.contactFormId	The ID of the contact form.
detail.pluginVersion	The version of Contact Form 7 plugin.
detail.contactFormLocale	The locale code of the contact form.
detail.unitTag	The unit-tag of the contact form.
detail.containerPostId	The ID of the post that the contact form is placed in.
</p>

<p>
Example redirect to a page
</p>
<pre class="example">
document.addEventListener( 'wpcf7mailsent', function( event ) {
  var inputs = event.detail.inputs;
  if ( '123' == event.detail.contactFormId) {
    location = 'http://example.com/';
  }
}, false );
</pre>

<pre class="example">
document.addEventListener( 'wpcf7submit', function( event ) {
    var inputs = event.detail.inputs;

    for ( var i = 0; i &lt; inputs.length; i++ ) {
        if ( 'your-name' == inputs[i].name ) {
            alert( inputs[i].value );
            break;
        }
    }
}, false );
</pre>
</div>
</div>

<div id="outline-container-org3a5cb42" class="outline-5">
<h5 id="org3a5cb42"><span class="section-number-5">3.33.22.5</span> Form tags, akismet</h5>
<div class="outline-text-5" id="text-3-33-22-5">
<pre class="example">
Select Country (required)
[checkbox* your-country use_label_element "China" "India" "San Marino"]

Select Sports
[radio your-sports label_first default:2 "Football" "Tennis" "Pole-vault"]

Select Fruit (required)
[checkbox* your-fruit exclusive "Apple" "Banana" "Grape"]

Select Browser (required)
[select* your-browser include_blank "Firefox" "Safari" "Opera" "Lynx"]

Select Ghkdsjdf
[select your-ghkdsjdf multiple "fsdfs" "klgjfk" "vdrie"]

[submit "Send"]
</pre>
</div>

<ol class="org-ol">
<li><a id="orge7ff68e"></a><a href="https://contactform7.com/spam-filtering-with-akismet/">Akismet</a><br />
<div class="outline-text-6" id="text-3-33-22-5-1">
<p>
akismet:author
Add this option to the field that accepts the name of the sender.
Example: [text* your-name akismet:author]
akismet:author_email
Add this option to the field that accepts the email address of the sender.
Example: [email* your-email akismet:author_email]
akismet:author_url
Add this option to the field that accepts the URL of the sender.
Example: [text your-url akismet:author_url]
</p>

<p>
Test viagra-test-123 as name
</p>
</div>
</li>

<li><a id="org7682611"></a>File upload<br />
<div class="outline-text-6" id="text-3-33-22-5-2">
<p>
<a href="https://contactform7.com/file-uploading-and-attachment/">https://contactform7.com/file-uploading-and-attachment/</a>
</p>
<pre class="example">
[file your-file filetypes:pdf|txt limit:2mb]
//id:foo
//limit:1048576
//limit:1024kb
//limit:1mb

// multiple classes
// class:y2008 class:m01 class:d01
</pre>

<p>
Default file upload location is wp-content/uploads/wpcf7_uploads
</p>
</div>
</li>

<li><a id="org919a733"></a>select with pipes<br />
<div class="outline-text-6" id="text-3-33-22-5-3">
<pre class="example">
[select your-recipient "CEO|ceo@example.com"
                    "Sales|sales@example.com"
                    "Support|support@example.com"]
</pre>
<p>
Only the part before pipes are revealed on the front end to prevent spam.
Use [your-recipient] in the Mail template. To get value before pipe, [_raw<sub>field name</sub>] e.g. [_raw_your-recipient]
</p>
</div>
</li>

<li><a id="org00d038e"></a>Attribute - default<br />
<div class="outline-text-6" id="text-3-33-22-5-4">
<pre class="example">
// The field will obtain its default value from the GET variable with the same name (“your-name”)
// http://example.com/contact/?your-name=John+Smith
// John Smith
[text* your-name default:get]

// This form-tag has two default options and a value “Your Name”. The options are evaluated from the first to the last. In this example, default:get is evaluated first. If the “your-name” GET variable has a value, it will be used for the default value. If that value is empty, default:post_meta will be evaluated next. If both of these options do not have values, “Your Name” will be used.
[text* your-name default:get default:post_meta "Your Name"]
</pre>

<p>
<a href="https://contactform7.com/setting-default-values-to-the-logged-in-user/">Logged-in user fields</a>
</p>
<pre class="example">
Your Name: [text* your-name default:user_display_name]
Your E-mail: [email* your-email default:user_email]
</pre>

<p>
Get default from shortcode attributes
</p>
<pre class="example">
[contact-form-7 id="123" title="Contact Form" destination-email="xxxxxx@example.com"]

[email* destination-email default:shortcode_attr]

// Filter needs to setup to catch custom attributes. Refer to wp:p:contact-form-7:f:shortcode_atts_wpcf7
</pre>
</div>
</li>

<li><a id="org6cef07f"></a>hidden fields<br />
<div class="outline-text-6" id="text-3-33-22-5-5">
<p>
id:foo, 
</p>
<pre class="example">
[hidden your-text class:y2008 class:m01 class:d01]
[hidden your-email default:user_email "example@example.com"]
</pre>
</div>
</li>
</ol>
</div>

<div id="outline-container-org395f353" class="outline-5">
<h5 id="org395f353"><span class="section-number-5">3.33.22.6</span> multifile-upload-field-for-contact-form-7</h5>
<div class="outline-text-5" id="text-3-33-22-6">
<p>
Form tag [multifile your-photos] to upload multiple files as one zip file
</p>
</div>
</div>
<div id="outline-container-org2dfa0d6" class="outline-5">
<h5 id="org2dfa0d6"><span class="section-number-5">3.33.22.7</span> contact-form-7-confirm-email-feild</h5>
<div class="outline-text-5" id="text-3-33-22-7">
<p>
Confirm email field 
</p>

<pre class="example">
[email* your-email akismet:author_email]
&lt;label&gt; &lt;p&gt;Confirm Email:&lt;/p&gt; [confirm_email* confirm-email]&lt;/label&gt;
</pre>
</div>
</div>

<div id="outline-container-org79f784b" class="outline-5">
<h5 id="org79f784b"><span class="section-number-5">3.33.22.8</span> flamingo</h5>
<div class="outline-text-5" id="text-3-33-22-8">
<p>
save form submission
By default, flamingo will take [your-subject] [your-name] [your-email]. Overwrite them
</p>

<p>
Additional Settings in the contact form
</p>
<pre class="example">
flamingo_email: "[the-email-field]"
flamingo_name: "[the-name-field]"
flamingo_subject: "[the-subject-field]"
</pre>
</div>
</div>

<div id="outline-container-org10df3cb" class="outline-5">
<h5 id="org10df3cb"><span class="section-number-5">3.33.22.9</span> contact-form-plugin</h5>
<div class="outline-text-5" id="text-3-33-22-9">
<p>
receive messages from customers to your email addresses. Download, activate and paste [bestwebsoft_contact_form] shortcode on any page, post or widget to display the form. Customize the form styles and contents easily with the pre-build options.
</p>
</div>
</div>

<div id="outline-container-orga202090" class="outline-5">
<h5 id="orga202090"><span class="section-number-5">3.33.22.10</span> Release</h5>
<div class="outline-text-5" id="text-3-33-22-10">
<p>
3.7.2
4.0 :: WP 3.9+
4.1 :: WP 4.0+
4.9 :: WP 4.7+
5.0 :: WP 4.8+, on_sent_ok and on_submit are removed
5.0.1
</p>
</div>
</div>
</div>
<div id="outline-container-org5387048" class="outline-4">
<h4 id="org5387048"><span class="section-number-4">3.33.23</span> constant-contact-forms</h4>
<div class="outline-text-4" id="text-3-33-23">
<p>
Require WP 4.0+ and PHP 5.4+
Widget: Constant Contact Form
shortcode: [ctct form="5872"]
</p>
</div>

<div id="outline-container-orga93bbd7" class="outline-5">
<h5 id="orga93bbd7"><span class="section-number-5">3.33.23.1</span> Setting</h5>
<div class="outline-text-5" id="text-3-33-23-1">
<p>
Enable logging
</p>
</div>
</div>

<div id="outline-container-org86f8852" class="outline-5">
<h5 id="org86f8852"><span class="section-number-5">3.33.23.2</span> wp filters</h5>
<div class="outline-text-5" id="text-3-33-23-2">
<p>
Add label on ConstantContact.com for custom field values
add_filter( 'constant_contact_include_custom_field_label', '__return_true' );
</p>
</div>
</div>

<div id="outline-container-org04090c0" class="outline-5">
<h5 id="org04090c0"><span class="section-number-5">3.33.23.3</span> Caveats</h5>
<div class="outline-text-5" id="text-3-33-23-3">
<p>
There's no name field only first name and last name field captured on ConstantContact.com
</p>

<p>
If there're more than one Constant Contact forms, the form fields will have the same id. This will create a problem when clicking a later opt-in checkbox label always jump to the first opt-in checkbox
</p>

<p>
Make opt-in checkbox required and fix opt-in checkbox label
</p>
<pre class="example">
$(function(){
    $('label[for=ctct-opt-in]').prev().addClass('ctct-form-field-required').prop('required',true);;

    $('label[for=ctct-opt-in]').on('click', function(e){
      e.preventDefault();
      e.stopPropagation();
      var $input = $( this ).prev(); // previous sibling
      $input.prop('checked', !$input.prop("checked")); // jQuery 1.6+
    });

});
</pre>
</div>
</div>
</div>

<div id="outline-container-orgffa9b87" class="outline-4">
<h4 id="orgffa9b87"><span class="section-number-4">3.33.24</span> constant-contact-forms-by-mailmunch</h4>
<div class="outline-text-4" id="text-3-33-24">
<p>
It takes way too much work to customize the form..
</p>
</div>
</div>

<div id="outline-container-org40920a0" class="outline-4">
<h4 id="org40920a0"><span class="section-number-4">3.33.25</span> custom-search-plugin</h4>
<div class="outline-text-4" id="text-3-33-25">
<p>
Custom Search plugin adds custom post types and taxonomies to WordPress website search results. A quick and easy way to search everything within custom post types and taxonomies.
</p>
</div>
</div>

<div id="outline-container-org6af1593" class="outline-4">
<h4 id="org6af1593"><span class="section-number-4">3.33.26</span> custom-permalinks</h4>
<div class="outline-text-4" id="text-3-33-26">
<p>
Change URL to any structure for individual post, page, tag or category.
Need to resave Permalinks setting
</p>
</div>
</div>

<div id="outline-container-org40631b8" class="outline-4">
<h4 id="org40631b8"><span class="section-number-4">3.33.27</span> redirection</h4>
<div class="outline-text-4" id="text-3-33-27">
<p>
<a href="https://wordpress.org/plugins/redirection/">https://wordpress.org/plugins/redirection/</a>
</p>

<p>
Redirect without .htaccess
</p>
</div>
</div>

<div id="outline-container-org7bb9802" class="outline-4">
<h4 id="org7bb9802"><span class="section-number-4">3.33.28</span> hc-custom-wp-admin-url</h4>
</div>

<div id="outline-container-org1956dcc" class="outline-4">
<h4 id="org1956dcc"><span class="section-number-4">3.33.29</span> better-wp-security (iThemes Security)</h4>
<div class="outline-text-4" id="text-3-33-29">
<p>
<a href="https://en-ca.wordpress.org/plugins/better-wp-security/">https://en-ca.wordpress.org/plugins/better-wp-security/</a>
</p>

<p>
Latest plugin version usually requires the latest WP Core.
PHP version 5.2+
Site has to run either on Apache, LightSpeed or Nginx
Work on multi-site
</p>

<p>
Will add lines to .htaccess and wp-config.php
</p>

<p>
Banned Users :: get blacklisted IPs, user agents and apply to your website. Enable HackRepair.com's blacklist feature
</p>
<ul class="org-ul">
<li>HackRepair is enalbed, then .htaccess is modified to add user agents and referrer rules for blocking (Forbidden) access.</li>
</ul>

<p>
Local Brute Force Protection :: Ban hosts and users with invalid login attempts
404 Detection :: locks out someone that gets too many 404 pages
Global Settings :: Lockout White List by IP
</p>

<p>
Network Brute Force Protection :: enabled by default
WordPress Tweaks : enabled by default
</p>

<p>
Away mode :: Disable access to wp Dashboard on a schedule
</p>

<p>
Scan site to report vulnerabilities and try to fix them
Ban bad user agents, bots and other hosts
Enforce strong passwords for all accounts
Force SSL for admin pages and any pages
Turn off file editing from wp-admin UI
Detect and block attacks to filesystem and database
Change URLs of login, admin
Turn off the ability to login for a given time period
Remove theme, plugin and core update notifications from users who do not have permission to update them
Remove Windows Live Write header info
Remove RSD header info
Rename admin account
Change ID on the user with ID 1
Change database table prefix
Change wp-content path
Remove login error messages
</p>
</div>

<div id="outline-container-org8b9c6f8" class="outline-5">
<h5 id="org8b9c6f8"><span class="section-number-5">3.33.29.1</span> Release</h5>
<div class="outline-text-5" id="text-3-33-29-1">
<p>
3.6.5
6.9.2 &gt; 7.0.1
</p>
</div>
</div>
</div>

<div id="outline-container-orga492a74" class="outline-4">
<h4 id="orga492a74"><span class="section-number-4">3.33.30</span> Exploit scanner exploit-scanner <a id="orgb44ba0a">wp:plugin:exploit-scanner</a></h4>
<div class="outline-text-4" id="text-3-33-30">
<p>
Search the files on your website, and the posts and comments tables of your database for anything suspicious. It also examines your list of active plugins for unusual filenames.
</p>

<p>
You need to have wp-content/plugins/exployt-scanner/hashes-4.9.6.php to match the wp version in order for the file checking to work correct
<a href="https://github.com/philipjohn/exploit-scanner-hashes">https://github.com/philipjohn/exploit-scanner-hashes</a>
</p>
</div>
</div>

<div id="outline-container-org5d2f503" class="outline-4">
<h4 id="org5d2f503"><span class="section-number-4">3.33.31</span> tinymce-advanced</h4>
<div class="outline-text-4" id="text-3-33-31">
<p>
Add, remove and arrange buttons shown on the Visual Editor toolbar.
Enable or disable 15 plugins for TinyMCE.
Modify options such as keeping the paragrah tags in the Text editor and importing CSS classes from the theme's editor-style.css
</p>

<p>
Always update as wp core updates
</p>
</div>
</div>

<div id="outline-container-orge445050" class="outline-4">
<h4 id="orge445050"><span class="section-number-4">3.33.32</span> black-studio-tinymce-widget</h4>
<div class="outline-text-4" id="text-3-33-32">
<p>
Add a "Visual Editor" widget like WYSIWYG TinyMCE switching between Visual and HTML mode.
Since WP Core 4.8, it has Visual text widget but it's minimal.
</p>
</div>
</div>

<div id="outline-container-orgc8c8e6f" class="outline-4">
<h4 id="orgc8c8e6f"><span class="section-number-4">3.33.33</span> menu-image</h4>
</div>
<div id="outline-container-orgbaeac60" class="outline-4">
<h4 id="orgbaeac60"><span class="section-number-4">3.33.34</span> multiple-featured-images <a id="orgd3e5a3a">wp:plugin:multiple-featured-images</a></h4>
<div class="outline-text-4" id="text-3-33-34">
<pre class="example">
add_filter( 'kdmfi_featured_images', function( $featured_images ) {
    $args_1 = array(
        'id' =&gt; 'featured-image-2',
        'desc' =&gt; 'Your description here.',
        'label_name' =&gt; 'Featured Image 2',
        'label_set' =&gt; 'Set featured image 2',
        'label_remove' =&gt; 'Remove featured image 2',
        'label_use' =&gt; 'Set featured image 2',
        'post_type' =&gt; array( 'page' ),
    );

    $args_2 = array(
        'id' =&gt; 'featured-image-3',
        'desc' =&gt; 'Your description here.',
        'label_name' =&gt; 'Featured Image 3',
        'label_set' =&gt; 'Set featured image 3',
        'label_remove' =&gt; 'Remove featured image 3',
        'label_use' =&gt; 'Set featured image 3',
        'post_type' =&gt; array( 'page', 'post' ),
    );

    $featured_images[] = $args_1;
    $featured_images[] = $args_2;

    return $featured_images;
});
</pre>
</div>
</div>

<div id="outline-container-org9c4c5cb" class="outline-4">
<h4 id="org9c4c5cb"><span class="section-number-4">3.33.35</span> responsive-lightbox</h4>
<div class="outline-text-4" id="text-3-33-35">
<p>
<a href="https://dfactory.eu/docs/responsive-lightbox/manual-usage/">https://dfactory.eu/docs/responsive-lightbox/manual-usage/</a>
By default, RL applies effects to all published images, videos and galleries.
</p>

<p>
Settings &gt; Responsive Lightbox &gt; General settings
</p>
<ul class="org-ul">
<li>set Selector and enable lightbox for WordPress image links. This is the manual way.</li>
<li>(default) Enable lightbox for WordPress image links will apply to all published images</li>

<li>set Display single post images as a gallery. This is the manual way to create gallery</li>
<li>(default) Add lightbox to WordPress image galleries by default.</li>

<li>(default) Add lightbox to YouTube and Vimeo video links by default.</li>
</ul>

<pre class="example">
// Manual on single image
&lt;a href="image-link" data-rel="lightbox"&gt;&lt;img class ="some-text-here" src="image-link" /&gt;&lt;/a&gt;

// Manual on single gallery
&lt;a href="image-link" data-rel="lightbox-gallery-182"&gt;&lt;img class ="some-text-here" src="image-link" /&gt;&lt;/a&gt;
</pre>
</div>
</div>

<div id="outline-container-org5541182" class="outline-4">
<h4 id="org5541182"><span class="section-number-4">3.33.36</span> revslider (not in WP directory)</h4>
<div class="outline-text-4" id="text-3-33-36">
<p>
Display in template
</p>
<pre class="example">
putRevSlider("home");
putRevSlider("home","homepage"); // only display if current page is homepage
putRevSlider("home","2,10"); // only display if current page has an ID
</pre>

<p>
Shortcode
</p>
<pre class="example">
[rev_slider home]
</pre>

<p>
Add Revolution Slider widget to the desired sidebar
</p>
</div>
</div>

<div id="outline-container-org31f733b" class="outline-4">
<h4 id="org31f733b"><span class="section-number-4">3.33.37</span> wpfront-scroll-top</h4>
</div>
<div id="outline-container-org1a4dcee" class="outline-4">
<h4 id="org1a4dcee"><span class="section-number-4">3.33.38</span> vertical-marquee-plugin</h4>
<div class="outline-text-4" id="text-3-33-38">
<p>
In your WordPress administrator section go to Settings menu and select Vertical marquee plugin menu to configure this plugin.
</p>

<p>
Scroll Amount : This is used to organize the speed of the scrolling, only integer allowed and higher value provides a faster speed
Scroll Delay : This is used to reduce the speed of the scrolling, only integer allowed.
</p>

<p>
Drag and drop the widget : Go to widget menu and drag and drop the Vertical marquee widget to your sidebar location.
</p>

<p>
Short code for pages and posts : Use the below short code in the pages and posts.
</p>

<p>
[vertical-marguee setting="1" group="group1"]
</p>

<p>
Add directly in the theme : Add the below PHP code in your theme PHP file, for example if you want to add this slider in your website footer, just activate the plugin and add this code in footer.php file.
</p>

<p>
From version 1.0 to 4.0
</p>

<p>
&lt;?php verticalmarquee(); ?&gt;
</p>

<p>
From version 4.0 onwards
</p>

<p>
&lt;?php vmarquee( $setting="1", $group="widget" ); ?&gt;
</p>
</div>
</div>

<div id="outline-container-org504d779" class="outline-4">
<h4 id="org504d779"><span class="section-number-4">3.33.39</span> vertical-scroll-recent-post</h4>
</div>
<div id="outline-container-org71b7f50" class="outline-4">
<h4 id="org71b7f50"><span class="section-number-4">3.33.40</span> recent-posts-widget-extended</h4>
</div>

<div id="outline-container-org1d66daa" class="outline-4">
<h4 id="org1d66daa"><span class="section-number-4">3.33.41</span> widget-logic</h4>
</div>
<div id="outline-container-org952e498" class="outline-4">
<h4 id="org952e498"><span class="section-number-4">3.33.42</span> widget-css-classes</h4>
</div>
<div id="outline-container-org925680f" class="outline-4">
<h4 id="org925680f"><span class="section-number-4">3.33.43</span> breadcrumb-navxt</h4>
<div class="outline-text-4" id="text-3-33-43">
<p>
<a href="https://wordpress.org/plugins/breadcrumb-navxt/#installation">https://wordpress.org/plugins/breadcrumb-navxt/#installation</a>
After installing and activating the plugin, to get breadcrumb trails to display either use the included widget, or call the breadcrumb trail in your theme (or child theme). See the Calling the Breadcrumb Trail article for more information on calling the breadcrumb trail.
</p>
</div>

<div id="outline-container-orga568bba" class="outline-5">
<h5 id="orga568bba"><span class="section-number-5">3.33.43.1</span> Release</h5>
<div class="outline-text-5" id="text-3-33-43-1">
<p>
5.0.1
6.0.4
</p>
</div>
</div>
</div>
<div id="outline-container-org93f3901" class="outline-4">
<h4 id="org93f3901"><span class="section-number-4">3.33.44</span> sendgrid-email-delivery-simplified</h4>
</div>
<div id="outline-container-org00f639e" class="outline-4">
<h4 id="org00f639e"><span class="section-number-4">3.33.45</span> woocommerce</h4>
<div class="outline-text-4" id="text-3-33-45">
</div>
<div id="outline-container-org4449997" class="outline-5">
<h5 id="org4449997"><span class="section-number-5">3.33.45.1</span> Basics</h5>
<div class="outline-text-5" id="text-3-33-45-1">
<p>
<a href="https://docs.woocommerce.com/documentation/plugins/woocommerce/getting-started/">https://docs.woocommerce.com/documentation/plugins/woocommerce/getting-started/</a>
</p>

<p>
In order to remove data in db when removing the plugin, add this first then deactive and delete the plugin:
</p>
<div class="org-src-container">
<pre class="src src-php">define( <span style="color: #e67128;">'WC_REMOVE_ALL_DATA'</span>, <span style="color: #008b8b;">true</span>);
<span style="color: #74af68;">/* </span><span style="color: #74af68;">That's all, stop editing! Happy blogging. */</span>
</pre>
</div>

<dl class="org-dl">
<dt>To update extension/payment gateways, connect to WooCommerce.com</dt><dd>WooCommerce &gt; Extensions &gt; WooCommerce.com Subscriptions</dd>

<dt>Db structure</dt><dd><a href="https://github.com/woocommerce/woocommerce/wiki/Database-Description">https://github.com/woocommerce/woocommerce/wiki/Database-Description</a></dd>
</dl>
<p>
Please note, each table name will be prefixed with your WP Database Table Prefix e.g. wp_
The database scheme is defined in woocommerce/includes/class-wc-install.php
</p>

<dl class="org-dl">
<dt>It creates some custom post types and taxonomies</dt><dd><a href="https://docs.woocommerce.com/document/installed-taxonomies-post-types/">https://docs.woocommerce.com/document/installed-taxonomies-post-types/</a></dd>

<dt>(no term)</dt><dd>It creates some pages</dd>
<dt>To check whether they are installed or to install them</dt><dd>WooCommerce &gt; System Status &gt; Tools</dd>
<dt>To custom page for Cart and Checkout</dt><dd>WooCommerce &gt; Settings &gt; Checkout</dd>
<dt>For My Account</dt><dd>WooCommerce &gt; Settings &gt; Accounts</dd>
<dt>For Shop page (archive page for all products) </dt><dd>WooCommerce &gt; Settings &gt; Products</dd>
</dl>

<p>
Endpoints
Starting v2.1 shortcodes are replaced with endpoints
</p>
<dl class="org-dl">
<dt>My Account page endpoints</dt><dd>WooCommerce &gt; Settings &gt; Accounts
<ul class="org-ul">
<li>e.g. yoursite.com/my-account/edit-account</li>
</ul></dd>
<dt>Checkout page endpoints</dt><dd>WooCommerce &gt; Settings &gt; Checkout
<ul class="org-ul">
<li>retrieve URL using <code>$order</code>
<ul class="org-ul">
<li><code>$order-&gt;get_checkout_payment_url( $on_checkout = false );</code></li>
<li><code>$order-&gt;get_checkout_order_received_url();</code></li>
</ul></li>
</ul></dd>
</dl>

<p>
<a href="https://github.com/woocommerce/woocommerce">https://github.com/woocommerce/woocommerce</a>
<a href="https://docs.woocommerce.com/documentation/plugins/woocommerce/woocommerce-codex/">https://docs.woocommerce.com/documentation/plugins/woocommerce/woocommerce-codex/</a>
</p>
</div>
</div>

<div id="outline-container-org6e36ae9" class="outline-5">
<h5 id="org6e36ae9"><span class="section-number-5">3.33.45.2</span> Payment Gateways</h5>
<div class="outline-text-5" id="text-3-33-45-2">
<p>
<a href="https://woocommerce.com/posts/woocommerce-payments-affordably/">https://woocommerce.com/posts/woocommerce-payments-affordably/</a>
</p>

<p>
In WooCommerce core :: Stripe and PayPal Powered by Braintree. Old WooCommerce plugin can also download these gateways for free.
</p>
<ul class="org-ul">
<li>On-site</li>
</ul>

<p>
<a href="https://woocommerce.com/products/stripe/">Stripe</a> :: pay 2.9% + 30 cents per successful credit card transaction, as long as your yearly charges are below $1 million.
</p>
<ul class="org-ul">
<li>Credit cards</li>
</ul>

<p>
<a href="https://woocommerce.com/products/woocommerce-gateway-paypal-powered-by-braintree/">PayPal Powered by Braintree</a> :: 2.9%+30 cents per successful credit card or digital wallet transaction (e.g. Apply Pay)
</p>
<ul class="org-ul">
<li>Credit cards and debit cards</li>
<li>Payment from buyers' PayPal accounts</li>
</ul>
</div>
</div>

<div id="outline-container-org588be74" class="outline-5">
<h5 id="org588be74"><span class="section-number-5">3.33.45.3</span> hooks</h5>
<div class="outline-text-5" id="text-3-33-45-3">
</div>
<ol class="org-ol">
<li><a id="orgccd8970"></a>Add a custom field to Order :: woocommerce_shop_order_search_fields, manage_shop_order_posts_custom_column<br />
<div class="outline-text-6" id="text-3-33-45-3-1">
<p>
Add search on custom field
</p>
<div class="org-src-container">
<pre class="src src-php">add_filter( <span style="color: #e67128;">'woocommerce_shop_order_search_fields'</span>, <span style="color: #e67128;">'lili_wc_shop_order_search_field_myfield'</span> );
<span style="color: #ffad29; font-weight: bold;">function</span> <span style="color: #00ede1; font-weight: bold;">lili_wc_shop_order_search_field_myfield</span>( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">search_fields</span> ) {
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">search_fields</span>[] = <span style="color: #e67128;">'_myfield'</span>; <span style="color: #74af68;">// </span><span style="color: #74af68;">You can add a WooCommerce builtin order field without creating a field </span>
  <span style="color: #74af68;">// </span><span style="color: #74af68;">start with _</span>
  <span style="color: #ffad29; font-weight: bold;">return</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">search_fields</span>;
}
</pre>
</div>

<p>
Add a column to the 3rd position
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffad29; font-weight: bold;">function</span> <span style="color: #00ede1; font-weight: bold;">ra_order_tax_receipt_columns</span>(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">columns</span>) {
    <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">columnsF</span> = array_slice(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">columns</span>, 0, 2);
    <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">columnL</span> = array_slice(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">columns</span>, 2);
    <span style="color: #ffad29; font-weight: bold;">return</span> array_merge(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">columnsF</span>, <span style="color: #ffad29; font-weight: bold;">array</span>(<span style="color: #e67128;">'myfield'</span> =&gt; <span style="color: #008b8b;">__</span>(<span style="color: #e67128;">'My Field Name'</span>)), <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">columnL</span>);
}
add_filter(<span style="color: #e67128;">'manage_edit-shop_order_columns'</span> , <span style="color: #e67128;">'ra_order_tax_receipt_columns'</span>, 2);

add_action( <span style="color: #e67128;">'manage_shop_order_posts_custom_column'</span> , <span style="color: #e67128;">'lili_wc_shop_order_search_field_myfield_content'</span>, 10, 2 );
<span style="color: #ffad29; font-weight: bold;">function</span> <span style="color: #00ede1; font-weight: bold;">lili_wc_shop_order_search_field_myfield_content</span>( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">column</span> ) {
    <span style="color: #ffad29; font-weight: bold;">global</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">post</span>, <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">woocommerce</span>, <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">the_order</span>;
    <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">order_id</span> = <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">the_order</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #dbdb95;">id</span>;
    <span style="color: #ffad29; font-weight: bold;">switch</span> ( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">column</span> ) {
     <span style="color: #ffad29; font-weight: bold;">case</span> <span style="color: #e67128;">'myfield'</span> :
       <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">order_items</span> = <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">the_order</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #e1e1e0; background-color: #2d3743;">get_items</span>();
       <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">myVarOne</span> = get_post_meta(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">order_id</span>, <span style="color: #e67128;">'_myfield'</span>, <span style="color: #008b8b;">true</span> );
       <span style="color: #ffad29; font-weight: bold;">echo</span> <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">myVarOne</span>;
       <span style="color: #ffad29; font-weight: bold;">break</span>;
    }
}
</pre>
</div>
</div>
</li>

<li><a id="org754dca6"></a>Page/Template hooks<br />
<div class="outline-text-6" id="text-3-33-45-3-2">
<p>
<a href="https://businessbloomer.com/woocommerce-visual-hook-guide-archiveshopcat-page/">https://businessbloomer.com/woocommerce-visual-hook-guide-archiveshopcat-page/</a>
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org1babed6" class="outline-5">
<h5 id="org1babed6"><span class="section-number-5">3.33.45.4</span> Product</h5>
<div class="outline-text-5" id="text-3-33-45-4">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_pf</span> = <span style="color: #ffad29; font-weight: bold;">new</span> <span style="color: #34cae2;">WC_Product_Factory</span>();
<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_p</span>  = <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_pf</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #e1e1e0; background-color: #2d3743;">get_product</span>( 123 );

<span style="color: #ffad29; font-weight: bold;">echo</span> apply_filters(
  <span style="color: #e67128;">'woocommerce_loop_add_to_cart_link'</span>,
  sprintf(
  <span style="color: #e67128;">'&lt;a href="%s" rel="nofollow" data-product_id="%s" data-product_sku="%s" class="button product_type_simple add_to_cart_button ajax_add_to_cart"&gt;%s %s&lt;/a&gt;'</span>,
  esc_url( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_p</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #e1e1e0; background-color: #2d3743;">add_to_cart_url</span>() ),
  esc_attr( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_p</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #e1e1e0; background-color: #2d3743;">get_id</span>() ),
  esc_attr( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_p</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #e1e1e0; background-color: #2d3743;">get_sku</span>() ),
  implode( <span style="color: #e67128;">' '</span>, array_filter( [
    <span style="color: #e67128;">'button'</span>,
    <span style="color: #e67128;">'product_type_'</span> . <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_p</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #dbdb95;">product_type</span>,
    <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_p</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #e1e1e0; background-color: #2d3743;">is_purchasable</span>() &amp;&amp; <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_p</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #e1e1e0; background-color: #2d3743;">is_in_stock</span>() ? <span style="color: #e67128;">'add_to_cart_button'</span> : <span style="color: #e67128;">''</span>,
    <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_p</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #e1e1e0; background-color: #2d3743;">supports</span>( <span style="color: #e67128;">'ajax_add_to_cart'</span> ) ? <span style="color: #e67128;">'ajax_add_to_cart'</span> : <span style="color: #e67128;">''</span>,
  ] ) ),
  esc_attr( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_p</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #dbdb95;">product_type</span> ),
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_p</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #e1e1e0; background-color: #2d3743;">get_price_html</span>(),
  esc_attr( <span style="color: #ffad29; font-weight: bold;">isset</span>( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">class</span> ) ? <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">class</span> : <span style="color: #e67128;">'button'</span> ),
  esc_html( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_p</span><span style="color: #e1e1e0; background-color: #2d3743;">-&gt;</span><span style="color: #e1e1e0; background-color: #2d3743;">add_to_cart_text</span>() )
  ),
  <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_p</span> );
</pre>
</div>

<p>
For each product edit page, change Advanced &gt; Menu order and then use menu_order in query:
</p>
<div class="org-src-container">
<pre class="src src-php"><span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">args</span> = <span style="color: #ffad29; font-weight: bold;">array</span>( <span style="color: #e67128;">'post_type'</span> =&gt; <span style="color: #e67128;">'product'</span>, <span style="color: #e67128;">'product_cat'</span> =&gt; <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">prodCat</span>, <span style="color: #e67128;">"orderby"</span>=&gt;<span style="color: #e67128;">"menu_order"</span>, <span style="color: #e67128;">"order"</span>=&gt;<span style="color: #e67128;">"ASC"</span>);
<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">loop</span> = <span style="color: #ffad29; font-weight: bold;">new</span> <span style="color: #34cae2;">WP_Query</span>( <span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">args</span> );
</pre>
</div>
</div>
</div>

<div id="outline-container-org68af226" class="outline-5">
<h5 id="org68af226"><span class="section-number-5">3.33.45.5</span> Template Structure</h5>
<div class="outline-text-5" id="text-3-33-45-5">
<p>
<a href="https://docs.woocommerce.com/document/template-structure/">https://docs.woocommerce.com/document/template-structure/</a>
</p>

<p>
<code>wp-content/plugins/woocommerce/templates/emails/admin-new-order.php</code> =&gt; <code>wp-content/themes/yourtheme/woocommerce/emails/admin-new-order.php</code>
<code>wp-content/plugins/woocommerce/templates/content-single-product.php</code> =&gt; <code>wp-content/themes/yourtheme/woocommerce/content-single-product.php</code>
</p>
</div>
</div>

<div id="outline-container-orgd32f981" class="outline-5">
<h5 id="orgd32f981"><span class="section-number-5">3.33.45.6</span> Test Credit Cards</h5>
<div class="outline-text-5" id="text-3-33-45-6">
<p>
Turn on test mode for each Payment Gateway.
For <a href="#org2b7c5e3">payment:moneris</a>, WooCommerce &gt; Settings &gt; Payments &gt; Moneris - Credit Card &gt; Manage &gt; Environment &gt; Sandbox
</p>
</div>
</div>

<div id="outline-container-orgac815d1" class="outline-5">
<h5 id="orgac815d1"><span class="section-number-5">3.33.45.7</span> extension: Subscription</h5>
<div class="outline-text-5" id="text-3-33-45-7">
<p>
Make recurring payment and subscription products possible.
Docs: <a href="https://docs.woocommerce.com/document/subscriptions/">https://docs.woocommerce.com/document/subscriptions/</a>
<a href="https://woocommerce.com/products/woocommerce-subscriptions/">https://woocommerce.com/products/woocommerce-subscriptions/</a>
</p>
</div>
</div>

<div id="outline-container-org2f30ef5" class="outline-5">
<h5 id="org2f30ef5"><span class="section-number-5">3.33.45.8</span> extension: Name Your Price</h5>
<div class="outline-text-5" id="text-3-33-45-8">
<p>
Set custom price by buyer. Compatible with Subscription extension.
</p>
</div>
</div>

<div id="outline-container-org3f6d98a" class="outline-5">
<h5 id="org3f6d98a"><span class="section-number-5">3.33.45.9</span> extension: WooCommerce Sequential Order Numbers Pro</h5>
<div class="outline-text-5" id="text-3-33-45-9">
<p>
The post id of order is still not sequential but global $the_order-&gt;id is.
</p>
</div>
</div>
</div>

<div id="outline-container-org4e54175" class="outline-4">
<h4 id="org4e54175"><span class="section-number-4">3.33.46</span> woo-order-export-lite</h4>
</div>
<div id="outline-container-org9572732" class="outline-4">
<h4 id="org9572732"><span class="section-number-4">3.33.47</span> woocommerce-pdf-invoices-packing-slips</h4>
<div class="outline-text-4" id="text-3-33-47">
<p>
Doc: <a href="http://docs.wpovernight.com/woocommerce-pdf-invoices-packing-slips/">http://docs.wpovernight.com/woocommerce-pdf-invoices-packing-slips/</a>
</p>
</div>

<div id="outline-container-orgc905a29" class="outline-5">
<h5 id="orgc905a29"><span class="section-number-5">3.33.47.1</span> Template hooks</h5>
<div class="outline-text-5" id="text-3-33-47-1">
<p>
<a href="http://docs.wpovernight.com/woocommerce-pdf-invoices-packing-slips/pdf-template-action-hooks/">http://docs.wpovernight.com/woocommerce-pdf-invoices-packing-slips/pdf-template-action-hooks/</a>
<a href="http://hookr.io/plugins/woocommerce-pdf-invoices-packing-slips/">http://hookr.io/plugins/woocommerce-pdf-invoices-packing-slips/</a>
</p>

<p>
Simple template wp-content/plugins/woocommerce-pdf-invoices-packing-slips/templates/Simple/
html-document-wrapper.php
  invoice.php
</p>
</div>
<ol class="org-ol">
<li><a id="org5748c74"></a>action wpo_wcpdf_before_document<br />
<div class="outline-text-6" id="text-3-33-47-1-1">
<p>
$wpo_wcpdf_export_template_type :: The wpo wcpdf export template type.
$wpo_wcpdf_export_order :: The wpo wcpdf export order.
</p>

<pre class="example">
function action_wpo_wcpdf_before_document( $wpo_wcpdf_export_template_type, $wpo_wcpdf_export_order ) { 
    // make action magic happen here...
}; 

// add the action 
add_action( 'wpo_wcpdf_before_document', 'action_wpo_wcpdf_before_document', 10, 2 ); 
</pre>
</div>
</li>

<li><a id="orge4ae31c"></a>action wpo_wcpdf_after_document_label<br /></li>
<li><a id="orge433289"></a>action wpo_wcpdf_before_billing_address<br /></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org3d6ca2e" class="outline-3">
<h3 id="org3d6ca2e"><span class="section-number-3">3.34</span> Debug, WP_Error</h3>
<div class="outline-text-3" id="text-3-34">
<p>
<a href="https://codex.wordpress.org/Function_Reference/WP_Error">https://codex.wordpress.org/Function_Reference/WP_Error</a>
Function may return WP_Error object. Catch error
</p>
<pre class="example">
$post = wp_insert_post([]);
if ( is_wp_error($post) ) {
 echo $post-&gt;get_error_message();
}
</pre>

<p>
<a id="org91aa88e">wp:show error</a>
In wp-config.php insert this before <i>* That's all, stop editing! Happy blogging *</i>
<a href="https://codex.wordpress.org/Debugging_in_WordPress">https://codex.wordpress.org/Debugging_in_WordPress</a>
</p>
<pre class="example">
define( 'WP_DEBUG', false );
//define('WP_DEBUG', true);
if ( WP_DEBUG ) {
  @error_reporting( E_ALL ); @ini_set( 'log_errors', true );
  @ini_set( 'log_errors_max_len', '0' );
  // define( 'WP_DEBUG_LOG', true ); // /wp-content/debug.log useful to debug AJAX or wp-cron run
  define('WP_DEBUG_DISPLAY', true); // set to false to not display error on HTML pages
  define( 'CONCATENATE_SCRIPTS', false ); // by default, for Admin area, WP loads one JavaScript. If you have one error in script, it will fail
  // set to false that JavaScript files are loaded separately for Admin area.
  define( 'SAVEQUERIES', true ); // enable global $wpdb-&gt;queries to analyze queries
  ini_set('display_errors', 1); // 'stderr' can be set
}
</pre>

<p>
Or anywhere
</p>
<pre class="example">
error_reporting(E_ALL);
ini_set('display_errors', 1);
</pre>
</div>
</div>

<div id="outline-container-org0a0270f" class="outline-3">
<h3 id="org0a0270f"><span class="section-number-3">3.35</span> Installation Language</h3>
<div class="outline-text-3" id="text-3-35">
<p>
Download additional language packs from <a href="https://make.wordpress.org/polyglots/teams/">here</a>
Upload thme to wp-content/languages
Then change the language in each User Profile.
</p>
</div>
</div>

<div id="outline-container-org664169f" class="outline-3">
<h3 id="org664169f"><span class="section-number-3">3.36</span> File Permissions <a id="orga70d167">wp:file permissions</a></h3>
<div class="outline-text-3" id="text-3-36">
<p>
All files should be <a href="#orgd10f1c9">chmod:644</a> and all folders <a href="#org6531cc6">chmod:755</a>
wp-config.php should be <a href="#org47b1f63">chmod:660</a> or <a href="#org12a168a">chmod:664</a>
</p>
<pre class="example">
# set permission 644 on files
find . -type f -exec chmod 644 {} +
# set permissions 755 for directories
find . -type d -exec chmod 755 {} +
chmod 660 wp-config.php
</pre>

<p>
Run this to check which files are not 644 and which directories are not 755 <a id="org855c406">wp:check file permissions</a>
</p>
<pre class="example">
find . -type d -not -perm 755 -o -type f -not -perm 644
find . -type d -not -perm 755 -not -path "./.git/*" -o -type f -not -perm 644 -not -path "./.git/*"
</pre>

<p>
Multiple users upload as www-data <a href="#org490d2a6">linux:permission:users</a>
</p>
</div>
</div>

<div id="outline-container-org2eb95c9" class="outline-3">
<h3 id="org2eb95c9"><span class="section-number-3">3.37</span> SSL</h3>
<div class="outline-text-3" id="text-3-37">
<pre class="example">
// Force HTTPS logins and administration
define('FORCE_SSL_ADMIN', true);

// The above also means this below
//define('FORCE_SSL_LOGIN', true);

define('WP_HOME','https://'.$_SERVER[HTTP_HOST]);
define('WP_SITEURL','https://'.$_SERVER[HTTP_HOST]);
</pre>

<p>
You can now try to go to wp-admin
If W3 Total Cache is installed, Performance &gt; Page Cache &gt; enable Cache SSL (https) requests
If some security plugin is installed, make sure no SSL is enforced for any pages because Apache at the end will cover that.
</p>

<p>
Use <a href="#org119dd85">ssl:test</a> tools to identify problematic links
Fix legacy content in DB
<a href="https://css-tricks.com/moving-to-https-on-wordpress/">https://css-tricks.com/moving-to-https-on-wordpress/</a>
</p>
<pre class="example">
// double quotes
UPDATE wp_posts 
SET    post_content = ( Replace (post_content, 'src="http://', 'src="//') )
WHERE  Instr(post_content, 'jpeg') &gt; 0 
        OR Instr(post_content, 'jpg') &gt; 0 
        OR Instr(post_content, 'gif') &gt; 0 
        OR Instr(post_content, 'png') &gt; 0;

// single quote
UPDATE wp_posts 
SET   post_content = ( Replace (post_content, "src='http://", "src='//") )
WHERE  Instr(post_content, 'jpeg') &gt; 0 
        OR Instr(post_content, 'jpg') &gt; 0 
        OR Instr(post_content, 'gif') &gt; 0 
        OR Instr(post_content, 'png') &gt; 0;

// Custom Fields
UPDATE wp_postmeta 
SET meta_value=(REPLACE (meta_value, 'iframe src="http://','iframe src="//'));
</pre>

<p>
Force redirect to https on Apache for all pages :: <a href="#org0a532d8">apache:https</a>
To setup nginx as host and apache as proxy <a href="#org5e2d6ed">nginx:proxy:docker</a>
</p>

<p>
If WordPress is behind Nginx proxy server or load balancer, the above is not enough because is_ssl function will not work
Inspired by plugin <a href="https://wordpress.org/plugins/ssl-insecure-content-fixer/">ssl-insecure-content-fixer</a> wp-config.php
</p>
<pre class="example">
if (isset($_SERVER['HTTP_X_FORWARDED_PROTO']) &amp;&amp; strtolower($_SERVER['HTTP_X_FORWARDED_PROTO']) === 'https') {
  $_SERVER['HTTPS'] = 'on';
}
</pre>
</div>
</div>

<div id="outline-container-org28201d4" class="outline-3">
<h3 id="org28201d4"><span class="section-number-3">3.38</span> REST API</h3>
<div class="outline-text-3" id="text-3-38">
<p>
<a href="https://deliciousbrains.com/wordpress-rest-api-vs-custom-request-handlers/">https://deliciousbrains.com/wordpress-rest-api-vs-custom-request-handlers/</a>
</p>
</div>
</div>

<div id="outline-container-orgd3bfb29" class="outline-3">
<h3 id="orgd3bfb29"><span class="section-number-3">3.39</span> Life Cycle</h3>
<div class="outline-text-3" id="text-3-39">
<p>
Refer to <a href="#orga9d5ad0">wp:action:loading sequence</a>
<a href="https://wordpress.stackexchange.com/questions/71406/is-there-a-flowchart-for-wordpress-loading-sequence">https://wordpress.stackexchange.com/questions/71406/is-there-a-flowchart-for-wordpress-loading-sequence</a>
<a href="http://www.wpbeginner.com/wp-tutorials/how-wordpress-actually-works-behind-the-scenes-infographic/">http://www.wpbeginner.com/wp-tutorials/how-wordpress-actually-works-behind-the-scenes-infographic/</a>
</p>

<p>
Request /wp-admin/admin-ajax.php
/wp-load.php <a href="#orga002216">wp:global:wpdb</a>
/wp-config.php
/wp-settings.php (core files, active plugins and themes and the REST API)
/wp-admin/admin.php
/wp-admin/includes/ajax-actions.php
(<a href="#org86105c8">wp:action:admin_init</a>)
</p>

<p>
Request REST API
/index.php
/wp-blog-header.php (Environment and Template)
/wp-load.php
/wp-config.php
/wp-settings.php (which loads most core files, all active plugins and themes, and the REST API)
(doesn't load admin_init, /wp-admin/*.*)
</p>
</div>
</div>

<div id="outline-container-org0ea0741" class="outline-3">
<h3 id="org0ea0741"><span class="section-number-3">3.40</span> PHP 7</h3>
<div class="outline-text-3" id="text-3-40">
<p>
Notice: The called constructor method for WP_Widget is deprecated since version 4.3.0! Use __construct() instead. in /path-to/wp-includes/functions.php on line 3457
</p>

<p>
Disable Notice logging
</p>
<pre class="example">
add_filter('deprecated_constructor_trigger_error', '__return_false');
</pre>

<p>
Or fix the code <a href="#org20b9c0b">wp:f:register_widget</a>
</p>

<p>
<a href="#orga002216">wp:global:wpdb</a>
</p>

<p>
Your PHP installation appears to be missing the MySQL extension which is required by WordPress
</p>
</div>
</div>

<div id="outline-container-orgc0dd9d3" class="outline-3">
<h3 id="orgc0dd9d3"><span class="section-number-3">3.41</span> UC: Simple HTML page with form submit</h3>
<div class="outline-text-3" id="text-3-41">
<p>
Create a url path /abc which points to index.html (can't have php files)
</p>
</div>
<div id="outline-container-org3df367f" class="outline-4">
<h4 id="org3df367f"><span class="section-number-4">3.41.1</span> /abc/index.html</h4>
<div class="outline-text-4" id="text-3-41-1">
<pre class="example">
&lt;script src='https://www.google.com/recaptcha/api.js'&gt;&lt;/script&gt;

&lt;div id="form-frame" class="form"&gt;
  &lt;div class="form-input"&gt;
    &lt;div id="err-message"&gt;&lt;/div&gt;
  &lt;/div&gt;
  &lt;div class="form-input"&gt;
    &lt;label for="li-fname"&gt;Full Name&lt;/label&gt;
    &lt;input type="text" name="li-fname" id="li-fname"&gt;
  &lt;/div&gt;
  &lt;div class="form-input news-input"&gt;
    &lt;label for="li-sub-promo"&gt;How did you hear about this promotion?&lt;/label&gt;
    &lt;select name="li-sub-promo" id="li-sub-promo"&gt;
      &lt;option value="Website"&gt;Website&lt;/option&gt;
      &lt;option value="Radio"&gt;Radio&lt;/option&gt;
      &lt;option value="TV"&gt;TV&lt;/option&gt;
      &lt;option value="Referral"&gt;Referral&lt;/option&gt;
      &lt;option value="Brochure"&gt;Brochure&lt;/option&gt;
      &lt;option value="Email"&gt;Email&lt;/option&gt;
      &lt;option value="Newsletter"&gt;Newsletter&lt;/option&gt;
      &lt;option value="Online Ads"&gt;Online Ads&lt;/option&gt;
      &lt;option value="Social Media"&gt;Social Media&lt;/option&gt;
    &lt;/select&gt;
  &lt;/div&gt;
  &lt;div class="form-input news-input"&gt;
    &lt;label for="small-business-lighting"&gt;Programs of Interest
      &lt;br&gt;(Check all that apply)&lt;/label&gt;
    &lt;div class="li-newsbox"&gt;
      &lt;input type="checkbox" name="li-newsbox" id="small-business-lighting"&gt;Small
      Business Lighting&lt;br&gt;
      &lt;input type="checkbox" name="li-newsbox"
             id="business-registration-incentives"&gt;Business Refrigeration
      Incentives
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class="form-input"&gt;
    &lt;label&gt;&amp;nbsp;&lt;/label&gt;
    &lt;div class="g-recaptcha" data-sitekey="[[your_google_recaptcha_public_key]]"&gt;&lt;/div&gt;
    &lt;div id="captcha-verify"&gt;&lt;/div&gt;
  &lt;/div&gt;

  &lt;div class="form-input submit-input" id="form-submit"&gt;
    &lt;label&gt;&amp;nbsp;&lt;/label&gt;
    &lt;a href="javascript:;" onclick="javascript:submit_form();"&gt;Submit&lt;/a&gt;
  &lt;/div&gt;

&lt;/div&gt;
&lt;script type="text/javascript"
        src="/abc/lb/js/app.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"
        src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"&gt;&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-org2077b3b" class="outline-4">
<h4 id="org2077b3b"><span class="section-number-4">3.41.2</span> /abc/lb/js/app.js</h4>
<div class="outline-text-4" id="text-3-41-2">
<pre class="example">
function submit_form(){

  var send_msg = document.getElementById('form-submit');
  var pre_send = ('&lt;label&gt;&amp;nbsp;&lt;/label&gt;&lt;a href="javascript:;" onclick="javascript:submit_form();"&gt;Submit&lt;/a&gt;');
  var post_send =  ('&lt;label&gt;&amp;nbsp;&lt;/label&gt;&lt;a id="send-blank"&gt;Sending...&lt;/a&gt;');

  var validate_form = pre_validate_cf();
  var message = document.getElementById('err-message');
  var form_data = '';
  var form_return = '';

  send_msg.innerHTML = post_send;

  if (validate_form!=0) {

    send_msg.innerHTML = pre_send;
    message.innerHTML = 'Please correct the following errors: &lt;ul&gt;'+validate_form+'&lt;/ul&gt;';
    message.style.display = 'block';

  }
  else {

    message.style.display = 'none';

    /* -- SEND TO SERVER -- */
    var name = encodeURIComponent(document.getElementById('li-fname').value);
    var email = encodeURIComponent(document.getElementById('li-email').value);
    var phone = encodeURIComponent(document.getElementById('li-phone').value);
    var company = encodeURIComponent(document.getElementById('li-company').value);
    var address = encodeURIComponent(document.getElementById('li-address').value);
    var promo = encodeURIComponent(document.getElementById('li-sub-promo').value);

    var bus_lighting = is_checked('small-business-lighting');
    var bus_reg_incentives = is_checked('business-registration-incentives');

    form_data = 'name='+name+'&amp;email='+email+'&amp;phone='+phone+'&amp;company='+company+'&amp;address='+address+'&amp;promo_hear='+promo+'&amp;bus_lighting='+bus_lighting+'&amp;bus_reg_incentives='+bus_reg_incentives;

    cf_form_req(form_data);

  }
}

function cf_form_req(params){

  var send_msg = document.getElementById('form-submit');
  var pre_send = ('&lt;label&gt;&amp;nbsp;&lt;/label&gt;&lt;a href="javascript:;" onclick="javascript:submit_form();"&gt;Submit&lt;/a&gt;');
  var post_send =  ('&lt;label&gt;&amp;nbsp;&lt;/label&gt;&lt;a id="send-blank"&gt;Sending...&lt;/a&gt;');
  var message = document.getElementById('err-message');
  var recaptcha = '';
  recaptcha = grecaptcha.getResponse();
  var params_full = params +'&amp;recaptcha='+ recaptcha;

  send_msg.innerHTML = post_send;

  var url = "/wp-content/themes/li-cdm-lp/lb/api-localbusiness/cf-form-post.php";

  $.ajax({
    url : url,
    type: "POST",
    data : params_full,
    success: function(data)
    {

      console.log(data);

      if(data=='true'){
        document.getElementById('form-validated').style.display = 'block';
        ga('send', 'event', {
          eventCategory: 'Form Submit Success',
          eventAction: 'click',
          eventLabel: event.target.href
        });

        console.log('submit');
      }else {
        message.style.display = 'block';
        send_msg.innerHTML = pre_send;
        message.innerHTML = 'Please correct the following errors: &lt;ul&gt;'+data+'&lt;/ul&gt;';
      }

    }
  });
}

function google_captcha_verify(){
  var v = grecaptcha.getResponse();
  if(v.length == 0) { return false; }
  else { return true; }
}

function pre_validate_cf(){

  var name = document.getElementById('li-fname');
  var email = document.getElementById('li-email');
  var phone = document.getElementById('li-phone');
  var company = document.getElementById('li-company');
  var address = document.getElementById('li-address');

  var bus_lighting = is_checked('small-business-lighting');
  var bus_reg_incentives = is_checked('business-registration-incentives');
  var google_captcha = google_captcha_verify();

  //var captcha = document.getElementById('captcha-verify');

  var clean_css = 'border:1px #2ac158 solid';
  var err_css = 'border:1px #FF0000 solid';

  var check = '';
  var log_data = '';

  if(name.value == null || name.value==''){
    check = '&lt;li&gt;Please enter your name.&lt;/li&gt;';
    log_data = '[ Empty First Name ],';
    name.style.cssText = err_css;
  }else {
    log_data = '[ First Name: '+name.value+' ],';
    name.style.cssText = clean_css;
  }

  if(email.value == null || email.value==''){
    check += '&lt;li&gt;Please enter your email.&lt;/li&gt;';
    log_data += '[ Empty Email ],';
    email.style.cssText = err_css;
  }else if(validate_email(email.value)=='false'){
    check += '&lt;li&gt;Please enter a valid email.&lt;/li&gt;';
    log_data += '[ Invalid Email: '+email.value+' ],';
    email.style.cssText = err_css;
  }else {
    log_data += '[ Email: '+email.value+' ],';
    email.style.cssText = clean_css;
  }

  if(phone.value == null || phone.value==''){
    check += '&lt;li&gt;Please enter your phone number.&lt;/li&gt;';
    phone.style.cssText = err_css;
  }else if(validate_phone(phone)!=true){
    check += '&lt;li&gt;Please enter a valid phone number. Format: 000-000-0000&lt;/li&gt;';
    phone.style.cssText = err_css;
  }else {
    phone.style.cssText = clean_css;
  }

  if(company.value == null || company.value==''){
    check += '&lt;li&gt;Please enter your company name.&lt;/li&gt;';
    company.style.cssText = err_css;
  }else {
    company.style.cssText = clean_css;
  }

  if(address.value == null || address.value == ''){
    check += '&lt;li&gt;Please enter your company address&lt;/li&gt;';
    address.style.cssText = err_css;
  }else {
    address.style.cssText = clean_css;
  }

  if(google_captcha!== true ){
    check += '&lt;li&gt;Please verify you are not a robot.&lt;/li&gt;';
  }

  if(bus_lighting!== 'Checked'){
    if(bus_reg_incentives!=='Checked'){
      check += '&lt;li&gt;Please select a program of interest.&lt;/li&gt;';
    }else {

    }
  }

  /* IF VALID -- Clear Check, Set to 0 */
  if(check==''){check=0;}

  return check;
}

function is_checked(id){
  if(document.getElementById(id).checked) {
    return( "Checked" );
  }else {
    return( "Not Checked" );
  }
}

function close_form(){
  document.getElementById('form-validated').style.display = 'none';
}
</pre>
</div>
</div>

<div id="outline-container-org513dabe" class="outline-4">
<h4 id="org513dabe"><span class="section-number-4">3.41.3</span> /wp-content/themes/li-cdm-lp/lb/api-localbusiness/cf-form-post.php</h4>
<div class="outline-text-4" id="text-3-41-3">
<pre class="example">
&lt;?php
/* --- CLASS INCLUSION --- */
include('form-clean.php');
$FORMCLEAN = new FORM_CLEAN();

session_start();

$recipients_sbl = array('iamadmin@abc.com');

/* --- PARAMS (Pre-Clean) --- */
$C_NAME                         = $FORMCLEAN-&gt;clean($_POST['name']);
$C_EMAIL                        = $FORMCLEAN-&gt;clean($_POST['email']);
$C_PHONE                        = $FORMCLEAN-&gt;clean($_POST['phone']);
$C_COMPANY                      = $FORMCLEAN-&gt;clean($_POST['company']);
$C_ADDRESS                      = $FORMCLEAN-&gt;clean($_POST['address']);
$C_PROMO                        = $FORMCLEAN-&gt;clean($_POST['promo_hear']);
$C_BUS_LIGHTING = $FORMCLEAN-&gt;clean($_POST['bus_lighting']);
$C_BUS_INCENTIVES = $FORMCLEAN-&gt;clean($_POST['bus_reg_incentives']);

/* --- VALIDATE --- */
$C_NAME_VALIDATE                                =       $FORMCLEAN-&gt;validate($C_NAME,'Name');
$C_EMAIL_VALIDATE                               =       $FORMCLEAN-&gt;validate($C_EMAIL,'Email');
$C_PHONE_VALIDATE                               =       $FORMCLEAN-&gt;validate($C_PHONE,'Phone');
$C_COMPANY_VALIDATE                             =       $FORMCLEAN-&gt;validate($C_COMPANY,'Company');
$C_ADDRESS_VALIDATE                             =       $FORMCLEAN-&gt;validate($C_ADDRESS,'Address');


// validate reCaptcha
$C_CAPTCHA_VALIDATE = '';
$C_CAPTCHA = $_POST['recaptcha'];
$C_CAPTCHA_google_request = array(
  'url' =&gt; 'https://www.google.com/recaptcha/api/siteverify',
  'options' =&gt; array(
    'secret' =&gt; 'your_recaptcha_secret_key',
    'response' =&gt; $C_CAPTCHA,
  ));

$ch = curl_init();
$options = array(
  CURLOPT_URL =&gt; $C_CAPTCHA_google_request['url'],
  CURLOPT_POSTFIELDS =&gt; http_build_query($C_CAPTCHA_google_request['options']),
  CURLOPT_FOLLOWLOCATION =&gt;  1,
  CURLOPT_HEADER =&gt; 0,
  CURLOPT_RETURNTRANSFER =&gt; 1
);
curl_setopt_array($ch, $options);
$C_CAPTCHA_google_result = json_decode(curl_exec( $ch ), true);
curl_close($ch);

if (!(is_array($C_CAPTCHA_google_result) &amp;&amp; $C_CAPTCHA_google_result['success'] === true)) {
  $C_CAPTCHA_VALIDATE = ('&lt;li&gt;reCaptcha Match Fails &lt;/li&gt;');
}
// validate reCaptcha.

$EMAIL_TO = '';

$SOURCE_CODE = 'Li-Local-Business';

$VALIDATE = str_replace('0','',$C_NAME_VALIDATE.$C_EMAIL_VALIDATE.$C_PHONE_VALIDATE.$C_COMPANY_VALIDATE.$C_ADDRESS_VALIDATE.$C_CAPTCHA_VALIDATE);

if($VALIDATE==''){

  if($C_BUS_LIGHTING=='Checked'){

    /* --- SEND EMAIL (TO ADMINISTRATOR) --- */
    $EMAIL_TO = implode(',', $recipients_sbl);
    //$EMAIL_TO .= 'joseph.alonzi@cleversamurai.com';
    $SUBJECT = '[ Li ] - Small Business Lighting Signup';
    $EMAIL_FROM = 'donotreply@abc.com';

    $MESSAGE = ('
                                        &lt;html&gt;
                                                &lt;head&gt;
                                                        &lt;title&gt;[ Li ] - Small Business Lighting Signup&lt;/title&gt;
                                                &lt;/head&gt;
                                                &lt;body&gt;

                                                 &lt;h1&gt;[ Li ] - Small Business Lighting Signup&lt;/h1&gt;

                                                 &lt;b&gt;Name:&lt;/b&gt; '.$C_NAME.'&lt;br /&gt;
                                                 &lt;b&gt;Email:&lt;/b&gt; '.$C_EMAIL.'&lt;br /&gt;
                                                 &lt;b&gt;Phone:&lt;/b&gt; '.$C_PHONE.'&lt;br /&gt;&lt;br /&gt;

                                                &lt;b&gt;How Did You Hear About Us?&lt;/b&gt; '.$C_PROMO.'&lt;br /&gt;&lt;br /&gt;

                                                 &lt;b&gt;Business Name:&lt;/b&gt; '.$C_COMPANY.'&lt;br /&gt;
                                                 &lt;b&gt;Business Address:&lt;/b&gt; '.$C_ADDRESS.'&lt;br /&gt;&lt;br /&gt;

                                                 The following email: '.$C_EMAIL.' has shown interest in Small Business Lighting.

                                                &lt;br /&gt;
                                                ---
                                                &lt;br /&gt;
                                                Source Code: '.$SOURCE_CODE.$_debug.'

                                                &lt;/body&gt;
                                        &lt;/html&gt;
                                        ');

    $HEADERS  = 'MIME-Version: 1.0' . "\r\n";
    $HEADERS .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
    $HEADERS .= 'From: Li &lt;'.$EMAIL_FROM.'&gt;' . "\r\n";
    mail($EMAIL_TO, $SUBJECT, $MESSAGE, $HEADERS);

  }

  unset($_SESSION['C_CAPTCHA']);
  session_destroy();

  /* --- IF ALL VALIDATES, AND THE EMAIL HAS BEEN SENT --- */
  echo 'true';

}
else {
  echo $VALIDATE;
}
</pre>
</div>
</div>

<div id="outline-container-org8422815" class="outline-4">
<h4 id="org8422815"><span class="section-number-4">3.41.4</span> /wp-content/themes/li-cdm-lp/lb/api-localbusiness/form-clean.php</h4>
<div class="outline-text-4" id="text-3-41-4">
<pre class="example">
&lt;?php

class FORM_CLEAN{

  public function clean($input){

    /* -- Simple Clean -- */
    $input = preg_replace('#&lt;script(.*?)&gt;(.*?)&lt;/script&gt;#is', '', $input);
    $input = str_replace('&lt;?php','',$input);
    $input = str_replace('?&gt;','',$input);
    $input = str_replace("1=1;--",'',$input);
    $input = strip_tags($input);

    return $input;

  }

  public function validate($input,$name){

    $error=0;

    if($input==''){
      $error++;
    }

    if($error!=0){
      return '&lt;li&gt; '.$name.' field is empty or invalid.';
    }else {
      return $error;
    }

  }

  public function check_convert($str){

    if($str=='true'){
      $str='YES';
    }else {
      $str='NO';
    }

    return $str;

  }

}
</pre>
</div>
</div>
</div>

<div id="outline-container-org8f378d1" class="outline-3">
<h3 id="org8f378d1"><span class="section-number-3">3.42</span> TS: Hacked <a id="orgb3405eb">wp:ts:hacked</a></h3>
<div class="outline-text-3" id="text-3-42">
<p>
<a href="https://codex.wordpress.org/FAQ_My_site_was_hacked">https://codex.wordpress.org/FAQ_My_site_was_hacked</a>
<a href="https://codex.wordpress.org/Hardening_WordPress">https://codex.wordpress.org/Hardening_WordPress</a>
Change wp users' passwords
Compare wp-config.php with wp-config-sample.php
<a href="#orga70d167">wp:file permissions</a>
<a href="#orgfcb47c7">wp:wp-config:DISALLOW_FILE_EDIT</a>
</p>
</div>

<div id="outline-container-org9aeed62" class="outline-4">
<h4 id="org9aeed62"><span class="section-number-4">3.42.1</span> Search backdoor scripts</h4>
<div class="outline-text-4" id="text-3-42-1">
<p>
Use <a href="#orgb44ba0a">wp:plugin:exploit-scanner</a> to check core and plugin files
<a href="https://sucuri.net/guides/how-to-clean-hacked-wordpress">https://sucuri.net/guides/how-to-clean-hacked-wordpress</a>
Used PHP functions
base64
str_rot13
gzuncompress
eval
exec
system
assert
stripslashes
preg_replace (with <i>e</i>)
move_uploaded_file
</p>
</div>
</div>

<div id="outline-container-org7edcdd8" class="outline-4">
<h4 id="org7edcdd8"><span class="section-number-4">3.42.2</span> Don't execute PHP in wp-content/uploads folder</h4>
<div class="outline-text-4" id="text-3-42-2">
<p>
In wp-content/uploads folder upload this .htaccess
</p>
<pre class="example">
&lt;Files *.php&gt;
deny from all
&lt;/Files&gt;
</pre>

<p>
Find *.php in uploads folder
</p>
<pre class="example">
find wp-content/uploads/ iname "*.php"
</pre>
</div>
</div>
</div>

<div id="outline-container-org163bf4f" class="outline-3">
<h3 id="org163bf4f"><span class="section-number-3">3.43</span> TS: wp_deregister_script was called incorrectly</h3>
<div class="outline-text-3" id="text-3-43">
<p>
Scripts and styles should not be registered or enqueued until the wp_enqueue_scripts, admin_enqueue_scripts, or login_enqueue_scripts hooks.
Use something like this
</p>
<pre class="example">
if ( ! is_admin() ) {
    add_action( 'wp_enqueue_scripts', function(){
        wp_deregister_script( 'jquery' );
        wp_register_script( 'jquery', 'http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js', array(), null, false );
        wp_enqueue_script( 'jquery');
    });
}
</pre>
</div>
</div>

<div id="outline-container-org4915d4f" class="outline-3">
<h3 id="org4915d4f"><span class="section-number-3">3.44</span> TS: Check list</h3>
<div class="outline-text-3" id="text-3-44">
<ul class="org-ul">
<li>check PHP and MySQL version</li>
<li>check WP Core version</li>
<li>check proprietary plugins and see which plugins are deprecated. Check PHP and WP version required by plugins.</li>
<li>check if there's custom/modified plugins</li>
<li>check errors <a href="#org91aa88e">wp:show error</a></li>
<li>check sitemap</li>
<li>check website status</li>
<li>wp-admin Settings &gt; Reading &gt; Search Engine Visibility &gt; uncheck Discourage search engines from indexing this site.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org4a07eca" class="outline-2">
<h2 id="org4a07eca"><span class="section-number-2">4</span> ColdFusion</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org28bca1d" class="outline-3">
<h3 id="org28bca1d"><span class="section-number-3">4.1</span> cfsetting</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Override the server setting for a particular page
</p>
<pre class="example">
&lt;cfsetting enablecfoutputonly="yes|no" 
           requesttimeout="300" 
           showdebugoutput="yes|no"&gt;
</pre>
</div>
</div>

<div id="outline-container-org53b8d8f" class="outline-3">
<h3 id="org53b8d8f"><span class="section-number-3">4.2</span> Text</h3>
<div class="outline-text-3" id="text-4-2">
<pre class="example">
FindNoCase("the", "The sentence") returns integer position
0 if not found
</pre>
</div>
</div>

<div id="outline-container-org194138a" class="outline-3">
<h3 id="org194138a"><span class="section-number-3">4.3</span> Mail</h3>
<div class="outline-text-3" id="text-4-3">
<pre class="example">
&lt;cfmail to="1@a.com,2@b.com" from="" subject="" type="text/html"&gt;
  &lt;cfmailparam name="X-SMTPAPI" value='{"category": ["abc-xyz"]}' /&gt;
  &lt;p&gt;...&lt;/p&gt;
&lt;/cfmail&gt;
</pre>
</div>
</div>

<div id="outline-container-org1640234" class="outline-3">
<h3 id="org1640234"><span class="section-number-3">4.4</span> Function</h3>
<div class="outline-text-3" id="text-4-4">
<pre class="example">
&lt;cffunction name="getSiteDetail" access="public" returntype="query"&gt;
  &lt;cfargument name="intID" type="numeric" default="0"&gt;
  &lt;cfset var getSite = ""&gt;
  &lt;cfquery name="getSite" datasource="..." dbtype="ODBC"&gt;
     SELECT *
     FROM Site
     WHERE ID &lt;&gt; 7
     &lt;cfif argument.intID neq 0&gt;
       AND ID = &lt;cfqueryparam value="#Arguments.intID#" CFSQLType="CF_SQL_NUMERIC"&gt;
     &lt;/cfif&gt;
     ORDER BY Site.sname
  &lt;/cfquery&gt;
  &lt;cfreturn getSite&gt;
&lt;/cffunction&gt;

&lt;cfinvoke component="functions.banner" 
          method="getSiteDetail" 
          returnvariable="getSite"&gt;
  &lt;cfinvokeargument name="intID" value="#Form.ssite2#"&gt;
&lt;/cfinvoke&gt;
</pre>
</div>
</div>

<div id="outline-container-org0a815b3" class="outline-3">
<h3 id="org0a815b3"><span class="section-number-3">4.5</span> Query</h3>
<div class="outline-text-3" id="text-4-5">
<pre class="example">
&lt;!--- Access ---&gt;
&lt;cfquery name="queryname" datasource="abc" dbtype="ODBC"&gt;
  SELECT *
  FROM tblOne
&lt;/cfquery&gt;
</pre>
</div>

<div id="outline-container-org4619d54" class="outline-4">
<h4 id="org4619d54"><span class="section-number-4">4.5.1</span> Get Identity After Insert</h4>
<div class="outline-text-4" id="text-4-5-1">
<p>
Access
</p>
<pre class="example">
&lt;cftransaction&gt;
  &lt;cfquery name="insertQ" datasource="abc"&gt;
    INSERT INTO aTable (col1, col2)
    VALUES (1,2)
  &lt;/cfquery&gt;
  &lt;cfquery name="getID" datasource="abc"&gt;
    SELECT @@identity AS RecordID
  &lt;/cfquery&gt;
&lt;/cftransaction&gt;

&lt;cfoutput&gt;#getID.recordID#&lt;/cfoutput&gt;
</pre>

<p>
TSQL
</p>

<pre class="example">
&lt;cfquery&gt;
SET NOCOUNT ON;
INSERT INTO aTable (col1,col2)
VALUES (1,2)
SELECT SCOPE_IDENTITY() AS RecordID;
&lt;/cfquery&gt;
</pre>
</div>
</div>

<div id="outline-container-org9da20c2" class="outline-4">
<h4 id="org9da20c2"><span class="section-number-4">4.5.2</span> Insert Null</h4>
<div class="outline-text-4" id="text-4-5-2">
<pre class="example">
&lt;cfquery&gt;
  UPDATE tTable SET
  &lt;cfif isDefined('form.formFieldA')&gt;
    intField = &lt;cfqueryparam value="#form.formFieldA#" cfsqltype="cf_sql_numeric"&gt;
  &lt;cfelse&gt;
    intField = &lt;cfqueryparam value="" cfsqltype="cf_sql_numeric" null="1"&gt;
  &lt;/cfif&gt;
&lt;/cfquery&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org1e507a4" class="outline-3">
<h3 id="org1e507a4"><span class="section-number-3">4.6</span> Fast form to Database</h3>
<div class="outline-text-3" id="text-4-6">
<p>
Checkbox
</p>
<pre class="example">
&lt;input type="checkbox" name="dLocked" value="1"&gt;

&lt;cfparam name="form.dLocked" default="0" overwrite="false"&gt;
INSERT INTO aTable (dLocked)
VALUES (
&lt;cfqueryparam value="#form.dLocked#" CFSQLType="CF_SQL_BIT"&gt;
)
</pre>

<pre class="example">
&lt;!--- Insert ---&gt;
&lt;form action="site_new.cfm" method="post"&gt;
  &lt;input name="Sname" type="text" size="30" maxlength="255"&gt;
&lt;/form&gt;

// site_new.cfm
&lt;cfinsert datasource="aDB" tablename="TableName"&gt;

&lt;!--- Update. cfupdate doesn't work... use cfquery ---&gt;
&lt;cfif isDefined("form.phone")&gt; 
    &lt;cfupdate datasource="cfdocexamples" tablename="EMPLOYEES"&gt; 
&lt;/cfif&gt; 

&lt;cfquery name="empTable" datasource="cfdocexamples"&gt; 
    SELECT * FROM EMPLOYEES 
&lt;/cfquery&gt; 

&lt;!--- This code shows the contents of the employee table and allows you to choose a row for updating. ---&gt; 
&lt;table border="1"&gt; 
&lt;cfoutput query="empTable"&gt; 
    &lt;tr&gt; 
        &lt;td&gt;#firstName#&lt;/td&gt; 
        &lt;td&gt;#lastName#&lt;/td&gt; 
        &lt;td&gt;#phone#&lt;/td&gt; 
        &lt;td&gt;&lt;a href="cfupdate.cfm?id=#emp_id#"&gt;Edit&lt;/a&gt;&lt;/td&gt; 
    &lt;/tr&gt; 
&lt;/cfoutput&gt; 
&lt;/table&gt; 

&lt;cfif isDefined("url.id")&gt; 
    &lt;cfquery name="phoneQuery" datasource="cfdocexamples"&gt; 
        SELECT * FROM employees WHERE emp_id=#url.id# 
    &lt;/cfquery&gt; 
&lt;!--- This code displays the row to edit for update. ---&gt; 
    &lt;cfoutput query="phoneQuery"&gt; 
        &lt;form action="cfupdate.cfm" method="post"&gt; 
        #phoneQuery.firstName# #phoneQuery.lastName#  
        &lt;input name="phone" type="text" value="#phone#" size="12"&gt;  
        &lt;input type="submit" value="Update"&gt; 
        &lt;input name="emp_id" type="hidden" value="#emp_id#"&gt; 
        &lt;!--- The emp_id is passed as a hidden field to be used as a primary  
            key in the CFUPDATE. ---&gt; 
        &lt;/form&gt; 
    &lt;/cfoutput&gt; 
&lt;/cfif&gt;
</pre>
</div>
</div>

<div id="outline-container-orgf7b33e8" class="outline-3">
<h3 id="orgf7b33e8"><span class="section-number-3">4.7</span> Loop</h3>
<div class="outline-text-3" id="text-4-7">
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">cfloop</span> <span style="color: #dbdb95;">query</span>=<span style="color: #e67128;">"aQueryname"</span> <span style="color: #dbdb95;">startRow</span>=<span style="color: #e67128;">"1"</span> <span style="color: #dbdb95;">endRow</span>=<span style="color: #e67128;">"10"</span> <span style="color: #dbdb95;">group</span>=<span style="color: #e67128;">"Customer_ID"</span>&gt;
  #aQueryName.CurrentRow#
&lt;/<span style="color: #00ede1; font-weight: bold;">cfloop</span>&gt;
</pre>
</div>

<p>
startRow, endRow and group are optional.
</p>

<p>
Array
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">cfset</span> local.objPath = GetPageContext().getRequest().getServletPath() /&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">cfset</span> local.apiNS = ArrayNew(2) /&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">cfset</span> local.apiNS[1] = [<span style="color: #e67128;">"v1"</span>, <span style="color: #e67128;">"json"</span>] /&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">cfset</span> local.apiNS[2] = [<span style="color: #e67128;">"v2"</span>, <span style="color: #e67128;">"json2"</span>] /&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">cfset</span> local.apiVer = 0 /&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">cfset</span> Request.apiCFC = 'json' /&gt;

&lt;<span style="color: #00ede1; font-weight: bold;">cfloop</span> <span style="color: #dbdb95;">array</span>=<span style="color: #e67128;">"#local.apiNS#"</span> <span style="color: #dbdb95;">item</span>=<span style="color: #e67128;">"i"</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">cfif</span> FindNoCase('/' &amp; i[1] &amp; '/', local.objPath, 1)&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">cfset</span> local.apiVer = i[1] /&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">cfset</span> Request.apiCFC = i[2] /&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">cfbreak</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">cfif</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">cfloop</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd28cc7d" class="outline-3">
<h3 id="orgd28cc7d"><span class="section-number-3">4.8</span> Remote Address</h3>
<div class="outline-text-3" id="text-4-8">
<p>
&lt;cfif cgi.REMOTE_ADDR eq "127.0.0.1"&gt;
</p>
</div>
</div>

<div id="outline-container-orgb96f85c" class="outline-3">
<h3 id="orgb96f85c"><span class="section-number-3">4.9</span> cftry</h3>
<div class="outline-text-3" id="text-4-9">
<pre class="example">
&lt;cftry&gt;
  &lt;!--- Do something ---&gt;
  &lt;cfcatch type="any"&gt;
    &lt;cfdump var="#cfcatch#"&gt;
  &lt;/cfcatch&gt;
&lt;/cftry&gt;
</pre>
</div>
</div>

<div id="outline-container-orgd3d61b6" class="outline-3">
<h3 id="orgd3d61b6"><span class="section-number-3">4.10</span> cfdump</h3>
<div class="outline-text-3" id="text-4-10">
<p>
Save cfdump in a string
</p>
<pre class="example">
&lt;cfsavecontent variable="theDump"&gt;
  &lt;cfdump var="#form.uploadSizesAll#" expand="yes" format="text"&gt;
&lt;/cfsavecontent&gt;
&lt;cfset sError = theDump&gt;
</pre>
</div>
</div>

<div id="outline-container-orga03e379" class="outline-3">
<h3 id="orga03e379"><span class="section-number-3">4.11</span> Javascript</h3>
<div class="outline-text-3" id="text-4-11">
<pre class="example">
&lt;cfoutput&gt;
  &lt;script&gt;
    var #toscript(form.afield, "jsVarName")#;
  &lt;/script&gt;
&lt;/cfoutput&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org1151a52" class="outline-2">
<h2 id="org1151a52"><span class="section-number-2">5</span> CSS</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orga98438a" class="outline-3">
<h3 id="orga98438a"><span class="section-number-3">5.1</span> Position, box-sizing</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Default position is static. left, right, top, bottom have not effect
relative is relative to default static position, use left, right, top and bottom
</p>

<p>
Other elements adjacent to position:relative element will no be adjusted to fit into
any gap left by the element (treat the relative element as static)
</p>

<p>
position:fixed is relative to viewport
</p>

<p>
A "positioned" element is one whose position is anything except static.
</p>

<p>
postion:absolute is positioned relative to the nearest positioned ancestor.
If there's no positioned ancestors, document body is used.
</p>

<p>
When elements are positioned, they can overlap other elements.
</p>

<p>
box-sizing: border-box | padding-box | content-box (default); 
</p>
</div>
</div>

<div id="outline-container-org31b4592" class="outline-3">
<h3 id="org31b4592"><span class="section-number-3">5.2</span> Horizontal Center Absolute</h3>
<div class="outline-text-3" id="text-5-2">
<p>
The absolute element is positioned related to the first position:relative parent
</p>

<p>
Center that abosulte element in relate to that parent
</p>

<p>
Notice: any parents will not expand in width and height according to that absolute child element 
</p>
<pre class="example">
.grandchild {
  position: absolute;
  margin-left: auto;
  margin-right: auto;
  left: 0;
  right: 0;
}
</pre>
</div>
</div>

<div id="outline-container-org8b24a49" class="outline-3">
<h3 id="org8b24a49"><span class="section-number-3">5.3</span> Transform, Transition</h3>
<div class="outline-text-3" id="text-5-3">
<p>
<a href="#org06dcf43">css:animation</a>
</p>
</div>

<div id="outline-container-org478ff52" class="outline-4">
<h4 id="org478ff52"><span class="section-number-4">5.3.1</span> Transition</h4>
<div class="outline-text-4" id="text-5-3-1">
<p>
transition: <i>transition-property</i> <i>transition-duration</i> <i>transition-timing-function</i> <i>transition-delay</i>
</p>

<dl class="org-dl">
<dt>transition-property</dt><dd>can be 'all'</dd>
<dt>transition-timing-function</dt><dd>default linear
<dl class="org-dl">
<dt>ease-in</dt><dd>slow start</dd>
<dt>ease-out</dt><dd>slow end</dd>
<dt>(no term)</dt><dd>e.g. use ease-in for div:hover and ease-out in div</dd>
</dl></dd>

<dt>transition-delay</dt><dd>delay n seconds before the current transition starts.</dd>
</dl>

<pre class="example">
div {
  width: 100px;
  height: 100px;
  background: red;
  transition: width 2s linear 3s, height 2s linear 3s, transform 2s linear 3s;
}
</pre>
</div>
</div>

<div id="outline-container-orgb8cdd4a" class="outline-4">
<h4 id="orgb8cdd4a"><span class="section-number-4">5.3.2</span> Transform <a id="orgea92755">css:transform</a></h4>
<div class="outline-text-4" id="text-5-3-2">
<pre class="example">
div:hover {
  width: 300px;
  height: 300px;
  transform: 
    rotate(180deg) 
    translate(-20px, 0)
    scale(0.9, 2)
    skew(30deg, 20deg);
}
/* You can turn off all transform */
/* transform: none; */
</pre>

<p>
2D transforms
</p>
<dl class="org-dl">
<dt>translate()</dt><dd>translate(tx) is equivalent to translate(tx, ty) as ty is 0 by default. Default is translate(0,0)</dd>
<dt>(no term)</dt><dd>rotate()</dd>
<dt>scale()</dt><dd>e.g. scale(0.5, 0.5)</dd>
<dt>(no term)</dt><dd>scaleX() scaleY()</dd>
<dt>skew()</dt><dd>skew(20deg, 10deg)</dd>
<dt>skewX() skewY()</dt><dd>skewX(20deg)</dd>
<dt>matrix()</dt><dd>matrix(scaleX(),skewY(),skewX(),scaleY(),translateX(),translateY())</dd>
</dl>

<p>
Angle
</p>
<dl class="org-dl">
<dt>rad</dt><dd>One full circle is 2π radians which approximates to 6.2832rad. 1rad is 180/π degrees. Examples: 0rad, 1.0708rad, 6.2832rad</dd>
</dl>
<p>
Represents an angle in gradians. One full circle is 400grad. Examples: 0grad, 100grad, 38.8grad.
</p>
<dl class="org-dl">
<dt>turn</dt><dd>Represents an angle in a number of turns. One full circle is 1turn. Examples: 0turn, 0.25turn, 1.2turn.</dd>
</dl>

<p>
3D transforms
</p>
<ul class="org-ul">
<li>tranlsate3d(x,y,z)
<ul class="org-ul">
<li>translateX(x) translateY(y) translateZ(z)</li>
</ul></li>
<li>scale3d(x,y,z)
<ul class="org-ul">
<li>scaleX(x) scaleY(y) scaleZ(z)</li>
</ul></li>
<li id="rotate3d(x,y,z,angle)">x, y, z is a vector and x|y|z is between 0 and 1, and rotate according to that vector
<ul class="org-ul">
<li>rotateX(angle) rotateY(angle) rotateZ(angle)</li>
</ul></li>
<li id="matrix3d"><a href="https://meyerweb.com/eric/tools/matrix/">https://meyerweb.com/eric/tools/matrix/</a></li>
<li id="perspective(d)">d is by default 0 and must be a positive number.</li>
</ul>

<p>
3D transform properties
</p>
<dl class="org-dl">
<dt>transform-origin</dt><dd>e.g. rotate around transform-origin <a href="https://css-tricks.com/almanac/properties/t/transform-origin/">https://css-tricks.com/almanac/properties/t/transform-origin/</a></dd>
<dt>transform-style</dt><dd>whether child elements should carry parent's transform property <a href="https://css-tricks.com/almanac/properties/t/transform-style/">https://css-tricks.com/almanac/properties/t/transform-style/</a></dd>
<dt>perspective</dt><dd>default none <a href="https://css-tricks.com/almanac/properties/p/perspective/">https://css-tricks.com/almanac/properties/p/perspective/</a></dd>
<dt>perspective-origin</dt><dd>50% 50%|initial|inheri <a href="https://css-tricks.com/almanac/properties/p/perspective-origin/">https://css-tricks.com/almanac/properties/p/perspective-origin/</a></dd>
<dt>backface-visibility</dt><dd>visible|hidden|initial|inherit</dd>
</dl>

<p>
<a href="http://ds-overdesign.com/transform/matrix3d.html">http://ds-overdesign.com/transform/matrix3d.html</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org397003a" class="outline-3">
<h3 id="org397003a"><span class="section-number-3">5.4</span> Link</h3>
<div class="outline-text-3" id="text-5-4">
<pre class="example">
// In order
a:link {} /* Unvisited and normal */
a:visited {}
a:hover {}
a:active {}
</pre>
</div>
</div>

<div id="outline-container-orge243238" class="outline-3">
<h3 id="orge243238"><span class="section-number-3">5.5</span> Text</h3>
<div class="outline-text-3" id="text-5-5">
</div>
<div id="outline-container-org9e34c22" class="outline-4">
<h4 id="org9e34c22"><span class="section-number-4">5.5.1</span> Ellipsis</h4>
<div class="outline-text-4" id="text-5-5-1">
<p>
Single Line
</p>
<pre class="example">
div.test {
 white-space: nowrap;
 width: 200px; // width has to be defined
 overflow: hidden; // needed
 text-overflow: ellipsis; // change to inherit when hover then the clipped text will show
}
</pre>

<p>
Multiple Lines (IE and Edge will not show 3 dots)
</p>

<pre class="example">
.excerpt {
  display: block;
  display: -webkit-box;
  font-weight: normal;
  font-size: 15px;
  line-height: 1.4;
  -webkit-line-clamp: 9;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
  height: 189px; /* 15*1.4*9 */
}
</pre>
</div>
</div>

<div id="outline-container-orgc210116" class="outline-4">
<h4 id="orgc210116"><span class="section-number-4">5.5.2</span> Long Word</h4>
<div class="outline-text-4" id="text-5-5-2">
<pre class="example">
word-wrap: break-word; // allow to break a long word
</pre>
</div>
</div>

<div id="outline-container-org0e781b1" class="outline-4">
<h4 id="org0e781b1"><span class="section-number-4">5.5.3</span> Font size, line-height, letter-spacing</h4>
<div class="outline-text-4" id="text-5-5-3">
<p>
font-size in child elements inherit parent element
em uses the current element's font-size or its closest parent element which has font-size defined
rem is relative to the &lt;html&gt;'s font-size. Set rem for line-height in &lt;body&gt; to ensure line-height is relative to &lt;html&gt;'s font-size.
</p>

<p>
!! Both em and rem will be affected by parent element's css:zoom in Edge!
</p>

<p>
vw and vh are the viewport width and height. 1vw is 1% of vw
</p>

<p>
Google recommends line-height is at least 1.2
</p>

<p>
line-height is normal means to use user agent style. Most likely default is 1 not 1.2
</p>

<p>
letter-spacing, padding using em is relative to the current element's font size
</p>
</div>
</div>

<div id="outline-container-org16e170d" class="outline-4">
<h4 id="org16e170d"><span class="section-number-4">5.5.4</span> Prevent sup and sub affecting line height <a id="org0955f2f">css:sup:line-height</a></h4>
<div class="outline-text-4" id="text-5-5-4">
<pre class="example">
sup, sub {
  vertical-align: baseline;
  position: relative;
  top: -0.4em;
}
sub { 
  top: 0.4em; 
}
</pre>

<p>
Email
</p>
<pre class="example">
.sup {
  line-height:0;
  font-size:6px;
  vertical-align:5px;
}
</pre>
</div>
</div>

<div id="outline-container-orga69745c" class="outline-4">
<h4 id="orga69745c"><span class="section-number-4">5.5.5</span> Fluid Typography</h4>
<div class="outline-text-4" id="text-5-5-5">
<pre class="example">
body {
  font-size: calc([minimum size] + ([maximum size] - [minimum size]) * ((100vw - [minimum viewport width]) / ([maximum viewport width] - [minimum viewport width])));
}

// example
html {
  font-size: 16px; /* [minimum size] */
}

/* 320px = [minimum viewport width] */
@media screen and (min-width: 320px) { 
  html {
    font-size: calc(16px + (22 - 16) * ((100vw - 320px) / (1000 - 320) ) );
  }
}

/* 1000px = [maximum viewport width] */
@media screen and (min-width: 1000px) {
  html {
    font-size: 22px; /* [maximum size] */
  }
}
</pre>

<p>
<a href="https://css-tricks.com/fitting-text-to-a-container/">https://css-tricks.com/fitting-text-to-a-container/</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orgdf32d39" class="outline-3">
<h3 id="orgdf32d39"><span class="section-number-3">5.6</span> <a href="#orgf67d3bb">CSS Selectors</a> <a id="orgf67d3bb">CSS Selectors</a></h3>
<div class="outline-text-3" id="text-5-6">
<p>
div &gt; p :: select p elements where the direct parent is div
div + p :: select p elements that are placed immediately after div
</p>
<pre class="example">
&lt;div&gt;&lt;/div&gt;
&lt;p&gt;&lt;/p&gt;
</pre>

<p>
p ~ ul :: select ul elements that are preceded by a p element
</p>
<pre class="example">
&lt;p&gt;&lt;/p&gt;
&lt;ul&gt;&lt;/ul&gt;
&lt;ul&gt;&lt;/ul&gt;
</pre>

<p>
a[target] :: &lt;a&gt;'s with target attribute
a[target=_blank]
a[title~=flower] :: containing a word or followed by a hypen (not match flowers)
a[lang|=en] :: starting with a word or followed by a hyphen (en, en-us)
div[class^="test"] :: starting with (anything)
div[class$="test"] :: ending with (anything)
a[href*="w3schools"] :: containing
</p>

<pre class="example">
:root {
  /* matches &lt;html&gt; */
  /* perfect place to define custom properties to be used by var() function */
  --example-name: 5px 24px;
  --blue: #007bff;
}
</pre>

<p>
a:active
a:hover
a:link :: div:link may be possible when div has href attribute
a:visited
</p>

<p>
p::after :: &lt;img&gt; can't have pseudo element
p::before
p::first-letter
p::first-line
p::selection
div::selection &#x2013; the selected portion of an element (e.g. select text)
</p>

<p>
input:checked
input[type="text"]:disabled
input:enabled
input:focus
input:invalid
input:valid
input:optional :: without required attribute
input:required :: with required attribute
</p>

<p>
p:empty :: has no children including text nodes
</p>

<p>
div:not(p) &#x2013; all children elements except &lt;p&gt;'s
div:not(.aClass) :: all div elements except the ones with class aClass
</p>

<p>
p:first-child :: &lt;p&gt;'s are the first child of any elements
p:last-child
p:nth-child(2)
p:nth-child(7n-1)
tr:nth-child(even)
tr:nth-child(odd)
p:nth-last-child(2)
p:only-child :: &lt;p&gt;'s are the only child of any elements
</p>

<p>
div p:first-of-type :: &lt;div&gt; has 4 children &lt;p&gt;'s and first child is &lt;a&gt;. Select 1st of &lt;p&gt; children.
div p:last-of-type
div p:nth-of-type(2) :: can use n like nth-child
div p:only-of-type
</p>

<p>
<code>#news:target</code> &#x2013; anchor name id=news matches the URL hash
</p>

<p>
ul &gt; li:not(:last-child):after
</p>
</div>
</div>

<div id="outline-container-orgb19f3c5" class="outline-3">
<h3 id="orgb19f3c5"><span class="section-number-3">5.7</span> Specificity</h3>
<div class="outline-text-3" id="text-5-7">
<p>
(a, b, c, d) start with (0, 0 , 0 ,0)
a - inline add 1
b - each id add 1
c - class, pseudo-class and attribute add 1
d - element add 1
</p>

<p>
Pseudo-class :not is not considered as pesudo-class in specificity calculation.
But anything inside it counts.
</p>
</div>
</div>

<div id="outline-container-org45d2a67" class="outline-3">
<h3 id="org45d2a67"><span class="section-number-3">5.8</span> Functions</h3>
<div class="outline-text-3" id="text-5-8">
</div>
<div id="outline-container-orge92ccd9" class="outline-4">
<h4 id="orge92ccd9"><span class="section-number-4">5.8.1</span> attr(data-attr-1)</h4>
<div class="outline-text-4" id="text-5-8-1">
<pre class="example">
a::after {
 content: " (" attr(href) ")";
}
</pre>
</div>
</div>

<div id="outline-container-orgdc8b0e6" class="outline-4">
<h4 id="orgdc8b0e6"><span class="section-number-4">5.8.2</span> calc()</h4>
<div class="outline-text-4" id="text-5-8-2">
<p>
No parenthesis is allowed inside calc()
Only attr() and calc() are allowed inside calc()
</p>

<pre class="example">
&lt;div&gt;Some Text...&lt;/div&gt;

// Always leave 50px on both sides for space
// and take all that is left for width

div {
 width: calc(100% - 100px); /* calculate */
 margin-left: 50px;
}

// 3 columns minus gutter
.item {
  width: calc(100%/3 - 10px/3);
}
</pre>
</div>
</div>

<div id="outline-container-org9429a8f" class="outline-4">
<h4 id="org9429a8f"><span class="section-number-4">5.8.3</span> counter</h4>
<div class="outline-text-4" id="text-5-8-3">
<div class="org-src-container">
<pre class="src src-css"><span style="color: #00ede1; font-weight: bold;">body </span>{
 <span style="color: #ffad29; font-weight: bold;">counter-reset</span>: section;
}
<span style="color: #00ede1; font-weight: bold;">h1 </span>{
 <span style="color: #ffad29; font-weight: bold;">counter-reset</span>: subsection;
}
<span style="color: #00ede1; font-weight: bold;">h1::before </span>{
 <span style="color: #ffad29; font-weight: bold;">counter-increment</span>: section,
 <span style="color: #ffad29; font-weight: bold;">content</span>: <span style="color: #e67128;">"Section "</span> counter(section) <span style="color: #e67128;">". "</span>;
}
<span style="color: #00ede1; font-weight: bold;">h2::before </span>{
 <span style="color: #ffad29; font-weight: bold;">counter-increment</span>: subsection;
 <span style="color: #ffad29; font-weight: bold;">content</span>: counter(section) <span style="color: #e67128;">"."</span> counter(subsection) <span style="color: #e67128;">" "</span>;
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org49367b3" class="outline-3">
<h3 id="org49367b3"><span class="section-number-3">5.9</span> border-image</h3>
<div class="outline-text-3" id="text-5-9">
<p>
border-image: source slice width outset repeat|initial|inherit;
border-image: none   100%   1     0     stretch
</p>
</div>
</div>

<div id="outline-container-org8457c76" class="outline-3">
<h3 id="org8457c76"><span class="section-number-3">5.10</span> background <a id="org84204cf">css:background</a></h3>
<div class="outline-text-3" id="text-5-10">
<p>
background: bg-color bg-image position/bg-size bg-repeat bg-origin bg-clip bg-attachment initial|inherit;
</p>

<pre class="example">
background: url(img_flwr.gif) right bottom no-repeat, url(paper.gif) left top repeat;
</pre>
</div>

<div id="outline-container-org2b3106a" class="outline-4">
<h4 id="org2b3106a"><span class="section-number-4">5.10.1</span> background-position</h4>
<div class="outline-text-4" id="text-5-10-1">
<p>
background-position: right center; // align right on X and align center on Y
background-position: right bottom;
background-position: right 100px bottom -100px; <i>/  for right/left or top/bottom, +- pixels
background-position: calc(50% - 100px) calc(50% + 100px); /</i> for center, calc has be used
</p>
</div>
</div>

<div id="outline-container-orgea29089" class="outline-4">
<h4 id="orgea29089"><span class="section-number-4">5.10.2</span> background-size</h4>
<div class="outline-text-4" id="text-5-10-2">
<p>
background-size: 20px auto;
background-size: 50% auto; <i>/ sets the width of the bg image in percent of the parent element.
background-size: contain; /</i> bg image might not cover all content area
background-size: cover; // content area might not see the whole bg image
</p>

<p>
Stretch on y-axis and repeat on x-axis
background: url() center repeat-x;
background-size: auto 100%;
</p>
</div>
</div>

<div id="outline-container-org1f1c878" class="outline-4">
<h4 id="org1f1c878"><span class="section-number-4">5.10.3</span> background-clip, background-origin</h4>
<div class="outline-text-4" id="text-5-10-3">
<p>
background-clip: border-box; <i>/ default. largest area
/</i> padding-box, content-box
</p>

<p>
<i>/ For background image
background-origin: border-box; /</i> default. largest area
// padding-box, content-box
</p>
</div>
</div>

<div id="outline-container-org6538e55" class="outline-4">
<h4 id="org6538e55"><span class="section-number-4">5.10.4</span> background-attachment</h4>
<div class="outline-text-4" id="text-5-10-4">
<p>
default scroll :: bg image will scroll with the page
fixed :: bg image will not scroll
local :: bg image will scroll with the element's contents
</p>
</div>
</div>

<div id="outline-container-org72f6a56" class="outline-4">
<h4 id="org72f6a56"><span class="section-number-4">5.10.5</span> Add dark layer on a background image</h4>
<div class="outline-text-4" id="text-5-10-5">
<p>
15% darker
</p>
<pre class="example">
// Before
background: url(/slide-03.jpg) no-repeat center center;

// After
background: linear-gradient(to bottom, rgba(0, 0, 0, 0.15) 0%, rgba(0, 0, 0, 0.15) 100%), url('/slide-03.jpg') no-repeat center center;
</pre>
</div>
</div>

<div id="outline-container-org1e04109" class="outline-4">
<h4 id="org1e04109"><span class="section-number-4">5.10.6</span> Mobile background-attachment:fixed background-size:cover</h4>
<div class="outline-text-4" id="text-5-10-6">
<p>
Instead of
</p>
<pre class="example">
.cs-hero-background {
  background: url('...') no-repeat center bottom fixed;
  -webkit-background-size: cover;
  -moz-background-size: cover;
  -o-background-size: cover;
  background-size: cover;
}
</pre>

<p>
Do this, body:before might work in some situation
</p>
<pre class="example">
.cs-hero-background:before {
  content: "";
  display: block;
  position: fixed;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  z-index: -10;
  background: url('...') no-repeat center bottom;
  -webkit-background-size: cover;
  -moz-background-size: cover;
  -o-background-size: cover;
  background-size: cover;
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orga54c8a5" class="outline-3">
<h3 id="orga54c8a5"><span class="section-number-3">5.11</span> List style</h3>
<div class="outline-text-3" id="text-5-11">
<p>
&lt;'list-style-type'&gt; || &lt;'list-style-position'&gt; || &lt;'list-style-image'&gt;
Can't control the image size.
</p>
</div>
</div>

<div id="outline-container-orgdc82628" class="outline-3">
<h3 id="orgdc82628"><span class="section-number-3">5.12</span> Color</h3>
<div class="outline-text-3" id="text-5-12">
</div>
<div id="outline-container-org6aa8e6e" class="outline-4">
<h4 id="org6aa8e6e"><span class="section-number-4">5.12.1</span> <a id="org2c01afc">CSS inherit color</a></h4>
<div class="outline-text-4" id="text-5-12-1">
<p>
You can grab the parent `color` css property and use it in any color properties in child element
</p>
<pre class="example">
&lt;div class="parent"&gt;
 &lt;div class="child"&gt;
 &lt;/div&gt;
&lt;/div&gt;

.parent {
 color: red;
 background-color: blue;
}
.child {
 background-color: currentColor; /* take the parent color: red */
 color: currentColor; /* Take the parent color: red */
}
</pre>
</div>
</div>

<div id="outline-container-orge7f6a14" class="outline-4">
<h4 id="orge7f6a14"><span class="section-number-4">5.12.2</span> rgb(), rgba() <a id="orgced5a97">CSS rgba</a></h4>
<div class="outline-text-4" id="text-5-12-2">
<div class="org-src-container">
<pre class="src src-css"><span style="color: #ffffff; background-color: #f03;">#f03</span>
<span style="color: #ffffff; background-color: #ff0033;">#ff0033</span>
<span style="color: #ffffff; background-color: #FF0033;">#FF0033</span>
<span style="color: #ffffff; background-color: #ff0033;">rgb(255, 0, 51)</span> // no fraction all integers
<span style="color: #ffffff; background-color: #ff0033;">rgb(100%, 0%, 20%)</span> // all % no integer

<span style="color: #ffffff; background-color: #f03;">#f030</span>     // 0% opaque <span style="color: #ffffff; background-color: #ff0000;">red</span>
<span style="color: #ffffff; background-color: #ff0033;">#ff003300</span> // 0% opaque <span style="color: #ffffff; background-color: #ff0000;">red</span>
<span style="color: #ffffff; background-color: #FF0033;">#FF003388</span> // 50% opaque <span style="color: #ffffff; background-color: #ff0000;">red</span>
<span style="color: #ffffff; background-color: #ff0000;">rgba(255,0,0,0.7)</span> // 70% opaque <span style="color: #ffffff; background-color: #ff0000;">red</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdb3c773" class="outline-4">
<h4 id="orgdb3c773"><span class="section-number-4">5.12.3</span> hsl(), hsla()</h4>
<div class="outline-text-4" id="text-5-12-3">
<p>
Hue :: integer, angle degree of the color circle. Red is 0, Green is 120, Blue is 240
Saturation :: percentage. 0% is grey
Lightness :: 100% is white, 0% is black, 50% is normal
</p>

<pre class="example">
hsla(240, 100%, 50%, 0.05) // 5% opaque blue
</pre>
</div>
</div>
</div>

<div id="outline-container-org4f9af99" class="outline-3">
<h3 id="org4f9af99"><span class="section-number-3">5.13</span> Gradient <a id="org49ff3e1">CSS gradient</a></h3>
<div class="outline-text-3" id="text-5-13">
<p>
Both <a href="#org49ff3e1">CSS gradient</a> and <a href="#orge4faa3c">CSS repeat gradient</a> can be stacked in background-image
</p>

<pre class="example">
linear-gradient(45deg, blue, red);
// to bottom, to top
// to right, to left
// to bottom right, to top left
linear-gradient(to bottom, blue, white 80%, orange);
// blue at 0%, white at 80%, orange at 100%
linear-gradient(to right, red, orange, yellow, green, blue);
// evenly distributed

background: linear-gradient(to right, rgba(255,255,255,0), rgba(255,255,255,1))
           ,url(/bg.jpg);
// Use it with background image

radial-gradient(red, yellow, rgb(30, 144, 255)); // evenly spaced
radial-gradient(red 5%, yellow 25%, #1E90FF 50%);
radial-gradient(
 circle, 
 // Shape can circle or ellipse
 // Default farthest-side
 // Fade from the center point to the ___
 // closest-corner, closest-side, farthest-corner, farthest-side
 yellow, #f06d06
);
// Change from center point to corner
radial-gradient(
 circle farthest-corner at top right,
 yellow, #f06d06
);
</pre>

<p>
<a id="orge4faa3c">CSS repeat gradient</a>
</p>

<pre class="example">
// On top of percentage, px can be used in repeat gradient
repeating-linear-gradient(-45deg, red, red 5px, white 5px, white 10px);
</pre>
</div>
</div>

<div id="outline-container-org508e7cc" class="outline-3">
<h3 id="org508e7cc"><span class="section-number-3">5.14</span> opacity</h3>
<div class="outline-text-3" id="text-5-14">
<p>
0, 0.3, 1. The lower the value the more transparent
Child elements inherits the parent opacity value
If you don't want to carry opacity to children, define rgba color in parent elements
<a href="#orgced5a97">CSS rgba</a>
</p>
</div>
</div>

<div id="outline-container-orgc648075" class="outline-3">
<h3 id="orgc648075"><span class="section-number-3">5.15</span> Shadow</h3>
<div class="outline-text-3" id="text-5-15">
<p>
Shadows can be stacked
</p>
<pre class="example">
box-shadow: h-shadow v-shadow blur spread color |inset|initial|inherit;
text-shadow: h-shadow v-shadow blur-radius color|none|initial|inherit;
</pre>

<p>
Text stroke/outline
</p>
<pre class="example">
text-shadow:
  -1px -1px 0 #000,
   0   -1px 0 #000,
   1px -1px 0 #000,
   1px  0   0 #000,
   1px  1px 0 #000,
   0    1px 0 #000,
  -1px  1px 0 #000,
  -1px  0   0 #000;

// you might need to adjust font smoothing to antialiased
font-smoothing: antialiased;
-webkit-font-smoothing: antialiased;

// there's a new way! Won't work on IE but work on all current browsers
-webkit-text-fill-color:#ffd33a;
-webkit-text-stroke: 1px #ffd33a;
</pre>
</div>
</div>

<div id="outline-container-orgdac7f43" class="outline-3">
<h3 id="orgdac7f43"><span class="section-number-3">5.16</span> object-fit</h3>
<div class="outline-text-3" id="text-5-16">
<p>
Apply this to &lt;img&gt;, &lt;video&gt; to have background effect.
Usually width and height are set in those elements.
</p>

<p>
fill (default) | contain | cover | none | scale-down
</p>

<pre class="example">
&lt;img src="..." class="cover"&gt;

img {
  width: 150px;
  height: 100px;
}
.cover {
  -webkit-object-fit: cover;
  -moz-object-fit: cover;
  -ms-object-fit: cover;
  -o-object-fit: cover;
  object-fit: cover;
}
</pre>

<p>
Edge and IE only works for &lt;img&gt; element
</p>
</div>
</div>

<div id="outline-container-org0489282" class="outline-3">
<h3 id="org0489282"><span class="section-number-3">5.17</span> @font-face <a id="org0eea7ac">css:font-face</a></h3>
<div class="outline-text-3" id="text-5-17">
<p>
Most widely accepted font format is WOFF then TTF and OTF.
IE 11 and less only supports EOT. Edge supports WOFF.
</p>

<p>
!! Use full url in src: url() for email HTML
</p>

<pre class="example">
@font-face {
 font-family: myFirstFont;
 src: url(sansation_light.woff);
}

// Another for bold
@font-face {
 font-family: myFirstFont;
 src: url(sansation_bold.woff);
 font-weight: bold;
/*
 font-stretch: normal | condensed | semi condensed | extra condensed | ultra condensed | expanded | ...;
 font-style: normal | italic | oblique 
*/
}
</pre>
</div>

<div id="outline-container-orgf63eca6" class="outline-4">
<h4 id="orgf63eca6"><span class="section-number-4">5.17.1</span> font-display</h4>
<div class="outline-text-4" id="text-5-17-1">
<p>
Chrome and Firefox will use the font fallback if the first font choice is not available after 3 seconds (timeout). If the first font choice is available later, a swap occurs.
Internet Explorer has 0 timeout and use fallback immediately and swap later if font is available.
Safari always wait for the font to be downloaded.
</p>

<p>
font-display :: Not supported in IE, Edge and iOS &lt; 11.4
</p>
<dl class="org-dl">
<dt>auto</dt><dd>use user-agent's default. Most user-agents use block</dd>
<dt>block</dt><dd>After 3 seconds if the font is not loaded use a invisible text and swap to the downloaded font with infinite swap period</dd>
<dt>swap</dt><dd>browser draws text immediately with a fallback and swap to it after it's loaded.</dd>
<dt>fallback</dt><dd>fallback at first and swap to it later. If too much time passes (3s), then the fallback is used for the rest of page lifetime.</dd>
<dt>optional</dt><dd>the font is a nice to have but not critical. It leaves it up to the browser to decide whether to initiate the font download.</dd>
</dl>

<pre class="example">
@font-face {
  font-family: 'Awesome Font';
  font-style: normal;
  font-weight: 400;
  font-display: auto; /* or block, swap, fallback, optional */
  src: local('Awesome Font'),
       url('/fonts/awesome-l.woff2') format('woff2'), /* will be preloaded */ 
       url('/fonts/awesome-l.woff') format('woff'),
       url('/fonts/awesome-l.ttf') format('truetype'),
       url('/fonts/awesome-l.eot') format('embedded-opentype');
  unicode-range: U+000-5FF; /* Latin glyphs */
}
</pre>
</div>
</div>

<div id="outline-container-org6b788af" class="outline-4">
<h4 id="org6b788af"><span class="section-number-4">5.17.2</span> Font Loading API</h4>
<div class="outline-text-4" id="text-5-17-2">
<p>
<a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/webfont-optimization">https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/webfont-optimization</a>
<a href="https://medium.com/@matuzo/getting-started-with-css-font-loading-e24e7ffaa791">https://medium.com/@matuzo/getting-started-with-css-font-loading-e24e7ffaa791</a>
</p>

<p>
Not supported in IE and Edge
</p>

<pre class="example">
var font = new FontFace("Awesome Font", "url(/fonts/awesome.woff2)", {
  style: 'normal', unicodeRange: 'U+000-5FF', weight: '400'
});

// don't wait for the render tree, initiate an immediate fetch!
font.load().then(function() {
  // apply the font (which may re-render text and cause a page reflow)
  // after the font has finished downloading
  document.fonts.add(font);
  document.body.style.fontFamily = "Awesome Font, serif";

  // OR... by default the content is hidden, 
  // and it's rendered after the font is available
  var content = document.getElementById("content");
  content.style.visibility = "visible";

  // OR... apply your own render strategy here... 
});

// check status :: unloaded, loading, loaded, error
font.status

// Promise loaded resolves when the font is loaded
notoSansRegular.loaded.then((fontFace) =&gt; {
  // This is where you can declare a new font-family, because the font is now loaded and ready.  
  console.info('Current status', fontFace.status);
  console.log(fontFace.family, 'loaded successfully.');
  // Throw an error if loading wasn't successful
}, (fontFace) =&gt; {
  console.error('Current status', notoSansRegular.status);
});


// when all fonts are ready
document.fonts.ready.then((fontFaceSet) =&gt; {
  console.log(document.fonts.size, 'FontFaces loaded.');
});
</pre>
</div>
</div>

<div id="outline-container-org20deccf" class="outline-4">
<h4 id="org20deccf"><span class="section-number-4">5.17.3</span> Bootstrap 3</h4>
<div class="outline-text-4" id="text-5-17-3">
<pre class="example">
@font-face {
  font-family: 'Glyphicons Halflings';
  src: url('../fonts/glyphicons-halflings-regular.eot');
  src: url('../fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), 
       url('../fonts/glyphicons-halflings-regular.woff2') format('woff2'), 
       url('../fonts/glyphicons-halflings-regular.woff') format('woff'), 
       url('../fonts/glyphicons-halflings-regular.ttf') format('truetype'),
       url('../fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');
}
</pre>
</div>
</div>

<div id="outline-container-org9cde1a1" class="outline-4">
<h4 id="org9cde1a1"><span class="section-number-4">5.17.4</span> Google Font :: local() unicode-range</h4>
<div class="outline-text-4" id="text-5-17-4">
<p>
&lt;link href="<a href="https://fonts.googleapis.com/css?family=Montserrat:400,700">https://fonts.googleapis.com/css?family=Montserrat:400,700</a>" rel="stylesheet" type="text/css"&gt;
</p>

<p>
local('Font Name') if user agent has the font, then the font will not be downloaded. 
</p>

<p>
unicode-range :: ranges are separated by comma
</p>
<dl class="org-dl">
<dt>Sigle codepoint</dt><dd>U+416</dd>
<dt>Interval range</dt><dd>start and end e.g. U+400-4ff</dd>
<dt>Wildcard range</dt><dd>? is any hexadecimal digit e.g. U+4??</dd>
</dl>

<p>
The browser:
</p>
<ul class="org-ul">
<li>Can't make a bold font lighter</li>
<li>Can't make an oblique (italic) font "straight"</li>
<li>Has limited ability to synthesize bold(er) fonts</li>
<li>Has limited ability to synthesize oblique fonts and may produce wrong shapes esepcially in Cyrillic fonts.</li>
</ul>

<pre class="example">
/* cyrillic-ext */
@font-face {
  font-family: 'Montserrat';
  font-style: normal;
  font-weight: 400;
  src: local('Montserrat Regular'), local('Montserrat-Regular'), url(https://fonts.gstatic.com/s/montserrat/v12/JTUSjIg1_i6t8kCHKm459WRhyzbi.woff2) format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Montserrat';
  font-style: normal;
  font-weight: 400;
  src: local('Montserrat Regular'), local('Montserrat-Regular'), url(https://fonts.gstatic.com/s/montserrat/v12/JTUSjIg1_i6t8kCHKm459W1hyzbi.woff2) format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* vietnamese */
@font-face {
  font-family: 'Montserrat';
  font-style: normal;
  font-weight: 400;
  src: local('Montserrat Regular'), local('Montserrat-Regular'), url(https://fonts.gstatic.com/s/montserrat/v12/JTUSjIg1_i6t8kCHKm459WZhyzbi.woff2) format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Montserrat';
  font-style: normal;
  font-weight: 400;
  src: local('Montserrat Regular'), local('Montserrat-Regular'), url(https://fonts.gstatic.com/s/montserrat/v12/JTUSjIg1_i6t8kCHKm459Wdhyzbi.woff2) format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Montserrat';
  font-style: normal;
  font-weight: 400;
  src: local('Montserrat Regular'), local('Montserrat-Regular'), url(https://fonts.gstatic.com/s/montserrat/v12/JTUSjIg1_i6t8kCHKm459Wlhyw.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/* cyrillic-ext */
@font-face {
  font-family: 'Montserrat';
  font-style: normal;
  font-weight: 700;
  src: local('Montserrat Bold'), local('Montserrat-Bold'), url(https://fonts.gstatic.com/s/montserrat/v12/JTURjIg1_i6t8kCHKm45_dJE3gTD_u50.woff2) format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Montserrat';
  font-style: normal;
  font-weight: 700;
  src: local('Montserrat Bold'), local('Montserrat-Bold'), url(https://fonts.gstatic.com/s/montserrat/v12/JTURjIg1_i6t8kCHKm45_dJE3g3D_u50.woff2) format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* vietnamese */
@font-face {
  font-family: 'Montserrat';
  font-style: normal;
  font-weight: 700;
  src: local('Montserrat Bold'), local('Montserrat-Bold'), url(https://fonts.gstatic.com/s/montserrat/v12/JTURjIg1_i6t8kCHKm45_dJE3gbD_u50.woff2) format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Montserrat';
  font-style: normal;
  font-weight: 700;
  src: local('Montserrat Bold'), local('Montserrat-Bold'), url(https://fonts.gstatic.com/s/montserrat/v12/JTURjIg1_i6t8kCHKm45_dJE3gfD_u50.woff2) format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Montserrat';
  font-style: normal;
  font-weight: 700;
  src: local('Montserrat Bold'), local('Montserrat-Bold'), url(https://fonts.gstatic.com/s/montserrat/v12/JTURjIg1_i6t8kCHKm45_dJE3gnD_g.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
</pre>
</div>
</div>

<div id="outline-container-org5cc6560" class="outline-4">
<h4 id="org5cc6560"><span class="section-number-4">5.17.5</span> Web Safe Fonts <a id="orga7649c3">css:font-face:web safe fonts</a></h4>
<div class="outline-text-4" id="text-5-17-5">
<ul class="org-ul">
<li>Arial, Arial Black</li>
<li>Comic Sans MS</li>
<li>Courier New</li>
<li>Georgia</li>
<li>Impact / Charcoal</li>
<li>Lucida Sans / Lucida Grande</li>
<li>Tahoma / Geneva</li>
<li>Times New Roman</li>
<li>Trebuchet MS</li>
<li>Verdana</li>
</ul>

<p>
<a href="http://www.cssfontstack.com/">Web Safe Fonts in PC and Mac</a> and font stack
</p>
</div>
</div>
</div>

<div id="outline-container-org767ab60" class="outline-3">
<h3 id="org767ab60"><span class="section-number-3">5.18</span> CSS target IE 11 and IE10</h3>
<div class="outline-text-3" id="text-5-18">
<p>
Target IE 11 only
</p>
<pre class="example">
_:-ms-fullscreen, :root .msie11 { color: blue; }
</pre>

<p>
Target IE 10 and IE 11
</p>
<pre class="example">
@media all and (-ms-high-contrast:none) {
  .foo { color: green } /* IE10 */
  *::-ms-backdrop, .foo { color: red } /* IE11 */
}
</pre>
</div>
</div>

<div id="outline-container-orgae9d35d" class="outline-3">
<h3 id="orgae9d35d"><span class="section-number-3">5.19</span> @media</h3>
<div class="outline-text-3" id="text-5-19">
<p>
@media not|only <i>mediatype</i> and (<i>media feature</i>) {}
&lt;link rel="stylesheet" media="mediatype and|not|only (media feature)" href="style.css"&gt;
</p>
</div>

<div id="outline-container-org9e090ed" class="outline-4">
<h4 id="org9e090ed"><span class="section-number-4">5.19.1</span> Syntax</h4>
<div class="outline-text-4" id="text-5-19-1">
<p>
not <i>mediatype</i>
only <i>mediatype</i>
</p>

<p>
Each media feature, key:value or key, must be wrapped in ()
Some media feature doesn't have a value.
</p>

<p>
<code>not /mediatype/</code> and <code>only /mediatype/</code> can be chained with OR (separated by comma) but not <code>and</code>
</p>
<pre class="example">
// This works
@media screen and (min-width:200px), not print and (min-width:300px) {}

// This syntax is wrong
@media screen and (min-width:200px) and not print and (min-width:300px) {}
</pre>

<p>
Note :: <code>not /mediatype/</code> is different from <code>not(/mediafeature/)</code>
</p>

<p>
Nested media queries (@media inside another @media) is supported on all browsers except IE11 and below.
</p>
</div>
</div>

<div id="outline-container-orgac13263" class="outline-4">
<h4 id="orgac13263"><span class="section-number-4">5.19.2</span> Testing</h4>
<div class="outline-text-4" id="text-5-19-2">
<pre class="example">
var mql = window.matchMedia("(orientation: portrait)");
// window.addListener(handlerOrientationChange);
handlerOrientationChange(mql);

function handlerOrientationChange(mql) {
 if (mql.mathces) {
  console.log('media query matches');
 }
 else {
  console.log('media query does not match');
 }
}
</pre>
</div>
</div>

<div id="outline-container-org0cfcd11" class="outline-4">
<h4 id="org0cfcd11"><span class="section-number-4">5.19.3</span> Media Types <a id="org7f0d2b3">css:@media:type</a></h4>
<div class="outline-text-4" id="text-5-19-3">
<p>
all, print, screen, speech
</p>

<pre class="example">
@media screen and (max-width: 1000px) and (min-width: 700px) {}
// Use comma for OR
@media screen and (max-width: 699px) and (min-width: 520px), (min-width: 1151px) {}
</pre>
</div>
</div>

<div id="outline-container-org2b475c4" class="outline-4">
<h4 id="org2b475c4"><span class="section-number-4">5.19.4</span> <a id="orgdd4f0e1">meta viewport</a></h4>
<div class="outline-text-4" id="text-5-19-4">
<pre class="example">
&lt;meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"&gt;
// Set the width of the page to follow the screen-width of the device
// Initial zoom level 1.0

// Prevent zoom: add maximum-scale=1.0, user-scalable=0
// the above won't be WCAG compliant
</pre>
</div>
</div>

<div id="outline-container-orgc24560c" class="outline-4">
<h4 id="orgc24560c"><span class="section-number-4">5.19.5</span> Features <a id="org4dbbbf3">css:@media:features</a></h4>
<div class="outline-text-4" id="text-5-19-5">
<p>
min-width, max-width and:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Key</td>
<td class="org-left">Min/Max?</td>
<td class="org-left">value</td>
</tr>

<tr>
<td class="org-left">orientation</td>
<td class="org-left">no</td>
<td class="org-left">landscape, portrait. Not reliable when soft keyboard opens</td>
</tr>

<tr>
<td class="org-left">color</td>
<td class="org-left">yes</td>
<td class="org-left">int, number of colors. (color) for color device</td>
</tr>

<tr>
<td class="org-left">aspect-ratio</td>
<td class="org-left">yes</td>
<td class="org-left">int1/int2</td>
</tr>

<tr>
<td class="org-left">grid</td>
<td class="org-left">no</td>
<td class="org-left">0, 1 or (grid). The last suggests it's a device with 1 font</td>
</tr>

<tr>
<td class="org-left">width, height</td>
<td class="org-left">yes</td>
<td class="org-left">viewport</td>
</tr>

<tr>
<td class="org-left">monochrome</td>
<td class="org-left">yes</td>
<td class="org-left">0 (not mono) or int</td>
</tr>

<tr>
<td class="org-left">resolution</td>
<td class="org-left">yes</td>
<td class="org-left">300dpi or 2dppx</td>
</tr>

<tr>
<td class="org-left">pointer</td>
<td class="org-left">no</td>
<td class="org-left">fine (mouse, drawying stylus), coarse (finger), none (not a pointing device)</td>
</tr>

<tr>
<td class="org-left">hover</td>
<td class="org-left">no</td>
<td class="org-left">none (finger), hover (can have hover state)</td>
</tr>
</tbody>
</table>

<p>
pointer and hover always refer to the primary device while any-pointer and any-hover refers to any if exists.
any-hover has on-demand which means mobile services can emulate hovering when the user performs a long tap.
</p>

<p>
Don't use min/max-device-width as it refers to the screen size not the viewport size
</p>
</div>
</div>

<div id="outline-container-orge5cf51c" class="outline-4">
<h4 id="orge5cf51c"><span class="section-number-4">5.19.6</span> Responsive Design</h4>
<div class="outline-text-4" id="text-5-19-6">
<p>
Progressive Method :: start from mobile layout, add content to bigger screen size
</p>
<pre class="example">
/* {
 box-sizing: border-box;
}
.row:after {
 content: "";
 clear:both;
 display:block;
}
[class*="col-"] {
 float: left;
 padding: 15px;
 width: 100%;
}
@media only screen and (min-width: 600px) {
    .col-s-1 {width: 8.33%;}
    .col-s-2 {width: 16.66%;}
    .col-s-3 {width: 25%;}
    .col-s-4 {width: 33.33%;}
    .col-s-5 {width: 41.66%;}
    .col-s-6 {width: 50%;}
    .col-s-7 {width: 58.33%;}
    .col-s-8 {width: 66.66%;}
    .col-s-9 {width: 75%;}
    .col-s-10 {width: 83.33%;}
    .col-s-11 {width: 91.66%;}
    .col-s-12 {width: 100%;}
}
@media only screen and (min-width: 768px) {
    .col-1 {width: 8.33%;}
    .col-2 {width: 16.66%;}
    .col-3 {width: 25%;}
    .col-4 {width: 33.33%;}
    .col-5 {width: 41.66%;}
    .col-6 {width: 50%;}
    .col-7 {width: 58.33%;}
    .col-8 {width: 66.66%;}
    .col-9 {width: 75%;}
    .col-10 {width: 83.33%;}
    .col-11 {width: 91.66%;}
    .col-12 {width: 100%;}
}

&lt;div class="row"&gt;
 &lt;div class="col-3 col-s-3 menu"&gt;
  &lt;ul&gt;
   &lt;li&gt;Menu 1&lt;/li&gt;
   &lt;li&gt;Menu 2&lt;/li&gt;
   &lt;li&gt;Menu 3&lt;/li&gt;
 &lt;/div&gt;

 &lt;div class="col-6 col-s-9"&gt;
  long content...
 &lt;/div&gt;

 &lt;div class="col-3 col-s-12"&gt;
  right sidebar...
 &lt;/div&gt;
&lt;/div&gt;
</pre>

<p>
Graceful Method :: start from desktop layout, remove content to smaller screen size
</p>
</div>

<div id="outline-container-org78b2c67" class="outline-5">
<h5 id="org78b2c67"><span class="section-number-5">5.19.6.1</span> Mostly Fluid</h5>
<div class="outline-text-5" id="text-5-19-6-1">
<p>
<a href="https://googlesamples.github.io/web-fundamentals/fundamentals/design-and-ux/responsive/mostly-fluid.html">https://googlesamples.github.io/web-fundamentals/fundamentals/design-and-ux/responsive/mostly-fluid.html</a>
</p>
<pre class="example">
    &lt;div class="container" role="main"&gt;
      &lt;div class="c1"&gt;
      &lt;/div&gt;
      &lt;div class="c2"&gt;
      &lt;/div&gt;
      &lt;div class="c3"&gt;
      &lt;/div&gt;
      &lt;div class="c4"&gt;
      &lt;/div&gt;
      &lt;div class="c5"&gt;
      &lt;/div&gt;
    &lt;/div&gt;

.container {
  display: -webkit-flex;
  display: flex;
  -webkit-flex-flow: row wrap;
  flex-flow: row wrap;
}

.c1, .c2, .c3, .c4, .c5 {
  width: 100%;
}

@media (min-width: 600px) {
  .c2, .c3, .c4, .c5 {
    width: 50%;
  }
}

@media (min-width: 800px) {
  .c1 {
    width: 60%;
  }
  .c2 {
    width: 40%;
  }
  .c3, .c4, .c5 {
    width: 33.33%;
  }
}

@media (min-width: 800px) {
  .container {
    width: 800px;
    margin-left: auto;
    margin-right: auto;
  }
}
</pre>
</div>
</div>

<div id="outline-container-orge9f95db" class="outline-5">
<h5 id="orge9f95db"><span class="section-number-5">5.19.6.2</span> Column Drop</h5>
<div class="outline-text-5" id="text-5-19-6-2">
<p>
<a href="https://googlesamples.github.io/web-fundamentals/fundamentals/design-and-ux/responsive/column-drop.html">https://googlesamples.github.io/web-fundamentals/fundamentals/design-and-ux/responsive/column-drop.html</a>
</p>
<pre class="example">
&lt;div class="container" role="main"&gt;
  &lt;div class="c1"&gt;&lt;/div&gt;
    &lt;div class="c2"&gt;&lt;/div&gt;
    &lt;div class="c3"&gt;&lt;/div&gt;
&lt;/div&gt;

.container {
  display: -webkit-flex;
  display: flex;
  -webkit-flex-flow: row wrap;
  flex-flow: row wrap;
}

.c1, .c2, .c3 {
  width: 100%;
}

@media (min-width: 600px) {
  .c1 {
    width: 60%;
    -webkit-order: 2;
    order: 2;
  }

  .c2 {
    width: 40%;
    -webkit-order: 1;
    order: 1;
  }

  .c3 {
    width: 100%;
    -webkit-order: 3;
    order: 3;
  }
}


@media (min-width: 800px) {
  .c2 {
    width: 20%;
  }

  .c3 {
    width: 20%;
  }
}
</pre>
</div>
</div>

<div id="outline-container-org9bd50cc" class="outline-5">
<h5 id="org9bd50cc"><span class="section-number-5">5.19.6.3</span> Layout shifter</h5>
<div class="outline-text-5" id="text-5-19-6-3">
<p>
<a href="https://googlesamples.github.io/web-fundamentals/fundamentals/design-and-ux/responsive/layout-shifter.html">https://googlesamples.github.io/web-fundamentals/fundamentals/design-and-ux/responsive/layout-shifter.html</a>
</p>
<pre class="example">
&lt;div class="container" role="main"&gt;
  &lt;div class="c1"&gt;&lt;/div&gt;
  &lt;div class="c4"&gt;
    &lt;div class="c2"&gt;&lt;/div&gt;
    &lt;div class="c3"&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

.container {
  display: -webkit-flex;
  display: flex;
  -webkit-flex-flow: row wrap;
  flex-flow: row wrap;
}

.c1, .c2, .c3, .c4 {
  width: 100%;
}

@media (min-width: 600px) {
  .c1 {
    width: 25%;
  }

  .c4 {
    width: 75%;
  }

}

@media (min-width: 800px) {
  .container {
    width: 800px;
    margin-left: auto;
    margin-right: auto;
  }
}
</pre>
</div>
</div>

<div id="outline-container-org74ce28e" class="outline-5">
<h5 id="org74ce28e"><span class="section-number-5">5.19.6.4</span> Off canvas</h5>
<div class="outline-text-5" id="text-5-19-6-4">
<p>
<a href="https://googlesamples.github.io/web-fundamentals/fundamentals/design-and-ux/responsive/off-canvas.html">https://googlesamples.github.io/web-fundamentals/fundamentals/design-and-ux/responsive/off-canvas.html</a>
</p>
<pre class="example">
&lt;div class="container" role="main"&gt;
  &lt;div class="c1" id="leftDrawer"&gt;
  &lt;/div&gt;
  &lt;div class="c2" id="mainPanel"&gt;
    Click the &lt;code&gt;div&lt;/code&gt;'s to change views
  &lt;/div&gt;
  &lt;div class="c3" id="rightDrawer"&gt;
  &lt;/div&gt;
&lt;/div&gt;

body {
  overflow-x: hidden;
}

.container {
  display: block;
}

.c1, .c3 {
  position: absolute;
  width: 250px;
  height: 100%;

  /*
    This is a trick to improve performance on newer versions of Chrome
    #perfmatters
  */
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden; 

  -webkit-transition: -webkit-transform 0.4s ease-out;
  transition: transform 0.4s ease-out;

  z-index: 1;
}

.c1 {
  /*
  Using translate3d as a trick to improve performance on older versions of Chrome
  See: http://aerotwist.com/blog/on-translate3d-and-layer-creation-hacks/
  #perfmatters
  */
  -webkit-transform: translate(-250px,0);
  transform: translate(-250px,0);
}

.c2 {
  width: 100%;
  position: absolute;
}

.c3 {
  left: 100%;
}

.c1.open {
  -webkit-transform: translate(0,0);
  transform: translate(0,0);
}

.c3.open {
  -webkit-transform: translate(-250px,0);
  transform: translate(-250px,0);
}

@media (min-width: 500px) {
  /* If the screen is wider then 500px, use Flexbox */
  .container {
    display: -webkit-flex;
    display: flex;
    -webkit-flex-flow: row nowrap;
    flex-flow: row nowrap;
  }
  .c1 {
    position: relative;
    -webkit-transition: none 0s ease-out;
    transition: none 0s ease-out;
    -webkit-transform: translate(0,0);
    transform: translate(0,0);
  }
  .c2 {
    position: static;
  }
}

@media (min-width: 800px) {
  body {
    overflow-x: auto;
  }
  .c3 {
    position: relative;
    left: auto;
    -webkit-transition: none 0s ease-out;
    transition: none 0s ease-out;
    -webkit-transform: translate(0,0);
    transform: translate(0,0);
  }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org24c3228" class="outline-4">
<h4 id="org24c3228"><span class="section-number-4">5.19.7</span> Viewport sizes of device</h4>
<div class="outline-text-4" id="text-5-19-7">
<p>
<a href="http://viewportsizes.com/">http://viewportsizes.com/</a>
</p>

<pre class="example">
// @media only screen and (max-width:1920) {}
// @media all and (...) {...}

@media (max-width:1920px){}

/* iPadPro@H1366 */
@media (max-width:1400px){}

/* iPad@H1024 */
@media (max-width:1267px){}

/* iPadPro@1024 */
@media (max-width:1201px){}

@media (max-width:1023px){}

@media (max-width:967px){}

/* iPad@768, iPhone6+@H736, Nexus 6P/5X@H732 */
@media (max-width:867px){}

/* iPhone6@H667 */
@media (max-width:697px){}

/* GalaxyS5@H640 */
@media (max-width:645px){}

/* iPhone5@H568 */
@media (max-width:597px){}

@media (max-width:467px){}

/* iPhone6+@414, Nexus 6P/5X@412 */
@media (max-width:420px){}

/* iPhone6@375, GalaxyS5@360 */
@media (max-width:375px){}

/* iPhone5@320 */
@media (max-width:320px){}
</pre>

<p>
Mobile first
</p>
<pre class="example">
.any {
  width:100%;
}

@media (min-width:576px) {}
@media (min-width:768px) {}
@media (min-width:992px) {}
@media (min-width:1200px) {}
</pre>
</div>
</div>
</div>

<div id="outline-container-org18e7a81" class="outline-3">
<h3 id="org18e7a81"><span class="section-number-3">5.20</span> @keyframes <a id="org06dcf43">css:animation</a></h3>
<div class="outline-text-3" id="text-5-20">
<p>
IE10+, iOS 6.1+, Android 4.4.4+
</p>

<p>
animation: <i>name</i> <i>duration</i> <i>timing-function</i> <i>delay</i> <i>iteration-count</i> <i>direction</i> <i>fill-mode</i> <i>play-state</i>;
</p>

<pre class="example">
@keyframes fa-spin {
 0%   { transform: rotate(0deg); }
 100% { transform: rotate(359deg); } 
}
.fa-spin {
 animation: fa-spin 2s linear 3s infinite alternate;
/* 
  2s - duration
  3s - delay :: delay before start, once started, the delay has no effect.
  infinite - animation-iteration-count
  alternate - animation-direction

  animation-fill-mode:
    none (default, after animation ends, styles go back to before start) | 
    forwards (after animation ends, styles got applied) | 
    backwards (before animation starts and during delay, apply styles defined in the 1 iteration, e.g. from and to ) | 
    both;
*/
}
.fa-repeat:before {
  content: "\f01e";
}
&lt;i class="fa fa-repeat fa-spin"&gt;&lt;/i&gt;
// Spinner made in FontAwesome 
</pre>

<p>
Javascript starts keyframes animation
</p>
<pre class="example">
&lt;div id="myDIV" onclick="startAnimation()"&gt;Click to start animation&lt;/div&gt;
var x = document.getElementById("myDIV");
function startAnimation() {
 x.style.animation = "fa-spin 2s liner 3s infinite alternate"; // Standard
}
</pre>

<p>
Javascript animation event listners
</p>
<pre class="example">
x.addEventListner("animationstart", func1);
x.addEventListner("animationiteration", func2);
x.addEventListner("animationend", func3);
</pre>
</div>
</div>

<div id="outline-container-org6ed610f" class="outline-3">
<h3 id="org6ed610f"><span class="section-number-3">5.21</span> @import</h3>
<div class="outline-text-3" id="text-5-21">
<pre class="example">
/* @import usage should be avoided and should appear before any css styles defined in a css file */
@import "mystyle.css";
@import url("mystyle.css");
@import "mystyle.css" print;
/* only media types not media features */
</pre>
</div>
</div>

<div id="outline-container-org533db11" class="outline-3">
<h3 id="org533db11"><span class="section-number-3">5.22</span> @viewport</h3>
<div class="outline-text-3" id="text-5-22">
<p>
WD. Only Edge. Same as <a href="#orgdd4f0e1">meta viewport</a>.
</p>

<pre class="example">
@media screen and (max-width: 400px) {
 @-ms-viewport { width: 320px; }
 /* Define the viewport size */
}
</pre>
</div>
</div>

<div id="outline-container-org9a2894a" class="outline-3">
<h3 id="org9a2894a"><span class="section-number-3">5.23</span> @supports</h3>
<div class="outline-text-3" id="text-5-23">
<pre class="example">
@supports not (display:flex) {}
@supports (display: flex) or 
          (display: -ms-flexbox) or
          (display: -moz-box) {}

@supports (transition-property: color) or 
          ( (animation-name: myAnimation) and (transform: rotate(225deg) )
          ) {}
</pre>
</div>
</div>

<div id="outline-container-org039f485" class="outline-3">
<h3 id="org039f485"><span class="section-number-3">5.24</span> Flexbox <a id="orgaf7eb63">css:flex</a></h3>
<div class="outline-text-3" id="text-5-24">
</div>
<div id="outline-container-orgd2d0574" class="outline-4">
<h4 id="orgd2d0574"><span class="section-number-4">5.24.1</span> Basics</h4>
<div class="outline-text-4" id="text-5-24-1">
<p>
Container could be display:flex or display:inline-flex
Flexbox is good for aligning child elements with irregular or unknown or inconsistent width and height
And the number of child elements are unknown
Good for vertical and horizontal center a child element inside a container (parent)
Good for these scenarios <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Typical_Use_Cases_of_Flexbox">https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Typical_Use_Cases_of_Flexbox</a>
</p>

<p>
Can't set equal width for child items when the number of child items is unknown
</p>

<pre class="example">
.container {
 display: flex;
 /* flex-flow: &lt;flex-direction&gt; &lt;flex-wrap&gt; */

 /* flex-direction: row | row-reverse | column | column-reverse; */
 /* main axis is by default horizontally left to right 
  * main axis is changed by direcion css property (say change it ot rtl, right to left)
  * row is left to right , column is top to bottom
  *
  */
 /* flex-wrap: nowrap | wrap | wrap-reverse; */
    flex-flow: row wrap;

 /* justify-content: flex-start | flex-end | center | space-between | space-around; */
 /* e.g. you can change from flex-end to space-around for menu nav with @media queries */
    justify-content: space-around;

 /* align-items: stretch | flex-start | flex-end | center | baseline; */
 /* This is for aligning items on one line (default x axis) on cross axis (y axis) */
 /* relative to the same line. e.g. you have 3 lines of items and each line holds 3 items. 
  * 3 items on each line have different height
  * how do the 3 items align on y axis on every line?
  * default is stretch
  */ 

 /* align-content: flex-start | flex-end | center | space-between | space-around | stretch;
  * This is for space between multiple lines
  * e.g. There're 3 lines of items and each line has 3 items 
  * How do the 3 lines align on the y axis on each line?
  * default is stretch
  * It only works when there are multiple lines and the container height is larger than total children height
  */

  /* It's always to set width and height in container */
  width: 100%;
}

.item {
 /* order: &lt;integer&gt;; // optional */

 /* flex: none | &lt;flex-grow&gt; &lt;flex-shrink&gt; &lt;flex-basis&gt; */
 /* Default flex:0 1 auto; */

 /* flex-grow: 0 | &lt;number&gt;; */
 /* 0 is default and means do not enlarge item in width (default x axis) */

 /* flex-shrink: 1 | &lt;number&gt; */
 /* 1 is default and means do not shrink item in width (default x axis) */
 /* 0 might be necessary for items to shrink */

 /* flex-basis: auto | &lt;length&gt;; */
 /* auto is default. if it's 0, extra space will not be factored in. Always use auto */
 /* Set to 0% instead of 0 */

 /* don't set width in flex item */
 flex: 0 0 100px; /* instead of width:100px */
 flex: 0 0 50%; /* width: 50% */
 /* However, flex-basis is not guaranteed and it's based on max-width and min-width */

 flex: 1 0 auto; /* grow to the rest of the width, no shrink, auto */

 /* Override align-items in container */
 /* align-self: stretch | auto | flex-start | flex-end | center | baseline; */

}

.item_1 {
 /* Set margin:auto in an item will absorb all space of the current line in current direction
 margin-right: auto;
 /* all other items to the right of item_1 will not have extra space */
}
</pre>
</div>
</div>

<div id="outline-container-org6c12164" class="outline-4">
<h4 id="org6c12164"><span class="section-number-4">5.24.2</span> Insert a line break in flex items. Might not be easy..</h4>
<div class="outline-text-4" id="text-5-24-2">
<pre class="example">
.line-break {width: 100%}

&lt;div class="container"&gt;
 &lt;div class="item"&gt;1&lt;/div&gt;
 &lt;div class="item"&gt;2&lt;/div&gt;
 &lt;div class="line-break"&gt;&lt;/div&gt;
 &lt;div class="item"&gt;3&lt;/div&gt;
 &lt;div class="item"&gt;4&lt;/div&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org7f1867b" class="outline-4">
<h4 id="org7f1867b"><span class="section-number-4">5.24.3</span> flex-grow:1</h4>
<div class="outline-text-4" id="text-5-24-3">
<p>
You can flex-grow a child's width or height (depending on the flex-direction of the container), so that the child takes up the remaining width or height of the container.
Just remember to set the width or height for the container.
</p>

<p>
Combine with Bootstrap div.container and div.row, you can set a specific row to take the rest of the container height.
You don't have to get height of any other rows.
</p>

<pre class="example">
.container.flex-column {
  display:flex;
  flex-direction:column;
  height: 100%; /* Make sure the container has a height */
  /* This is to take the height of the parent of the container */
}

.row.cover-row {
  flex-grow:1;
}
</pre>
</div>
</div>

<div id="outline-container-org30ebd1f" class="outline-4">
<h4 id="org30ebd1f"><span class="section-number-4">5.24.4</span> Examples</h4>
<div class="outline-text-4" id="text-5-24-4">
<pre class="example">
.flex-r-nw-sb {
  /* row nowrap space-between */
  display:flex;
  flex-flow: row nowrap;
  width:100%;
}
.flex-r-nw-sb-fs {
  /* row nowrap space-between don't stretch items' height on each line */
  display:flex;
  justify-content:space-between;
  flex-flow: row nowrap;
  align-items:flex-start;
  width:100%;
}

.flex-r-nw-sb-mq-r-w-c {
  /* row nowrap space-between */
  /* same as flex-r-nw-sb but with @media query */
  display:flex;

  flex-flow: row nowrap;
  width:100%;
}

@media only screen and (max-width: 597px) {
  .flex-r-nw-sb-mq-r-w-c {
    flex-flow: row wrap;
  }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org0f37bd4" class="outline-3">
<h3 id="org0f37bd4"><span class="section-number-3">5.25</span> Equal width for unknown number of child elements</h3>
<div class="outline-text-3" id="text-5-25">
<pre class="example">
&lt;div&gt;
   &lt;span&gt;tab1&lt;/span&gt;
   &lt;span&gt;tab2&lt;/span&gt;
   &lt;span&gt;tabx&lt;/span&gt;
&lt;/div&gt;
</pre>

<pre class="example">
div{
  margin:0;
  padding:0;
  width:100%;
  max-width:100%;
  display:table; /* trick */
  table-layout: fixed; /* trick */
}
span{
  border:1px solid grey;
  padding 0 20;
  margin:0;
  overflow:hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  display:table-cell; /* trick */
}

/* Set back
div {
  display:block;
  table-layout:auto;
}
span {
  display:inline;
}
*/
</pre>
</div>
</div>

<div id="outline-container-org5ed73d1" class="outline-3">
<h3 id="org5ed73d1"><span class="section-number-3">5.26</span> Grid</h3>
<div class="outline-text-3" id="text-5-26">
<p>
<a href="https://css-tricks.com/snippets/css/complete-guide-grid/">https://css-tricks.com/snippets/css/complete-guide-grid/</a>
</p>
</div>

<div id="outline-container-org9d3c290" class="outline-4">
<h4 id="org9d3c290"><span class="section-number-4">5.26.1</span> container: display, grid-template-columns, grid-template-rows</h4>
<div class="outline-text-4" id="text-5-26-1">
<p>
<a id="orgdd78ba2">css:grid-template-columns</a> <a id="org5d7c905">css:grid-template-rows</a>
</p>

<pre class="example">
&lt;!-- div.container has to be the direct parent of all grid items --&gt;
&lt;div class="container"&gt;
 &lt;!-- .item are direct descendants --&gt;
 &lt;div class="item item-1"&gt;&lt;/div&gt;
 &lt;div class="item item-2"&gt;
  &lt;div class="sub-item"&gt;
    &lt;!-- .sub-item is not a grid item! --&gt;
  &lt;/div&gt;
 &lt;/div&gt;
 &lt;div class="item item-3"&gt;&lt;/div&gt;
&lt;/div&gt;

.container {

 display: grid | inline-grid | subgrid;
 /* subgrid to indicate the grid container is a grid item of another grid container and 
    it should take the parent's sizes of rows/columns  
 */

 /* Don't use column, float, clear and vertical-align in grid container as they have no effect */

 /*
 grid-template-columns: &lt;track-size&gt; ... | &lt;line-name&gt; &lt;track-size&gt; ...;
 grid-template-rows: &lt;track-size&gt; ... | &lt;line-name&gt; &lt;track-size&gt; ...;

 &lt;track-size&gt; - can be a length, a percentage, or a fraction of the free space in the grid (unit is fr)
 &lt;line-name&gt; - an arbitrary name
 */

 grid-template-columns: 40px 50px auto 50px 40px; /* 5 columns */
 grid-template-rows: 25% 100px auto; /* 3 rows */

 /* Add line names
 grid-template-columns: [first] 40px [line2] 50px [line3] auto [col4-start] 50px [five] 40px [end];
 grid-template-rows: [row1-start] 25% [row1-end row2-start] 100px [third-line] auto [last-line];

 /* Any row or column line can have multiple names: [row1-end row-start]
    Any row or column line can have the same name */

 grid-template-columns: repeat(3, 20px [col-start]) 5%;
 /* equivalent to */
 grid-template-columns: 20px [col-start] 20px [col-start] 20px [col-start] 5%;

 /* Free space is defined as total space minus any fixed size items */
 grid-template-columns: 1fr 50px 1fr 1fr;
 /* each column will take (total width - 50px) * (1/3) */
}
</pre>
</div>
</div>

<div id="outline-container-org0219b19" class="outline-4">
<h4 id="org0219b19"><span class="section-number-4">5.26.2</span> <a id="org54d01aa">container: grid-template-areas</a>, <a href="#org2985f37">items: grid-area</a></h4>
<div class="outline-text-4" id="text-5-26-2">
<p>
<a id="org9ab1dc1">css:grid-template-areas</a>
</p>

<pre class="example">
.item-a{
  grid-area: header;
}
.item-b{
  grid-area: main;
}
.item-c{
  grid-area: sidebar;
}
.item-d{
  grid-area: footer;
}

.container{
  grid-template-columns: 50px 50px 50px 50px;
  grid-template-rows: auto;
  grid-template-areas: "header header header header"
                       "main main . sidebar"
                       "footer footer footer footer";
d}
/* . means that single cell is empty. You can have multiple dots without space ".." */
/*
The first row line and column line of footer area have an extra name "footer-start"
The last row line and column line of footer aree have an extra name "footer-end"
*/
</pre>
</div>
</div>

<div id="outline-container-org795cf4c" class="outline-4">
<h4 id="org795cf4c"><span class="section-number-4">5.26.3</span> container: grid-template</h4>
<div class="outline-text-4" id="text-5-26-3">
<p>
Shorthand for setting <a href="#org5d7c905">css:grid-template-rows</a>, <a href="#orgdd78ba2">css:grid-template-columns</a> and <a href="#org9ab1dc1">css:grid-template-areas</a>
</p>

<pre class="example">
.container {
  grid-template: none | subgrid | &lt;grid-template-rows&gt; / &lt;grid-template-columns&gt;;
}
</pre>
</div>
</div>

<div id="outline-container-org8e3f58a" class="outline-4">
<h4 id="org8e3f58a"><span class="section-number-4">5.26.4</span> container: grid-column-gap, grid-row-gap, grid-gap <a id="org6ed148a">css:grid-gap</a></h4>
<div class="outline-text-4" id="text-5-26-4">
<p>
Gutter size: space inbetween 2 row lines or column lines. But start and end space is always 0.
</p>

<pre class="example">
grid-column-gap: 10px;
grid-row-gap: 15px;
grid-gap: &lt;grid-row-gap&gt; &lt;grid-column-gap&gt;;
</pre>
</div>
</div>

<div id="outline-container-orgf7cb9b4" class="outline-4">
<h4 id="orgf7cb9b4"><span class="section-number-4">5.26.5</span> container: justify-items, items: justify-self <a id="org1036000">css:justify-items</a></h4>
<div class="outline-text-4" id="text-5-26-5">
<pre class="example">
justify-items: start | end | center | stretch (default);
/* Adjust content in a grid item along the row axis
   start: align to left end of the grid area
   end: right
   stretch: fills the whole width of the grid area
*/

.item {
 justify-self: /* To overwrite .container: justify-items */
}
</pre>
</div>
</div>

<div id="outline-container-org33ff107" class="outline-4">
<h4 id="org33ff107"><span class="section-number-4">5.26.6</span> container: align-items, items: align-self <a id="orgf3753c4">css:align-items</a></h4>
<div class="outline-text-4" id="text-5-26-6">
<pre class="example">
align-items: start | end | center | stretch (default);
/* Adjust content in a grid item along the column axis
   start: align content to the top of the grid area
   end: bottom
   stretch: fills the whole height of the grid area
*/

.item {
  align-self: start | end | center | stretch (default);
}
</pre>
</div>
</div>

<div id="outline-container-orge1d8653" class="outline-4">
<h4 id="orge1d8653"><span class="section-number-4">5.26.7</span> container: justify-content</h4>
<div class="outline-text-4" id="text-5-26-7">
<p>
Align the grid along the row axis.
If all grid items are sized with non-flexible units like px, the total size of grid might be less than the size of its grid container.
Total width of all grids is less than width of its grid container.
start: align all grids to the left of the grid container
end: right
stretch: resize the grid items to allow the grid to fill the full width of the grid container
space-around: place an even amount of space between each grid item, with half-sized spaces on the far ends
space-between: place an even amount of space between each grid item, with no space at the far ends
space-evenly: place an even amount of space between each grid item, including the far ends
</p>
<pre class="example">
justify-content: start | end | center | stretch | space-around | space-between | space-evenly
</pre>
</div>
</div>

<div id="outline-container-org608b540" class="outline-4">
<h4 id="org608b540"><span class="section-number-4">5.26.8</span> container: align-content</h4>
<div class="outline-text-4" id="text-5-26-8">
<p>
Align the grid along the column axis.
Total height of all grids is less than height of its grid container.
start: align all grids to the top of the grid container
</p>
<pre class="example">
align-content: start | end | center | stretch | space-around | space-between | space-evenly
</pre>
</div>
</div>

<div id="outline-container-org680b46a" class="outline-4">
<h4 id="org680b46a"><span class="section-number-4">5.26.9</span> container: grid-auto-columns, grid-auto-rows <a id="orgede1e47">css:grid-auto-columns</a> <a id="org03bb24c">css:grid-auto-rows</a></h4>
<div class="outline-text-4" id="text-5-26-9">
<p>
Implicit grid tracks are created when items have positioned or resized (<a href="#org131ee6c">items: grid-column, grid-row</a>) outside of the defined grid (<a href="#org54d01aa">container: grid-template-areas</a>).
Implicit grid tracks will have 0 width by default until it's set.
Implicit grid tracks of 2 columns and 2 rows are set.
</p>
<pre class="example">
grid-template-columns: 60px 60px;
grid-tempalte-rows: 90px 90px;
/* 2x2 grids are created. 3 row lines and 3 column lines */
/* but item-b is out of bound */
.item-b {
 grid-column: 5 / 6; /* From the 5th column line to the 6th */
 grid-row: 2 / 3; /* From the 2nd row line to the 3rd */
}
/* It's 5x2 grids now. */
grid-auto-columns: 60px; /* the implicit grid tracks width is 60px but .item-b is auto */
grid-auto-rows: auto;
</pre>
</div>
</div>

<div id="outline-container-orge33bd61" class="outline-4">
<h4 id="orge33bd61"><span class="section-number-4">5.26.10</span> container: grid-auto-flow <a id="org4d1c9d0">css:grid-auto-flow</a></h4>
<div class="outline-text-4" id="text-5-26-10">
<p>
For items that are not positioned (<a href="#org131ee6c">items: grid-column, grid-row</a>) nor 
put in a named area (<a href="#org2985f37">items: grid-area</a>) which is later used by <a href="#org54d01aa">container: grid-template-areas</a>,
these items are "not explicitly placed on the grid".
Use this to control the auto placement
</p>
<pre class="example">
grid-auto-flow: row | column | row dense | column dense
/* row : fill rows first (default)
   column: fill columns first
   dense : fill smaller items first (order of items might change!)
*/
</pre>

<pre class="example">
&lt;section class="container"&gt;
  &lt;div class="item-a"&gt;item-a&lt;/div&gt;
  &lt;div class="item-b"&gt;item-b&lt;/div&gt;
  &lt;div class="item-c"&gt;item-c&lt;/div&gt;
  &lt;div class="item-d"&gt;item-d&lt;/div&gt;
  &lt;div class="item-e"&gt;item-e&lt;/div&gt;
&lt;/section&gt;

.container { /* 5x2 */
  display: grid;
  grid-template-columns: 60px 60px 60px 60px 60px;
  grid-template-rows: 30px 30px;
  grid-auto-flow: row;
}
.item-a { /* 2x1 */
  grid-column: 1;
  grid-row: 1 / 3;
}
.item-e { /* 2x1 */
  grid-column: 5;
  grid-row: 1 / 3;
}
</pre>
</div>
</div>

<div id="outline-container-org568ed3c" class="outline-4">
<h4 id="org568ed3c"><span class="section-number-4">5.26.11</span> container: grid</h4>
<div class="outline-text-4" id="text-5-26-11">
<p>
<a href="#org5d7c905">css:grid-template-rows</a> <a href="#orgdd78ba2">css:grid-template-columns</a> <a href="#org4d1c9d0">css:grid-auto-flow</a>
<a href="#orgede1e47">css:grid-auto-columns</a> <a href="#org03bb24c">css:grid-auto-rows</a>
</p>
<pre class="example">
grid: none | &lt;grid-template-rows&gt; / &lt;grid-template-columns&gt; | &lt;grid-auto-flow&gt; [&lt;grid-auto-rows&gt; [/ &lt;grid-auto-columns&gt;]];
</pre>
</div>
</div>

<div id="outline-container-org7ec7874" class="outline-4">
<h4 id="org7ec7874"><span class="section-number-4">5.26.12</span> item: grid-column-start, grid-column-end, grid-row-start, grid-row-end</h4>
<div class="outline-text-4" id="text-5-26-12">
<p>
<a id="orgdf8ad24">css:grid-column-start</a> <a id="orgc29f157">css:grid-column-end</a> <a id="org3567534">css:grid-row-start</a> <a id="orgea77494">css:grid-row-end</a>
</p>

<pre class="example">
.item {
  grid-column-start: &lt;number&gt; | &lt;name&gt; | span &lt;number&gt; | span &lt;name&gt; | auto
  grid-column-end: &lt;number&gt; | &lt;name&gt; | span &lt;number&gt; | span &lt;name&gt; | auto
  grid-row-start: &lt;number&gt; | &lt;name&gt; | span &lt;number&gt; | span &lt;name&gt; | auto
  grid-row-end: &lt;number&gt; | &lt;name&gt; | span &lt;number&gt; | span &lt;name&gt; | auto
}
</pre>

<pre class="example">
.item-a {
  grid-column-start: 2;
  grid-column-end: five; /* line-name */
  grid-row-start: row1-start;
  grid-row-end: 3;
}

.item-b {
  grid-column-start: 1;
  grid-column-end: span col4-start; /* span to a line-name */
  grid-row-start: 2;
  grid-row-end: span 2; /* span 2 rows */
}
</pre>
</div>
</div>

<div id="outline-container-orgd914a91" class="outline-4">
<h4 id="orgd914a91"><span class="section-number-4">5.26.13</span> <a id="org131ee6c">items: grid-column, grid-row</a></h4>
<div class="outline-text-4" id="text-5-26-13">
<p>
<a href="#orgdf8ad24">css:grid-column-start</a> <a href="#orgc29f157">css:grid-column-end</a> <a href="#org3567534">css:grid-row-start</a> <a href="#orgea77494">css:grid-row-end</a>
</p>

<p>
Position and resize an item
</p>
<pre class="example">
grid-column: &lt;grid-column-start&gt; / &lt;grid-column-end&gt;;
grid-row: &lt;grid-row-start&gt; / &lt;grid-row-end&gt;;
</pre>

<pre class="example">
.item-c {
  grid-column: 3 / span 2;
  grid-row: third-line / 4;
}
</pre>
</div>
</div>

<div id="outline-container-orgdffcddb" class="outline-4">
<h4 id="orgdffcddb"><span class="section-number-4">5.26.14</span> <a id="org2985f37">items: grid-area</a></h4>
<div class="outline-text-4" id="text-5-26-14">
<p>
<a href="#org9ab1dc1">css:grid-template-areas</a>
</p>

<pre class="example">
grid-area: &lt;name&gt; | &lt;grid-row-start&gt; / &lt;grid-column-start&gt; / &lt;grid-row-end&gt; / &lt;grid-column-end&gt;
</pre>
</div>
</div>

<div id="outline-container-org35d828f" class="outline-4">
<h4 id="org35d828f"><span class="section-number-4">5.26.15</span> item: justify-self, align-self</h4>
<div class="outline-text-4" id="text-5-26-15">
<p>
Used to overwrite grid container's <a href="#org1036000">css:justify-items</a>, <a href="#orgf3753c4">css:align-items</a>
</p>
</div>
</div>

<div id="outline-container-orgb7a78bf" class="outline-4">
<h4 id="orgb7a78bf"><span class="section-number-4">5.26.16</span> IE10, IE11</h4>
<div class="outline-text-4" id="text-5-26-16">
<p>
IE doesn't support:
<a href="https://rachelandrew.co.uk/archives/2016/11/26/should-i-try-to-use-the-ie-implementation-of-css-grid-layout/">https://rachelandrew.co.uk/archives/2016/11/26/should-i-try-to-use-the-ie-implementation-of-css-grid-layout/</a>
</p>
<ul class="org-ul">
<li>auto-placement (for each item, need to specify -ms-grid-row, -ms-grid-column, -ms-grid-row-span, -ms-grid-column-span)</li>
<li>grid-template-areas</li>
</ul>


<pre class="example">
display: -ms-grid;
display: grid;
grid-gap:10px; /* not supported in IE, use grid*/
-ms-grid-columns: 100px 10px 100px 10px 100px; /* 2 extra columns are for gap */
-ms-grid-rows: 100px 10px 100px; /* the extra row is for gap */
grid-template-columns: 100px 100px 100px; /* notice there are 3 columns here while in IE there are 5 columns */
</pre>

<p>
.item
</p>
<pre class="example">
-ms-grid-row: 1;
-ms-grid-column: 1;
-ms-grid-column-span: 3;
grid-column: 1 / 3;
grid-row: 1;
</pre>
</div>
</div>
</div>

<div id="outline-container-org08ec0e0" class="outline-3">
<h3 id="org08ec0e0"><span class="section-number-3">5.27</span> Horizontal and Vertical Center</h3>
<div class="outline-text-3" id="text-5-27">
<p>
If both the parent and child are blocks, use flexbox.
</p>

<p>
For text or to place an absolute child element inside parent and the child element is not the only child. Refer to <a href="https://www.smashingmagazine.com/2013/08/absolute-horizontal-vertical-centering-css/">https://www.smashingmagazine.com/2013/08/absolute-horizontal-vertical-centering-css/</a>
</p>
<pre class="example">
.center {
 height:200px;
 position:relative;
}
.center p {
 margin:0;
 position:absolute;
 top:50%;
 left:50%;
 transform: translate(-50%, -50%);
}
</pre>

<p>
<a href="#org2308bb5">bs:Center Tags</a> Vertically center span inside h1
</p>

<p>
Vertically align &lt;img&gt; and &lt;span&gt; inside &lt;a&gt;
</p>
<pre class="example">
a {
  line-height:20px;
  display:block;
  vertical-align:middle;
}
a img {
  height: 15px; /* let's say the img's height is 15px */
}
a span {
  display:inline-block;
  vertical-align:middle;
  line-height:1em;
}
</pre>
</div>
</div>

<div id="outline-container-orgaded674" class="outline-3">
<h3 id="orgaded674"><span class="section-number-3">5.28</span> Column for text</h3>
<div class="outline-text-3" id="text-5-28">
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">div</span>&gt;
 &lt;<span style="color: #00ede1; font-weight: bold;">h2</span>&gt;<span style="font-weight: bold; font-style: italic; text-decoration: underline;">Title takes 2 columsn</span>&lt;/<span style="color: #00ede1; font-weight: bold;">h2</span>&gt;
 long text..
&lt;/<span style="color: #00ede1; font-weight: bold;">div</span>&gt;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-css"><span style="color: #00ede1; font-weight: bold;">div </span>{
 <span style="color: #ffad29; font-weight: bold;">column-count</span>: 3;
 <span style="color: #ffad29; font-weight: bold;">column-gap</span>: 40px;
 <span style="color: #ffad29; font-weight: bold;">column-rule-style</span>: solid; <span style="color: #74af68;">/* </span><span style="color: #74af68;">just like border </span><span style="color: #74af68;">*/</span>
 <span style="color: #ffad29; font-weight: bold;">column-rule-width</span>: 1px;
 <span style="color: #ffad29; font-weight: bold;">column-rule-color</span>: <span style="color: #000000; background-color: #add8e6;">lightblue</span>;
 <span style="color: #ffad29; font-weight: bold;">column-rule</span>: 1px solid <span style="color: #000000; background-color: #add8e6;">lightblue</span>;
}
<span style="color: #00ede1; font-weight: bold;">div h2 </span>{
 <span style="color: #ffad29; font-weight: bold;">column-span</span>: 2;
}

<span style="color: #00ede1; font-weight: bold;">div.fixedWidth </span>{
 <span style="color: #ffad29; font-weight: bold;">columns</span>: 200px; <span style="color: #74af68;">/* </span><span style="color: #74af68;">column-count will be auto </span><span style="color: #74af68;">*/</span>
 <span style="color: #ffad29; font-weight: bold;">overflow-x</span>: scroll;
 <span style="color: #ffad29; font-weight: bold;">height</span>: 600px; <span style="color: #74af68;">/* </span><span style="color: #74af68;">So that scrollbar shows on x axis </span><span style="color: #74af68;">*/</span>
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org806217f" class="outline-3">
<h3 id="org806217f"><span class="section-number-3">5.29</span> Shape</h3>
<div class="outline-text-3" id="text-5-29">
<p>
At the end of 2016, only Chrome, Safari, iOS and Android browswers support shape.
</p>

<pre class="example">
&lt;div class="conainer"&gt;
  &lt;img id="image" src="a.jpg"&gt;
  &lt;p id="content"&gt;Long text&lt;/p&gt;
&lt;/div&gt;

img {
 display: block;
 float:left;
 width: 100%;
 height: auto;
 shape-outside: url(shape.png); /* polygon can be used */
 /* png has areas that are partially or completely transparent */
 shape-image-threshold: 0.9; /* The shape is any areas that have opacity greater than 0.9 */
 shape-margin: 20px; 
}

</pre>
</div>
</div>

<div id="outline-container-orgac623df" class="outline-3">
<h3 id="orgac623df"><span class="section-number-3">5.30</span> SVG</h3>
<div class="outline-text-3" id="text-5-30">
<p>
xml header should be removed when used in HTML
</p>
<div class="org-src-container">
<pre class="src src-xml"><span style="color: #e67128;">&lt;?</span><span style="color: #ffad29; font-weight: bold;">xml</span><span style="color: #e67128;"> </span><span style="color: #e67128;">version="1.0" encoding="utf-8"</span><span style="color: #e67128;">?&gt;</span>
</pre>
</div>
</div>

<div id="outline-container-orgbd03d45" class="outline-4">
<h4 id="orgbd03d45"><span class="section-number-4">5.30.1</span> Make SVG, Optimize SVG, IE 11</h4>
<div class="outline-text-4" id="text-5-30-1">
<p>
Exported from AI and <a href="http://petercollingridge.appspot.com/svg-optimiser">optimize it</a> or use <a href="#orga34c902">nodejs:svgo</a>
</p>

<p>
IE 11 doesn't support url('a.svg') in background CSS. Use <a href="#orga34c902">nodejs:svgo</a> to convert to URL encoded.
</p>
<pre class="example">
div.svgbg {
  background-image:url('url-encoded-svg');
}
</pre>
</div>
</div>

<div id="outline-container-orgd4ccd86" class="outline-4">
<h4 id="orgd4ccd86"><span class="section-number-4">5.30.2</span> SVG as background image IE 11 <a id="orgb6db2e6">svg:ie11</a></h4>
<div class="outline-text-4" id="text-5-30-2">
<p>
AI export .svg by default is responsive and no width and height attributes are in &lt;svg&gt;
You may add width and height to &lt;svg&gt; based on viewBox
</p>
<pre class="example">
// before
&lt;svg viewBox="0 0 22.77 28.96"&gt;

// after
&lt;svg viewBox="0 0 22.77 28.96" width="22.77" height="28.96"&gt;
</pre>

<p>
If it still doesn't work, move &lt;styles&gt; to attributes
</p>

<p>
You need to export .svg in Adobe Illustrator using one of these mode for the Styling
</p>
<dl class="org-dl">
<dt>Presentation Attributes</dt><dd>fill="none" stroke="#cfdf00" stroke-width="0.44"</dd>
<dt>Inline Style</dt><dd>style="fill:none;stroke:#cfdf00;stroke-width:0.4399999976158142px"</dd>
</dl>

<p>
But not Internal Style.
</p>

<p>
If AI already exports the .svg, use <a href="#org6de4804">nodejs:svgo:move styles</a>
</p>
</div>
</div>

<div id="outline-container-org4250655" class="outline-4">
<h4 id="org4250655"><span class="section-number-4">5.30.3</span> SVG as background image dynamic size</h4>
<div class="outline-text-4" id="text-5-30-3">
<p>
You can only control size in this method
</p>
<pre class="example">
.logo {
 background: url(logo.svg) no-repeat top left;
 background-size: contain;
 width: 100px;
 height: 82px;
}
</pre>
</div>
</div>

<div id="outline-container-orgf0cd3c5" class="outline-4">
<h4 id="orgf0cd3c5"><span class="section-number-4">5.30.4</span> <a id="org631617d">CSS in SVG</a></h4>
<div class="outline-text-4" id="text-5-30-4">
<p>
Inline CSS
</p>
<pre class="example">
&lt;svg xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink"&gt;

    &lt;style type="text/css" &gt;
      &lt;![CDATA[

        circle.myGreen {
           stroke: #006600;
           fill:   #00cc00;
        }
       circle.myRed {
          stroke: #660000;
          fill:   #cc0000;
       }

      ]]&gt;
    &lt;/style&gt;

    &lt;circle  class="myGreen" cx="40" cy="40"  r="24"/&gt;
    &lt;circle  class="myRed"   cx="40" cy="100" r="24"/&gt;
&lt;/svg&gt;
</pre>

<p>
External CSS
</p>

<pre class="example">
&lt;?xml-stylesheet type="text/css" href="svg-stylesheet.css" ?&gt;
&lt;svg xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink"&gt;
    &lt;circle cx="40" cy="40" r="24"
       style="stroke:#006600; fill:#00cc00"/&gt;
&lt;/svg&gt;
</pre>

<p>
Embedded <a href="#org631617d">CSS in SVG</a> only affects the SVG not other elements in the global HTML if svg is not inline with global HTML.
</p>

<p>
Closed strokes forms shapes or path. Shapes or path's can be filled. And stroke (color) and stroke-width (default 1px when stroke is set) can be set.
</p>
</div>
</div>

<div id="outline-container-org897a03f" class="outline-4">
<h4 id="org897a03f"><span class="section-number-4">5.30.5</span> SVG Zoom and Pan</h4>
<div class="outline-text-4" id="text-5-30-5">
<pre class="example">
&lt;g id="parentGraphic"&gt;
 &lt;rect /&gt;
 &lt;text&gt;&lt;/text&gt;
&lt;/g&gt;

&lt;!-- use copy an element --&gt;
&lt;use href="#parentGraphic" transform="translate(40, 30) scale(0.9)"&gt;&lt;/use&gt;
</pre>

<pre class="example">
&lt;!-- Original --&gt;
&lt;svg currentScale="1" width="300px" height="200px" viewbox="0 0 300 200"&gt;
&lt;!-- Don't use currentScale to zoom --&gt;

&lt;!-- Move down 200/200*25=25px and move right 300/300=50 px --&gt;
&lt;svg width="300px" height="200px" viewbox="-50 -25 300 200"&gt;

&lt;!-- Enlarge 50% --&gt;
&lt;svg width="300px" height="200px" viewbox="0 0 150 100"&gt;

&lt;!-- Enlarge 50%, move down 200/100*25=50px and move right 300/150*50=100px --&gt;
&lt;svg width="300px" height="200px" viewbox="-50 -25 150 100"&gt;

viewBox = &lt;min-x&gt; &lt;min-y&gt; &lt;w&gt; &lt;h&gt;
</pre>

<p>
Assuming min-x and min-y is both 0
Original width and height is width and height (200x200)
</p>

<p>
50% smaller, just change w and h to w*2 and h*2
</p>

<p>
Now the circle radius is shrank from 100 to 50
You need to move down and right 50px
</p>

<p>
200/(w*2)*&lt;min-y&gt;=50
&lt;min-y&gt; = 50/200*(w*2)
</p>

<p>
&lt;min-y&gt; = -(target move down amount)/(svg width)*(w*(shrink factor))
&lt;min-x&gt; = -(target move right amount )/(svg height)*(h*(shrink factor))
</p>
</div>
</div>

<div id="outline-container-orgf7c971f" class="outline-4">
<h4 id="orgf7c971f"><span class="section-number-4">5.30.6</span> SVG Sprite</h4>
<div class="outline-text-4" id="text-5-30-6">
<p>
Old Way using <code>&lt;defs&gt;</code>, <code>viewBox</code> has to be defined in <code>&lt;svg&gt;</code>
</p>
<pre class="example">
&lt;svg&gt;
  &lt;defs&gt;
    &lt;g id="shape-icon-1"&gt;
      &lt;!-- all the paths and shapes and whatnot for this icon --&gt;
    &lt;g&gt;
    &lt;g id="shape-icon-2"&gt;
      &lt;!-- all the paths and shapes and whatnot for this icon --&gt;
    &lt;g&gt;
  &lt;/defs&gt;
&lt;/svg&gt;

&lt;!-- These viewBox's better be right or the icons won't look right! --&gt;

&lt;svg class="icon" viewBox="214.7 0 182.6 792"&gt;
  &lt;use xlink:href="#shape-icon-1" /&gt;
&lt;/svg&gt;

&lt;svg class="icon" viewBox="0 26 100 48"&gt;
  &lt;use xlink:href="#shape-icon-2" /&gt;
&lt;/svg&gt;
</pre>

<p>
New way using <code>&lt;symbol&gt;</code>, and they don't display until you <code>&lt;use&gt;</code> them
</p>
<pre class="example">
&lt;svg xmlns="http://www.w3.org/2000/svg" style="display: none;"&gt;

  &lt;symbol id="beaker" viewBox="214.7 0 182.6 792"&gt;
    &lt;!-- add more accessibility --&gt;
    &lt;title&gt;original-file's-title&lt;/title&gt; 
    &lt;desc&gt;original-file's-desc&lt;/desc&gt;

    &lt;!-- &lt;path&gt;s and whatever other shapes in here --&gt;  
  &lt;/symbol&gt;

  &lt;symbol id="shape-icon-2" viewBox="0 26 100 48"&gt;
    &lt;!-- &lt;path&gt;s and whatever other shapes in here --&gt;  
  &lt;/symbol&gt;

&lt;/svg&gt;

&lt;!-- We ain't even need no viewBox round here. --&gt; 

&lt;svg class="icon"&gt;
  &lt;use xlink:href="#shape-icon-1" /&gt;
&lt;/svg&gt;

&lt;svg class="icon"&gt;
  &lt;use xlink:href="#shape-icon-2" /&gt;
&lt;/svg&gt;
</pre>

<p>
About CSS styling for <code>&lt;svg&gt;&lt;use&gt;</code> :: <a href="https://tympanus.net/codrops/2015/07/16/styling-svg-use-content-css/">https://tympanus.net/codrops/2015/07/16/styling-svg-use-content-css/</a>
</p>

<p>
Polyfil svg4everybody searches and replaces <code>svg use</code> with <code>&lt;object&gt;</code>
</p>

<p>
New way using <code>&lt;symbol&gt;</code> only works when <code>&lt;svg&gt;&lt;use&gt;</code> (inline). If you want SVG-as-&lt;img&gt; or SVG-as-background-image, use this:
</p>
<pre class="example">
&lt;defs&gt;
  &lt;style&gt;
    g {
      display: none;
    }
    g:target {
      display: inline;
    }
  &lt;/style&gt;
&lt;/defs&gt;

&lt;g id="icon-clock"&gt;...&lt;/g&gt;
&lt;g id="icon-heart"&gt;...&lt;/g&gt;
&lt;g id="icon-arrow-right"&gt;...&lt;/g&gt;
</pre>

<pre class="example">
&lt;div class="lili-svg-as-bg"&gt;&lt;/div&gt;

.lili-svg-as-bg {
  background:url('//y.ca/a.svg#icon-clock') left top repeat;
  width:100%;
  height:400px;
  font-size:1rem;
}
</pre>


<p>
You can also place each svg one after another
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">view</span> <span style="color: #dbdb95;">id</span>=<span style="color: #e67128;">"icon-clock-view"</span> <span style="color: #dbdb95;">viewBox</span>=<span style="color: #e67128;">"0 0 32 32"</span> /&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">view</span> <span style="color: #dbdb95;">id</span>=<span style="color: #e67128;">"icon-heart-view"</span> <span style="color: #dbdb95;">viewBox</span>=<span style="color: #e67128;">"0 32 32 32"</span> /&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">view</span> <span style="color: #dbdb95;">id</span>=<span style="color: #e67128;">"icon-arrow-right-view"</span> <span style="color: #dbdb95;">viewBox</span>=<span style="color: #e67128;">"0 64 32 32"</span> /&gt;

&lt;<span style="color: #00ede1; font-weight: bold;">img</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"sprite.svg#svgView(viewBox(0, 0, 32, 32))"</span> <span style="color: #dbdb95;">alt</span>=<span style="color: #e67128;">""</span>&gt;
// or
&lt;<span style="color: #00ede1; font-weight: bold;">img</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"sprite.svg#icon-heart-view"</span> <span style="color: #dbdb95;">alt</span>=<span style="color: #e67128;">""</span>&gt;

.icon-clock {
  background: url(<span style="color: #e67128;">"sprite.svg#svgView(viewBox(0, 0, 32, 32))"</span>) no-repeat;
  // or
  background: url(sprite.svg#icon-clock-view) no-repeat;
  // or
  background: url(<span style="color: #e67128;">"sprite.svg"</span>) no-repeat;
  background-size: 32px 96px;
  background-position: 0 -32px;
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org26c2b76" class="outline-3">
<h3 id="org26c2b76"><span class="section-number-3">5.31</span> Use Cases</h3>
<div class="outline-text-3" id="text-5-31">
</div>
<div id="outline-container-orge88c36f" class="outline-4">
<h4 id="orge88c36f"><span class="section-number-4">5.31.1</span> iOS Hover</h4>
<div class="outline-text-4" id="text-5-31-1">
<p>
Other than &lt;a&gt; tag, :hover doesn't work on iOS. Try one of these workaround
</p>
<pre class="example">
// add onclick
&lt;div onClick="return true" class="tast test"&gt;
    Test
&lt;/div&gt;

// or add cursor:pointer
.test {
  background-color:blue;
}
div.test {
  cursor:pointer;
}
div.test:hover {
  background-color:red;
}
</pre>
</div>
</div>

<div id="outline-container-org5e91bb0" class="outline-4">
<h4 id="org5e91bb0"><span class="section-number-4">5.31.2</span> Fix parent height less than total children height</h4>
<div class="outline-text-4" id="text-5-31-2">
<pre class="example">
&lt;div class="clearfix"&gt;
  &lt;div style=""&gt;Div 1 doesn't float&lt;/div&gt;
  &lt;div style="float: left;"&gt;Div 2&lt;/div&gt;
&lt;/div&gt;

/* Solution 1 */
.clearfix:after {
 content: " ";
 display:block;
 clear:both;
 height:0;
}

/* Solution 2 */
.clearfix {
 display:inline-block;
 width:100%;
}
</pre>
</div>
</div>

<div id="outline-container-org5de768e" class="outline-4">
<h4 id="org5de768e"><span class="section-number-4">5.31.3</span> Image inside a div</h4>
<div class="outline-text-4" id="text-5-31-3">
<p>
Div's height is greater than img. add display:block in &lt;img&gt;
</p>
<pre class="example">
&lt;div class="item"&gt;
    &lt;img src="http://placehold.it/230x20/?text=6" style="display:block"&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-orgb8f9194" class="outline-4">
<h4 id="orgb8f9194"><span class="section-number-4">5.31.4</span> Transparent Image</h4>
<div class="outline-text-4" id="text-5-31-4">
<pre class="example">
&lt;img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
 width="100" height="100"&gt;
</pre>
</div>
</div>

<div id="outline-container-org345733b" class="outline-4">
<h4 id="org345733b"><span class="section-number-4">5.31.5</span> Image scaling</h4>
<div class="outline-text-4" id="text-5-31-5">
<p>
IE 10+ and Edge removes any -ms-* CSS filters, so this does not work any more
</p>
<pre class="example">
img { -ms-interpolation-mode: bicubic; }
</pre>

<p>
Use this plugin <a href="https://github.com/sukhoi1/ie-bicubic-img-interpolation-plugin">https://github.com/sukhoi1/ie-bicubic-img-interpolation-plugin</a>
</p>
<pre class="example">
$( document ).ready(function() {
  if (navigator.appName == 'Microsoft Internet Explorer' ||  !!(navigator.userAgent.match(/Trident/) || navigator.userAgent.match(/rv:11/)) || (typeof $.browser !== "undefined" &amp;&amp; $.browser.msie == 1))
  {
    $('img.render').bicubicImgInterpolation({
                crossOrigin: 'anonymous' //for demo purpose
    });
  }
});
</pre>
</div>
</div>

<div id="outline-container-org70be3cc" class="outline-4">
<h4 id="org70be3cc"><span class="section-number-4">5.31.6</span> Button Hover Double Quotes</h4>
<div class="outline-text-4" id="text-5-31-6">
<pre class="example">
&lt;button class="button" style=""&gt;&lt;span&gt;Hover &lt;/span&gt;&lt;/button&gt;
.button {
 display: inline-block;
 border-radius: 4px;
 background-color: #f4511e;
 border: none;
 color: #FFFFFF;
 text-align: center;
 font-size: 28px;
 padding: 20px;
 width: 200px;
 transition: all 0.5s;
 cursor: pointer;
 margin: 5px;
}
.button span {
 cursor: pointer;
 position: absolute;
 opacity: 0;
 top: 0;
 right: -20px;
 transition: 0.5s;
}
.button:hover span {
  padding-right: 25px; 
/*
push button text to left and create padding
for double quotes to push to the right of padding
*/
}
.button:hover span:after {
 opacity: 1;
 right: 0;
}
</pre>
</div>
</div>

<div id="outline-container-org3f4f39d" class="outline-4">
<h4 id="org3f4f39d"><span class="section-number-4">5.31.7</span> Text Label</h4>
<div class="outline-text-4" id="text-5-31-7">
<p>
Flair is a fixed font-size squared tag.
</p>

<p>
&lt;span class="li-tag li-tag-color"&gt;Flair&lt;/span&gt;
.li-tag{
  display:inline-block;
  margin-right: .5em;
  padding: 0 2px;
  border:1px solid;
  border-radius: 2px;
  font-size:x-small;
  white-space:nowrap;
  vertical-align:middle;
}
.li-tag-color{
  background-color:#f5f5f5;
  color: #555;
  border-color: #ddd;
}
.li-tag-red{
  background-color:#d9534f;
  color: #ffffff;
  border-color: #d9534f;
}
</p>

<p>
Vertical align inside h1, h2
h1 .li-tag, h2 .li-tag, h3 .li-tag {
  margin-top: -0.5em;
}
</p>

<p>
h1, h2 must have font-size defined
</p>
</div>
</div>

<div id="outline-container-orgf40e0bb" class="outline-4">
<h4 id="orgf40e0bb"><span class="section-number-4">5.31.8</span> Button with icon on the left</h4>
<div class="outline-text-4" id="text-5-31-8">
<pre class="example">
// No space in button
&lt;button class="li-button has-icon"&gt;&lt;span&gt;&lt;a href=""&gt;Youtube&lt;/a&gt;&lt;/span&gt;&lt;/button&gt;

&lt;style&gt;
.li-button {
  display:inline-block;
  padding:0 8px 0 5.5px;
  border:solid 1px transparent;
  border-radius:.25em;
  background-color:#0072BC;
  color:#ffffff;
  vertical-align:middle;
  /* Overwrite default button styles */
  outline:0;
  text-decoration:none;
  cursor:none;
}
.li-button.has-icon::before {
  margin-right:6px;
  background:url(icon.svg) no-repeat;
  background-size:16px 12px;
  width:16px;
  height:12px;
  content:'';
  display:inline-block;
  vertical-align:middle;
}
.li-button span {
  vertical-align:middle;
  font-size:12px;
}
&lt;/style&gt;
</pre>
</div>
</div>

<div id="outline-container-org7944460" class="outline-4">
<h4 id="org7944460"><span class="section-number-4">5.31.9</span> Vertical Line Separator in &lt;li&gt;</h4>
<div class="outline-text-4" id="text-5-31-9">
<pre class="example">
&lt;ul class="ul"&gt;
  &lt;li&gt;&lt;a href=""&gt;1&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=""&gt;2&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

.ul li:last-child {
  margin-right: 5px;
}
.ul li:not(:first-child):before {
  content: "|";
  padding:0 5px;
}
</pre>
</div>
</div>

<div id="outline-container-orgebd5771" class="outline-4">
<h4 id="orgebd5771"><span class="section-number-4">5.31.10</span> Wrap h1 around a div on the right, float right sequence</h4>
<div class="outline-text-4" id="text-5-31-10">
<pre class="example">
&lt;div class="div"&gt;
  &lt;a href=""&gt;&lt;img&gt;&lt;/a&gt;
&lt;/div&gt;
&lt;h1&gt;Long text...&lt;/h1&gt;
.div {
  display:block;
  float:right;
}
h1 {
  clear: none; /* default is none */
}

/* Make it take the whole width */
@media (max-width: 425px) {
    .div {
        display:block;
        text-align: center;
        width:100%;
    }
}
</pre>

<pre class="example">
&lt;div id="div1" style="float:right"&gt;&lt;/div&gt;
&lt;div id="div2" style="float:right"&gt;&lt;/div&gt;
&lt;h1&gt;...&lt;/h1&gt;
&lt;!-- Sequence: h1, div2, div1 --&gt;
</pre>
</div>
</div>

<div id="outline-container-orgfa2ceb9" class="outline-4">
<h4 id="orgfa2ceb9"><span class="section-number-4">5.31.11</span> 100% width and with margin</h4>
<div class="outline-text-4" id="text-5-31-11">
<p>
The trick is not specify 100% width and set the margin
Or
</p>
<pre class="example">
margin-left: 15px;
/* width: 100% */
width calc(100% - 15px);
</pre>
</div>
</div>

<div id="outline-container-orgcfdae02" class="outline-4">
<h4 id="orgcfdae02"><span class="section-number-4">5.31.12</span> Align text with elements</h4>
<div class="outline-text-4" id="text-5-31-12">
<p>
Use flex
</p>
<pre class="example">
&lt;div class="flex-r-w-fs-center"&gt;
  &lt;div class="app-information-title p-r-10 p-t-5"&gt;&lt;span&gt;A Title&lt;/span&gt;&lt;/div&gt;
  &lt;div class="app-information-btns"&gt;
    &lt;a href="#" role="button" class="btn btn-green-overnight" target="_blank"&gt;Sign up&lt;/a&gt;
    &lt;a href="#" role="button" class="btn btn-green-overnight"&gt;FAQs&lt;/a&gt;
    &lt;a href="#" role="button" class="btn btn-green-overnight" target="_blank"&gt;Learn more&lt;/a&gt;
  &lt;/div&gt;
&lt;/div&gt;

.app-information-title {
  font-size:26px;
  font-family: 'tg-medium';
  font-weight: normal;
}
.app-information-title span{
  line-height:33px;
}
</pre>
</div>
</div>

<div id="outline-container-orgca39db3" class="outline-4">
<h4 id="orgca39db3"><span class="section-number-4">5.31.13</span> Circle Number List</h4>
<div class="outline-text-4" id="text-5-31-13">
<pre class="example">
.numberCircle {
    border-radius: 50%;
    behavior: url(PIE.htc); /* remove if you don't care about IE8 */

    width: 36px;
    height: 36px;
    padding: 8px;

    background: #fff;
    border: 2px solid #666;
    color: #666;
    text-align: center;

    font: 32px Arial, sans-serif; /* 32 + padding/2 = width = height */
}
</pre>

<pre class="example">
&lt;span style="font-size: 450%; color: #FF5722;"&gt;&amp;#9312;&lt;/span&gt;
</pre>

<pre class="example">
&lt;span class="step"&gt;1&lt;/span&gt;

span.step {
  background: #cccccc;
  border-radius: 0.8em;
  -moz-border-radius: 0.8em;
  -webkit-border-radius: 0.8em;
  color: #ffffff;
  display: inline-block;
  font-weight: bold;
  line-height: 1.6em;
  margin-right: 5px;
  text-align: center;
  width: 1.6em; 
}
</pre>

<p>
Just change the font size to enlarge/shrink the button. Or width, line-height and the border-radius to only affect the circle (border-radius = half of the width and line-height values)
</p>
</div>
</div>

<div id="outline-container-orgbf1d1a8" class="outline-4">
<h4 id="orgbf1d1a8"><span class="section-number-4">5.31.14</span> superscript, subscript uneven line height</h4>
<div class="outline-text-4" id="text-5-31-14">
<pre class="example">
&lt;p&gt;Some Text &lt;sup&gt;OM&lt;/sup&gt;Office Mark

p {
  line-height:1.5em; /* if line-height:0 doesn't work, try increase p line-height or lower sup font-size*/
}
sup {
  /* font-size:0.5em; */
  line-height:0;
}
</pre>
</div>
</div>

<div id="outline-container-org3859872" class="outline-4">
<h4 id="org3859872"><span class="section-number-4">5.31.15</span> Swap image in @media</h4>
<div class="outline-text-4" id="text-5-31-15">
<p>
css
</p>
<pre class="example">
.flex-r-w-fs-center-mq-r-w-sa-center {
  display:flex;
  flex-flow:row wrap;
  justify-content:flex-start;
  align-items:center;
}

.footer-logos &gt; div {
  margin:15px 10px;
  background-color:red;
}
.footer-logos &gt; div &gt; div &gt; img{
  display:block;
  margin:0 auto;
}

@media only screen and (max-width: 697px) {
  .footer-logos.flex-r-w-fs-center-mq-r-w-sa-center {
    justify-content:space-around;
  }
}

@media only screen and (max-width: 320px) {
  .footer-logos &gt; div {
    width:100%;
    margin-top:2em;
  }

  .footer-logos .cs-i-1 {
    background:transparent url('http://placehold.it/137x42/?text=137x42') center center no-repeat;
    height:42px;
  }
  .footer-logos .cs-i-2 {
    background:transparent url('http://placehold.it/137x49/?text=137x49') center center no-repeat;
    height:49px;
  }
  .footer-logos .cs-i-3 {
    background:transparent url('http://placehold.it/137x64/?text=137x64') center center no-repeat;
    height:64px;
  }
  .footer-logos .cs-i-4 {
    background:transparent url('http://placehold.it/137x37/?text=137x37') center center no-repeat;
    height:37px;
  }
  .footer-logos .cs-items {
    margin:0.5em auto;
    width:137px;
  }
  .footer-logos .cs-items img {
    visibility:hidden;
  }

}
</pre>

<pre class="example">
&lt;div class="footer-logos flex-r-w-fs-center-mq-r-w-sa-center"&gt;
  &lt;div&gt;
    &lt;div class="cs-items cs-i-1"&gt;
      &lt;img src="http://placehold.it/81x25/?text=81x25" alt="#1 Logo"/&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div&gt;
    &lt;div class="cs-items cs-i-2"&gt;
      &lt;img src="http://placehold.it/92x25/?text=92x25" alt="#2 Logo"/&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div&gt;
    &lt;div class="cs-items cs-i-3"&gt;
      &lt;img src="http://placehold.it/54x25/?text=86x25" alt="#3 Hydro"/&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div&gt;
    &lt;div class="cs-items cs-i-4"&gt;
      &lt;img src="http://placehold.it/70x25/?text=70x25" alt="#4 Logo"/&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-orgc5a679e" class="outline-4">
<h4 id="orgc5a679e"><span class="section-number-4">5.31.16</span> Hightlight element when the hash and id of element match</h4>
<div class="outline-text-4" id="text-5-31-16">
<pre class="example">
:target {
  animation: contenthighlight 1s ease;
}
@keyframes contenthighlight {
  0% { border-left-color: red; }
  100% { border-left-color: white; }
}
</pre>
</div>
</div>

<div id="outline-container-orgf6ebfd0" class="outline-4">
<h4 id="orgf6ebfd0"><span class="section-number-4">5.31.17</span> Go to anchor element with position:fixed header</h4>
<div class="outline-text-4" id="text-5-31-17">
<pre class="example">
:target:before {
content:"";
display:block;
height:90px; /* fixed header height*/
margin:-90px 0 0; /* negative fixed header height */
}
</pre>
</div>
</div>

<div id="outline-container-org265d37d" class="outline-4">
<h4 id="org265d37d"><span class="section-number-4">5.31.18</span> Center position:absolute</h4>
<div class="outline-text-4" id="text-5-31-18">
<p>
Don't have to know the child's exact width
</p>
<pre class="example">
.parent {
  position:relative;
}

/* center both horizontally and vertically
.child {
  position: absolute;
  top: 50%;  /* position the top  edge of the element at the middle of the parent */
  left: 50%; /* position the left edge of the element at the middle of the parent */

  transform: translate(-50%, -50%); /* This is a shorthand of
                                       translateX(-50%) and translateY(-50%) */
}

/* center only horizontally */
.child {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orga1f25f0" class="outline-2">
<h2 id="orga1f25f0"><span class="section-number-2">6</span> Bootstrap</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org8a5481b" class="outline-3">
<h3 id="org8a5481b"><span class="section-number-3">6.1</span> Mobile Meta Setup</h3>
<div class="outline-text-3" id="text-6-1">
<p>
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
&lt;meta charset="UTF-8"&gt;
<i>/ Put this as close to the &lt;head&gt; as possible
/</i> To use the latest IE, chrome=1 is optional
&lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"&gt;
// shrink-to-fit is for Safari
&lt;meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"&gt;
// Bootstrap css and js files are about 170kb
&lt;link rel="stylesheet" href="<a href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css</a>" 
  integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" 
  crossorigin="anonymous"&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;!&#x2013; HTML Code &#x2013;&gt;
&lt;script
  src="<a href="https://code.jquery.com/jquery-1.12.4.min.js">https://code.jquery.com/jquery-1.12.4.min.js</a>"
  integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="
  crossorigin="anonymous"&gt;&lt;/script&gt;
&lt;script src="<a href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js">https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js</a>" 
  integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" 
  crossorigin="anonymous"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</p>
</div>
</div>

<div id="outline-container-org54ec155" class="outline-3">
<h3 id="org54ec155"><span class="section-number-3">6.2</span> Global</h3>
<div class="outline-text-3" id="text-6-2">
<ul class="org-ul">
<li>box-sizing is border-box including *:before and *:after</li>
<li>font-size 16px is declared on &lt;html&gt; and font-size:1rem on &lt;body&gt;</li>
<li>BS3 default font-size is 14px</li>
<li>&lt;body&gt; also sets global font-family and line-height</li>
<li>&lt;body&gt; has background-color #fff</li>
<li>bootstrap.js requries jQuery</li>
<li>By default, flexbox is not enabled</li>
<li>If flexbox is enabled:
<ul class="org-ul">
<li>entire grid system switches from float to flex</li>
<li>input groups move from table to flex</li>
<li>media components move from table to flex</li>
<li>After flex is enabled, you might have problems with IE9 and IE10</li>
</ul></li>
</ul>

<p>
<a href="https://v4-alpha.getbootstrap.com/migration/">BS4 vs BS3</a>
</p>

<p>
<a href="http://www.bootply.com">Hands on different versions of Bootstrap</a>
</p>
</div>
</div>

<div id="outline-container-orgb5a4fca" class="outline-3">
<h3 id="orgb5a4fca"><span class="section-number-3">6.3</span> Content</h3>
<div class="outline-text-3" id="text-6-3">
</div>
<div id="outline-container-org16aac45" class="outline-4">
<h4 id="org16aac45"><span class="section-number-4">6.3.1</span> Native font stack</h4>
<div class="outline-text-4" id="text-6-3-1">
<p>
Switched from Helvetica Neue, Helvetica and Arial to:
</p>
<ul class="org-ul">
<li>-apply-system (Safari for OS X and iOS)</li>
<li>BlinkMacSystemFont (Chrome for OS X)</li>
<li>Segoe UI (Windows)</li>
<li>Robot (Android)</li>
<li>Helvetica Neue, Arial, sans-serif !default;</li>
</ul>
</div>
</div>

<div id="outline-container-orgf894d9e" class="outline-4">
<h4 id="orgf894d9e"><span class="section-number-4">6.3.2</span> h1, h2 heading elements</h4>
<div class="outline-text-4" id="text-6-3-2">
<dl class="org-dl">
<dt>heading elements</dt><dd>margin-bottom: .5rem, no margin-top</dd>
<dt>.h1 .h2</dt><dd>to imitate heading display without margins</dd>
<dt>(no term)</dt><dd>Add .display-1, &#x2026;, .display-4 to change the size and display for &lt;h1&gt;, &lt;h2&gt;, etc.</dd>
<dt>(no term)</dt><dd>Add &lt;small class="text-muted"&gt;secondary heading text&lt;/small&gt; to &lt;h1&gt;
<ul class="org-ul">
<li>inline with text in &lt;h1&gt;, light color</li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-org0b9a1cf" class="outline-4">
<h4 id="org0b9a1cf"><span class="section-number-4">6.3.3</span> &lt;p&gt;</h4>
<div class="outline-text-4" id="text-6-3-3">
<ul class="org-ul">
<li>margin-bottom: 1rem, no margin-top</li>
<li>Add .lead to &lt;p&gt; to make it more standout.</li>
</ul>
</div>
</div>

<div id="outline-container-org5d7d2d8" class="outline-4">
<h4 id="org5d7d2d8"><span class="section-number-4">6.3.4</span> Lists &lt;ul&gt; &lt;ol&gt; &lt;dl&gt;</h4>
<div class="outline-text-4" id="text-6-3-4">
<ul class="org-ul">
<li>margin-bottom: 1rem, no margin-top</li>
<li>Except nested lists</li>
<li>add .list-unstyled to &lt;ul&gt;, &lt;ol&gt;. Only only apply for Level-1 children &lt;li&gt;</li>
<li>add .list-inline to &lt;ul, &lt;ol&gt; and .list-inline-item to li</li>
<li>add .dl-horizontal to &lt;dl&gt;</li>
</ul>
</div>
</div>

<div id="outline-container-org3700fb8" class="outline-4">
<h4 id="org3700fb8"><span class="section-number-4">6.3.5</span> Horinzontal Center (text, truncate, block)</h4>
<div class="outline-text-4" id="text-6-3-5">
<ul class="org-ul">
<li>Add .text-center in column</li>
<li>Add .center-block in column (margin:0 auto)</li>
<li>Add .text-truncate in column can truncate text and provides ellipsis</li>
</ul>
</div>
</div>

<div id="outline-container-org5425a0e" class="outline-4">
<h4 id="org5425a0e"><span class="section-number-4">6.3.6</span> Special Text</h4>
<div class="outline-text-4" id="text-6-3-6">
<dl class="org-dl">
<dt>&lt;kbd&gt; User input</dt><dd>&lt;kbd&gt;cd&lt;/kbd&gt;, &lt;kbd&gt;&lt;kbd&gt;ctrl&lt;/kbd&gt; + &lt;kbd&gt;,&lt;/kbd&gt;&lt;/kbd&gt;</dd>
<dt>(no term)</dt><dd>&lt;pre&gt; has margin-top removed and add margin-bottom: 1rem;</dd>
<dt>(no term)</dt><dd>add .pre-scrollable to &lt;pre&gt; to set a max-height and make it horizontally scrollable</dd>
<dt>&lt;code&gt;&amp;lt;em&amp;gt;&lt;/code&gt;</dt><dd>red text</dd>
<dt>(no term)</dt><dd>&lt;samp&gt;&amp;lt;em&amp;gt;&lt;/samp&gt;</dd>
<dt>(no term)</dt><dd>add .small to imitate &lt;small&gt; (normally it's 85% of parent font-size)</dd>
<dt>(no term)</dt><dd>&lt;mark&gt; light yellow</dd>
<dt>(no term)</dt><dd>&lt;s&gt;, &lt;del&gt; strike</dd>
<dt>(no term)</dt><dd>&lt;ins&gt; same as &lt;u&gt; underline</dd>
<dt>(no term)</dt><dd>&lt;em&gt;, &lt;i&gt; and &lt;var&gt; look the same</dd>
<dt>(no term)</dt><dd>add .initialism to cap and make font size 90% &lt;abbr title="full term"&gt;HTML&lt;/abbr&gt;</dd>
<dt>(no term)</dt><dd>add .blockquote-reverse to &lt;blockquote&gt;&lt;p&gt;&#x2026;&lt;/p&gt;&lt;footer&gt;&#x2026;&lt;/footer&gt;&lt;/blockquote&gt;</dd>
</dl>
</div>
</div>

<div id="outline-container-orgf4a49cc" class="outline-4">
<h4 id="orgf4a49cc"><span class="section-number-4">6.3.7</span> Vertical Align</h4>
<div class="outline-text-4" id="text-6-3-7">
<ul class="org-ul">
<li>Only applies to inline, inline-block, inline-table and table cell</li>
<li>.align-baseline, .align-top, .align-middle, .align-bottom</li>
<li>.align-text-bottom, .align-text-top</li>
</ul>
</div>
</div>

<div id="outline-container-orge5e8490" class="outline-4">
<h4 id="orge5e8490"><span class="section-number-4">6.3.8</span> Table</h4>
<div class="outline-text-4" id="text-6-3-8">
<ul class="org-ul">
<li>Add class="table" to &lt;table&gt;
<ul class="org-ul">
<li>add .table-inverse (dark) to inverse color</li>
<li>add .table-striped to add color to even or odd row within &lt;tbody&gt;</li>
<li>add .table-bordered</li>
<li>add .table-hover</li>
<li>add .table-sm (or .table-condensed) to remove cell padding</li>
<li>add .table-reflow to transpose</li>
</ul></li>
<li>Add scope="row" to the first td (or th) in each &lt;tr&gt; inside &lt;tbody&gt;</li>
<li>Add class="thead-inverse" or thead-default in &lt;thead&gt; to make table header dark or light</li>
<li>Add colors to rows or individual cells. If table-inverse, use bg-* or text-*
<dl class="org-dl">
<dt>.table-active (.active)</dt><dd>light grey</dd>
<dt>.table-success (.success)</dt><dd>light green</dd>
<dt>.table-info (.info)</dt><dd>light blue</dd>
<dt>.table-warning (.warning)</dt><dd>light yellow</dd>
<dt>.table-danger (.danger)</dt><dd>light red</dd>
</dl></li>
<li>Wrap table.table inside div.table-responsive to make table horizontal scrollable on small devices (under 768px)</li>
</ul>
</div>
</div>

<div id="outline-container-orgf8129bd" class="outline-4">
<h4 id="orgf8129bd"><span class="section-number-4">6.3.9</span> Image</h4>
<div class="outline-text-4" id="text-6-3-9">
<p>
.img-responsive BS3 .img-fluid BS4
</p>

<pre class="example">
&lt;!-- block, max-width: 100%; height: auto; --&gt;
&lt;img src="" class="img-responsive"&gt;

&lt;!-- add .center-block to &lt;img&gt; to center .img-responsive --&gt;

&lt;!-- Or center an image as inline --&gt;
&lt;img src="" class="img-responsive img-circle" style="display:inline"&gt;
</pre>

<p>
max-width and max-height
</p>

<p>
&lt;div class="img-container" style="width:300px;height:168px;"&gt;
  &lt;img src="&#x2026;"&gt;
&lt;/div&gt;
.img-container img {
  max-width: 100%;
  max-height: 100%;
}
</p>

<p>
Image shapes :: img-circle, img-rounded, img-thumbnail
</p>
</div>
</div>

<div id="outline-container-orgbd1bdb1" class="outline-4">
<h4 id="orgbd1bdb1"><span class="section-number-4">6.3.10</span> Colors</h4>
<div class="outline-text-4" id="text-6-3-10">
<p>
text-muted, text-primary, -success, -info, -warning, -danger
             btn-primary, -success, -info, -warning, -danger
              bg-primary, -success, -info, -warning, -danger
</p>
</div>
</div>

<div id="outline-container-org9fe2e88" class="outline-4">
<h4 id="org9fe2e88"><span class="section-number-4">6.3.11</span> Quick float content .pull-left, .pull-right</h4>
<div class="outline-text-4" id="text-6-3-11">
<p>
Not to be used in .navbar. Use .navbar-left or .navbar-right instead.
</p>
</div>
</div>
</div>

<div id="outline-container-orgc4ab822" class="outline-3">
<h3 id="orgc4ab822"><span class="section-number-3">6.4</span> Layout</h3>
<div class="outline-text-3" id="text-6-4">
</div>
<div id="outline-container-orgb15b62b" class="outline-4">
<h4 id="orgb15b62b"><span class="section-number-4">6.4.1</span> Grid</h4>
<div class="outline-text-4" id="text-6-4-1">
<pre class="example">
&lt;div class="container"&gt;
  &lt;div class="row"&gt;
    &lt;div class="col-*-*"&gt;&lt;/div&gt;
  &lt;/div&gt;
  &lt;div class="row"&gt;
    &lt;div class="col-*-*"&gt;&lt;/div&gt;
    &lt;div class="col-*-*"&gt;&lt;/div&gt;
    &lt;div class="col-*-*"&gt;&lt;/div&gt;
  &lt;/div&gt;
  &lt;div class="row"&gt;
    ...
  &lt;/div&gt;
&lt;/div&gt;
</pre>

<p>
For all sizes, 15px on each side of a column
.container has a fixed max-width based on different viewports.
.container-fluid takes 100% of the viewport width and the same as .container
.row is a horizontal group of columns. Only columns can be immediate children of rows.
</p>

<p>
15px on each side of a column
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">BS4</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&lt;576px</td>
<td class="org-left">&gt;=576px</td>
<td class="org-left">&gt;=768px</td>
<td class="org-left">&gt;=992px</td>
<td class="org-left">&gt;=1200px</td>
</tr>

<tr>
<td class="org-left">Class</td>
<td class="org-left">.col-</td>
<td class="org-left">.col-sm-</td>
<td class="org-left">.col-md-</td>
<td class="org-left">.col-lg-</td>
<td class="org-left">.col-xg-</td>
</tr>

<tr>
<td class="org-left">container</td>
<td class="org-left">none/auto</td>
<td class="org-left">540px</td>
<td class="org-left">720px</td>
<td class="org-left">960px</td>
<td class="org-left">1140px</td>
</tr>

<tr>
<td class="org-left">max width</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">BS3</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&lt;768px</td>
<td class="org-left">&gt;=768px</td>
<td class="org-left">&gt;=992px</td>
<td class="org-left">&gt;=1200px</td>
</tr>

<tr>
<td class="org-left">Class</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">.col-xs-</td>
<td class="org-left">.col-sm-</td>
<td class="org-left">.col-md-</td>
<td class="org-left">.col-lg-</td>
</tr>

<tr>
<td class="org-left">container</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">none/auto</td>
<td class="org-left">750px</td>
<td class="org-left">970px</td>
<td class="org-left">1170px</td>
</tr>

<tr>
<td class="org-left">max width</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
@media (min-width: 576px) {} =&gt; &gt;=576
@media (max-width: 576px) {} =&gt; &lt;=576
</p>

<p>
col-lg-9 :: non large size will have 100% width
col-md-7 col-lg-9 :: small size and extra small will have 100% width
col-xs-9 col-md-7 :: large size will have 7 columns, small size will have 9 columns
</p>

<p>
728px :: requires (BS4) md-12, lg-9, xg-8; (BS3) sm-12, md-9, lg-8
300px :: requries (BS4) md-5, lg-4, xg-3; (BS3) sm-5, md-4, lg-3
</p>

<p>
When column has 100% width, margin-bottom is 25px
</p>

<p>
div.clearfix.visible-*-(block, inline-block) to prevent strange wrapping with uneven height content at certain viewport size
</p>

<p>
Offset Columns
col-md-offset-* :: increase the left margin of a column by n columns
Offset can be used to horizontally center a column
div.col-xs-offset-3.col-xs-6 :: to the left 3 columns, width 6 columns, to the right 3 columns
.col-xs-offset-3 carries forward to bigger size. In order to remove offset for larger sizes, add .col-sm-offset-0
</p>

<p>
Change Column Ordering
col-sm-push-<b>, col-sm-pull-</b> :: col-sm-push-8, col-sm-pull-4. Only at sm the columns are pushed/pulled.
This only works when elements can be floated in one row. When they are stacked, this trick doesn't work.
</p>
</div>
</div>

<div id="outline-container-org64f24e4" class="outline-4">
<h4 id="org64f24e4"><span class="section-number-4">6.4.2</span> Responsive Utility</h4>
<div class="outline-text-4" id="text-6-4-2">
<p>
<a id="org4ec7994">bs:responsive utility</a>
</p>
<dl class="org-dl">
<dt>.hidden-*-down</dt><dd>e.g. .hidden-md-down hides an element on xs, sm and md viewports</dd>
<dt>.hidden-*-up</dt><dd>.hidden-md-up hides an element on md, lg and xg viewports</dd>
<dt>(no term)</dt><dd>combine .hidden-<b>-down and .hidden-</b>-up to only show element for a specific viewport size</dd>
<dt>.hidden-*</dt><dd>* is xs, sm, lg, xl</dd>
<dt>.hidden-print</dt><dd>hide element for print device</dd>
<dt>.visible-print-block</dt><dd>only visible in print as display: block</dd>
<dt>.visible-print-inline</dt><dd>only visible in print as display: inline</dd>
<dt>.visible-print-inline-block</dt><dd>only visible in print as display: inline-block</dd>
<dt>(no term)</dt><dd>.visible-*-block, -inline, -inline-block where * is xs, sm, lg, xl</dd>
</dl>
</div>
</div>

<div id="outline-container-org7bee775" class="outline-4">
<h4 id="org7bee775"><span class="section-number-4">6.4.3</span> Media Object</h4>
<div class="outline-text-4" id="text-6-4-3">
<p>
Align media (image, video, audio) to the left or right of a content block
</p>

<pre class="example">
&lt;div class="media"&gt;
  &lt;!-- .media-middle, .media-bottom, default is top --&gt;
  &lt;!-- .media-left, .media-right --&gt;
  &lt;a class="media-left" href="#"&gt;
    &lt;img class="media-object" src="..." alt="..."&gt;
  &lt;/a&gt;
  &lt;div class="media-body"&gt;
    &lt;h4 class="media-heading"&gt;Media Heading&lt;/h4&gt;
    Some Description...
    &lt;!-- Nest another media object --&gt;
  &lt;/div&gt;
&lt;/div&gt;
</pre>

<p>
Put multiple li.media inside ul.media-list. Good for layout comments
</p>
</div>
</div>
</div>

<div id="outline-container-org88ece7d" class="outline-3">
<h3 id="org88ece7d"><span class="section-number-3">6.5</span> Utilities</h3>
<div class="outline-text-3" id="text-6-5">
</div>
<div id="outline-container-org95bcd9b" class="outline-4">
<h4 id="org95bcd9b"><span class="section-number-4">6.5.1</span> Spacing Utility (Boostrap 4)</h4>
<div class="outline-text-4" id="text-6-5-1">
<dl class="org-dl">
<dt>m</dt><dd>margin</dd>
<dt>p</dt><dd>padding</dd>
<dt>t, b, l, r</dt><dd>top, bottom, left, right</dd>
<dt>x</dt><dd>*-left and *-right</dd>
<dt>y</dt><dd>*-top and *-bottom</dd>
<dt>a</dt><dd>all 4 sides</dd>
<dt>mt-0</dt><dd>margin top 0</dd>
<dt>mx-auto</dt><dd>same as .center-block</dd>
</dl>

<p>
In Bootstrap 3, use .form-group to create margin-bottom: 15px
</p>
</div>
</div>

<div id="outline-container-org355a64a" class="outline-4">
<h4 id="org355a64a"><span class="section-number-4">6.5.2</span> Responsive Utility</h4>
<div class="outline-text-4" id="text-6-5-2">
<p>
<a href="#org4ec7994">bs:responsive utility</a>
</p>
</div>
</div>

<div id="outline-container-org1d93231" class="outline-4">
<h4 id="org1d93231"><span class="section-number-4">6.5.3</span> Responsive helpers (embed and float) <a id="org3065488">bootstrap:responsive helpers</a></h4>
<div class="outline-text-4" id="text-6-5-3">
<p>
Apply to &lt;iframe&gt;, &lt;embed&gt;, &lt;video&gt; and &lt;object&gt; to maintain media size ratio
</p>

<pre class="example">
&lt;div class="embed-responsive embed-responsive-16by9"&gt;
  &lt;iframe class="embed-responsive-item" src="//www.youtube.com/embed/zpOULjyy-n8?rel=0" allowfullscreen&gt;&lt;/iframe&gt;
&lt;/div&gt;
</pre>

<p>
BS3 4by3 and 16by9. BS4 added 21by9 and 1by1
</p>

<p>
Control floats based on viewport size breakpoint
float-xs-left, float-xs-right, float-xs-none
</p>

<p>
Raw CSS
</p>
<pre class="example">
&lt;div class="videoWrapper-16-9"&gt;
  &lt;!-- Copy &amp; Pasted from YouTube --&gt;
  &lt;iframe width="560" height="349" src="http://www.youtube.com/embed/n_dZNLr2cME?rel=0&amp;hd=1" style="border:0" allowfullscreen&gt;&lt;/iframe&gt;
&lt;/div&gt;

.videoWrapper-16-9 {
  position: relative;
  padding-bottom: 56.25%; /* 16:9 */
  padding-top: 25px;
  height: 0;
}
.videoWrapper-16-9 iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}
</pre>
</div>
</div>

<div id="outline-container-org0320764" class="outline-4">
<h4 id="org0320764"><span class="section-number-4">6.5.4</span> Border (BS4)</h4>
<div class="outline-text-4" id="text-6-5-4">
<ul class="org-ul">
<li>.rounded</li>
<li>.rounded-circle</li>
<li>.rounded-top, right, left, bottom</li>
</ul>
</div>
</div>

<div id="outline-container-orgbf2721f" class="outline-4">
<h4 id="orgbf2721f"><span class="section-number-4">6.5.5</span> Text</h4>
<div class="outline-text-4" id="text-6-5-5">
<p>
<a id="orge6aa9a0">bs:text align</a>
</p>
<dl class="org-dl">
<dt>BS4</dt><dd>.text-<b>-left, .text-</b>-right, .text-*-center, * is xs, sm, md, lg, xl</dd>
<dt>BS3</dt><dd>.text-justify, .text-left, right, center</dd>
</dl>

<p>
Text nowrap :: .text-nowrap
</p>

<p>
Text color
</p>
<ul class="org-ul">
<li>.text-muted</li>
<li>.text-primary, -success, -info, &#x2026;</li>
</ul>

<p>
Font weight
</p>
<ul class="org-ul">
<li>.font-weight-bold, .font-weight-normal</li>
<li>.font-italic</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org2f2c463" class="outline-3">
<h3 id="org2f2c463"><span class="section-number-3">6.6</span> Components</h3>
<div class="outline-text-3" id="text-6-6">
</div>
<div id="outline-container-org1a9ad38" class="outline-4">
<h4 id="org1a9ad38"><span class="section-number-4">6.6.1</span> Alert</h4>
<div class="outline-text-4" id="text-6-6-1">
<p>
Wrap text in div with .alert and one of the alert color class
</p>
<ul class="org-ul">
<li>alert-success</li>
<li>alert-info</li>
<li>alert-warning</li>
<li>alert-danger</li>
</ul>

<p>
100% width block with inner and outter spacing
</p>

<p>
Non-dismissible
</p>
<pre class="example">
&lt;div class="alert alert-danger" role="alert"&gt;
  Some text with
  &lt;a href="#" class="alert-link"&gt; a link &lt;/a&gt; 
  some other text
&lt;/div&gt;
</pre>

<p>
Dismissable
</p>
<pre class="example">
&lt;div class="alert alert-warning alert-dismissible" role="alert"&gt;
  &lt;button type="button" class="close" data-dismiss="alert" aria-label="Close"&gt;
    &lt;span aria-hidden="true"&gt;&amp;times;&lt;/span&gt;
  &lt;/button&gt;
  &lt;strong&gt;Warning!&lt;/strong&gt; Better check yourself, you're not looking too good.
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org199937d" class="outline-4">
<h4 id="org199937d"><span class="section-number-4">6.6.2</span> Jumbotron</h4>
<div class="outline-text-4" id="text-6-6-2">
<p>
.page-header :: Extra space on top and some on bottom
</p>
<pre class="example">
&lt;div class="page-header"&gt;
  &lt;h1&gt;Example page header &lt;small&gt;Subtext for header&lt;/small&gt;&lt;/h1&gt;
&lt;/div&gt;
</pre>

<p>
Jumbotron :: 100% width
BS4 uses h.display-3, p.lead
</p>
<pre class="example">
&lt;div class="jumbotron"&gt;
  &lt;h1 class="display-3"&gt;Hello, world!&lt;/h1&gt;
  &lt;p class="lead"&gt;Text.&lt;/p&gt;
  &lt;hr class="my-2"&gt;
  &lt;p&gt;Another paragraph.&lt;/p&gt;
  &lt;p class="lead"&gt;
    &lt;a class="btn btn-primary btn-lg" href="#" role="button"&gt;Learn more&lt;/a&gt;
  &lt;/p&gt;
&lt;/div&gt;
</pre>
</div>
</div>
<div id="outline-container-orgf220d68" class="outline-4">
<h4 id="orgf220d68"><span class="section-number-4">6.6.3</span> Tag (BS4) Label (BS3)</h4>
<div class="outline-text-4" id="text-6-6-3">
<p>
<a id="orgea84a2a">bs:tag</a>
Used in &lt;button&gt;, &lt;h1&gt; as inline element and in <a href="#orge9f0d6b">bs:list group</a> 
&lt;span class="tag tag-default"&gt;New&lt;/span&gt;
&lt;span class="label label-info"&gt;New&lt;/span&gt;
</p>

<p>
tag-pill or badge in BS3 can collapse when there's no content
&lt;span class="tag tag-pill tag-default"&gt;Default&lt;/span&gt;
</p>

<p>
<a id="org2308bb5">bs:Center Tags</a> Vertically center span inside h1
h1,h2,h3 {
  vertical-align:middle;
}
</p>

<p>
h1&gt;.tag, h2&gt;.tag, h3&gt;.tag {
  vertical-aign:middle;
  margin-top:-0.5em;
  font-size: 50%; <i>* default is 75%. Make the tag smaller *</i>
}
</p>
</div>
</div>

<div id="outline-container-org4651eee" class="outline-4">
<h4 id="org4651eee"><span class="section-number-4">6.6.4</span> Progress</h4>
<div class="outline-text-4" id="text-6-6-4">
<p>
Contextual classes :: progress-success, etc.
.progress-striped
</p>

<p>
BS4
</p>
<pre class="example">
&lt;div class="text-xs-center" id="example-caption-4"&gt;Some Text appears on top progress bar&lt;/div&gt;
&lt;progress class="progress" value="75" max="100" aria-describedby="example-caption-4"&gt;&lt;/progress&gt;
</pre>

<p>
BS3 is more reliable..
</p>

<p>
Contextual classes :: progress-bar-success, etc.
.progress-bar-striped
Add .active to .progress-bar-striped to animate the stripes right to left
</p>

<pre class="example">
&lt;div class="progress"&gt;
  &lt;div class="progress-bar"
       role="progressbar"
       aria-valuenow="0"
       aria-valuemin="0"
       aria-valuemax="100"
       style="min-width: 2em;"&gt;
    0%
  &lt;/div&gt;
&lt;/div&gt;
&lt;div class="progress"&gt;
  &lt;div class="progress-bar"
       role="progressbar"
       aria-valuenow="2"
       aria-valuemin="0"
       aria-valuemax="100"
       style="min-width: 2em; width: 2%;"&gt;
    2%
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Align multiple .progress-bar's on one line in ratio --&gt;
&lt;div class="progress"&gt;
  &lt;div class="progress-bar progress-bar-success" style="width: 35%"&gt;
    &lt;span class="sr-only"&gt;35% Complete (success)&lt;/span&gt;
  &lt;/div&gt;
  &lt;div class="progress-bar progress-bar-warning progress-bar-striped" style="width: 20%"&gt;
    &lt;span class="sr-only"&gt;20% Complete (warning)&lt;/span&gt;
  &lt;/div&gt;
  &lt;div class="progress-bar progress-bar-danger" style="width: 10%"&gt;
    &lt;span class="sr-only"&gt;10% Complete (danger)&lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org57bdae9" class="outline-4">
<h4 id="org57bdae9"><span class="section-number-4">6.6.5</span> Button, Button Group <a id="org9428f13">bs:button</a></h4>
<div class="outline-text-4" id="text-6-6-5">
<p>
Used in <a href="#orgddd969a">bs:nav</a> <a href="#org82a77db">bs:navbar</a>
Add .btn.btn-default to &lt;a&gt;, &lt;button&gt; and &lt;input&gt;
Only button.btn can be used as button in nav
</p>

<p>
btn-default, btn-primary, btn-success, info, warning, danger
</p>

<p>
btn-lg, btn-sm, btn-xs
</p>

<p>
btn-block :: full width of parent
</p>

<p>
Add .active to .btn to show the button is pressed
</p>

<p>
Button with icon
</p>
<pre class="example">
&lt;a href="#" class="btn btn-default btn-lg"&gt;
 &lt;span class="glyphicon glyphicon-search"&gt;&lt;/span&gt; Button Large
&lt;/a&gt;
</pre>

<p>
<a id="org16b8fd5">bs:btn-group</a>
Use role="group" for .btn-group and .btn-group-vertical
div.btn-group to align &lt;button&gt;s horizontally without padding nor margin
div.btn-group-vertical to align &lt;button&gt;s vertically without padding nor margin
</p>

<p>
Use role="toolbar" for .btn-toolbar
When there're multiple div.btn-group or div.btn-group-vertical, use div.btn-toolbar to wrap them.
</p>

<p>
To group a <a href="#orgee93b8d">bs:dropdown</a> with &lt;button&gt;s, use div.btn-group to wrap the dropdown all together.
</p>
</div>
</div>

<div id="outline-container-org89397af" class="outline-4">
<h4 id="org89397af"><span class="section-number-4">6.6.6</span> Form</h4>
<div class="outline-text-4" id="text-6-6-6">
<p>
<a id="orgdcc993f">bs:form</a>
</p>
<dl class="org-dl">
<dt>.sr-only</dt><dd>add to &lt;label&gt; to hide it</dd>
<dt>.form-group</dt><dd>add to &lt;div&gt; which wraps each form field to add margin-bottom
<dl class="org-dl">
<dt>.form-group-lg, .form-group-sm</dt><dd>sizing</dd>
</dl></dd>
</dl>
</div>

<div id="outline-container-org7555957" class="outline-5">
<h5 id="org7555957"><span class="section-number-5">6.6.6.1</span> .form-control</h5>
<div class="outline-text-5" id="text-6-6-6-1">
<dl class="org-dl">
<dt>.form-control</dt><dd>add to &lt;input&gt;, &lt;select&gt;, &lt;textarea&gt; to make it width 100%</dd>
<dt>.form-control-file</dt><dd>add to &lt;input type=file&gt; for 100% width 
<dl class="org-dl">
<dt>input.form-control-lg, input.form-control-sm</dt><dd>sizing (BS4)</dd>
<dt>input.input-lg, input.input-sm</dt><dd>sizing (BS3)</dd>
</dl></dd>
</dl>
</div>
</div>

<div id="outline-container-orgfeb5a6c" class="outline-5">
<h5 id="orgfeb5a6c"><span class="section-number-5">6.6.6.2</span> Help Text (after &lt;input&gt;)</h5>
<div class="outline-text-5" id="text-6-6-6-2">
<dl class="org-dl">
<dt>.form-text (.help-block)</dt><dd>block-level help text. p.form-text or div.form-text</dd>
<dt>.text-muted</dt><dd>inline help text small.text-muted or span.text-muted</dd>
<dt>(no term)</dt><dd>aria-describedby attribute (may also refer to the feedback)</dd>
</dl>

<pre class="example">
&lt;div class="form-group"&gt;
  &lt;label for="inputPassword"&gt;Password&lt;/label&gt;
  &lt;input type="password" id="inputPassword" class="form-control" aria-describedby="passwordHelpInline"&gt;
  &lt;small id="passwordHelpInline" class="text-muted"&gt;
    Must be 8-20 characters long.
  &lt;/small&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org66a953a" class="outline-5">
<h5 id="org66a953a"><span class="section-number-5">6.6.6.3</span> .form-inline</h5>
<div class="outline-text-5" id="text-6-6-6-3">
<ul class="org-ul">
<li>By default, &lt;form&gt; doesn't have to have any class</li>
<li id=".form-inline">add to &lt;form&gt; and any form field to make it inline. Only works for md and above viewport sizes</li>
</ul>
</div>
</div>

<div id="outline-container-org3a394b6" class="outline-5">
<h5 id="org3a394b6"><span class="section-number-5">6.6.6.4</span> Checkbox and Radio</h5>
<div class="outline-text-5" id="text-6-6-6-4">
<ul class="org-ul">
<li>div.checkbox (.form-check BS4), div.radio (BS3 only)</li>
<li>label.checkbox-inline (.form-check-inline BS4), label.radio-inline (BS3 only)</li>
<li>label.form-check-label (BS4 only)</li>
<li>input.form-check-input (BS4 only)</li>
</ul>

<p>
&lt;div class="checkbox"&gt;
  &lt;label&gt;
    &lt;input id="a" type="checkbox"&gt;
    Only one checkbox
  &lt;/label&gt;
&lt;/div&gt;
</p>

<p>
&lt;div class="form-group"&gt;
 &lt;label class="checkbox-inline"&gt;
    &lt;input name="a" id="a1" type="checkbox"&gt;
    Checkbox #1
 &lt;/label&gt;
 &lt;label class="checkbox-inline"&gt;
    &lt;input name="a" id="a2" type="checkbox"&gt;
    Checkbox #2
  &lt;/label&gt;
&lt;/div&gt;
</p>
</div>
</div>

<div id="outline-container-org2a3b6dc" class="outline-5">
<h5 id="org2a3b6dc"><span class="section-number-5">6.6.6.5</span> .input-group <a id="orgda910f4">bs:form:input-group</a></h5>
<div class="outline-text-5" id="text-6-6-6-5">
<p>
Group multiple inputs of different types (or even text) in one line. Good for making very short form
</p>

<pre class="example">
&lt;div class="form-group"&gt;
  &lt;label class="sr-only" for="exampleInputAmount"&gt;Amount (in dollars)&lt;/label&gt;
  &lt;div class="input-group"&gt;
    &lt;div class="input-group-addon"&gt;
      &lt;input type="checkbox" checked&gt;
    &lt;/div&gt;
    &lt;input type="text" class="form-control" id="exampleInputAmount" placeholder="Amount"&gt;
    &lt;div class="input-group-addon"&gt;.00&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;div class="form-group"&gt;
  &lt;div class="input-group"&gt;
    &lt;input type="text" class="form-control" placeholder="Search terms"&gt;
    &lt;span class="input-group-btn"&gt;
      &lt;button class="btn btn-default" type="submit"&gt;Go!&lt;/button&gt;
    &lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-orgac2bd87" class="outline-5">
<h5 id="orgac2bd87"><span class="section-number-5">6.6.6.6</span> Align fields in columns</h5>
<div class="outline-text-5" id="text-6-6-6-6">
<p>
Add .col-<b>-</b> to &lt;label&gt; and container of form field. Also add .control-label to &lt;label&gt;
&lt;div class="form-group"&gt;
  &lt;label class="col-sm-2 control-label" for="inputComments"&gt;Comments&lt;/label&gt;
  &lt;div class="col-sm-10"&gt;
    &lt;textarea class="form-control" id="inputComments"&gt;&lt;/textarea&gt;
  &lt;/div&gt;
&lt;/div&gt;
</p>

<p>
Align Submit button
&lt;div class="form-group"&gt;
  &lt;div class="col-sm-10 col-sm-offset-2"&gt;
    &lt;input type="submit" class="btn btn-default" value="submit"&gt;
  &lt;/div&gt;
&lt;/div&gt;
</p>

<p>
Align checkbox/radio
&lt;div class="form-group"&gt;
 &lt;div class="col-sm-10 col-sm-offset-2"&gt;
   &lt;label class="checkbox-inline"&gt;
      &lt;input name="a" type="checkbox"&gt;
      Checkbox #2
   &lt;/label&gt;
 &lt;/div&gt;
&lt;/div&gt;
</p>
</div>
</div>

<div id="outline-container-org5777a15" class="outline-5">
<h5 id="org5777a15"><span class="section-number-5">6.6.6.7</span> Validation and Feedback</h5>
<div class="outline-text-5" id="text-6-6-6-7">
<p>
Add validation class to div.form-group to add color as a whole
</p>
<ul class="org-ul">
<li>.has-success</li>
<li>.has-warning</li>
<li>.has-error</li>
<li>.has-feedback</li>
</ul>

<p>
Validation feedback with icon and/or text (only input type=text)
</p>
<dl class="org-dl">
<dt>.has-feedback</dt><dd>add to div.form-group</dd>
<dt>.control-label</dt><dd>add to &lt;label&gt;</dd>
<dt>span.glyphicon.glyphicon-ok.form-control-feedback</dt><dd>icon inside field (BS3)</dd>
<dt>input.form-control-warning, -success, -danger</dt><dd>icon inside field (BS4)</dd>
<dt>div.form-control-feedback</dt><dd>feedback in text</dd>
</dl>

<pre class="example">
&lt;div class="form-group has-feedback"&gt;
  &lt;label class="control-label" for="inputName"&gt;Name&lt;/label&gt;
  &lt;input class="form-control" id="inputName" type="text" placeholder="Name"&gt;
  &lt;span class="glyphicon glyphicon-ok form-control-feedback"&gt;&lt;/span&gt;
&lt;/div&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd86f920" class="outline-4">
<h4 id="orgd86f920"><span class="section-number-4">6.6.7</span> Thumbnail (BS3)</h4>
<div class="outline-text-4" id="text-6-6-7">
<p>
div.thumbnail is a block with padding 4px and border 1px.
Place it inside a column for layout
</p>
</div>
</div>

<div id="outline-container-orgc843f8e" class="outline-4">
<h4 id="orgc843f8e"><span class="section-number-4">6.6.8</span> List group <a id="orge9f0d6b">bs:list group</a></h4>
<div class="outline-text-4" id="text-6-6-8">
<p>
Used in <a href="#org95e9e9b">bs:panel</a> <a href="#orge9f0d6b">bs:list group</a>
</p>

<ul class="org-ul">
<li>Parent and child can be any HTML elements.</li>
<li>&lt;ul&gt; &lt;li&gt; will not have hovering effect</li>
<li>Add contextual classes to li.list-group-item 
<ul class="org-ul">
<li>list-group-item-success, info, warning, danger</li>
</ul></li>
</ul>

<pre class="example">
&lt;div class="list-group"&gt;
  &lt;!-- may use .disabled, .active --&gt;
  &lt;li class="list-group-item disabled"&gt;
    &lt;!-- may use bs:tag --&gt;
    New Mails
    &lt;span class="tag tag-default tag-pill float-xs-right"&gt;14&lt;/span&gt;
  &lt;/li&gt;

  &lt;!-- BS4: link as a button, use &lt;div&gt; as parent --&gt;
  &lt;a class="list-group-item list-group-item-action"&gt;
    Dapibus ac facilisis in
  &lt;/a&gt;

  &lt;!-- BS3: link as a button, use &lt;div&gt; as parent --&gt;
  &lt;button type="button" class="list-group-item"&gt;
    Dapibus ac facilisis in
  &lt;/button&gt;

  &lt;!-- Custom Content BS3 --&gt;
  &lt;a href="#" class="list-group-item"&gt;
    &lt;h4 class="list-group-item-heading"&gt;Heading&lt;/h4&gt;
    &lt;p class="list-group-item-text"&gt;...&lt;/p&gt;
  &lt;/a&gt;

  &lt;!-- Custom Content BS4 --&gt;
  &lt;a href="#" class="list-group-item list-group-item-action"&gt;
    &lt;h4 class="list-group-item-heading"&gt;Heading&lt;/h4&gt;
    &lt;p class="list-group-item-text"&gt;...&lt;/p&gt;
  &lt;/a&gt;

&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-orgcfca95f" class="outline-4">
<h4 id="orgcfca95f"><span class="section-number-4">6.6.9</span> Panel (BS3 only) <a id="org95e9e9b">bs:panel</a></h4>
<div class="outline-text-4" id="text-6-6-9">
<p>
3 rows layout 100% width with padding
</p>

<p>
Contextual classes: panel-success, &#x2026;
</p>

<pre class="example">
&lt;div class="panel panel-default"&gt;

  &lt;div class="panel-heading"&gt;
    &lt;h2 class="panel-title"&gt;Title&lt;/h2&gt;
  &lt;/div&gt;

  &lt;div class="panel-body"&gt;
    &lt;p&gt;Panel Content&lt;/p&gt;
  &lt;/div&gt;

  &lt;!-- may add any HTML or BS components --&gt;

  &lt;div class="panel-footer"&gt;
    &lt;a href="#"&gt;Some Action&lt;/a&gt;
  &lt;/div&gt;

&lt;/div&gt;
</pre>

<p>
.panel-collapse
</p>
<ul class="org-ul">
<li>Expand and collapse a panel <a href="#orge0a64cd">bs:collapse</a></li>
<li>Place .panel-body inside .panel-collpse</li>
<li>.list-group can replace .panel-body inside .panel-collapse</li>
</ul>

<pre class="example">
&lt;!-- add role="tablist" and aria-multiselectable --&gt;
&lt;div class="panel-group"
     id="accordion"
     role="tablist"
     aria-multiselectable="true"&gt;

  &lt;div class="panel panel-default"&gt;
    &lt;!-- add role="tab" and id for each panel-heading --&gt;
    &lt;div class="panel-heading"
         role="tab"
         id="headingOne"&gt;
      &lt;h4 class="panel-title"&gt;
        &lt;!-- For each .panel-title
             - add regular bs:collapse action button with data-parent
        --&gt;

        &lt;!-- This panel opens initially --&gt;
        &lt;!-- no .collapsed in &lt;a&gt; means it expands initially --&gt;
        &lt;!-- aria-expanded="true" not false! --&gt;
        &lt;a role="button"
           data-toggle="collapse"
           data-parent="#accordion"
           href="#collapseOne"
           aria-expanded="true"
           aria-controls="collapseOne"&gt;
          Collapsible Group Item #1
        &lt;/a&gt;
      &lt;/h4&gt;
    &lt;/div&gt;

    &lt;!-- .collapse.in :: displays content initially --&gt;
    &lt;div id="collapseOne"
         class="panel-collapse collapse in"
         role="tabpanel"
         aria-labelledby="headingOne"&gt;
      &lt;div class="panel-body"&gt;
        ...
      &lt;/div&gt;
    &lt;/div&gt;

  &lt;/div&gt;

  &lt;div class="panel panel-default"&gt;
    &lt;div class="panel-heading" role="tab" id="headingTwo"&gt;
      &lt;h4 class="panel-title"&gt;
        &lt;!-- .collapsed :: collapse content initially --&gt;
        &lt;a class="collapsed"
           role="button"
           data-toggle="collapse"
           data-parent="#accordion"
           href="#collapseTwo"
           aria-expanded="false"
           aria-controls="collapseTwo"&gt;
          Collapsible Group Item #2
        &lt;/a&gt;
      &lt;/h4&gt;
    &lt;/div&gt;

    &lt;!-- .collapse :: hides content initially --&gt;
    &lt;div id="collapseTwo"
         class="panel-collapse collapse"
         role="tabpanel"
         aria-labelledby="headingTwo"&gt;
      &lt;div class="panel-body"&gt;
        ...
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org61871e6" class="outline-4">
<h4 id="org61871e6"><span class="section-number-4">6.6.10</span> Card, Card Group, Card Deck (BS4) <a id="org7a04404">bs:card</a></h4>
<div class="outline-text-4" id="text-6-6-10">
<p>
Panel is replaced by Card in BS4
</p>

<pre class="example">
&lt;!-- add .card-inverse to make text color white.
     contextual classes :: card-primary, info, etc.
     outline color :: card-outline-primary, info, etc.
--&gt;
&lt;div class="card"&gt;

  &lt;!-- .card-header in &lt;h*&gt; --&gt;
  &lt;h3 class="card-header"&gt;Featured&lt;/h3&gt;
  &lt;!--  header can have bs:nav, tabs or pills --&gt;
  &lt;!-- just add .card-header-tabs ---&gt;
  &lt;div class="card-header"&gt;
    &lt;ul class="nav nav-tabs card-header-tabs"&gt;
      ...
    &lt;/ul&gt;
  &lt;/div&gt;

  &lt;!-- .card-img without -top or -bottom centers the image inside .card --&gt;
  &lt;img class="card-img-top" src="..." alt="Card image cap"&gt;
  &lt;!-- Overlay content on image --&gt;
  &lt;div class="card-img-overlay"&gt;
    &lt;h4 class="card-title"&gt;Image title&lt;/h4&gt;
    &lt;p class="card-text"&gt;...&lt;/p&gt;
    &lt;p class="card-text"&gt;&lt;small class="text-muted"&gt;...&lt;/small&gt;&lt;/p&gt;
  &lt;/div&gt;

  &lt;!-- Wrap text with .card-block --&gt;
  &lt;div class="card-block"&gt;
    &lt;h4 class="card-title"&gt;Card title&lt;/h4&gt;
    &lt;p class="card-text"&gt;...&lt;/p&gt;
    &lt;!-- regular button --&gt;
    &lt;a href="#" class="btn btn-primary"&gt;Go&lt;/a&gt;
  &lt;/div&gt;

  &lt;div class="card-block"&gt;
    &lt;!-- .card-title and .card-subtitle in &lt;h*&gt; --&gt;
    &lt;h4 class="card-title"&gt;Card title&lt;/h4&gt;
    &lt;h6 class="card-subtitle text-muted"&gt;Support card subtitle&lt;/h6&gt;
  &lt;/div&gt;

  &lt;!-- bs:list group --&gt;
  &lt;ul class="list-group list-group-flush"&gt;
    &lt;li class="list-group-item"&gt;Cras justo odio&lt;/li&gt;
    &lt;li class="list-group-item"&gt;Dapibus ac facilisis in&lt;/li&gt;
    &lt;li class="list-group-item"&gt;Vestibulum at eros&lt;/li&gt;
  &lt;/ul&gt;

  &lt;div class="card-block"&gt;
    &lt;!-- .card-link --&gt;
    &lt;a href="#" class="card-link"&gt;Card link&lt;/a&gt;
    &lt;a href="#" class="card-link"&gt;Another link&lt;/a&gt;
  &lt;/div&gt;

  &lt;img class="card-img-bottom" src="..." alt="Card image cap"&gt;

  &lt;div class="card-footer"&gt;2 days ago&lt;/div&gt;
  &lt;!-- .card-header in &lt;h*&gt; --&gt;
  &lt;h3 class="card-footer"&gt;2 days ago&lt;/h3&gt;

&lt;/div&gt;
</pre>

<p>
Card Group
</p>
<ul class="org-ul">
<li>wrap all .card inside div.card-group</li>
<li>each .card will have equal height with no spacing like in a table</li>
</ul>

<p>
Card Deck
</p>
<ul class="org-ul">
<li>Like .card-group but with spacing</li>
<li>wrap all .card inside div.card-deck</li>
<li>if flex is not enabled, wrap div.card-deck with div.card-deck-wrapper</li>
</ul>

<p>
Card Columns
</p>
<ul class="org-ul">
<li>Masonry</li>
<li>Wrap all .card inside div.card-columns</li>
</ul>
</div>
</div>

<div id="outline-container-org2defce5" class="outline-4">
<h4 id="org2defce5"><span class="section-number-4">6.6.11</span> Dropdown (js)</h4>
<div class="outline-text-4" id="text-6-6-11">
<p>
<a id="orgee93b8d">bs:dropdown</a> For navigation purpose. 
Used in <a href="#orgddd969a">bs:nav</a> <a href="#org82a77db">bs:navbar</a> <a href="#org16b8fd5">bs:btn-group</a>
</p>

<pre class="example">
&lt;!-- .open :: dropdown state is always open --&gt;
&lt;div class="dropdown open"&gt;
  &lt;!-- .dropdown-toggle turn something into a dropdown toggle --&gt;
  &lt;!-- data-toggle :: attach js dropdown event --&gt;
  &lt;button
    type="button" id="dropdownMenuButton"
    class="btn btn-secondary dropdown-toggle"
    data-toggle="dropdown"
    aria-haspopup="true"
    aria-expanded="false"&gt;
    Dropdown button &lt;span class="caret"&gt;&lt;/span&gt;
    &lt;!-- BS4 does't have to define caret --&gt;
  &lt;/button&gt;

  &lt;!-- BS4 no longer requires menu items to be &lt;li&gt;&lt;a /&gt;&lt;/li&gt; but you have to use .dropdown-item --&gt;
  &lt;!-- &lt;ul&gt; &lt;li&gt; &lt;a&gt; are used in BS3 --&gt;
  &lt;div class="dropdown-menu" aria-labelledby="dropdownMenuButton"&gt;
    &lt;h6 class="dropdown-header"&gt;Combo A (not selectable)&lt;/h6&gt;
    &lt;a class="dropdown-item" href="#"&gt;1&lt;/a&gt;
    &lt;a class="dropdown-item" href="#"&gt;2&lt;/a&gt;
    &lt;a class="dropdown-item" href="#"&gt;3&lt;/a&gt;
    &lt;!-- BS3 use .divider --&gt;
    &lt;div role="separator" class="dropdown-divider"&gt;&lt;/div&gt;
    &lt;h6 class="dropdown-header"&gt;Combo B (not selectable)&lt;/h6&gt;
    &lt;a class="dropdown-item" href="#"&gt;4&lt;/a&gt;
    &lt;!-- disabled --&gt;
    &lt;a class="dropdown-item disabled" href="#"&gt;5 (Sold out!)&lt;/a&gt;
    &lt;a class="dropdown-item" href="#"&gt;6&lt;/a&gt;
  &lt;/div&gt;
&lt;/div&gt;
</pre>

<p>
To group a <a href="#orgee93b8d">bs:dropdown</a> with &lt;button&gt;s, use div.btn-group to wrap the dropdown all together.
</p>

<pre class="example">
&lt;div class="btn-group" role="group" aria-label="..."&gt;
  &lt;button type="button" class="btn btn-info"&gt;Button #1&lt;/button&gt;
  &lt;button type="button" class="btn btn-info"&gt;Button #2&lt;/button&gt;

  &lt;!-- dropdown starts here --&gt;
  &lt;div class="btn-group" role="group"&gt;
    &lt;button
      type="button"
      class="btn btn-info dropdown-toggle"
      data-toggle="dropdown"
      aria-haspopup="true"
      aria-expanded="false"&gt;
      Button #3: Dropdown
      &lt;!-- BS4 doesn't need to manually add a caret --&gt;
      &lt;!-- &lt;span class="caret"&gt;&lt;/span&gt; --&gt;
    &lt;/button&gt;

    &lt;!-- add ul.dropdown-menu mentioned above --&gt;
  &lt;/div&gt;

&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org14265cf" class="outline-4">
<h4 id="org14265cf"><span class="section-number-4">6.6.12</span> Navigation (js), tab (js)</h4>
<div class="outline-text-4" id="text-6-6-12">
</div>
<div id="outline-container-org28ca06b" class="outline-5">
<h5 id="org28ca06b"><span class="section-number-5">6.6.12.1</span> .nav, .nav-tabs, .nav-pills, tablist (js)</h5>
<div class="outline-text-5" id="text-6-6-12-1">
<p>
<a id="orgddd969a">bs:nav</a> :: May use 
</p>
<ul class="org-ul">
<li><a href="#orgee93b8d">bs:dropdown</a> as a nav item</li>
<li><a href="#orgf12dce9">bs:tab</a> to show and hide content</li>
<li id="bs:scrollspy">&lt;a href="#home"&gt;</li>
</ul>

<p>
Items are blocks float to left or stacked vertically
</p>

<pre class="example">
&lt;!-- nav-tabs or nav-pills --&gt;
&lt;!-- .nav-stacked :: add to ul --&gt;
&lt;!-- .nav-justified :: add to ul. Center tabs/pills --&gt;

&lt;ul class="nav nav-tabs"&gt;

  &lt;!-- BS4 for &lt;li&gt; :: add .nav-item and remove role="presentation" --&gt;
  &lt;li role="presentation" class="active"&gt;
    &lt;!-- BS4 for &lt;a&gt; :: add .nav-link --&gt;
    &lt;a href="#"&gt;Item 1&lt;/a&gt;
  &lt;/li&gt;
  &lt;li role="presentation" class="disabled"&gt;&lt;a href="#"&gt;Item 2&lt;/a&gt;&lt;/li&gt;
  &lt;li role="presentation"&gt;&lt;a href="#"&gt;Item 3&lt;/a&gt;&lt;/li&gt;

  &lt;!-- Item can be a bs:dropdown --&gt;
  &lt;li role="presentation" class="dropdown"&gt;
    &lt;button
      class="dropdown-toggle"
      data-toggle="dropdown"
      aria-haspopup="true"
      aria-expanded="false"&gt;
      Item 4
    &lt;/button&gt;

    &lt;ul class="dropdown-menu"&gt;
      ...
    &lt;/ul&gt;
  &lt;/li&gt;

&lt;/ul&gt;
</pre>

<p>
<a id="orgf12dce9">bs:tab</a>
Display content when nav-tabs or nav-pills is clicked $().tab data-toggle="tab"
</p>
<pre class="example">
&lt;!-- add role="tablist" --&gt;
&lt;ul class="nav nav-tabs"
    role="tablist"
    id="myTab"&gt;
  &lt;!-- Be sure to add .active --&gt;
  &lt;!-- BS4 for &lt;li&gt; :: add .nav-item and remove role="presentation" --&gt;
  &lt;li role="presentation" class="active"&gt;
    &lt;!-- &lt;a&gt; ::
         add role="tab", data-toggle="tab", aria-controls="..."
         BS4 :: add .nav-link
         may use data-target instead of href
     --&gt;
    &lt;a href="#item1"
       data-toggle="tab"
       role="tab"
       aria-controls="item1"&gt;Item 1&lt;/a&gt;
  &lt;/li&gt;


  &lt;li role="presentation" class="active"&gt;
    &lt;!-- &lt;a&gt; ::
         add role="tab", data-toggle="tab", aria-controls="..."
         BS4 :: add .nav-link
     --&gt;
    &lt;a href="#item1"
       data-toggle="tab"
       role="tab"
       aria-controls="item2"&gt;Item 2&lt;/a&gt;
  &lt;/li&gt;

&lt;/ul&gt;

&lt;div class="tab-content"&gt;
  &lt;!-- effect :: .fade to div.tab-pane --&gt;
  &lt;div class="tab-pane active"
       id="item1"
       role="tabpanel"&gt;
    Item 1 content
  &lt;/div&gt;

  &lt;div class="tab-pane active"
       id="item2"
       role="tabpanel"&gt;
    Item 2 content
  &lt;/div&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-orgc5f38f9" class="outline-5">
<h5 id="orgc5f38f9"><span class="section-number-5">6.6.12.2</span> Navbar (js)</h5>
<div class="outline-text-5" id="text-6-6-12-2">
<p>
<a id="org82a77db">bs:navbar</a> is responsive
Use <a href="#orge0a64cd">bs:collapse</a>
</p>

<p>
div.collapse collpses at viewport &lt;768px which is xs in BS3 and sm in BS4
</p>

<p>
Background image to navbar 
</p>
<pre class="example">
@media (min-width:768px) {
  .navbar {
    background:url('../images/nav-bg.jpg') center repeat-x #222;
    background-size:auto 100%;
  }
}

@media (max-width:768px) {
  .navbar .navbar-header{
    background:url('../images/nav-bg.jpg') center repeat-x #222;
    background-size:auto 100%;
  }
}
</pre>

<pre class="example">
&lt;!-- .navbar-fixed-bottom | .navbar-fixed-top :: add to &lt;nav&gt; if navbar is fixed --&gt;
&lt;!-- .navbar-default | .navbar-inverse (black and white) --&gt;
&lt;!-- customize color, border using .navbar-default --&gt;
&lt;nav class="navbar navbar-default"&gt;
  &lt;!-- Without div.container, the navbar will align to left --&gt;
  &lt;div class="container"&gt;

    &lt;!-- Add branding --&gt;
    &lt;div class="navbar-header"&gt;
      &lt;!-- Style toggle button --&gt;
      &lt;button type="button"
              class="navbar-toggle"
              data-toggle="collapse"
              data-target="#myNavbar"
              aria-expanded="false"&gt;
        &lt;span class="sr-only"&gt;Toggle navigation&lt;/span&gt;
        &lt;span class="icon-bar"&gt;&lt;/span&gt;
        &lt;span class="icon-bar"&gt;&lt;/span&gt;
        &lt;span class="icon-bar"&gt;&lt;/span&gt;
      &lt;/button&gt;

      &lt;a class="navbar-brand" href=""&gt;Website Name&lt;/a&gt;
      &lt;!-- Add a logo in a.navbar-brand. Height should 20px. --&gt;
      &lt;p class="navbar-text"&gt;optional: extra text&lt;/p&gt;
    &lt;/div&gt;

    &lt;!-- .collapse is display: none; --&gt;
    &lt;div class="collapse navbar-collapse" id="myNavbar"&gt;
      &lt;ul class="nav navbar-nav"&gt;
        &lt;li&gt;&lt;a href="#"&gt;Submenu 1&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href="#"&gt;Submenu 2&lt;/a&gt;&lt;/li&gt;

        &lt;!-- bs:dropdown --&gt;
        &lt;li&gt;
          &lt;a href="#"
             class="dropdown-toggle"
             data-toggle="dropdown"
             role="button"
             aria-haspopup="true"
             aria-expanded="false"&gt;Submenu 3&lt;/a&gt;
          &lt;ul class="dropdown-menu"&gt;
            ...
          &lt;/ul&gt;
        &lt;/li&gt;

      &lt;/ul&gt; &lt;!-- ul.navbar-nav ends --&gt;

      &lt;!-- Add extra text --&gt;
      &lt;p class="navbar-text"&gt;optional: extra text&lt;/p&gt;

      &lt;!-- Add a bs:button --&gt;
      &lt;button type="button" class="btn btn-default navbar-btn"&gt;sign in&lt;/button&gt;

      &lt;!-- Add a bs:form or bs:form:input-group --&gt;
      &lt;form class="navbar-form navbar-right" role="search"&gt;
        &lt;div class="form-group"&gt;
          ...
        &lt;/div&gt;
      &lt;/form&gt;

    &lt;/div&gt;
    &lt;!-- div.collapse ends --&gt;

  &lt;/div&gt;
  &lt;!-- div.container ends --&gt;
&lt;/nav&gt;
</pre>
</div>
</div>

<div id="outline-container-orgcc20e96" class="outline-5">
<h5 id="orgcc20e96"><span class="section-number-5">6.6.12.3</span> Breadcrumb</h5>
<div class="outline-text-5" id="text-6-6-12-3">
<p>
Simple align links horizontally
</p>

<pre class="example">
&lt;ol class="breadcrumb"&gt;
  &lt;li class="breadcrumb-item"&gt;&lt;a href="#"&gt;Home&lt;/a&gt;&lt;/li&gt;
  &lt;li class="breadcrumb-item"&gt;&lt;a href="#"&gt;Library&lt;/a&gt;&lt;/li&gt;
  &lt;li class="breadcrumb-item active"&gt;Data&lt;/li&gt;
&lt;/ol&gt;
</pre>
</div>
</div>

<div id="outline-container-orgd6ae1c3" class="outline-5">
<h5 id="orgd6ae1c3"><span class="section-number-5">6.6.12.4</span> Pagination and pager</h5>
<div class="outline-text-5" id="text-6-6-12-4">
<p>
Simply align links horizontally
BS3 recommends to replace &lt;a&gt; with &lt;span&gt; when li.disabled
</p>

<pre class="example">
&lt;nav aria-label="Page navigation"&gt;
  &lt;!-- .pagination-lg | .pagination-sm :: add to ul --&gt;
  &lt;ul class="pagination"&gt;
    &lt;!-- li.disabled --&gt;
    &lt;li class="disabled"&gt;
      &lt;a href="#" aria-label="Previous"&gt;
        &lt;span aria-hidden="true"&gt;&amp;laquo;&lt;/span&gt;
      &lt;/a&gt;
    &lt;/li&gt;

    &lt;!-- li.active --&gt;
    &lt;li class="active"&gt;
      &lt;a href="#"&gt;1&lt;/a&gt; &lt;span class="sr-only"&gt;(current)&lt;/span&gt;
    &lt;/li&gt;

    &lt;li&gt;&lt;a href="#"&gt;2&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href="#"&gt;3&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href="#"&gt;4&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href="#"&gt;5&lt;/a&gt;&lt;/li&gt;

    &lt;li&gt;
      &lt;a href="#" aria-label="Next"&gt;
        &lt;span aria-hidden="true"&gt;&amp;raquo;&lt;/span&gt;
      &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/nav&gt;
</pre>

<p>
Pager :: Simple Previous and Next buttons with no pages 
</p>
<pre class="example">
&lt;!-- add &lt;nav&gt;, classes li.previous, li.next to align buttons to both ends --&gt;
&lt;!-- remove &lt;nav&gt;, classes li.previous, li.next to center them --&gt;
&lt;nav aria-label="..."&gt;
  &lt;ul class="pager"&gt;
    &lt;li class="previous disabled"&gt;
      &lt;a href="#"&gt;&lt;span aria-hidden="true"&gt;&amp;larr;&lt;/span&gt; Older&lt;/a&gt;
    &lt;/li&gt;
    &lt;li class="next"&gt;
      &lt;a href="#"&gt;Newer &lt;span aria-hidden="true"&gt;&amp;rarr;&lt;/span&gt;&lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/nav&gt;
</pre>

<p>
BS4 structure is a little different
</p>
<dl class="org-dl">
<dt>.page-item</dt><dd>add to every &lt;li&gt;</dd>
<dt>.page-link</dt><dd>add to every li&gt;a</dd>
<dt>.disabled</dt><dd>add to li and add tabindex="-1" to li&gt;a. &lt;a&gt; will have pointer-events: none.</dd>
<dt>Optionally remove &lt;a&gt; if li.disabled</dt><dd>BS3 seems to recommend this behavior</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-orgce6c11f" class="outline-4">
<h4 id="orgce6c11f"><span class="section-number-4">6.6.13</span> Carousel (js)</h4>
<div class="outline-text-4" id="text-6-6-13">
<p>
Don't add data-ride if it's triggered by javascript
</p>

<p>
Pictures have to be the same width and height.
</p>

<pre class="example">
&lt;!-- Options
data-interval :: 5000
data-pause :: "hover" | null
data-wrap :: true
keyboard :: true
--&gt;
&lt;div id="carousel-example-generic"
     class="carousel slide"
     data-ride="carousel"&gt;

  &lt;ol class="carousel-indicators"&gt;
    &lt;!-- An item must have .active --&gt;
    &lt;li data-target="#carousel-example-generic" data-slide-to="0" class="active"&gt;&lt;/li&gt;
    &lt;li data-target="#carousel-example-generic" data-slide-to="1"&gt;&lt;/li&gt;
    &lt;li data-target="#carousel-example-generic" data-slide-to="2"&gt;&lt;/li&gt;
  &lt;/ol&gt;

  &lt;div class="carousel-inner" role="listbox"&gt;
    &lt;!-- An item must have .active --&gt;
    &lt;!-- BS4 :: use .carousel-item instead of .item --&gt;
    &lt;div class="item active"&gt;
      &lt;img src="..." alt="..."&gt;
      &lt;div class="carousel-caption"&gt;
        &lt;h3&gt;...&lt;/h3&gt;
        &lt;p&gt;...&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="item"&gt;
      &lt;img src="..." alt="..."&gt;
      &lt;div class="carousel-caption"&gt;
        ...
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;!--  more items --&gt;
  &lt;/div&gt;

  &lt;!-- Controls --&gt;
  &lt;!-- data-slide could be
  prev, next, cycle, pause, number (integer starting from 0)
  --&gt;
  &lt;a class="left carousel-control"
     href="#carousel-example-generic"
     role="button"
     data-slide="prev"&gt;
    &lt;span class="glyphicon glyphicon-chevron-left" aria-hidden="true"&gt;&lt;/span&gt;
    &lt;span class="sr-only"&gt;Previous&lt;/span&gt;
  &lt;/a&gt;
  &lt;a class="right carousel-control"
     href="#carousel-example-generic"
     role="button"
     data-slide="next"&gt;
    &lt;span class="glyphicon glyphicon-chevron-right" aria-hidden="true"&gt;&lt;/span&gt;
    &lt;span class="sr-only"&gt;Next&lt;/span&gt;
  &lt;/a&gt;

&lt;/div&gt;

&lt;script&gt;
  $(function() {
    $('#carousel-example-generic').carousel({
      // options :: see above
    });
    /* Other methods refer to data-slide
    e.g. .carousel('cycle') ...
     */

    // Catch events
    // slide.bs.carousel :: start
    // slid.bs.carousel :: complete
    // Event object
    // direction :: 'left' | 'right'
    // relatedTarget :: DOM element that is about to be active
    $('#carousel-example-generic').on('slide.bs.carousel', function(e) {
     // do something
    });

  });
&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-orgf5236be" class="outline-4">
<h4 id="orgf5236be"><span class="section-number-4">6.6.14</span> Modal (js)</h4>
<div class="outline-text-4" id="text-6-6-14">
<pre class="example">
&lt;!-- When a modal is open, it adds .modal-open to &lt;body&gt; and also
      a .modalbackdrop to provide a click area to dismiss the modal
---&gt;
&lt;button type="button" class="btn btn-primary btn-lg"
        data-toggle="modal"
        data-target="#myModal"&gt;
  Launch demo modal
&lt;/button&gt;

&lt;!-- remove .fade to remove animation --&gt;
&lt;div class="modal fade"
     id="myModal"
     tabindex="-1"
     role="dialog"
     aria-labelledby="myModalLabel"&gt;

  &lt;!-- Sizing :: in modal-dialog, add modal-lg, modal-sm --&gt;
  &lt;div class="modal-dialog" role="document"&gt;

    &lt;div class="modal-content"&gt;

      &lt;div class="modal-header"&gt;
        &lt;button type="button"
                class="close"
                data-dismiss="modal"
                aria-label="Close"&gt;
          &lt;span aria-hidden="true"&gt;&amp;times;&lt;/span&gt;
        &lt;/button&gt;
        &lt;h4 class="modal-title" id="myModalLabel"&gt;Modal title&lt;/h4&gt;
      &lt;/div&gt;

      &lt;div class="modal-body"&gt;
        &lt;!-- stack .row to use grid --&gt;
        &lt;!-- Any HTML or BS components --&gt;
        &lt;!-- form field autofocus has no effect. Refer to javascript below --&gt;
      &lt;/div&gt;

      &lt;div class="modal-footer"&gt;
        &lt;button type="button" class="btn btn-default"
                data-dismiss="modal"&gt;Close&lt;/button&gt;
        &lt;button type="button" class="btn btn-primary"&gt;Save changes&lt;/button&gt;
      &lt;/div&gt;

    &lt;/div&gt;

  &lt;/div&gt;

&lt;/div&gt;

&lt;script&gt;
  /* Options :: data-*
     backdrop :: true. Use 'static' to not close the modal on click
     keyboard :: true. Esp key closes the modal
     show :: true. Show when initialized
     remote :: deprecated.
  */

  /* Methods
     .modal(options)
     method_name :: toggle, show, hide, and
     handUpdate (readjust positioning. Only needed if modal height changes while it opens)
     .modal('method_name')
  */

  /* Event types:
  show.bs.modal :: start.
  shown.bs.modal :: finished (after transition is complete)
  hide.bs.modal :: start to hide
  hidden.bs.modal :: finished being hidden
  loaded.bs.modal :: content has been loaded through remote option
     Event object
   e.relatedTarget :: If triggered by a click, it's the clicked element
   */
  $('#myModal').on('show.bs.modal', function(e) {
    // Using the same modal to display different content
    var button = $(e.relatedTarget);
    var data = button.data('lili-content');
    // Do some Ajax
    var modal = $(this);
    modal.find('.modal-title').text('...');
    modal.find('.modal-body').innerHTML = '...';

    &lt;!-- form field autofocus has no effect. Use this workaround --&gt;
    $('#fieldInputID').focus();
  });
&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-org108880e" class="outline-4">
<h4 id="org108880e"><span class="section-number-4">6.6.15</span> Collapse (js)</h4>
<div class="outline-text-4" id="text-6-6-15">
<p>
<a id="orge0a64cd">bs:collapse</a> :: Button to expand or collapse content
Used in <a href="#org82a77db">bs:navbar</a> <a href="#org95e9e9b">bs:panel</a> <a href="#org7a04404">bs:card</a> (accordion)
</p>

<pre class="example">
&lt;!-- Action Button as &lt;a&gt; --&gt;
&lt;a class="btn btn-primary"
   role="button"
   data-toggle="collapse"
   href="#collapseExample"
   aria-expanded="false"
   aria-controls="collapseExample"&gt;
  Link with href
&lt;/a&gt;

&lt;!-- Action Button as &lt;button&gt; --&gt;
&lt;button class="btn btn-primary"
        type="button"
        data-toggle="collapse"
        data-target="#collapseExample"
        aria-expanded="false"
        aria-controls="collapseExample"&gt;
  Button with data-target
&lt;/button&gt;

&lt;!-- .collapse :: hide content initially --&gt;
&lt;div class="collapse" id="collapseExample"&gt;
  &lt;!-- BS4 :: use .card.card-block instead of .well --&gt;
  &lt;div class="well"&gt;
    ...
  &lt;/div&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org0b43ec4" class="outline-4">
<h4 id="org0b43ec4"><span class="section-number-4">6.6.16</span> Tooltip (js)</h4>
<div class="outline-text-4" id="text-6-6-16">
<p>
Need to initiate in javascript
</p>

<pre class="example">
&lt;button type="button" class="btn btn-default" 
        data-toggle="tooltip" 
        data-placement="left" 
        title="Tooltip on left"&gt;Tooltip on left&lt;/button&gt;

&lt;a href="#"
   data-toggle="tooltip"
   data-placement="bottom"
   title=""&gt;Tooltip on bottom&lt;/a&gt;

&lt;script&gt;
  $('[data-toggle="tooltip"]').tooltip();
&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-org7910879" class="outline-4">
<h4 id="org7910879"><span class="section-number-4">6.6.17</span> Popover (js)</h4>
<div class="outline-text-4" id="text-6-6-17">
<p>
Need to initiate in javascript
A title can be specified
</p>

<p>
data-trigger can be click | hover | focus | manual
</p>

<pre class="example">
&lt;a tabindex="0"
   class="btn btn-lg btn-danger"
   role="button"
   data-toggle="popover"
   data-container="body"
   data-trigger="focus"
   title="Dismissible popover"
   data-content="And here's some amazing content. It's very engaging. Right?"&gt;
  Click on anywhere to dismiss the popover
&lt;/a&gt;

&lt;button type="button"
   class="btn btn-lg btn-danger"
   role="button"
   data-toggle="popover"
   data-trigger="focus"
   title="Dismissible popover"
   data-content="And here's some amazing content. It's very engaging. Right?"&gt;
  Must click on the button again to dismiss the popover
&lt;/button&gt;

&lt;script&gt;
  $('[data-toggle="popover"]').popover();
&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-orgd42dc50" class="outline-4">
<h4 id="orgd42dc50"><span class="section-number-4">6.6.18</span> Scrollspy (js)</h4>
<div class="outline-text-4" id="text-6-6-18">
<p>
Must use with <a href="#orgddd969a">bs:nav</a>
</p>

<pre class="example">
&lt;body data-spy="scroll" data-target="#navbar-example"&gt;
  ...
  &lt;div id="navbar-example"&gt;
    &lt;ul class="nav nav-tabs" role="tablist"&gt;
      ...
    &lt;/ul&gt;
  &lt;/div&gt;
  ...
&lt;/body&gt;

&lt;style&gt;
body {
  position: relative;
}
&lt;/style&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org0de3eab" class="outline-3">
<h3 id="org0de3eab"><span class="section-number-3">6.7</span> Mockup Tools</h3>
<div class="outline-text-3" id="text-6-7">
<p>
<a href="http://www.layoutit.com/">LayoutIt.com</a> BS3
<a href="http://www.bootply.com/">http://www.bootply.com/</a>
</p>
</div>
</div>

<div id="outline-container-orged31273" class="outline-3">
<h3 id="orged31273"><span class="section-number-3">6.8</span> v4</h3>
<div class="outline-text-3" id="text-6-8">
</div>
<div id="outline-container-org570da15" class="outline-4">
<h4 id="org570da15"><span class="section-number-4">6.8.1</span> Display utilities .d-* .display-*</h4>
<div class="outline-text-4" id="text-6-8-1">
<p>
.d-{value} for xs
.d-{breakpoint}-{value} for sm, md, lg, and xl.
</p>

<p>
d-none
d-inline
d-inline-block
d-block
d-table
d-table-cell
d-table-row
d-flex
d-inline-flex
</p>

<p>
Hidden on all	        .d-none
Hidden only on xs	.d-none .d-sm-block
Hidden only on sm	.d-sm-none .d-md-block
Hidden only on md	.d-md-none .d-lg-block
Hidden only on lg	.d-lg-none .d-xl-block
Hidden only on xl	.d-xl-none
Visible on all	        .d-block
Visible only on xs	.d-block .d-sm-none
Visible only on sm	.d-none .d-sm-block .d-md-none
Visible only on md	.d-none .d-md-block .d-lg-none
Visible only on lg	.d-none .d-lg-block .d-xl-none
Visible only on xl	.d-none .d-xl-block
</p>

<p>
Display headings
&lt;h1 class="display-1"&gt;Display 1&lt;/h1&gt;
&lt;h1 class="display-2"&gt;Display 2&lt;/h1&gt;
&lt;h1 class="display-3"&gt;Display 3&lt;/h1&gt;
&lt;h1 class="display-4"&gt;Display 4&lt;/h1&gt;
</p>
</div>
</div>

<div id="outline-container-org895bdf5" class="outline-4">
<h4 id="org895bdf5"><span class="section-number-4">6.8.2</span> p.lead</h4>
<div class="outline-text-4" id="text-6-8-2">
<pre class="example">
.lead {
    font-size: 1.25rem;
    font-weight: 300;
}

&lt;p class="lead"&gt;25% bigger than 1rem and 300 font weight.&lt;/p&gt;

Can be used to enlarge a button
&lt;p class="lead"&gt;
  &lt;a class="btn btn-primary btn-lg" href="#" role="button"&gt;Learn more&lt;/a&gt;
&lt;/p&gt;
</pre>
</div>
</div>

<div id="outline-container-org08fabd4" class="outline-4">
<h4 id="org08fabd4"><span class="section-number-4">6.8.3</span> Spacing</h4>
<div class="outline-text-4" id="text-6-8-3">
<p>
mt, pt, mb, pb
mx, px for left and right
my, py for top and bottom
</p>

<p>
{property}{sides}-{size} for xs
{property}{sides}-{breakpoint}-{size} for sm, md, lg and xl
</p>

<p>
size
m-0
m-1 to $spacer * .25
m-2 $spacer * .5
m-3 $spacer
m-4 $spacer * 1.5
m-5 $spacer * 3
m-auto
</p>

<p>
$spacer is 1 rem
</p>
</div>
</div>

<div id="outline-container-orgecdc84a" class="outline-4">
<h4 id="orgecdc84a"><span class="section-number-4">6.8.4</span> flex</h4>
<div class="outline-text-4" id="text-6-8-4">
<p>
<a href="https://getbootstrap.com/docs/4.0/utilities/flex/">https://getbootstrap.com/docs/4.0/utilities/flex/</a>
</p>
</div>

<div id="outline-container-org6e78ad7" class="outline-5">
<h5 id="org6e78ad7"><span class="section-number-5">6.8.4.1</span> Use case</h5>
<div class="outline-text-5" id="text-6-8-4-1">
<p>
Left and right
</p>
<pre class="example">
&lt;section class="search-bar"&gt;
  &lt;div class="page-wrap container"&gt;
    &lt;div class="d-flex flex-wrap align-items-center"&gt;
      &lt;h1 class="mr-auto p-2 text-white text-uppercase"&gt;New And Used Inventory&lt;/h1&gt;
      &lt;a href="/admin" class="p-2 btn btn-light btn-sm bg-white text-primary" role="button"&gt;Adminstrator Login&lt;/a&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/section&gt;
</pre>
</div>
</div>

<div id="outline-container-org9b0bc5a" class="outline-5">
<h5 id="org9b0bc5a"><span class="section-number-5">6.8.4.2</span> display</h5>
<div class="outline-text-5" id="text-6-8-4-2">
<pre class="example">
.d-flex
.d-inline-flex
.d-sm-flex
.d-sm-inline-flex
.d-md-flex
.d-md-inline-flex
.d-lg-flex
.d-lg-inline-flex
.d-xl-flex
.d-xl-inline-flex
</pre>
</div>
</div>

<div id="outline-container-orgcf5c5d6" class="outline-5">
<h5 id="orgcf5c5d6"><span class="section-number-5">6.8.4.3</span> flex-row</h5>
<div class="outline-text-5" id="text-6-8-4-3">
<pre class="example">
.flex-row
.flex-row-reverse
.flex-column
.flex-column-reverse
.flex-sm-row
.flex-sm-row-reverse
.flex-sm-column
.flex-sm-column-reverse
.flex-md-row
.flex-md-row-reverse
.flex-md-column
.flex-md-column-reverse
.flex-lg-row
.flex-lg-row-reverse
.flex-lg-column
.flex-lg-column-reverse
.flex-xl-row
.flex-xl-row-reverse
.flex-xl-column
.flex-xl-column-reverse
</pre>
</div>
</div>

<div id="outline-container-orgb2de683" class="outline-5">
<h5 id="orgb2de683"><span class="section-number-5">6.8.4.4</span> flex-wrap</h5>
<div class="outline-text-5" id="text-6-8-4-4">
<pre class="example">
.flex-nowrap
.flex-wrap
.flex-wrap-reverse
.flex-sm-nowrap
.flex-sm-wrap
.flex-sm-wrap-reverse
.flex-md-nowrap
.flex-md-wrap
.flex-md-wrap-reverse
.flex-lg-nowrap
.flex-lg-wrap
.flex-lg-wrap-reverse
.flex-xl-nowrap
.flex-xl-wrap
.flex-xl-wrap-reverse
</pre>
</div>
</div>

<div id="outline-container-orgdccad40" class="outline-5">
<h5 id="orgdccad40"><span class="section-number-5">6.8.4.5</span> justify-content</h5>
<div class="outline-text-5" id="text-6-8-4-5">
<pre class="example">
.justify-content-start
.justify-content-end
.justify-content-center
.justify-content-between
.justify-content-around
.justify-content-sm-start
.justify-content-sm-end
.justify-content-sm-center
.justify-content-sm-between
.justify-content-sm-around
.justify-content-md-start
.justify-content-md-end
.justify-content-md-center
.justify-content-md-between
.justify-content-md-around
.justify-content-lg-start
.justify-content-lg-end
.justify-content-lg-center
.justify-content-lg-between
.justify-content-lg-around
.justify-content-xl-start
.justify-content-xl-end
.justify-content-xl-center
.justify-content-xl-between
.justify-content-xl-around
</pre>
</div>
</div>

<div id="outline-container-orgc43c5f6" class="outline-5">
<h5 id="orgc43c5f6"><span class="section-number-5">6.8.4.6</span> align-items</h5>
<div class="outline-text-5" id="text-6-8-4-6">
<pre class="example">
.align-items-start
.align-items-end
.align-items-center
.align-items-baseline
.align-items-stretch
.align-items-sm-start
.align-items-sm-end
.align-items-sm-center
.align-items-sm-baseline
.align-items-sm-stretch
.align-items-md-start
.align-items-md-end
.align-items-md-center
.align-items-md-baseline
.align-items-md-stretch
.align-items-lg-start
.align-items-lg-end
.align-items-lg-center
.align-items-lg-baseline
.align-items-lg-stretch
.align-items-xl-start
.align-items-xl-end
.align-items-xl-center
.align-items-xl-baseline
.align-items-xl-stretch
</pre>
</div>
</div>

<div id="outline-container-org83ff015" class="outline-5">
<h5 id="org83ff015"><span class="section-number-5">6.8.4.7</span> auto margin</h5>
<div class="outline-text-5" id="text-6-8-4-7">
<pre class="example">
&lt;!-- all three left --&gt;
&lt;div class="d-flex"&gt;
  &lt;div class="p-2"&gt;Flex item&lt;/div&gt;
  &lt;div class="p-2"&gt;Flex item&lt;/div&gt;
  &lt;div class="p-2"&gt;Flex item&lt;/div&gt;
&lt;/div&gt;

&lt;!-- left right right--&gt;
&lt;div class="d-flex"&gt;
  &lt;div class="mr-auto p-2"&gt;Flex item&lt;/div&gt;
  &lt;div class="p-2"&gt;Flex item&lt;/div&gt;
  &lt;div class="p-2"&gt;Flex item&lt;/div&gt;
&lt;/div&gt;

&lt;!-- left left right --&gt;
&lt;div class="d-flex"&gt;
  &lt;div class="p-2"&gt;Flex item&lt;/div&gt;
  &lt;div class="p-2"&gt;Flex item&lt;/div&gt;
  &lt;div class="ml-auto p-2"&gt;Flex item&lt;/div&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org2b2c67f" class="outline-5">
<h5 id="org2b2c67f"><span class="section-number-5">6.8.4.8</span> iOS 8 and lower</h5>
<div class="outline-text-5" id="text-6-8-4-8">
<p>
v4 doesn't support flex for iOS 8 and lower.
</p>
<pre class="example">
display: -webkit-box; /* v4 uses. and this doesn't support wrap so -webkit-flex has to be used */
display: -moz-box;
display: -ms-flexbox;
display: -webkit-flex; /* should use this */
display: flex;

/* v4 doesn't use any -webkit-flex-* */
-webkit-flex-wrap: wrap;
-webkit-justify-content: center;
        justify-content: center;
-webkit-align-items: center;
        align-items: center;
</pre>

<p>
Refer to <a href="#org18d20e6">modernizr:flexbox</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orgd87d80d" class="outline-4">
<h4 id="orgd87d80d"><span class="section-number-4">6.8.5</span> color</h4>
<div class="outline-text-4" id="text-6-8-5">
<p>
<a href="https://getbootstrap.com/docs/4.0/utilities/colors/">https://getbootstrap.com/docs/4.0/utilities/colors/</a>
</p>

<p>
.bg-white
.text-white
</p>

<p>
primary :: blue
secondary :: grey
success :: green
danger :: red
warning :: yellow
info :: cyan
light :: light grey
muted :: darker grey similary to secondary
</p>
</div>
</div>

<div id="outline-container-org84ac53a" class="outline-4">
<h4 id="org84ac53a"><span class="section-number-4">6.8.6</span> text</h4>
<div class="outline-text-4" id="text-6-8-6">
<p>
.text-lowercase
-uppercase
-capitalize
</p>
</div>
</div>

<div id="outline-container-org4353545" class="outline-4">
<h4 id="org4353545"><span class="section-number-4">6.8.7</span> Popover</h4>
<div class="outline-text-4" id="text-6-8-7">
<p>
Require popper.js
Need to be initialized using javascript
</p>
<pre class="example">
// initialize all
$(function () {
  $('[data-toggle="popover"]').popover()
})

//
</pre>

<p>
button not dismissable
</p>
<pre class="example">
&lt;button type="button" 
 class="btn btn-lg btn-danger" 
 data-toggle="popover" 
 title="Popover title" 
 data-content="And here's some amazing content. It's very engaging. Right?"&gt;Click to toggle popover&lt;/button&gt;
</pre>

<p>
&lt;a&gt; dismissable (click somewhere else)
</p>
<pre class="example">
&lt;a tabindex="0" 
   class="btn btn-lg btn-danger" 
   role="button" 
   data-toggle="popover" 
   data-trigger="focus" 
   title="Dismissible popover" 
   data-content="And here's some amazing content. It's very engaging. Right?"&gt;Dismissible popover&lt;/a&gt;
</pre>

<p>
Events :: *.bs.popover
show, shown, hide, hidden, inserted
</p>
<pre class="example">
$('#myPopover').on('shown.bs.popover', function () {
  // do something…
})
</pre>

<p>
Methods
</p>

<p>
trigger mode manual if you want to distinguish hover and click events
</p>
<pre class="example">
$('.action-call[data-toggle="popover"]').popover({trigger:'manual'})
    .on({
      mouseenter: function() {$(this).popover('show');},
      mouseleave: function() {$(this).popover('hide');},
      click: function() {window.open('tel:'+$(this).data('phone'));}
    });
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd34859c" class="outline-2">
<h2 id="orgd34859c"><span class="section-number-2">7</span> HTML</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org2931b40" class="outline-3">
<h3 id="org2931b40"><span class="section-number-3">7.1</span> DOM</h3>
<div class="outline-text-3" id="text-7-1">
</div>
<div id="outline-container-org9673069" class="outline-4">
<h4 id="org9673069"><span class="section-number-4">7.1.1</span> Document Object</h4>
<div class="outline-text-4" id="text-7-1-1">
<p>
<a href="https://developer.mozilla.org/en/docs/Web/API/Document">Document properties and methods</a>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">document.methodName() or</th>
<th scope="col" class="org-left">Notes</th>
<th scope="col" class="org-left">Use in</th>
</tr>

<tr>
<th scope="col" class="org-left">document.propertyName</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">Element Obj?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">createElement("p")</td>
<td class="org-left"><a href="#org25654c8">appendChild</a></td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">createTextNode("text node");</td>
<td class="org-left"><a href="#org25654c8">appendChild</a></td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">createAttribute('data-id')</td>
<td class="org-left"><a href="#org25654c8">appendChild</a></td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">getElementById("id")</td>
<td class="org-left">null or <a href="#org87fa3a7">element object</a></td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">getElementsByClassName</td>
<td class="org-left"><a href="#org8b12a28">NodeList</a></td>
<td class="org-left">yes</td>
</tr>

<tr>
<td class="org-left">getElementsByTagName("p")</td>
<td class="org-left"><a href="#org8b12a28">NodeList</a></td>
<td class="org-left">yes</td>
</tr>

<tr>
<td class="org-left">querySelector('#id')</td>
<td class="org-left">1st matched element. null or exception or <a href="#org87fa3a7">element object</a></td>
<td class="org-left">yes</td>
</tr>

<tr>
<td class="org-left">querySelectorAll('#id')</td>
<td class="org-left"><a href="#org0dede7c">Static NodeList</a> or exception</td>
<td class="org-left">yes</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">normalize()</td>
<td class="org-left">remove empty text nodes and join adjacent text nodes</td>
<td class="org-left">yes</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orge16faea" class="outline-4">
<h4 id="orge16faea"><span class="section-number-4">7.1.2</span> <a href="#org8b12a28">NodeList</a> Object <a id="org8b12a28">NodeList</a></h4>
<div class="outline-text-4" id="text-7-1-2">
<p>
<a href="#org8b12a28">NodeList</a> Object appears like an array (loop like an array) but cannot use Array Methods such as valueOf(), join(), forEach().
</p>

<p>
<a id="org0dede7c">Static NodeList</a> means changes to DOM have no effect.
</p>

<p>
All <a href="#org8b12a28">NodeList</a> objects are live objects meaning changes
that are made in other code places reflect on all <a href="#org8b12a28">NodeList</a> objects that were previously found.
</p>

<p>
var myNodeList = document.getElementsByTagName("P");
console.log(myNodeList.length); 
var firstP = myNodeList[0];
var firstP = myNodeList.item(0); <i>/ same as above, return null if not exists
var firstP = document.getElementsByTagName("p")[0]; /</i> same as above
</p>

<p>
console.log(firstP.innerHTML);
firstP.style.backgroundColor = "red";
</p>

<p>
for (var i=0; i &lt; myNodeList.length; i++) {
 myNodeList[i].style.backgroundColor = "red";
} 
</p>

<p>
Another way to loop <a href="#org8b12a28">NodeList</a>
</p>

<pre class="example">
Array.prototype.forEach.call(
 aNodeListArray,
 function(item) {
  console.log(item.id);
 }
);
</pre>
</div>
</div>

<div id="outline-container-org2b0c0b4" class="outline-4">
<h4 id="org2b0c0b4"><span class="section-number-4">7.1.3</span> <a id="org87fa3a7">Element Object</a></h4>
<div class="outline-text-4" id="text-7-1-3">
<p>
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Element">Element Properties and Methods</a>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">element.methodName() or</th>
<th scope="col" class="org-left">Notes</th>
<th scope="col" class="org-left">Use in</th>
</tr>

<tr>
<th scope="col" class="org-left">element.propertyName</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">Document</th>
</tr>

<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">Object?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">accessKey</td>
<td class="org-left">get/set accessKey</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">addEventListerner()</td>
<td class="org-left">refer to event attributes without 'on'</td>
<td class="org-left">yes</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">e.addEventListerner("click", myFunction,false )</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">false for bubbling, true for capturing</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">removeEventListener()</td>
<td class="org-left">anonymous function will not work</td>
<td class="org-left">yes</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">click()</td>
<td class="org-left">simulate a click on an element</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">blur()</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">focus()</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">innerHTML</td>
<td class="org-left">get/set</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><a href="#org25654c8">appendChild</a>(newChildNode)</td>
<td class="org-left">move element to the end of another element</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><a id="org25654c8">appendChild</a></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">removeChild(childNode)</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">list.insertBefore(newnode,</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">list.childNodes[0])</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><a id="org01d485a">parentNode</a></td>
<td class="org-left">read only</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left"><a id="org5b95308">parentElement</a></td>
<td class="org-left">read only</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.cloneNode()</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">attributes</td>
<td class="org-left">read only. <a href="#org8ec6cc4">NamedNodeMap</a></td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">getAttribute("class")</td>
<td class="org-left">attribute value in string</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">getAttributeNode("class")</td>
<td class="org-left"><a href="#orge5bc6f0">Attr object</a></td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.childElementCount</td>
<td class="org-left">the number of child element nodes not text</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">and comment nodes</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.childNodes</td>
<td class="org-left"><a href="#org8b12a28">NodeList</a> object. .childNodes.length</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">var c = e.childNodes[0].text</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.children</td>
<td class="org-left">exclude text and comment nodes.</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">HTMLCollection object.</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">classList</td>
<td class="org-left">read only. <a href="#org48edc50">DOMTokenList</a></td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">className</td>
<td class="org-left">get/set</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">clientHeight</td>
<td class="org-left">height + padding, no border and scrollbar</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">clientWidth</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">clientTop</td>
<td class="org-left">Top border width</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">clientLeft</td>
<td class="org-left">Left border width</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">offsetWidth</td>
<td class="org-left">width+padding+border+scrollbar but no margin</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">offsetHeight</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">no</td>
</tr>

<tr>
<td class="org-left">.offsetLeft, offsetTop</td>
<td class="org-left">relative to offsetParent</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.scrollHeight, .scrollWidth</td>
<td class="org-left">width+padding only</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.scrollLeft, .scrollTop</td>
<td class="org-left">pixels are scrolled</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">e1.compareDocumentPosition(e2)</td>
<td class="org-left">compare positions of elements</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">e1.contains(e2)</td>
<td class="org-left">if e2 is a descendant of e1</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.contentEditable</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.firstChild</td>
<td class="org-left">child node</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.firstElementChild</td>
<td class="org-left">child element node</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.nextSibling</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.nextElementSibling</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.hasAttribute("onclick")</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.hasAttributes()</td>
<td class="org-left">has any attributes?</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.hasChildNodes()</td>
<td class="org-left">has any child nodes</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.isEqualNode(e1,e2)</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.nodeName</td>
<td class="org-left">tag name</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.tagName</td>
<td class="org-left">tag name in upppercase</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">.nodeValue</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org13ba2da" class="outline-4">
<h4 id="org13ba2da"><span class="section-number-4">7.1.4</span> Event Object</h4>
<div class="outline-text-4" id="text-7-1-4">
<pre class="example">
&lt;input id="elem" type="button" value="Click me"&gt;
// event is the first argument
&lt;script&gt;
  elem.onclick = function(e) {
    alert('Thank you');
  };
&lt;/script&gt;

// Pass event for inlince onclick
&lt;pre onclick="doSth(event)"&gt;

function doSth(e) {
  e.stopPropagation();
}

&lt;pre onclick="event.stopPropagation();doSth();"&gt;
</pre>


<p>
Property
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">type</td>
<td class="org-left">event name. e.g. mousedown</td>
</tr>

<tr>
<td class="org-left">timeStamp</td>
<td class="org-left">event occured</td>
</tr>

<tr>
<td class="org-left">bubbles</td>
<td class="org-left">true or false</td>
</tr>

<tr>
<td class="org-left">defaultPrevented</td>
<td class="org-left">if method preventDefault() was called</td>
</tr>

<tr>
<td class="org-left">currentTarget</td>
<td class="org-left">the element event happens on</td>
</tr>

<tr>
<td class="org-left">target</td>
<td class="org-left">the (child) element event happens on</td>
</tr>

<tr>
<td class="org-left">view</td>
<td class="org-left">get reference of the Window object where the event occured</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Method
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">preventDefault()</td>
<td class="org-left">stop defeault event action</td>
</tr>

<tr>
<td class="org-left">stopImmediatePropagation()</td>
<td class="org-left">stop other listerns of the same event (e.g. click) on the same target</td>
</tr>

<tr>
<td class="org-left">stopPropagation()</td>
<td class="org-left">stop bubbling</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-org804ad01" class="outline-5">
<h5 id="org804ad01"><span class="section-number-5">7.1.4.1</span> MouseEvent Object</h5>
<div class="outline-text-5" id="text-7-1-4-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">altKey</td>
<td class="org-left">whether ALT key was pressed</td>
</tr>

<tr>
<td class="org-left">shiftKey</td>
<td class="org-left">whether Shift key was pressed</td>
</tr>

<tr>
<td class="org-left">ctrlKey</td>
<td class="org-left">whether Ctrl key was pressed</td>
</tr>

<tr>
<td class="org-left">button</td>
<td class="org-left">0 left click, 1 middle, 2 right</td>
</tr>

<tr>
<td class="org-left">which</td>
<td class="org-left">button + 1: 0: no button, 1 left, 2 middle, 3 right</td>
</tr>

<tr>
<td class="org-left">buttons</td>
<td class="org-left">one or more buttons. More button such as browse back button.Safari not supported</td>
</tr>

<tr>
<td class="org-left">clientX</td>
<td class="org-left">relative to current window (viewport).</td>
</tr>

<tr>
<td class="org-left">clientY</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">pageX</td>
<td class="org-left">relative to the fully rendered content area. Height might be larger than</td>
</tr>

<tr>
<td class="org-left">pageY</td>
<td class="org-left">viewport height.</td>
</tr>

<tr>
<td class="org-left">screenX</td>
<td class="org-left">relative to the screen. e.g. number of monitors and monitor screen</td>
</tr>

<tr>
<td class="org-left">screenY</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">relatedTarget</td>
<td class="org-left">use with mouseover event to find the element the cursor jsut exited or</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">with the mouseout event to find the element the cursor just entered</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org7d92c38" class="outline-5">
<h5 id="org7d92c38"><span class="section-number-5">7.1.4.2</span> KeyboardEvent Object</h5>
<div class="outline-text-5" id="text-7-1-4-2">
<p>
Keyboard code (KC) - actual key on keyboard (always lowercase)
Unicode Character code (UCC) - result Unicode character (Shift + w = W, return the character code of W)
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">altKey</td>
<td class="org-left">whether alt is pressed</td>
</tr>

<tr>
<td class="org-left">ctrlKey</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">shiftKey</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">metaKey</td>
<td class="org-left">whether meta is pressed. Windows key</td>
</tr>

<tr>
<td class="org-left">key</td>
<td class="org-left">key name on keyboard (F1,Enter..)</td>
</tr>

<tr>
<td class="org-left">keyCode</td>
<td class="org-left">keypress-0, keydown,keyup-UCC. All browsers.</td>
</tr>

<tr>
<td class="org-left">charCode</td>
<td class="org-left">keypress-UCC, keydown,keyup-0. All browsers.</td>
</tr>

<tr>
<td class="org-left">which</td>
<td class="org-left">keypress-UCC, keydown,keyup-UCC. All browsers.</td>
</tr>

<tr>
<td class="org-left">location</td>
<td class="org-left">4 numbers 0 - standard,1 - left,</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">2 - right (CTRL), 3 - numpad</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
If you want to return UCC for all events cross all browsers use this:
var x = event.charCode || event.keyCode;
</p>
</div>
</div>

<div id="outline-container-org6dccf1f" class="outline-5">
<h5 id="org6dccf1f"><span class="section-number-5">7.1.4.3</span> HashChangeEvent Object</h5>
<div class="outline-text-5" id="text-7-1-4-3">
<p>
newURL :: the URL after the hash has been changed
oldURL
</p>
</div>
</div>

<div id="outline-container-org65b0abc" class="outline-5">
<h5 id="org65b0abc"><span class="section-number-5">7.1.4.4</span> PageTransitionEvent</h5>
<div class="outline-text-5" id="text-7-1-4-4">
<p>
For events: onpageshow and onpagehide
persisted :: whether the page was cached
</p>
</div>
</div>

<div id="outline-container-org273e561" class="outline-5">
<h5 id="org273e561"><span class="section-number-5">7.1.4.5</span> FocusEvent Object</h5>
<div class="outline-text-5" id="text-7-1-4-5">
<p>
relatedTarget :: the element related to the element that triggered the event
event.relatedTarget.tagName;
</p>
</div>
</div>

<div id="outline-container-orgef86ce5" class="outline-5">
<h5 id="orgef86ce5"><span class="section-number-5">7.1.4.6</span> AnimationEvent Object</h5>
<div class="outline-text-5" id="text-7-1-4-6">
<p>
animationName :: keyframe name
elapsedTime :: number of seconds the transition has been running
</p>
</div>
</div>

<div id="outline-container-org7833bec" class="outline-5">
<h5 id="org7833bec"><span class="section-number-5">7.1.4.7</span> HTML DOM Event</h5>
<div class="outline-text-5" id="text-7-1-4-7">
</div>
<ol class="org-ol">
<li><a id="orgc946b22"></a>DOMContentLoaded <a id="org7bd86f0">html:event:DOMContentLoaded</a><br />
<div class="outline-text-6" id="text-7-1-4-7-1">
<p>
It's fired when the initial HTML has been completely loaded and parsed, without waiting for stylesheets, images and subframes to finish loading. <a href="#org704edba">html:event:load</a> is fully-loaded.
</p>

<p>
Synchronous JavaScript can issue a doc.write at any point; hence the DOM tree construction is blocked anytime a synchronous script is encountered
JavaScript can query for a computed style of any object, which means it can also block on CSS
</p>

<p>
DOM construction can’t proceed until JavaScript is executed, and JavaScript can’t proceed until CSSOM is available.
</p>

<p>
Mark JavaScript files as <a href="#orgd765464">js:defer</a> to unblock construction of DOM and execute them before domContentLoadedEventStart but JavaScript files still need to wait for CSSOM to be finished.
</p>

<p>
Mark JavaScript files as <a href="#orgf9f8f3a">js:async</a> is similar to <a href="#orgd765464">js:defer</a> but DCL does not have to wait for execution of async scripts.
</p>

<p>
By default, JavaScript will block DOM construction, which may block on CSSOM. Sync scripts are bad, but you already knew that. Marking scripts with “defer” and “async” makes an implicit promise to the document parser that you will not use doc.write, which in turn allows it to unblock DOM construction.
</p>

<p>
If at any point we must wait for JavaScript execution, then we will have to first wait for the CSSOM construction to finish. In other words, there is a hard dependency edge between JavaScript and CSS… Stylesheets at the top, scripts at the bottom? Now you know why.
</p>

<p>
<a href="https://calendar.perfplanet.com/2012/deciphering-the-critical-rendering-path/">https://calendar.perfplanet.com/2012/deciphering-the-critical-rendering-path/</a>
</p>
</div>
</li>

<li><a id="orgaebd387"></a>load <a id="org704edba">html:event:load</a><br />
<div class="outline-text-6" id="text-7-1-4-7-2">
<p>
Refer to <a href="#org7bd86f0">html:event:DOMContentLoaded</a>
</p>

<p>
domLoading :: browser is about to start parsing the first received bytes of the HTML document
domInteractive :: browser has finished parsing all HTML and DOM construction
domContentLoaded :: Both DOM is ready and there're no stylesheets that are blocking JavaScript execution (CSSOM is parsed and ready). Ready to construct the render tree.
</p>
<ul class="org-ul">
<li>domContentLoadedEventStart</li>
<li>domContentLoadedEventEnd</li>
</ul>
<p>
domComplete :: all processing is complete and all resources e.g. images have finished downloading. The loading spinner has stopped spinning.
load :: page is fully loaded
</p>
<ul class="org-ul">
<li>loadEventStart</li>
<li>loadEventEnd</li>
</ul>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org7ec8bdb" class="outline-4">
<h4 id="org7ec8bdb"><span class="section-number-4">7.1.5</span> <a id="org48edc50">DOMTokenList</a> Object</h4>
<div class="outline-text-4" id="text-7-1-5">
<p>
A collection of space-separated tokens.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left"><a href="#org48edc50">DOMTokenList</a>.methodName()</th>
<th scope="col" class="org-left">Notes</th>
</tr>

<tr>
<th scope="col" class="org-left">or</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>

<tr>
<th scope="col" class="org-left"><a href="#org48edc50">DOMTokenList</a>.propertyName</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">length</td>
<td class="org-left">read only</td>
</tr>

<tr>
<td class="org-left">add("class2Name")</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">remove("class2Name")</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">replace("old","new")</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">toggle('class2Name')</td>
<td class="org-left">if exists, removes and return false. If not, add and return true</td>
</tr>

<tr>
<td class="org-left">contains("class2Name")</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgeb11946" class="outline-4">
<h4 id="orgeb11946"><span class="section-number-4">7.1.6</span> <a id="org8ec6cc4">NamedNodeMap</a> Object</h4>
<div class="outline-text-4" id="text-7-1-6">
<p>
A collection of <a href="#orge5bc6f0">Attr object</a> 's. Loopable like an Array but no Array methods.
</p>
</div>
</div>

<div id="outline-container-org71fc2c8" class="outline-4">
<h4 id="org71fc2c8"><span class="section-number-4">7.1.7</span> <a id="orge5bc6f0">Attr Object</a></h4>
<div class="outline-text-4" id="text-7-1-7">
<p>
An attribute node.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">name</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">value</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org3fae74b" class="outline-4">
<h4 id="org3fae74b"><span class="section-number-4">7.1.8</span> PointerEvent</h4>
<div class="outline-text-4" id="text-7-1-8">
<p>
<a href="https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent">https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent</a>
Polyfill: <a href="https://github.com/jquery/PEP#why-pointer-events">jQuery PEP</a> 
</p>
</div>
</div>
</div>

<div id="outline-container-org222ef74" class="outline-3">
<h3 id="org222ef74"><span class="section-number-3">7.2</span> Global Attributes</h3>
<div class="outline-text-3" id="text-7-2">
<p>
Can be applied to any element
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">accesskey</td>
<td class="org-left">Add shortcut. M-accesskey</td>
</tr>

<tr>
<td class="org-left">download</td>
<td class="org-left">filename. force download</td>
</tr>

<tr>
<td class="org-left">contenteditable</td>
<td class="org-left">true or false. Become editable</td>
</tr>

<tr>
<td class="org-left">contextmenu</td>
<td class="org-left">right click menu. Only in Firefox</td>
</tr>

<tr>
<td class="org-left">dir</td>
<td class="org-left">ltr, rtl or auto. text direction.</td>
</tr>

<tr>
<td class="org-left">hidden</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">spellcheck</td>
<td class="org-left">true or false</td>
</tr>

<tr>
<td class="org-left">tabindex</td>
<td class="org-left">Tab button. 1 is first</td>
</tr>

<tr>
<td class="org-left">title</td>
<td class="org-left">tool tip</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Drag-and-Drop
</p>

<pre class="example">
// ondropover allows this tag to receive dropped elements.
// ondrop defines what to do with the traferred data
&lt;div id="div1" ondrop="drop(e)" ondragover="allowDrop(e)"&gt;&lt;/div&gt;
// Make a tag draggable: draggable="true"
// &lt;a&gt; and &lt;img&gt; are by default draggable
// ondragstart defines what data to pass to ondrop
&lt;img id="drag1" src="http://placehold.it/300x250" draggable="true" ondragstart="drag(e)"&gt;

&lt;script&gt;
function drag(e) {
  // Pass the dragged element id
  ev.dataTransfer.setData("text", ev.target.id);
}

function allowDrop(e) {
  e.preventDefault();
} 

function drop(e) {
  e.preventDefault();
  var data = e.dataTransfer.getData("text");
  e.target.appendChild(document.getElementById(data));
}
&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-orgf6ae3d2" class="outline-3">
<h3 id="orgf6ae3d2"><span class="section-number-3">7.3</span> Event Attributes</h3>
<div class="outline-text-3" id="text-7-3">
<p>
Capturing phrase: DOM heirarchy up
Bubbling phrase (default): DOM heirarchy down
</p>

<p>
These objects have implemented EventTarget interface which can receive events and may have listeners:
</p>
<ul class="org-ul">
<li>element, document, window</li>
<li><a href="#org88b9832">XMLHttpRequest</a>, AudioNode, AudioContext and others</li>
</ul>
</div>

<div id="outline-container-orgf7cee32" class="outline-4">
<h4 id="orgf7cee32"><span class="section-number-4">7.3.1</span> Windows Event in body tag</h4>
<div class="outline-text-4" id="text-7-3-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">onafterprint, onbeforeprint</td>
<td class="org-left">only IE and FF</td>
</tr>

<tr>
<td class="org-left">onbeforeunload</td>
<td class="org-left">before page is closed/refreshed</td>
</tr>

<tr>
<td class="org-left">onunload</td>
<td class="org-left">after page is closed/refreshed</td>
</tr>

<tr>
<td class="org-left">onhashchange</td>
<td class="org-left">when URL hash is changed</td>
</tr>

<tr>
<td class="org-left">onload</td>
<td class="org-left">when an object is loaded:</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">body, frame, frameset, iframe,</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">img, link, script, style</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Not run when it's loaded from cache</td>
</tr>

<tr>
<td class="org-left">onpageshow</td>
<td class="org-left">similar to onload but always triggers</td>
</tr>

<tr>
<td class="org-left">onpagehide</td>
<td class="org-left">similar to onunload but onunload event causes</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">the page to not be cached.</td>
</tr>

<tr>
<td class="org-left">onresize</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org07e230b" class="outline-4">
<h4 id="org07e230b"><span class="section-number-4">7.3.2</span> Form Event Attributes</h4>
<div class="outline-text-4" id="text-7-3-2">
<p>
Also can be applied on almost all elements.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">oncontextmenu</td>
<td class="org-left">right click to bring context menu</td>
</tr>

<tr>
<td class="org-left">onreset</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">onsearch</td>
<td class="org-left">&lt;input type="search" onsearch=""&gt;. IE and FF not supported</td>
</tr>

<tr>
<td class="org-left">onselect</td>
<td class="org-left">when text is selected in &lt;input type="text"&gt; or &lt;textarea&gt;</td>
</tr>

<tr>
<td class="org-left">onblur</td>
<td class="org-left">leave a form field. opposite of onfocus</td>
</tr>

<tr>
<td class="org-left">onfocus</td>
<td class="org-left">opposite of onblur</td>
</tr>

<tr>
<td class="org-left">onfocusin</td>
<td class="org-left">similar to onfocus but bubbles. FF not supported</td>
</tr>

<tr>
<td class="org-left">onfocusout</td>
<td class="org-left">similar to onblur but bubbles.FF not supported</td>
</tr>

<tr>
<td class="org-left">onchange</td>
<td class="org-left">oninput and lose focus. also works on &lt;select&gt; and &lt;keygen&gt;</td>
</tr>

<tr>
<td class="org-left">oninput</td>
<td class="org-left">not working on &lt;select&gt; and &lt;keygen&gt;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org7e554d3" class="outline-4">
<h4 id="org7e554d3"><span class="section-number-4">7.3.3</span> Mouse Events, Clipboard Events, Keyboard Events</h4>
<div class="outline-text-4" id="text-7-3-3">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">ondblclick</td>
<td class="org-left">double click</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">ondragstart</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">ondrag</td>
<td class="org-left">being dragged</td>
</tr>

<tr>
<td class="org-left">ondragend</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">ondragenter</td>
<td class="org-left">when dragged element enters the drop target</td>
</tr>

<tr>
<td class="org-left">ondragover</td>
<td class="org-left">over the drop target</td>
</tr>

<tr>
<td class="org-left">ondragleave</td>
<td class="org-left">leave the drop target</td>
</tr>

<tr>
<td class="org-left">ondrop</td>
<td class="org-left">is dropped on the drop target</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">onscroll</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">onwheel</td>
<td class="org-left">only Chrome and FF</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">oncopy</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">oncut</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">onpaste</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">onmousedown</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">onmouseenter</td>
<td class="org-left">when move into child element</td>
</tr>

<tr>
<td class="org-left">onmouseleave</td>
<td class="org-left">when moving out of the element (not its children)</td>
</tr>

<tr>
<td class="org-left">onmousemove</td>
<td class="org-left">when moving inside an element</td>
</tr>

<tr>
<td class="org-left">onmouseover</td>
<td class="org-left">when onto this element</td>
</tr>

<tr>
<td class="org-left">onmouseout</td>
<td class="org-left">when moving out of the element and its children</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">onkeydown</td>
<td class="org-left">evens are in order. works for all keys</td>
</tr>

<tr>
<td class="org-left">onkeypress</td>
<td class="org-left">Some keys are not fired: C, A, S, ESC, etc.</td>
</tr>

<tr>
<td class="org-left">onkeyup</td>
<td class="org-left">when releasing a key</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orge4a8118" class="outline-4">
<h4 id="orge4a8118"><span class="section-number-4">7.3.4</span> Media Events</h4>
<div class="outline-text-4" id="text-7-3-4">
<p>
Elements: audio, img, embed, object, video
Events in order:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">onloadstart</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">ondurationchange</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">onloadedmetadata</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">onloadeddata</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">onprogress</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">oncanplay</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">oncanplaytrhough</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgbe7fb4a" class="outline-4">
<h4 id="orgbe7fb4a"><span class="section-number-4">7.3.5</span> Animation Events</h4>
<div class="outline-text-4" id="text-7-3-5">
<p>
Refer to CSS @keyframes.
animationstart
animationend
animationiteration :: when animaiton repeats
</p>
</div>
</div>

<div id="outline-container-orga777701" class="outline-4">
<h4 id="orga777701"><span class="section-number-4">7.3.6</span> Transition Event</h4>
<div class="outline-text-4" id="text-7-3-6">
<p>
transitionend
</p>
</div>
</div>

<div id="outline-container-org13c4bc9" class="outline-4">
<h4 id="org13c4bc9"><span class="section-number-4">7.3.7</span> Misc events</h4>
<div class="outline-text-4" id="text-7-3-7">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">onerror</td>
<td class="org-left">when an error occurs while loading an external file: &lt;img&gt;</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-orgcc9a046" class="outline-3">
<h3 id="orgcc9a046"><span class="section-number-3">7.4</span> Canvas</h3>
</div>
<div id="outline-container-org649f07b" class="outline-3">
<h3 id="org649f07b"><span class="section-number-3">7.5</span> Tags, HTML5 Elements</h3>
<div class="outline-text-3" id="text-7-5">
</div>
<div id="outline-container-orgce028d6" class="outline-4">
<h4 id="orgce028d6"><span class="section-number-4">7.5.1</span> HTML Tags</h4>
<div class="outline-text-4" id="text-7-5-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Tag</th>
<th scope="col" class="org-left">Usage</th>
<th scope="col" class="org-left">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">a</td>
<td class="org-left">download="filename"</td>
<td class="org-left">force download</td>
</tr>

<tr>
<td class="org-left">abbr</td>
<td class="org-left">title="World Health Organization"</td>
<td class="org-left">abbreviation WHO</td>
</tr>

<tr>
<td class="org-left">address</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">author or owner (not just address) of a document</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">or an article. display:block, italic author</td>
</tr>

<tr>
<td class="org-left">base</td>
<td class="org-left">href,target</td>
<td class="org-left">base url and target for &lt;a&gt; tags</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">article</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">affect outline</td>
</tr>

<tr>
<td class="org-left">aside</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">section</td>
<td class="org-left">headline tag is required</td>
<td class="org-left">affect outline</td>
</tr>

<tr>
<td class="org-left">main</td>
<td class="org-left">Use it once</td>
<td class="org-left">not descendant of other tags</td>
</tr>

<tr>
<td class="org-left">nav</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">affect outline</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">cite</td>
<td class="org-left">&lt;cite&gt;U of T Professor&lt;/cite&gt;</td>
<td class="org-left">wrap a person's title</td>
</tr>

<tr>
<td class="org-left">dfn</td>
<td class="org-left">&lt;dfn&gt;HTML&lt;/dfn&gt; is &#x2026;</td>
<td class="org-left">A term to be defined</td>
</tr>

<tr>
<td class="org-left">mark</td>
<td class="org-left">highlight text</td>
<td class="org-left">background yellow and text in black</td>
</tr>

<tr>
<td class="org-left">s</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">text-decoration: line-through</td>
</tr>

<tr>
<td class="org-left">q</td>
<td class="org-left">&lt;q cite="abc.com"&gt;Build&lt;/q&gt;</td>
<td class="org-left">Double quotes</td>
</tr>

<tr>
<td class="org-left">ruby</td>
<td class="org-left">&lt;ruby&gt;a &lt;rt&gt;sound&lt;/rt&gt;&lt;/ruby&gt;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">wbr</td>
<td class="org-left">&lt;wbr&gt;alongword&lt;/wbr&gt;</td>
<td class="org-left">the word will not be broken for line break</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">meter</td>
<td class="org-left">min,max,high,low,optimum</td>
<td class="org-left">value</td>
</tr>

<tr>
<td class="org-left">progress</td>
<td class="org-left">max, value</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">colgrup,</td>
<td class="org-left">specify styles and span for</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">col</td>
<td class="org-left">columns in a table</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">iframe</td>
<td class="org-left">srcdoc=""</td>
<td class="org-left">IE &amp; Edge not supported. Repalce double quote with &amp;quot;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">sandbox=""</td>
<td class="org-left">empty to apply all restrictions</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">e.g. allow-forms allow-same-origin</td>
</tr>

<tr>
<td class="org-left">input</td>
<td class="org-left">autocomplete="on or off"</td>
<td class="org-left">default on. turn off for a specific field</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">autofocus=""</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">formmethod="get or post"</td>
<td class="org-left">overwrite &lt;form&gt; type="submit, image"</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">formaction="another.php"</td>
<td class="org-left">overwrite &lt;form&gt; type="submit, image"</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">formenctype="multipart/form-data"</td>
<td class="org-left">overwrite &lt;form&gt; type="submit, image"</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">formtarget="_blank"</td>
<td class="org-left">overwrite &lt;form&gt; type="submit, image"</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">min="1" max="1979-12-31"</td>
<td class="org-left">for type="date" or type="number"</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">multiple</td>
<td class="org-left">for type="file"</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">pattern="regex"</td>
<td class="org-left">for type=text,date,search,url,tel,email,password</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">escape " in regex with \x22</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">placeholder="hint"</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">step="3"</td>
<td class="org-left">-3,0,3,6 can be accepted. type="number"</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">type=email, url</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">required</td>
<td class="org-left">no in IE</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">type="range" min max</td>
<td class="org-left">slide control</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">type="search"</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">disabled="disabled"</td>
<td class="org-left">not selectable, editable and not submitted</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">readonly="readonly"</td>
<td class="org-left">selectable, not editable and get submitted</td>
</tr>

<tr>
<td class="org-left">samp</td>
<td class="org-left">sample computer output</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">code</td>
<td class="org-left">monospace</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">kbd</td>
<td class="org-left">monospace</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">var</td>
<td class="org-left">variable name</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">li</td>
<td class="org-left">value="100"</td>
<td class="org-left">increment by 1</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
&lt;header&gt;
&lt;nav&gt;
&lt;section&gt;
&lt;aside&gt;
&lt;article&gt;
&lt;footer&gt;
</p>
</div>
</div>

<div id="outline-container-org0a49548" class="outline-4">
<h4 id="org0a49548"><span class="section-number-4">7.5.2</span> &lt;picture&gt;, &lt;img srcset sizes&gt;</h4>
<div class="outline-text-4" id="text-7-5-2">
</div>
<div id="outline-container-orgc8c4d59" class="outline-5">
<h5 id="orgc8c4d59"><span class="section-number-5">7.5.2.1</span> <a id="org36aa389">html:img:srcset</a> <a id="org1b1c640">html:img:sizes</a></h5>
<div class="outline-text-5" id="text-7-5-2-1">
<p>
IE 11 doesn't support srcset and sizes
The srcset attribute (without sizes) is used to serve larger—but otherwise identical—image sources to high resolution displays only. 
</p>

<p>
When x is used in <code>srcset</code>, <code>sizes</code> cannot be set.
&lt;img srcset="examples/images/image-384.jpg 1x, examples/images/image-768.jpg 2x" alt="…"&gt;
</p>

<p>
<code>w</code> in <code>srcset</code> is the actual image's width.
</p>

<p>
<code>sizes</code> attribute is the width of slot the image will fill when the media condition is true. If the image should take a third of the viewport, then sizes="33.3vw". The <code>srcset</code> which has the closest <code>w</code> that matches the chosen <code>sizes</code> will serve.
</p>

<p>
In order to test img with srcset and sizes, you need to open InCognito and resize the window size not choosing a simulated device.
</p>

<pre class="example">
&lt;img
src="examples/images/fallback.jpg"
sizes="(min-width: 40em) 80vw, 100vw"
srcset="examples/images/medium.jpg 375w,
        examples/images/large.jpg 480w,
        examples/images/extralarge.jpg 768w"
alt="…"&gt;

// make sure img tag is responsive
img {
  max-width:100%;
  height:auto;
}
</pre>
</div>
</div>

<div id="outline-container-org6a0c465" class="outline-5">
<h5 id="org6a0c465"><span class="section-number-5">7.5.2.2</span> <a id="org965daec">html:picture</a></h5>
<div class="outline-text-5" id="text-7-5-2-2">
<p>
Used when you need explicit control over which source is shown at set viewport sizes. Except IE 11 and below
</p>
<pre class="example">
&lt;picture&gt;
 &lt;source srcset="a.jpg" media="(min-width: 600px)"&gt;
 &lt;source srcset="b.jpg" media="(min-width: 500px)"&gt; 
 &lt;source srcset="fallback.jpg"&gt;
 &lt;img src="fallback.jpg" alt="one alt"&gt;
&lt;/picture&gt;

// This is called art direction
&lt;picture&gt;
  &lt;source media="(min-width: 800px)"
      sizes="100vw"
      srcset="cropped-for-wide-screens--large.jpg 1600w,
              cropped-for-wide-screens--small.jpg 800w" /&gt;
  &lt;source media="(min-width: 600px)"
      sizes="100vw"
      srcset="full-image-for-standard-screens--large.jpg 1200w,
              full-image-for-standard-screens--small.jpg  600w" /&gt;
  &lt;img
    src="zoomed-in-for-small-screens--small.jpg"
    srcset="zoomed-in-for-small-screens--large.jpg 800w,
            zoomed-in-for-small-screens--small.jpg 400w" alt="" /&gt;
&lt;/picture&gt;

&lt;picture&gt;
    &lt;source srcset='paul_irish.jxr' type='image/vnd.ms-photo'&gt;
    &lt;source srcset='paul_irish.jp2' type='image/jp2'&gt;
    &lt;source srcset='paul_irish.webp' type='image/webp'&gt;
    &lt;img src='paul_irish.jpg' alt='paul'&gt;
&lt;/picture&gt;
</pre>
</div>
</div>

<div id="outline-container-org2dc1de6" class="outline-5">
<h5 id="org2dc1de6"><span class="section-number-5">7.5.2.3</span> srcset and sizes calculation</h5>
<div class="outline-text-5" id="text-7-5-2-3">
<p>
small is 500x100, medium is 1000x200, and large is 2000x400
Device with screen width of 320px and 1x display (non-retina)
Then chooses the one that is closest to 1
500  / 320 = 1.5625
1000 / 320 = 3.125
2000 / 320 = 6.25
</p>

<pre class="example">
&lt;img src="small.jpg" srcset="medium.jpg 1000w, large.jpg 2000w"&gt;
</pre>

<p>
By default sizes="100vw", which is 100% viewport (320px in the above example)
Extra media query can be added 
</p>
<pre class="example">
sizes="(max-width: 300px) 100vw, 300px"
</pre>

<p>
Which means if media query matches, use 100vw. If not match, use 300px
</p>

<p>
Responsive image which takes 100% width. Define the largest width image first
This is the wordpress way.
</p>
<pre class="example">
&lt;img src="medium.jpg" width="1000" height="200" 
     srcset="large.jpg 2000w, small.jpg 500w"
     sizes="(max-width: 1000px) 100vw, 1000px"&gt;
// make sure img tag is responsive
img {
  max-width:100%;
  height:auto;
}
</pre>

<pre class="example">
&lt;picture&gt;
  &lt;source media="(max-width: 799px)" srcset="elva-480w-close-portrait.jpg"&gt;
  &lt;source media="(min-width: 800px)" srcset="elva-800w.jpg"&gt;
  &lt;img src="elva-800w.jpg" alt="Chris standing up holding his daughter Elva"&gt;
&lt;/picture&gt;
</pre>

<p>
CSS fallback
</p>
<pre class="example">
&lt;img srcset="
  examples/images/image-384.jpg 1x, 
  examples/images/image-768.jpg 2x
" alt="…"&gt;

.img {
  background-image: url(examples/images/image-384.jpg); 
}
@media 
  (-webkit-min-device-pixel-ratio: 2), 
  (min-resolution: 192dpi) { 
  .img {
    background-image: url(examples/images/image-768.jpg);
  }
}

/* 1.25 dpr */
@media 
(-webkit-min-device-pixel-ratio: 1.25), 
(min-resolution: 120dpi){ 
    /* Retina-specific stuff here */
}

/* 1.3 dpr */
@media 
(-webkit-min-device-pixel-ratio: 1.3), 
(min-resolution: 124.8dpi){ 
    /* Retina-specific stuff here */
}

/* 1.5 dpr */
@media 
(-webkit-min-device-pixel-ratio: 1.5), 
(min-resolution: 144dpi){ 
    /* Retina-specific stuff here */
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org4a04059" class="outline-4">
<h4 id="org4a04059"><span class="section-number-4">7.5.3</span> Term/name in a list</h4>
<div class="outline-text-4" id="text-7-5-3">
<pre class="example">
&lt;dl&gt;
  &lt;dt&gt;Term #1&lt;/dt&gt;
  &lt;dd&gt;Description of Term #1&lt;/dd&gt;
  &lt;dt&gt;Term #2&lt;/dt&gt;
  &lt;dd&gt;Description of Term #2&lt;/dd&gt;
&lt;/dl&gt;
</pre>
</div>
</div>

<div id="outline-container-orge8d9563" class="outline-4">
<h4 id="orge8d9563"><span class="section-number-4">7.5.4</span> video <a id="orgc76bf9c">html:video</a></h4>
<div class="outline-text-4" id="text-7-5-4">
<p>
MP4 is the most compatible video format. Uses H.264 video codec and AAC audio codec.
WebM is Google for HTML5. Uses VP8 video codec and Vorbis audio codec. Doesn't support in iOS, Safari nor old IE.
FLV is Flash only. Uses H.263 video codec and MP3 audio codec.
</p>

<p>
autoplay is turned off on iOS mobile &lt; v10
</p>
<pre class="example">
&lt;video autoplay muted loop id="myVideo"&gt;
  &lt;source src="rain.mp4" type="video/mp4"&gt;
&lt;/video&gt;
</pre>
</div>

<div id="outline-container-orgf4ea73f" class="outline-5">
<h5 id="orgf4ea73f"><span class="section-number-5">7.5.4.1</span> Attribute preload</h5>
<div class="outline-text-5" id="text-7-5-4-1">
<dl class="org-dl">
<dt>metadata</dt><dd>dimensions, track list, duration</dd>
<dt>auto</dt><dd>load entire video. Setting to auto is not guaranteed as some browsers force it to be metadata or none.</dd>
<dt>(no term)</dt><dd>none</dd>
</dl>

<p>
Video resource starts to be fetched after DOMContentLoaded and window.load event will be fired when the entire resource is completely fetched.
</p>

<p>
<a href="https://developers.google.com/web/fundamentals/media/fast-playback-with-video-preload">https://developers.google.com/web/fundamentals/media/fast-playback-with-video-preload</a>
Use <a href="#org45f4a2b">html:link:rel:preload</a>
<a id="org95f1fcb">html:preload video</a>
</p>

<p>
Preload full small media files &lt; 5mb
</p>
<pre class="example">
&lt;link rel="preload" as="video" href="https://cdn.com/small-file.mp4"&gt;

&lt;video id="video" controls&gt;&lt;/video&gt;

&lt;script&gt;
  // Later on, after some condition has been met, set video source to the
  // preloaded video URL.
  video.src = 'https://cdn.com/small-file.mp4';
  video.play().then(_ =&gt; {
    // If preloaded video URL was already cached, playback started immediately.
  });
&lt;/script&gt;
</pre>

<p>
Preload the first segment use <a href="https://developers.google.com/web/fundamentals/media/mse/basics">Media Source Extensions JavaScript API</a>
</p>
<pre class="example">
&lt;link rel="preload" as="fetch" href="https://cdn.com/file_1.webm"&gt;

&lt;video id="video" controls&gt;&lt;/video&gt;

&lt;script&gt;
  const mediaSource = new MediaSource();
  video.src = URL.createObjectURL(mediaSource);
  mediaSource.addEventListener('sourceopen', sourceOpen, { once: true });

  function sourceOpen() {
    URL.revokeObjectURL(video.src);
    const sourceBuffer = mediaSource.addSourceBuffer('video/webm; codecs="vp09.00.10.08"');

    // If video is preloaded already, fetch will return immediately a response
    // from the browser cache (memory cache). Otherwise, it will perform a
    // regular network fetch.
    fetch('https://cdn.com/file_1.webm')
    .then(response =&gt; response.arrayBuffer())
    .then(data =&gt; {
      // Append the data into the new sourceBuffer.
      sourceBuffer.appendBuffer(data);
      // TODO: Fetch file_2.webm when user starts playing video.
    })
    .catch(error =&gt; {
      // TODO: Show "Video is not available" message to user.
    });
  }
&lt;/script&gt;
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3b84a8c" class="outline-3">
<h3 id="org3b84a8c"><span class="section-number-3">7.6</span> Meta</h3>
<div class="outline-text-3" id="text-7-6">
</div>
<div id="outline-container-orga7120c9" class="outline-4">
<h4 id="orga7120c9"><span class="section-number-4">7.6.1</span> Meta Refresh (redirect)</h4>
<div class="outline-text-4" id="text-7-6-1">
<pre class="example">
&lt;meta http-equiv="refresh" content="0;URL='http://abc.com'" /&gt;
// "0" means zero second.
</pre>
</div>
</div>

<div id="outline-container-org059791d" class="outline-4">
<h4 id="org059791d"><span class="section-number-4">7.6.2</span> Open Graph Protocol <a id="org52237ac">html:og</a></h4>
<div class="outline-text-4" id="text-7-6-2">
<p>
<a href="http://ogp.me/">http://ogp.me/</a>
Required properties for every page
</p>
<ul class="org-ul">
<li>og:title</li>
<li id="og:type">article, video, video.movie, etc. Refer to <a href="http://ogp.me/#types">ogp types</a></li>
<li>og:image</li>
<li>og:url</li>
</ul>

<p>
&lt;meta property="og:title" content="" /&gt;
</p>

<p>
<a href="https://developers.google.com/web/fundamentals/discovery/social-discovery/">https://developers.google.com/web/fundamentals/discovery/social-discovery/</a>
</p>
</div>
</div>

<div id="outline-container-org03acf7f" class="outline-4">
<h4 id="org03acf7f"><span class="section-number-4">7.6.3</span> Twitter Cards</h4>
<div class="outline-text-4" id="text-7-6-3">
<p>
<a href="https://developer.twitter.com/en/docs/tweets/optimize-with-cards/guides/getting-started">https://developer.twitter.com/en/docs/tweets/optimize-with-cards/guides/getting-started</a>
</p>
</div>
</div>

<div id="outline-container-orgeef71cf" class="outline-4">
<h4 id="orgeef71cf"><span class="section-number-4">7.6.4</span> Address Bar <a id="org049adae">html:address bar</a></h4>
<div class="outline-text-4" id="text-7-6-4">
<p>
Hide Safari UI (URL address bar)
</p>
<pre class="example">
&lt;meta name="apple-mobile-web-app-capable" content="yes"&gt;
</pre>

<p>
By default, iOS web content displays under the top black status bar. 
Push the content to the top and make the status transparent
</p>
<pre class="example">
// default is black
&lt;meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"&gt;
</pre>

<p>
Address Bar color
</p>
<pre class="example">
&lt;meta name="theme-color" content="#4285f4"&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdbb9fc2" class="outline-3">
<h3 id="orgdbb9fc2"><span class="section-number-3">7.7</span> Header</h3>
<div class="outline-text-3" id="text-7-7">
<p>
All headers - <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers</a>
</p>

<p>
HTTP response header can be defined in html markup
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">meta</span> <span style="color: #dbdb95;">http-equiv</span>=<span style="color: #e67128;">"Content-Security-Policy"</span> <span style="color: #dbdb95;">content</span>=<span style="color: #e67128;">"default-src https://cdn.example.net; child-src 'none'; object-src 'none'"</span>&gt;
</pre>
</div>
</div>

<div id="outline-container-org5cd904c" class="outline-4">
<h4 id="org5cd904c"><span class="section-number-4">7.7.1</span> Age</h4>
<div class="outline-text-4" id="text-7-7-1">
<p>
A non-negative integer of seconds that the object (response) has been in a proxy cache (CDN, Varnish)
</p>
</div>
</div>

<div id="outline-container-orgf6096fd" class="outline-4">
<h4 id="orgf6096fd"><span class="section-number-4">7.7.2</span> Cache-Control, Pragma <a id="org754d9a8">header:cache-control</a></h4>
<div class="outline-text-4" id="text-7-7-2">
<p>
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control</a>
<a href="#org126b404">apache:mod_headers:cache</a>
</p>

<p>
<code>Pragma</code> is for legacy HTTP/1.0 where <code>Cache-Control HTTP/1.1</code> is not yet present. Only <code>Pragma:no-cache</code> or <code>Pragma:cache</code>
</p>

<p>
Directives
</p>
<dl class="org-dl">
<dt>must-revalidate</dt><dd>force to verify the status before using the cache and expired ones should not be used.</dd>

<dt>no-cache</dt><dd>browser has to always check Etag and makes a roundtrip request. If file in server is new, it will be downloaded.</dd>
<dt>no-store</dt><dd>no cache should be stored in request or response e.g. Go Back to previous page, the browser shows the browser cache version of the page</dd>

<dt>no-transform</dt><dd>No transformations or conversions should be made to the resource. The <code>Content-Encoding</code>, <code>Content-Range</code>, <code>Content-Type</code> headers must not be modified by a proxy. A non-transparent proxy might, for example, convert between image formats in order to save cache space or to reduce the amount of traffic on a slow link. The <code>no-transform</code> directive disallows this.</dd>

<dt>public</dt><dd>response can be cached in all devices. It's not necessary as max-age inidicates the response is cacheable.</dd>
<dt>private</dt><dd>response can be cached for a single user (user's browser) but not in shared cache (public CDN, Varnish or other intermediaries)</dd>
</dl>

<p>
proxy-revalidate
</p>

<dl class="org-dl">
<dt>max-age=&lt;seconds&gt;</dt><dd>refer to <a href="#orgafd6166">header:expires</a> If max-age is set in Cache-Control and Etag is set, then after max-age, client sends a request with If-None-Match: &lt;etag-value&gt; to server and if the Etag response doesn't change, server will return 304 Not Modified response and client will not download the file. The cache serves the same file for another max-age before checking Etag again.</dd>
</dl>
<p>
post-check=0, pre-check=0 :: (Discouraged) Old IE does not cache and always ask from server
</p>

<ul class="org-ul">
<li>Common usage
<dl class="org-dl">
<dt><code>public, max-age=2592000</code></dt><dd>Tells the <code>external</code> caching system e.g. Varnish not to make a call to the web server for this request until the max-age <a id="orgc4cf7dc">header:cache-control:public max-age</a></dd>
<dt><code>no-cache, must-revalidate, post-check=0, pre-check=0</code></dt><dd>no cache and always ask from server</dd>
</dl></li>
</ul>
</div>
</div>

<div id="outline-container-org8433bc1" class="outline-4">
<h4 id="org8433bc1"><span class="section-number-4">7.7.3</span> Expires <a id="orgafd6166">header:expires</a></h4>
<div class="outline-text-4" id="text-7-7-3">
<p>
When the response is considered stale. Set to 0 means the response is expired.
If Cache-Control has max-age or s-max-age, Expires is ignored.
</p>
</div>
</div>

<div id="outline-container-orgf32f233" class="outline-4">
<h4 id="orgf32f233"><span class="section-number-4">7.7.4</span> Content-Security-Policy (CSP) - response <a id="org6282ee7">header:content-security-policy</a></h4>
<div class="outline-text-4" id="text-7-7-4">
<p>
Content-Security-Policy is official name
</p>
<ul class="org-ul">
<li>X-Content-Security-Policy (Old Firefox and IE)</li>
<li>X-WebKit-CSP (Chrome and Safari)</li>
</ul>

<p>
<a href="https://developers.google.com/web/fundamentals/security/csp/">https://developers.google.com/web/fundamentals/security/csp/</a>
</p>

<p>
Use Content-Security-Policy-Report-Only instead of Content-Security-Policy to test first!
</p>

<p>
Specify whitelist
</p>
<pre class="example">
Content-Security-Policy: script-src 'self' https://apis.google.com https://host1.com https://host2.com
</pre>

<p>
default-src is any other non-defined directives' default
</p>

<p>
Define multiple directives, 'none' means whitelist nothing (block anything)
</p>
<pre class="example">
Content-Security-Policy: default-src https://cdn.example.net; child-src 'none'; object-src 'none'
</pre>

<p>
Wildcards can be used for scheme, port, or in the leftmost position of the hostname :: <code>*://*.example.com:*</code>
</p>

<p>
<code>data:</code> <code>http:</code> :: scheme
</p>
<pre class="example">
script-src * data: https://ssl.gstatic.com 'unsafe-inline' 'unsafe-eval';
</pre>

<p>
example.com :: any scheme and any port
</p>

<p>
'self' :: matches the current origin, but not its subdomains
'unsafe-inline' :: allow inline JavaScript and CSS.
'unsafe-eval' :: allo text-to-JavaScript mechanisms like eval.
</p>

<p>
By default, CSP bans inline script entirely if 'unsafe-inline', 'nonce-*' nor 'sha256-' is not used
</p>
<ul class="org-ul">
<li>scripts inside &lt;script&gt; tags</li>
<li>inline event handlers and <code>javascript:</code> URLs.</li>
</ul>

<p>
You will need to move content of script tags into an external file.
</p>
<pre class="example">
//  change this
&lt;script&gt;
  function doAmazingThings() {
    alert('YOU AM AMAZING!');
  }
&lt;/script&gt;
&lt;button onclick='doAmazingThings();'&gt;Am I amazing?&lt;/button&gt;

// To this
&lt;!-- amazing.html --&gt;
&lt;script src='amazing.js'&gt;&lt;/script&gt;
&lt;button id='amazing'&gt;Am I amazing?&lt;/button&gt;
// amazing.js
function doAmazingThings() {
  alert('YOU AM AMAZING!');
}
document.addEventListener('DOMContentReady', function () {
  document.getElementById('amazing')
    .addEventListener('click', doAmazingThings);
});
</pre>

<p>
report-uri directive tells the browser to POST JSON-formatted violation reports
</p>
<pre class="example">
Content-Security-Policy: default-src 'self'; ...; report-uri /my_amazing_csp_report_parser;
// example
{
  "csp-report": {
    "document-uri": "http://example.org/page.html",
    "referrer": "http://evil.example.com/",
    "blocked-uri": "http://evil.example.com/evil.js",
    "violated-directive": "script-src 'self' https://apis.google.com",
    "original-policy": "script-src 'self' https://apis.google.com; report-uri http://example.org/my_amazing_csp_report_parser"
  }
}
</pre>

<p>
Generate nonce value differently each time and insert it into any inline script, bash64
</p>
<pre class="example">
&lt;script nonce=EDNnf03nceIOfn39fn3e9h3sdfa&gt;
  //Some inline code I cant remove yet, but need to asap.
&lt;/script&gt;

Content-Security-Policy: script-src 'nonce-EDNnf03nceIOfn39fn3e9h3sdfa'
</pre>

<p>
Or use sha
</p>
<pre class="example">
&lt;script&gt;alert('Hello, world.');&lt;/script&gt;
Content-Security-Policy: script-src 'sha256-qznLcsROx4GACP2dm0UCKCzCG-HiZ1guq6ZZDob_Tng='
// calculate sha hash for each inline script
</pre>

<p>
To enable Google Analytics without 'unsafe-inline', move GA code in a js file and
</p>
<pre class="example">
Content-Security-Policy: script-src www.google-analytics.com; img-src www.google-analytics.com
</pre>

<p>
I've heard there's way other than 'unsafe-inline' for Google Tag Manager
</p>

<p>
referrer directive is like <a href="#org4761875">header:referrer-policy</a>
</p>
</div>
</div>

<div id="outline-container-org8cb7506" class="outline-4">
<h4 id="org8cb7506"><span class="section-number-4">7.7.5</span> X-Frame-Options</h4>
<div class="outline-text-4" id="text-7-7-5">
<p>
Whether the client can render the page in a &lt;frame&gt;, &lt;iframe&gt;, &lt;object&gt;.
</p>

<p>
DENY
SAMEORIGIN :: the page can only be displayed in a frame on the same origin as the page itself.
ALLOW-FROM uri :: Chrome doesn't support.
</p>
</div>
</div>

<div id="outline-container-org4191386" class="outline-4">
<h4 id="org4191386"><span class="section-number-4">7.7.6</span> X-Content-Type-Options - response</h4>
<div class="outline-text-4" id="text-7-7-6">
<dl class="org-dl">
<dt>Only one value</dt><dd><code>X-Content-Type-Options: nosniff</code></dd>
<dt>(no term)</dt><dd>It only applies to script and style</dd>
<dt>(no term)</dt><dd>Blocks a request if the requested type is
<ul class="org-ul">
<li><code>style</code> and MIME type is not "text/css"</li>
<li><code>script</code> and MIME type is not <a href="https://mimesniff.spec.whatwg.org/#javascript-mime-type">JavaScript MIME type</a></li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-orgf00f5f7" class="outline-4">
<h4 id="orgf00f5f7"><span class="section-number-4">7.7.7</span> X-XSS-Protection - response</h4>
<div class="outline-text-4" id="text-7-7-7">
<p>
Not supported in FireFox. Use Content-Security-Policy for modern browsers. This is used for older browsers.
</p>

<dl class="org-dl">
<dt>Disable XSS filtering</dt><dd><code>X-XSS-Protection: 0</code></dd>
<dt>Default, If XSS then the client will sanitize the page (remove the unsafe parts)</dt><dd><code>X-XSS-Protection: 1</code></dd>
<dt>Rather than sanitizing the page, the client will prevent rendering of the page if an attack is detected</dt><dd><code>X-XSS-Protection: 1; mode=block</code></dd>
<dt>Chrome only. If XSS is detected, the client will sanitize the page and report the violation. Same as report-uri in Content-Security-Policy</dt><dd><code>X-XSS-Protection: 1; report=&lt;reporting-uri&gt;</code></dd>
</dl>
</div>
</div>

<div id="outline-container-orgc9574ce" class="outline-4">
<h4 id="orgc9574ce"><span class="section-number-4">7.7.8</span> Referer :: request <a id="org32dba97">header:referer</a></h4>
</div>
<div id="outline-container-orgdbf58e7" class="outline-4">
<h4 id="orgdbf58e7"><span class="section-number-4">7.7.9</span> Referrer-Policy - response <a id="org4761875">header:referrer-policy</a></h4>
<div class="outline-text-4" id="text-7-7-9">
<p>
Only works for Chrome, FireFox and Opera
Controls how the client sends the Referer request header with requests that are made from your site. e.g. clicking on a link on your website and the link goes to either your website or other websites.
</p>

<p>
no-referrer-when-downgrade :: If no Referrer-Police is defined, clients should set to this. The url is sent as a referrer when the protocol security level stays the same HTTP-&gt;HTTP or HTTPS-&gt;HTTPS
</p>
<ul class="org-ul">
<li>source:<a href="http://a.ca/1/">http://a.ca/1/</a> Destination:<a href="http://b.com">http://b.com</a> Referer is <a href="http://a.ca/1/">http://a.ca/1/</a></li>
<li>source:<a href="http://a.ca/1/">http://a.ca/1/</a> Destination:<a href="https://b.com">https://b.com</a> Referer is <a href="http://a.ca/1">http://a.ca/1</a></li>
<li>source:<a href="https://a.ca/1/">https://a.ca/1/</a> Destination:<a href="http://b.com">http://b.com</a> Referer is NULL</li>
<li>source:<a href="https://a.ca/1/">https://a.ca/1/</a> Destination:<a href="http://a.ca/2/">http://a.ca/2/</a> Referer is NULL</li>
<li>source:<a href="https://a.ca/1/">https://a.ca/1/</a> Destination:<a href="https://a.ca/2/">https://a.ca/2/</a> Referer is <a href="https://a.ca/1/">https://a.ca/1/</a></li>
</ul>

<p>
no-referrer :: never set Referer header
</p>

<p>
same-origin :: only set Referer when the origin is the same.
</p>
<ul class="org-ul">
<li>source:<a href="https://a.ca/1/">https://a.ca/1/</a> Destination:<a href="https://a.ca/2/">https://a.ca/2/</a> Referer is <a href="https://a.ca/1/">https://a.ca/1/</a></li>
<li>source:<a href="https://a.ca/1/">https://a.ca/1/</a> Destination:<a href="http://a.ca/2/">http://a.ca/2/</a> Referer is NULL</li>
</ul>

<p>
origin :: always set the Referer header to the origin (domain) from which the request was made. Path information is stripped.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><a href="https://scotthelme.co.uk/blog1/">https://scotthelme.co.uk/blog1/</a></td>
<td class="org-left"><a href="https://scotthelme.co.uk/blog2/">https://scotthelme.co.uk/blog2/</a></td>
<td class="org-left"><a href="https://scotthelme.co.uk/">https://scotthelme.co.uk/</a></td>
</tr>

<tr>
<td class="org-left"><a href="https://scotthelme.co.uk/blog1/">https://scotthelme.co.uk/blog1/</a></td>
<td class="org-left"><a href="http://scotthelme.co.uk/blog2/">http://scotthelme.co.uk/blog2/</a></td>
<td class="org-left"><a href="https://scotthelme.co.uk/">https://scotthelme.co.uk/</a></td>
</tr>

<tr>
<td class="org-left"><a href="https://scotthelme.co.uk/blog1/">https://scotthelme.co.uk/blog1/</a></td>
<td class="org-left"><a href="http://example.com/">http://example.com/</a></td>
<td class="org-left"><a href="https://scotthelme.co.uk/">https://scotthelme.co.uk/</a></td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
strict-origin :: This value is similar to origin above but will not allow the secure origin to be sent on a HTTP request, only HTTPS.
</p>

<p>
origin-when-cross-origin :: The browser will send the full URL to requests to the same origin/domain but only send the origin when requests are cross-origin.
</p>

<p>
strict-origin-when-cross-origin :: Similar to origin-when-cross-origin above but will not allow any information to be sent when a scheme downgrade happens (the user is navigating from HTTPS to HTTP).
</p>

<p>
unsafe-url :: The browser will always send the full URL with any request to any origin.
</p>
</div>
</div>

<div id="outline-container-org7aaf9cd" class="outline-4">
<h4 id="org7aaf9cd"><span class="section-number-4">7.7.10</span> Strict-Transport-Security - response <a id="orgadd9f67">header:strict-transport-security</a></h4>
<div class="outline-text-4" id="text-7-7-10">
<p>
HSTS lets a website tell browsers that it should only be accessed using HTTPS. The first time your site is accessed using HTTPS and it returns the Strict-Transport-Security header, the browser records this information, so that future attempts to load the site using HTTP will automatically use HTTPS instead.
</p>

<p>
<code>Strict-Transport-Security: max-age=&lt;expire-time&gt;</code>
</p>
<dl class="org-dl">
<dt>max-age</dt><dd>The time, in seconds, that the browser should remember that a site is only to be accessed using HTTPS.</dd>
</dl>

<p>
<code>Strict-Transport-Security: max-age=&lt;expire-time&gt;; includeSubDomains</code>
</p>
<dl class="org-dl">
<dt>includeSubDomains Optional</dt><dd>If this optional parameter is specified, this rule applies to all of the site's subdomains as well.</dd>
</dl>

<p>
<code>Strict-Transport-Security: max-age=&lt;expire-time&gt;; preload</code>
</p>
<ul class="org-ul">
<li>preload is not recommended</li>
</ul>

<p>
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security#Preloading_Strict_Transport_Security">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security#Preloading_Strict_Transport_Security</a>
</p>
</div>
</div>

<div id="outline-container-org2e319c1" class="outline-4">
<h4 id="org2e319c1"><span class="section-number-4">7.7.11</span> Vary - response <a id="org4e2b21a">header:vary</a></h4>
<div class="outline-text-4" id="text-7-7-11">
<p>
Vary: User-Agent :: Tell caching servers to deliver a different cache for different User-Agent
Vary: * :: Tell caching servers to always deliver a refresh copy (all requests are uncacheable)
</p>
</div>
</div>

<div id="outline-container-orga7458ef" class="outline-4">
<h4 id="orga7458ef"><span class="section-number-4">7.7.12</span> Link <a href="#org3e4c698">html:link</a></h4>
<div class="outline-text-4" id="text-7-7-12">
<p>
Each link defined in HTML is separated by comma and values inside a link with attributes are delimited by ;
</p>
</div>

<div id="outline-container-orgc326bae" class="outline-5">
<h5 id="orgc326bae"><span class="section-number-5">7.7.12.1</span> <a href="#orge790135">html:hreflang</a></h5>
</div>
</div>
<div id="outline-container-orgbab4bf3" class="outline-4">
<h4 id="orgbab4bf3"><span class="section-number-4">7.7.13</span> Accept-CH - response <a id="org02c073f">header:accept-ch</a></h4>
<div class="outline-text-4" id="text-7-7-13">
<p>
<a href="https://www.smashingmagazine.com/2016/01/leaner-responsive-images-client-hints/">Client Hints</a> :: Tell browsers to give the following headers for following requests:
</p>
<ul class="org-ul">
<li>DPR</li>
<li>Viewport-Width</li>
<li id="Width">actual width of an image in real physical pixels</li>
<li id="Downlink">client max download speed</li>
<li id="Save-Data">boolean whether extra measures should be taken to reduce the payload</li>
</ul>

<p>
Initial page load has this in HTML
</p>
<pre class="example">
&lt;img src="flower.jpg" sizes="25vw"&gt;
</pre>

<p>
sizes attribute has to be set in order for the Width header to be sent. In the near future, the width attribute on the image element is likely to be included in the algorithm too, but for now, we’ll have to stick with sizes. The sizes attribute describes the layout and display size of the image.
</p>

<ul class="org-ul">
<li>Header Width is then perfectly calculated.</li>
<li>Header DPR saves x in srcset and thus saves some markup.</li>
<li id="The whole point is not to write srcset">deliver images which have approximate size</li>
<li>Use image server/proxy to deliver pin-point size picture
<ul class="org-ul">
<li>Base <code>http://example.com/image.jpg</code></li>
<li>Actual url in HTML <code>http://[key].lite.imgeng.in/http://example.com/image.jpg</code></li>
<li>Image server will deliver the images based on the CH request headers</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org6e71f2e" class="outline-4">
<h4 id="org6e71f2e"><span class="section-number-4">7.7.14</span> X-Powered-By</h4>
<div class="outline-text-4" id="text-7-7-14">
<p>
Remove it :: <a href="#org1bc0ad4">apache:mod_headers</a> <a href="#org69a58a1">php.ini:expose_php</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org5f8648c" class="outline-3">
<h3 id="org5f8648c"><span class="section-number-3">7.8</span> Cookie <a id="orgf00c58a">html:cookie</a></h3>
<div class="outline-text-3" id="text-7-8">
<p>
HTTP response header
</p>
<pre class="example">
Set-Cookie: &lt;name&gt;=&lt;value&gt;[; &lt;Max-Age&gt;=&lt;age&gt;]
[; expires=&lt;date&gt;][; domain=&lt;domain_name&gt;]
[; path=&lt;some_path&gt;][; secure][; HttpOnly]
</pre>

<dl class="org-dl">
<dt>httponly</dt><dd>client side script cannot access the cookie</dd>
<dt>secure</dt><dd>the client browser will prevent the transmission of a cookie over an unencrypted channel (non-https)</dd>
</dl>

<p>
Refer to setcookie, <a href="#orgbb189d5">php.ini:session:cookie_secure</a>, <a href="#org1bc0ad4">apache:mod_headers</a> for adding flags to cookies
</p>
</div>
</div>

<div id="outline-container-orgc9ae512" class="outline-3">
<h3 id="orgc9ae512"><span class="section-number-3">7.9</span> Email</h3>
<div class="outline-text-3" id="text-7-9">
</div>
<div id="outline-container-org94b4be7" class="outline-4">
<h4 id="org94b4be7"><span class="section-number-4">7.9.1</span> View email source on Outlook</h4>
<div class="outline-text-4" id="text-7-9-1">
<p>
Open the email, in Move tab under Message, Actions &gt; Other Actions &gt; View Source
</p>
</div>
</div>

<div id="outline-container-org4d95e0e" class="outline-4">
<h4 id="org4d95e0e"><span class="section-number-4">7.9.2</span> Doctype</h4>
<div class="outline-text-4" id="text-7-9-2">
<p>
<a href="https://litmus.com/community/templates">https://litmus.com/community/templates</a>
</p>
<pre class="example">
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
  &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
  &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;
  &lt;meta http-equiv="X-UA-Compatible" content="IE=edge" /&gt;
  &lt;meta name="robots" content="noindex, nofollow"&gt;
  &lt;link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'&gt;

  &lt;title&gt;Product Update Hybrid&lt;/title&gt;

  &lt;style type="text/css"&gt;
    @import url(https://fonts.googleapis.com/css?family=Montserrat);
    body, table, td, a{-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;}
    table, td{mso-table-lspace: 0pt; mso-table-rspace: 0pt;}
    img{border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; -ms-interpolation-mode: bicubic;}
    table{border-collapse: collapse !important;}
    body{font-family: 'Montserrat', Arial, sans-serif; height: 100% !important; margin: 0 !important; padding: 0 !important; width: 100% !important;}

    /* https://github.com/seanpowell/Email-Boilerplate */

    div[style*="margin: 16px 0;"] { margin:0 !important; }

    a[x-apple-data-detectors] {
      color: inherit !important;
      text-decoration: none !important;
      font-size: inherit !important;
      font-family: inherit !important;
      font-weight: inherit !important;
      line-height: inherit !important;
    }
  &lt;/style&gt;

  &lt;!--[if mso]&gt;
  &lt;style type="text/css"&gt;
    .body-text {
      font-family: Arial, sans-serif !important;
    }
  &lt;/style&gt;
  &lt;![endif]--&gt;

&lt;/head&gt;
</pre>

<p>
<a href="https://litmus.com/community/learning/24-how-to-code-a-responsive-email-from-scratch">https://litmus.com/community/learning/24-how-to-code-a-responsive-email-from-scratch</a>
Use XHTML 1.0 Transitional
</p>

<pre class="example">
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/&gt;
&lt;meta name="format-detection" content="telephone=no"&gt; 
&lt;meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=no;"&gt;
&lt;meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE" /&gt;

    &lt;title&gt;Page title&lt;/title&gt;

    &lt;style type="text/css"&gt; 
        @media screen and (max-width: 630px) {

        }
    &lt;/style&gt;


&lt;/head&gt;

&lt;body style="padding:0; margin:0"&gt;

&lt;table border="0" cellpadding="0" cellspacing="0" style="margin: 0; padding: 0" width="100%"&gt;
    &lt;tr&gt;
        &lt;td align="center" valign="top"&gt;

        &lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>

<p>
Style
</p>
<pre class="example">
&lt;style&gt;
  @import url(http://fonts.googleapis.com/css?family=Roboto:300); /*Calling our web font*/

  /* Some resets and issue fixes */
body, table, td, a{-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;}
      table, td{mso-table-lspace: 0pt; mso-table-rspace: 0pt;}
      img{border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; -ms-interpolation-mode: bicubic;}
      table{border-collapse: collapse !important;}
      body{font-family: 'Montserrat', Arial, sans-serif; height: 100% !important; margin: 0 !important; padding: 0 !important; width: 100% !important;}

  #outlook a{ padding:0; }
  .ReadMsgBody{ width:100%; }
  .ExternalClass{ width:100%; }
  .backgroundTable{ margin:0 auto; padding:0; width:100%; !important; }
  .ExternalClass *{ line-height:115%; }
  /* End reset */

  /* These are our tablet/medium screen media queries */
  @media screen and (max-width:630px){

    /* Display block allows us to stack elements */
    *[class="mobile-column"]{ display:block; }
    /* Some more stacking elements */
    *[class="mob-column"]{ float:none !important; width:100% !important; }
    /* Hide stuff */
    *[class="hide"]{ display:none !important; }
    /* This sets elements to 100% width and fixes the height issues too, a god send */
    *[class="100p"]{ width:100% !important; height:auto !important; }
    /* For the 2x2 stack */
    *[class="condensed"]{ padding-bottom:40px !important; display:block; }
    /* Centers content on mobile */
    *[class="center"]{ text-align:center !important; width:100% !important; height:auto !important; }
    /* 100percent width section with 20px padding */
    *[class="100pad"]{ width:100% !important; padding:20px; }
    /* 100percent width section with 20px padding left &amp; right */
    *[class="100padleftright"]{ width:100% !important; padding:0 20px 0 20px; }
    /* 100percent width section with 20px padding top &amp; bottom */
    *[class="100padtopbottom"]{ width:100% !important; padding:20px 0px 20px 0px; }

  }
&lt;/style&gt;
</pre>
</div>
</div>

<div id="outline-container-org23ab4a6" class="outline-4">
<h4 id="org23ab4a6"><span class="section-number-4">7.9.3</span> Guidelines</h4>
<div class="outline-text-4" id="text-7-9-3">
<p>
<a href="https://www.campaignmonitor.com/dev-resources/guides/mobile">Campaign Monitor Mobile Design Guide</a>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Element</th>
<th scope="col" class="org-left">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">table</td>
<td class="org-left">always assign align, width,border, cellpadding, cellspacing</td>
</tr>

<tr>
<td class="org-left">tr</td>
<td class="org-left">&lt;tr style="padding:0;margin:0;line-height:0;" height="15"&gt;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&lt;td&gt;&amp;nbsp;&lt;/td&gt;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&lt;/tr&gt; // empty row with height</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">td</td>
<td class="org-left">Wrap text in td</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Attribute</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">style</td>
<td class="org-left">use <code>display: none!important;</code></td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Inline text full width separator. Change attribute size and style height when needed.
</p>
<pre class="example">
&lt;hr noshade color="#FFFFFF" width="100%" size="1" 
    style="padding:0; margin:8px 0 8px 0; border:none; width:100%; height: 1px; color:#FFFFFF; background-color: #FFFFFF" /&gt;
</pre>

<pre class="example">
&lt;h2 style="font-family: 'Montserrat', Arial, sans-serif; font-size:20px; line-height:26px; color:#222222; font-weight:bold; text-transform:uppercase; padding:0 20px; margin:0;"&gt;You've been invited to this years event&lt;/h2&gt;
</pre>
</div>
</div>

<div id="outline-container-orgf30ed0f" class="outline-4">
<h4 id="orgf30ed0f"><span class="section-number-4">7.9.4</span> Responsive</h4>
<div class="outline-text-4" id="text-7-9-4">
<pre class="example">
&lt;style&gt;
.sectionContainer {
  background-color: #ffffff;
  padding-right:10px !important;
  padding-left:10px !important;
}
.sectionTable {
  background-color: #ffffff;
}
@media only screen and (max-width:640px) {
.sectionTable {
  max-width:640px !important;
  width:100% !important;
}
}
@media only screen and (max-width:480px) {
.sectionTable {
  max-width:480px !important;
  width:100% !important;
}
.sectionContent .s480-w0 {
  display:none !important;
}
} 
&lt;/style&gt;

&lt;table&gt;
  &lt;tr&gt;
    &lt;td class="sectionContainer"&gt;
      &lt;table border="0" cellpadding="0" cellspacing="0" width="640" class="sectionTable"&gt;
        &lt;tr style="padding:0;margin:0;line-height:0;" height="15"&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
        &lt;tr&gt;
          &lt;td align="center" valign="middle" style="background-color:#004663;color:#ffffff;margin:0;font-size:24px;font-family:Georgia;font-weight:normal;"&gt;
            Section #1  
          &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr style="padding:0;margin:0;line-height:0;" height="10"&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
        &lt;tr&gt;
          &lt;td align="center" valign="top"&gt;

          &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/table&gt;
    &lt;td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
</pre>
</div>
</div>

<div id="outline-container-org79cf3dd" class="outline-4">
<h4 id="org79cf3dd"><span class="section-number-4">7.9.5</span> Even 3 columns</h4>
<div class="outline-text-4" id="text-7-9-5">
<pre class="example">
&lt;td align="center" valign="top" style="font-size:0;"&gt;
  &lt;!--[if (gte mso 9)|(IE)]&gt;
  &lt;table align="center" border="0" cellspacing="0" cellpadding="0" width="600"&gt;
    &lt;tr&gt;
      &lt;td align="left" valign="top" width="190"&gt;
  &lt;![endif]--&gt;
  &lt;div style="display:inline-block; max-width:33.3333%; min-width:190px; vertical-align:top; width:100%;" class="mobile-wrapper"&gt;

    &lt;table align="left" border="0" cellpadding="0" cellspacing="0" width="100%" style="max-width:190px;" class="max-width"&gt;
      &lt;tbody&gt;&lt;tr&gt;
        &lt;td align="center" valign="top" style="font-family: Open Sans, Helvetica, Arial, sans-serif; padding-top: 25px;"&gt;

          &lt;img src="icon-shield.png" width="50" height="50" border="0" style="display: block;"&gt;

          &lt;h3 style="font-size: 18px; line-height: 24px;"&gt;Gmail&lt;/h3&gt;
          &lt;p style="color: #999999; font-size: 14px; line-height: 20px;"&gt;
            Mandeville carneiro robbins goas ross kelly ragan rodriguez stig jordan hodgekiss merlin yeaman
            &lt;br&gt;&lt;br&gt;
            &lt;a href="http://litmus.com" target="_blank" style="text-decoration: none; color: #75b6c9;"&gt;Read more →&lt;/a&gt;
          &lt;/p&gt;

        &lt;/td&gt;
      &lt;/tr&gt;
      &lt;/tbody&gt;&lt;/table&gt;
  &lt;/div&gt;
  &lt;!--[if (gte mso 9)|(IE)]&gt;
  &lt;/td&gt;
  &lt;td width="15" style="font-size: 1px;"&gt;&amp;nbsp;&lt;/td&gt;
  &lt;td align="left" valign="top" width="190"&gt;
  &lt;![endif]--&gt;
  &lt;div style="display:inline-block; max-width:33.3333%; min-width:190px; vertical-align:top; width:100%;" class="mobile-wrapper"&gt;
    &lt;table align="center" border="0" cellpadding="0" cellspacing="0" width="100%" style="max-width:190px;" class="max-width"&gt;
      &lt;tbody&gt;&lt;tr&gt;
        &lt;td align="center" valign="top" style="font-family: Open Sans, Helvetica, Arial, sans-serif; padding-top: 25px;"&gt;

          &lt;img src="icon-cloud-lock.png" width="50" height="50" border="0" style="display: block;"&gt;

          &lt;h3 style="font-size: 18px; line-height: 24px;"&gt;Outlook&lt;/h3&gt;
          &lt;p style="color: #999999; font-size: 14px; line-height: 20px;"&gt;
            Mandeville carneiro robbins goas ross kelly ragan rodriguez stig jordan hodgekiss merlin yeaman
            &lt;br&gt;&lt;br&gt;
            &lt;a href="http://litmus.com" target="_blank" style="text-decoration: none; color: #75b6c9;"&gt;Read more →&lt;/a&gt;
          &lt;/p&gt;

        &lt;/td&gt;
      &lt;/tr&gt;
      &lt;/tbody&gt;&lt;/table&gt;
  &lt;/div&gt;
  &lt;!--[if (gte mso 9)|(IE)]&gt;
  &lt;/td&gt;
  &lt;td width="15" style="font-size: 1px;"&gt;&amp;nbsp;&lt;/td&gt;
  &lt;td align="left" valign="top" width="190"&gt;
  &lt;![endif]--&gt;
  &lt;div style="display:inline-block; max-width:33.3333%; min-width:190px; vertical-align:top; width:100%;" class="mobile-wrapper"&gt;
    &lt;table align="right" border="0" cellpadding="0" cellspacing="0" width="100%" style="max-width:190px; float: right;" class="max-width"&gt;
      &lt;tbody&gt;&lt;tr&gt;
        &lt;td align="center" valign="top" style="font-family: Open Sans, Helvetica, Arial, sans-serif; padding-top: 25px;"&gt;

          &lt;img src="icon-key.png" width="50" height="50" border="0" style="display: block;"&gt;

          &lt;h3 style="font-size: 18px; line-height: 24px;"&gt;Lotus&lt;/h3&gt;
          &lt;p style="color: #999999; font-size: 14px; line-height: 20px;"&gt;
            Mandeville carneiro robbins goas ross kelly ragan rodriguez stig jordan hodgekiss merlin yeaman
            &lt;br&gt;&lt;br&gt;
            &lt;a href="http://litmus.com" target="_blank" style="text-decoration: none; color: #75b6c9;"&gt;Read more →&lt;/a&gt;
          &lt;/p&gt;

        &lt;/td&gt;
      &lt;/tr&gt;
      &lt;/tbody&gt;&lt;/table&gt;
  &lt;/div&gt;
  &lt;!--[if (gte mso 9)|(IE)]&gt;
  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;/table&gt;
  &lt;![endif]--&gt;
&lt;/td&gt;
</pre>
</div>
</div>

<div id="outline-container-orgb238bc7" class="outline-4">
<h4 id="orgb238bc7"><span class="section-number-4">7.9.6</span> My even 2 columns</h4>
<div class="outline-text-4" id="text-7-9-6">
<pre class="example">
@media only screen and (max-width:480px){
      td[class="articleBlockRightColumn"]{
        text-align:center !important;
      }      
      td[class="articleBlockLeftColumn"],
      td[class="articleBlockRightColumn"]{
        display:block !important;
        width:100% !important;
        padding-bottom:10px;
      }
}

$html_default = [
  'left'  =&gt; 'articleBlockLeftColumn',
  'right' =&gt; 'articleBlockRightColumn',
  'ad'    =&gt; 'bigAds',
];
?&gt;
&lt;table border="0" cellpadding="0" cellspacing="0" width="100%"&gt;
  &lt;tr&gt;
    &lt;td align="left" valign="top" width="50%" class="&lt;?php echo $html['left']; ?&gt;"&gt;
      &lt;table border="0" cellpadding="0" cellspacing="0" width="100%"&gt;
        &lt;tr&gt;
          &lt;td align="left" valign="top"&gt;
            &lt;h3&gt;
              &lt;a href="&lt;?php echo $item['url']; ?&gt;" target="_blank" style="text-decoration: none;"&gt;
                &lt;?php
                print theme('nc_custom_templates_inline_native_article',
                  ['article' =&gt; $item]
                );
                echo $item['title'];?&gt;&lt;/a&gt;
            &lt;/h3&gt;
            &lt;p&gt;&lt;?php echo $item['summary']; ?&gt; &lt;?php
              if ($readmore['inline']) {
                print theme(
                  'nc_custom_templates_inline_read_more',
                  ['item' =&gt; $item,
                   'options'=&gt; $readmore
                  ]);
              }
               ?&gt;&lt;/p&gt;
            &lt;?php
              if (!$readmore['inline']) {
                print theme(
                  'nc_custom_templates_inline_read_more',
                  ['item' =&gt; $item,
                   'options'=&gt; $readmore
                  ]);
              }
            ?&gt;
          &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/table&gt;
    &lt;/td&gt;

    &lt;td align="right" valign="top" width="50%" class="&lt;?php echo $html['right']; ?&gt;"&gt;
      &lt;table border="0" cellpadding="0" cellspacing="0" width="100%"&gt;
        &lt;tr&gt;
          &lt;td align="right" valign="top" class="&lt;?php echo $html['ad']; ?&gt;"&gt;
            &lt;a href="&lt;?php echo $dfp['a']; ?&gt;"&gt;
              &lt;img src="&lt;?php echo $dfp['img']; ?&gt;" /&gt;
            &lt;/a&gt;
          &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/table&gt;
    &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
</pre>
</div>
</div>

<div id="outline-container-org0a55c37" class="outline-4">
<h4 id="org0a55c37"><span class="section-number-4">7.9.7</span> My template</h4>
<div class="outline-text-4" id="text-7-9-7">
<p>
Presets
</p>
<pre class="example">
&lt;?php
$_css_body = '-webkit-text-size-adjust:100%; -ms-text-size-adjust:100%;width:100% !important; margin:0;padding:0';
$_css_preheader = 'display: none; font-size: 1px; line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;';

$_css_section_column = 'background-color:#ffffff;padding-right:10px !important;padding-left:10px !important;';
// It's ok to set td with padding-right and left if td will not display:block when it's in mobile
// If td will display:block, then wrap content with &lt;table&gt;&lt;tr&gt;&lt;td style="padding: 1em"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt; to set padding.
$_css_section_table = 'max-width:640px;';
$_css_section_top = 'padding-top:15px;';

 $_css_text_small = 'font-size:10px;color:#555555;font-family:Arial,Helvetica,sans-serif !important;';
  $_css_p = 'font-size:16px;line-height: 20px !important;margin: 1em 0;font-family: Arial, Helvetica, sans-serif;';
  $_css_h1 = 'font-family:Arial,Helvetica,sans-serif !important; font-size:30px; line-height:36px; font-weight:bold; color:#ffffff;padding:0; margin:0;';
  $_css_h2 = 'font-family:Arial,Helvetica,sans-serif !important;font-size:20px;line-height:26px; font-weight:bold; color:#ffffff;padding:0; margin:0;';
  $_css_h3 = 'font-family:Arial,Helvetica,sans-serif !important;font-size:16px;line-height:22px;font-weight:bold;color:#333333;padding:0; margin:0;';
  $_css_h3_a = 'font-family:Arial,Helvetica,sans-serif !important;font-size:16px;line-height:22px;font-weight:bold;color:#333333;padding:0; margin:0;text-decoration: none;';
  $_css_h4 = 'font-family:Arial,Helvetica,sans-serif !important;font-size:14px;line-height:20px;font-weight:bold;color:#333333;padding:0; margin:0;';
  $_css_h4_a = 'font-family:Arial,Helvetica,sans-serif !important;font-size:14px;line-height:20px;font-weight:bold;color:#333333;padding:0; margin:0;text-decoration: none;';
?&gt;
&lt;style type="text/css"&gt;
td[class="articleBlockFullColumn"] {
    padding-bottom:10px !important;
}

@media screen and (max-width:640px) {

}

@media only screen and (max-width: 480px) {
p {
    padding-left: 0px !important;
    padding-right: 10px !important;
}
td[class="mobilecenter"] {
  text-align: center !important;
}
td[class="articleImg"],
td[class="articleDiv"] {
      display:none;
}

}
&lt;/style&gt;
</pre>

<p>
Global
</p>
<pre class="example">
&lt;body style="margin:0;padding:0;"&gt;
&lt;table width="100%" height="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#F1F1F1"&gt;
  &lt;tr&gt;
    &lt;td width="100%" valign="top" align="center"&gt;
      &lt;div style="&lt;?php echo $_css_preheader; ?&gt;"&gt;&lt;?php echo $_preview_text; ?&gt;&lt;/div&gt;
      &lt;center&gt;
        &lt;table width="100%" height="100%" cellpadding="0" cellspacing="0" border="0"&gt;
          &lt;tr&gt;&lt;td&gt;Section 1&lt;/td&gt;&lt;/tr&gt;
        &lt;/table&gt;
      &lt;/center&gt;
    &lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
&lt;/body&gt;
</pre>

<p>
Per section
</p>
<pre class="example">
&lt;tr&gt;
  &lt;td align="center" valign="top" style="&lt;?php echo $_css_section_column; ?&gt;"&gt;
    &lt;table border="0" cellpadding="0" cellspacing="0" width="100%" style="&lt;?php echo $_css_section_table; ?&gt;"&gt;
      &lt;tr&gt;
        &lt;td align="center" valign="top" style="&lt;?php echo $_css_section_top; ?&gt;"&gt;
          &lt;table border="0" cellpadding="0" cellspacing="0" width="100%"&gt;
            &lt;?php // section title ?&gt;
            &lt;tr&gt;
              &lt;td align="left" valign="top"&gt;
                &lt;h2 style="&lt;?php echo $_css_section_title; ?&gt;"&gt;Press Releases&lt;/h2&gt;
                &lt;hr noshade color="#eb1f2a" width="100%" size="1"
                    style="padding:0; margin:8px 0 8px 0; border:none; width:100%; height: 1px; color:#eb1f2a; background-color: #eb1f2a" /&gt;
              &lt;/td&gt;
            &lt;/tr&gt;
            &lt;?php // section content ?&gt;
            &lt;tr&gt;
              &lt;td align="left" valign="top"&gt;
                &lt;?php for ($i = 0; $i &lt; count($_item); $i++) {
                              $content_item = $_item[$i];
                              print theme(
                                'nc_custom_templates_component_full_width',
                                [
                                  'item'     =&gt; $content_item,
                'readmore' =&gt; $readmore,
                'html'     =&gt; $full_width_html,
                ]
                );
                }
                ?&gt;
              &lt;/td&gt;
            &lt;/tr&gt;
          &lt;/table&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;
  &lt;/td&gt;
&lt;/tr&gt;
</pre>

<p>
Section content
</p>
<pre class="example">
&lt;?php
/**
 * Created by PhpStorm.
 * User: Li Li
 * Date: 8/3/2017 2:28 PM
 *
 * $html =&gt; [
 *   'row' =&gt; 'articleBlockFullColumn',
 *   'img' =&gt; [
 * 'class' =&gt; 'articleImg'],
 *   'ad' =&gt; 'bigAds',
 * ]
 */

$html_default = [
  'row' =&gt; 'articleBlockFullColumn',
  'h3' =&gt; 'color:#333333;font-weight:bold;font-size:20px;font-family:Arial,Helvetica,sans-serif !important;',
  'h3 a' =&gt; 'text-decoration: none;color:#333333',
        'p' =&gt; 'line-height: 20px !important;margin: 1em 0;font-family: Arial, Helvetica, sans-serif;',
  'img' =&gt; [
    'enable'  =&gt; 1, // To show article thumbnail if it has one?
    'class'   =&gt; 'articleImg',
    'w'       =&gt; 140,
    'h'       =&gt; 105,
    'style'   =&gt; 'width:140px; height:105px; vertical-align:top;',
    ],
  'div' =&gt; [
    'class' =&gt; 'articleDiv',
    'w' =&gt; 15,
  ],
];
?&gt;

&lt;table border="0" cellpadding="0" cellspacing="0" width="100%"&gt;
  &lt;tr&gt;
    &lt;td align="left" valign="top" width="100%" class="&lt;?php echo $html['row']; ?&gt;"&gt;
      &lt;table border="0" cellpadding="0" cellspacing="0" width="100%"&gt;
        &lt;tr&gt;
          &lt;?php if (!empty($item['image']) &amp;&amp; $html['img']['enable']): ?&gt;
            &lt;td class="&lt;?php echo $html['img']['class']; ?&gt;" align="center" valign="top"&gt;
              &lt;a
                href="&lt;?php echo $item['url']; ?&gt;"
                target="_blank"&gt;&lt;img alt=""
                                     src="&lt;?php echo $item['image']; ?&gt;"
                                     width="&lt;?php echo $html['img']['w']; ?&gt;"
                                     height="&lt;?php echo $html['img']['h']; ?&gt;"
                                     style="&lt;?php echo $html['img']['style']; ?&gt;"/&gt;&lt;/a&gt;
            &lt;/td&gt;
            &lt;td class="&lt;?php echo $html['div']['class']; ?&gt;"
                width="&lt;?php echo $html['div']['w']; ?&gt;"&gt;&amp;nbsp;&lt;/td&gt;
          &lt;?php endif; ?&gt;

          &lt;td align="left" valign="top"&gt;
            &lt;h3 style="&lt;?php echo $html['h3']; ?&gt;"&gt;&lt;a
                href="&lt;?php echo $item['url']; ?&gt;"
                target="_blank"
                style="&lt;?php echo $html['h3 a']; ?&gt;"&gt;&lt;?php
                print theme('nc_custom_templates_inline_native_article',
                  ['article' =&gt; $item]
                );
                echo $item['title'];
                ?&gt;&lt;/a&gt;&lt;/h3&gt;
            &lt;p style="&lt;?php echo $html['p']; ?&gt;"&gt;&lt;?php echo $item['summary']; ?&gt; &lt;?php
              if ($readmore['inline']) {
                print theme(
                  'nc_custom_templates_inline_read_more',
                  ['item' =&gt; $item,
                   'options'=&gt; $readmore
                  ]);
              }
              ?&gt;
            &lt;/p&gt;
            &lt;?php
            if (!$readmore['inline']) {
              print theme(
                'nc_custom_templates_inline_read_more',
                ['item' =&gt; $item,
                 'options'=&gt; $readmore
                ]);
            }
            ?&gt;
          &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/table&gt;
    &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
</pre>

<p>
Table with 1 col wrapper
</p>
<pre class="example">
$h_default = [
        'spacer' =&gt; '', // '' no spacer, top or bottom
        'content' =&gt; '',
        'align' =&gt; ['','right'], // first one is table then td
        'valign' =&gt; ['','top'],
        'class' =&gt; ['','mobilecenter'],
        'style' =&gt; ['',''],
];
?&gt;
&lt;table border="0" cellpadding="0" cellspacing="0" width="100%"
        &lt;?php if ($h['align'][0]) {echo ' align="'.$h['align'][0].'"'; } ?&gt;
        &lt;?php if ($h['valign'][0]) {echo ' valign="'.$h['valign'][0].'"'; } ?&gt;
        &lt;?php if ($h['class'][0]) {echo ' class="'.$h['class'][0].'"'; } ?&gt;
        &lt;?php if ($h['style'][0]) {echo ' style="'.$h['style'][0].'"'; } ?&gt;&gt;
        &lt;?php if (isset($h['spacer']) &amp;&amp; $h['spacer'] == 'top'): ?&gt;
                &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
        &lt;?php endif; ?&gt;
        &lt;tr&gt;
                &lt;td &lt;?php if ($h['align'][1]) {echo ' align="'.$h['align'][1].'"'; } ?&gt;
                        &lt;?php if ($h['valign'][1]) {echo ' valign="'.$h['valign'][1].'"'; } ?&gt;
                        &lt;?php if ($h['class'][1]) {echo ' class="'.$h['class'][1].'"'; } ?&gt;
                        &lt;?php if ($h['style'][1]) {echo ' style="'.$h['style'][1].'"'; } ?&gt;&gt;&lt;?php echo $h['content']; ?&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;?php if (isset($h['spacer']) &amp;&amp; $h['spacer'] == 'bottom'): ?&gt;
                &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
        &lt;?php endif; ?&gt;
&lt;/table&gt;
</pre>

<p>
Table with 2 cols
</p>
<pre class="example">
$_partnership_left  = theme(
  'nc_custom_templates_component_col_1',
  [
    'h' =&gt; [
      'spacer'  =&gt; '',
// '' no spacer, top or bottom
      'content' =&gt; "&lt;a href='${_dfp_txt_1['href']}' target='_blank' style='ouline:none;display:inline-block;'&gt;&lt;img src='${_dfp_txt_1['img']}' alt='' style='${_dfp_txt_1['img_style']}'&gt;&lt;/a&gt;",
      'align'   =&gt; [ '', 'center' ],
// first one is table then td
      'valign'  =&gt; [ '', 'top' ],
      'class'   =&gt; [ '', 'mobilecenter' ],
      'style'   =&gt; [ '', 'padding: 0.4em' ],
    ],
  ]
);
$_partnership_right = theme(
  'nc_custom_templates_component_col_1',
  [
    'h' =&gt; [
      'spacer'  =&gt; '',
// '' no spacer, top or bottom
      'content' =&gt; "&lt;h3 style='${_css_h3}'&gt;&lt;a href='${_dfp_txt_1['href']}' target='_blank' style='${_css_h3_a}'&gt;${_dfp_txt_1['title']}&lt;/a&gt;&lt;/h3&gt;${_dfp_txt_1['content']}",
      'align'   =&gt; [ '', 'left' ],
// first one is table then td
      'valign'  =&gt; [ '', 'top' ],
      'class'   =&gt; [ '', '' ],
      'style'   =&gt; [ '', 'padding: 0.4em' ],
    ],
  ]
);
print theme(
  'nc_custom_templates_component_col_2',
  [
    'h' =&gt; [
      'table'   =&gt; [
        'align'  =&gt; '',
        'valign' =&gt; '',
        'class'  =&gt; '',
        'style'  =&gt; '',
      ],
      'spacer'  =&gt; '',
      'fixed'   =&gt; FALSE,
      'content' =&gt; [
        $_partnership_left,
        $_partnership_right
      ],
      'align'   =&gt; [ 'center', 'left' ],
      'valign'  =&gt; [ 'top', 'top' ],
      'class'   =&gt; [
        'partnershipBlockContentLeft',
        'partnershipBlockContentRight'
      ],
      'style'   =&gt; [ '', '' ], // padding: 0.4em
    ],
  ]
);
</pre>
</div>
</div>

<div id="outline-container-org8fa21d4" class="outline-4">
<h4 id="org8fa21d4"><span class="section-number-4">7.9.8</span> Hybrid Responsive Design</h4>
<div class="outline-text-4" id="text-7-9-8">
<p>
Orignal responsive design: parent table width:100%, child table.responsive-table width:600 and use media queries
</p>
<pre class="example">
&lt;table border="0" cellpadding="0" cellspacing="0" width="100%"&gt; 
    &lt;tr&gt;
        &lt;td bgcolor="#00a9f7" align="center"&gt;
            &lt;table border="0" cellpadding="0" cellspacing="0" width="600" class="responsive-table"&gt;                
                &lt;tr&gt;
                    &lt;td align="center" valign="top" style="padding: 40px 0px 40px 0px;"&gt;
                        &lt;!-- IMAGE --&gt;
                        &lt;img alt="Example" src="http://placehold.it/600x300" width="600" style="display: block;" border="0" class="responsive-image"&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td align="center" valign="top" style="padding: 0px 10px 20px 10px;"&gt;
                        &lt;!-- HEADLINE --&gt;
                        &lt;p style="color: #ffffff; font-family: sans-serif; font-size: 24px; font-weight: bold; line-height: 28px; margin: 0;"&gt;Announcing Some News&lt;/p&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td align="center" valign="top" style="padding: 0px 10px 60px 10px;"&gt;
                        &lt;!-- COPY --&gt;
                        &lt;p style="color: #b5e2f7; font-family: sans-serif; font-size: 16px; font-weight: normal; line-height: 24px; margin: 0;"&gt;Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim.&lt;/p&gt;
                    &lt;/td&gt;
                &lt;/tr&gt; 
            &lt;/table&gt;
        &lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;

@media screen and (max-width: 600px) {
  .responsive-table {
    display: block;
    width: 100% !important;
  }

  .responsive-image {
    height: auto;
    max-width: 100% !important;
  }
}
</pre>

<p>
Hybrid or spongy design: parent table width:100%, child table width:100% with max-width:600px, for IE, wrap another table width:600 around the child table.
</p>
<pre class="example">
&lt;table border="0" cellpadding="0" cellspacing="0" width="100%"&gt; 
    &lt;tr&gt;
        &lt;td bgcolor="#00a9f7" align="center"&gt;
            &lt;!--[if (gte mso 9)|(IE)]&gt;
            &lt;table align="center" border="0" cellspacing="0" cellpadding="0" width="600"&gt;
            &lt;tr&gt;
            &lt;td align="center" valign="top" width="600"&gt;
            &lt;![endif]--&gt;
            &lt;table border="0" cellpadding="0" cellspacing="0" width="100%" style="max-width: 600px;" &gt;                
                &lt;tr&gt;
                    &lt;td align="center" valign="top" style="padding: 40px 0px 40px 0px;"&gt;
                        &lt;!-- IMAGE --&gt;
                        &lt;img alt="Example" src="http://placehold.it/600x300" width="600" style="display: block; width: 100%; max-width: 100%;" border="0"&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td align="center" valign="top" style="padding: 0px 10px 20px 10px;"&gt;
                        &lt;!-- HEADLINE --&gt;
                        &lt;p style="color: #ffffff; font-family: sans-serif; font-size: 24px; font-weight: bold; line-height: 28px; margin: 0;"&gt;Announcing Some News&lt;/p&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td align="center" valign="top" style="padding: 0px 10px 60px 10px;"&gt;
                        &lt;!-- COPY --&gt;
                        &lt;p style="color: #b5e2f7; font-family: sans-serif; font-size: 16px; font-weight: normal; line-height: 24px; margin: 0;"&gt;Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim.&lt;/p&gt;
                    &lt;/td&gt;
                &lt;/tr&gt; 
            &lt;/table&gt;
            &lt;!--[if (gte mso 9)|(IE)]&gt;
            &lt;/td&gt;
            &lt;/tr&gt;
            &lt;/table&gt;
            &lt;![endif]--&gt;
        &lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;
</pre>

<p>
Fab Four Technique to create responsive emails without media queries
</p>
<ul class="org-ul">
<li>If width is greater than max-width, max-width wins</li>
<li>If min-width is greater than width or max-width, min-width wins.</li>
<li><a href="http://emails.hteumeuleu.fr/wp-content/uploads/2016/02/the-fab-four.html">Demo</a></li>
</ul>

<p>
So the following sets the box to 480px
</p>
<pre class="example">
.box {
    width:320px;
    min-width:480px;
    max-width:160px;
}
</pre>

<p>
Use calc() to set width. The following creates 2 columns that will stack and grow below 480px
</p>
<pre class="example">
.block {
    display:inline-block;
    min-width:50%;
    max-width:100%;
    width:calc((480px — 100%) * 480);
}
</pre>

<p>
calc() is only not supported in latest Outlook for Windows, OWA both Office 365 and Outlook.com, and Yahoo webmail and iOS/Android apps. In these cases
</p>
<pre class="example">
.block {
    display:inline-block;
    min-width:240px;
    width:50%;
    max-width:100%;
    min-width:calc(50%);
    width:calc(480px * 480 — 100% * 480);
}
</pre>

<p>
Final version with fixes for OWA and WebKit Prefixes
</p>
<pre class="example">
.block {
    display:inline-block;
    min-width:240px;
    width:50%;
    max-width:100%;
    min-width:-webkit-calc(50%);
    min-width:calc(50%);
    width:-webkit-calc(230400px — 48000%);
    width:calc(230400px — 48000%);
}
</pre>
</div>
</div>

<div id="outline-container-org3086008" class="outline-4">
<h4 id="org3086008"><span class="section-number-4">7.9.9</span> Inbox Preview</h4>
<div class="outline-text-4" id="text-7-9-9">
<p>
Litmus :: covers the most email clients and used by MailChimp and Campaign Monitor. Plus plan has Live Edit and Live Preivew
Email on Acid :: Basic plan covers unlimited tests. Fewer Android devices are supported compared with Litmus.
</p>
</div>
</div>

<div id="outline-container-orge956c2b" class="outline-4">
<h4 id="orge956c2b"><span class="section-number-4">7.9.10</span> Gmail Image Caching</h4>
<div class="outline-text-4" id="text-7-9-10">
<p>
Images are downloaded at proxy server and serve those images from that proxy instead. One download only. Affects stats of opens and geolocation.
Gmail Web and Gmail iOS and Android apps.
</p>
</div>
</div>

<div id="outline-container-orgded2fc8" class="outline-4">
<h4 id="orgded2fc8"><span class="section-number-4">7.9.11</span> CSS and HTML Support across Devices <a id="org5d592a3">email:css:support</a></h4>
<div class="outline-text-4" id="text-7-9-11">
<p>
<a href="https://www.campaignmonitor.com/css/">https://www.campaignmonitor.com/css/</a>
<a href="https://templates.mailchimp.com/resources/email-client-css-support/">https://templates.mailchimp.com/resources/email-client-css-support/</a>
</p>

<p>
Gmail Web doesn't support <code>&lt;style&gt;</code> in <code>&lt;body&gt;</code> but supports <code>&lt;style&gt;</code> in <code>&lt;head&gt;</code>
</p>

<p>
Gmail removes support for CSS attribute selectors.
</p>

<dl class="org-dl">
<dt><code>&lt;link&gt;</code> within <code>&lt;head&gt;</code> or <code>&lt;body&gt;</code></dt><dd>not support, browsers Outlook.com, Yahoo!, Gmail, AOL</dd>
</dl>

<p>
<code>&lt;style&gt;</code> in <code>&lt;head&gt;</code> is not supported in:
</p>
<ul class="org-ul">
<li>Gmail Android app IMAP, Gmail mobile webmail, Yahoo! Mail Android app</li>
<li>AOL Mail</li>
</ul>

<p>
<code>@media</code> :: not supported in
</p>
<dl class="org-dl">
<dt>Desktop</dt><dd>Outlook 2007-16, Windows 10 Mail</dd>
<dt>Mobile</dt><dd>Gmail Android app IMAP, Gmail mobile wemail but supports in Gmail Android app, Gmail iOS app</dd>
<dt>Webmail</dt><dd>AOL Mail, Outlook.com</dd>
</dl>

<p>
<code>@font-face</code> :: only supported in
</p>
<dl class="org-dl">
<dt>Desktop</dt><dd>Outlook 2000-03, Apply Mail 10, Outlook for Mac</dd>
<dt>Mobile</dt><dd>Android Mail 4.4.4, iOS 10 Mail, iOS 11 Mail, Outlook Android app, Sparrow</dd>
<dt>Webmail</dt><dd>AOL Mail</dd>
</dl>

<p>
<code>background-image</code> :: not supported in
</p>
<ul class="org-ul">
<li>Outlook 2007-16</li>
<li>Outlook Express</li>
<li>Windows 10 Mail</li>
<li>Windows Live Mail</li>
<li>Android 4.2.2 Mail</li>
<li>Gmail Android app IMAP</li>
<li>Windows Phone 8 Mail</li>
<li>Yahoo! Mail Android app</li>
</ul>

<p>
Email client safe fonts
</p>
<ul class="org-ul">
<li>Courier</li>
<li>Courier New</li>
<li>Georgia</li>
<li>Times</li>
<li>Times New Roman</li>
</ul>

<p>
Refer to <a href="#orga7649c3">css:font-face:web safe fonts</a> for checking font coverage and font stack
</p>

<p>
Target iPhone 5 and above <a href="#orgfec3bca">mjml:tag:mj-hero:sample1</a>
</p>
<div class="org-src-container">
<pre class="src src-css"><span style="color: #23d7d7;">@media</span> all and (max-width: 414px) {
  table[style*=<span style="color: #e67128;">"color:#123456;"</span>] { <span style="color: #ffad29; font-weight: bold;">width</span>:100%;}
  td[style*=<span style="color: #e67128;">"font-family:Khand, Helvetica, sans-serif, Arial;font-size:18px;line-height:28px;color:#666465;"</span>] {
    <span style="color: #ffad29; font-weight: bold;">color</span>: <span style="color: #ffffff; background-color: #000000;">#000000</span> <span style="color: #23d7d7;">!important</span>;
    <span style="color: #ffad29; font-weight: bold;">background-color</span>: <span style="color: #000000; background-color: #ffffff;">rgba(255,255,255,0.5)</span> <span style="color: #23d7d7;">!important</span>;
  }
  <span style="color: #00ede1; font-weight: bold;">tr.spacer-above-button </span>{
     <span style="color: #ffad29; font-weight: bold;">height</span>:50px;
  }
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-css"><span style="color: #23d7d7;">@media</span> screen and (max-device-width: 320px) and (max-device-height:
568px) { <span style="color: #74af68;">/* </span><span style="color: #74af68;">iPhone 8 (Zoom View) </span><span style="color: #74af68;">*/</span> }

<span style="color: #23d7d7;">@media</span> screen and (max-device-width: 375px) and (max-device-height:
667px) { <span style="color: #74af68;">/* </span><span style="color: #74af68;">iPhone 8 (Standard View) and iPhone 8 Plus (Zoom View) </span><span style="color: #74af68;">*/</span> }

<span style="color: #23d7d7;">@media</span> screen and (max-device-width: 414px) and (max-device-height:
776px) { <span style="color: #74af68;">/* </span><span style="color: #74af68;">iPhone 8 Plus (Standard View) </span><span style="color: #74af68;">*/</span> }
</pre>
</div>

<p>
Prevent auto-scaling on iOS 11
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">meta</span> <span style="color: #dbdb95;">name</span>=<span style="color: #e67128;">"x-apple-disable-message-reformatting"</span>&gt;
</pre>
</div>

<p>
Target Samsung Mail
</p>
<div class="org-src-container">
<pre class="src src-css"><span style="color: #00ede1; font-weight: bold;">#MessageViewBody .yourclassnamehere </span>{ }
</pre>
</div>
</div>
</div>

<div id="outline-container-org059c952" class="outline-4">
<h4 id="org059c952"><span class="section-number-4">7.9.12</span> MJML</h4>
<div class="outline-text-4" id="text-7-9-12">
</div>
<div id="outline-container-org3a8c8cc" class="outline-5">
<h5 id="org3a8c8cc"><span class="section-number-5">7.9.12.1</span> Install &amp; Basics</h5>
<div class="outline-text-5" id="text-7-9-12-1">
<pre class="example">
npm install mjml

// you can delete node_modules folder and reinstall to get the latest version

./node_modules/.bin/mjml -V

// To avoid typing ./node_modules/bin/
export PATH="$PATH:./node_modules/.bin"

// mjml version (e.g. 3.3.5)
mjml -V

// one time output html
mjml input.mjml

// one time output to a specific file
mjml input.mjml -o my-email.html

// watch a file
mjml -w input.mjml

// convert v3 .mjml to v4 .mjml
mjml -m index.mjml indexv4.mjml

// minify html output
node_modules/.bin/mjml path/to/index.mjml -o path/to/index.html --config.minify
</pre>

<p>
Since v4, install Windows App <a href="https://mjmlio.github.io/mjml-app/">https://mjmlio.github.io/mjml-app/</a> to get WYSIWYG experience.
</p>

<p>
Install Litmus Chrome Extension and follow the instructions to tweak the extension setting. Login to Litmus.com and open a local .html file.
</p>

<p>
Install Atom packages to edit .mjml in Atom: linter-mjml and mjml-preview
</p>

<p>
Tags or mj-elements styling
</p>
<ul class="org-ul">
<li>a limited set of attributes can be used</li>
<li>For now, must repeat for each tag the style you want to apply on it.</li>
<li>Another way is to create custom component, sub-classing a standard one and have your styles defined by default.</li>
</ul>

<p>
<a href="https://mjml.io/try-it-live/templates/basic">Sample 1</a>
</p>
</div>
</div>

<div id="outline-container-org8a99ba9" class="outline-5">
<h5 id="org8a99ba9"><span class="section-number-5">7.9.12.2</span> mjml <a id="org856bb3c">mjml:tag:mjml</a></h5>
<div class="outline-text-5" id="text-7-9-12-2">
<p>
Contains <a href="#org648c99a">mjml:tag:mj-head</a> and <a href="#org79f8739">mjml:tag:mj-body</a>
</p>

<p>
By default, display the mobile version for Outlook.com. To force the desktop layout on Outlook.com
</p>
<pre class="example">
&lt;mjml owa="desktop"&gt;
</pre>
</div>
</div>

<div id="outline-container-orgce5002d" class="outline-5">
<h5 id="orgce5002d"><span class="section-number-5">7.9.12.3</span> mj-head <a id="org648c99a">mjml:tag:mj-head</a></h5>
<div class="outline-text-5" id="text-7-9-12-3">
<p>
Contains styles and meta elements. To insert custom head elements, registerMJHeadElement(&lt;string&gt; name, &lt;funciton&gt; handler) api from mjml-core
</p>
</div>
</div>

<div id="outline-container-org2fbd23d" class="outline-5">
<h5 id="org2fbd23d"><span class="section-number-5">7.9.12.4</span> mj-head &gt; mj-preview <a id="orgb7708b2">mjml:tag:mj-preview</a></h5>
<div class="outline-text-5" id="text-7-9-12-4">
<p>
no other attributes
</p>
<pre class="example">
&lt;mj-head&gt;
    &lt;mj-preview&gt;Hello MJML&lt;/mj-preview&gt;
&lt;/mj-head&gt;
</pre>
</div>
</div>

<div id="outline-container-org53d0bf2" class="outline-5">
<h5 id="org53d0bf2"><span class="section-number-5">7.9.12.5</span> mj-head &gt; mj-attributes <a id="org80be0dd">mjml:tag:mj-attributes</a></h5>
<div class="outline-text-5" id="text-7-9-12-5">
<p>
mj-all sets default attributes for every component inside your MJML document
Order: inline attributes &gt; classes &gt; default mj-attributes &gt; defaultMJMLDefinition
</p>

<pre class="example">
&lt;mjml&gt;
  &lt;mj-head&gt;
    &lt;mj-attributes&gt;
      &lt;mj-text padding="0" /&gt;
      &lt;mj-class name="blue" color="blue" /&gt;
      &lt;mj-class name="big" font-size="20px" /&gt;
      &lt;mj-all font-family="Arial" /&gt;
      &lt;mj-all padding="0px"&gt;&lt;/mj-all&gt;
    &lt;/mj-attributes&gt;
  &lt;/mj-head&gt;
  &lt;mj-body&gt;
    &lt;mj-container&gt;
      &lt;mj-section&gt;
        &lt;mj-column&gt;
          &lt;mj-text mj-class="blue big"&gt;
            Hello World!
          &lt;/mj-text&gt;
        &lt;/mj-column&gt;
      &lt;/mj-section&gt;
    &lt;/mj-container&gt;
  &lt;/mj-body&gt;
&lt;/mjml&gt;
</pre>
</div>
</div>

<div id="outline-container-orgb42baef" class="outline-5">
<h5 id="orgb42baef"><span class="section-number-5">7.9.12.6</span> mj-head &gt; mj-breakpoint</h5>
<div class="outline-text-5" id="text-7-9-12-6">
<p>
On which breakpoint the layout should go desktop/mobile. Default is 480px
</p>

<pre class="example">
&lt;mjml&gt;
  &lt;mj-head&gt;
    &lt;mj-breakpoint width="320px" /&gt;
  &lt;/mj-head&gt;
  &lt;mj-body&gt;
    &lt;mj-section&gt;
      &lt;mj-column&gt;
        &lt;mj-text&gt;
          Hello World!
        &lt;/mj-text&gt;
      &lt;/mj-column&gt;
    &lt;/mj-section&gt;
  &lt;/mj-body&gt;
&lt;/mjml&gt;
</pre>
</div>
</div>

<div id="outline-container-org14cfeb7" class="outline-5">
<h5 id="org14cfeb7"><span class="section-number-5">7.9.12.7</span> mj-head &gt; mj-style <a id="orgd3069dc">mjml:tag:mj-style</a></h5>
<div class="outline-text-5" id="text-7-9-12-7">
<dl class="org-dl">
<dt>Apply styles to generated or native HTML elements</dt><dd><code>mj-style</code></dd>
<dt>Set class in native HTML elememts</dt><dd><code>inline="inline"</code></dd>
<dt>(no term)</dt><dd>When <code>inline="inline"</code> used, don't use double quotes inside <code>mj-style</code>.</dd>
</dl>

<p>
Refer to <a href="#org5d592a3">email:css:support</a>
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mjml</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-head</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-style</span>&gt;
      @media all and (max-width: 480px) { div[style*=<span style="color: #e67128;">"color:#F45e46;"</span>] { text-align: center !important } }
    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-style</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-style</span> <span style="color: #dbdb95;">inline</span>=<span style="color: #e67128;">"inline"</span>&gt;
      .link-nostyle { color: inherit; text-decoration: none }
      <span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">for a tag, color: inherit is not working, either specify color in .link-nostyle or style="color:#fff" in a tag. </span><span style="color: #74af68;">--&gt;</span>
    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-style</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-head</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-body</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-container</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;

          &lt;<span style="color: #00ede1; font-weight: bold;">mj-image</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"100"</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"/assets/img/logo-small.png"</span>&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">mj-image</span>&gt;

          &lt;<span style="color: #00ede1; font-weight: bold;">mj-divider</span> <span style="color: #dbdb95;">border-color</span>=<span style="color: #e67128;">"#F45E43"</span>&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">mj-divider</span>&gt;

          &lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span> <span style="color: #dbdb95;">font-size</span>=<span style="color: #e67128;">"20px"</span> <span style="color: #dbdb95;">color</span>=<span style="color: #e67128;">"#F45e46"</span> <span style="color: #dbdb95;">font-family</span>=<span style="color: #e67128;">"helvetica"</span>&gt;
            Hello &lt;<span style="color: #00ede1; font-weight: bold;">a</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"https://mjml.io"</span> <span style="color: #dbdb95;">class</span>=<span style="color: #e67128;">"link-nostyle"</span>&gt;World&lt;/<span style="color: #00ede1; font-weight: bold;">a</span>&gt;
          &lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;

        &lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
      &lt;/<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-container</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-body</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">mjml</span>&gt;
</pre>
</div>

<p>
<a id="org0a81f98">mjml:tag:mj-style:responsive font size</a>
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mjml</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-head</span>&gt;
     &lt;<span style="color: #00ede1; font-weight: bold;">mj-style</span>&gt;
       .body-fix div {
          font-size: 22px !important; /* This will override font-size attribute if client supports style in head.*/
          /* Define styles use mjml elements' attribute for devices don't support &lt;<span style="color: #00ede1; font-weight: bold;">style</span>&gt; in &lt;<span style="color: #00ede1; font-weight: bold;">head</span>&gt;:
            Gmail Android app IMAP, Gmail mobile webmail, Yahoo! Mail Android app, Google Inbox, Android 5.1+ Native Mail App
          */
          line-height: 28px !important;
        }
        @media only screen and (max-width: 480px){
          .body-fix div {
            font-size: 28px !important;
            line-height: 44px !important;
          }
        }
    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-style</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-head</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-body</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-container</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
          &lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span> <span style="color: #dbdb95;">css-class</span>=<span style="color: #e67128;">"body-fix"</span> <span style="color: #dbdb95;">font-size</span>=<span style="color: #e67128;">"20px"</span> <span style="color: #dbdb95;">color</span>=<span style="color: #e67128;">"#F45E43"</span> <span style="color: #dbdb95;">font-family</span>=<span style="color: #e67128;">"helvetica"</span>&gt;Will work :)&lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;
        &lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
      &lt;/<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-container</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-body</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">mjml</span>&gt;
</pre>
</div>

<p>
Use css-class in any mj-element and change styles for mobile
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mj-style</span>&gt;
  @media ... {
    tr[class*=<span style="color: #e67128;">"hidden"</span>] {
      display:none;
    }
  }
&lt;<span style="color: #00ede1; font-weight: bold;">mj-style</span>&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span> <span style="color: #dbdb95;">css-class</span>=<span style="color: #e67128;">"hidden"</span>&gt;
</pre>
</div>

<p>
css-class only works for mj-* elements, use this to target elements inside mj-text
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mj-style</span>&gt;
      @media all and (max-width: 361px) { 
        h2[class*=<span style="color: #e67128;">"header"</span>] { font-size:50px!important;}
      }
      @media all and (max-width: 321px) {
        h2[class*=<span style="color: #e67128;">"header"</span>] { font-size:49px!important;}
      }
&lt;/<span style="color: #00ede1; font-weight: bold;">mj-style</span>&gt;
<span style="color: #74af68;">&lt;!-- </span>
<span style="color: #74af68;">     h2[class*="header"] { font-size:55px!important;}</span>
<span style="color: #74af68;">--&gt;</span>

&lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span> <span style="color: #dbdb95;">css-class</span>=<span style="color: #e67128;">"main-content"</span> <span style="color: #dbdb95;">color</span>=<span style="color: #e67128;">"#001f58"</span> <span style="color: #dbdb95;">padding</span>=<span style="color: #e67128;">"0px 0px 0px 0px"</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">h2</span> <span style="color: #dbdb95;">css-class</span>=<span style="color: #e67128;">"main-content"</span> <span style="color: #dbdb95;">class</span>=<span style="color: #e67128;">"header"</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"font-size:55px;line-height:50px;font-family:'Trebuchet MS',sans-serif;padding:0;margin:0;font-weight:100;padding:0;margin:0;"</span>&gt;<span style="font-weight: bold; font-style: italic; text-decoration: underline;">...</span>&lt;/<span style="color: #00ede1; font-weight: bold;">h2</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgad94794" class="outline-5">
<h5 id="orgad94794"><span class="section-number-5">7.9.12.8</span> mj-head &gt; mj-font <a id="org18f461e">mjml:tag:mj-font</a></h5>
<div class="outline-text-5" id="text-7-9-12-8">
<p>
<a href="https://www.campaignmonitor.com/css/text-fonts/font-face/">https://www.campaignmonitor.com/css/text-fonts/font-face/</a>
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mjml</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-head</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-font</span> <span style="color: #dbdb95;">name</span>=<span style="color: #e67128;">"Raleway"</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"https://fonts.googleapis.com/css?family=Raleway"</span> /&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-head</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-body</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-container</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
          &lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span> <span style="color: #dbdb95;">font-family</span>=<span style="color: #e67128;">"Raleway, Arial"</span>&gt;
            Hello World!
          &lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;
        &lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
      &lt;/<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-container</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-body</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">mjml</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org0606867" class="outline-5">
<h5 id="org0606867"><span class="section-number-5">7.9.12.9</span> mj-head &gt; mj-title <a id="orgc7f5689">mjml:tag:mj-title</a></h5>
<div class="outline-text-5" id="text-7-9-12-9">
<pre class="example">
&lt;mj-head&gt;
  &lt;mj-title&gt;Hello MJML&lt;/mj-title&gt;
&lt;/mj-head&gt;
</pre>
</div>
</div>

<div id="outline-container-org60c5cfa" class="outline-5">
<h5 id="org60c5cfa"><span class="section-number-5">7.9.12.10</span> mj-head &gt; mj-body &gt; mj-section (mj-container)</h5>
<div class="outline-text-5" id="text-7-9-12-10">
<p>
<a id="org79f8739">mjml:tag:mj-body</a> <a id="orgcfae5ba">mjml:tag:mj-section</a> <a id="orgd44d82d">mjml:tag:mj-container</a>
To insert custom elements either registerMJElement(&lt;MJMLElement&gt; class) api from mjml-core or via .mjmlconfig file.
Non-known element from mjml-core are ignored.
</p>

<p>
mj-body can have multiple mj-section
</p>
<dl class="org-dl">
<dt>width</dt><dd>default 600px</dd>
<dt>(no term)</dt><dd>background-color</dd>
<dt>(no term)</dt><dd>css-class</dd>
</dl>

<p>
For version 3, mj-body should have only one root element which usually is mjml-container, which contains the entire content of your document.
</p>

<p>
There's no more mj-container in version 4. mj-section was mj-container in version 3 and mj-container was mj-body in version 1.x
</p>
<dl class="org-dl">
<dt>width</dt><dd>unit px, default 600px, you can change mj-body's width attribute to change it.</dd>
<dt>full-width</dt><dd>default n/a. If set to full-width then section is extended to the full width beyond 600px</dd>
<dt>(no term)</dt><dd>background-color</dd>
<dt>(no term)</dt><dd>background-url</dd>
<dt>background-size</dt><dd>auto</dd>
<dt>background-repeat</dt><dd>repeat</dd>
<dt>vertical-align</dt><dd>top</dd>
<dt>text-align</dt><dd>center</dd>
<dt>padding</dt><dd>20px 0</dd>
<dt>direction</dt><dd>ltr (or rtl)</dd>
<dt>css-class</dt><dd>rendered HTML is class="xx"</dd>
</dl>

<p>
// TODO Inside container, you can have include, section and/or wrapper
</p>
</div>
</div>

<div id="outline-container-org466b63e" class="outline-5">
<h5 id="org466b63e"><span class="section-number-5">7.9.12.11</span> mj-body &gt; mj-include <a id="org5141222">mjml:tag:mj-include</a></h5>
<div class="outline-text-5" id="text-7-9-12-11">
<p>
Inside mjml &gt; mj-body &gt; mj-container
&lt;mj-include path="./header" /&gt; &lt;!&#x2013; or 'header.mjml' &#x2013;&gt;
</p>
</div>
</div>

<div id="outline-container-org734798f" class="outline-5">
<h5 id="org734798f"><span class="section-number-5">7.9.12.12</span> mj-body &gt; mj-section <a id="org233a78b">mjml:tag:mj-section</a></h5>
<div class="outline-text-5" id="text-7-9-12-12">
<p>
It should contain mj-column. Up to 4 columns.
Section has up to 600px width.
</p>

<p>
<a href="https://mjml.io/documentation/#mjml-section">https://mjml.io/documentation/#mjml-section</a>
</p>

<p>
Structure the columns in the order you want them to stack on mobile, then use direction attribute to change the order on desktop.
</p>

<dl class="org-dl">
<dt>full-width</dt><dd>n/a (full-width)</dd>
<dt>direction</dt><dd>ltr or rtl, default ltr</dd>
<dt>padding</dt><dd>default 20px 0</dd>
<dt>(no term)</dt><dd>padding-top, padding-x</dd>
<dt>background-url</dt><dd>default n/a</dd>
<dt>background-repeat</dt><dd>default repeat, no-repeat</dd>
<dt>background-color</dt><dd>default n/a,</dd>
</dl>

<p>
You may use % for left and right padding.
</p>
</div>
</div>

<div id="outline-container-org0990955" class="outline-5">
<h5 id="org0990955"><span class="section-number-5">7.9.12.13</span> mj-wrapper &gt; mj-section <a id="orgaf2edb9">mjml:tag:mj-wrapper</a></h5>
<div class="outline-text-5" id="text-7-9-12-13">
<p>
Wrap multiple sections. Perfect place to set borders
</p>

<p>
<a href="https://mjml.io/documentation/#mjml-wrapper">https://mjml.io/documentation/#mjml-wrapper</a>
</p>

<dl class="org-dl">
<dt>padding</dt><dd>20px 0</dd>
<dt>(no term)</dt><dd>padding-*</dd>
<dt>background-url</dt><dd>If mj-wrapper has this defined, don't define in its mj-section</dd>
<dt>background-repeat</dt><dd>repeat</dd>
<dt>background-size</dt><dd>auto</dd>
<dt>border</dt><dd>none</dd>
<dt>direction</dt><dd>ltr (rtl)</dd>
<dt>vertical-align</dt><dd>top</dd>
<dt>text-align</dt><dd>center</dd>
<dt>full-width</dt><dd>Don't add full-width="full-width" inside mj-section as it will make mj-section non-full-width
<ul class="org-ul">
<li>I also find out if there are other sections that are also inside mj-container, define full-width only for that wrapper and don't define it for other sections</li>
<li>Sometimes mj-section does not have to be full-width, you can set left/right padding to 0 for mj-section</li>
</ul></dd>
<dt>(no term)</dt><dd>css-class</dd>
</dl>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mjml</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-body</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-wrapper</span> <span style="color: #dbdb95;">border</span>=<span style="color: #e67128;">"1px solid #000000"</span> <span style="color: #dbdb95;">padding</span>=<span style="color: #e67128;">"50px 30px"</span>&gt;

      &lt;<span style="color: #00ede1; font-weight: bold;">mj-section</span> <span style="color: #dbdb95;">border-top</span>=<span style="color: #e67128;">"1px solid #aaaaaa"</span> <span style="color: #dbdb95;">border-left</span>=<span style="color: #e67128;">"1px solid #aaaaaa"</span> <span style="color: #dbdb95;">border-right</span>=<span style="color: #e67128;">"1px solid #aaaaaa"</span> <span style="color: #dbdb95;">padding</span>=<span style="color: #e67128;">"20px"</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
          &lt;<span style="color: #00ede1; font-weight: bold;">mj-image</span> <span style="color: #dbdb95;">padding</span>=<span style="color: #e67128;">"0"</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"https://placeholdit.imgix.net/~text?&amp;w=350&amp;h=150"</span> /&gt;
        &lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
      &lt;/<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;

      &lt;<span style="color: #00ede1; font-weight: bold;">mj-section</span> <span style="color: #dbdb95;">border-left</span>=<span style="color: #e67128;">"1px solid #aaaaaa"</span> <span style="color: #dbdb95;">border-right</span>=<span style="color: #e67128;">"1px solid #aaaaaa"</span> <span style="color: #dbdb95;">padding</span>=<span style="color: #e67128;">"20px"</span> <span style="color: #dbdb95;">border-bottom</span>=<span style="color: #e67128;">"1px solid #aaaaaa"</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span> <span style="color: #dbdb95;">border</span>=<span style="color: #e67128;">"1px solid #dddddd"</span>&gt;
          &lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span> <span style="color: #dbdb95;">padding</span>=<span style="color: #e67128;">"20px"</span>&gt; First line of text &lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;
          &lt;<span style="color: #00ede1; font-weight: bold;">mj-divider</span> <span style="color: #dbdb95;">border-width</span>=<span style="color: #e67128;">"1px"</span> <span style="color: #dbdb95;">border-style</span>=<span style="color: #e67128;">"dashed"</span> <span style="color: #dbdb95;">border-color</span>=<span style="color: #e67128;">"lightgrey"</span> <span style="color: #dbdb95;">padding</span>=<span style="color: #e67128;">"0 20px"</span> /&gt;
          &lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span> <span style="color: #dbdb95;">padding</span>=<span style="color: #e67128;">"20px"</span>&gt; Second line of text &lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;
        &lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
      &lt;/<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;

    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-wrapper</span>&gt;

  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-body</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">mjml</span>&gt;
</pre>
</div>
</div>

<ol class="org-ol">
<li><a id="orgc49df6f"></a>mj-container &gt; <a id="org5835de1">mjml:tag:mj-column</a><br />
<div class="outline-text-6" id="text-7-9-12-13-1">
<p>
Any mj-element included in a column will have a width equals to 100% of this column's width. e.g. mj-text
</p>

<p>
Inside a column, any standard element, or the ones you've defined and registered can be included.
</p>

<p>
But don't include another column or section.
</p>

<dl class="org-dl">
<dt>background-color</dt><dd>default n/a</dd>
</dl>
</div>

<ol class="org-ol">
<li><a id="orgf485281"></a>Auto sizing<br />
<div class="outline-text-8" id="text-7-9-12-13-1-0-1">
<p>
2 columns, each column 50%, 3 columns each is 33%, etc.
</p>
</div>
</li>

<li><a id="org75cf9a4"></a>Manual sizing<br />
<div class="outline-text-8" id="text-7-9-12-13-1-0-2">
<pre class="example">
&lt;mj-column width="300px"&gt;
 &lt;!-- First column content --&gt;
&lt;/mj-column&gt;
&lt;mj-column&gt; 
 &lt;!-- Second column content --&gt;
&lt;/mj-column&gt;
</pre>

<p>
Once one column's width is set, you have to set manually each column size.
</p>

<p>
Always keep in mind that the maximum space to end up with a responsive layout is 600px.
</p>

<dl class="org-dl">
<dt>vertical-align</dt><dd>default top, can be middle/bottom</dd>
<dt>width</dt><dd>default (100/number of columns %)</dd>
</dl>

<p>
No padding is set by default
</p>
</div>
</li>
</ol>
</li>
</ol>
</div>

<div id="outline-container-org9a3841b" class="outline-5">
<h5 id="org9a3841b"><span class="section-number-5">7.9.12.14</span> mj-container &gt; mj-hero <a id="orga9c5f19">mjml:tag:mj-hero</a></h5>
<div class="outline-text-5" id="text-7-9-12-14">
<p>
<a href="https://mjml.io/documentation/#mjml-hero">https://mjml.io/documentation/#mjml-hero</a>
</p>
<pre class="example">
&lt;mj-container&gt;
  &lt;mj-hero mode="fluid-height" background-width="600px" background-height="469px" background-url="https://via.placeholder.com/600x469/?text=600x469" background-color="#2a3448" padding="100px 0px"&gt;
    &lt;!-- To add content like mj-image, mj-text, mj-button ... use the mj-hero-content component --&gt;
    &lt;mj-hero-content width="100%"&gt;
      &lt;mj-text padding="20px" color="#ffffff" font-family="Helvetica" align="left" font-size="45" line-height="45px" font-weight="900"&gt;
        GO TO SPACE
      &lt;/mj-text&gt;
      &lt;mj-button href="https://mjml.io/" align="left"&gt;
        ORDER YOUR TICKET NOW
      &lt;/mj-button&gt;
    &lt;/mj-hero-content&gt;
  &lt;/mj-hero&gt;
&lt;/mj-container&gt;
</pre>

<p>
Always specify background-color
mode :: fluid-height or fixed-height
</p>

<pre class="example">
&lt;mj-container&gt;
  &lt;mj-hero mode="fixed-height" height="469px" background-width="600px" background-height="469px" background-url="https://via.placeholder.com/600x469/?text/600x469" background-color="#2a3448" padding="100px 0px"&gt;
    &lt;!-- To add content like mj-image, mj-text, mj-button ... use the mj-hero-content component --&gt;
    &lt;mj-hero-content width="100%"&gt;
      &lt;mj-text padding="20px" color="#ffffff" font-family="Helvetica" align="center" font-size="45" line-height="45px" font-weight="900"&gt;
        GO TO SPACE
      &lt;/mj-text&gt;
      &lt;mj-button href="https://mjml.io/" align="center"&gt;
        ORDER YOUR TICKET NOW
      &lt;/mj-button&gt;
    &lt;/mj-hero-content&gt;
  &lt;/mj-hero&gt;
&lt;/mj-container&gt;
</pre>

<p>
mj-hero can be a mj-section <a id="orgfec3bca">mjml:tag:mj-hero:sample1</a>
</p>
<pre class="example">
&lt;mj-hero
  mode="fluid-height"
  height="420px"
  background-width="600px"
  background-height="420px"
  background-url="http://600x420.jpg"
  background-color="#FFFFFF"
  padding="0px"&gt;
  &lt;mj-hero-content width="100%"&gt;
    &lt;mj-text font-size="18px" font-family="Khand, Helvetica, sans-serif, Arial" font-weight="900"&gt;
      Title aligned to left
    &lt;/mj-text&gt;
    &lt;mj-table width="55%" color="#123456"&gt;
      &lt;tr style="list-style: none;line-height:1"&gt;
        &lt;td style="font-family:Khand, Helvetica, sans-serif, Arial;font-size:18px;line-height:28px;color:#666465;"&gt;
          This text aligned to the left and takes 55% width
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/mj-table&gt;
    &lt;mj-spacer height="20px" css-class="spacer-above-button" /&gt;
    &lt;mj-button background-color="#FF0025" font-size="16px" align="left" font-family="'Merriweather Sans', Helvetica, sans-serif, Arial" padding-left="25px"&gt;
      Learn more
    &lt;/mj-button&gt;
    &lt;mj-spacer height="20px" /&gt;
    &lt;mj-text font-size="14px" font-weight="900" font-family="'Merriweather Sans', sans-serif;"&gt;
      Phone number&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href="http://a.com" style="color:#000000;text-decoration:none;"&gt;a.com&lt;/a&gt;
    &lt;/mj-text&gt;
    &lt;mj-social color="#333333" align="left" text-mode="false" icon-size="16px" padding-left="25" padding-bottom="10" padding-top="10" mode="horizontal" display="linkedin:url facebook:url twitter:url youtubec:url" linkedin-href="https://www.linkedin.com/"
               linkedin-content=" "
               linkedin-icon-color="#A7A6A4" facebook-href="https://www.facebook.com/" facebook-content=" "
               facebook-icon-color="#A7A6A4"
               twitter-href="https://twitter.com/"
               twitter-content=" "
               twitter-icon-color="#A7A6A4" youtubec-href="https://www.youtube.com/"
               youtubec-content=" "
               youtubec-icon-color="#A7A6A4" youtubec-icon="http://16x16.jpg" /&gt;
    &lt;mj-spacer height="30px" /&gt;
  &lt;/mj-hero-content&gt;
&lt;/mj-hero&gt;
&lt;mj-section&gt;
...
&lt;/mj-section&gt;
</pre>
</div>
</div>
<div id="outline-container-org8a09ef3" class="outline-5">
<h5 id="org8a09ef3"><span class="section-number-5">7.9.12.15</span> mj-section &gt; mj-column <a id="org9c59c22">mjml:tag:mj-column</a></h5>
<div class="outline-text-5" id="text-7-9-12-15">
<p>
Without width attribute, mj-column is evenly distributed.
</p>

<p>
width attribute can have pixels or percentage.
</p>
<pre class="example">
&lt;mj-column width="200px"&gt; &lt;!-- First column content --&gt; &lt;/mj-column&gt;
</pre>

<dl class="org-dl">
<dt>vertical-align</dt><dd>top</dd>
<dt>padding</dt><dd>20px 0</dd>
</dl>
</div>
</div>

<div id="outline-container-org740162d" class="outline-5">
<h5 id="org740162d"><span class="section-number-5">7.9.12.16</span> mj-elements inside mj-column</h5>
<div class="outline-text-5" id="text-7-9-12-16">
<p>
Any mj-element inside mj-column will have width equivalent to 100% of this column's width.
</p>

<p>
Max width:
Any mj-element or elements inside mj-raw including mj-image should not have a higher width than the current column, otherwise Outlook will have troubhle in laying out mj-column
</p>
</div>

<ol class="org-ol">
<li><a id="orgbe4126f"></a>mj-text <a id="orga562b8b">mjml:tag:mj-text</a><br />
<div class="outline-text-6" id="text-7-9-12-16-1">
<p>
It can contain any HTML tag with any attributes.
</p>

<dl class="org-dl">
<dt>padding</dt><dd>10px 25px</dd>
<dt>color</dt><dd>#000000</dd>
<dt>container-background-color</dt><dd>n/a</dd>
<dt>font-family</dt><dd>Ubuntu, Helvetica, Arial, sans-serif</dd>
<dt>font-size</dt><dd>13px</dd>
<dt>(no term)</dt><dd>font-style</dd>
<dt>line-height</dt><dd>22px. Use %.</dd>
<dt>letter-spacing</dt><dd>none</dd>
<dt>align</dt><dd>left</dd>
</dl>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mj-section</span> <span style="color: #dbdb95;">background-color</span>=<span style="color: #e67128;">"#f0f0f0"</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span> <span style="color: #dbdb95;">font-style</span>=<span style="color: #e67128;">"italic"</span> <span style="color: #dbdb95;">font-size</span>=<span style="color: #e67128;">"20"</span> <span style="color: #dbdb95;">color</span>=<span style="color: #e67128;">"#626262"</span>&gt;
       My Company &lt;<span style="color: #00ede1; font-weight: bold;">a</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"#"</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"text-decoration:none!important;text-decoration:none;color:#2DDCB4"</span>&gt;... read more&lt;/<span style="color: #00ede1; font-weight: bold;">a</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Hello Title</span>&lt;/<span style="color: #00ede1; font-weight: bold;">h1</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;
 &lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
</pre>
</div>

<p>
<a href="#org0a81f98">mjml:tag:mj-style:responsive font size</a>
</p>

<p>
Remove underline for telephone on iOS
<a href="https://litmus.com/blog/update-banning-blue-links-on-ios-devices">https://litmus.com/blog/update-banning-blue-links-on-ios-devices</a>
</p>
<ul class="org-ul">
<li><code>&lt;meta content="telephone=no" name="format-detection"&gt;</code></li>
<li><code>6&amp;zwnj;75 Massachusetts Ave, Cambridge, MA 02139</code> &gt;&gt; 675 Massachusetts Ave, Cambridge, MA 02139</li>
</ul>

<p>
<code>a[href^=tel]{ color:#F00; text-decoration:none;}</code>
</p>

<p>
Change styles for all iOS data detection! 
</p>
<dl class="org-dl">
<dt>iOS add an attribute to all links</dt><dd><code>&lt;a href="#" x-apple-data-detectors="true"&gt;</code></dd>
</dl>

<p>
So add style
</p>
<div class="org-src-container">
<pre class="src src-css"><span style="color: #00ede1; font-weight: bold;">a[x-apple-data-detectors] </span>{
    <span style="color: #ffad29; font-weight: bold;">color</span>: inherit <span style="color: #23d7d7;">!important</span>;
    <span style="color: #ffad29; font-weight: bold;">text-decoration</span>: none <span style="color: #23d7d7;">!important</span>;
    <span style="color: #74af68;">/* </span><span style="color: #74af68;">below is optional </span><span style="color: #74af68;">*/</span>
    <span style="color: #ffad29; font-weight: bold;">font-size</span>: inherit <span style="color: #23d7d7;">!important</span>; 
    <span style="color: #ffad29; font-weight: bold;">font-family</span>: inherit <span style="color: #23d7d7;">!important</span>;
    <span style="color: #ffad29; font-weight: bold;">font-weight</span>: inherit <span style="color: #23d7d7;">!important</span>;
    <span style="color: #ffad29; font-weight: bold;">line-height</span>: inherit <span style="color: #23d7d7;">!important</span>;
}

// Samsung Mail automatically adds id MessageViewBody to &lt;body&gt; and a &lt;div id=<span style="color: #e67128;">"MessageWebViewDiv"</span>&gt;
<span style="color: #00ede1; font-weight: bold;">#MessageViewBody a </span>{
 <span style="color: #ffad29; font-weight: bold;">color</span>: inherit;
 <span style="color: #ffad29; font-weight: bold;">text-decoration</span>: none;
 <span style="color: #ffad29; font-weight: bold;">font-size</span>: inherit;
 <span style="color: #ffad29; font-weight: bold;">font-family</span>: inherit;
 <span style="color: #ffad29; font-weight: bold;">font-weight</span>: inherit;
 <span style="color: #ffad29; font-weight: bold;">line-height</span>: inherit;
}
</pre>
</div>

<p>
Customize line-height for Outlook desktop clients only:
</p>
<ul class="org-ul">
<li>Define ling-height in mj-text attribute and then set @media</li>
<li>line-height for Outlook desktop clients is 95% while others support @media use 83%</li>
<li>This can be used to target other CSS property for Outlook desktop clients only.</li>
</ul>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mj-style</span>&gt;
@media all and (min-width: 500px) {
  .main-content-h1-lh div {
    line-height:83%!important;
  }
}
&lt;/<span style="color: #00ede1; font-weight: bold;">mj-style</span>&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span> <span style="color: #dbdb95;">css-class</span>=<span style="color: #e67128;">"main-content-h1-lh"</span> <span style="color: #dbdb95;">line-height</span>=<span style="color: #e67128;">"95%"</span>&gt;...&lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;
</pre>
</div>
</div>
</li>

<li><a id="orga9b6c0b"></a>mj-button, Image header with text and button<br />
<div class="outline-text-6" id="text-7-9-12-16-2">
<dl class="org-dl">
<dt>href</dt><dd></dd>

<dt>target</dt><dd>_blank</dd>
<dt>padding</dt><dd>10px 25px</dd>
<dt>inner-padding</dt><dd>10px 25px</dd>
<dt>background-color</dt><dd>#414141</dd>
<dt>color</dt><dd>#ffffff</dd>
<dt>border-radius</dt><dd>3px</dd>
<dt>font-size</dt><dd>13px</dd>
<dt>font-weight</dt><dd>normal</dd>
<dt>font-family</dt><dd>Ubuntu, Helvetic, Arial, sans-serif</dd>
<dt>line-height</dt><dd>120%, px/%/none</dd>
<dt>align</dt><dd>center</dd>
<dt>vertical-align</dt><dd>middle</dd>
</dl>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mj-section</span> <span style="color: #dbdb95;">background-url</span>=<span style="color: #e67128;">"http://1.bp.blogspot.com/-TPrfhxbYpDY/Uh3Refzk02I/AAAAAAAALw8/5sUJ0UUGYuw/s1600/New+York+in+The+1960's+-+70's+(2).jpg"</span> <span style="color: #dbdb95;">background-size</span>=<span style="color: #e67128;">"cover"</span> <span style="color: #dbdb95;">background-repeat</span>=<span style="color: #e67128;">"no-repeat"</span>&gt;
  <span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">-In order to have the background rendered full-width in the column, </span>
<span style="color: #74af68;">  set the column width to 600px</span><span style="color: #74af68;">--&gt;</span>
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"600"</span>&gt;

    &lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span> <span style="color: #dbdb95;">align</span>=<span style="color: #e67128;">"center"</span> <span style="color: #dbdb95;">color</span>=<span style="color: #e67128;">"#fff"</span> <span style="color: #dbdb95;">font-size</span>=<span style="color: #e67128;">"40"</span> <span style="color: #dbdb95;">font-family</span>=<span style="color: #e67128;">"Helvetica Neue"</span>&gt;Slogan here&lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;

    &lt;<span style="color: #00ede1; font-weight: bold;">mj-button</span> <span style="color: #dbdb95;">background-color</span>=<span style="color: #e67128;">"#F63A4D"</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"#"</span>&gt;
      Promotion
    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-button</span>&gt;

  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;

&lt;/<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
</pre>
</div>
</div>
</li>

<li><a id="orga86a4f1"></a>mj-image <a id="org90d5425">mjml:tag:mj-image</a><br />
<div class="outline-text-6" id="text-7-9-12-16-3">
<dl class="org-dl">
<dt>width</dt><dd>px, default 100% (100% of the column width)</dd>
<dt>height</dt><dd>auto</dd>
<dt>align</dt><dd>center</dd>
<dt>padding</dt><dd>10px 25px</dd>
<dt>(no term)</dt><dd>padding-*</dd>
<dt>border</dt><dd>none</dd>
<dt>border-width</dt><dd>default 4px</dd>
<dt>border-style</dt><dd>default solid, dashed/dotted</dd>
<dt>border-color</dt><dd>default #000000</dd>
<dt>alt</dt><dd>string</dd>
<dt>(no term)</dt><dd>href</dd>
<dt>target</dt><dd>_blank</dd>
</dl>

<p>
srcset is only supported in iOS. Determine display size and multiply the dimension by 2.
</p>

<p>
When mj-image is inside a mj-column that is the only column, then size doesn't matter.
If mj-image is inside a column that has other sibling columns, then limit width so that columns are layed out correctly in Outlook.
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mj-section</span> <span style="color: #dbdb95;">background-color</span>=<span style="color: #e67128;">"white"</span>&gt;

  <span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">Left image </span><span style="color: #74af68;">--&gt;</span>
  <span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">column is 50% of total width,  mj-image is vertically and horizontally centered and image width is always 200 </span><span style="color: #74af68;">--&gt;</span>
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-image</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"200"</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"http://via.placeholder.com/300x400/?text=300x400"</span> /&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;

  <span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">right paragraph </span><span style="color: #74af68;">--&gt;</span>
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span> <span style="color: #dbdb95;">font-style</span>=<span style="color: #e67128;">"italic"</span> <span style="color: #dbdb95;">font-size</span>=<span style="color: #e67128;">"20"</span> <span style="color: #dbdb95;">font-family</span>=<span style="color: #e67128;">"Helvetica Neue"</span> <span style="color: #dbdb95;">color</span>=<span style="color: #e67128;">"#626262"</span>&gt;
      Find amazing places
    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;

    &lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span> <span style="color: #dbdb95;">color</span>=<span style="color: #e67128;">"#525252"</span>&gt;
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin rutrum enim eget magna efficitur, eu semper augue semper. Aliquam erat volutpat. Cras id dui lectus. Vestibulum sed finibus lectus.&lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;

  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
</pre>
</div>
</div>
</li>

<li><a id="orgef08887"></a>mj-social <a id="org216f0b7">mjml:tag:mj-social</a><br />
<div class="outline-text-6" id="text-7-9-12-16-4">
<p>
Refer to <a href="#org76c844d">mjml:tag:mj-table:social</a>
Version 4
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mj-section</span> <span style="color: #dbdb95;">background-color</span>=<span style="color: #e67128;">"#e7e7e7"</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-social</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">mj-social-element</span> <span style="color: #dbdb95;">name</span>=<span style="color: #e67128;">"facebook"</span> /&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-social</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
</pre>
</div>

<p>
mj-social
</p>
<dl class="org-dl">
<dt>border-radius</dt><dd>3px</dd>
<dt>font-family</dt><dd>Ubuntu, Helvetica, Arial, sans-serif</dd>
<dt>font-size</dt><dd>13px</dd>
<dt>icon-size</dt><dd>20px</dd>
<dt>line-height</dt><dd>22px</dd>
<dt>mode</dt><dd>horizontal (vertical)</dd>
<dt>text-decoration</dt><dd>none</dd>
<dt>align</dt><dd>center</dd>
<dt>color</dt><dd>#333333</dd>
<dt>inner-padding</dt><dd>4px</dd>
<dt>padding</dt><dd>10px 25px</dd>
</dl>

<p>
mj-social-element
</p>
<dl class="org-dl">
<dt>name</dt><dd>facebook/google/instagram/pinterest/linkedin/twitter</dd>
<dt>mode</dt><dd>horizontal (vertical)</dd>
<dt>text-mode</dt><dd>true (false, no text node inside mj-social-element)</dd>

<dt>(no term)</dt><dd>src</dd>

<dt>border-radius</dt><dd>3px</dd>
<dt>href</dt><dd></dd>

<dt>target</dt><dd>_blank</dd>
<dt>text-decoration</dt><dd>none</dd>

<dt>align</dt><dd>center</dd>
<dt>color</dt><dd>#333333</dd>
<dt>background-color</dt><dd>each social name has its own default</dd>
<dt>font-size</dt><dd>13px</dd>
<dt>icon-size</dt><dd>20px</dd>
<dt>line-height</dt><dd>22px</dd>

<dt>padding</dt><dd>10px 25px</dd>
</dl>

<p>
Version 3
</p>
<dl class="org-dl">
<dt>text-mode</dt><dd>default true, if true, *-content must be defined</dd>
<dt>(no term)</dt><dd>font-family</dd>
<dt>color</dt><dd>text color, default #333333</dd>
<dt>align</dt><dd>center</dd>
<dt>icon-size</dt><dd>default 20px</dd>
<dt>padding</dt><dd>default 10px 25px</dd>
<dt>mode</dt><dd>defualt horizontal, or vertical</dd>

<dt>display</dt><dd>default facebook twitter google. could be facebook:url, can add custom social network e.g. youtube</dd>

<dt>*-href, *-content, *-rel, *-icon, *-icon-color</dt><dd>* could be facebook, twitter, google, linkedin, pinterest, instagram</dd>

<dt>(no term)</dt><dd>*-icon for default facebook, twitter, etc. cannot be modified</dd>
<dt>(no term)</dt><dd>*-icon-color has to be defined for custom social medias e.g. youtubec</dd>
</dl>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mj-social</span> <span style="color: #dbdb95;">color</span>=<span style="color: #e67128;">"#333333"</span> <span style="color: #dbdb95;">align</span>=<span style="color: #e67128;">"left"</span> 
<span style="color: #dbdb95;">text-mode</span>=<span style="color: #e67128;">"false"</span> <span style="color: #dbdb95;">icon-size</span>=<span style="color: #e67128;">"16px"</span> 
<span style="color: #dbdb95;">padding-right</span>=<span style="color: #e67128;">"25"</span> <span style="color: #dbdb95;">padding-bottom</span>=<span style="color: #e67128;">"10"</span> <span style="color: #dbdb95;">padding-top</span>=<span style="color: #e67128;">"10"</span> 
<span style="color: #dbdb95;">mode</span>=<span style="color: #e67128;">"horizontal"</span> 
<span style="color: #dbdb95;">display</span>=<span style="color: #e67128;">"linkedin:url facebook:url twitter:url youtubec:url"</span> 
<span style="color: #dbdb95;">linkedin-href</span>=<span style="color: #e67128;">"..."</span>
<span style="color: #dbdb95;">linkedin-content</span>=<span style="color: #e67128;">" "</span>
<span style="color: #dbdb95;">linkedin-icon-color</span>=<span style="color: #e67128;">"#A7A6A4"</span> 
<span style="color: #dbdb95;">youtubec-href</span>=<span style="color: #e67128;">"..."</span>
<span style="color: #dbdb95;">youtubec-content</span>=<span style="color: #e67128;">" "</span>
<span style="color: #dbdb95;">youtubec-icon-color</span>=<span style="color: #e67128;">"#A7A6A4"</span> <span style="color: #dbdb95;">youtubec-icon</span>=<span style="color: #e67128;">"path to youtube icon image"</span> /&gt;
</pre>
</div>
</div>
</li>

<li><a id="org7770143"></a>mj-divider<br />
<div class="outline-text-6" id="text-7-9-12-16-5">
<p>
Try to add horizontal border with some spacing using mj-divider
</p>
<dl class="org-dl">
<dt>border-color</dt><dd>#000000</dd>
<dt>border-style</dt><dd>solid</dd>
<dt>border-width</dt><dd>4px</dd>
<dt>width</dt><dd>100% px/percent</dd>
<dt>padding</dt><dd>10px 25px</dd>
<dt>(no term)</dt><dd>container-background-color</dd>
</dl>

<pre class="example">
&lt;mj-section padding-bottom="0" background-color="white"&gt;
  &lt;mj-column width="100%"&gt;
    &lt;mj-image src="https://avatars0.githubusercontent.com/u/16115896?v=3&amp;s=200" width="50px" /&gt;
    &lt;mj-divider padding-top="20" padding-bottom="0" padding-left="0" padding-right="0" border-width="1px" border-color="#f8f8f8" /&gt;
  &lt;/mj-column&gt;
&lt;/mj-section&gt;
</pre>
</div>
</li>

<li><a id="org4d3f5fb"></a>mj-spacer<br />
<div class="outline-text-6" id="text-7-9-12-16-6">
<p>
blank space.  For some reason, try adding a section with a spacer only so that the email has the content in full width
</p>

<dl class="org-dl">
<dt>height</dt><dd>20px</dd>
<dt>(no term)</dt><dd>css-class</dd>
</dl>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;A first line of text&lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-spacer</span> <span style="color: #dbdb95;">height</span>=<span style="color: #e67128;">"50px"</span> /&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;A second line of text&lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
</pre>
</div>
</div>
</li>

<li><a id="org06e3673"></a>mj-table<br />
<div class="outline-text-6" id="text-7-9-12-16-7">
<p>
only accepts plain html
</p>

<dl class="org-dl">
<dt>font-family</dt><dd>Ubuntu, Helvetica, Arial, sans-serif</dd>
<dt>font-size</dt><dd>13px</dd>
<dt>line-height</dt><dd>22px (%/px)</dd>
<dt>padding</dt><dd>10px 25px</dd>
<dt>width</dt><dd>default 100%. With default left+right padding 25*2, the maximum width can be less than 300px. Otherwise the table has 100% width</dd>
<dt>table-layout</dt><dd>auto (fixed/initial/inherit)</dd>
</dl>

<p>
Use <code>mj-table</code> to have fixed width that's not gonna change when in mobile. Or width will be 100%
</p>

<p>
mj-table always, as a whole, align left while <a href="#org216f0b7">mjml:tag:mj-social</a> aligns center. To center, use <code>mj-raw</code> to <a href="#orgb83cf64">mjml:raw:center table</a>
</p>

<p>
<a id="org76c844d">mjml:tag:mj-table:social</a>
Use it to align icons with links. Notice the img has fixed width. mj-table has fixed width including padding 25*5+5*(5-1)=165px. If mj-table has no width, columns will have equal width.
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mj-table</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"165px"</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">tr</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"list-style: none;line-height:1"</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">a</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"https://twitter.com/RecastAI"</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">img</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"25"</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"https://cdn.recast.ai/newsletter/twitter.png"</span> /&gt;
      &lt;/<span style="color: #00ede1; font-weight: bold;">a</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">a</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"https://www.facebook.com/recastAI"</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">img</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"25"</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"https://cdn.recast.ai/newsletter/facebook.png"</span> /&gt;
      &lt;/<span style="color: #00ede1; font-weight: bold;">a</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">a</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"https://medium.com/@RecastAI"</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">img</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"25"</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"https://cdn.recast.ai/newsletter/medium.png"</span> /&gt;
      &lt;/<span style="color: #00ede1; font-weight: bold;">a</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">a</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"https://www.youtube.com/channel/UCA0UZlR8crpgwFiVaSTbVWw"</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">img</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"25"</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"https://cdn.recast.ai/newsletter/youtube.png"</span> /&gt;
      &lt;/<span style="color: #00ede1; font-weight: bold;">a</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">a</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"https://plus.google.com/u/0/+RecastAi"</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">img</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"25"</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"https://cdn.recast.ai/newsletter/google%2B.png"</span> /&gt;
      &lt;/<span style="color: #00ede1; font-weight: bold;">a</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">mj-table</span>&gt;
</pre>
</div>

<ul class="org-ul">
<li>For borders on 4 sides (bottom/top/left/right), I had trouble with setting in <code>&lt;tr&gt;</code>. Define 4 sided borders in <code>&lt;td&gt;</code> is fine.</li>
</ul>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-table</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">tr</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"border-bottom:1px solid #ecedee;text-align:left;padding:15px 0;"</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">th</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"padding: 0 15px 0 0;"</span>&gt;Year&lt;/<span style="color: #00ede1; font-weight: bold;">th</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">th</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"padding: 0 15px;"</span>&gt;Language&lt;/<span style="color: #00ede1; font-weight: bold;">th</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">th</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"padding: 0 0 0 15px;"</span>&gt;Inspired from&lt;/<span style="color: #00ede1; font-weight: bold;">th</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">td</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"padding: 0 15px 0 0;"</span>&gt;1995&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">td</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"padding: 0 15px;"</span>&gt;PHP&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">td</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"padding: 0 0 0 15px;"</span>&gt;C, Shell Unix&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">td</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"padding: 0 15px 0 0;"</span>&gt;1995&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">td</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"padding: 0 15px;"</span>&gt;JavaScript&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">td</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"padding: 0 0 0 15px;"</span>&gt;Scheme, Self&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-table</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-table</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">tr</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"list-style: none;line-height:1"</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">td</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"46"</span>&gt;&lt;<span style="color: #00ede1; font-weight: bold;">img</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"46"</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"http://via.placeholder.com/46x32/"</span> /&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">td</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"10"</span>&gt;<span style="color: #dbdb95;">&amp;nbsp;</span>&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
          &lt;<span style="color: #00ede1; font-weight: bold;">br</span>&gt;
          &lt;<span style="color: #00ede1; font-weight: bold;">span</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"font-size:18px;font-weight:200;"</span>&gt;Contact Us&lt;/<span style="color: #00ede1; font-weight: bold;">span</span>&gt;&lt;<span style="color: #00ede1; font-weight: bold;">br</span>&gt;
          &lt;<span style="color: #00ede1; font-weight: bold;">a</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"tel:18881231234"</span> <span style="color: #dbdb95;">target</span>=<span style="color: #e67128;">"_blank"</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"text-decoration:none;color:#545759;"</span>&gt;1-888-123-1234&lt;/<span style="color: #00ede1; font-weight: bold;">a</span>&gt;&lt;<span style="color: #00ede1; font-weight: bold;">br</span>&gt;
          &lt;<span style="color: #00ede1; font-weight: bold;">a</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"mailto:a@xyz.com"</span> <span style="color: #dbdb95;">target</span>=<span style="color: #e67128;">"_blank"</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"text-decoration:none;color:#545759;"</span>&gt;a@xyz.com&lt;/<span style="color: #00ede1; font-weight: bold;">a</span>&gt;&lt;<span style="color: #00ede1; font-weight: bold;">br</span>&gt;
          &lt;<span style="color: #00ede1; font-weight: bold;">a</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"http://a.com"</span> <span style="color: #dbdb95;">target</span>=<span style="color: #e67128;">"_blank"</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"text-decoration:none;color:#545759;"</span>&gt;www.a.com&lt;/<span style="color: #00ede1; font-weight: bold;">a</span>&gt;
        &lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
      &lt;/<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-table</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
</pre>
</div>
</div>
</li>

<li><a id="org12a3fc2"></a>mj-raw<br />
<div class="outline-text-6" id="text-7-9-12-16-8">
<p>
Not to be rendered by MJML engine
</p>

<p>
<a id="orgb83cf64">mjml:raw:center table</a>
This won't work for Yahoo! Mail but works on all clients
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mj-style</span> <span style="color: #dbdb95;">inline</span>=<span style="color: #e67128;">"inline"</span>&gt;
  .tbl-cell-1 {
  font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;
  font-size:12px;
  padding:0px 0px 10px 0px;
  width:30px;
  }
  .tbl-cell-2, .tbl-cell-3 {
  width:30px;
  }
&lt;/<span style="color: #00ede1; font-weight: bold;">mj-style</span>&gt;

&lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;...&lt;/<span style="color: #00ede1; font-weight: bold;">mj-text</span>&gt;

  <span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">each mj-element under mj-column is &lt;tr&gt;&lt;td&gt; content &lt;/td&gt;&lt;/tr&gt; </span><span style="color: #74af68;">--&gt;</span>
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-raw</span>&gt;

    &lt;<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">table</span> <span style="color: #dbdb95;">align</span>=<span style="color: #e67128;">"center"</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"110"</span> <span style="color: #dbdb95;">cellpadding</span>=<span style="color: #e67128;">"0"</span> <span style="color: #dbdb95;">cellspacing</span>=<span style="color: #e67128;">"0"</span> <span style="color: #dbdb95;">border</span>=<span style="color: #e67128;">"0"</span>&gt;
          <span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">right also works </span><span style="color: #74af68;">--&gt;</span>
          &lt;<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
            &lt;<span style="color: #00ede1; font-weight: bold;">td</span> <span style="color: #dbdb95;">align</span>=<span style="color: #e67128;">"center"</span> <span style="color: #dbdb95;">class</span>=<span style="color: #e67128;">"tbl-cell-1"</span>&gt;&lt;<span style="color: #00ede1; font-weight: bold;">a</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"#"</span>&gt;
                &lt;<span style="color: #00ede1; font-weight: bold;">img</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"30"</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"twitter.png"</span> /&gt;
            &lt;/<span style="color: #00ede1; font-weight: bold;">a</span>&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
            &lt;<span style="color: #00ede1; font-weight: bold;">td</span> <span style="color: #dbdb95;">align</span>=<span style="color: #e67128;">"center"</span> <span style="color: #dbdb95;">class</span>=<span style="color: #e67128;">"tbl-cell-2"</span>&gt;&lt;<span style="color: #00ede1; font-weight: bold;">a</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"#"</span>&gt;
                &lt;<span style="color: #00ede1; font-weight: bold;">img</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"30"</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"twitter.png"</span> /&gt;
            &lt;/<span style="color: #00ede1; font-weight: bold;">a</span>&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
            &lt;<span style="color: #00ede1; font-weight: bold;">td</span> <span style="color: #dbdb95;">align</span>=<span style="color: #e67128;">"center"</span> <span style="color: #dbdb95;">class</span>=<span style="color: #e67128;">"tbl-cell-3"</span>&gt;&lt;<span style="color: #00ede1; font-weight: bold;">a</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"#"</span>&gt;
                &lt;<span style="color: #00ede1; font-weight: bold;">img</span> <span style="color: #dbdb95;">width</span>=<span style="color: #e67128;">"30"</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"twitter.png"</span> /&gt;
            &lt;/<span style="color: #00ede1; font-weight: bold;">a</span>&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
          &lt;/<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
        &lt;/<span style="color: #00ede1; font-weight: bold;">table</span>&gt;
      &lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-raw</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
</pre>
</div>
</div>
</li>

<li><a id="orgbe93d96"></a>mj-hero<br />
<div class="outline-text-6" id="text-7-9-12-16-9">
<p>
Display a section with a background image and some content inside (mj-text, mj-button, mj-image …) wrapped in mj-hero-content component
</p>

<p>
<a href="#orga9c5f19">mjml:tag:mj-hero</a>
</p>
</div>
</li>

<li><a id="orgb818b2f"></a>mj-invoice<br /></li>
<li><a id="orgadc70c2"></a>mj-location<br /></li>
<li><a id="orga64f5ca"></a>mj-navbar<br />
<div class="outline-text-6" id="text-7-9-12-16-12">
<p>
<a href="https://mjml.io/documentation/#mjml-navbar">https://mjml.io/documentation/#mjml-navbar</a>
So far, all have been tested only show expanded items.
</p>
</div>
</li>

<li><a id="org366e7f8"></a>mj-carousel<br />
<div class="outline-text-6" id="text-7-9-12-16-13">
<p>
<a href="https://mjml.io/documentation/#mjml-carousel">https://mjml.io/documentation/#mjml-carousel</a>
Outlook and OWA only shows the first image. Works for Gmail.com and Android Gmail.
</p>
</div>
</li>

<li><a id="org19615e7"></a>mj-accordion<br />
<div class="outline-text-6" id="text-7-9-12-16-14">
<p>
<a href="https://mjml.io/documentation/#mjml-accordion">https://mjml.io/documentation/#mjml-accordion</a>
Every attribute in `mj-accordion` are applied to `mj-accordion-element` unless you overide them on `mj-accordion-element`
</p>

<p>
So far, all have been tested only show expanded items.
</p>

<p>
The "hamburger" feature only work on mobile device with all iOS mail client, for others mail clients the render is performed on an normal way, the links are displayed inline and the hamburger is not visible.
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">mjml</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">mj-head</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-attributes</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">mj-accordion</span> <span style="color: #dbdb95;">border</span>=<span style="color: #e67128;">"none"</span> <span style="color: #dbdb95;">padding</span>=<span style="color: #e67128;">"1px"</span> /&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">mj-accordion-element</span> <span style="color: #dbdb95;">icon-wrapped-url</span>=<span style="color: #e67128;">"http://i.imgur.com/Xvw0vjq.png"</span> <span style="color: #dbdb95;">icon-unwrapped-url</span>=<span style="color: #e67128;">"http://i.imgur.com/KKHenWa.png"</span> <span style="color: #dbdb95;">icon-height</span>=<span style="color: #e67128;">"24px"</span> <span style="color: #dbdb95;">icon-width</span>=<span style="color: #e67128;">"24px"</span> /&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">mj-accordion-title</span> <span style="color: #dbdb95;">font-family</span>=<span style="color: #e67128;">"Roboto, Open Sans, Helvetica, Arial, sans-serif"</span> <span style="color: #dbdb95;">background-color</span>=<span style="color: #e67128;">"#fff"</span> <span style="color: #dbdb95;">color</span>=<span style="color: #e67128;">"#031017"</span> <span style="color: #dbdb95;">padding</span>=<span style="color: #e67128;">"15px"</span> <span style="color: #dbdb95;">font-size</span>=<span style="color: #e67128;">"18px"</span> /&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">mj-accordion-text</span> <span style="color: #dbdb95;">font-family</span>=<span style="color: #e67128;">"Open Sans, Helvetica, Arial, sans-serif"</span> <span style="color: #dbdb95;">background-color</span>=<span style="color: #e67128;">"#fafafa"</span> <span style="color: #dbdb95;">padding</span>=<span style="color: #e67128;">"15px"</span> <span style="color: #dbdb95;">color</span>=<span style="color: #e67128;">"#505050"</span> <span style="color: #dbdb95;">font-size</span>=<span style="color: #e67128;">"14px"</span> /&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-attributes</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-head</span>&gt;

  &lt;<span style="color: #00ede1; font-weight: bold;">mj-body</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">mj-section</span> <span style="color: #dbdb95;">padding</span>=<span style="color: #e67128;">"20px"</span> <span style="color: #dbdb95;">background-color</span>=<span style="color: #e67128;">"#ffffff"</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">mj-column</span> <span style="color: #dbdb95;">background-color</span>=<span style="color: #e67128;">"#dededd"</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">mj-accordion</span>&gt;
          &lt;<span style="color: #00ede1; font-weight: bold;">mj-accordion-element</span>&gt;
            &lt;<span style="color: #00ede1; font-weight: bold;">mj-accordion-title</span>&gt;Why use an accordion?&lt;/<span style="color: #00ede1; font-weight: bold;">mj-accordion-title</span>&gt;
            &lt;<span style="color: #00ede1; font-weight: bold;">mj-accordion-text</span>&gt;
              &lt;<span style="color: #00ede1; font-weight: bold;">span</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"line-height:20px"</span>&gt;
                Because emails with a lot of content are most of the time a very bad experience on mobile, mj-accordion comes handy when you want to deliver a lot of information in a concise way.
              &lt;/<span style="color: #00ede1; font-weight: bold;">span</span>&gt;
            &lt;/<span style="color: #00ede1; font-weight: bold;">mj-accordion-text</span>&gt;
          &lt;/<span style="color: #00ede1; font-weight: bold;">mj-accordion-element</span>&gt;
          &lt;<span style="color: #00ede1; font-weight: bold;">mj-accordion-element</span>&gt;
            &lt;<span style="color: #00ede1; font-weight: bold;">mj-accordion-title</span>&gt;How it works&lt;/<span style="color: #00ede1; font-weight: bold;">mj-accordion-title</span>&gt;
            &lt;<span style="color: #00ede1; font-weight: bold;">mj-accordion-text</span>&gt;
              &lt;<span style="color: #00ede1; font-weight: bold;">span</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"line-height:20px"</span>&gt;
                Content is stacked into tabs and users can expand them at will. If responsive styles are not supported (mostly on desktop clients), tabs are then expanded and your content is readable at once.
              &lt;/<span style="color: #00ede1; font-weight: bold;">span</span>&gt;
            &lt;/<span style="color: #00ede1; font-weight: bold;">mj-accordion-text</span>&gt;
          &lt;/<span style="color: #00ede1; font-weight: bold;">mj-accordion-element</span>&gt;
        &lt;/<span style="color: #00ede1; font-weight: bold;">mj-accordion</span>&gt;
      &lt;/<span style="color: #00ede1; font-weight: bold;">mj-column</span>&gt;
    &lt;/<span style="color: #00ede1; font-weight: bold;">mj-section</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">mj-body</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">mjml</span>&gt;
</pre>
</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-org9cb16df" class="outline-5">
<h5 id="org9cb16df"><span class="section-number-5">7.9.12.17</span> mj-group to group columns</h5>
<div class="outline-text-5" id="text-7-9-12-17">
<p>
Prevent columns from stacking on mobile.
</p>

<p>
Columns inside a group must have a width in percentage or auto sizing, but not in pixel
</p>

<p>
Section can have both mj-column and mj-group.
</p>

<p>
iOS 9 :: always remove space between columns inside a mj-group. Or export HTML using minify.
</p>

<dl class="org-dl">
<dt>width</dt><dd>100 / number of children in section (%/px)</dd>
<dt>vertical-align</dt><dd>top</dd>
<dt>background-color</dt><dd>default n/a</dd>
</dl>
</div>
</div>

<div id="outline-container-org31f2b70" class="outline-5">
<h5 id="org31f2b70"><span class="section-number-5">7.9.12.18</span> Background Image</h5>
<div class="outline-text-5" id="text-7-9-12-18">
<p>
<a href="https://litmus.com/blog/the-ultimate-guide-to-background-images-in-email">Docs from Litmus</a>
</p>

<p>
background-url can only be used in mj-hero, mj-section, mj-wrapper
background-position can only be set in mj-hero and top center for other mjml elements
</p>
</div>
</div>

<div id="outline-container-orgb60f84c" class="outline-5">
<h5 id="orgb60f84c"><span class="section-number-5">7.9.12.19</span> Hide for mobile</h5>
<div class="outline-text-5" id="text-7-9-12-19">
<p>
Can't apply directly to mj-column
</p>

<p>
Because a lot of mobile email clients don't support media query but supports CSS
</p>
<div class="org-src-container">
<pre class="src src-css"><span style="color: #00ede1; font-weight: bold;">.cs-column-right-img </span>{ <span style="color: #ffad29; font-weight: bold;">display</span>: none <span style="color: #23d7d7;">!important</span>;}
<span style="color: #23d7d7;">@media</span> only screen and (min-width: 480px) { .cs-column-right-img { <span style="color: #ffad29; font-weight: bold;">display</span>: block <span style="color: #23d7d7;">!important</span>;} }
</pre>
</div>
</div>
</div>

<div id="outline-container-orge5bb0c8" class="outline-5">
<h5 id="orge5bb0c8"><span class="section-number-5">7.9.12.20</span> Change default padding</h5>
<div class="outline-text-5" id="text-7-9-12-20">
<p>
Use this to change left/right padding in % is not consistent especially in Outlook 2003-2016. For Outlook desktop, you may need to hard set mj-image width.
</p>
<pre class="example">
&lt;mjml&gt;
  &lt;mj-head&gt;
    &lt;mj-attributes&gt;
      &lt;mj-all padding-left="0px"&gt;&lt;/mj-all&gt;
      &lt;mj-all padding-right="0px"&gt;&lt;/mj-all&gt;
    &lt;/mj-attributes&gt;
  &lt;/mj-head&gt;

&lt;mj-section padding-left="12%" padding-right="12%"&gt;
&lt;/mj-section&gt;
</pre>
</div>
</div>

<div id="outline-container-orgb8a166b" class="outline-5">
<h5 id="orgb8a166b"><span class="section-number-5">7.9.12.21</span> Caveats</h5>
<div class="outline-text-5" id="text-7-9-12-21">
<p>
mj-image inside mj-column will always have a maximum fixed width.
</p>

<p>
If there's one mj-column, then mj-image is 100% of the mj-column.
</p>

<p>
If there're 2 mj-columns, then mj-image is 50% of the whole width = 300px
</p>

<p>
If there're 3 mj-columns, mj-image is 196px.
</p>

<p>
You can align mj-image left or right inside a mj-column. And when you do that, pay attention to the padding. Usually don't set padding:0
When in mobile, &lt;p&gt; has padding-left:10px. So you could do
</p>
<pre class="example">
&lt;mj-section full-width="full-width"&gt;
  &lt;mj-group&gt;
    &lt;mj-column width="50%"&gt;
      &lt;mj-image src="logo1.jpg" width="103" align="left" padding="10px 0 0 10px" /&gt;
    &lt;/mj-column&gt;
    &lt;mj-column width="50%"&gt;
      &lt;mj-image src="logo2.jpg" width="96" align="right" padding="10px 10px 0 0"/&gt;
    &lt;/mj-column&gt;
  &lt;/mj-group&gt;
&lt;/mj-section&gt;
</pre>

<p>
mj-section, mj-column don't have left and right padding by default.
</p>

<p>
mj-image has padding:10px 25px by default
</p>
</div>
</div>
</div>

<div id="outline-container-org8927271" class="outline-4">
<h4 id="org8927271"><span class="section-number-4">7.9.13</span> Non breaking</h4>
<div class="outline-text-4" id="text-7-9-13">
<pre class="example">
&amp;nbsp; ::
&amp;#x2011; :: hyphen
</pre>
</div>
</div>

<div id="outline-container-org6ac70e1" class="outline-4">
<h4 id="org6ac70e1"><span class="section-number-4">7.9.14</span> Don't use anchor link!</h4>
</div>
</div>
<div id="outline-container-org28e4846" class="outline-3">
<h3 id="org28e4846"><span class="section-number-3">7.10</span> Phone number</h3>
<div class="outline-text-3" id="text-7-10">
<p>
&lt;a href="tel:+18475555555"&gt;1-847-555-5555&lt;/a&gt;
</p>

<p>
// javascript
window.open('tel:+11231231234');
</p>
</div>
</div>
<div id="outline-container-orgb9ee2b0" class="outline-3">
<h3 id="orgb9ee2b0"><span class="section-number-3">7.11</span> link <a id="org3e4c698">html:link</a></h3>
<div class="outline-text-3" id="text-7-11">
</div>
<div id="outline-container-org5f5f7b9" class="outline-4">
<h4 id="org5f5f7b9"><span class="section-number-4">7.11.1</span> rel="preload" <a id="org45f4a2b">html:link:rel:preload</a></h4>
<div class="outline-text-4" id="text-7-11-1">
<p>
Not supported in IE11-, Edge, Safari 11-, iOS Safari 11.2-
</p>

<ul class="org-ul">
<li>Resources loaded via &lt;link rel="preload"&gt; are stored locally in the browser, and are effectively inert until they’re referenced in the DOM, JavaScript, or CSS.</li>
<li>Does not block window.onload event.</li>
<li>To load late-discovered critical resources which will be loaded very soon at current request.</li>
<li>Compliant with Content-Security-Policy and http header Accept</li>
</ul>

<pre class="example">
&lt;link rel="preload" href="used-later.js" as="script"&gt;
&lt;!-- ...other HTML... --&gt;
&lt;script&gt;
  // Later on, after some condition has been met, we run the preloaded
  // JavaScript by inserting a &lt;script&gt; tag into the DOM.
  var usedLaterScript = document.createElement('script');
  usedLaterScript.src = 'used-later.js';    
  document.body.appendChild(usedLaterScript)
&lt;/script&gt;
</pre>

<p>
as="script" refers to consumer tag &lt;script&gt;
</p>

<p>
If as is not defined, it's equivalent to XHR request with low priority.
</p>

<p>
&lt;link rel="preload" as="image" href="logo.jpg"/&gt;
</p>

<p>
Preload font
</p>
<ul class="org-ul">
<li>Font needs crossorigin even it's on the same origin. type is also needed.</li>
<li>&lt;link rel="preload" href="font.woff2" as="font" type="font/woff2" crossorigin&gt;</li>
<li>Not all browsers support &lt;link rel="preload"&gt;, and in those browsers, &lt;link rel="preload"&gt; will just be ignored. But every browser that supports preloading also supports WOFF2, so that's always the format that you should preload.</li>
<li>preload won't have the ability to @font-face local(), so the font will be always downloaded</li>
</ul>

<p>
Refer to <a href="#org95f1fcb">html:preload video</a>
</p>

<p>
If you don't want to preload a resource at page load but want to preload it before it's used:
</p>
<pre class="example">
var preload = document.createElement("link");
link.href = "myscript.js";
link.rel = "preload";
link.as = "script";
document.head.appendChild(link);

// later
var script = document.createElement("script");
script.src = "myscript.js";
document.body.appendChild(script);
</pre>

<p>
Preload with onload, do something when resource is downloaded which is different from window.onload
</p>
<pre class="example">
&lt;link rel="preload" as="style" href="async_style.css" onload="this.rel='stylesheet'"&gt;

var asyncScriptOnLoad = function() {
  var script = document.createElement('script');
  script.src = this.href;
  document.body.appendChild(script);
};

&lt;link rel="preload" as="script" href="async_script.js"
onload="asyncScriptOnLoad();"&gt;
</pre>

<p>
Preload with media (responsive loading)
</p>
<pre class="example">
&lt;link rel="preload" as="image" href="map.png" media="(max-width: 600px)"&gt;
&lt;link rel="preload" as="script" href="map.js" media="(min-width: 601px)"&gt;
</pre>

<p>
Detect if <code>&lt;link rel="preload"&gt;</code> is supported
</p>
<pre class="example">
const preloadSupported = () =&gt; {
  const link = document.createElement('link');
  const relList = link.relList;
  if (!relList || !relList.supports)
    return false;
  return relList.supports('preload');
};
</pre>

<p>
HTTP/2 Server Push can push resources to browser before browser sends the request for them. Which means Push can send resources before HTML even started to be sent to the browser. Resources have to be on the same origin.
</p>

<p>
Preload can be used for all origins.
</p>
</div>
</div>

<div id="outline-container-org091bb85" class="outline-4">
<h4 id="org091bb85"><span class="section-number-4">7.11.2</span> rel="prefetch"</h4>
<div class="outline-text-4" id="text-7-11-2">
<p>
Has better browser support. Download non-critical resources earlier. Prefetch non-recursively fetches the top level resource not the child resources.
Downloads the same css 2 times.
</p>
<pre class="example">
&lt;link rel="prefetch" href="optional.css"&gt;
&lt;link rel="stylesheet" href="optional.css"&gt;
</pre>

<p>
Network Prioritisation :: <a href="https://medium.com/reloading/preload-prefetch-and-priorities-in-chrome-776165961bbf">https://medium.com/reloading/preload-prefetch-and-priorities-in-chrome-776165961bbf</a>
</p>

<p>
Priority shown in DevTools:
</p>

<dl class="org-dl">
<dt>Highest</dt><dd>layout-blocking
<dl class="org-dl">
<dt>CSS inside &lt;head&gt;</dt><dd>match</dd>
<dt>(no term)</dt><dd>Font</dd>
<dt>(no term)</dt><dd>XHR (sync)</dd>
<dt>(no term)</dt><dd>&lt;link rel=preload as=style&gt;</dd>
</dl></dd>
<dt>High</dt><dd>load in layout-blocking phase
<dl class="org-dl">
<dt>&lt;script&gt; inside &lt;head&gt;</dt><dd>requested before any non-preloaded images</dd>
<dt>(no term)</dt><dd>&lt;link rel=preload as=script&gt;</dd>
<dt>(no term)</dt><dd>&lt;link rel=preload as=font&gt;</dd>
<dt>(no term)</dt><dd>Import</dd>
<dt>(no term)</dt><dd>Image (in viewport)</dd>
<dt>(no term)</dt><dd>&lt;link rel=preload&gt; with no as will behave as XHR</dd>
<dt>(no term)</dt><dd>XSL</dd>
<dt>(no term)</dt><dd>XHR/fetch* (async)</dd>
</dl></dd>
<dt>Medium</dt><dd>Load one-at-a-time in layout-blocking phase
<dl class="org-dl">
<dt>&lt;script&gt;</dt><dd>requested after any non-preloaded images</dd>
<dt>(no term)</dt><dd>Favicon</dd>
</dl></dd>
<dt>Low</dt><dd>Load one-at-a-time in layout-blocking phase
<ul class="org-ul">
<li>&lt;script async&gt;</li>
<li>&lt;script defer&gt;</li>
<li>Injected &lt;script&gt;</li>
<li>Image</li>
<li>&lt;link rel=preload as="image"&gt;</li>
<li>Media</li>
<li>SVG</li>
</ul></dd>
<dt>Lowest</dt><dd>Load one-at-a-time for layout-blocking phase. after current page is done loading and there's bandwidth available
<dl class="org-dl">
<dt>CSS</dt><dd>mismatch</dd>
<dt>(no term)</dt><dd>&lt;link rel="prefetch"&gt;</dd>
</dl></dd>
</dl>
</div>
</div>

<div id="outline-container-orgda31106" class="outline-4">
<h4 id="orgda31106"><span class="section-number-4">7.11.3</span> rel="canonical"</h4>
<div class="outline-text-4" id="text-7-11-3">
<pre class="example">
// desktop page: http://www.example.com/page-1
&lt;link rel="alternate" media="only screen and (max-width: 640px)" href="http://m.example.com/page-1"&gt;

// mobile page: http://m.example.com/page-1
&lt;link rel="canonical" href="http://www.example.com/page-1"&gt;

// sitemap
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
        xmlns:xhtml="http://www.w3.org/1999/xhtml"&gt;
    &lt;url&gt;
        &lt;loc&gt;http://www.example.com/page-1/&lt;/loc&gt;
        &lt;xhtml:link
                rel="alternate"
                media="only screen and (max-width: 640px)"
                href="http://m.example.com/page-1" /&gt;
    &lt;/url&gt;
&lt;/urlset&gt;
</pre>
</div>
</div>

<div id="outline-container-org3aaf91e" class="outline-4">
<h4 id="org3aaf91e"><span class="section-number-4">7.11.4</span> rel="dns-prefetch"</h4>
<div class="outline-text-4" id="text-7-11-4">
<pre class="example">
&lt;link rel="dns-prefetch" href="http://www.spreadfirefox.com/"&gt;
&lt;link rel="dns-prefetch" href="//www.spreadfirefox.com"&gt;
</pre>

<p>
rel="preconnect" has less browser support and it's a superset of dns-prefetch
</p>
</div>
</div>

<div id="outline-container-org379d74d" class="outline-4">
<h4 id="org379d74d"><span class="section-number-4">7.11.5</span> rel="manifest.json" <a id="orgbb5fed7">html:link:rel:manifest</a></h4>
<div class="outline-text-4" id="text-7-11-5">
<p>
Required by Crhome to show the Add to Home Screen prompt.
</p>

<p>
DevTools &gt; Application &gt; Manifest
</p>

<pre class="example">
&lt;link rel="manifest" href="/manifest.json"&gt;

{
  "short_name": "Maps",
  "name": "Google Maps", // your app name

  // If you want to have your own size, provide icons in increments of 48px or 128px.
  "icons": [

    {
      "src": "/images/icons-192.png",
      "type": "image/png",
      "sizes": "192x192"
    },
    {
      "src": "/images/icons-512.png",
      "type": "image/png",
      "sizes": "512x512"
    }
  ],

  "start_url": "/?utm_source=pwa", // the page the app should start with. Tracking query string can be added e.g. track how often the app is launched.
  "background_color": "#3367D6",

  "display": "standalone",
  // standalone: separte from the browser and runs in its own window.
  // fullscreen: no browser UI
  // minimal-ui: not supported by Chrome. Similar to fullscreen but might have other navigation (back, forward, reload)
  // browser: a standard browser experience

  // "orientation": "landscape",
  // Enforce an orientation

  "scope": "/maps/",
  // if current page is not inside this directory, then the user exists the app
  // If scope is not defined, then default is the directory that the app manifest is served from
  // can be relative path e.g. ../
  // start_url must be in the scope
  // start _url is relative to the path defined in scope
  // start_url starting with / will always be the root of the origin

  "theme_color": "#3367D6"
}
</pre>
</div>
</div>

<div id="outline-container-org71fb985" class="outline-4">
<h4 id="org71fb985"><span class="section-number-4">7.11.6</span> Stylesheet for a media</h4>
<div class="outline-text-4" id="text-7-11-6">
<pre class="example">
&lt;link rel="stylesheet" href="print.css" media="print"&gt;
</pre>
<p>
Or use <a href="#org7f0d2b3">css:@media:type</a>
</p>
</div>
</div>

<div id="outline-container-orgb4e73fc" class="outline-4">
<h4 id="orgb4e73fc"><span class="section-number-4">7.11.7</span> rel="icon" rel="apple-touch-startup-image" rel="apple-touch-icon"</h4>
<div class="outline-text-4" id="text-7-11-7">
<p>
Refer to <a href="#org049adae">html:address bar</a>
<a href="https://developers.google.com/web/fundamentals/design-and-ux/browser-customization/">https://developers.google.com/web/fundamentals/design-and-ux/browser-customization/</a>
</p>

<p>
Chrome and Opera in scale of 48px (muliple sizes can be added)
</p>
<pre class="example">
&lt;link rel="icon" sizes="192x192" href="icon.png"&gt;
</pre>

<p>
IE Tiles :: 4 sizes. Listed are standard size. 1.8 times is better.
</p>
<pre class="example">
&lt;meta name="application-name" content="CenturyCutCook" /&gt;
&lt;meta name="msapplication-TitleColor" content="#009900" /&gt;

&lt;meta name="msapplication-sqaure70x70logo" content="icon_smalltitle.png"&gt;
&lt;meta name="msapplication-sqaure150x150logo" content="icon_mediumitle.png"&gt;
&lt;meta name="msapplication-sqaure310x150logo" content="icon_widetitle.png"&gt;
&lt;meta name="msapplication-sqaure310x310logo" content="icon_largetitle.png"&gt;
</pre>

<p>
Apple Icon :: Default 60x60
</p>
<pre class="example">
&lt;link rel="apple-touch-icon" href="touch-icon-iphone.png"&gt;
&lt;link rel="apple-touch-icon" sizes="76x76" href="touch-icon-ipad.png"&gt;
&lt;link rel="apple-touch-icon" sizes="120x120" href="touch-icon-iphone-retina.png"&gt;
&lt;link rel="apple-touch-icon" sizes="152x152" href="touch-icon-ipad-retina.png"&gt;
</pre>

<p>
Apple :: Startup Image. By default, Safari shows a blank screen during load time and after multiple loads a screenshot of the previous state of the app.
Base Size :: 320x480. But different devices ask for different sizes. Follow this to implement
</p>
<pre class="example">
&lt;link rel="apple-touch-startup-image" href="/startup.png"&gt;

&lt;!-- iPad retina portrait startup image --&gt;
&lt;link href="https://placehold.it/1536x2008"
      media="(device-width: 768px) and (device-height: 1024px)
                 and (-webkit-device-pixel-ratio: 2)
                 and (orientation: portrait)"
      rel="apple-touch-startup-image"&gt;

&lt;!-- iPad retina landscape startup image --&gt;
&lt;link href="https://placehold.it/1496x2048"
      media="(device-width: 768px) and (device-height: 1024px)
                 and (-webkit-device-pixel-ratio: 2)
                 and (orientation: landscape)"
      rel="apple-touch-startup-image"&gt;

&lt;!-- iPad non-retina portrait startup image --&gt;
&lt;link href="https://placehold.it/768x1004"
      media="(device-width: 768px) and (device-height: 1024px)
                 and (-webkit-device-pixel-ratio: 1)
                 and (orientation: portrait)"
      rel="apple-touch-startup-image"&gt;

&lt;!-- iPad non-retina landscape startup image --&gt;
&lt;link href="https://placehold.it/748x1024"
      media="(device-width: 768px) and (device-height: 1024px)
                 and (-webkit-device-pixel-ratio: 1)
                 and (orientation: landscape)"
      rel="apple-touch-startup-image"&gt;

&lt;!-- iPhone 6 Plus portrait startup image --&gt;
&lt;link href="https://placehold.it/1242x2148"
      media="(device-width: 414px) and (device-height: 736px)
                 and (-webkit-device-pixel-ratio: 3)
                 and (orientation: portrait)"
      rel="apple-touch-startup-image"&gt;

&lt;!-- iPhone 6 Plus landscape startup image --&gt;
&lt;link href="https://placehold.it/1182x2208"
      media="(device-width: 414px) and (device-height: 736px)
                 and (-webkit-device-pixel-ratio: 3)
                 and (orientation: landscape)"
      rel="apple-touch-startup-image"&gt;

&lt;!-- iPhone 6 startup image --&gt;
&lt;link href="https://placehold.it/750x1294"
      media="(device-width: 375px) and (device-height: 667px)
                 and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image"&gt;

&lt;!-- iPhone 5 startup image --&gt;
&lt;link href="https://placehold.it/640x1096"
      media="(device-width: 320px) and (device-height: 568px)
                 and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image"&gt;

&lt;!-- iPhone &lt; 5 retina startup image --&gt;
&lt;link href="https://placehold.it/640x920"
      media="(device-width: 320px) and (device-height: 480px)
                 and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image"&gt;

&lt;!-- iPhone &lt; 5 non-retina startup image --&gt;
&lt;link href="https://placehold.it/320x460"
      media="(device-width: 320px) and (device-height: 480px)
                 and (-webkit-device-pixel-ratio: 1)"
      rel="apple-touch-startup-image"&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfdcbe39" class="outline-3">
<h3 id="orgfdcbe39"><span class="section-number-3">7.12</span> Autofill, Input Types</h3>
<div class="outline-text-3" id="text-7-12">
<p>
<a href="https://developers.google.com/web/updates/2015/06/checkout-faster-with-autofill">https://developers.google.com/web/updates/2015/06/checkout-faster-with-autofill</a>
</p>

<p>
Autofill hint set :: the address or contact info type
</p>
<dl class="org-dl">
<dt>autocomplete="shipping locality"</dt><dd>"shipping" or "billing" meaning the field is part of the shipping address or contact information.</dd>
</dl>

<p>
These apply to telephone, emails and instant messaging
</p>
<ul class="org-ul">
<li>home, work, mobile, fax, pager</li>
</ul>

<p>
section-* may be added with autofill hint set. The whole thing is called autofill scope.
</p>

<p>
<a href="https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#autofill-field">Autofill fields</a> :: have to match &lt;input&gt; type e.g. text, select, etc.
</p>

<p>
Wrap &lt;input&gt; inside &lt;form&gt; in order for autocomplete to work in Chrome.
</p>

<p>
[section-](optional) [shipping|billing](optional) [home|work|mobile|fax|pager](optional) [autofill field name]
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">label</span> <span style="color: #dbdb95;">for</span>=<span style="color: #e67128;">"frmNameCC"</span>&gt;Name on card&lt;/<span style="color: #00ede1; font-weight: bold;">label</span>&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">input</span> <span style="color: #dbdb95;">name</span>=<span style="color: #e67128;">"ccname"</span> <span style="color: #dbdb95;">id</span>=<span style="color: #e67128;">"frmNameCC"</span> required <span style="color: #dbdb95;">placeholder</span>=<span style="color: #e67128;">"Full Name"</span> <span style="color: #dbdb95;">autocomplete</span>=<span style="color: #e67128;">"cc-name"</span>&gt;

&lt;<span style="color: #00ede1; font-weight: bold;">label</span> <span style="color: #dbdb95;">for</span>=<span style="color: #e67128;">"frmCCNum"</span>&gt;Card Number&lt;/<span style="color: #00ede1; font-weight: bold;">label</span>&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">input</span> <span style="color: #dbdb95;">name</span>=<span style="color: #e67128;">"cardnumber"</span> <span style="color: #dbdb95;">id</span>=<span style="color: #e67128;">"frmCCNum"</span> required <span style="color: #dbdb95;">autocomplete</span>=<span style="color: #e67128;">"cc-number"</span>&gt;

&lt;<span style="color: #00ede1; font-weight: bold;">label</span> <span style="color: #dbdb95;">for</span>=<span style="color: #e67128;">"frmCCCVC"</span>&gt;CVC&lt;/<span style="color: #00ede1; font-weight: bold;">label</span>&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">input</span> <span style="color: #dbdb95;">name</span>=<span style="color: #e67128;">"cvc"</span> <span style="color: #dbdb95;">id</span>=<span style="color: #e67128;">"frmCCCVC"</span> required <span style="color: #dbdb95;">autocomplete</span>=<span style="color: #e67128;">"cc-csc"</span>&gt;

&lt;<span style="color: #00ede1; font-weight: bold;">label</span> <span style="color: #dbdb95;">for</span>=<span style="color: #e67128;">"frmCCExp"</span>&gt;Expiry&lt;/<span style="color: #00ede1; font-weight: bold;">label</span>&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">input</span> <span style="color: #dbdb95;">name</span>=<span style="color: #e67128;">"cc-exp"</span> <span style="color: #dbdb95;">id</span>=<span style="color: #e67128;">"frmCCExp"</span> required <span style="color: #dbdb95;">placeholder</span>=<span style="color: #e67128;">"MM-YYYY"</span> <span style="color: #dbdb95;">autocomplete</span>=<span style="color: #e67128;">"cc-exp"</span>&gt;

&lt;<span style="color: #00ede1; font-weight: bold;">label</span> <span style="color: #dbdb95;">for</span>=<span style="color: #e67128;">"frmCityS"</span>&gt;City&lt;/<span style="color: #00ede1; font-weight: bold;">label</span>&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">input</span> <span style="color: #dbdb95;">name</span>=<span style="color: #e67128;">"ship-city"</span> required <span style="color: #dbdb95;">id</span>=<span style="color: #e67128;">"frmCityS"</span> <span style="color: #dbdb95;">placeholder</span>=<span style="color: #e67128;">"New York"</span> <span style="color: #dbdb95;">autocomplete</span>=<span style="color: #e67128;">"shipping locality"</span>&gt;

&lt;<span style="color: #00ede1; font-weight: bold;">fieldset</span>&gt;
 &lt;<span style="color: #00ede1; font-weight: bold;">legend</span>&gt;Ship the blue gift to...&lt;/<span style="color: #00ede1; font-weight: bold;">legend</span>&gt;
 &lt;<span style="color: #00ede1; font-weight: bold;">p</span>&gt; &lt;<span style="color: #00ede1; font-weight: bold;">label</span>&gt; Address:     &lt;<span style="color: #00ede1; font-weight: bold;">textarea</span> name=ba <span style="color: #dbdb95;">autocomplete</span>=<span style="color: #e67128;">"section-blue shipping street-address"</span>&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">textarea</span>&gt; &lt;/<span style="color: #00ede1; font-weight: bold;">label</span>&gt;
 &lt;<span style="color: #00ede1; font-weight: bold;">p</span>&gt; &lt;<span style="color: #00ede1; font-weight: bold;">label</span>&gt; City:        &lt;<span style="color: #00ede1; font-weight: bold;">input</span> name=bc <span style="color: #dbdb95;">autocomplete</span>=<span style="color: #e67128;">"section-blue shipping address-level2"</span>&gt; &lt;/<span style="color: #00ede1; font-weight: bold;">label</span>&gt;
 &lt;<span style="color: #00ede1; font-weight: bold;">p</span>&gt; &lt;<span style="color: #00ede1; font-weight: bold;">label</span>&gt; Postal Code: &lt;<span style="color: #00ede1; font-weight: bold;">input</span> name=bp <span style="color: #dbdb95;">autocomplete</span>=<span style="color: #e67128;">"section-blue shipping postal-code"</span>&gt; &lt;/<span style="color: #00ede1; font-weight: bold;">label</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">fieldset</span>&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">fieldset</span>&gt;
 &lt;<span style="color: #00ede1; font-weight: bold;">legend</span>&gt;Ship the red gift to...&lt;/<span style="color: #00ede1; font-weight: bold;">legend</span>&gt;
 &lt;<span style="color: #00ede1; font-weight: bold;">p</span>&gt; &lt;<span style="color: #00ede1; font-weight: bold;">label</span>&gt; Address:     &lt;<span style="color: #00ede1; font-weight: bold;">textarea</span> name=ra <span style="color: #dbdb95;">autocomplete</span>=<span style="color: #e67128;">"section-red shipping street-address"</span>&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">textarea</span>&gt; &lt;/<span style="color: #00ede1; font-weight: bold;">label</span>&gt;
 &lt;<span style="color: #00ede1; font-weight: bold;">p</span>&gt; &lt;<span style="color: #00ede1; font-weight: bold;">label</span>&gt; City:        &lt;<span style="color: #00ede1; font-weight: bold;">input</span> name=rc <span style="color: #dbdb95;">autocomplete</span>=<span style="color: #e67128;">"section-red shipping address-level2"</span>&gt; &lt;/<span style="color: #00ede1; font-weight: bold;">label</span>&gt;
 &lt;<span style="color: #00ede1; font-weight: bold;">p</span>&gt; &lt;<span style="color: #00ede1; font-weight: bold;">label</span>&gt; Postal Code: &lt;<span style="color: #00ede1; font-weight: bold;">input</span> name=rp <span style="color: #dbdb95;">autocomplete</span>=<span style="color: #e67128;">"section-red shipping postal-code"</span>&gt; &lt;/<span style="color: #00ede1; font-weight: bold;">label</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">fieldset</span>&gt;
</pre>
</div>
</div>

<div id="outline-container-orgd318977" class="outline-4">
<h4 id="orgd318977"><span class="section-number-4">7.12.1</span> Input Types</h4>
<div class="outline-text-4" id="text-7-12-1">
<p>
<a href="https://developers.google.com/web/fundamentals/design-and-ux/input/forms/">Input types</a>
</p>
<dl class="org-dl">
<dt>url</dt><dd>validate <code>http://</code>, <code>ftp://</code> or <code>mailto:</code></dd>
<dt>tel</dt><dd>don't validate</dd>
<dt>email</dt><dd>may validate? May use attribute <code>multiple</code></dd>
<dt>(no term)</dt><dd>search</dd>
<dt>number</dt><dd>iOS requires pattern="\d*" to show the numeric keyboard</dd>
<dt>(no term)</dt><dd>range</dd>
<dt>(no term)</dt><dd>datetime-local</dd>
<dt>(no term)</dt><dd>date</dd>
<dt>(no term)</dt><dd>time</dd>
<dt>(no term)</dt><dd>month</dd>
<dt>(no term)</dt><dd>color</dd>
</dl>

<p>
Provide suggestions for text field
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">label</span> <span style="color: #dbdb95;">for</span>=<span style="color: #e67128;">"frmFavChocolate"</span>&gt;Favorite Type of Chocolate&lt;/<span style="color: #00ede1; font-weight: bold;">label</span>&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">input</span> <span style="color: #dbdb95;">type</span>=<span style="color: #e67128;">"text"</span> <span style="color: #dbdb95;">name</span>=<span style="color: #e67128;">"fav-choc"</span> <span style="color: #dbdb95;">id</span>=<span style="color: #e67128;">"frmFavChocolate"</span> <span style="color: #dbdb95;">list</span>=<span style="color: #e67128;">"chocType"</span>&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">datalist</span> <span style="color: #dbdb95;">id</span>=<span style="color: #e67128;">"chocType"</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">option</span> <span style="color: #dbdb95;">value</span>=<span style="color: #e67128;">"white"</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">option</span> <span style="color: #dbdb95;">value</span>=<span style="color: #e67128;">"milk"</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">option</span> <span style="color: #dbdb95;">value</span>=<span style="color: #e67128;">"dark"</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">datalist</span>&gt;
</pre>
</div>

<p>
Validate form :: Constraint Validation API <a href="https://developers.google.com/web/fundamentals/design-and-ux/input/forms/">https://developers.google.com/web/fundamentals/design-and-ux/input/forms/</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org87aae35" class="outline-3">
<h3 id="org87aae35"><span class="section-number-3">7.13</span> Special Characters</h3>
<div class="outline-text-3" id="text-7-13">
<p>
In CSS content attribute, you need to use CSS value
Convert tool
<a href="http://www.evotech.net/articles/testjsentities.html">http://www.evotech.net/articles/testjsentities.html</a>
</p>

<div class="org-src-container">
<pre class="src src-html">Heavy checkmark &amp;#10004;
Light checkmark &amp;#128504;
Checkmark &amp;#10003;
Square with checkmark &amp;#9745;

hyphen &amp;#x2011;

Left Double Quotation Mark &#8220; :: &amp;#8220;
Right Double Quotation Mark &#8221; :: &amp;#8221;
Left Single Quotation Mark &#8216; :: &amp;#8216;
Right Single Quotation Mark (including English possessives and contractions) &#8217; :: &amp;#8217;

Middle dot <span style="color: #dbdb95;">&amp;middot;</span> &amp;#183; &amp;#xb7; CSS:\00B7
</pre>
</div>
</div>
</div>

<div id="outline-container-org58a1e28" class="outline-3">
<h3 id="org58a1e28"><span class="section-number-3">7.14</span> Geolocation</h3>
<div class="outline-text-3" id="text-7-14">
<p>
Chrome v50+ only supports geolocation for https
</p>
</div>
<div id="outline-container-orgdd944fa" class="outline-4">
<h4 id="orgdd944fa"><span class="section-number-4">7.14.1</span> .getCurrentPosition</h4>
<div class="outline-text-4" id="text-7-14-1">
<pre class="example">
&lt;button onclick="getLocation()"&gt;Get Location&lt;/button&gt;
&lt;p id="demo"&gt;&lt;/p&gt;
&lt;script&gt;
var x = document.getElementById("demo");
function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition, showError);
  }
  else {
    x.innerHTML = "Not supported";
  }
}

function showPosition(position) {
 x.innerHTML = "Latitiude" + position.coords.latitude +
               "Longitude: " + position.coords.longitude;
}

function showError(e) {
  switch (e.code) {
    case: e.PERMISSION_DENIED:
     break;
    case: e.POSITION_UNAVAILABLE;
    case: e.TIMEOUT:
    case: e.UNKNOWN_ERROR:
  }
}
&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-org2fb69e3" class="outline-4">
<h4 id="org2fb69e3"><span class="section-number-4">7.14.2</span> watchPosition</h4>
<div class="outline-text-4" id="text-7-14-2">
<p>
Same as getCurrentPosition but continuous track.
</p>
</div>
</div>
</div>

<div id="outline-container-org66f211c" class="outline-3">
<h3 id="org66f211c"><span class="section-number-3">7.15</span> Storage</h3>
<div class="outline-text-3" id="text-7-15">
<pre class="example">
if (typeof(Storage) !== "undefined") {
  // Use localStorage or sessionStorage
  // Store. value is always string
  localStorage.setItem("key","value");
  console.log(localStorage.getItem("key"));
  localStorage.clickcount = Number(localStorage.clickcount) + 1;
  console.log(localStorage.key);
} 
else {
  // Not supported
}
</pre>
</div>
</div>
<div id="outline-container-org521b4da" class="outline-3">
<h3 id="org521b4da"><span class="section-number-3">7.16</span> Application Cache</h3>
<div class="outline-text-3" id="text-7-16">
<p>
<code>&lt;html manifest="demo.appcache"</code>
.appcache file should be served in <code>text/cache-manifest</code> media type
</p>
<pre class="example">
CACHE MANIFEST
# Above should be first line
# Files that should be cached
/theme.css
NETWORK
# Files will not be cached
login.asp
# An asterisk indicates all other files require an internet connection
*
FALLBACK
/html/ /offline.html
# offline.html should be served in place of all files in /html/ directory
# if internet is not available

# Change the manifest file to update cache
</pre>
</div>
</div>

<div id="outline-container-orga604811" class="outline-3">
<h3 id="orga604811"><span class="section-number-3">7.17</span> Language lang="en"</h3>
<div class="outline-text-3" id="text-7-17">
<p>
<a href="https://www.w3.org/International/articles/language-tags/">https://www.w3.org/International/articles/language-tags/</a>
<a href="http://www.iana.org/assignments/language-subtag-registry/language-subtag-registry">http://www.iana.org/assignments/language-subtag-registry/language-subtag-registry</a>
</p>
</div>
</div>

<div id="outline-container-orga65d086" class="outline-3">
<h3 id="orga65d086"><span class="section-number-3">7.18</span> ARIA</h3>
<div class="outline-text-3" id="text-7-18">
<p>
<a id="org8af96ab">html:ARIA</a>
<a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/ARIA_Techniques">https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/ARIA_Techniques</a>
</p>
</div>

<div id="outline-container-orgebcb1a0" class="outline-4">
<h4 id="orgebcb1a0"><span class="section-number-4">7.18.1</span> role attribute</h4>
<div class="outline-text-4" id="text-7-18-1">
<dl class="org-dl">
<dt>separator</dt><dd>BS4 .dropdown-divider</dd>
<dt>group</dt><dd>BS4 .btn-group</dd>
<dt>button</dt><dd>&lt;a&gt; without href</dd>
<dt>search</dt><dd>&lt;form&gt; define purpose</dd>
<dt>presentation</dt><dd>element does not need to be mapped to the accessibility API</dd>
</dl>
</div>
</div>

<div id="outline-container-org307bf84" class="outline-4">
<h4 id="org307bf84"><span class="section-number-4">7.18.2</span> aria-* attributes</h4>
<div class="outline-text-4" id="text-7-18-2">
<dl class="org-dl">
<dt>aria-label</dt><dd>Label or name is used interchangably. Inside &lt;button&gt; where label text can't be displayed.</dd>
<dt>aria-labelledby</dt><dd>Labelled by other element(s). Refer to other elements using their ids.
<ul class="org-ul">
<li>Can be nested 'parentID child1ID'</li>
<li>Say parentID element contains text Men's Shirts and childID element contains text Shop Now, then the name of the element used aria-labelledby has a name "Men's Shirts Shop Now"</li>
<li>it can even refer to itself</li>
</ul></dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org7aa38c8" class="outline-3">
<h3 id="org7aa38c8"><span class="section-number-3">7.19</span> Display price</h3>
<div class="outline-text-3" id="text-7-19">
<pre class="example">
&lt;span class="price-49-cents"&gt;4.9&lt;/span&gt;

.price-49-cents {
  font-size:70px;
}
.price-49-cents:after {
  content; "\00A2 \A per kWh";
  white-space: pre; /* wrap when line break is encountered */
  font-size:16px;
  /* line-height:16px; probably don't need it */
  vertical-align:top;
  display:inline-block;
}
</pre>
</div>
</div>

<div id="outline-container-org7ef6664" class="outline-3">
<h3 id="org7ef6664"><span class="section-number-3">7.20</span> Progressive Web App</h3>
<div class="outline-text-3" id="text-7-20">
<p>
<a href="https://developers.google.com/web/progressive-web-apps/">https://developers.google.com/web/progressive-web-apps/</a>
</p>
</div>
</div>

<div id="outline-container-org99b5caa" class="outline-3">
<h3 id="org99b5caa"><span class="section-number-3">7.21</span> AMP</h3>
<div class="outline-text-3" id="text-7-21">
<p>
<a href="https://www.ampproject.org/learn/about-how/">https://www.ampproject.org/learn/about-how/</a>
</p>

<ul class="org-ul">
<li>JavaScript and asset files are inside iframe. Only async js is allowed.</li>
<li>Predefine size in HTML for assets/resources, ads or iframes</li>
<li>Custom script will eventually have a custom tag (iframe) to be loaded in.</li>
<li>Inline CSS style sheet (50kb max)</li>
<li>The above fonts start to download immediately</li>
<li>Only certain animations are allowed (transform and opacity)</li>
<li>Resources are loaded as late as possible (lazy-load, above the fold), but prefetched as early as possible</li>
<li>Many AMP features require HTTPS</li>
</ul>
</div>

<div id="outline-container-org9ed59a4" class="outline-4">
<h4 id="org9ed59a4"><span class="section-number-4">7.21.1</span> Search Engine Discovery</h4>
<div class="outline-text-4" id="text-7-21-1">
<p>
Add the following to the non-AMP page:
&lt;link rel="amphtml" href="<a href="https://www.example.com/url/to/amp/document.html">https://www.example.com/url/to/amp/document.html</a>"&gt;
</p>

<p>
And this to the AMP page:
&lt;link rel="canonical" href="<a href="https://www.example.com/url/to/full/document.html">https://www.example.com/url/to/full/document.html</a>"&gt;
</p>

<p>
If there's only one page and the page is AMP
&lt;link rel="canonical" href="<a href="https://www.example.com/url/to/amp/document.html">https://www.example.com/url/to/amp/document.html</a>"&gt;
</p>

<p>
<a href="https://www.ampproject.org/docs/fundamentals/spec">https://www.ampproject.org/docs/fundamentals/spec</a>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orge23112b" class="outline-2">
<h2 id="orge23112b"><span class="section-number-2">8</span> JavaScript</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-orgac8ef03" class="outline-3">
<h3 id="orgac8ef03"><span class="section-number-3">8.1</span> Loading Sequence <a id="orgd765464">js:defer</a> <a id="orgf9f8f3a">js:async</a></h3>
<div class="outline-text-3" id="text-8-1">
<p>
Refer to <a href="#org7bd86f0">html:event:DOMContentLoaded</a>
&lt;script&gt; tags without any attributes are downloaded together and executed immediately in order
</p>

<dl class="org-dl">
<dt>defer</dt><dd>Works when src is defined. Download together, execute in order and defer execution until before DOMContentLoaded</dd>
<dt>async</dt><dd>Works when src is defined. Download together, execute in any order as soon as they're downloaded and DOMContentLoaded does not have to wait for the execution. If async scripts are downloaded and executed before DCL, it will still block HTML parsing.</dd>
<dt>async="false"</dt><dd>Works when src is defined. Download together, execute in order as soon as all are downloaded</dd>
</dl>

<p>
async is useful when the script files are not dependent on other files and do not have any dependencies themselves. Use it when you don't care exactly at which point the file is executed.
</p>

<p>
By default, all dynamically added scripts are async.
</p>

<p>
For example, if you want to load 2 javascript files and execute them in order but after they are all downloaded:
async="false" is needed.
</p>

<pre class="example">
[ '1.js',
  '2.js'
].forEach(function(src) {
  var script = document.createElement('script');
  script.src = src;
  script.async = false;
  document.head.appendChild(script);
});
</pre>
</div>
</div>

<div id="outline-container-org11a01ce" class="outline-3">
<h3 id="org11a01ce"><span class="section-number-3">8.2</span> External Script, document.write <a id="org343612c">js:external script</a></h3>
<div class="outline-text-3" id="text-8-2">
<p>
Loading external script use this
</p>

<pre class="example">
(function () {
  var nodeScript = document.createElement('script');
  nodeScript.type = 'text/javascript';
  nodeScript.src = 'http://otherdomain.com/a.js';
  var node = document.getElementById('interstitial');
  node.appendChild(node);

  // Add to &lt;head&gt;
  // var node = document.getElementsByTagName('script')[0];
  // node.parentNode.insertBefore(gads, node);
})();
</pre>

<p>
document.write inside external script (asynchronously loaded) cannot modify DOM 
You will need to use these to modify the DOM
</p>
<pre class="example">
// .appendChild(), .insertBefore(), .innerHTML
// jQuery ~.html('html')~ is equivalent to javascript ~$('').innerHTML ='html'~
</pre>

<p>
Refer to <a href="#org401f1c0">tool:html:document.write</a>
</p>

<p>
Example
<a href="https://support.jwplayer.com/customer/portal/articles/1406723#fndtn-method-1">https://support.jwplayer.com/customer/portal/articles/1406723#fndtn-method-1</a>
</p>

<p>
Default JW player embed is single-line embed:
&lt;script src="//content.jwplatform.com/players/MEDIAID-PLAYERID.js"&gt; &lt;/script&gt;
</p>

<p>
If this is async loaded, the player will not show because it has document.write
</p>

<p>
Instead, load this in &lt;head&gt;
&lt;script src="//content.jwplatform.com/libraries/PLAYERID.js"&gt; &lt;/script&gt;
</p>

<p>
And a container :: &lt;div id="myElement"&gt;&lt;/div&gt;
Then dynamically load this
</p>
<pre class="example">
&lt;script type="text/javaScript"&gt;
var playerInstance = jwplayer("myElement");
playerInstance.setup({
    file: "//content.jwplatform.com/videos/MEDIAID-TEMPLATEID.mp4"
    mediaid: "xxxxYYYY"
});
&lt;/script&gt;
</pre>
<p>
Where TEMPLATEID is the Source file name for a video content in JW UI (under Sources).
</p>
</div>
</div>

<div id="outline-container-orgc9c62be" class="outline-3">
<h3 id="orgc9c62be"><span class="section-number-3">8.3</span> Initialization</h3>
<div class="outline-text-3" id="text-8-3">
<p>
<a id="orgebbb06d">js:Initialization</a>
Always initialize variables at the top including vars in loops
var myObj = {},
    myString = "",
    myArray = [],
    myBoolean = false,
    myRegex = <i>()</i>,
    myNumber = 0;
</p>

<p>
These values are considered as false
</p>
</div>
</div>

<div id="outline-container-org5f5ae68" class="outline-3">
<h3 id="org5f5ae68"><span class="section-number-3">8.4</span> Variable Scope</h3>
<div class="outline-text-3" id="text-8-4">
</div>
<div id="outline-container-org590772b" class="outline-4">
<h4 id="org590772b"><span class="section-number-4">8.4.1</span> Hoisting</h4>
<div class="outline-text-4" id="text-8-4-1">
<p>
<a id="orgb7f851c">js:hoisting</a>. Refer to <a href="#orgeb76160">js:Function</a>
Variables defined outside of any functions are Global.
Only function can create local scope. Without using var to declare variables, those variables are global.
</p>

<pre class="example">
myFunction();

function myFunction() {
  carName = "Volvo";
  // carName is actually global
  var carName2 = "Freightliner";
  // carName2 is not global
  // Local var takes precedence when it's used inside a function
  // the inner var shadows the outer.
}
// Alternative way to get global var
console.log(window.carName);
</pre>

<pre class="example">
// function and variable declaration are moved to the top of their
// scope (global or local). It's called hoisting
// which allows you to use them before they are declared
// Functions are hoisted first and then variables
// Function declarations have priority over variable declarations, but not variable assignments

showState("one", {}, 2, 0.98); // output: Ready

// function declaration
// Pros :: Can be used before function is declared
// Cons :: Can't conditionally declare a function
function showState() {
  console.log("Ready");
  // arguments[0] is "one"
} 

// function expression/definition/assignment
// Pros :: Can conditionally define a function
// Cons :: Can't be used before it is defined 
var showState = function() {
  console.log("Idle");
};

showState(); // output: Idle

// The function that is assigned to a variable doesn't have to anonymous.

really.long.external.scoped.name = function shortcut(n) {
 // regression
 shortcut(n-1);
 // Pass it self as a callback
 someFunction(shortcut);
}

</pre>
</div>
</div>

<div id="outline-container-org03ec287" class="outline-4">
<h4 id="org03ec287"><span class="section-number-4">8.4.2</span> let, const, var</h4>
<div class="outline-text-4" id="text-8-4-2">
<p>
A variable is defined by var then this variable is available to the closest function scope.
</p>

<p>
Always <a href="#orgebbb06d">js:Initialization</a> for variables declared by var
</p>

<p>
let and const are <i>block-scoped</i>
</p>

<p>
let declares a variable which is available to the block it is enclosed in.
A block can be a switch, for, or if statement which has one pair of {}
You can only 'let' declare the same variable once in the same block.
The same variable can be let declaired inside a subblock and it will have new scope but not overwrite the upper scope variable.
let declared variable must be declared before it is used or referenced.
</p>

<p>
Limitation about var
Use let in a loop, the variable can be re-binded for each iteration 
while var in a loop, only the final assigned value is passed unless a closure is used
</p>

<pre class="example">
for (var i = 1; i &lt;= 5; i++) {
  setTimeout(
    function() {
      console.log(i);
    }, 1000*i);
  // 5 5 5 5 5

  setTimeout(
    function(x) {
      return function () {
        console.log(x);
      };
    }(i)
  , 1000*i);
  // 1 2 3 4 5
}
</pre>

<p>
const is the same as let but it's read only. Uppercase naming.
The same const variable name can be redeclared to different value in sub block.
If const is an array or object, its child element or key/value is not protected by default.
Which means you can push to const arry or modify key/value.
const in the same block cannot be changed or redeclared or redeclared by let or var.
</p>
</div>
</div>
</div>

<div id="outline-container-orge75864b" class="outline-3">
<h3 id="orge75864b"><span class="section-number-3">8.5</span> Closure, <a href="#orgc57ee83">Javascript Singleton</a></h3>
<div class="outline-text-3" id="text-8-5">
</div>
<div id="outline-container-org6af9f90" class="outline-4">
<h4 id="org6af9f90"><span class="section-number-4">8.5.1</span> Syntax, When to use closure?</h4>
<div class="outline-text-4" id="text-8-5-1">
<ul class="org-ul">
<li>When you don't want to change the variables in outer scope where the closure is in.</li>
</ul>
<p>
The outer scope can be global or any place where the closure is in.
</p>
<ul class="org-ul">
<li>When you want to run the function later</li>
<li>When you want to run the function later by providing just reference to other function</li>
<li>When you want to run the function later by providing initial state</li>
<li>When you want to do regression, don't want to affect outer scope and need more debugging</li>
</ul>

<pre class="example">
(function() {
  // Codes here runs immediately
})();
</pre>

<pre class="example">
(function($) {
  // Use jQuery with the shortcut
  console.log($.browser);
  $(document).ready(function($) {
    // document ready
   }
  );
}(jQuery));

// Another form
jQuery(document).ready(function($) {
  // Use $ now
});
</pre>
</div>
</div>

<div id="outline-container-org0a651a5" class="outline-4">
<h4 id="org0a651a5"><span class="section-number-4">8.5.2</span> Singleton <a id="orgc57ee83">Javascript Singleton</a></h4>
<div class="outline-text-4" id="text-8-5-2">
<pre class="example">
var Managers = {}; //namespace
// Singleton object CssManager
// Managers and singleton object CssManager has to be defined before they are used

Managers.CssManager = (function() {

// Private space in which all variables and methods are protected from the global scope
// Initialization of properties but it can't be instantialized.

var doc = document;
var setAttributes = function(element, attributes) {
  for (attribute in attributes) {
    element[attribute] = attributes[attribute];
  }
}
// Private space.

return {
  // Public members 
  addStyleSheet: function(id, url) {
    var newStyleSheet = document.createElement("link");
    setAttributes(newStyleSheet, {
      rel : "stylesheet",
      type: "text/css",
      id : id,
      href: url
    });
    document.getElementByTagName("head")[0].appendChild(newStyleSheet);
  },
  removeStyleSheet: function(id) {
    var currentStyleSheet = document.getElementById(id);
    if (currentStyleSheet) {
      currentStyleSheet.parentNode.removeChild(currentStyleSheet);
    }
  },
  swapStyleSheet: function(id, url) {
    this.removeStyleSheet(id);
    this.addStyleSheet(id, url);
  }
  // Public members
}
// return ends.

})();

</pre>
</div>
</div>

<div id="outline-container-org5c512e0" class="outline-4">
<h4 id="org5c512e0"><span class="section-number-4">8.5.3</span> Regression</h4>
<div class="outline-text-4" id="text-8-5-3">
<p>
This provides you more debugging info
</p>

<pre class="example">
var charsInBody = (function counter(elm) {
  // Notice :: this is not an anonymous function as we see before in a closure!
  if (elm.nodeType == 3) {
    return elm.nodeValue.length;
  }
  var count = 0;
  for (var i = 0, child; child = elm.childNodes[i]; i++) {
    count += counter(child);
  }
  return count;
})(document.body);
</pre>
</div>
</div>
</div>

<div id="outline-container-org8bc08ad" class="outline-3">
<h3 id="org8bc08ad"><span class="section-number-3">8.6</span> Types, typeof, constructor</h3>
<div class="outline-text-3" id="text-8-6">
</div>
<div id="outline-container-org327e11a" class="outline-4">
<h4 id="org327e11a"><span class="section-number-4">8.6.1</span> All types, typeof, constructor</h4>
<div class="outline-text-4" id="text-8-6-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">String</td>
<td class="org-left"><a href="#orgbca4dc9">js:String</a></td>
</tr>

<tr>
<td class="org-left">Number</td>
<td class="org-left">NaN is number. <a href="#org721fafe">js:Number</a></td>
</tr>

<tr>
<td class="org-left">Boolean</td>
<td class="org-left">true or false. Not FALSE/TRUE</td>
</tr>

<tr>
<td class="org-left">Object</td>
<td class="org-left"><a href="#orgff85b74">js:Array</a>, <a href="#orgbb38f38">js:Date</a>, <a href="#org2f053f5">js:Object</a>, null, <a href="#org3a4784d">js:RegExp</a></td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"><a href="#org396fc41">js:Math</a>, <a href="#orgac3f002">js:Error</a></td>
</tr>

<tr>
<td class="org-left">Function</td>
<td class="org-left">a special type of object <a href="#orgeb76160">js:Function</a></td>
</tr>

<tr>
<td class="org-left">Symbol</td>
<td class="org-left">new in Edition 6</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">undefined</td>
<td class="org-left">undefined or has not been assigned a value</td>
</tr>

<tr>
<td class="org-left">null</td>
<td class="org-left">a special type of object</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgea2fc05" class="outline-4">
<h4 id="orgea2fc05"><span class="section-number-4">8.6.2</span> Number <a id="org721fafe">js:Number</a></h4>
<div class="outline-text-4" id="text-8-6-2">
<p>
Used: <a href="#org396fc41">js:Math</a>
</p>

<pre class="example">
var foo = "55";
var myNumber = Number(foo);
if (!isNaN(myNumber)) {
  console.log("It is a number");
  // foo is a number
} 
</pre>
</div>
</div>

<div id="outline-container-orgf6f30cf" class="outline-4">
<h4 id="orgf6f30cf"><span class="section-number-4">8.6.3</span> String <a id="orgbca4dc9">js:String</a></h4>
<div class="outline-text-4" id="text-8-6-3">
<p>
s.length
s.charAt(s.length-1)
s.charCodeAt(s.length-1) :: UTF-16 code unit value
var myString = String.fromCharCode(65,66,67); <i>/ 'ABC'
s.indexOf("Paul"); /</i> Case sensitive. Starts from the beginning. -1 not found
s.lastIndexOf("Paul"); <i>/ Case sensitive. Starts from the end
s.substr(0,4); /</i> From start to 4th index
s.substring(0,4); // From start and take 4 characters. If stop is omitted, take the rest
</p>

<pre class="example">
s.slice(0,4); // Same as substring but start and stop can be both or either negative
// If start is negative, start from the end of string
// If stop is negative, stop to (s.length - 1) - Math.abs(s)
</pre>

<p>
s.toLowerCase(); s.toUpperCase();
</p>

<p>
Don't use string1 <code>= string2 to do case insensitive comparison. Use below including UTF8
string1.toUpperCase() ==</code> string2.toUpperCase()
</p>

<p>
Padding 0's to left
</p>
<pre class="example">
function padLeft(nr, n, str){
  return Array(n-String(nr).length+1).join(str||'0')+nr;
}
var mystring = 3;
console.log(padLeft(mystring,3)); // 003
console.log(padLeft(mystring,3,'z')); // zz3
</pre>
</div>
</div>

<div id="outline-container-org0bd3a0e" class="outline-4">
<h4 id="org0bd3a0e"><span class="section-number-4">8.6.4</span> Array</h4>
<div class="outline-text-4" id="text-8-6-4">
</div>
<div id="outline-container-org23458fa" class="outline-5">
<h5 id="org23458fa"><span class="section-number-5">8.6.4.1</span> Basics</h5>
<div class="outline-text-5" id="text-8-6-4-1">
<p>
<a id="orgff85b74">JS:Array</a>
var a = new Array();
a[0] = "Paul";
a = ["P", "C", "S"]; <i>/ never put comma at the end of array
a[a.length-1] /</i> last element
a[a.length]= "Z"; // append to last
</p>
</div>
</div>

<div id="outline-container-org69a1048" class="outline-5">
<h5 id="org69a1048"><span class="section-number-5">8.6.4.2</span> If variable is array</h5>
<div class="outline-text-5" id="text-8-6-4-2">
<pre class="example">
console.log(Array.isArray(fruits)); // true or false
console.log(fruits instanceof Array) // true or false
</pre>
</div>
</div>

<div id="outline-container-org2132946" class="outline-5">
<h5 id="org2132946"><span class="section-number-5">8.6.4.3</span> array.pop(), array.shift(), array.push(), array.unshift()</h5>
<div class="outline-text-5" id="text-8-6-4-3">
<p>
a.pop(); <i>/ remove last element
a.shift(); /</i> remove fist element
a.push("Z"); <i>/ add to the end of array. return new length
a[a.length]="Z"; /</i> also append to last
</p>

<p>
a.unshift("Z"); // add to the beginning of array. return new length
</p>
</div>
</div>

<div id="outline-container-org6a3a758" class="outline-5">
<h5 id="org6a3a758"><span class="section-number-5">8.6.4.4</span> array.concat()</h5>
<div class="outline-text-5" id="text-8-6-4-4">
<p>
var a = new Array("P", "C", "S");
var b = new Array(31,29,34);
a = a.concat(b); // Join arrays P, C, S, 31, 29, 34
</p>
</div>
</div>

<div id="outline-container-org50bce48" class="outline-5">
<h5 id="org50bce48"><span class="section-number-5">8.6.4.5</span> array.slice()</h5>
<div class="outline-text-5" id="text-8-6-4-5">
<p>
var slice = a.slice(1,2); // C, S
</p>
</div>
</div>

<div id="outline-container-orga8191da" class="outline-5">
<h5 id="orga8191da"><span class="section-number-5">8.6.4.6</span> array.splice(), remove a value from array if exists</h5>
<div class="outline-text-5" id="text-8-6-4-6">
<p>
var removed = a.splice(0,1,"Z","B"); <i>/ ["P"]
/</i> First delete 1 element at index 0 and then add element Z and B 
// return the ones that are removed
</p>

<p>
Remove a value from array if it exists
var index = myArray.indexOf(item);
if (index !== -1) {
 myArray.splice(index, 1);
}
</p>
</div>
</div>

<div id="outline-container-org565ac12" class="outline-5">
<h5 id="org565ac12"><span class="section-number-5">8.6.4.7</span> array.join(), array.toString(), array.valueOf()</h5>
<div class="outline-text-5" id="text-8-6-4-7">
<p>
var join = a.join(","); <i>/ "P,C,S"
a.toString() /</i> also "P,C,S"
a.valueOf(); // also "P,C,S". Convert to primitive
</p>
</div>
</div>

<div id="outline-container-orgd507f97" class="outline-5">
<h5 id="orgd507f97"><span class="section-number-5">8.6.4.8</span> array.sort(), array.reverse()</h5>
<div class="outline-text-5" id="text-8-6-4-8">
<p>
var sort = a.sort(); // sort as strings. case sensitive: C, P, S
function numericSort(anArray) {
 anArray.sort(function(a,b) {
  return a - b; <i>/ ascending order
  /</i> return a.year - b.year; if it's an obj
});
 return anArray;
}
</p>

<p>
function randomSort(anArray) {
 anArray.sort(function(a, b) {return 0.5 - Math.random();});
 return anArray;
}
</p>

<p>
var reverse = a.reverse(); // S, C, P
</p>
</div>
</div>

<div id="outline-container-org880f720" class="outline-5">
<h5 id="org880f720"><span class="section-number-5">8.6.4.9</span> array loop: for, array.forEach()</h5>
<div class="outline-text-5" id="text-8-6-4-9">
<p>
for (var i = 0; i &lt; fruits.length; i++) {
 fruits[i];
}
</p>

<p>
<a href="#org129281a">js:forEach</a>
fruits.forEach(function(i) {
 console.log(i);
});
</p>
</div>
</div>

<div id="outline-container-org457b332" class="outline-5">
<h5 id="org457b332"><span class="section-number-5">8.6.4.10</span> array.map(), array.filter()</h5>
<div class="outline-text-5" id="text-8-6-4-10">
<p>
Do something while each item is iterated, join returned values into an array.
var result = a.map(function(i) { return i.toUpperCase(); }); <i>/ result is an array
console.log(a); /</i> a is not affected!
</p>

<p>
a = a.filter(function(i) { 
   if ( true then remove condition ) { 
    return false; 
   }
   else {
    return true; // keep
   }
});
</p>
</div>
</div>

<div id="outline-container-org117364c" class="outline-5">
<h5 id="org117364c"><span class="section-number-5">8.6.4.11</span> array.every(), array.some()</h5>
<div class="outline-text-5" id="text-8-6-4-11">
<p>
a.every(function(i) { return i[0] <code>=</code> "a"; }); <i>/ return true only if all returns are true
a.some(function(i)  { return i[0] <code>=</code> "a"; }); /</i> return true if at least one return is true
</p>
</div>
</div>

<div id="outline-container-org1392259" class="outline-5">
<h5 id="org1392259"><span class="section-number-5">8.6.4.12</span> array.reduce()</h5>
<div class="outline-text-5" id="text-8-6-4-12">
<p>
var sum = [0, 1, 2, 3].reduce(
 function(a,b) { return a=b; },
 0
);
// sum is integer 6
</p>

<pre class="example">
var flattened = [[0, 1], [2, 3], [4, 5]].reduce(
 function(a,b) { return a.concat(b); },
 []
);
// [0, 1, 2, 3, 4, 5]
</pre>

<p>
array.reduce(callback[, initialValue])
</p>

<p>
If initialValue is provided, it will start at index 0. 
If not provided, it will start at index 1 and previousValue is the value at index 0 in the array.
</p>

<p>
callback has 4 arguments
</p>
<ul class="org-ul">
<li>previousValue</li>
<li>currentValue</li>
<li>currentIndex</li>
<li id="array">the input array was called upon</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org3088074" class="outline-4">
<h4 id="org3088074"><span class="section-number-4">8.6.5</span> Date <a id="orgbb38f38">js:Date</a></h4>
<div class="outline-text-4" id="text-8-6-5">
<p>
var date1 = new Date();
var date2 = new Date(77978); <i>/ milliseconds since 1970 01 01 GMT
var date3 = new Date(2017,0,31,15,35,20,20); /</i> 2017 Jan 1 at 15:35:20 at 20 ms
var date4 = new Date("31 January 2016"); 
// "31 Jan 2016" "Jan 31 2016" "01-31-2016"
</p>

<p>
<i>/ Get and Set
var dayofmonth = date4.getDate(); /</i> setDate
var dayofweek = date4.getDau(); <i>/ int, Sunday as 0. You can't set day
var month = date4.getMonth(); /</i> int, January as 0. setMonth
var fullyear = date4.getFullYear(); <i>/ 4 digits. setFullYear
var datestring = date4.toDateString(); /</i> Current time zone. "Wed 31 Dec 2003"
</p>

<p>
var currentDay = date4.getDate();
date4.setDate(currentDay + 28 ); // Plus 28 days
</p>

<p>
getHours(), getMinutes(), getSeconds(), getMilliseconds(), toTimeString()
setHours(), setMinutes(), setSeconds(), setMilliseconds()
</p>

<p>
// Date difference
var date1 = new Date();
var date2 = new Date('01-31-2016');
var timeDiff = date2.getTime() - date1.getTime(); // milliseconds
var diff Days = timeDiff / (1000*3600*24);
</p>

<p>
// Conversion getter
<a id="org4683b46">js:time:iso</a>
date4.toISOString()
<i>/ e.g. 2011-10-05T14:48:00.000Z
/</i> timezone is always zero UTC offset. 24 or 27 (I haven't seen one..) characters.
</p>

<p>
Compare current date with a future date
</p>
<pre class="example">
function checkFuture(futureDateString) {
  var futureMS = new Date(futureDateString).getTime();
  var currentMS = new Date().getTime();

  if (currentMS &gt;= futureMS) {
    return true; // current date is beyond future date
  }
  return false;
}
checkFuture("01/03/2018"); // mm/dd/yyyy
</pre>
</div>
</div>

<div id="outline-container-org52ed56f" class="outline-4">
<h4 id="org52ed56f"><span class="section-number-4">8.6.6</span> Math <a id="org396fc41">js:Math</a></h4>
<div class="outline-text-4" id="text-8-6-6">
<p>
Math.PI
Math.abs(-101);
Math.ceil(101.01); <i>/ 102
Math.floor(101.01); /</i> 101
Math.round(101.01);
Math.pow(10, 2); <i>/ 100
parseInt("10"); /</i> 10
</p>

<p>
var itemCost = 9.99 * 1.075; <i>/ 10.73925
itemCost.toFixed(2); /</i> 10.74
</p>
</div>
</div>
<div id="outline-container-org8a11d8a" class="outline-4">
<h4 id="org8a11d8a"><span class="section-number-4">8.6.7</span> RegExp</h4>
<div class="outline-text-4" id="text-8-6-7">
</div>
<div id="outline-container-org5b43225" class="outline-5">
<h5 id="org5b43225"><span class="section-number-5">8.6.7.1</span> search(), replace(), match()</h5>
<div class="outline-text-5" id="text-8-6-7-1">
<pre class="example">
var s = "Visit W3Schools!";
var n = s.search("W3Schools"); // 6. -1 if not found
var all = s.match("i"); // return all matches
var res = s.replace(/w3schools/i, "Microsoft");
var res = s.replace("W3Schools", "Microsoft");
</pre>
</div>
</div>

<div id="outline-container-org18617cf" class="outline-5">
<h5 id="org18617cf"><span class="section-number-5">8.6.7.2</span> RegExp</h5>
<div class="outline-text-5" id="text-8-6-7-2">
</div>
<ol class="org-ol">
<li><a id="orga36e80c"></a>Ways to define regex <a id="org3a4784d">js:RegExp</a><br />
<div class="outline-text-6" id="text-8-6-7-2-1">
<pre class="example">
var n = s.search(/w3schools/i); // Use forward slash. Return the first matched index
var pattern = /w3schools/i; // Define a pattern in a variable

// Need to escape \ with \\
var patternobj = new RegExp('w3schools','i'); // Define a pattern as a RegExp object 
var patternobj = new RegExp(/w3schools/,'i');

// Test a pattern
pattern.test("Perform a test on this string"); // true or false

// Return the first found text
pattern.exec("Perform an exec on this string"); // null if not found.

// Index
every time pattern.exec() or pattern.test() is run, the pattern.lastIndex is advanced.
Until .lastIndex gets to 0

// Return all matches
s.match(pattern);
</pre>
</div>
</li>

<li><a id="org3873fb1"></a>Pattern and modifiers<br />
<div class="outline-text-6" id="text-8-6-7-2-2">
<p>
<code>/pattern/modifiers</code>
</p>

<p>
Modifiers
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">i</td>
<td class="org-left">case-insensitive</td>
</tr>

<tr>
<td class="org-left">g</td>
<td class="org-left">find all match</td>
</tr>

<tr>
<td class="org-left">m</td>
<td class="org-left">multiline</td>
</tr>
</tbody>
</table>

<p>
Brackets
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">[abc]</td>
<td class="org-left">a character that is a, b or c</td>
</tr>

<tr>
<td class="org-left">[^abc]</td>
<td class="org-left">a character that is not a, b nor c</td>
</tr>

<tr>
<td class="org-left">[0-9]</td>
<td class="org-left">a digit</td>
</tr>

<tr>
<td class="org-left">[^0-9]</td>
<td class="org-left">a non-digit character</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
(x|y) one of x or y
</p>

<p>
Metacharacter
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">.</td>
<td class="org-left">a character execpt newline or line terminator</td>
</tr>

<tr>
<td class="org-left">\w</td>
<td class="org-left">a word character including _ [A-Za-z0-9_]</td>
</tr>

<tr>
<td class="org-left">\W</td>
<td class="org-left">a non-word character. same as [$\w]</td>
</tr>

<tr>
<td class="org-left">\d</td>
<td class="org-left">a digit</td>
</tr>

<tr>
<td class="org-left">\D</td>
<td class="org-left">a non-digit character</td>
</tr>

<tr>
<td class="org-left">\s</td>
<td class="org-left">whitespace</td>
</tr>

<tr>
<td class="org-left">&sect;</td>
<td class="org-left">a non-space character</td>
</tr>

<tr>
<td class="org-left">\b</td>
<td class="org-left">word boundary</td>
</tr>

<tr>
<td class="org-left">\0</td>
<td class="org-left">a NUL character</td>
</tr>

<tr>
<td class="org-left">\n</td>
<td class="org-left">a new line character</td>
</tr>

<tr>
<td class="org-left">\f</td>
<td class="org-left">a form feed character. e.g. page/section break</td>
</tr>

<tr>
<td class="org-left">\r</td>
<td class="org-left">a carriage return</td>
</tr>

<tr>
<td class="org-left">\t</td>
<td class="org-left">a tab character</td>
</tr>

<tr>
<td class="org-left">\v</td>
<td class="org-left">a vertical tab character</td>
</tr>

<tr>
<td class="org-left">\uxxxx</td>
<td class="org-left">a Unicode character \u0057 is w</td>
</tr>

<tr>
<td class="org-left">\xxx</td>
<td class="org-left">\127 is w</td>
</tr>

<tr>
<td class="org-left">\xdd</td>
<td class="org-left">\x57 is w</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Quantifier
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">n+</td>
<td class="org-left">at least one of n</td>
</tr>

<tr>
<td class="org-left">n*</td>
<td class="org-left">zero or more</td>
</tr>

<tr>
<td class="org-left">n?</td>
<td class="org-left">zero or one</td>
</tr>

<tr>
<td class="org-left">n{X}</td>
<td class="org-left">\d{4} a 4-digit string</td>
</tr>

<tr>
<td class="org-left">n{X,Y}</td>
<td class="org-left">\d{3,4} a 3-to-4-digit string</td>
</tr>

<tr>
<td class="org-left">n{X,}</td>
<td class="org-left">\d{3,} a at-least-3-digit string</td>
</tr>

<tr>
<td class="org-left">n$</td>
<td class="org-left">at the end</td>
</tr>

<tr>
<td class="org-left">^n</td>
<td class="org-left">at the beginning</td>
</tr>

<tr>
<td class="org-left">(?=n)</td>
<td class="org-left">non greedy match</td>
</tr>
</tbody>
</table>
</div>
</li>

<li><a id="org534ce66"></a>Word Boundary \b and \B<br />
<div class="outline-text-6" id="text-8-6-7-2-3">
<pre class="example">
var s = "Visit W3Schools";
var pattern = /\bW3/g; // return words that start with W3
pattern.exec(s); // W3
var patter = /\bVisit\b/g; // whole word
var patterB = /\BSchools/g; // return "Schools". Words that do not start or end with Schools
</pre>
</div>
</li>

<li><a id="org9540ed7"></a>Non greedy match (?=n)<br />
<div class="outline-text-6" id="text-8-6-7-2-4">
<pre class="example">
var s = 'Is this all there is';
var p = /is(?= all)/g;
s.match(p); // is
// (?= all) matches any string that is before ' all':  but the matched is not returned.
// The other way to intepret it is find any 'is' that has ' all' right behind
var p = /is(?! all)/g; // Find any 'is' that doesn't have ' all' right behind
</pre>
</div>
</li>

<li><a id="org67217eb"></a>Match Tags <a id="org55ff3ce">regex:match_tags</a><br />
<div class="outline-text-6" id="text-8-6-7-2-5">
<p>
Match all tags
</p>
<pre class="example">
'&lt;[^&gt;]*&gt;'
</pre>

<p>
Match one tag only
</p>
<pre class="example">
'&lt;img[^&gt;]*&gt;'
'&lt;(img|/?div|br)[^&gt;]*&gt;'
</pre>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-orge73f13a" class="outline-4">
<h4 id="orge73f13a"><span class="section-number-4">8.6.8</span> Function</h4>
<div class="outline-text-4" id="text-8-6-8">
<p>
<a id="orgeb76160">js:Function</a> Refer to <a href="#orgb7f851c">js:hoisting</a>
</p>
</div>
<div id="outline-container-org0a3d660" class="outline-5">
<h5 id="org0a3d660"><span class="section-number-5">8.6.8.1</span> arguments</h5>
<div class="outline-text-5" id="text-8-6-8-1">
<p>
function add() {
  var sum = 0;
  for (var i = 0, j = arguments.length; i &lt; j; i++) {
    sum += arguments[i];
  }
  return sum;
}
add(2,3,4,5);
</p>

<p>
// Use Spread Syntax js:spread
function add(firstValue, &#x2026;args) {
  var sum = 0;
  for (let value of args) {
    sum += value;
  }
  sum += firstValue;
  return sum;
}
add(2,3,4,5);
</p>

<p>
Optional argument
function verify(w) {
  w = (typeof w <code>=</code> 'undefined') ? 'default' : w;
}
</p>
</div>
</div>

<div id="outline-container-org5b14f56" class="outline-5">
<h5 id="org5b14f56"><span class="section-number-5">8.6.8.2</span> .apply(), .call()</h5>
<div class="outline-text-5" id="text-8-6-8-2">
<p>
<a id="org00c04f8">js:Function.apply</a> <a id="orgffb8cdf">js:Function.call</a>
.apply() :: Pass arguments as an array to a function which accepts multiple arguments
.call() :: Pass arguments as arguments to a function which accepts multiple arguments
</p>

<p>
funct.apply(thisArg, [argsArray])
</p>

<p>
thisArg :: pass thisArg into funct as this in funct
argsArray :: array or array-like object
</p>

<p>
Pass no more than 65536 arguments/elements in array.
</p>

<p>
var numbers = [5,6,2,3,7];
var max = Math.max.apply(null, numbers); // Equivalent to Math.max(5,6, &#x2026;);
var max = Math.max.call(null, 5,6,2,3,7);
</p>

<p>
.apply() and .call() are used when the number of arguments passed to a method is unknown.
They are also used to call a method on a varible (obj or array) which doesn't has that method as its property. 
</p>
<ul class="org-ul">
<li>Loop arrays which don't have .forEach() such as <a href="#org8b12a28">NodeList</a></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org698f346" class="outline-4">
<h4 id="org698f346"><span class="section-number-4">8.6.9</span> Error <a id="orgac3f002">js:Error</a></h4>
<div class="outline-text-4" id="text-8-6-9">
<pre class="example">
try {
 throw "Too big"; // Manually throw an error
 var err = new Error("Too big");
 throw err;
}
catch(err) {
 console.log(
  err.message, // Standard
  err.description, // Microsoft.
  err.number, // Microsoft. same as linenumber
  err.linenumber, // FF and Chrome
  err.name, // Standard. Initial is Error but you can change it
  err.stack // Not standard but works in all browsers.. Stack trace.
 );
}
finally {
 // success or failure, run this
}
</pre>
</div>
</div>

<div id="outline-container-org264d20a" class="outline-4">
<h4 id="org264d20a"><span class="section-number-4">8.6.10</span> Prototype Object</h4>
<div class="outline-text-4" id="text-8-6-10">
<p>
<a id="orgc347faf">js:prototype</a>
Every <a href="#org2f053f5">js:Object</a> has a prototype object.
</p>

<p>
prototype object's default properties and methods
</p>

<dl class="org-dl">
<dt>constructor</dt><dd>property. get/set</dd>
<dt>hasOwnProperty('aProperty')</dt><dd><ul class="org-ul">
<li>bool. objA.hasOwnProperty('aProperty') not objA.prototype.hasOwnProperty('aProperty')</li>
<li>aProperty has to be direct (not objA.prototype.aProperty) and not inherited</li>
</ul></dd>
<dt>isPrototypeOf()</dt><dd><ul class="org-ul">
<li><a id="org1b3423b">js:prototype.isPrototypeOf</a></li>
<li>Parent.prototype.isPrototypeOf(SubParent.prototype) is true</li>
<li>Whether or not SubParent has some prototype properties removed, added or modified</li>
<li><a href="#org6c26aa4">js:instanceof</a></li>
</ul></dd>
<dt>propertyIsEnumerable</dt><dd><ul class="org-ul">
<li><a id="org5a323ef">js:prototype.propertyIsEnumerable</a></li>
<li><a href="#org2274960">js:Enumerable</a></li>
<li>objA.propertyIsEnumerable('prop') not objA.prototype.propertyIsEnumerable('prop')</li>
<li>return true if it's enumerable in <a href="#org91dd71a">js:for&#x2026;in</a></li>
<li>inherited properties are not enumerable</li>
<li>but newly created properties or methods are enumerable!</li>
</ul></dd>
</dl>

<p>
Because protype object can be cloned and modified, that brings one OOP characteristic: <a href="#org59ae43b">js:inheritance</a>
</p>

<p>
Also, if any prototype property is modified in the upper chain, the lower chain and its instantiated objects will be modified, too!
</p>
</div>
</div>

<div id="outline-container-org2758278" class="outline-4">
<h4 id="org2758278"><span class="section-number-4">8.6.11</span> Type Conversion</h4>
<div class="outline-text-4" id="text-8-6-11">
<p>
Javascript conversion is automatic. 
var y = "5";
var x = + y;
</p>

<p>
General methods:
String(x) or x.toString() <i>/ convert to string
Number(x) /</i> convert to numbers
</p>
</div>

<div id="outline-container-org0f1f9c5" class="outline-5">
<h5 id="org0f1f9c5"><span class="section-number-5">8.6.11.1</span> Number to String</h5>
<div class="outline-text-5" id="text-8-6-11-1">
<p>
x.toString();
x.toExponential(2); <i>/ 2 decimal points: 9.66e+0
x.toFixed(2); /</i> 2 decimal points
x.toPrecision(); // total number of digits
</p>
</div>
</div>

<div id="outline-container-org4b6ede7" class="outline-5">
<h5 id="org4b6ede7"><span class="section-number-5">8.6.11.2</span> String to Number</h5>
<div class="outline-text-5" id="text-8-6-11-2">
<p>
parseInt("10"); <i>/ 10
parseInt("10.33"); /</i> 10
parseInt("10.53"); <i>/ 10
parseInt("10 20 30"); /</i> 10
parseInt("10 years"); <i>/ 10
parseInt("year 10"); /</i> NaN
</p>

<p>
The same for parseFloat.
</p>

<p>
Always provide a base number :: parseInt("10", 10); // decimal base
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org76dd7fa" class="outline-3">
<h3 id="org76dd7fa"><span class="section-number-3">8.7</span> Loops and Breaks</h3>
<div class="outline-text-3" id="text-8-7">
</div>
<div id="outline-container-orgd195303" class="outline-4">
<h4 id="orgd195303"><span class="section-number-4">8.7.1</span> for, while, do&#x2026;while</h4>
<div class="outline-text-4" id="text-8-7-1">
<pre class="example">
var cars = ['a', 'b', 'c'];
for (i = 0, len = cars.length, text = ""; i&lt; len; i++) {
 // Loop through all properties of Array.prototype
 // 3rd party libraries or frameworks might add methods or properties to Array.prototype
 // So this is not recommended for looping an Array
}
for (; i&lt;len; i++)

while () {
}

do {
}
while (condition);
</pre>
</div>
</div>

<div id="outline-container-orgadf38bf" class="outline-4">
<h4 id="orgadf38bf"><span class="section-number-4">8.7.2</span> for&#x2026;in <a id="org91dd71a">js:for&#x2026;in</a></h4>
<div class="outline-text-4" id="text-8-7-2">
<pre class="example">
var myObj = {};
for (var prop in myObj) {
 console.log(myObj[prop]);
}
</pre>
</div>
</div>

<div id="outline-container-org82f70d6" class="outline-4">
<h4 id="org82f70d6"><span class="section-number-4">8.7.3</span> for&#x2026;of</h4>
<div class="outline-text-4" id="text-8-7-3">
<p>
<a id="orgc233113">js:for&#x2026;of</a>
<a href="#org91dd71a">js:for&#x2026;in</a> interates over all enumerable properties of an object.
While for&#x2026;of iterates over elements of any collection that has a [Symbo.iterator] property.
</p>

<p>
for&#x2026;of interates over iterable objects :: Array, Map, Set, String, TypedArray, arguments but not objects!
</p>

<p>
for (let value of iterable) {
 console.log(value);
}
</p>
</div>
</div>

<div id="outline-container-orgc2dc54e" class="outline-4">
<h4 id="orgc2dc54e"><span class="section-number-4">8.7.4</span> forEach</h4>
<div class="outline-text-4" id="text-8-7-4">
<p>
<a id="org129281a">js:forEach</a>
</p>

<p>
array.forEach(callback[, thisArg])
</p>

<p>
thisArg :: Pass a variable outside of .forEach() and change it inside .forEach() using <i>this</i>
</p>

<p>
callback :: 3 arguments
</p>
<ul class="org-ul">
<li>currentValue</li>
<li>index</li>
<li>array</li>
</ul>

<p>
Return :: undefined. So .forEach() is not chainable
</p>

<p>
Elements appended after the call to forEach() begins will not be visited.
The value of element is changed before forEach() visits, it will reflect the change.
Elements removed before being visited will not be visited.
</p>
</div>
</div>

<div id="outline-container-org27c874e" class="outline-4">
<h4 id="org27c874e"><span class="section-number-4">8.7.5</span> break and continue</h4>
<div class="outline-text-4" id="text-8-7-5">
<p>
<code>break</code> without a label reference, can only jump out of a loop or a switch
<code>continue</code> with or without a label, can only skip one loop iteration.
With a label reference, <code>break</code> can jump out of any code block.
A code block is a block of code between { and }
</p>
<pre class="example">
list: {
 text += cars[0] +  "&lt;br&gt;";
 text += cars[1] +  "&lt;br&gt;";
 break list;
 text += cars[3] +  "&lt;br&gt;";
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org6f981c5" class="outline-3">
<h3 id="org6f981c5"><span class="section-number-3">8.8</span> Enumerable <a id="org2274960">js:Enumerable</a></h3>
<div class="outline-text-3" id="text-8-8">
<p>
Except inherited properties, all methods and properties are enumerable in <a href="#org91dd71a">js:for&#x2026;in</a>
<a href="#org5a323ef">js:prototype.propertyIsEnumerable</a>
<a href="#org88c56aa">js:Object.defineProperty</a>
</p>

<p>
To make a method non enumerable
</p>
<pre class="example">
// CustomerBooking class and its method setFilm is already defined
Object.defineProperty(Customerbooking.prototype,'setFilm',
{enumerable:false});
</pre>
</div>
</div>

<div id="outline-container-org7666045" class="outline-3">
<h3 id="org7666045"><span class="section-number-3">8.9</span> JSONP, JSON</h3>
<div class="outline-text-3" id="text-8-9">
</div>
<div id="outline-container-org20dd982" class="outline-4">
<h4 id="org20dd982"><span class="section-number-4">8.9.1</span> JSONP</h4>
<div class="outline-text-4" id="text-8-9-1">
<pre class="example">
&lt;script type="text/javascript" src="http://b.com/returnjsondata?callback=mycallback"&gt;&lt;/script&gt;

Where b.com/returnjsondata returns a json object. 
And the whole &lt;script&gt; in yourwebsite.com will become 
mycallback({foo:'bar'});
</pre>
</div>
</div>

<div id="outline-container-orgbda5876" class="outline-4">
<h4 id="orgbda5876"><span class="section-number-4">8.9.2</span> JSON</h4>
<div class="outline-text-4" id="text-8-9-2">
<p>
JSON object names require double quotes.
String are wrapped in double quotes.
Boolean is true or false.
null can be used.
MIME type: application/json
</p>

<p>
var obj = JSON.parse(jsonString); // parse a json string
</p>
</div>

<div id="outline-container-org8c05b4d" class="outline-5">
<h5 id="org8c05b4d"><span class="section-number-5">8.9.2.1</span> Deep Keys</h5>
<div class="outline-text-5" id="text-8-9-2-1">
<pre class="example">
var r1 = (((test || {}).level1 || {}).level2 || {}).level3;
if (typeof r1 !== 'undefined') {
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2d6899d" class="outline-3">
<h3 id="org2d6899d"><span class="section-number-3">8.10</span> DOM Manipulation</h3>
<div class="outline-text-3" id="text-8-10">
</div>
<div id="outline-container-org83643f9" class="outline-4">
<h4 id="org83643f9"><span class="section-number-4">8.10.1</span> If an element exists</h4>
<div class="outline-text-4" id="text-8-10-1">
<pre class="example">
var e = document.getElementById("abc");
if (!!e) {
 // exists
}

var e = document.getElementsByClassName('aClass');
if (e.length &gt; 0) {
  // exists
}
</pre>
</div>
</div>

<div id="outline-container-orge18ea1a" class="outline-4">
<h4 id="orge18ea1a"><span class="section-number-4">8.10.2</span> Loop querySelectorAll</h4>
<div class="outline-text-4" id="text-8-10-2">
<pre class="example">
var divs = document.querySelectorAll('.aClass');
[].forEach.call(divs, function(div) {
  div.style.color="red";
});
</pre>
</div>
</div>

<div id="outline-container-org12304df" class="outline-4">
<h4 id="org12304df"><span class="section-number-4">8.10.3</span> Remove a class</h4>
<div class="outline-text-4" id="text-8-10-3">
<p>
Don't need to check existance
</p>
<pre class="example">
ELEMENT.classList.remove("CLASS_NAME");
ELEMENT.classList.add('hint');
</pre>
</div>
</div>

<div id="outline-container-org1362db5" class="outline-4">
<h4 id="org1362db5"><span class="section-number-4">8.10.4</span> Selected Option</h4>
<div class="outline-text-4" id="text-8-10-4">
<pre class="example">
var e = document.getElementById("selectElementID");
var i = e.selectedIndex;
var ep = e.options[i];
ep.value;
ep.text;
</pre>
</div>
</div>

<div id="outline-container-org72af445" class="outline-4">
<h4 id="org72af445"><span class="section-number-4">8.10.5</span> Element data attributes</h4>
<div class="outline-text-4" id="text-8-10-5">
<pre class="example">
&lt;div id="id" data-primary="abc"&gt;&lt;/div&gt;

var e = document.getElementById('id');
if (e.dataset.hasOwnProperty('primary')) {
  print e.dataset.primary;
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org0c9cebe" class="outline-3">
<h3 id="org0c9cebe"><span class="section-number-3">8.11</span> URI and URI Component Encode, Current URL, open, email link</h3>
<div class="outline-text-3" id="text-8-11">
<pre class="example">
var url1 = "http://abc.com";
var url2 = "http://xyz.com/test.php?url=" + encodeURIComponent(url1);
// decodeURIComponent();

// When you want a working URL as a whole with URL parameters
var uri = "http://abc.com/folder name with space/file name with space.asp?abc=has space"
var uri_en = encodeURI(uri);
// decodeURI(str)
</pre>

<p>
encodeURI do not encode these:
</p>
<pre class="example">
@*_+-./
</pre>

<p>
Both encodeURI and encodeURIComponent don't encode single quotes.
</p>

<p>
Current URL <a id="org3899a01">js:window.location</a>
</p>
<pre class="example">
console.log(window.location.href);

// window.location.href === window.location.toString() === 'http://abc.com/xyz/ijk.php?m=123#def'

// window.location.href = window.location.protocol + "//" 
// + window.location.host (abc.com)
// + window.location.pathname (/xyz/ijk.php, if homepage, '/')
// + window.location.search (?m=123)
// +  window.location.hash; (#def)
</pre>

<pre class="example">
// click to email
function sendMail() {
 var link = "mailto:me@example.com"
          + "?cc=myCCaddress@example.com"
          + "&amp;subject=" + encodeURIComponent("This is my subject")
          + "&amp;body=" + encodeURIComponent(document.getElementById('myText').value);
 window.location.href = link;
}

// open a new tab
window.open('/your-url', '_blank');
</pre>

<p>
Get URL Parameter
</p>
<pre class="example">
var getUrlParameter = function getUrlParameter(sParam) {
    var sPageURL = decodeURIComponent(window.location.search.substring(1)),
        sURLVariables = sPageURL.split('&amp;'),
        sParameterName,
        i;

    for (i = 0; i &lt; sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
            return sParameterName[1] === undefined ? true : sParameterName[1];
        }
    }
};

// Given http://dummy.com/?technology=jquery&amp;blog=jquerybyexample
var tech = getUrlParameter('technology');
</pre>
</div>
</div>

<div id="outline-container-orgca0f13d" class="outline-3">
<h3 id="orgca0f13d"><span class="section-number-3">8.12</span> Cookie <a id="org1fc1454">js:cookie</a></h3>
<div class="outline-text-3" id="text-8-12">
<p>
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie">https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie</a>
</p>
<div class="org-src-container">
<pre class="src src-js">cookieVal = <span style="color: #e67128;">"abc"</span>;
cookieKeyValPair = <span style="color: #e67128;">"litest="</span> + encodeURIComponent(cookieVal); 
<span style="color: #74af68;">// </span><span style="color: #74af68;">only one single cookie can be set/updated at a time</span>
document.cookie = cookieKeyValPair;

<span style="color: #74af68;">// </span><span style="color: #74af68;">Optional cookie attribute values, preceded by a semi-colon separator</span>
<span style="color: #ffad29; font-weight: bold;">var</span> <span style="color: #dbdb95;">d</span> = <span style="color: #ffad29; font-weight: bold;">new</span> <span style="color: #34cae2;">Date</span>();
d.setTime(d.getTime() + 30*24*60*60*1000); <span style="color: #74af68;">// </span><span style="color: #74af68;">30 days. If not set, cookie will be exired after browser is closed.</span>
<span style="color: #ffad29; font-weight: bold;">var</span> <span style="color: #dbdb95;">expires</span> = <span style="color: #e67128;">"expires="</span> + d.toUTCString();
cookieKeyValPair += <span style="color: #e67128;">"; "</span> + expires;
cookieKeyValPair += <span style="color: #e67128;">"; path='/mydir'"</span>;

<span style="color: #74af68;">// </span><span style="color: #74af68;">or</span>
cookieKeyValPair += <span style="color: #e67128;">"; path=/"</span>

<span style="color: #ffad29; font-weight: bold;">function</span> <span style="color: #00ede1; font-weight: bold;">setCookie</span>(<span style="color: #dbdb95;">cname</span>, <span style="color: #dbdb95;">cvalue</span>, <span style="color: #dbdb95;">exdays</span>) {
    <span style="color: #ffad29; font-weight: bold;">var</span> <span style="color: #dbdb95;">d</span> = <span style="color: #ffad29; font-weight: bold;">new</span> <span style="color: #34cae2;">Date</span>();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    <span style="color: #ffad29; font-weight: bold;">var</span> <span style="color: #dbdb95;">expires</span> = <span style="color: #e67128;">"expires="</span>+ d.toUTCString();
    document.cookie = cname + <span style="color: #e67128;">"="</span> + encodeURIComponent(cvalue) + <span style="color: #e67128;">";"</span> + expires + <span style="color: #e67128;">";path=/"</span>;
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org869b180" class="outline-3">
<h3 id="org869b180"><span class="section-number-3">8.13</span> Object only, no Class</h3>
<div class="outline-text-3" id="text-8-13">
<p>
<a id="org2f053f5">js:Object</a>
</p>
</div>
<div id="outline-container-orgb7b12e5" class="outline-4">
<h4 id="orgb7b12e5"><span class="section-number-4">8.13.1</span> new, Object.create</h4>
<div class="outline-text-4" id="text-8-13-1">
<p>
Every thing in Javascript is an object. No class.
</p>

<p>
Every object has a prototype object.
</p>

<p>
<i>Parent</i> is an object with a constructor (because it's a function) and a prototype object.
</p>

<p>
When <i>new</i> keyword is used, var parent = new Parent();, 
parent copies the Parent's prototype object and run the Parent's constructor.
If the constructor returns anything, parent will take it.
If the constructor returns nothing, the Parent object with prototype object and Parent's other properties defined in 
the constructor (this.xyz = &#x2026;) will be copied.
</p>

<p>
var SubParent.prototype = Object.create(Parent.prototype);
Copies Parent's prototype object and return it. So Parent's constructor is not run.
<a href="#orgc347faf">js:prototype</a>
</p>

<p>
You can create an object with null as prototype :: Object.create(null);
</p>

<p>
You can create an object with extra properties
Object.create(Object.prototype, 
{
 foo: {writable: true, configuration: true, value: 'hello', get: &#x2026;, set: &#x2026;, otherthings: &#x2026;},
 bar: {&#x2026;}
})
</p>
</div>
</div>

<div id="outline-container-orge20d8d5" class="outline-4">
<h4 id="orge20d8d5"><span class="section-number-4">8.13.2</span> instanceof</h4>
<div class="outline-text-4" id="text-8-13-2">
<p>
<a id="org6c26aa4">js:instanceof</a>
A useful operand that is for object to test instantiation
Syntax :: <i>object</i> instanceof <i>constructor</i>
Return true if <i>constructor</i>.prototype exists in <i>object</i>'s prototype chain
</p>
<dl class="org-dl">
<dt>object</dt><dd>an instance (an object)</dd>
<dt>constructor</dt><dd>Function object to test against. It has to be a function</dd>
</dl>

<p>
Use instanceof to test instantiation, and use <a href="#org1b3423b">js:prototype.isPrototypeOf</a> to test inheritance
</p>
</div>
</div>

<div id="outline-container-org19b7c83" class="outline-4">
<h4 id="org19b7c83"><span class="section-number-4">8.13.3</span> Object.defineProperty</h4>
<div class="outline-text-4" id="text-8-13-3">
<p>
<a id="org88c56aa">js:Object.defineProperty</a>
<a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty">MDN Object.defineProperty()</a>
</p>
</div>
</div>

<div id="outline-container-org889dfb3" class="outline-4">
<h4 id="org889dfb3"><span class="section-number-4">8.13.4</span> Example</h4>
<div class="outline-text-4" id="text-8-13-4">
<pre class="example">
function CustomerBooking(bookingId, customerName, film, showDate) {
/* This is a constructor. It is not a good way to define property
 * Better to use methods to set. But here should provide initialization
*/
  this.customerName = customerName;
  this.bookingId = bookingId;
  this.showDate = showDate;
  this.film = film;
// You can also call a method which is defined later to initialize properties.
}

CustomerBooking.prototype.getCustomerName = function() {
 return this.customerName;
}

CustomerBooking.prototype.setFilm = function(film) {
 this.film = film;
}

// Instantiate
var firstBooking = new CustomerBooking(1234,
 "Arnold Palmer", "Toy Story", "27 July 2004 20:15");

var enumerated = [];
for (var prop in firstBooking) {
 enumerated[enumerated.length] = prop;
}
// ["customerName","bookingId", "showDate", "film", "getCustomerName", ..., "setFilm"]

// A cinema can hold multiple CustomerBooking instances
function cinema() {
 this.bookings = new Array();
}

cinema.prototype.addBooking = function(bookingId, customerName, film, showDate) {
 this.bookings[bookingId] = new CustomerBooking(bookingId, customerName, film, showDate);
}

// Loop through bookings of a cinema
cinema.prototype.getBookingsTable = function() {
 var booking;
 var bookingsTableHTML = "&lt;table border=1&gt;";
 for (booking in this.bookings) {
  bookingsTable += this.bookings[booking].getBookdingId();
  ...
 }
 bookingsTableHTML += "&lt;/table&gt;";
 return bookingsTableHTML;
}

var londonOdeon = new cinema(); // Constructor takes no parameters
londonOdeon.addBooking(342, "First Last", "Toy Story", "15 July 2004 20:15");
</pre>
</div>
</div>
</div>

<div id="outline-container-orge3935cd" class="outline-3">
<h3 id="orge3935cd"><span class="section-number-3">8.14</span> Extending Native Object</h3>
<div class="outline-text-3" id="text-8-14">
<p>
Native prototype can't be deleted or replaced
But values of its properties can be modified or created
</p>

<p>
Create a new method in Array class which removes a member after checking if the method is already defined
</p>

<pre class="example">
Array.prototype.remove = Array.prototype.remove || function(member) {
 var i = this.indexOf(member);
 if (i &gt; -1) {
  this.splice(index,1);
 } 
 return this;
}

// If a method (remove) is created in native class, but later it was assigned as a property
// error will show 
</pre>

<p>
Newly added remove method is enumerable in <a href="#org91dd71a">js:for&#x2026;in</a> <a href="#org5a323ef">js:prototype.propertyIsEnumerable</a>
Inherited properties are not enumerable
To filter out method in <a href="#org91dd71a">js:for&#x2026;in</a>
</p>

<pre class="example">
var props = [];
for (var prop in results) {
 results.hasOwnProperty(prop) &amp;&amp; props.push(prop);
}
</pre>

<p>
<a id="orgf652ed0">Add "method" in Function class</a>
Then "method" exists in any function.
</p>
<pre class="example">
Function.prototype.method = function(name, func) {
 this.prototype[name] = func;
 return this;
}

// Parenizor is a custom class. Create a method called 'setValue'
Parenizor.method('setValue', function(v) {
 this.value = value;
 return this;
});
</pre>

<p>
<a id="org68b1cff">Add "inherits" in Function class</a>
</p>
<pre class="example">
Function.method('inherits', function(parent) {
 // parent is a class that is already defined
 // make a new instance
 this.prototype = new parent();
 var d = {},
     p = this.prototype;
 this.prototype.constructor = parent;
 this.method('uber', function uber(name) {
  if (!(name in d)) {
   d[name] = 0;
  } 
  var f, r, t = d[name], v = parent.prototype;
  if (t) {
   while (t) {
    v = v .contructor.prototype;
    t -= 1;
   }
   f= v[name];
  }
  else {
   f = p[name];
   if (f == this[name]) {
    f = v[name];
   }
  }
  d[name] +=1;
  r = f.apply(this, Array.prototype.slice.apply(arguments, [1]));
  d[name] -=1;
  return r;
 });
 return this;
});
</pre>
</div>
</div>

<div id="outline-container-org01cf908" class="outline-3">
<h3 id="org01cf908"><span class="section-number-3">8.15</span> Classical Inheritance, Parasitic Inheritance</h3>
<div class="outline-text-3" id="text-8-15">
<p>
<a id="org59ae43b">js:inheritance</a>
Classical inheritance is about the <span class="underline">is-a</span> relationship.
Parasitic inheritance is about the <span class="underline">was-a-but-now's-a</span> relationship.
</p>
</div>

<div id="outline-container-org0d1145f" class="outline-4">
<h4 id="org0d1145f"><span class="section-number-4">8.15.1</span> Classical inheritance</h4>
<div class="outline-text-4" id="text-8-15-1">
<p>
Refer to: <a href="#orgf652ed0">Add "method" in Function class</a>, <a href="#org68b1cff">Add "inherits" in Function class</a>
</p>
</div>

<div id="outline-container-org5c5f20a" class="outline-5">
<h5 id="org5c5f20a"><span class="section-number-5">8.15.1.1</span> Example</h5>
<div class="outline-text-5" id="text-8-15-1-1">
<pre class="example">
function Parenizor(v) {
// enclose v with ( and )
 this.setValue(v);
}

Parenizor.prototype = {
  constructor: Parenizor, // This line is crucial as we are overwriting Parenizor.prototype rather than adding
  setValue: function(v) {
    this.value = v;
    return this;
  },
  getValue: function() {
    return this.value;
  },
  toString: function() {
    return '(' + this.getValue() + ')';
  }
};

myParenizor = new Parenizor(0); 
myString = myParenizor.toString(); // "(0)"

// Subclass inherits parent class Parenizor
function ZParenizor(v, w) {
 Parenizor.call(this, v); // call parent class parenizor constructor
 // You can also call other parent class constructor
 // OtherParenizor.call(this, v);

 // Define other properties that this subclass should have
 this.otherValue = w;
}

ZParenizor.prototype = Object.create(Parenizor.prototype); 
// Inherits parent class's all methods. 
// First create an instance of the parent class and assign it to the child class.

// Inherits other parent class's all methods
// mixin(ZParenizor.prototype, OtherParenizor.prototype);

ZParenizor.prototype.constructor = ZParenizor; 
// Set subclass constructor 
// but ZParenizor should have its own constructor which is ZParenizor.prototype.constructor.

// Modify subclass's inherited method toString 

ZParenizor.prototype.toString = function() {
  // ...
}

var zParenizor = new ZParenizor('v', 'w');

console.log(zParenizor instanceof ZParenizor); // true
console.log(zParenizor instanceof Parenizor); // true
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org38ff7fc" class="outline-3">
<h3 id="org38ff7fc"><span class="section-number-3">8.16</span> OOP Pattern</h3>
<div class="outline-text-3" id="text-8-16">
<pre class="example">
// Javascript Singleton
(function() {
  this.myApp = this.MyApp || {};
  var ns = this.myApp; // further shorten the keyboard typing

  // private properties
  var vehicleCount = 5;
  var vehicles = [];

  // Public properties

  ns.publicHello = 'This is public';

  // Define a Class
  // You can even separate the class definition into another javascript file
  // Just remember to include the necessary closure like the above
  ns.Vehicle = (function() {

    function Vehicle(year, make, model) {
      this.year = year;
      this.make = make;
      this.model = model;
    }

    Vehicle.prototype = {
      getInfo: function () {
        return this.year + ' ' + this.make + ' ' + this.model;
      },
      startEngine: function () {
        return 'Vroom';
      }
    };

    return Vehicle;
  }());

  // Define a sub Class
  ns.Car = (function(parent) {

    function Car(year, make, model) {
      parent.call(this, year, make, model);
      this.wheelQuantity = 4;
    }

    Car.prototype = Object.create(parent.prototype);
    Car.prototype.constructor = Car;
    Car.prototype.getInfo = function() {
      // Extend parent's method
      return 'Vehicle Type: Car ' + parent.prototype.getInfo.call(this);
    }

    return Car;
  }(ns.Vehicle));

}());

console.log(myApp.publicHello);

// Instantiate
var v = new myApp.Vehicle(2012, 'Toyota', 'Rav4');
console.log(v.getInfo());

var c = new myApp.Car(2012, 'Toyota', 'Rav4');
console.log(c.getInfo());
</pre>
</div>
</div>

<div id="outline-container-orge3f0323" class="outline-3">
<h3 id="orge3f0323"><span class="section-number-3">8.17</span> Promise</h3>
<div class="outline-text-3" id="text-8-17">
<p>
Promise is now native in all browsers including Edge except IE.
</p>

<p>
IE polyfill <a href="https://github.com/stefanpenner/es6-promise">https://github.com/stefanpenner/es6-promise</a>
</p>
<pre class="example">
&lt;script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js"&gt;&lt;/script&gt;
</pre>

<pre class="example">
function get(url) {
  // You should wrap all code into return
  return new Promise(function (resolve, reject) {
    // run resolve or reject function to resolve or reject a promise
    var req = new XMLHttpRequest();
    req.open('GET', url); // it can be set to async

    req.onload = function () {
      if (req.status == 200) {
        resolve(req.response);
      }
      else {
        reject(Error(req.statusText));
      }
    };

    req.onerror = function () {
      reject(Error("Network Error"));
    }

  });
}

get('story.json')
  .then(function (response) {
    console.log('Success!', response);
    // transform a value to the next .then
    // just return the value, you may modify it
    // The returned value has to be a non-promise
    return JSON.parse(response);
  }, function (error) {
    console.log('Failed!', error);
    return error;
  })
  .then(function (response) {
    console.log('JSON!', response);
  });

// If a 'then' just returns a value when it's resolved, use a shortform
get('story.json').then(JSON.parse).then(function(response) {
  console.log('JSON!', response);
});

// In 'then', you can return a promise
// a promise.then is a promise

function getJSON(url) {
  return get(url).then(JSON.parse);
}

getJSON('story.json').then(function(story) {
  return getJSON(story.chapterUrls[0]);
}).then(function(chapter1) {
  console.log('Got Chapter 1', chapter1);
});

// Store the result of a promise and reuse it
var storyPromise;

function getChapter(i) {
  storyPromise = storyPromise || getJSON('story.json');

  return storyPromise.then(function(story) {
    return getJSON(story.chapterUrls[i]);
  });
}

getChapter(0).then(function(chapter) {
  console.log(chapter);
  return getChapter(1);
}).then(function(chapter) {
  console.log(chapter);
});

// .catch(function(e) { ... }) equals to
// .then(undefined, function(e) { ... })

// Dynamically chained .then()
// Start with a resolved promise: Promise.resolve('initialValue')
// a reject promise: Promise.reject('initialValue')
getJSON('story.json')
  .then(function(story) {
    // addHTMLToPage(story.heading);
    return story.chapterUrls.reduce(function(sequence, chapterUrl) {
      return sequence
        .then(function() { return getJSON(chapterUrl); })
        .then(function(chapter) { /* addHtmlToPage(chapter.html); */ });
    }, Promise.resolve());
  })
  .then(function() { /* addTextToPage("All done"); */ })
  .catch(function(err) { /* addTextToPage("broken" + err.message); */ })
  .then(function() { /* document.querySelector('.spinner').style.display='none'; */ });

// Start a set of promises in parallel and create a promise that fulfils when all are fulfilled
getJSON('story.json')
  .then(function(story) {
    // addHTMLToPage(story.heading);
    return Promise.all(
      story.chapterUrls.map(getJSON)
    ); // not a callback. It's an array of Promises (not chained)
    // After promises are added to array as values, they are started already

    // Start a set of promises in parallel, chain them so that we get response in order

    return story.chapterUrls.map(getJSON)
      .reduce(function (sequence, chapterPromise) {

        return sequence
          .then(function () {
            return chapterPromise;
          })
          .then(function (chapter) {
            addHtmlToPage(chapter.html);
          });

      }, Promise.resolve());


  })
  .then(function() { /* ... */ })
  .catch(function(err) { /* ... */ })
  .then(function() { /* ... */ });
</pre>
</div>
</div>

<div id="outline-container-org26e8259" class="outline-3">
<h3 id="org26e8259"><span class="section-number-3">8.18</span> Observable <a id="orgeebf565">js:observable</a></h3>
<div class="outline-text-3" id="text-8-18">
<p>
A promise is a push mechanism that calls some code after the promise has been resolved or rejected with a single value.
An observable is like a promise, but it calls some code every time a new value becomes available, and can emit many values over time.
</p>
</div>
</div>

<div id="outline-container-org551e4cc" class="outline-3">
<h3 id="org551e4cc"><span class="section-number-3">8.19</span> Worker</h3>
<div class="outline-text-3" id="text-8-19">
<p>
IE 10 and above supports worker.
Workers are independent and separated from parent window. 
Don't try to access or modify parent window DOM. Do it indirectly.
</p>
<pre class="example">
var w;

if (typeof(Worker) !== "undefined") {
 if (typeof(w) == "undefined") {
  w = new Worker("demo_workers.js");
 }
 // Receive message from worker
 w.onmessage = function(event) {
  console.log(event.data);
 }

 w.onerror = function(error) {
  console.log(error.message, error.filename, error.lineno);
 }

 // Send message to worker
 w.postMessage(['First Name', 'Last Name']);
}

w.terminate();
w = undefined;

// demo_workers.js
var i = 0;

function timedCount() {
 i = i + 1;
 postMessage(i);
 setTimeout("timeCount()", 500);
}

close(); // Worker can close itself

// This is how worker receives a message
onmessage = function(e) {
  console.log("Message receved by worker from main window");
  var workerResult = 'Result: ' + (e.data[0] * e.data[1]);
  console.log('Posting message back to main window');
  postMessage(workerResult);
}

// Workers can spawn or create subworkers. URIs of subwokers are resolved relative to
// the parent worker's location rather than that of the owning page.

// Worker can load scripts within the same domain
// Scripts are loaded and executed in order.
importScripts('foo.js');
importScripts('foo.js','bar.js');

// Spawn a shared worker. IE doesn't support sharedWorker
// Worker Square and Worker Multiply2Numbers both use shared worker Multiply
// In sqaure.js and multiply2numbers.js

if (!!window.SharedWorker) {
 var sharedWorker = new SharedWorker("multiply.js");
 sharedWorker.port.postMessage([123,123]); // square.js
 sharedWorker.port.postMessage([123,789]); // multiply2numbers.js

 sharedWorker.port.start(); // Only needed in parent thread if onmessage is not defined
 // such as the shares worker is a callback of event listener in parent thread

 sharedWorker.port.onmessage = function(e) {
  //
  console.log(e.data); // receive from shared worker
 }
}

// In multiply.js shared worker
port.start(); // only needed if onmessage is not defined in parent thread

onconnect = function(e) {
 var port = e.ports[0];

 port.onmessage = function(e) {
  var workerResult = 'Result: ' + (e.data[0] * e.data[1]);
  port.postMessage(workerResult);
 }
}
</pre>
</div>
</div>

<div id="outline-container-org0235cd1" class="outline-3">
<h3 id="org0235cd1"><span class="section-number-3">8.20</span> <a href="#org88b9832">XMLHttpRequest</a> <a id="org88b9832">XMLHttpRequest</a></h3>
<div class="outline-text-3" id="text-8-20">
<pre class="example">
function loadDoc() {
 var xhttp = new XMLHttpRequest();

 // event handlers. Others: onloadstart, onprgress, onabort, onerror, onload, ontimeout, onloadend
 // Always use onload instead of onreadystatechange
 // onload = onreadystatechange and this.readyState ==4

 // XHR property: readyState
 // 0: request not initialized, 
 // 1: connection established
 // 2: request received, 
 // 3: processing request
 // 4: request finished and response is ready 

 xhttp.onload = function() {
  if (this.status == 200) {
   console.log(
      this.responseText // as text
    , this.responseXML // as it's XML data
    , this.statusText // "OK" or "Not Found"
   );

    console.log(xhttp.getAllResponseHeaders());
    xhttp.getResponseHeader("Last-Modified");

  } 
 };

 xhttp.open('GET', 'ajax_info.txt'
 , true // async
 , "username" // optional
 , "psw" // optional
 );

 /* After open() */
 xhttp.setRequestHeader(); // set request header. Especially if 'POST' form fields
 /* For POST
  * xhttp.setRequestHeader("Content-type",'application/x-www-form-urlencoded');
  */

 // For receiving a binary string
 // xhttp.overrideMimeType("text/plain; charset=x-user-defined");

 /* before send(); */

 xhttp.send(); // Nothing when 'GET'
 /* For POST
  * var fname = encodeURIComponent('Henry');
  * var varJson = encodeURIComponent(JSON.stringify(var1));
  * xhttp.send("fname="+fname+"&amp;var2="+varJson);
  * if .setRequestHeader content-type is www-form-urlencoded
  * when data is received from PHP, you need to
  * json_decode(stripslashes($_POST['var2'])) 
  */

 // binary data can be sent
 /* var blob = new Blob(['abc123'], {type: 'text/plain'});
  * xhttp.send(blob);
  * var myArray = new ArrayBuffer(512);
  * var longInt8View = new Uint8Array(myArray);
  * for (var i=0; i&lt; longInt8View.length; i++) {
  *  longInt8View[i] = i % 255;
  * }
  * xhttp.send(myArray);
  */ 
}
</pre>
</div>

<div id="outline-container-org32a79fe" class="outline-4">
<h4 id="org32a79fe"><span class="section-number-4">8.20.1</span> application/x-www-form-urlencoded vs multipart/form-data</h4>
<div class="outline-text-4" id="text-8-20-1">
<p>
urlencoded has to transfer extra data if large amount of binary data is sent.
</p>

<p>
multipart/form-data
</p>
<ul class="org-ul">
<li>Request header
<ul class="org-ul">
<li>Content-Type: multipart/form-data; boundary=&#x2013;user-agent-sets-this-boundary</li>
</ul></li>
<li>Request Payload</li>
</ul>
<pre class="example">
--user-agent-sets-this-boundary
Content-Disposition: form-data; name="gv-inv_image"; filename="alectra-APP-dynamic-card.jpg"
Content-Type: image/jpeg



--user-agent-sets-this-boundary--
</pre>
</div>
</div>

<div id="outline-container-org63e5719" class="outline-4">
<h4 id="org63e5719"><span class="section-number-4">8.20.2</span> FormData to send file</h4>
<div class="outline-text-4" id="text-8-20-2">
<p>
Supports all browsers except IE 9 and below.
</p>

<pre class="example">
&lt;input type="file" id="gv-inv_image"&gt;

var fileInputElement = document.getElementById('gv-inv_image');

var formData = new FormData();

formData.append("username", "Groucho");
formData.append("accountnum", 123456); // number 123456 is immediately converted to a string "123456"

// if value is not string or Blob or file, it will be converted to string

// HTML file input, chosen by user
formData.append("userfile", fileInputElement.files[0]);

// you can check the file before it gets uploaded

// JavaScript file-like object
var content = '&lt;a id="a"&gt;&lt;b id="b"&gt;hey!&lt;/b&gt;&lt;/a&gt;'; // the body of the new file...
var blob = new Blob([content], { type: "text/xml"});

formData.append("webmasterfile", blob);

var request = new XMLHttpRequest();
request.open("POST", "http://foo.com/submitform.php");
request.send(formData);
// request content type is multipart/form-data
</pre>

<p>
php
</p>
<pre class="example">
if (isset($_FILES['gv-inv_image'])) {
  $file         = $_FILES['gv-inv_image']['name'];
  $ext          = pathinfo($file, PATHINFO_EXTENSION);
  $filename = sha1(rand(25, 1920) . rand(72, 2560)) . '-' . time();
  $filename = strtoupper($filename) . '.' . $ext;
  if (move_uploaded_file($_FILES['gv-inv_image']['tmp_name'], '../uploads/' . $filename)) {
      $result = ['status' =&gt; 'OK', 'filename' =&gt; $filename];
  }
  else {
      $result = ['status' =&gt; 'ERR', 'message' =&gt; 'File Move Error.'];
  }
}
</pre>
</div>
</div>

<div id="outline-container-org2c57c21" class="outline-4">
<h4 id="org2c57c21"><span class="section-number-4">8.20.3</span> Receive binary as arraybuffer or blob</h4>
<div class="outline-text-4" id="text-8-20-3">
<pre class="example">
var oReq = new XMLHttpRequest();
oReq.open("GET", "/myfile.png", true);
oReq.responseType = "arraybuffer";

oReq.onload = funciton(event) {
 var arrayBuffer = oReq.response; // not .responseText
 if (arrayBuffer) {
  // Read arraybuffer
  var byteArray = new Uint8Array(arrayBuffer);
  for (var i=0; i &lt; byteArra.byteLength; i++) {
   // do something
  }
  // Read arraybuffer.

  // Construct a blob from arraybuffer
  var blob = new Blob( [arrayBuffer], {type: "image/png"} ); 

 }
};

oReq.send();
</pre>

<p>
Specify the received data is blob
</p>
<pre class="example">
var oReq = new XMLHttpRequest();
oReg.open("GET", "/myfile.png", true);
oReq.responseType = "blob";

oReq.onload = function(e) {
 var blob = oReq.response;
}

oReq.send();
</pre>
</div>
</div>
</div>

<div id="outline-container-org32bcfcd" class="outline-3">
<h3 id="org32bcfcd"><span class="section-number-3">8.21</span> File handling</h3>
<div class="outline-text-3" id="text-8-21">
<p>
<a href="https://developer.mozilla.org/en-US/docs/Web/API/File/Using_files_from_web_applications">https://developer.mozilla.org/en-US/docs/Web/API/File/Using_files_from_web_applications</a>
</p>
</div>
</div>

<div id="outline-container-orgb5ca85a" class="outline-3">
<h3 id="orgb5ca85a"><span class="section-number-3">8.22</span> Apply XSLT on XML</h3>
<div class="outline-text-3" id="text-8-22">
<pre class="example">
function loadXMLDoc(filename) {
 var xhttp = new XMLHttpRequest();
 xhttp.open("GET", filename, false);
 try {
  xhttp.responseType = "msxml-document";
 }
 catch(err) {}
 xhttp.send();
 return xhttp.responseXML;
}

var xml = loadXMLDoc('cdcatalog.xml');
var xsl = loadXMLDoc('cdcatalog.xsl');

var xsltProcessor = new XSLTProcessor();
xsltProcesser.importStylesheet(xsl);
resultDocument = xsltProcesser.transformToFragment(xml, document);
document.getElementById("example").appendChild(resultDocument);

</pre>
</div>
</div>

<div id="outline-container-orgda9ae83" class="outline-3">
<h3 id="orgda9ae83"><span class="section-number-3">8.23</span> Apply <a href="#orgc0cbc97">XPath</a></h3>
<div class="outline-text-3" id="text-8-23">
<pre class="example">
var x=loadXMLDoc("books.xml");
var xml = x.responseXML;
path = "/bookstore/book[1]/title";

var nodes = xml.evaluate(path, xml, 
null, // namespaceResolver
XPathResult.ANY_TYPE, // resultType
null // If an existing XPathResult object is specified, it will be reused
); // Return xpathResult object 
var result = nodes.iterateNext();

while (result) {
 console.log(result.childNodes[0].nodeValue);
 result = nodes.iterateNext();
} 

</pre>
</div>
</div>

<div id="outline-container-org0ed7a15" class="outline-3">
<h3 id="org0ed7a15"><span class="section-number-3">8.24</span> Web APIs</h3>
<div class="outline-text-3" id="text-8-24">
</div>
<div id="outline-container-orgdcd72c3" class="outline-4">
<h4 id="orgdcd72c3"><span class="section-number-4">8.24.1</span> WebSocket <a id="org6fb8196">js:ws</a></h4>
<div class="outline-text-4" id="text-8-24-1">
<p>
Javascript on client (e.g. web browser)
</p>
<pre class="example">
var connection = new WebSocket('ws://abc.com/echo', ['soap', 'xmpp']);
// ['soap', 'xmpp'] are subprotocols

// When connection is open, send some data
connection.onopen = function() {
 connection.send('Ping'); // send string
};

// When connection close
connection.onclose = function() {
  // do something
};

// Send ArrayBuffer as binary
var img = canvas_context.getImageData(0, 0,400, 320);
var binary = new Unit8Array(img.data.length);
for (var i = 0; i &lt; img.data.length; i++) {
 binary[i] = img.data[i];
}
connection.send(binary.buffer);

// Send file as Blob
var file = document.querySelector('input[type="file"]').files[0];
connection.send(file);

connection.onerror = function(error) {
 console.log('WebSocket Error ' + error);
};

connection.onmessage = function(e) {
 console.log(e.data);
};

// Define binary type before onmessage to receive binary
connection.binaryType = 'arraybuffer'; // or blob
connection.onmessage = function(e) {
 console.log(e.data.byteLength);
};
</pre>
</div>
</div>

<div id="outline-container-org8bed0ed" class="outline-4">
<h4 id="org8bed0ed"><span class="section-number-4">8.24.2</span> Mutation Observer <a id="org5be9653">js:MutationObserver</a></h4>
<div class="outline-text-4" id="text-8-24-2">
<p>
<a href="https://developer.mozilla.org/en/docs/Web/API/MutationObserver">MDN MutationObserver</a> <a href="https://developer.mozilla.org/en-US/docs/Web/API/MutationRecord">MDN MutationRecord</a>
</p>

<pre class="example">
MutationObserver = window.MutationObserver;

// callback function has 2 arguments
// mutations: an array of objects of type MutationRecord
// observer: this MutationObserver instance
var observer = new MutationObserver(function (mutations, observer) {
  mutations.forEach(function (mutation) {

    // A MutationRecord has properties
    // Some of them might be different based on MutationObserver's options

    // Loop addedNodes
    // addedNodes return NodeList which doesn't have .forEach
    // js:Function.call
    Array.prototype.forEach.call(
      mutation.addedNodes,
      function (addedNode) {
        if (addedNode.id == "bar") {
          console.log("bar was added!");
        }
      });
  });
});

// Define the parent element
var target = document.getElementById('foo');
// Or $('#foo').get(0)

// Which event should be observed
var config = {
  attributes: true,
  attributeOldValue: true, // set to true if attributes is set to true
  // attributeFilter: ['attr1', 'attr2'], // filter out an array of attribute local names in observation
  childList: true, // add/remove child elements including text nodes
  subtree: true, // any change to the subtree including all descendants
  characterData: true, // maybe image or multimedia changes?
  characterDataOldValue: true
};

observer.observe(target, config);

// You may stop observing later
observer.disconnect();
</pre>
</div>
</div>

<div id="outline-container-org7c3aad8" class="outline-4">
<h4 id="org7c3aad8"><span class="section-number-4">8.24.3</span> Intersection Observer <a id="org99aed0b">js:intersection observer</a></h4>
<div class="outline-text-4" id="text-8-24-3">
<p>
<a href="https://developers.google.com/web/updates/2016/04/intersectionobserver">Introduction by Google</a> <a href="https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API">MDN</a>
</p>

<p>
Supported in Edge, Firefox, Chrome, Chrome Android but not Safar and iOS
</p>

<p>
It registers a callback function which is only executed when an element enters or exists another element or intersects at a threshold and thus saves event for every scroll or viewport movement.
</p>

<p>
It doesn't tell the exact number of pixels that overlap or specifically which ones they are; however, it convers the much more common use case of "If they intersect by somewhere around N%, I need to do something".
</p>

<pre class="example">
var io = new IntersectionObserver(
  entries =&gt; {
    console.log(entries);
  },
  {
    // Using default options: callback will be called only when the element comes partially into view and when it completely leaves the viewport. Details below
  }
);
// Start observing an element
io.observe(element);

// Stop observing an element
// io.unobserve(element);

// Disable entire IntersectionObserver
// io.disconnect();
</pre>

<p>
Parameter entries are readonly <a href="https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserverEntry">IntersectionObserverEntry</a> and they are delivered asynchronously and callback will run in the main thread.
</p>
<dl class="org-dl">
<dt>rootBounds</dt><dd>DOMRect, the result of calling element.getBoundingClientRect() on the root element, which is the viewport by default.</dd>
<dt>boundingClientRect</dt><dd>DOMRect, the result of element.getBoundingClientRect() on the observed element.</dd>
<dt>intersectionRect</dt><dd>DOMRect, the intersection of the above 2 rectangles and tells which part of the observed element is visible</dd>
<dt>intersectionRatio</dt><dd>how much of the element is visible.</dd>
</dl>

<p>
Options
</p>
<dl class="org-dl">
<dt>root</dt><dd>Default <code>null</code></dd>
<dt>threshold</dt><dd>Default <code>[0]</code>, callback is called when intersectionRatio is greater or lower (2 times), you can set [0, 0.25, 0.5, 0.75, 1]</dd>
<dt>rootMargin</dt><dd>Default <code>"0px"</code>, grow or shrink the area used for intersections.</dd>
</dl>

<p>
If an iframe observes one of its elements, both scrolling the iframe as well as scrolling the window containing the iframe will trigger the callback. For the latter case, rootBounds will be set to null to avoid leaking data across origins.
</p>
</div>
</div>
</div>

<div id="outline-container-org81c90c6" class="outline-3">
<h3 id="org81c90c6"><span class="section-number-3">8.25</span> Testing</h3>
<div class="outline-text-3" id="text-8-25">
</div>
<div id="outline-container-org81bc6e7" class="outline-4">
<h4 id="org81bc6e7"><span class="section-number-4">8.25.1</span> Unit Testing</h4>
<div class="outline-text-4" id="text-8-25-1">
<p>
QUnit
</p>
</div>
</div>
</div>

<div id="outline-container-org8c9b043" class="outline-3">
<h3 id="org8c9b043"><span class="section-number-3">8.26</span> Worker</h3>
<div class="outline-text-3" id="text-8-26">
</div>
<div id="outline-container-org4809293" class="outline-4">
<h4 id="org4809293"><span class="section-number-4">8.26.1</span> Web Worker</h4>
<div class="outline-text-4" id="text-8-26-1">
<p>
Workers are in external files which don't have access to DOM (objects like window, document and parent) and completely separate from the webpage.
</p>

<p>
Use a Web Worker for heavy computation on the client. Use a Service Worker for offline capabilities like intercepting network requests, as well as other fun stuff like push notifications and synchronization of content in the background.
</p>

<pre class="example">
var w;
if (typeof(Worker) !== "undefined") {
  if (typeof(w) == "undefined") {
    w = new Worker("demo_workers.js");
  }
  w.onmessage = function(e) {
    console.log(e.data);
  }
}
else {
  // Worker not supported
}

// demo_workers.js
var i=0;
function timedCount() {
  i= i +1;
  postMessage(i);
  setTimeout("timedCount()", 500);
}
timedCount();
</pre>
</div>
</div>

<div id="outline-container-org901a075" class="outline-4">
<h4 id="org901a075"><span class="section-number-4">8.26.2</span> Service Worker</h4>
<div class="outline-text-4" id="text-8-26-2">
</div>
<div id="outline-container-org15878b2" class="outline-5">
<h5 id="org15878b2"><span class="section-number-5">8.26.2.1</span> Basics</h5>
<div class="outline-text-5" id="text-8-26-2-1">
<p>
<a href="https://developers.google.com/web/fundamentals/primers/service-workers/">https://developers.google.com/web/fundamentals/primers/service-workers/</a>
Support status :: <a href="https://jakearchibald.github.io/isserviceworkerready/">https://jakearchibald.github.io/isserviceworkerready/</a> IE11 is not supported
HTTPS or localhost
It can do push notifications and background sync and periodic sync or geofencing in the future. It is a Javascript Web Worker
ES6 can be used to write sw
</p>

<pre class="example">
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/sw.js').then(function(registration) {
      // Registration was successful
      console.log('ServiceWorker registration successful with scope: ', registration.scope);
    }, function(err) {
      // registration failed :(
      console.log('ServiceWorker registration failed: ', err);
    });
  });
}
</pre>

<p>
register() can be called many times without concern. Path can be relative path e.g. './sw.js', for event fetch, urls can also be relative.
Say project is /train/* and /train/sw.js, specify URLs to resource with different query string in mind
</p>
<pre class="example">
register('./sw.js')

urlsToCache = [
  './', // /train/
  'index.html', // /train/index.html
  'images/a.jpg',  // /train/images/a.jpg
  'scripts/a.js'
]
</pre>

<p>
register('<i>sw.js') :: sw receives fetch events for everything on this domain
register('/ex/sw.js') :: sw only sees and receives fetch events for pages whose URL starts with /ex</i>, <i>ex/page1</i>, <i>ex/page2</i> etc.
</p>

<p>
chrome://inspect/#service-workers :: shows an sw exists <a href="https://yoursite.com/serviceworker">https://yoursite.com/serviceworker</a> with a pid which you can inspect and terminiate. Incognito kills all sw if Incognitor is closed.
</p>

<p>
In sw.js
</p>
<pre class="example">
var CACHE_NAME = 'my-site-cache-v1';
var urlsToCache = [
  '/',
  '/styles/main.css',
  '/script/main.js'
];

self.addEventListener('install', function(event) {
  // Perform install steps
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then(function(cache) {
        console.log('Opened cache');

        // load other resources e.g. big resources that are not absolutely needed in first load
        // sw may be killed and unfinished downloading in this part may be dropped.
        // cache.addAll(...);

        return cache.addAll(urlsToCache);
        // Accept all URLs to fetch from and add response to the cache
        // if any files fail to download, the install step will fail
        // When all fetch promises are resolved, event activate event is triggered. 

      })
  );
  return self.clients.claim(); // activate sw faster
});

// when user navigates to a different page or refreshes, sw receives fetch events
// return cache as response if cache has it, otherwise make a network request to fetch
self.addEventListener('fetch', function(event) {
  event.respondWith(
    // find any cached results from any of the caches sw created.
    caches.match(event.request)
      .then(function(response) {
          // Cache hit - return response (cache value)
          if (response) {
            return response;
          }
          // fetch over the network
          return fetch(event.request);
        }
      )
  );
});
</pre>

<p>
event.waitUntil adds 1 promise to the install and activate event callbacks. Multiple event.waitUntil is possible inside the event callback and all promises have to settle.
</p>

<p>
Event callbacks for install and activate have to be finished before event fetch can be run.
</p>

<p>
fetch :: return if cache is found, otherwise make a network request to fetch, check response, if not successful or not coming from the same origin, just return the response, otherwise cache that response
</p>
<pre class="example">
self.addEventListener('fetch', function(event) {
  event.respondWith(
    caches.match(event.request)
      .then(function(response) {
        // Cache hit - return response
        if (response) {
          return response;
        }

        // IMPORTANT: Clone the request. A request is a stream and
        // can only be consumed once. Since we are consuming this
        // once by cache and once by the browser for fetch, we need
        // to clone the response.
        var fetchRequest = event.request.clone();

        return fetch(fetchRequest).then(
          function(response) {
            // Check if we received a valid response
            // 'basic' means it's a request from the current origin
            if(!response || response.status !== 200 || response.type !== 'basic') {
              return response;
            }

            // IMPORTANT: Clone the response. A response is a stream
            // and because we want the browser to consume the response
            // as well as the cache consuming the response, we need
            // to clone it so we have two streams.
            var responseToCache = response.clone();

            caches.open(CACHE_NAME)
              .then(function(cache) {
                cache.put(event.request, responseToCache);
              });

            return response;
          }
        );
      })
  );
});
</pre>

<p>
Update Service Worker (sw.js)
</p>
<ul class="org-ul">
<li>Update your service worker JavaScript file. When the user navigates to your site, the browser tries to redownload the script file that defined the service worker in the background. If there is even a byte's difference in the service worker file compared to what it currently has, it considers it new.</li>
<li>Your new service worker will be started and the install event will be fired.</li>
<li>At this point the old service worker is still controlling the current pages so the new service worker will enter a waiting state.</li>
<li>When the currently open pages of your site are closed, the old service worker will be killed and the new service worker will take control.</li>
<li>Once your new service worker takes control, its activate event will be fired.</li>
</ul>


<p>
Event activate is fired when the service worker starts up. Long event activate may block page loads. Keep it as lean as possible, only use it for things you couldn't do while the old version was active.
</p>

<p>
Create 'pages-cache-v1' and 'blog-posts-cache-v1' and delete old 'my-site-cache-v1'
</p>
<pre class="example">
self.addEventListener('activate', function(event) {

  var cacheWhitelist = ['pages-cache-v1', 'blog-posts-cache-v1'];

  event.waitUntil(
    caches.keys().then(function(cacheNames) {
      return Promise.all(
        cacheNames.map(function(cacheName) {
          if (cacheWhitelist.indexOf(cacheName) === -1) {
            return caches.delete(cacheName);
          }
        })
      );
    })
  );
});
</pre>

<p>
To manually refresh sw.js on DevTools, Application &gt; Service Workers &gt; skipWaiting, or on the top to enable Update on reload
</p>

<p>
fetch: always serve cache first, but always update cache
<a href="https://developers.google.com/web/fundamentals/primers/service-workers/high-performance-loading">https://developers.google.com/web/fundamentals/primers/service-workers/high-performance-loading</a>
</p>

<pre class="example">
self.addEventListener('fetch', function(event) {
  event.respondWith(
    caches.open('mysite-dynamic').then(function(cache) {
      return cache.match(event.request).then(function(response) {
        var fetchPromise = fetch(event.request).then(function(networkResponse) {
          cache.put(event.request, networkResponse.clone());
          return networkResponse;
        })
        return response || fetchPromise;
      })
    })
  );
});
</pre>
</div>
</div>

<div id="outline-container-orge7cfd63" class="outline-5">
<h5 id="orge7cfd63"><span class="section-number-5">8.26.2.2</span> PWA</h5>
<div class="outline-text-5" id="text-8-26-2-2">
<p>
<a href="https://codelabs.developers.google.com/codelabs/your-first-pwapp/#0">https://codelabs.developers.google.com/codelabs/your-first-pwapp/#0</a>
</p>
</div>
</div>

<div id="outline-container-org2862834" class="outline-5">
<h5 id="org2862834"><span class="section-number-5">8.26.2.3</span> Caching strategies</h5>
<div class="outline-text-5" id="text-8-26-2-3">
<p>
<a href="https://jakearchibald.com/2014/offline-cookbook/">https://jakearchibald.com/2014/offline-cookbook/</a>
</p>

<p>
Cache when an action is triggered. Caches API is available from regular pages not only sw.js
</p>
<pre class="example">
document.querySelector('.cache-article')
.addEventListener('click', function(event) {
  event.preventDefault();

  var id = this.dataset.articleId;
  caches.open('mysite-article-' + id).then(function(cache) {
    fetch('/get-article-urls?id=' + id).then(function(response) {
      // /get-article-urls returns a JSON-encoded array of
      // resource URLs that a given article depends on
      return response.json();
    }).then(function(urls) {
      cache.addAll(urls);
    });
  });
});
</pre>

<p>
Serve a offline page if both cache and network are not available
</p>
<pre class="example">
self.addEventListener('fetch', function(event) {
  event.respondWith(
    // Try the cache
    caches.match(event.request).then(function(response) {
      // Fall back to network
      return response || fetch(event.request);
    }).catch(function() {
      // If both fail, show a generic fallback:
      return caches.match('/offline.html');
      // However, in reality you'd have many different
      // fallbacks, depending on URL &amp; headers.
      // Eg, a fallback silhouette image for avatars.
    })
  );
});
</pre>

<p>
Sample
</p>
<pre class="example">
self.addEventListener('fetch', function(event) {
  // Parse the URL:
  var requestURL = new URL(event.request.url);

  // Handle requests to a particular host specifically
  if (requestURL.hostname == 'api.example.com') {
    event.respondWith(/* some combination of patterns */);
    return;
  }
  // Routing for local URLs
  if (requestURL.origin == location.origin) {
    // Handle article URLs
    if (/^\/article\//.test(requestURL.pathname)) {
      event.respondWith(/* some other combination of patterns */);
      return;
    }
    if (/\.webp$/.test(requestURL.pathname)) {
      event.respondWith(/* some other combination of patterns */);
      return;
    }
    if (request.method == 'POST') {
      event.respondWith(/* some other combination of patterns */);
      return;
    }
    if (/cheese/.test(requestURL.pathname)) {
      event.respondWith(
        new Response("Flagrant cheese error", {
          status: 512
        })
      );
      return;
    }
  }

  // A sensible default pattern
  event.respondWith(
    caches.match(event.request).then(function(response) {
      return response || fetch(event.request);
    })
  );
});
</pre>
</div>
</div>

<div id="outline-container-org817e68f" class="outline-5">
<h5 id="org817e68f"><span class="section-number-5">8.26.2.4</span> Push (not yet available on Chrome)</h5>
<div class="outline-text-5" id="text-8-26-2-4">
<p>
Update cache before showing a notification
</p>
<pre class="example">
self.addEventListener('push', function(event) {
  if (event.data.text() == 'new-email') {
    event.waitUntil(
      caches.open('mysite-dynamic').then(function(cache) {
        return fetch('/inbox.json').then(function(response) {
          cache.put('/inbox.json', response.clone());
          return response.json();
        });
      }).then(function(emails) {
        registration.showNotification("New email", {
          body: "From " + emails[0].from.name
          tag: "new-email"
        });
      })
    );
  }
});

self.addEventListener('notificationclick', function(event) {
  if (event.notification.tag == 'new-email') {
    // Assume that all of the resources needed to render
    // /inbox/ have previously been cached, e.g. as part
    // of the install handler.
    new WindowClient('/inbox/');
  }
});
</pre>
</div>
</div>

<div id="outline-container-org62d4729" class="outline-5">
<h5 id="org62d4729"><span class="section-number-5">8.26.2.5</span> Background sync (not yet available on Chrome)</h5>
<div class="outline-text-5" id="text-8-26-2-5">
<pre class="example">
self.addEventListener('sync', function(event) {
  if (event.id == 'update-leaderboard') {
    event.waitUntil(
      caches.open('mygame-dynamic').then(function(cache) {
        return cache.add('/leaderboard.json');
      })
    );
  }
});
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2f40c1f" class="outline-3">
<h3 id="org2f40c1f"><span class="section-number-3">8.27</span> iFrame</h3>
<div class="outline-text-3" id="text-8-27">
</div>
<div id="outline-container-orga60f738" class="outline-4">
<h4 id="orga60f738"><span class="section-number-4">8.27.1</span> Communication Between Children Window and Parent Window</h4>
<div class="outline-text-4" id="text-8-27-1">
<p>
A parent window can have multiple iframes and iframes are loaded from other domain.
</p>

<pre class="example">
// Post message from iFrame to parent Window
// In iframe
parent.postMessage('the message','*');
// or window.top.postMessage

// In parent window
function receiveMessage(event) {
 if (event.origin !== 'http://otherdomain.com') return;
 console.log(event.data);
}
window.addEventListener("message", receiveMessage, false);
</pre>

<pre class="example">
// Post message from parent window to iFrame
// In parent window
window.onload = function() {
  var receiver = document.getElementById("#iFrameID").contentWindow;
  receiver.postMessage('Hello', 'http://iframe.src.domain'); // '*' for any domain of any receiver
}

// In iFrame
window.onload = function() {
  function receiveMessage(e) {
    if (e.origin !== "http://parent.window.domain") return;
    alert(e.data);
  }
  window.addEventListener('message', receiveMessage);
}
</pre>
</div>
</div>

<div id="outline-container-org338301f" class="outline-4">
<h4 id="org338301f"><span class="section-number-4">8.27.2</span> Dynamic iframe height</h4>
<div class="outline-text-4" id="text-8-27-2">
<p>
This code requires the iframe domain is same origin.
</p>
<pre class="example">
&lt;iframe id="preview_iframe" style="width:100%"
        onload="resize_iframe(this)"
        srcdoc="&lt;?php echo str_replace('"', '&amp;quot;', $html);?&gt;"
&gt;
&lt;/iframe&gt;
&lt;script&gt;
function resize_iframe(iframe) {
  iframe.height= iframe.contentWindow.document.body.scrollHeight + 'px';
}
&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-orge075b71" class="outline-4">
<h4 id="orge075b71"><span class="section-number-4">8.27.3</span> Responsive iframe</h4>
<div class="outline-text-4" id="text-8-27-3">
<p>
Refer to <a href="#org3065488">bootstrap:responsive helpers</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org96f0866" class="outline-3">
<h3 id="org96f0866"><span class="section-number-3">8.28</span> setTimeout recall</h3>
<div class="outline-text-3" id="text-8-28">
<pre class="example">
function runTimeout() {
  setTimeout(function() {
    if (window.googletag &amp;&amp; googletag.apiReady) {
      // do something
    }
    else {
      //console.log('googletag is not ready');
      runTimeout();
    }
  }, 5000);
}
</pre>
</div>
</div>

<div id="outline-container-org235764c" class="outline-3">
<h3 id="org235764c"><span class="section-number-3">8.29</span> CSS Media Viewport Size <a id="org7b59005">js:viewport size</a></h3>
<div class="outline-text-3" id="text-8-29">
<p>
window.innerWidth is width including scrollbars
document.body.clientWidth is width excluding scrollbars
</p>

<p>
<code>var w = Math.max(window.innerWidth || 0, document.body.clientWidth)</code>
<code>var h = Math.max(window.innerHeight || 0, document.body.clientHeight)</code>
</p>
</div>
</div>

<div id="outline-container-org23ad331" class="outline-3">
<h3 id="org23ad331"><span class="section-number-3">8.30</span> Use Cases</h3>
<div class="outline-text-3" id="text-8-30">
</div>
<div id="outline-container-org1f6ee23" class="outline-4">
<h4 id="org1f6ee23"><span class="section-number-4">8.30.1</span> Click to anchor</h4>
<div class="outline-text-4" id="text-8-30-1">
<p>
Changes the hash in URL and then go to the element
</p>
<pre class="example">
&lt;div onclick="goToAnchor('gotoanchor-section-name')"&gt;
  something here
&lt;/div&gt;

&lt;div class="spacer" id="gotoanchor-section-name"&gt;&lt;/div&gt;

&lt;div&gt; Content I want to go to &lt;/div&gt;

&lt;script&gt;
  function goToAnchor(anchor) {
    var loc = document.location.toString().split('#')[0];
    document.location = loc + '#' + anchor;
    return false;
  }
&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-orgb425a15" class="outline-4">
<h4 id="orgb425a15"><span class="section-number-4">8.30.2</span> Get radio value, Event on radio buttons</h4>
<div class="outline-text-4" id="text-8-30-2">
<pre class="example">
&lt;input type="radio" name="genderS" value="1" checked&gt; Male
&lt;input type="radio" name="genderS" value="0"&gt; Female

function getRadioValue(name) {
  var radios = document.getElementsByName(name);
  if (!!radios &amp;&amp; radios.length &gt; 0) {
    for (var i = 0, length = radios.length; i &lt; length; i++) {
      if (radios[i].checked) {
        return radios[i].value; // only one radio can be logically checked, don't check the rest
      }
    }
  }
  return null;
}

getRadioValue('genderS');



</pre>
</div>
</div>

<div id="outline-container-org917ea53" class="outline-4">
<h4 id="org917ea53"><span class="section-number-4">8.30.3</span> Detect iOS version</h4>
<div class="outline-text-4" id="text-8-30-3">
<p>
<a href="https://gist.github.com/Craga89/2829457">https://gist.github.com/Craga89/2829457</a>
</p>

<pre class="example">
/*
 * Outputs a float representing the iOS version if user is using an iOS browser i.e. iPhone, iPad
 * Possible values include:
 *      3 - v3.0
 *      4.0 - v4.0
 *      4.14 - v4.1.4
 *      false - Not iOS
 */

var iOS = parseFloat(
        ('' + (/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent) || [0,''])[1])
        .replace('undefined', '3_2').replace('_', '.').replace('_', '')
) || false;
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0d4366d" class="outline-2">
<h2 id="org0d4366d"><span class="section-number-2">9</span> jQuery</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-orga8c7724" class="outline-3">
<h3 id="orga8c7724"><span class="section-number-3">9.1</span> Version, Closure, document ready</h3>
<div class="outline-text-3" id="text-9-1">
<pre class="example">
jQuery.fn.jquery
</pre>

<p>
Closure
</p>
<pre class="example">
(function($){
  // can do something like 
  $.fn.function_name = function(x){};
})(jQuery);
</pre>

<p>
Document ready shorthand
</p>

<pre class="example">
$(function(){

});
</pre>

<pre class="example">
&lt;script src="other_lib.js"&gt;&lt;/script&gt;
&lt;script src="jquery.js"&gt;&lt;/script&gt;
&lt;script&gt;
$.noConflict();
jQuery( document ).ready(function( $ ) {
  // Code that uses jQuery's $ can follow here.
});
// Code that uses other library's $ can follow here.
&lt;/script&gt;

jQuery.noConflict();
(function( $ ) {
  $(function() {
    // More code using $ as alias to jQuery
  });
})(jQuery);

// Other code using $ as an alias to the other library
</pre>
</div>

<div id="outline-container-orgbcaacc3" class="outline-4">
<h4 id="orgbcaacc3"><span class="section-number-4">9.1.1</span> jQuery.noConflict</h4>
<div class="outline-text-4" id="text-9-1-1">
<p>
Return control of $ back to the other library with a call to $.noConflict(). Old references of $ are saved during jQuery initialization; noConflict() simply restores them.
</p>

<pre class="example">
var j = jQuery.noConflict(); // different alias

// Do something with jQuery
j( "div p" ).hide();

// Do something with another library's $()
$( "content" ).style.display = "none";
</pre>

<p>
Completely move jQuery to a new namespace in another object.
</p>
<pre class="example">
var dom = {};
dom.query = jQuery.noConflict( true );
// If for some reason two versions of jQuery are loaded (which is not recommended), calling $.noConflict( true ) from the second version will return the globally scoped jQuery variables to those of the first version.

// Do something with the new jQuery
dom.query( "div p" ).hide();

// Do something with another library's $()
$( "content" ).style.display = "none";

// Do something with another version of jQuery
jQuery( "div &gt; p" ).hide();
</pre>
</div>
</div>
</div>

<div id="outline-container-org5bf3a78" class="outline-3">
<h3 id="org5bf3a78"><span class="section-number-3">9.2</span> Ajax</h3>
<div class="outline-text-3" id="text-9-2">
<p>
$.get(url[, data] [, success], [, dataType] )
$.post(url[, data] [, success], [, dataType] )
</p>
<pre class="example">
$.ajax({
 method: 'POST', // Default: GET
// Prior to 1.9.0, use type instead of method
 url: "some.php", // Default current page
 data: { name: "a", location: "Boston" } // Data send to server. Converted as URL parameters
// if data is not key/value pairs, change processData to false
 processData: true, 
// If data is not key/value pairs (object), say it's a DOMDocument, change it to false

 contentType: 'applicaton/x-www-form-urlencoded;charset=UTF-8', // Default. MIME type

 dataType: "json", // Default is not setting anything. MIME type of response
// &gt; v1.5, this option can convert response to the MIME types you want
// "json xml" :: first it will try to convert to json. if failed, convert ot xml
// "script" :: the response is javascript, and it will be run afer it's received.

// cross domain should be automatically handled
// crossDomain: default false for same-domain requests, true for cross-domain requests

 context: document.body, // provide context for callbacks. If not set, this referrence
// in callbacks is the Ajax request settings

 cache: true, // You can only change cache for HEAD and GET requests.

 headers: {}, // Default. Add (or add to overwrite) request header

// Callback options
 beforeSend: function(jqXHR, settings) {
  // Modify jqXHR object before it is sent.
  // e.g. request header
  // For receiving binary string (image or any binary data)
  // jqXHR.overrideMimeType("text/plain; charset=x-user-defined");
 },
 error: function(jqXHR, textStatus, errorThrown) {
  // if request fails.
 },
 dataFilter: function( data, type) {
  // raw response data
  // dataType option
  // You should sanitize the data here so to match the dataType option
 },
 success: function( data, textStatus, jqXHR ) {
 }, 
 complete: function( jqXHR, textStatus) {}

})
/* Promise callbacks: .done, .fail, .always. In those callbacks, 
`this` reference is the `context` in the request. If `context` was not set, `this` 
will be the Ajax setting.
You can add multiple promise callbacks.
*/
.done(function(data, textStatus, jqXHRmsg) {
// .success() will be deprecated in v3.0


})
.fail(function(jqXHR, textStatus, errorThrown) {
// .error() will be deprecated in v3.0
})
.always(function(data|jqXHR, textStatus, jqXHR|errorThrown) {
// .complete() will be dprecated in v3.0

});
</pre>
</div>
</div>

<div id="outline-container-orgc5d5330" class="outline-3">
<h3 id="orgc5d5330"><span class="section-number-3">9.3</span> <a id="org885f452">jQuery Selectors</a>, Loop through found elements</h3>
<div class="outline-text-3" id="text-9-3">
<p>
You can use all <a href="#orgf67d3bb">CSS Selectors</a>
</p>

<p>
<a href="http://api.jquery.com/category/selectors/">http://api.jquery.com/category/selectors/</a>
</p>

<pre class="example">
$('li').each(function(i) {
 // i = 0, 1, etc.
 $(this).addClass("foo");
});
</pre>

<p>
First matched element
</p>
<pre class="example">
var iframeId = $("#div-iframe").find('iframe').get(0).id;
</pre>
</div>
</div>

<div id="outline-container-orgb79d036" class="outline-3">
<h3 id="orgb79d036"><span class="section-number-3">9.4</span> iFrame refer to parent</h3>
<div class="outline-text-3" id="text-9-4">
<pre class="example">
var parentVideoDiv = parent.jQuery('#videoplayer').parent('.the-content');
</pre>
</div>
</div>

<div id="outline-container-org6e97d2f" class="outline-3">
<h3 id="org6e97d2f"><span class="section-number-3">9.5</span> Find elements</h3>
<div class="outline-text-3" id="text-9-5">
<pre class="example">
var $querySelection = ...;
if ($querySelect.length &gt; 0) {
  // not empty
  // if ($querySelect.length) {}
}
</pre>
</div>

<div id="outline-container-org7d7650b" class="outline-4">
<h4 id="org7d7650b"><span class="section-number-4">9.5.1</span> Get parent element, sibling, closet</h4>
<div class="outline-text-4" id="text-9-5-1">
<pre class="example">
var parentDiv = jQuery('#videoplayer').parent('.content');
var siblingDiv = parentDiv.prev(); // preceding sibling
var siblingDiv = parentDiv.next(); // next sibling
</pre>

<p>
.closest starts from the current element, travels up the DOM tree until it finds a match for the supplied selector, returns zero or one element.
</p>
<pre class="example">
$( "li.item-a" )
  .closest( "ul" )
  .css( "background-color", "red" );
</pre>
</div>
</div>

<div id="outline-container-org3aa9175" class="outline-4">
<h4 id="org3aa9175"><span class="section-number-4">9.5.2</span> Find inside an element, .find, .first, .last</h4>
<div class="outline-text-4" id="text-9-5-2">
<pre class="example">
siblingDiv.find(".panel.panel-default");

// by data attribute
var $all = $('#id').find('[data-name="' + js_var + '"]');
$first = $all.first(); 
</pre>
</div>
</div>
</div>

<div id="outline-container-org57121b8" class="outline-3">
<h3 id="org57121b8"><span class="section-number-3">9.6</span> Pass $(this) to javascript function</h3>
<div class="outline-text-3" id="text-9-6">
<p>
$(this) is jQuery object, but this is a normal this
</p>
<pre class="example">
function doFunc(obj) {
  obj.className = 'hello'; // className is a normal javascript function
}
$('li').each(function() {
  doFunc(this);
});

// or
function handler(event) {
  var target = $(event.target);
  if (target.is("li")) {
    target.children().toggle();
  }
}
$("ul").click(handler).find("ul").hide();
</pre>
</div>
</div>

<div id="outline-container-org5c83edb" class="outline-3">
<h3 id="org5c83edb"><span class="section-number-3">9.7</span> General click to element</h3>
<div class="outline-text-3" id="text-9-7">
<p>
Any elements with attribute data-target="goto1" with id #goto1
</p>
<pre class="example">
LiliJs.clickToGo = function(event) {
    var $target = $(event.target);
    var iter = 0;
    var itermax = 10;
    var goto = '';
    while (iter &lt; itermax ) {
      if ($target.data('target')) {
        goto =$target.data('target');
        break;
      }
      else {
        $target = $target.parent();
        iter++;
        console.log('+1');
      }
    }
    if (goto) {
      $("#"+goto).get(0).scrollIntoView();
    }
}

$(function() {
  $('.click-1, .click-2').click(LiliJs.clickToGo);
});
</pre>
</div>
</div>

<div id="outline-container-org7eeb401" class="outline-3">
<h3 id="org7eeb401"><span class="section-number-3">9.8</span> Pointer Events</h3>
<div class="outline-text-3" id="text-9-8">
<p>
<a href="https://mobiforge.com/design-development/html5-pointer-events-api-combining-touch-mouse-and-pen">https://mobiforge.com/design-development/html5-pointer-events-api-combining-touch-mouse-and-pen</a>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">mousedown</td>
<td class="org-left">touchstart</td>
<td class="org-left">pointerdown</td>
</tr>

<tr>
<td class="org-left">mouseenter</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">pointerenter</td>
</tr>

<tr>
<td class="org-left">mouseleave</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">pointerleave</td>
</tr>

<tr>
<td class="org-left">mousemove</td>
<td class="org-left">touchmove</td>
<td class="org-left">pointermove</td>
</tr>

<tr>
<td class="org-left">mouseout</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">pointerout</td>
</tr>

<tr>
<td class="org-left">mouseover</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">pointerover</td>
</tr>

<tr>
<td class="org-left">mouseup</td>
<td class="org-left">touchend</td>
<td class="org-left">pointerup</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
pointerover :: pointer moves over an element (enters its hit test boundaries)
pointerenter :: pointer moves over an element or one of its descendants. Differs to pointerover in that it doesn’t bubble
</p>

<p>
pointerdown :: active buttons state is entered: for touch and stylus, this is when contact is made with screen; for mouse, when a button is pressed
pointermove :: pointer changes coordinates, or when pressure, tilt, or button changes fire no other event
pointerup :: active buttons state is left: i.e. stylus or finger leaves the screen, or mouse button released
</p>

<p>
pointercancel :: pointer is determined to have ended, e.g. in case of orientation change, accidental input e.g. palm rejection, or too many pointers
</p>

<p>
pointerout :: pointer moves out of an element (leaves its hit test boundaries). Also fired after pointerup event for no-hover supported devices, and after pointercancel event
pointerleave :: pointer moves out of an element and its descendants
</p>

<p>
gotpointercapture :: when an element becomes target of pointer
lostpointercapture :: when element loses pointer capture
</p>

<pre class="example">
$('li').on( events [, selector ] [, data ], handler )
</pre>

<p>
There's no .on('hover'). Hover is equal to .on('mouseenter mouseleave')
</p>

<p>
CSS :hover vs :focus
Hover is 'true' when the mouse pointer is over an element. Focus is true if the cursor is in that element. It's possible for hover to be false and focus true (e.g click in a text field then move the mouse away)
</p>
</div>
</div>

<div id="outline-container-orge5928d3" class="outline-3">
<h3 id="orge5928d3"><span class="section-number-3">9.9</span> Replace class</h3>
<div class="outline-text-3" id="text-9-9">
<pre class="example">
parentDiv.removeClass('col-md-9').addClass('col-md-12');
</pre>

<p>
Or remove a class if it exists or add a class if it doesn't
</p>

<pre class="example">
$('#id').toggleClass('col-md-9 col-md-12');
</pre>

<p>
Remove class with wild card
</p>
<pre class="example">
$("#hello").removeClass (function (index, className) {
    return (className.match(/(^|\s)color-\S+/g) || []).join(' ');
});
</pre>
</div>
</div>

<div id="outline-container-orga01afb0" class="outline-3">
<h3 id="orga01afb0"><span class="section-number-3">9.10</span> Move element</h3>
<div class="outline-text-3" id="text-9-10">
<pre class="example">
/* Before
.siblingDiv
.parentDiv
*/

siblingDiv.insertAfter(parentDiv);

/* After
.parentDiv
.siblingDiv
*/

</pre>
</div>
</div>

<div id="outline-container-org656add6" class="outline-3">
<h3 id="org656add6"><span class="section-number-3">9.11</span> Add Style</h3>
<div class="outline-text-3" id="text-9-11">
<pre class="example">
var selector = jQuery('#id');
selector.attr('style', function(i,s) { 
  var a = ' visible: visible !important;
  if (typeof s !== 'undefined') {
    return s + a;
  }
  else {
    return a;
  }
});
</pre>
</div>
</div>

<div id="outline-container-org227d442" class="outline-3">
<h3 id="org227d442"><span class="section-number-3">9.12</span> Form</h3>
<div class="outline-text-3" id="text-9-12">
</div>
<div id="outline-container-orgf25191e" class="outline-4">
<h4 id="orgf25191e"><span class="section-number-4">9.12.1</span> serialize</h4>
<div class="outline-text-4" id="text-9-12-1">
<p>
Checkboxes and radio buttons are included only if they're checked.
All seriailized form field elements must have name attribute.
</p>

<pre class="example">
$("#form_id").on("submit", function(e) {
 event.preventDefault();
 console.log($(this).serialize());
});
</pre>
</div>
</div>

<div id="outline-container-org856a14b" class="outline-4">
<h4 id="org856a14b"><span class="section-number-4">9.12.2</span> Disabled Field</h4>
<div class="outline-text-4" id="text-9-12-2">
<p>
Disabled fields are not editable, selectable, copyable and they are not submitted.
In order to select and copy value of a disabled field, you need to enable it when mouseover and disable it
when mouseout.
</p>

<p>
Can't register events directly on disabled fields. Events can be registered on its parent
</p>

<pre class="example">
$('.parent_container')
  .mouseover(function() { $(this).find('textarea').prop('disabled',false)})
  .mouseout(function() { $(this).find('textarea').prop('disabled',true)});
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc2ec904" class="outline-3">
<h3 id="orgc2ec904"><span class="section-number-3">9.13</span> Animate</h3>
<div class="outline-text-3" id="text-9-13">
</div>
<div id="outline-container-org52485d5" class="outline-4">
<h4 id="org52485d5"><span class="section-number-4">9.13.1</span> Scroll</h4>
<div class="outline-text-4" id="text-9-13-1">
<pre class="example">
var offset = $("[ng-controller=aController]").offset();

offset.top -= 100; // offset.left is also available

$("html,body").animate({ 
 scrollTop: offset.top,
 // scrollLeft: offset.left // if it doesn't change, it won't have to be set
});
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf3a1c3b" class="outline-3">
<h3 id="orgf3a1c3b"><span class="section-number-3">9.14</span> Viewport Change Event</h3>
<div class="outline-text-3" id="text-9-14">
<p>
<a href="#org7b59005">js:viewport size</a>
\((window).resize(function() {
  consoel.log(\)(window).width()); // integer without unit
});
</p>
</div>
</div>

<div id="outline-container-orga0a0cda" class="outline-3">
<h3 id="orga0a0cda"><span class="section-number-3">9.15</span> jQuery UI: Dialog <a id="orgf498fd3">jqueryui:dialog</a></h3>
<div class="outline-text-3" id="text-9-15">
<pre class="example">
&lt;div id="interstitial"&gt;
 &lt;!-- script tag inside the container will be run every time the dialog is opend! 
      Consider remove script tag before .dialog and reattach javascript later.
      Content inside the container will be removed and then added to div.ui-dialog at the bottom of DOM.
 --&gt;
&lt;/div&gt;
</pre>

<pre class="example">
jQuery(function(){
  jQuery("#interstitial").dialog({
    width: 'auto', /* no scrollbar, auto fit content */
    height:'auto',
    resizable: false,
    draggable: false, /* movable */
    closeOnEscape: true,

    /* Add extra buttons below the content
    buttons: [{
      text: 'ok',
      icons: {primary: "ui-icon-closethick"},
      click: function() {jQuery(this).dialog("close");}
    }],
    */

    modal: true, /* add background to isolate the modal box */
    create: function (event, ui) {
      jQuery("#ui-dialog-title-dialog").hide();
      /* custom background/overlay */
      jQuery(".ui-widget-content").css({"background-color":"transparent","background":"transparent","border":"none"});
      /* title bar is transparent */
      jQuery(".ui-dialog-titlebar").css({"background-color":"transparent","background":"transparent","border":"none"});

      jQuery(".ui-dialog-titlebar").removeClass('ui-widget-header');
      // Change the default title &amp; close button to a custom link
      //jQuery(".ui-dialog-titlebar").html('&lt;a href="#" role="button"&gt;&lt;span class="myCloseIcon" style="color:white;"&gt;X close&lt;/span&gt;&lt;/a&gt;')

      // You can still load/modify the content here and the width/height will still be auto fit
    },
    open: function() {
      /* custom background */
      jQuery('.ui-widget-overlay').addClass('custom-overlay');

      /* Customize the default close button: only X displays */
      jQuery(this).closest(".ui-dialog")
        .find(".ui-dialog-titlebar-close")
        .removeClass("ui-dialog-titlebar-close")
        .html("&lt;span class='ui-button-icon-primary ui-icon ui-icon-closethick'&gt;&lt;/span&gt;");
      jQuery(".ui-dialog-titlebar button").css({"border":"none"});

      /* Close dialog when click outside */
      jQuery('.ui-widget-overlay').bind('click',function(){
        jQuery("#interstitial").dialog('close');
      })
    },
    close: function() {
      /* custom background/overlay */
      /*
      * .ui-widget-overlay.custom-overlay
       {
       background-color: black;
       background-image: none;
       opacity: 0.9;
       }
      * */
      jQuery('.ui-widget-overlay').removeClass('custom-overlay');
    }
  });

  /* bind events for custom buttons created
  jQuery("span.myCloseIcon").click(function() {
    jQuery("#interstitial").dialog( "close" );
  });
  */
});
</pre>
</div>
</div>

<div id="outline-container-orgef25c3c" class="outline-3">
<h3 id="orgef25c3c"><span class="section-number-3">9.16</span> jQuery UI: Sortable</h3>
<div class="outline-text-3" id="text-9-16">
<pre class="example">
$(function() {
    $("#slideshow-pictures").sortable({
      items:'.dz-preview',
      cursor: 'move',
      opacity: 0.5,
      containment: '#slideshow-pictures',
      distance: 20,
      tolerance: 'pointer'
    });
  });
</pre>
</div>
</div>
</div>

<div id="outline-container-org9fea8e1" class="outline-2">
<h2 id="org9fea8e1"><span class="section-number-2">10</span> JavaScript projects</h2>
<div class="outline-text-2" id="text-10">
<p>
<a href="https://stats.js.org/">https://stats.js.org/</a>
</p>
</div>

<div id="outline-container-orgd61d0dc" class="outline-3">
<h3 id="orgd61d0dc"><span class="section-number-3">10.1</span> TweenLite, TweenMax, Greensock</h3>
<div class="outline-text-3" id="text-10-1">
<p>
TweenMax has other common plugins included e.g. CSSPlugin where you can ease CSS property changes.
</p>
<dl class="org-dl">
<dt>CSSPlugin</dt><dd>change individual DOM element's style attribute</dd>
<dt>(no term)</dt><dd>RoundPropsPlugin</dd>
<dt>(no term)</dt><dd>BezierPlugin</dd>
<dt>(no term)</dt><dd>AttrPlugin</dd>
<dt>(no term)</dt><dd>DirectionalRotationPlugin</dd>
<dt>(no term)</dt><dd>EasePack</dd>
<dt>(no term)</dt><dd>TimelineLite</dd>
<dt>(no term)</dt><dd>TimelineMax</dd>
</dl>

<p>
Extra plugins which are separate js files loaded after TweenMax <a href="https://greensock.com/tweenmax">https://greensock.com/tweenmax</a>:
</p>
<dl class="org-dl">
<dt><a href="https://greensock.com/docs/Plugins/CSSRulePlugin">CSSRulePlugin</a></dt><dd>change style sheet rules e.g. for class .myClass and other pseudo elements :after :before which are impossible to reference directly in JavaScript</dd>
<dt>(no term)</dt><dd>modifiers</dd>
<dt>(no term)</dt><dd>text</dd>
<dt>(no term)</dt><dd>scrollTo</dd>
<dt>(no term)</dt><dd>pixi</dd>
<dt>(no term)</dt><dd>easel</dd>

<dt><a href="https://greensock.com/draggable">Draggable</a></dt><dd>Spin, Scrll</dd>
<dt>(no term)</dt><dd>jquery.gsap.js</dd>
</dl>

<p>
Using TweenLite only and you'll have to manually include these plugins.
</p>

<p>
<a href="https://github.com/greensock/GreenSock-JS/releases">All versions on GitHub</a>
</p>
</div>

<div id="outline-container-org5d9ce82" class="outline-4">
<h4 id="org5d9ce82"><span class="section-number-4">10.1.1</span> TweenLite.to() TweenLite.from() TweenLite.fromTo()</h4>
<div class="outline-text-4" id="text-10-1-1">
<p>
<a href="https://greensock.com/docs/TweenLite/static.to">https://greensock.com/docs/TweenLite/static.to</a>
</p>

<pre class="example">
TweenLite.to( [target object], [duration in seconds], [destination values] );

TweenLite.to(active_slide, 0.5, {marginLeft:'-50%',ease:Power3.easeOut});

TweenLite.to("#myID", 1, {left:"100px"});
// TweenLite will use selector engine e.g. jQuery if present or document.querySelectorAll() or lastly document.getElementById()

TweenLite.to(".myClass", 2, {boxShadow:"0px 0px 20px red", color:"#FC0"});

// multiple objects
TweenLite.to([obj1, obj2, obj3], 1, {opacity:0.5, rotation:45});
</pre>

<p>
TweenLite.from() define the starting values instead of the ending values.
TweenLite.fromTo() :: TweenLite.fromTo( target:Object, duration:Number, fromVars:Object, toVars:Object )
</p>

<pre class="example">
var tween = new TweenLite(element, 2, {width:200, height:150});
// or
var tween = TweenLite.to(element, 2, {width:200, height:150});
</pre>
</div>

<div id="outline-container-org8a71c17" class="outline-5">
<h5 id="org8a71c17"><span class="section-number-5">10.1.1.1</span> dest:css, relative value</h5>
<div class="outline-text-5" id="text-10-1-1-1">
<p>
It's important that you remove all dashes (-) from the css property names and use camelCase.
</p>
<pre class="example">
TweenLite.to(logo, 2, {left:"542px",
                       backgroundColor:"black",
                       borderBottomColor:"#90e500",
                       color:"white"});
</pre>

<p>
Adding a += or -= prefix tells GSAP to treat a value as relative to whatever it is when the tween renders the first time. For example, if "left" is currently 50px and you tween to "+=100px", it will end up at 150px. Don't forget to put quotes around the value.
</p>

<pre class="example">
TweenLite.to(logo, 0.5, {left:"+=100px"});
</pre>
</div>
</div>

<div id="outline-container-orga14d5fe" class="outline-5">
<h5 id="orga14d5fe"><span class="section-number-5">10.1.1.2</span> dest:ease, easeIn (begin), easeOut (the end), easeInOut (both)</h5>
<div class="outline-text-5" id="text-10-1-1-2">
<p>
<a href="https://greensock.com/docs/Easing">https://greensock.com/docs/Easing</a>
</p>

<p>
Default is Quad.easeOut
</p>

<ul class="org-ul">
<li>Linear</li>
<li id="Power0 to Power4">0 is linear</li>
<li>Quad</li>
<li>Cubic</li>
<li>Quart</li>
<li>Quint</li>
<li>Strong</li>
</ul>

<p>
Extras
</p>
<ul class="org-ul">
<li>Elastic Back Bounce SlowMo SteppedEase Rough Circ Expo Sine</li>
</ul>

<p>
Variants
</p>
<ul class="org-ul">
<li>.easeIn .easeOut .easeInOut .easeNone</li>
</ul>

<p>
For linear animation, use Linear.easeNone
</p>

<p>
Sample
</p>
<pre class="example">
TweenLite.to(logo, 3, {left:"440px", ease:Bounce.easeOut});

ease:Bounce.easeOut
ease:"Strong.easeOut"
ease:"easeOutStrong"
</pre>
</div>
</div>

<div id="outline-container-org9c0364c" class="outline-5">
<h5 id="org9c0364c"><span class="section-number-5">10.1.1.3</span> dest:delay in seconds, dest:paused bool, dest:immediateRender</h5>
<div class="outline-text-5" id="text-10-1-1-3">
<dl class="org-dl">
<dt>paused</dt><dd>If true, the animation will pause immediately upon creation</dd>
<dt>immediateRender</dt><dd></dd>
</dl>
</div>
</div>

<div id="outline-container-orgfcb31d9" class="outline-5">
<h5 id="orgfcb31d9"><span class="section-number-5">10.1.1.4</span> dest:onComplete onCompleteParams</h5>
<div class="outline-text-5" id="text-10-1-1-4">
<pre class="example">
TweenLite.to(element, 1, {left:100, onComplete:myFunction});
TweenLite.to(element, 1, {left:100, onComplete:myFunction, onCompleteParams:[element, "param2"]});

// pass the tween instance use {self}
TweenLite.to(element, 1, {left:100, onComplete:myFunction, onCompleteParams:["{self}", "param2"]});
</pre>
</div>
</div>
</div>

<div id="outline-container-org01dc1ab" class="outline-4">
<h4 id="org01dc1ab"><span class="section-number-4">10.1.2</span> Use Case</h4>
<div class="outline-text-4" id="text-10-1-2">
</div>
<div id="outline-container-org532ebec" class="outline-5">
<h5 id="org532ebec"><span class="section-number-5">10.1.2.1</span> Slideshow</h5>
<div class="outline-text-5" id="text-10-1-2-1">
<pre class="example">
&lt;section id="slider-wrap" class="home-slide inner"&gt;

  &lt;div id="slides-frame"&gt;

    &lt;div id="active-slide" class="slide-img"
         style="background:transparent url('1.jpg') no-repeat center 15%;background-size:cover;-webkit-transform: translateZ(0);"&gt;
      &lt;div class="background-screen"&gt;
        &lt;div class="page-wrap"&gt;
          &lt;div class="slide-headline"&gt;
            &lt;h2&gt;Slide #1 Title&lt;/h2&gt;
            &lt;p class="quote"&gt;Slide #1 Paragraph&lt;/p&gt;
            &lt;p class="quote-name"&gt;Slide #1 Paragraph&lt;/p&gt;
            &lt;a href="#"&gt;Slide #1 Button&lt;/a&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div id="next-slide" class="slide-img"
         style="background:transparent url('2.jpg') no-repeat center 25%;background-size:cover;-webkit-transform: translateZ(0);"&gt;
      &lt;div class="background-screen"&gt;
        &lt;div class="page-wrap"&gt;
          &lt;div class="slide-headline"&gt;
            &lt;h2&gt;Slide #2 Title&lt;/h2&gt;
            &lt;p class="quote"&gt;Slide #2 Paragraph&lt;/p&gt;
            &lt;p class="quote-name"&gt;Slide #2 Paragraph&lt;/p&gt;
            &lt;a href="#"&gt;Slide #2 Button&lt;/a&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt; &lt;!-- #next-slide --&gt;

  &lt;/div&gt; &lt;!-- #slides-frame --&gt;
&lt;/section&gt;

&lt;!-- @@ Slideshow Data: --&gt;
&lt;div id="slideshow-data" style="display:none!important;"&gt;
  &lt;div class="slideshow-data-item"
       style="background:transparent url('1.jpg') no-repeat center 15%;background-size:cover;-webkit-transform: translateZ(0);"&gt;
    &lt;div class="background-screen"&gt;
      &lt;div class="page-wrap"&gt;
        &lt;div class="slide-headline"&gt;
          &lt;h2&gt;Slide #1 Title&lt;/h2&gt;
          &lt;p class="quote"&gt;Slide #1 Paragraph&lt;/p&gt;
          &lt;p class="quote-name"&gt;Slide #1 Paragraph&lt;/p&gt;
          &lt;a href="#"&gt;Slide #1 Button&lt;/a&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;div class="slideshow-data-item"
       style="background:transparent url('2.jpg') no-repeat center 25%;background-size:cover;-webkit-transform: translateZ(0);"&gt;
    &lt;div class="background-screen"&gt;
      &lt;div class="page-wrap"&gt;
        &lt;div class="slide-headline"&gt;
          &lt;h2&gt;Slide #2 Title&lt;/h2&gt;
          &lt;p class="quote"&gt;Slide #2 Paragraph&lt;/p&gt;
          &lt;p class="quote-name"&gt;Slide #2 Paragraph&lt;/p&gt;
          &lt;a href="#"&gt;Slide #2 Button&lt;/a&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;div class="slideshow-data-item"
       style="background:transparent url('3.jpg') no-repeat center left;background-size:cover;-webkit-transform: translateZ(0);"&gt;
    &lt;div class="background-screen"&gt;
      &lt;div class="page-wrap"&gt;
        &lt;div class="slide-headline"&gt;
          &lt;h2&gt;Slide #3 Title&lt;/h2&gt;
          &lt;p class="quote"&gt;Slide #3 Paragraph&lt;/p&gt;
          &lt;p class="quote-name"&gt;Slide #3 Paragraph&lt;/p&gt;
          &lt;a href="#"&gt;Slide #3 Button&lt;/a&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

&lt;/div&gt; &lt;!-- #slideshow-data --&gt;
</pre>

<pre class="example">
.page {
  max-width:1200px;
  width:90%;
  margin:0 auto;
}
.home-slide.inner {
  height: 550px; /* media query change height */
  overflow: hidden;
}
#slides-frame {
  width:200%!important;
  position:relative;
  height:550px;
}
#active-slide, #next-slide {
  position:relative;
  display:inline-block;
  width:50%;
  height:100%;
  vertical-align:top;
}
#slides-frame .background-screen {
  position:relative;
  height:100%;
  width:100%;
  overflow-y:hidden;
  background:rgba(0,0,0,0.35); /* darken bg image */
}
.slide-wrap {
  /* Text content width */
  width:1200px; /* media query change width */
  /* width:100%; */
  height:100%;
  overflow:visible;
  margin:0 auto;
}
.slide-headline {
  position:absolute;
  left:0;
  bottom:0;
  margin-bottom:155px; /* media query change margin-bottom */
}
</pre>

<pre class="example">
window.onload = init();
function init() {
  slideshow_checker();
}
function slideshow_checker() {
  var slideshow_data = document.getElementById('slider-wrap');
  if (slideshow_data != null) {
    slideshow(0, 'time', 7000);
  }
}

var timer;
function slideshow(id, type, time_length) {

  var active_slide = document.getElementById('active-slide'),
    active_slide_style = active_slide.getAttribute('style');
  var next_slide = document.getElementById('next-slide');


  /* -- COUNT SLIDE NUM -- */
  var slideshow_data = document.getElementById('slideshow-data');
  var slides = slideshow_data.getElementsByClassName('slideshow-data-item');
  var slide_count = slides.length;

  var nxt_id, nxt_nxt_id, prev_id;
  nxt_id = (id + 1);
  prev_id = (id - 1);

  if (nxt_id == slide_count) {
    nxt_id = 0;
  }
  if ((id == 0)) {
    prev_id = (slide_count - 1);
  }

  //  arr_left.setAttribute('onclick','javascript:get_slide('+prev_id+')');
  //    arr_right.setAttribute('onclick','javascript:get_slide('+nxt_id+')');

  if (type == 'click') {
    var next_slide_data = slides[id].getAttribute('style');
    var next_slide_html = slides[id].innerHTML;
    next_slide.innerHTML = next_slide_html;
    next_slide.setAttribute('style', next_slide_data);

  }
  else {
    var next_slide_data = slides[nxt_id].getAttribute('style');
    var next_slide_html = slides[nxt_id].innerHTML;
    next_slide.innerHTML = next_slide_html;
    next_slide.setAttribute('style', next_slide_data);
  }

  timer = setTimeout(function () {
    TweenLite.to(active_slide, 0.5, {marginLeft: '-50%', ease: Power3.easeOut});
    setTimeout(function () {

      active_slide.setAttribute('style', next_slide.getAttribute('style'));

      TweenLite.to(active_slide, 0, {marginLeft: '0%'});

      active_slide.innerHTML = next_slide_html;

      /* -- RUN LOOP() --- */
      setTimeout(function () {
        if (type == 'time') {
          slideshow(nxt_id, 'time', 7000);
        }
        else {
          slideshow(nxt_id, 'time', time_length);
        }
      }, 0);

    }, 1000);
  }, time_length);

}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org5bdafef" class="outline-3">
<h3 id="org5bdafef"><span class="section-number-3">10.2</span> Select2</h3>
<div class="outline-text-3" id="text-10-2">
<p>
<a href="https://select2.org/">https://select2.org/</a> depends on jQuery
</p>
</div>

<div id="outline-container-org415562e" class="outline-4">
<h4 id="org415562e"><span class="section-number-4">10.2.1</span> Basic</h4>
<div class="outline-text-4" id="text-10-2-1">
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">script</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"</span>&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">link</span> <span style="color: #dbdb95;">href</span>=<span style="color: #e67128;">"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css"</span> <span style="color: #dbdb95;">rel</span>=<span style="color: #e67128;">"stylesheet"</span> /&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">script</span> <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"</span>&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">select</span> <span style="color: #dbdb95;">class</span>=<span style="color: #e67128;">"js-example-basic-single"</span> <span style="color: #dbdb95;">name</span>=<span style="color: #e67128;">"state"</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">option</span> <span style="color: #dbdb95;">value</span>=<span style="color: #e67128;">"AL"</span>&gt;Alabama&lt;/<span style="color: #00ede1; font-weight: bold;">option</span>&gt;
    ...
  &lt;<span style="color: #00ede1; font-weight: bold;">option</span> <span style="color: #dbdb95;">value</span>=<span style="color: #e67128;">"WY"</span>&gt;Wyoming&lt;/<span style="color: #00ede1; font-weight: bold;">option</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">select</span>&gt;

&lt;<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
$(document).ready(function() {
    $(<span style="color: #e67128;">".js-example-basic-single"</span>).select2();
});
&lt;/<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb69e997" class="outline-4">
<h4 id="orgb69e997"><span class="section-number-4">10.2.2</span> Internal Option data, &lt;optgroup&gt;</h4>
<div class="outline-text-4" id="text-10-2-2">
<p>
Select2 converts each &lt;option&gt; in this JSON
</p>

<div class="org-src-container">
<pre class="src src-json">{
  <span style="color: #ffad29; font-weight: bold;">"id"</span>: <span style="color: #e67128;">"value attribute"</span> || <span style="color: #e67128;">"option text"</span>,
  <span style="color: #ffad29; font-weight: bold;">"text"</span>: <span style="color: #e67128;">"label attribute"</span> || <span style="color: #e67128;">"option text"</span>,
  <span style="color: #ffad29; font-weight: bold;">"element"</span>: HTMLOptionElement
}

//<span style="color: #e67128;">"&lt;optgroup&gt;"</span>

{
  <span style="color: #ffad29; font-weight: bold;">"text"</span>: <span style="color: #e67128;">"label attribute"</span>,
  <span style="color: #ffad29; font-weight: bold;">"children"</span>: [ option data object, ... ],
  <span style="color: #ffad29; font-weight: bold;">"element"</span>: HTMLOptGroupElement
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">select</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">optgroup</span> <span style="color: #dbdb95;">label</span>=<span style="color: #e67128;">"Group Name"</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">option</span>&gt;Nested option&lt;/<span style="color: #00ede1; font-weight: bold;">option</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">optgroup</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">select</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orga887db2" class="outline-4">
<h4 id="orga887db2"><span class="section-number-4">10.2.3</span> config:ajax</h4>
<div class="outline-text-4" id="text-10-2-3">
<p>
Supply JSON to Select2
</p>
<pre class="example">
{
  "results": [
    {
      "id": 1,
      "text": "Option 1"
    },
    {
      "id": 2,
      "text": "Option 2",
      "selected": true
    },
    {
      "id": 3,
      "text": "Option 3",
      "disabled": true
    }
  ]
}
</pre>

<p>
ajax is triggered every time the user types in the search box.
</p>

<p>
By default, these parameters are sent
term :: search term
q :: same as term
_type :: a request type
page ::
</p>

<p>
e.g. <a href="https://api.github.com/search/repositories?term=sel&amp;_type=query&amp;q=sel">https://api.github.com/search/repositories?term=sel&amp;_type=query&amp;q=sel</a>
</p>

<pre class="example">
$('#mySelect2').select2({
  ajax: {
    url: 'https://api.github.com/orgs/select2/repos',
    data: function (params) {
      var query = {
        search: params.term,
        type: 'public'
      }

      // Query parameters will be ?search=[term]&amp;type=public
      return query;
    }
  }
});
</pre>

<pre class="example">
$('#mySelect2').select2({
  ajax: {
    url: '/example/api',
    processResults: function (data) {
      // Tranforms the top-level key of the response object from 'items' to 'results'
      return {
        results: data.items
      };
    }
  }
});
</pre>

<p>
Pagination
</p>
<pre class="example">
$('#mySelect2').select2({
  ajax: {
    url: 'https://api.github.com/search/repositories',
    data: function (params) {
      var query = {
        search: params.term,
        page: params.page || 1
      }

      // Query parameters will be ?search=[term]&amp;page=[page]
      return query;
    }
  }
});
</pre>

<p>
If the response has pagination.more prop
</p>
<pre class="example">
{
  "results": [
    {
      "id": 1,
      "text": "Option 1"
    },
    {
      "id": 2,
      "text": "Option 2"
    }
  ],
  "pagination": {
    "more": true
  }
}
</pre>

<p>
If not, then do it manually. response provides count_filtered that shows the total number.
</p>
<pre class="example">
processResults: function (data, params) {
    params.page = params.page || 1;

    return {
        results: data.results,
        pagination: {
            more: (params.page * 10) &lt; data.count_filtered
        }
    };
}
</pre>
</div>
</div>

<div id="outline-container-org7f26cb3" class="outline-4">
<h4 id="org7f26cb3"><span class="section-number-4">10.2.4</span> config:data</h4>
<div class="outline-text-4" id="text-10-2-4">
<p>
Load local Javascript array to Select2
</p>
<pre class="example">
var data = [
    {
        id: 0,
        text: 'enhancement'
    },
    {
        id: 1,
        text: 'bug'
    },
    {
        id: 2,
        text: 'duplicate'
    },
    {
        id: 3,
        text: 'invalid'
    },
    {
        id: 4,
        text: 'wontfix'
    }
];

$(".js-example-data-array").select2({
  data: data
})

$(".js-example-data-array-selected").select2({
  data: data
})
</pre>
</div>
</div>

<div id="outline-container-org7405d31" class="outline-4">
<h4 id="org7405d31"><span class="section-number-4">10.2.5</span> config:templateResult, Template</h4>
<div class="outline-text-4" id="text-10-2-5">
<pre class="example">
function formatState (state) {
  if (!state.id) {
    return state.text;
  }
  var baseUrl = "/user/pages/images/flags";
  var $state = $(
    '&lt;span&gt;&lt;img src="' + baseUrl + '/' + state.element.value.toLowerCase() + '.png" class="img-flag" /&gt; ' + state.text + '&lt;/span&gt;'
  );
  return $state;
};

$(".js-example-templating").select2({
  templateResult: formatState
});
</pre>
</div>
</div>

<div id="outline-container-org3431040" class="outline-4">
<h4 id="org3431040"><span class="section-number-4">10.2.6</span> config:templateSelection, Change display of selected value</h4>
<div class="outline-text-4" id="text-10-2-6">
<pre class="example">
function formatState (state) {
  if (!state.id) {
    return state.text;
  }
  var baseUrl = "/user/pages/images/flags";
  var $state = $(
    '&lt;span&gt;&lt;img src="' + baseUrl + '/' + state.element.value.toLowerCase() + '.png" class="img-flag" /&gt; ' + state.text + '&lt;/span&gt;'
  );
  return $state;
};

$(".js-example-templating").select2({
  templateSelection: formatState
});
</pre>
</div>
</div>

<div id="outline-container-org191c66f" class="outline-4">
<h4 id="org191c66f"><span class="section-number-4">10.2.7</span> config:maximumSelectionLength</h4>
<div class="outline-text-4" id="text-10-2-7">
<pre class="example">
$(".js-example-basic-multiple-limit").select2({
  maximumSelectionLength: 2
});
</pre>
</div>
</div>

<div id="outline-container-org8a3906a" class="outline-4">
<h4 id="org8a3906a"><span class="section-number-4">10.2.8</span> config:placeholder</h4>
<div class="outline-text-4" id="text-10-2-8">
<p>
First option has to be empty without any selected option
</p>
<pre class="example">
&lt;select class="js-example-placeholder-single js-states form-control"&gt;
  &lt;option&gt;&lt;/option&gt;
&lt;/select&gt;

$(".js-example-placeholder-single").select2({
    placeholder: "Select a state",
    allowClear: true
});
</pre>

<p>
placeholder can be an existing &lt;option&gt;
</p>
<pre class="example">
$('select').select2({
  placeholder: {
    id: '-1', // the value of the option
    text: 'Select an option'
  }
});
</pre>
</div>
</div>

<div id="outline-container-orgdb92d99" class="outline-4">
<h4 id="orgdb92d99"><span class="section-number-4">10.2.9</span> config:allowClear</h4>
<div class="outline-text-4" id="text-10-2-9">
<p>
Add a x for clearing
</p>
<pre class="example">
$('select').select2({
  placeholder: 'This is my placeholder',
  allowClear: true
});
</pre>
</div>
</div>

<div id="outline-container-org547bb27" class="outline-4">
<h4 id="org547bb27"><span class="section-number-4">10.2.10</span> config:width</h4>
<div class="outline-text-4" id="text-10-2-10">
<p>
Default is 'resolve' which is to take the style attribute of &lt;select&gt;, if not, fall back to computed element width ('element').
</p>

<p>
To make sure the field always takes 100% width of parent, use this
</p>
<pre class="example">
'width: '100%'
</pre>
</div>
</div>

<div id="outline-container-orgbd1e9d9" class="outline-4">
<h4 id="orgbd1e9d9"><span class="section-number-4">10.2.11</span> config:tags</h4>
<div class="outline-text-4" id="text-10-2-11">
<p>
User can type a new option and then select it
</p>
<pre class="example">
&lt;select class="form-control"&gt;
  &lt;option selected="selected"&gt;orange&lt;/option&gt;
  &lt;option&gt;white&lt;/option&gt;
  &lt;option&gt;purple&lt;/option&gt;
&lt;/select&gt;

$(".js-example-tags").select2({
  tags: true
});

// multiple
&lt;select class="form-control" multiple="multiple"&gt;
  &lt;option selected="selected"&gt;orange&lt;/option&gt;
  &lt;option&gt;white&lt;/option&gt;
  &lt;option selected="selected"&gt;purple&lt;/option&gt;
&lt;/select&gt;
</pre>
</div>
</div>

<div id="outline-container-orgc4cbb3d" class="outline-4">
<h4 id="orgc4cbb3d"><span class="section-number-4">10.2.12</span> config:tokenSeparators</h4>
<div class="outline-text-4" id="text-10-2-12">
<p>
User can type a space or a comma to add existing or type new option.
</p>
<pre class="example">
$(".js-example-tokenizer").select2({
    tags: true,
    tokenSeparators: [',', ' ']
})
</pre>
</div>
</div>

<div id="outline-container-org4b7d8e1" class="outline-4">
<h4 id="org4b7d8e1"><span class="section-number-4">10.2.13</span> config:createTag</h4>
<div class="outline-text-4" id="text-10-2-13">
<p>
After a new option is created by typing in config:tags, add properties to this new option
Reject creating a new option by returning null
</p>
<pre class="example">
$('select').select2({
  createTag: function (params) {
    var term = $.trim(params.term);

    if (term === '') {
      return null;
    }

    return {
      id: term,
      text: term,
      newTag: true // add additional parameters
    }
  }
});
</pre>
</div>
</div>

<div id="outline-container-orgcca5acb" class="outline-4">
<h4 id="orgcca5acb"><span class="section-number-4">10.2.14</span> config:insertTag</h4>
<div class="outline-text-4" id="text-10-2-14">
<p>
After a new option is created by typing in config:tags, do something about it
</p>
<pre class="example">
$('select').select2({
  insertTag: function (data, tag) {
    // Insert the tag at the end of the results
    data.push(tag);
  }
});
</pre>
</div>
</div>

<div id="outline-container-org2862aec" class="outline-4">
<h4 id="org2862aec"><span class="section-number-4">10.2.15</span> config:matcher, config:minimumInputLength, config:minimumResultsForSearch, Search</h4>
<div class="outline-text-4" id="text-10-2-15">
<p>
For single select, a search box is added to search each option. This search can be customized.
</p>

<p>
It only works for locally supplied data.
</p>

<pre class="example">
function matchCustom(params, data) {
    // If there are no search terms, return all of the data
    if ($.trim(params.term) === '') {
      return data;
    }

    // Do not display the item if there is no 'text' property
    if (typeof data.text === 'undefined') {
      return null;
    }

    // `params.term` should be the term that is used for searching
    // `data.text` is the text that is displayed for the data object
    if (data.text.indexOf(params.term) &gt; -1) {
      var modifiedData = $.extend({}, data, true);
      modifiedData.text += ' (matched)';

      // You can return modified objects from here
      // This includes matching the `children` how you want in nested data sets
      return modifiedData;
    }

    // Return `null` if the term should not be displayed
    return null;
}

$(".js-example-matcher").select2({
  matcher: matchCustom,
  minimumInputLength: 3, // only start searching when the user has input 3 or more characters
  minimumResultsForSearch: 20 // at least 20 results must be displayed. -1 or Infinity to permanently hide the search box.
  // minimumResultsForSearch: Infinity,
});
</pre>
</div>
</div>

<div id="outline-container-org5e78c11" class="outline-4">
<h4 id="org5e78c11"><span class="section-number-4">10.2.16</span> Methods, add, select, clear</h4>
<div class="outline-text-4" id="text-10-2-16">
<p>
add
</p>
<pre class="example">
// after $.append, &lt;select&gt; will have the new option

&lt;select id="mySelect2"&gt;
var data = {
    id: 1,
    text: 'Barn owl'
};

var newOption = new Option(data.text, data.id, false, false);
$('#mySelect2').append(newOption).trigger('change');

// create if not exists

// Set the value, creating a new option if necessary
if ($('#mySelect2').find("option[value='" + data.id + "']").length) {
    $('#mySelect2').val(data.id).trigger('change');
} else { 
    // Create a DOM Option and pre-select by default
    var newOption = new Option(data.text, data.id, true, true);
    // Append it to the select
    $('#mySelect2').append(newOption).trigger('change');
} 
</pre>

<p>
select
</p>
<pre class="example">
$('#mySelect2').val('1'); // Select the option with a value of '1'
$('#mySelect2').trigger('change'); // Notify any JS components that the value changed

$('#mySelect2').val(['1', '2']);
$('#mySelect2').trigger('change'); // Notify any JS components that the value changed
</pre>

<p>
clear
</p>
<pre class="example">
$('#mySelect2').val(null).trigger('change');
</pre>
</div>
</div>

<div id="outline-container-org7bc9fc8" class="outline-4">
<h4 id="org7bc9fc8"><span class="section-number-4">10.2.17</span> Method, get</h4>
<div class="outline-text-4" id="text-10-2-17">
<pre class="example">
// returns a array of objects
$('#mySelect2').select2('data');
$('#mySelect2').find(':selected');

// get value
$('#mySelect2').val();

// pure javascript will not work
// document.querySelector('#mySelect2').value;
</pre>

<pre class="example">
$('#mySelect2').select2({
  // ...
  templateSelection: function (data, container) {
    // Add custom attributes to the &lt;option&gt; tag for the selected option
    $(data.element).attr('data-custom-attribute', data.customValue);
    return data.text;
  }
});

// Retrieve custom attribute value of the first selected element
$('#mySelect2').find(':selected').data('custom-attribute');
</pre>
</div>
</div>

<div id="outline-container-orga85d9d3" class="outline-4">
<h4 id="orga85d9d3"><span class="section-number-4">10.2.18</span> Method, open|close dropdown, if initialized, destroy</h4>
<div class="outline-text-4" id="text-10-2-18">
<pre class="example">
$('#mySelect2').select2('open');

$('#mySelect2').select2('close');

if ($('#mySelect2').hasClass("select2-hidden-accessible")) {
    // Select2 has been initialized
}

$('#mySelect2').select2('destroy');
</pre>

<p>
Custom events need to be unbinded after destroy
</p>
<pre class="example">
// Set up a Select2 control
$('#example').select2();

// Bind an event
$('#example').on('select2:select', function (e) { 
    console.log('select event');
});

// Destroy Select2
$('#example').select2('destroy');

// Unbind the event
$('#example').off('select2:select');
</pre>
</div>
</div>

<div id="outline-container-org97ada74" class="outline-4">
<h4 id="org97ada74"><span class="section-number-4">10.2.19</span> Example: Destroy and Initiate</h4>
<div class="outline-text-4" id="text-10-2-19">
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">button</span> <span style="color: #dbdb95;">class</span>=<span style="color: #e67128;">"js-programmatic-destroy button"</span>&gt;Destroy&lt;/<span style="color: #00ede1; font-weight: bold;">button</span>&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">button</span> <span style="color: #dbdb95;">class</span>=<span style="color: #e67128;">"js-programmatic-init button"</span>&gt;Re-initialize&lt;/<span style="color: #00ede1; font-weight: bold;">button</span>&gt;

&lt;<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
$(<span style="color: #e67128;">".js-programmatic-destroy"</span>).on(<span style="color: #e67128;">"click"</span>, function () {
    $example.select2(<span style="color: #e67128;">"destroy"</span>);
});

$(<span style="color: #e67128;">".js-programmatic-init"</span>).on(<span style="color: #e67128;">"click"</span>, function () {
    $example.select2();
});
&lt;/<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org1a5c30d" class="outline-4">
<h4 id="org1a5c30d"><span class="section-number-4">10.2.20</span> Add down arrow to multiple &lt;select&gt;</h4>
<div class="outline-text-4" id="text-10-2-20">
<p>
By default, multiple &lt;select&gt; doesn't have a down arrow. The solution is to copy <code>.select2-selection--single</code> to <code>.select2-selection--multiple</code>
</p>
<div class="org-src-container">
<pre class="src src-css"><span style="color: #00ede1; font-weight: bold;">.select2-container--default .select2-selection--multiple .select2-selection__rendered</span>{
  <span style="color: #ffad29; font-weight: bold;">padding-left</span>:8px;
  <span style="color: #ffad29; font-weight: bold;">padding-right</span>:20px;
}
<span style="color: #00ede1; font-weight: bold;">.select2-container--default .select2-selection--multiple .select2-selection__clear</span>{
  <span style="color: #ffad29; font-weight: bold;">font-size</span>:13px;
  <span style="color: #ffad29; font-weight: bold;">color</span>:<span style="color: #ffffff; background-color: #666;">#666</span>;
  <span style="color: #ffad29; font-weight: bold;">margin</span>:0;
  <span style="color: #ffad29; font-weight: bold;">line-height</span>:26px;
}
<span style="color: #00ede1; font-weight: bold;">.select2-selection--multiple:after</span>{
  <span style="color: #ffad29; font-weight: bold;">content</span>:<span style="color: #e67128;">""</span>;
  <span style="color: #ffad29; font-weight: bold;">position</span>:absolute;
  <span style="color: #ffad29; font-weight: bold;">right</span>:7px;
  <span style="color: #ffad29; font-weight: bold;">top</span>:12px;
  <span style="color: #ffad29; font-weight: bold;">width</span>:0;
  <span style="color: #ffad29; font-weight: bold;">height</span>:0;
  <span style="color: #ffad29; font-weight: bold;">border-left</span>: 4px solid transparent;
  <span style="color: #ffad29; font-weight: bold;">border-right</span>: 4px solid transparent;
  <span style="color: #ffad29; font-weight: bold;">border-top</span>: 5px solid <span style="color: #ffffff; background-color: #888;">#888</span>;
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org4b5f223" class="outline-4">
<h4 id="org4b5f223"><span class="section-number-4">10.2.21</span> Events</h4>
<div class="outline-text-4" id="text-10-2-21">
<p>
change :: general Javascript select change
change.select2 :: only for Select2 &lt;select&gt; change
select2:selecting :: Triggered before a result is selected. This event can be prevented.
select2:select :: Triggered whenever a result is selected. select2:selecting is fired before this and can be prevented.
</p>

<pre class="example">
$('#mySelect2').on('select2:select', function (e) {
  var data = e.params.data;
  console.log(data);
});
</pre>

<p>
Trigger an event
</p>
<pre class="example">
var data = {
  "id": 1,
  "text": "Tyto alba",
  "genus": "Tyto",
  "species": "alba"
};

$('#mySelect2').trigger({
    type: 'select2:select',
    params: {
        data: data
    }
});

$('#mySelect2').trigger('change.select2'); // Notify only Select2 of changes
</pre>
</div>
</div>
</div>

<div id="outline-container-orgba7f9e1" class="outline-3">
<h3 id="orgba7f9e1"><span class="section-number-3">10.3</span> Owl Carousel</h3>
<div class="outline-text-3" id="text-10-3">
<p>
<a href="https://github.com/OwlCarousel2/OwlCarousel2">https://github.com/OwlCarousel2/OwlCarousel2</a>
</p>

<p>
Bootstrap's carousel can only show one item like a slideshow.
Owl can have multiple items.
</p>

<p>
<a href="https://gist.github.com/levonlee/c198b0a3d0286066aa5ff450bd49cf5e">Example: Owl Carousel + Bootstrap Modal + Bootstrap Carousel</a>
</p>
</div>
</div>

<div id="outline-container-org925adc2" class="outline-3">
<h3 id="org925adc2"><span class="section-number-3">10.4</span> Fine Uploader</h3>
<div class="outline-text-3" id="text-10-4">
<p>
<a href="https://github.com/FineUploader/fine-uploader">https://github.com/FineUploader/fine-uploader</a>
No dependency
</p>
</div>
</div>

<div id="outline-container-org874c92d" class="outline-3">
<h3 id="org874c92d"><span class="section-number-3">10.5</span> Dropzone</h3>
<div class="outline-text-3" id="text-10-5">
<p>
<a href="https://github.com/enyo/dropzone/">https://github.com/enyo/dropzone/</a>
</p>

<p>
No dependency
</p>
</div>

<div id="outline-container-org5c7a7dd" class="outline-4">
<h4 id="org5c7a7dd"><span class="section-number-4">10.5.1</span> Basics</h4>
<div class="outline-text-4" id="text-10-5-1">
<p>
Download the dist folder
</p>
<pre class="example">
&lt;script src="/dist/dropzone.js"&gt;&lt;/script&gt;
&lt;link rel="stylesheet" href="/dist/dropzone.css"&gt;
&lt;!-- /dist/min/* for production --&gt;
</pre>

<p>
Dropzone will be available as window.Dropzone and jQuery.fn.Dropzone (if jQuery is loaded)
</p>

<p>
Create Dropzone without javascript (auto discover), Dropzone.options
</p>
<pre class="example">
&lt;form action="/file-upload" class="dropzone" id="my-awesome-dropzone"&gt;
  &lt;!-- hidden input will be submitted --&gt;
  &lt;!-- &lt;input type="hidden" name="addtionaldata" value="1" /&gt; --&gt;
  &lt;div class="fallback"&gt;
    &lt;input name="file" type="file" multiple /&gt;
  &lt;/div&gt;
&lt;/form&gt;

&lt;!-- because it's auto discovered, you may need to setup the config --&gt;
// "myAwesomeDropzone" is the camelized version of the HTML element's ID
Dropzone.options.myAwesomeDropzone = {
  paramName: "file", // The name that will be used to transfer the file
  maxFilesize: 2, // MB
  accept: function(file, done) {
    if (file.name == "justinbieber.jpg") {
      done("Naha, you don't.");
    }
    else { done(); }
  }
};
</pre>

<p>
Create with javascript, must have url option.
</p>
<pre class="example">
// Prevent Dropzone from auto discovering this element:
Dropzone.options.myAwesomeDropzone = false;
// This is useful when you want to create the
// Dropzone programmatically later

// Disable auto discover for all elements:
Dropzone.autoDiscover = false;

// Dropzone class:
var myDropzone = new Dropzone("div#myId", { url: "/file/post"});

// jQuery
$("div#myId").dropzone({ url: "/file/post" });
</pre>

<p>
The file will be posted in backend as
</p>
<pre class="example">
&lt;input type="file" name="file" /&gt;
</pre>

<p>
To make the whole page droppable
</p>
<pre class="example">
&lt;!--
Don't forget to give this container the dropzone-previews class 
so the previews are formatted correctly.
 --&gt;
&lt;div id="previews" class="dropzone-previews"&gt;&lt;/div&gt;

&lt;button id="clickable"&gt;Click me to select files&lt;/button&gt;

var myDropzone  = new Dropzone(document.body, {
  previewsContainer: ".dropzone-previews", // the element must have
  // You probably don't want the whole body
  // to be clickable to select files
  clickable: false
});

// or
&lt;script&gt;
  new Dropzone(document.body, { // Make the whole body a dropzone
    url: "/upload/url", // Set the url
    previewsContainer: "#previews", // Define the container to display the previews
    clickable: "#clickable" // Define the element that should be used as click trigger to select files.
  });
&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-orgc4402b2" class="outline-4">
<h4 id="orgc4402b2"><span class="section-number-4">10.5.2</span> option:function:accept(file, done)</h4>
<div class="outline-text-4" id="text-10-5-2">
<p>
Invoke done() without arguments to accept and process the file.
Invoke done() with an error message to reject the file and show the message.
It won't be invoked if the file is too big or mime type doesn't match.
</p>
<pre class="example">
accept: function(file, done) {
  if (file.name == "justinbieber.jpg") {
    done("Naha, you don't.");
  }
  else { done(); }
}
</pre>
</div>
</div>

<div id="outline-container-orgd3816d0" class="outline-4">
<h4 id="orgd3816d0"><span class="section-number-4">10.5.3</span> option:previewsContainer null|string</h4>
<div class="outline-text-4" id="text-10-5-3">
<p>
HTMLElement or a CSS selector. The element should have the .dropzone-previews or dropzone class.
</p>
</div>
</div>

<div id="outline-container-org90740bb" class="outline-4">
<h4 id="org90740bb"><span class="section-number-4">10.5.4</span> option:autoProcessQueue</h4>
<div class="outline-text-4" id="text-10-5-4">
<p>
False :: files will be added to the queue but the queue will not be processed automatically.
Call myDropzone.processQueue() to process the queue.
</p>
</div>
</div>

<div id="outline-container-orgfc04ccf" class="outline-4">
<h4 id="orgfc04ccf"><span class="section-number-4">10.5.5</span> option:previewTemplate String, option:dict*</h4>
<div class="outline-text-4" id="text-10-5-5">
<p>
Default template <a id="orgc931a7e">dropzone:default template</a>
</p>
<pre class="example">
&lt;div class="dz-preview dz-file-preview"&gt;
  &lt;div class="dz-details"&gt;
    &lt;div class="dz-filename"&gt;&lt;span data-dz-name&gt;&lt;/span&gt;&lt;/div&gt;
    &lt;div class="dz-size" data-dz-size&gt;&lt;/div&gt;
    &lt;!-- img's alt and src will change --&gt;
    &lt;img data-dz-thumbnail /&gt;
  &lt;/div&gt;
  &lt;div class="dz-progress"&gt;&lt;span class="dz-upload" data-dz-uploadprogress&gt;&lt;!-- style.width from 0% to 100% --&gt;&lt;/span&gt;&lt;/div&gt;
  &lt;div class="dz-success-mark"&gt;&lt;span&gt;✔&lt;/span&gt;&lt;/div&gt;
  &lt;div class="dz-error-mark"&gt;&lt;span&gt;✘&lt;/span&gt;&lt;/div&gt;
  &lt;div class="dz-error-message"&gt;&lt;span data-dz-errormessage&gt;&lt;/span&gt;&lt;/div&gt;
  &lt;!-- &lt;a class="dz-remove" href="javascript:undefined" data-dz-remove&gt;Remove file&lt;/a&gt; --&gt;
&lt;/div&gt;
&lt;!-- Another preview --&gt;
</pre>

<p>
The default template might change from version to version. But console.log(file.previewElement) in any event will output.
</p>

<p>
.dz-preview gets .dz-processing when the file gets processed, .dz-success when it got uploaded and .dz-error
</p>

<p>
Make sure custom template has these attributes
</p>
<ul class="org-ul">
<li>data-dz-name</li>
<li>data-dz-size</li>
<li>data-dz-thumbnail</li>
<li>data-dz-uploadprogress</li>
<li>data-dz-errormessage</li>
</ul>

<p>
Add a remove button (data-dz-remove)
</p>
<pre class="example">
&lt;img src="removebutton.png" alt="Click me to remove the file." data-dz-remove /&gt;
</pre>
</div>
</div>

<div id="outline-container-orgdd8e3d7" class="outline-4">
<h4 id="orgdd8e3d7"><span class="section-number-4">10.5.6</span> option:addRemoveLInks null:true</h4>
<div class="outline-text-4" id="text-10-5-6">
<p>
Wording: dictCancelUpload, dictCancelUploadConfirmation and dictRemoveFile
<a href="#orgc931a7e">dropzone:default template</a>
</p>
</div>
</div>

<div id="outline-container-org2d05930" class="outline-4">
<h4 id="org2d05930"><span class="section-number-4">10.5.7</span> option:translation</h4>
<div class="outline-text-4" id="text-10-5-7">
</div>
<div id="outline-container-org11aaebe" class="outline-5">
<h5 id="org11aaebe"><span class="section-number-5">10.5.7.1</span> option:dictCancelUpload, dictCancelUploadConfirmation, dictRemoveFile</h5>
</div>
</div>

<div id="outline-container-orgefced44" class="outline-4">
<h4 id="orgefced44"><span class="section-number-4">10.5.8</span> option:maxFiles int</h4>
<div class="outline-text-4" id="text-10-5-8">
<pre class="example">
Dropzone.options.myAwesomeDropzone = {
  maxFiles: 1,
  accept: function(file, done) {
    console.log("uploaded");
    done();
  },
  init: function() {
    this.on("maxfilesexceeded", function(file){
        alert("No more files please!");
      this.removeFile(file);
    });
  }
};
</pre>
</div>
</div>

<div id="outline-container-org8561328" class="outline-4">
<h4 id="org8561328"><span class="section-number-4">10.5.9</span> option:maxFilesize int (MB)</h4>
<div class="outline-text-4" id="text-10-5-9">
<p>
event:maxfilesexceeded is called and the whole dropzone element gets the class .dz-max-files-reached
</p>
</div>
</div>

<div id="outline-container-org325a0f0" class="outline-4">
<h4 id="org325a0f0"><span class="section-number-4">10.5.10</span> option:event:init, add events</h4>
<div class="outline-text-4" id="text-10-5-10">
<p>
It's the best place to add custom events if options are used to setup the dropzone
</p>
<pre class="example">
// The recommended way from within the init configuration:
Dropzone.options.myAwesomeDropzone = {
  init: function() {
    this.on("addedfile", function(file) { alert("Added file."); });
  }
};
</pre>

<p>
Use this to attach events if dropzone is defined programmatically
</p>
<pre class="example">
// This example uses jQuery so it creates the Dropzone, only when the DOM has
// loaded.

// Disabling autoDiscover, otherwise Dropzone will try to attach twice.
Dropzone.autoDiscover = false;
// or disable for specific dropzone:
// Dropzone.options.myDropzone = false;

$(function() {
  // Now that the DOM is fully loaded, create the dropzone, and setup the
  // event listeners
  var myDropzone = new Dropzone("#my-dropzone");
  myDropzone.on("addedfile", function(file) {
    /* Maybe display some more file information on your page */
  });
})
</pre>
</div>
</div>

<div id="outline-container-org2da2065" class="outline-4">
<h4 id="org2da2065"><span class="section-number-4">10.5.11</span> option:clickable null|true|false|an html element|a CSS selector|array of html</h4>
<div class="outline-text-4" id="text-10-5-11">
<p>
All of those elements will trigger an upload when clicked
</p>
</div>
</div>

<div id="outline-container-orgd9a056e" class="outline-4">
<h4 id="orgd9a056e"><span class="section-number-4">10.5.12</span> option:acceptedFiles string of list</h4>
<div class="outline-text-4" id="text-10-5-12">
<p>
comma separated list of mime types of file extensions
</p>
<pre class="example">
image/*,applicaton/pdf,.psd
</pre>
</div>
</div>

<div id="outline-container-org8ffc5c0" class="outline-4">
<h4 id="org8ffc5c0"><span class="section-number-4">10.5.13</span> option:maxThumbnailFilesize (MB), thumbnailWidth, thumbnailHeight, thumbnailMethod</h4>
<div class="outline-text-4" id="text-10-5-13">
<p>
thumbnailMethod :: 'contain' or 'crop' when thumbnailWidth and thumbnailHeight are both defined!
</p>
</div>
</div>

<div id="outline-container-orgf6edc97" class="outline-4">
<h4 id="orgf6edc97"><span class="section-number-4">10.5.14</span> event:addedfile</h4>
<div class="outline-text-4" id="text-10-5-14">
<pre class="example">
// Disabling autoDiscover, otherwise Dropzone will try to attach twice.
Dropzone.autoDiscover = false;
// or disable for specific dropzone:
// Dropzone.options.myDropzone = false;

$(function() {
  // Now that the DOM is fully loaded, create the dropzone, and setup the
  // event listeners
  var myDropzone = new Dropzone("#my-dropzone");
  myDropzone.on("addedfile", function(file) {
    /* Maybe display some more file information on your page */
  });
})
</pre>
</div>
</div>

<div id="outline-container-org59fa4a2" class="outline-4">
<h4 id="org59fa4a2"><span class="section-number-4">10.5.15</span> event:removedfile(file)</h4>
</div>
<div id="outline-container-org8a730a1" class="outline-4">
<h4 id="org8a730a1"><span class="section-number-4">10.5.16</span> event:thumbnail(file, dataUrl)</h4>
</div>
<div id="outline-container-org20f3983" class="outline-4">
<h4 id="org20f3983"><span class="section-number-4">10.5.17</span> event:processing(file)</h4>
<div class="outline-text-4" id="text-10-5-17">
<p>
when a file gets processed
</p>
</div>
</div>

<div id="outline-container-org7bcfe57" class="outline-4">
<h4 id="org7bcfe57"><span class="section-number-4">10.5.18</span> event:uploadprogress(file, progress, bytesSent)</h4>
<div class="outline-text-4" id="text-10-5-18">
<p>
progress :: int from 0 to 100
</p>
</div>
</div>

<div id="outline-container-orgbfa120e" class="outline-4">
<h4 id="orgbfa120e"><span class="section-number-4">10.5.19</span> event:error(file)</h4>
</div>
<div id="outline-container-org6cc5f62" class="outline-4">
<h4 id="org6cc5f62"><span class="section-number-4">10.5.20</span> event:success(file, responseText)</h4>
<div class="outline-text-4" id="text-10-5-20">
<p>
Display something after a file is uploaded.
</p>

<p>
myDropzone.files has been appended.
</p>

<pre class="example">
Dropzone.options.myDropzone = {
  init: function() {
    this.on("success", function(file, responseText) {
      // Handle the responseText here. For example, add the text to the preview element:
      file.previewTemplate.appendChild(document.createTextNode(responseText));
    });
  }
};
</pre>

<p>
Display thumbnail that is created on server after server processes the uploaded image <code>{ "imageUrl": "http://my.image/file.jpg" }</code>
</p>
<pre class="example">
Dropzone.options.myDropzone = {
  init: function() {
    this.on("success", function(file, serverResponse) {
      // Called after the file successfully uploaded.

      // If the image is already a thumbnail:
      this.emit('thumbnail', file, serverResponse.imageUrl);

      // If it needs resizing:
      this.createThumbnailFromUrl(file, serverResponse.imageUrl);
    });
  }
};
</pre>
</div>
</div>

<div id="outline-container-orgdc8dd12" class="outline-4">
<h4 id="orgdc8dd12"><span class="section-number-4">10.5.21</span> event:complete(file)</h4>
</div>
<div id="outline-container-orge712f97" class="outline-4">
<h4 id="orge712f97"><span class="section-number-4">10.5.22</span> event:canceled(file)</h4>
</div>
<div id="outline-container-orgbe34d21" class="outline-4">
<h4 id="orgbe34d21"><span class="section-number-4">10.5.23</span> event:maxfilesexceeded(file)</h4>
</div>
<div id="outline-container-org6522601" class="outline-4">
<h4 id="org6522601"><span class="section-number-4">10.5.24</span> event:maxfilesreached(file)</h4>
<div class="outline-text-4" id="text-10-5-24">
<p>
the number of files accepted reaches the maxFiles limit
</p>
</div>
</div>
<div id="outline-container-orga498e64" class="outline-4">
<h4 id="orga498e64"><span class="section-number-4">10.5.25</span> FAQ</h4>
<div class="outline-text-4" id="text-10-5-25">
<p>
<a href="https://github.com/enyo/dropzone/wiki/FAQ#how-to-show-files-already-stored-on-server">https://github.com/enyo/dropzone/wiki/FAQ#how-to-show-files-already-stored-on-server</a>
</p>
</div>
</div>

<div id="outline-container-org3f30521" class="outline-4">
<h4 id="org3f30521"><span class="section-number-4">10.5.26</span> Show error returned by server</h4>
<div class="outline-text-4" id="text-10-5-26">
<p>
Just return HTTP status code in the range of 400-500.
If response Content-Type is text/plain, the text will be returned as error message.
If it's application/json, dropzone uses the error property {"error": "File could not be saved."}
</p>
</div>
</div>

<div id="outline-container-org1a6b0a1" class="outline-4">
<h4 id="org1a6b0a1"><span class="section-number-4">10.5.27</span> Show server response</h4>
<div class="outline-text-4" id="text-10-5-27">
<p>
See event:success(file, responseText)
</p>
</div>
</div>

<div id="outline-container-org39d929f" class="outline-4">
<h4 id="org39d929f"><span class="section-number-4">10.5.28</span> Show files already stored on server</h4>
<div class="outline-text-4" id="text-10-5-28">
<pre class="example">
// Create the mock file:
var mockFile = { name: "Filename", size: 12345 };

// Call the default addedfile event handler
myDropzone.emit("addedfile", mockFile);

// And optionally show the thumbnail of the file:
myDropzone.emit("thumbnail", mockFile, "/image/url");
// Or if the file on your server is not yet in the right
// size, you can let Dropzone download and resize it
// callback and crossOrigin are optional.
myDropzone.createThumbnailFromUrl(file, imageUrl, callback, crossOrigin);

// Make sure that there is no progress bar, etc...
myDropzone.emit("complete", mockFile);

myDropzone.files.push(mockFile);

// If you use the maxFiles option, make sure you adjust it to the
// correct amount:
var existingFileCount = 1; // The number of files already uploaded
myDropzone.options.maxFiles = myDropzone.options.maxFiles - existingFileCount;
</pre>
</div>
</div>

<div id="outline-container-org02a2c25" class="outline-4">
<h4 id="org02a2c25"><span class="section-number-4">10.5.29</span> Sortable</h4>
<div class="outline-text-4" id="text-10-5-29">
<pre class="example">
  $(function() {
    $("#slideshow-pictures").sortable({
      items:'.dz-preview',
      cursor: 'move',
      opacity: 0.5,
      containment: '#slideshow-pictures',
      //distance: 20,
      tolerance: 'pointer',
      update: function (event, ui) {
        var queue = myDropzone.files;
        var newQueue = [];
        $('#slideshow-pictures .dz-preview .dz-filename [data-dz-name]').each(function (count, el) {
          var name = el.innerHTML;
          queue.forEach(function(file) {
            if (file.name === name) {
              newQueue.push(file);
            }
          });
        });
        myDropzone.files = newQueue;
      }
    });
  });

Dropzone.options.slideshowPictures = false;
Dropzone.autoDiscover = false;
var myDropzone = new Dropzone("#slideshow-pictures", {...});
</pre>
</div>
</div>
</div>

<div id="outline-container-org3d1e6e8" class="outline-3">
<h3 id="org3d1e6e8"><span class="section-number-3">10.6</span> modernizr</h3>
<div class="outline-text-3" id="text-10-6">
<p>
It usually adds a class in &lt;html&gt; when a certain feature is supported
</p>
<pre class="example">
// &lt;html class="no-cssgradients"&gt;
// &lt;html class="cssgradients"&gt;

.no-cssgradients .header {
  background: url("images/glossybutton.png");
}
.cssgradients .header {
  background-image: linear-gradient(cornflowerblue, rebeccapurple);
}
</pre>

<p>
Config
</p>
<pre class="example">
{
  "classPrefix": "foo-",
  "feature-detects": ["dom/hidden"]
}
</pre>
</div>

<div id="outline-container-org0106505" class="outline-4">
<h4 id="org0106505"><span class="section-number-4">10.6.1</span> Feature</h4>
<div class="outline-text-4" id="text-10-6-1">
<p>
Modernizr.feature-name is true or false, true add .classPrefix-feature-name, false add .classPrefix-no-feature-name
</p>

<pre class="example">
if (Modernizr.mediaqueries) {
  // supported
} else {
  // not-supported
}
</pre>
</div>

<div id="outline-container-org9e252a7" class="outline-5">
<h5 id="org9e252a7"><span class="section-number-5">10.6.1.1</span> flexbox, flexboxlegacy, flexboxtweener, flexwrap <a id="org18d20e6">modernizr:flexbox</a></h5>
<div class="outline-text-5" id="text-10-6-1-1">
<pre class="example">
.flexbox.no-flexwrap .row {
  display:-webkit-flex-wrap: wrap;

}
</pre>

<p>
Bootstrap 4 fallback flex
</p>
<pre class="example">
Lili.cssFixFlex = function() {
  if (!Modernizr.testProp('display', 'flex') &amp;&amp; !Modernizr.testProp('display', '-ms-flexbox') &amp;&amp; Modernizr.testProp('display', '-webkit-box') &amp;&amp; Modernizr.testProp('display', '-webkit-flex')) {
    // display:flex and -ms-flexbox are not supported but -webkit-box and -webkit-flex are supported
    // Bootstrap uses display:-webkit-box only
    // add class to html tag
    $('html').addClass('bootstrap-ios-fix-row');
  }
  else if (!Modernizr.testProp('display', 'flex') &amp;&amp; !Modernizr.testProp('display', '-ms-flexbox') &amp;&amp; Modernizr.testProp('display', '-webkit-box') &amp;&amp; !Modernizr.testProp('display', '-webkit-flex')) {
    // flex is completely not supported
    $('html').addClass('bootstrap-fix-row');
  }
}

$(function() {
  Lili.cssFixFlex();
})
</pre>

<pre class="example">
.bootstrap-ios-fix-row .row {
  display:-webkit-flex;
  -webkit-flex-wrap:wrap;
}
.bootstrap-fix-row .row {
  display:inline-block;
}
</pre>
</div>
</div>

<div id="outline-container-org5851555" class="outline-5">
<h5 id="org5851555"><span class="section-number-5">10.6.1.2</span> touchevents</h5>
</div>
<div id="outline-container-orgf217f58" class="outline-5">
<h5 id="orgf217f58"><span class="section-number-5">10.6.1.3</span> videoautoplay</h5>
<div class="outline-text-5" id="text-10-6-1-3">
<p>
This feature detection is not reliable..
</p>
</div>
</div>

<div id="outline-container-org41eb498" class="outline-5">
<h5 id="org41eb498"><span class="section-number-5">10.6.1.4</span> webp <a id="org73eba46">modernizr:webp</a></h5>
<div class="outline-text-5" id="text-10-6-1-4">
<p>
Modernizr.webp, Modernizr.webp.lossless, Modernizr.webp.alpha and Modernizr.webp.animation
</p>
</div>
</div>
</div>

<div id="outline-container-orga0bf4ba" class="outline-4">
<h4 id="orga0bf4ba"><span class="section-number-4">10.6.2</span> Option</h4>
<div class="outline-text-4" id="text-10-6-2">
</div>
<div id="outline-container-org3b3833c" class="outline-5">
<h5 id="org3b3833c"><span class="section-number-5">10.6.2.1</span> .mq(mq)</h5>
<div class="outline-text-5" id="text-10-6-2-1">
<pre class="example">
var query = Modernizr.mq('(min-width: 900px)');
if (query) {
  // the browser window is larger than 900px
}

Modernizr.mq('only all'); // true if MQ are supported, false if not
</pre>
</div>
</div>
</div>

<div id="outline-container-org78b3fd9" class="outline-4">
<h4 id="org78b3fd9"><span class="section-number-4">10.6.3</span> API</h4>
<div class="outline-text-4" id="text-10-6-3">
</div>
<div id="outline-container-orgd50d6bb" class="outline-5">
<h5 id="orgd50d6bb"><span class="section-number-5">10.6.3.1</span> Modernizr.on(feature, cb)</h5>
<div class="outline-text-5" id="text-10-6-3-1">
<pre class="example">
Modernizr.on('flash', function( result ) {
  if (result) {
   // the browser has flash
  } else {
    // the browser does not have flash
  }
});
</pre>
</div>
</div>

<div id="outline-container-orge01fda3" class="outline-5">
<h5 id="orge01fda3"><span class="section-number-5">10.6.3.2</span> .addTest('customFeatureName', cb)</h5>
<div class="outline-text-5" id="text-10-6-3-2">
<pre class="example">
Modernizr.addTest('itsTuesday', function() {
 var d = new Date();
 return d.getDay() === 2;
});

Modernizr.addTest('hasJquery', 'jQuery' in window);

// combine
var detects = {
 'hasjquery': 'jQuery' in window,
 'itstuesday': function() {
   var d = new Date();
   return d.getDay() === 2;
 }
}
Modernizr.addTest(detects);
</pre>
</div>
</div>

<div id="outline-container-org961d4fc" class="outline-5">
<h5 id="org961d4fc"><span class="section-number-5">10.6.3.3</span> .atRule(prop)</h5>
<div class="outline-text-5" id="text-10-6-3-3">
<pre class="example">
var keyframes = Modernizr.atRule('@keyframes');
if (keyframes) {
   // keyframes are supported
   // could be `@-webkit-keyframes` or `@keyframes`
} else {
  // keyframes === `false`
}
</pre>
</div>
</div>

<div id="outline-container-org074c1e8" class="outline-5">
<h5 id="org074c1e8"><span class="section-number-5">10.6.3.4</span> ._domPrefixes, ._prefixes</h5>
<div class="outline-text-5" id="text-10-6-3-4">
<p>
._prefixes return kebab-case properties
</p>
<pre class="example">
var rule = Modernizr._prefixes.join('transform: rotate(20deg); ');
rule === 'transform: rotate(20deg); webkit-transform: rotate(20deg); moz-transform: rotate(20deg); o-transform: rotate(20deg); ms-transform: rotate(20deg);'
</pre>

<p>
Modernizr._domPrefixes <code>=</code> [ "Moz", "O", "ms", "Webkit" ];
</p>
</div>
</div>

<div id="outline-container-orgc4083a7" class="outline-5">
<h5 id="orgc4083a7"><span class="section-number-5">10.6.3.5</span> .hasEvent(eventName, [element])</h5>
</div>
<div id="outline-container-org7258bfb" class="outline-5">
<h5 id="org7258bfb"><span class="section-number-5">10.6.3.6</span> .prefixedCSS(prop), .prefixed(prop, [obj], [elem])</h5>
<div class="outline-text-5" id="text-10-6-3-6">
<pre class="example">
Modernizr.prefixedCSS('transition') // '-moz-transition' in old Firefox
</pre>
</div>
</div>

<div id="outline-container-org27b3bbb" class="outline-5">
<h5 id="org27b3bbb"><span class="section-number-5">10.6.3.7</span> .prefixedCSSValue(prop,value)</h5>
</div>

<div id="outline-container-org0f2e1e0" class="outline-5">
<h5 id="org0f2e1e0"><span class="section-number-5">10.6.3.8</span> .testAllProps(prop,[value], [skipValueTest]), .testProp(prop,[value], [useValue])</h5>
<div class="outline-text-5" id="text-10-6-3-8">
<p>
Whether a given CSS property, in some prefixed form, is supported by the browser.
</p>
<pre class="example">
testAllProps('boxSizing')  // true
testAllProps('display', 'block') // true
testAllProps('display', 'penguin') // false
</pre>

<p>
.testProp only tests against non-prefix version.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org75ae016" class="outline-3">
<h3 id="org75ae016"><span class="section-number-3">10.7</span> UAParser.js</h3>
<div class="outline-text-3" id="text-10-7">
<p>
Browser detect, engine, OS, CPU and device type/model from userAgent string. <a href="https://github.com/faisalman/ua-parser-js">Git</a>
</p>

<pre class="example">
&lt;script src="https://cdn.jsdelivr.net/npm/ua-parser-js@0/dist/ua-parser.min.js"&gt;&lt;/script&gt;

var parser = new UAParser();
var r = parser.getResult(); // { ua: '', browser: {}, cpu: {}, device: {}, engine: {}, os: {} }
console.log(r.browser);     // {name: "Chromium", version: "15.0.874.106"}

// browser.name
// Amaya, Android Browser, Arora, Avant, Baidu, Blazer, Bolt, Bowser, Camino, Chimera, 
Chrome [WebView], Chromium, Comodo Dragon, Conkeror, Dillo, Dolphin, Doris, Edge, 
Epiphany, Fennec, Firebird, Firefox, Flock, GoBrowser, iCab, ICE Browser, IceApe, 
IceCat, IceDragon, Iceweasel, IE[Mobile], Iron, Jasmine, K-Meleon, Konqueror, Kindle, 
Links, Lunascape, Lynx, Maemo, Maxthon, Midori, Minimo, MIUI Browser, [Mobile] Safari, 
Mosaic, Mozilla, Netfront, Netscape, NetSurf, Nokia, OmniWeb, Opera [Mini/Mobi/Tablet], 
PhantomJS, Phoenix, Polaris, QQBrowser, QQBrowserLite, Quark, RockMelt, Silk, Skyfire, 
SeaMonkey, Sleipnir, SlimBrowser, Swiftfox, Tizen, UCBrowser, Vivaldi, w3m, Waterfox, 
WeChat, Yandex

r.device // { model: '', type: '', vendor: '' }

// model
// console, mobile, tablet, smarttv, wearable, embedded
</pre>
</div>
</div>

<div id="outline-container-org7e7d379" class="outline-3">
<h3 id="org7e7d379"><span class="section-number-3">10.8</span> flowpaper</h3>
<div class="outline-text-3" id="text-10-8">
<p>
Turn PDF into HTML5. <a href="https://flowpaper.com/download/">https://flowpaper.com/download/</a>
</p>
</div>
</div>

<div id="outline-container-org7aee24f" class="outline-3">
<h3 id="org7aee24f"><span class="section-number-3">10.9</span> reveal.js</h3>
<div class="outline-text-3" id="text-10-9">
<p>
<a href="https://github.com/hakimel/reveal.js/">https://github.com/hakimel/reveal.js/</a>
</p>
</div>

<div id="outline-container-orgf6c8f54" class="outline-4">
<h4 id="orgf6c8f54"><span class="section-number-4">10.9.1</span> Plugins</h4>
<div class="outline-text-4" id="text-10-9-1">
<p>
<a href="https://github.com/hakimel/reveal.js/wiki/Plugins,-Tools-and-Hardware">All plugins</a> 
</p>
</div>

<div id="outline-container-orga4be4d1" class="outline-5">
<h5 id="orga4be4d1"><span class="section-number-5">10.9.1.1</span> <a href="https://github.com/denehyg/reveal.js-menu">reveal.js-menu</a></h5>
<div class="outline-text-5" id="text-10-9-1-1">
<p>
Git clone and copy the whole folder
</p>
<pre class="example">
Reveal.initialize({
        // ...

        dependencies: [
                // ... 

                { src: 'plugin/reveal.js-menu/menu.js' }
        ]
});
</pre>

<p>
Add id="theme" if theme is used
</p>
<pre class="example">
&lt;link rel="stylesheet" href="css/theme/black.css" id="theme"&gt;
</pre>

<p>
Add data-menu-title to section, if not, the first .menu-title is used and it doesn't have to be displayed. Or change option:titleSelector. If still no title and option:hideMissingTitles is set to false, then the slide will not be included in menu
</p>

<p>
Add custom item (panel) in menu top, default is slides and close button.
</p>
<pre class="example">
Reveal.initialize({
        // ...

        menu: {
                // ...

                custom: [
                        { title: 'Links', icon: '&lt;i class="fa fa-external-link"&gt;', src: 'links.html' },
                        { title: 'About', icon: '&lt;i class="fa fa-info"&gt;', content: '&lt;p&gt;This slidedeck is created with reveal.js&lt;/p&gt;' }
                ]
        }
});
</pre>

<dl class="org-dl">
<dt>src</dt><dd>when clicked, the external source is loaded into the menu content section.</dd>
<dt>content</dt><dd>any html but you can add your own menu items</dd>
</dl>
<pre class="example">
&lt;h1&gt;Links&lt;/h1&gt;
&lt;ul class="slide-menu-items"&gt;
        &lt;li class="slide-menu-item"&gt;&lt;a href="#/transitions"&gt;Transitions&lt;/a&gt;&lt;/li&gt;
        &lt;li class="slide-menu-item"&gt;&lt;a href="#/13"&gt;Code highlighting&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

// you can also link to any where
&lt;h1&gt;External Links&lt;/h1&gt;
&lt;ul class="slide-menu-items"&gt;
        &lt;li class="slide-menu-item"&gt;&lt;a href="https://github.com/denehyg/reveal.js-menu"&gt;Reveal.js-menu&lt;/a&gt;&lt;/li&gt;
        &lt;li class="slide-menu-item"&gt;&lt;a href="https://github.com/hakimel/reveal.js"&gt;Reveal.js&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</pre>

<p>
Options and their default
</p>
<pre class="example">
Reveal.initialize({
        // ...

        menu: {
          side: 'left', // or 'right',
          markers: true, // Add icon to menu title
        },
});
</pre>

<dl class="org-dl">
<dt>titleSelector: 'h1, h2, h3, h4, h5, h6'</dt><dd>e.g. 'p.lead'</dd>
<dt>(no term)</dt><dd>hideMissingTitles: false</dd>
</dl>
</div>
</div>
</div>
</div>

<div id="outline-container-org8926495" class="outline-3">
<h3 id="org8926495"><span class="section-number-3">10.10</span> BabylonJS</h3>
<div class="outline-text-3" id="text-10-10">
<p>
Install Blender :: <a href="https://www.blender.org/">https://www.blender.org/</a>
</p>
<ul class="org-ul">
<li>File &gt; User Preferences &gt; Add-ons &gt; search dxf and enable Export and Import AutoCAD DXF Format</li>
</ul>

<p>
Or import "dxf ascii release 14 or under"
</p>

<p>
Install addon to export from .blend to .babylon :: <a href="http://doc.babylonjs.com/resources/blender">http://doc.babylonjs.com/resources/blender</a>
</p>

<p>
Export as .babylon
</p>

<p>
Get free 3d .obj, .fbx, .3ds files from <a href="https://free3d.com/3d-model/bb8-35865.html">Free3d.com</a> or <a href="https://clara.io/library">Clara.io</a>
</p>

<p>
Tutorial: <a href="https://github.com/mpwassler/3dproductview">https://github.com/mpwassler/3dproductview</a>
</p>

<p>
Callback in runRenderLoop is run 60 times per second to draw a frame.
</p>
</div>

<div id="outline-container-org860625d" class="outline-4">
<h4 id="org860625d"><span class="section-number-4">10.10.1</span> Shapes</h4>
<div class="outline-text-4" id="text-10-10-1">
<p>
<a href="https://doc.babylonjs.com/babylon101/discover_basic_elements">https://doc.babylonjs.com/babylon101/discover_basic_elements</a>
</p>

<p>
var shape = BABYLON.MeshBuilder.Create[ShapeName](name, options, scene);
</p>

<ul class="org-ul">
<li>box, Sphere, Plane, Ground</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-org3c84e46" class="outline-2">
<h2 id="org3c84e46"><span class="section-number-2">11</span> ES6-ES2015 <a id="org3376ba2">js:es6</a></h2>
<div class="outline-text-2" id="text-11">
<p>
6 stands for 6th edition. 2015 is the year.
ES7-2016, ES8-2017
</p>
</div>

<div id="outline-container-orgbe9d99f" class="outline-3">
<h3 id="orgbe9d99f"><span class="section-number-3">11.1</span> Generator Function</h3>
<div class="outline-text-3" id="text-11-1">
<p>
You can treat each yield is a stop, and later code could be started when gen.next() is called.
You can assign variable = yield (async requests) and program like they are normal sync. Refer to last example
Refer to <a href="#org6b1ebce">nodejs:co</a> for yielding promises
</p>
<pre class="example">
function* idMaker() {
  var index = 0;
  while (index &lt;3)
    yield index++;
}

var gen = idMaker();
// Generator function is not contructable
// don't use var gen = new idMaker;
// When GF is called, an iterator object is returned and 
// the body is not executed yet.

console.log(gen.next().value);
// when the iterator's next() is called for the first time, 
// the GF body is executed until the 1st yield expression
// when it's called the nth time, the nth yield expression is called.

// Say there are 3 yields in total, when gen.next() is called the 4th time or more
// it will be {value: undefined, done: true}

// Use GF in another GF
function* anotherGenerator(i) {
  var index = 0;
  while (index &lt; 3) {
    index++;
    yield i + index;
  }
}
function* generator(i) {
  yield i;
  yield* anotherGenerator(i);
  yield i + 10;
}
var gen2 = generator(10);
console.log(gen2.next().value); // ...
// 10, 11, 12, 13, 20, done
</pre>

<p>
Passing variable in next(). The variable passed will subsitute the whole yield statement for the previous iteration.
(after the previous yield, and before the next/current yield)
</p>
<pre class="example">
function* consumer(){
  while (true){
    var val = yield null;
    console.log('Got value', val);
  }
}

var c = consumer();
c.next(1)
// No 'Got value'
c.next(2)
// Got value 2
</pre>

<p>
Usage
Without GF, you will write
</p>
<pre class="example">
fs.readFile('blog_post_template.html', function(err, tpContent){
  fs.readFile('my_blog_post.md', function(err, mdContent){
    console.log(tpContent, mdContent);
  });
});
</pre>

<p>
With GF
</p>
<pre class="example">
function readFile(filepath) {
  return function(callback) {
    fs.readFile(filepath, callback);
  }
}

function run(genfun) {
  var gen = genfun();

  function next(err, answer) {
    var res;
    if (err) {
      return gen.throw(err);
    }
    else {
      res = gen.next(answer);
    }

    if (!res.done) {
      res.value(next);
    }
  }

  next();

}

run(function* () {
  try{
    var tpContent = yield readFile('blog_post_template.html');
    var mdContent = yield readFile('my_blog_post.md');
    console.log(tpContent, mdContent);
  }catch(e){
    console.error(e.message);
  }
});
</pre>
</div>
</div>

<div id="outline-container-org2b7fd14" class="outline-3">
<h3 id="org2b7fd14"><span class="section-number-3">11.2</span> async/await <a id="org4617f13">js:async/await</a></h3>
<div class="outline-text-3" id="text-11-2">
<p>
async function returns AsyncFunction object which is Promise.resolve. 
</p>

<p>
await one and only one Promise.
</p>

<p>
To wait for all promises to finish, use Promise.all
</p>

<pre class="example">
function resolveAfter2Seconds(x) {
  return new Promise(resolve =&gt; {
    setTimeout(() =&gt; {
      resolve(x);
    }, 2000);
  });
}


async function add1(x) {
  // start and await Promise in order
  const a = await resolveAfter2Seconds(20);
  const b = await resolveAfter2Seconds(30);
  return x + a + b;
}

add1(10).then(v =&gt; {
  console.log(v);  // prints 60 after 4 seconds.
});


async function add2(x) {
  // start Promise all together
  const p_a = resolveAfter2Seconds(20);
  const p_b = resolveAfter2Seconds(30);
  // await each Promise
  return x + await p_a + await p_b;
}

add2(10).then(v =&gt; {
  console.log(v);  // prints 60 after 2 seconds.
});
</pre>
</div>
</div>
</div>

<div id="outline-container-orga78c279" class="outline-2">
<h2 id="orga78c279"><span class="section-number-2">12</span> NodeJS</h2>
<div class="outline-text-2" id="text-12">
</div>
<div id="outline-container-orgf66126e" class="outline-3">
<h3 id="orgf66126e"><span class="section-number-3">12.1</span> Install on Ubuntu</h3>
<div class="outline-text-3" id="text-12-1">
<pre class="example">
apt-get update
apt-get install build-essential libssl-dev
</pre>

<p>
Get <a href="https://github.com/creationix/nvm/releases">nvm version number</a> 0.33.1, Node Version Manager
</p>
<pre class="example">
cd ~
curl -sL https://raw.githubusercontent.com/creationix/nvm/v0.33.1/install.sh -o install_nvm.sh
# check the install script
nano install_nvm.sh
bash install_nvm.sh
</pre>

<p>
Directory ~/.nvm and ~/.profile file are created.
</p>

<p>
Log out and back again or source the file so that current session knows changes
<code>source ~/.profile</code>
</p>

<p>
List Node.js available versions <code>nvm ls-remote</code>
</p>
<pre class="example">
nvm install 7.1.0
nvm use 7.1.0

# What versions are installed
nvm ls

# Current in-use node version
node -v

# Make one version as default for new sessions
nvm alias default 6.10.2

# Use the default version
nvm use default
</pre>

<p>
<a href="https://github.com/nodejs/LTS">https://github.com/nodejs/LTS</a>
</p>
</div>
</div>

<div id="outline-container-org9603ac5" class="outline-3">
<h3 id="org9603ac5"><span class="section-number-3">12.2</span> Install on Windows</h3>
<div class="outline-text-3" id="text-12-2">
<p>
Download the .msi and install with NPM. Installation path: <code>C:\Program Files\nodejs\</code>
Download the latest .msi to upgrade. And upgrade any existing global packages.
</p>

<p>
Refer to <a href="#orgac0548b">phpstorm:nodejs</a>
</p>
</div>
</div>

<div id="outline-container-orgbfc183e" class="outline-3">
<h3 id="orgbfc183e"><span class="section-number-3">12.3</span> Basic</h3>
<div class="outline-text-3" id="text-12-3">
<p>
Modules installed globally usually have an executable command for direct use. If installed locally, usually run ./node_modules/module_name/bin/exec_cmd
</p>

<pre class="example">
node -v
npm -v

npm cache clean

// Install npm package to ./node_modules
npm install express

// Install package globally (available to other projects using the same Node.js version)
// ~/.nvm/node_version/lib/node_modules/package_name
npm install -g gulp

// What packages/modules are installed globally, just remove -g for locally
npm ls -g

// Check which global packages are outdated
npm outdated -g

// Update all global packages. Some global package update requires removing first
npm update -g

// Update one global package
npm install -g &lt;packagename&gt;

// Remove a package globally, just remove -g for locally
npm remove async -g
</pre>

<p>
Link
</p>
<pre class="example">
// run npm link alone in local repo is to create a symlink in global folder that links to the package where the command was executed
cd ~/projects/node-redis # Note local package name is not node-redis but redis as in ~/projects/node-redis/package.json
npm link # create symlink in global folder so that redis can be globally referrenced/linked.

cd ~/projects/node-bloggy # go to another project
npm link redis # install redis package in ~/projects/node-bloggy/node_modules/node-redis, file changes in ~/projects/node-redis/ will be reflected.

npm link express # a global package can be linked inside any local repo
</pre>
</div>
</div>

<div id="outline-container-org8fa4c87" class="outline-3">
<h3 id="org8fa4c87"><span class="section-number-3">12.4</span> Global Object</h3>
<div class="outline-text-3" id="text-12-4">
<p>
console.log is actually global.console.log
<a href="https://nodejs.org/api/globals.html">https://nodejs.org/api/globals.html</a>
</p>
</div>

<div id="outline-container-org1f14a83" class="outline-4">
<h4 id="org1f14a83"><span class="section-number-4">12.4.1</span> __dirname, __filename</h4>
<div class="outline-text-4" id="text-12-4-1">
<p>
Full path of the directory/file of the current module/file
</p>
</div>
</div>

<div id="outline-container-orga8ad78e" class="outline-4">
<h4 id="orga8ad78e"><span class="section-number-4">12.4.2</span> console <a id="org15ff188">nodejs:console</a></h4>
<div class="outline-text-4" id="text-12-4-2">
<p>
Backtick
</p>
<pre class="example">
var a = "World";
console.log(`Hello ${a}`); // Hello World
</pre>

<p>
console.dir(obj[, options]) uses util.inspect()
</p>
<pre class="example">
showHidden &lt;bool&gt; true
depth &lt;number&gt; 2, can be null
colors &lt;bool&gt; false
</pre>
</div>
</div>

<div id="outline-container-orgd23c6f0" class="outline-4">
<h4 id="orgd23c6f0"><span class="section-number-4">12.4.3</span> process</h4>
<div class="outline-text-4" id="text-12-4-3">
</div>
<div id="outline-container-orgbc9c284" class="outline-5">
<h5 id="orgbc9c284"><span class="section-number-5">12.4.3.1</span> process.argv</h5>
<div class="outline-text-5" id="text-12-4-3-1">
<p>
node app.js &#x2013;user li &#x2013;greeting "Good Day Sir"
console.log(process.argv);
//['nodejs installation full path', 'full path to module', '&#x2013;user', 'li', '&#x2013;greeting', 'Good Day Sir']
</p>

<pre class="example">
function grab(flag) {
  var index = process.argv.indexOf(flag);
  return (index === 01) ? null : process.argv[index+1];
}

var greeting = grab('--greeting');
</pre>
</div>
</div>

<div id="outline-container-org806a5eb" class="outline-5">
<h5 id="org806a5eb"><span class="section-number-5">12.4.3.2</span> stdout</h5>
<div class="outline-text-5" id="text-12-4-3-2">
<pre class="example">
var q = ['Q1', 'Q2'];
var a = [];
function ask(i) {
  process.stdout.write(`\n\n ${q[i]}`);
  process.stdout.write(' &gt; ');
}

process.stdin.on('data', function(data) {
  answers.push(data.toString().trim());
  if (a.length &lt; q.length) {
    ask(a.length);
  }
  else {
    process.exit();
  }
});

process.on('exit', function() {
  process.stdout.write(`${a[0]}, ${a[1]}, ${a[2]}`);
});

ask(0);
</pre>
</div>
</div>
</div>

<div id="outline-container-org535f8b6" class="outline-4">
<h4 id="org535f8b6"><span class="section-number-4">12.4.4</span> module</h4>
<div class="outline-text-4" id="text-12-4-4">
<pre class="example">
// ./lib/Person.js
// some code
module.exports = Person;
// literal object or any Javascript type
// module.exports is the object that is returned by the require statement

// ./app.js
var Person = require('./lib/Person'); // do not include .js
var ben = new Person('Ben');
var george = new Person('George');
</pre>
</div>
</div>

<div id="outline-container-org5f4326b" class="outline-4">
<h4 id="org5f4326b"><span class="section-number-4">12.4.5</span> Timing</h4>
<div class="outline-text-4" id="text-12-4-5">
<pre class="example">
var currentTime = 0;
var percentWaited = 0;

function writePercent(p) {
  process.stdout.clearLine();
  process.stdout.cursorTo(0);
  process.stdout.write(`waiting ... ${p}%`);
}

var interval = setInterval(functino() {
  currentTime += 500;
  percentWaited = Math.floor((currentTime/3000) * 100);
  writePercent(percentWaited);
}, 500);

setTimeout(function() {
  clearInterval(interval);
  writePercent(100);
  console.log("\n\n done \n\n");
}, 3000);

writePercent(percentWaited);
</pre>
</div>
</div>
</div>

<div id="outline-container-org018c15e" class="outline-3">
<h3 id="org018c15e"><span class="section-number-3">12.5</span> Modules, Packages, Frameworks</h3>
<div class="outline-text-3" id="text-12-5">
</div>
<div id="outline-container-org801f325" class="outline-4">
<h4 id="org801f325"><span class="section-number-4">12.5.1</span> Get version</h4>
<div class="outline-text-4" id="text-12-5-1">
<p>
<code>npm list</code> for locally installed packages
<code>npm list -g</code> for globally installed packages
<code>npm list -g --depth=0</code> global installed packages at first level
<code>npm list express</code>
<code>npm view PKG_NAME versions --json</code> The latest available version of a package
view aliaes: info, show, v
</p>

<p>
Distribution tags :: <code>npm view mjml dist-tags</code>
</p>
<dl class="org-dl">
<dt>latest</dt><dd>no pre-release/beta versions</dd>
<dt>beta</dt><dd>optional</dd>
<dt>future</dt><dd>optional</dd>
<dt>next</dt><dd>usually is set to a beta version to be the next version</dd>
</dl>

<p>
Backup and remove the node_modules and run <code>npm install mjml@next</code>
</p>

<p>
Update npm <code>sudo npm i -g npm</code>
</p>

<p>
npm i -D :: npm install &#x2013;save-dev gulp-imagemin
</p>

<p>
Npm website for a package gulp-sourcemaps
<a href="https://www.npmjs.com/package/gulp-sourcemaps">https://www.npmjs.com/package/gulp-sourcemaps</a>
</p>
</div>
</div>

<div id="outline-container-org8099fc5" class="outline-4">
<h4 id="org8099fc5"><span class="section-number-4">12.5.2</span> Update Package</h4>
<div class="outline-text-4" id="text-12-5-2">
<p>
<code>npm outdated -l</code> Show if there're updates for locally installed packages based on package.json in &#x2013;long format
<code>npm outdated --global</code> for globally installed packages
</p>
<ul class="org-ul">
<li>Current</li>
<li id="Wanted">it may be higher than Latest as it's next in dist-tags above</li>
<li id="Latest">same as latest in dist-tags above</li>
</ul>

<p>
A package is outdated when its Current is lower than Latest. It'll update to Latest. If Current is higher than Latest, then it'll be downgraded. 
</p>

<p>
npm update :: updates all outdated "dependencies" in package.json and change package.json to save the new version as the minimum required dependency.
npm update &#x2013;dev :: updates all outdated "dependencies" and "devDependencies" in package.json
npm update sharp :: update a local package to the latest
</p>
</div>
</div>

<div id="outline-container-org67718d6" class="outline-4">
<h4 id="org67718d6"><span class="section-number-4">12.5.3</span> Global package and Scoped package</h4>
<div class="outline-text-4" id="text-12-5-3">
<p>
npm install -g @angular/cli
@ indicates angular/cli is a scoped package. 
Without @, package is installed in <code>node_modules/packagename</code>
Scoped package is installed in <code>node_modules/@angular/cli</code>
Thus, scoped package can group packages under one namespace
</p>

<pre class="example">
// package.json
"dependencies": {
  "@angular/cli": "^1.3.0"
}

// In code
require('@angular/cli')
</pre>
</div>
</div>

<div id="outline-container-org37aa67b" class="outline-4">
<h4 id="org37aa67b"><span class="section-number-4">12.5.4</span> Peer dependencies</h4>
<div class="outline-text-4" id="text-12-5-4">
<p>
A dependency says "I need this thing directly available to me"
A peerDependency says "If you want to use me, you need this ting available to you"
</p>

<p>
However, as of verison 3, npm does not install packages listed in peerDependencies sections.
</p>

<p>
But npm issues a warning when
</p>
<ul class="org-ul">
<li>When any peer dependencies are missing</li>
<li>or when the application or any of its other dependencies installs a different version of a peer dependency.</li>
</ul>

<p>
It is your job to copy all peer dependency packages to devDependencies to install them.
</p>

<p>
For example, you app depends on angular and your app doesn't have peerDependencies. However, angular has peerDependencies.
</p>

<p>
You will make sure to list any angular's peerDependencies into your app's devDepenedencies 
</p>
</div>
</div>

<div id="outline-container-org2cba9a1" class="outline-4">
<h4 id="org2cba9a1"><span class="section-number-4">12.5.5</span> v8</h4>
<div class="outline-text-4" id="text-12-5-5">
<pre class="example">
var v8 = require('v8');
console.log('v8.getHeapStatistics()');
</pre>
</div>
</div>

<div id="outline-container-org05aa363" class="outline-4">
<h4 id="org05aa363"><span class="section-number-4">12.5.6</span> npx <a id="org2df5d79">npm:npx</a></h4>
<div class="outline-text-4" id="text-12-5-6">
<p>
Run &lt;command&gt; either from a local ./node_modules/.bin, or from a central cache, installing any packages needed in order for &lt;command&gt; to run.
</p>

<p>
By default, npx will check whether &lt;command&gt; exists in $PATH, or in the local project binaries, and execute that. If &lt;command&gt; is not found, it will be installed prior to execution.
</p>

<pre class="example">
npm i -g npx

# usage
npx [options] &lt;command&gt;[@version] [command-arg]...

npx [options] [-p|--package &lt;pkg&gt;]... &lt;command&gt; [command-arg]...

npx [options] -c '&lt;command-string&gt;'

npx --shell-auto-fallback [shell]
</pre>
</div>
</div>

<div id="outline-container-orgf20648e" class="outline-4">
<h4 id="orgf20648e"><span class="section-number-4">12.5.7</span> readline</h4>
<div class="outline-text-4" id="text-12-5-7">
<pre class="example">
var readline = require('readline');
var rl = readline.createInterface(process.stdin, process.stdout);
var aPerson = {
  name: '',
  sayings: []
}

rl.question("What is the name of a real person? ", function(a) {
  aPerson.name = a;
  rl.setPrompt(`What would ${aPerson.name} say? `);
  rl.prompt(); // display prompt
  rl.on('line', function(saying) {
    aPerson.sayings.push(saying.trim());
    if (saying.toLowerCase().trim() === 'exit') {
      rl.close();
    }
    else {
      rl.setPrompt(`What else would ${aPerson.name} say?  ('exit' to leave) `);
      rl.prompt();
    }

  });
});

rl.on('close', function() {
  console.log("5s is a real person that says %j", aPerson.name, aPerson.sayings);
  process.exit();
});
</pre>
</div>
</div>

<div id="outline-container-org49750a8" class="outline-4">
<h4 id="org49750a8"><span class="section-number-4">12.5.8</span> events</h4>
<div class="outline-text-4" id="text-12-5-8">
<pre class="example">
var events = require('events');
var emitter = new events.EventEmitter();

emitter.on('customEvent', function(msg, status) {
  console.log(`${status}: ${msg}`);
});

emitter.emit('customEvent', "Hello", 200);
</pre>
</div>
</div>

<div id="outline-container-orgfd98d3d" class="outline-4">
<h4 id="orgfd98d3d"><span class="section-number-4">12.5.9</span> util (native)</h4>
<div class="outline-text-4" id="text-12-5-9">
<pre class="example">
var EventEmitter = require('events').EventEmitter;
const util = require('util');
var Person = function(name) {
  this.name = name;
};

util.inherits(Person, EventEmitter);
// Add EventEmitter to Person's prototype
// Person inherits all from EventEmitter

var ben = new Person("Ben");

ben.on('speak', function(said) {
  console.log(`${this.name} said ${said}`);
});

ben.emit('speak', "I'm Ben");

// fully print an object
console.log(util.inspect(myObj, {showHidden: false, depth: null}));
// or this for short
cosole.log(util.inspect(myObj, false, null));
// console.dir actually uses util.inspect. See nodejs:console

util.format('%s:%s', 'foo'); // 'foo:%s'
util.format('%s:%s', 'foo', 'bar', 'baz'); 
// extra arguments are coerced into strings delimited by a space 
// 'foo:bar baz'
// %s &gt; string, %d &gt; integer or floating point value
// %i &gt; integer, %f &gt; floating point value
// %j &gt; JSON
// %% &gt; percent sign '%'
</pre>
</div>
</div>

<div id="outline-container-org8e3664f" class="outline-4">
<h4 id="org8e3664f"><span class="section-number-4">12.5.10</span> lodash</h4>
<div class="outline-text-4" id="text-12-5-10">
<pre class="example">
# npm i -g npm
npm i --save lodash

var _ = require('lodash');

var users = [
  { 'user': 'barney',  'age': 36, 'active': true },
  { 'user': 'fred',    'age': 40, 'active': false },
  { 'user': 'pebbles', 'age': 1,  'active': true }
];

_.find(users, function(o) { return o.age &lt; 40; });
// =&gt; object for 'barney'

// The `_.matches` shorthand.
_.find(users, { 'age': 1, 'active': true });
// =&gt; object for 'pebbles'

// The `_.matchesProperty` shorthand.
_.find(users, ['active', false]);
// =&gt; object for 'fred'

// The `_.property` shorthand.
_.find(users, 'active');
// =&gt; object for 'barney'

var user = _.findIndex(users, {id: req.params.id});
var update = req.body;
if (update.id) {
  delete update.id;
}

if (!users[user]) {
  res.send('user not found');
}
else {
  var updatedUser = _.assign(users[user], update);
  // merge multiple objects from left to right for enumerable string keyed properties
  res.json(updatedUser);
}
</pre>
</div>

<div id="outline-container-org9b8f0de" class="outline-5">
<h5 id="org9b8f0de"><span class="section-number-5">12.5.10.1</span> _.identity(value)</h5>
<div class="outline-text-5" id="text-12-5-10-1">
<p>
returns the first argument it receives
</p>

<p>
var object = { 'a': 1 };
console.log(_.identity(object) <code>=</code> object); // =&gt; true
</p>
</div>
</div>

<div id="outline-container-org7b09983" class="outline-5">
<h5 id="org7b09983"><span class="section-number-5">12.5.10.2</span> _.matches(source)</h5>
<div class="outline-text-5" id="text-12-5-10-2">
<p>
creates a function that performs a partical deep comparison between a given object and source, return true if the given object has equivalent prop values, else false.
Partial comparisons will match empty array and empty object source values against any array or object value, respectively.
</p>

<pre class="example">
var objects = [
  { 'a': 1, 'b': 2, 'c': 3 },
  { 'a': 4, 'b': 5, 'c': 6 }
];

_.filter(objects, _.matches({ 'a': 4, 'c': 6 }));
// =&gt; [{ 'a': 4, 'b': 5, 'c': 6 }]
</pre>
</div>
</div>

<div id="outline-container-org6d13fe4" class="outline-5">
<h5 id="org6d13fe4"><span class="section-number-5">12.5.10.3</span> _.find, _.findLast</h5>
<div class="outline-text-5" id="text-12-5-10-3">
<p>
Return the first element that the predicate function returns true.
</p>
<pre class="example">
_.find(collection, [predicate=_.identity], [fromIndex=0])
_.findLast(collection, [predicate=_.identity], [fromIndex=collection.length-1])

// Predicate function is passed with (value, index|key, collection)

var users = [
  { 'user': 'barney',  'age': 36, 'active': true },
  { 'user': 'fred',    'age': 40, 'active': false },
  { 'user': 'pebbles', 'age': 1,  'active': true }
];

_.find(users, function(o) { return o.age &lt; 40; });
// =&gt; object for 'barney'

// The `_.matches` iteratee shorthand.
_.find(users, { 'age': 1, 'active': true });
// =&gt; object for 'pebbles'

// The `_.matchesProperty` iteratee shorthand.
_.find(users, ['active', false]);
// =&gt; object for 'fred'

// The `_.property` iteratee shorthand.
_.find(users, 'active');
// =&gt; object for 'barney'
</pre>
</div>
</div>

<div id="outline-container-orga1f254c" class="outline-5">
<h5 id="orga1f254c"><span class="section-number-5">12.5.10.4</span> _.iteratee</h5>
<div class="outline-text-5" id="text-12-5-10-4">
<p>
Creates a function that invokes func with the arguments of the created function.
func is
</p>
<dl class="org-dl">
<dt>a property name</dt><dd>the created function returns the prop value for a given element.</dd>
</dl>

<pre class="example">
_.iteratee([func=_.identity])

var users = [
  { 'user': 'barney', 'age': 36, 'active': true },
  { 'user': 'fred',   'age': 40, 'active': false }
];

// The `_.matches` iteratee shorthand.
_.filter(users, _.iteratee({ 'user': 'barney', 'active': true }));
// =&gt; [{ 'user': 'barney', 'age': 36, 'active': true }]

// The `_.matchesProperty` iteratee shorthand.
_.filter(users, _.iteratee(['user', 'fred']));
// =&gt; [{ 'user': 'fred', 'age': 40 }]

// The `_.property` iteratee shorthand.
_.map(users, _.iteratee('user'));
// =&gt; ['barney', 'fred']

// Create custom iteratee shorthands.
_.iteratee = _.wrap(_.iteratee, function(iteratee, func) {
  return !_.isRegExp(func) ? iteratee(func) : function(string) {
    return func.test(string);
  };
});

_.filter(['abc', 'def'], /ef/);
// =&gt; ['def']
</pre>
</div>
</div>

<div id="outline-container-orgaf030b5" class="outline-5">
<h5 id="orgaf030b5"><span class="section-number-5">12.5.10.5</span> _.property(path)</h5>
<div class="outline-text-5" id="text-12-5-10-5">
<p>
Creates a function that returns the value at path of a given object
</p>

<pre class="example">
var objects = [
  { 'a': { 'b': 2 } },
  { 'a': { 'b': 1 } }
];

_.map(objects, _.property('a.b'));
// =&gt; [2, 1]

_.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');
// =&gt; [1, 2]
</pre>
</div>
</div>
</div>

<div id="outline-container-org13640c1" class="outline-4">
<h4 id="org13640c1"><span class="section-number-4">12.5.11</span> child_process</h4>
<div class="outline-text-4" id="text-12-5-11">
<p>
Exec is for short process
</p>
<pre class="example">
var exec = require('child_process').exec;
exec('ls', function(err, stdout) {
  if (err) throw err;
  console.log(stdout);
});
</pre>

<p>
Spawn for ongoing process
</p>
<pre class="example">
var spawn = require('child_process').spawn;
var cp = spawn('node', ["app"]); // node app
cp.stdout.on("data", function(data) {
  // Output child process stdout
  console.log(`STDOUT: ${data.toString()}`);
});

cp.on("close", function() {
  console.log("Child process has ended.");
  process.exit();
});

setTimeout(function() {
  // maximum run time
  cp.stdin.write("stop");
}, 4000);
</pre>
</div>
</div>

<div id="outline-container-org85cd474" class="outline-4">
<h4 id="org85cd474"><span class="section-number-4">12.5.12</span> gulp <a id="org63954af">npm:gulp</a></h4>
<div class="outline-text-4" id="text-12-5-12">
<p>
<a href="https://github.com/gulpjs/gulp/blob/master/docs/README.md">https://github.com/gulpjs/gulp/blob/master/docs/README.md</a>
</p>

<p>
If gulp was previously globally installed, remove it before installing gulp-cli
</p>
<pre class="example">
npm rm --global gulp
npm install --global gulp-cli
gulp -v

// 2.0.1
</pre>

<p>
Then install gulp locally
</p>
<pre class="example">
npm install --save-dev gulp@next
</pre>

<p>
Gulp plugins :: <a href="https://gulpjs.com/plugins/">https://gulpjs.com/plugins/</a> <a href="https://github.com/alferov/awesome-gulp">https://github.com/alferov/awesome-gulp</a>
</p>
</div>

<div id="outline-container-org8b6c2ba" class="outline-5">
<h5 id="org8b6c2ba"><span class="section-number-5">12.5.12.1</span> Example</h5>
<div class="outline-text-5" id="text-12-5-12-1">
<p>
<code>gulp</code> runs the default task.
gulp &lt;task&gt; &lt;othertask&gt;
</p>

<pre class="example">
npm install gulp-util --save-dev
npm install gulp-coffee --save-dev
npm install gulp-concat --save-dev
npm install gulp-browserify --save-dev
npm install gulp-compass --save-dev
npm install jquery --save-dev
npm install mustache --save-dev

// gulpfile.js
var gulp=require('gulp'),
    gutil = require('gulp-util'),
    coffee = require('gulp-coffee'),
    browserify = require('gulp-browserify'),
    compase = require('gulp-compass'),
    concat = require('gulp-concat');

// run ~gulp~ will run this task
gulp.task('default', function() {
  console.log('hello from gulp');
});

// gulp-util, run ~gulp log~
gulp.task('log', function() {
  gutil.log('Workflow starts');
});

var coffeeSources = ['components/coffee/tagline.coffee'];
var jsSources = [
  'components/scripts/1.js',
  'components/scripts/2.js'
];
var sassSources = ['components/sass/style.scss'];

gulp.task('coffee', function() {
  gulp.src(coffeeSources)
      .pipe(coffee({ bare: true })
         .on('error', gutil.log))
      .pipe(gulp.dest('components/scripts'));
});

gulp.task('js', ['coffee'], function() {
  gulp.src(jsSources)
      .pipe(concat('script.js'))
      .pipe(gulp.dest('builds/development/js'));
});

gulp.task('compass', function() {
  gulp.src(sassSources)
      .pipe(compoass({
            sass: 'components/sass',
            image: 'builds/development/images',
            style: 'expanded'
         })
         .on('error', gutil.log)
      )
      .pipe(gulp.dest('builds/development/css'));
});

gulp.task('watch', function() {
  gulp.watch(coffeeSources, ['coffee']);
});
</pre>
</div>
</div>

<div id="outline-container-orgf0d441a" class="outline-5">
<h5 id="orgf0d441a"><span class="section-number-5">12.5.12.2</span> gulp.src</h5>
<div class="outline-text-5" id="text-12-5-12-2">
<p>
gulp.src(globs[, options])
</p>

<p>
globs :: string or array. <a href="https://github.com/isaacs/node-glob">node-glob</a>
</p>
<pre class="example">
// negate can be used
['client/*.js', '!client/b*.js', 'client/bad.js']
</pre>

<p>
options :: options to pass to node-glob.
</p>

<pre class="example">
some/path/example/app/js/app.js
some/path/example/vendor/js/vendor.js
some/path/example/vendor/lib/js/lib.js

gulp.src('some/path/**/js/*.js')
  .pipe(gulp.dest('output'));

// base is anything before the first ** which is some/path
// result

output/example/app/js/app.js
output/example/vendor/js/vendor.js
output/example/vendor/lib/js/lib.js

// hard set base
gulp.src('some/path/**/js/*.js', {base:'.'})
  .pipe(gulp.dest('output'));

// result
output/some/path/example/app/js/app.js
output/some/path/example/vendor/js/vendor.js
output/some/path/example/vendor/lib/js/lib.js
</pre>

<p>
Only one option:base is possible for an array of files
</p>
<pre class="example">
gulp.src(
  ['source1/examples/**/*.html',
   'source2/examples/**/*.html'],
  { base: ['source1/', 'source2/']}   // Doesn't work. Needs to be a string.
).pipe(gulp.dest('dist'));
</pre>

<p>
Instead, do this
</p>
<pre class="example">
var merge = require('merge-stream');

gulp.task('default', function() {
  merge(gulp.src('source1/examples/**/*.html', {base: 'source1/'}),
        gulp.src('source2/examples/**/*.html', {base: 'source2/'}))
   .pipe(gulp.dest('dist'));
});
</pre>

<p>
option:cwd :: current working directory
</p>
</div>
</div>

<div id="outline-container-org5a177e2" class="outline-5">
<h5 id="org5a177e2"><span class="section-number-5">12.5.12.3</span> gulp-rename</h5>
<div class="outline-text-5" id="text-12-5-12-3">
<pre class="example">
var rename = require("gulp-rename");

// rename via string
gulp.src("./src/main/text/hello.txt")
  .pipe(rename("main/text/ciao/goodbye.md"))
  .pipe(gulp.dest("./dist")); // ./dist/main/text/ciao/goodbye.md

// rename via function
gulp.src("./src/**/hello.txt")
  .pipe(rename(function (path) {
    path.dirname += "/ciao";
    path.basename += "-goodbye";
    path.extname = ".md";
  }))
  .pipe(gulp.dest("./dist")); // ./dist/main/text/ciao/hello-goodbye.md

// rename via hash
gulp.src("./src/main/text/hello.txt", { base: process.cwd() })
  .pipe(rename({
    dirname: "main/text/ciao",
    basename: "aloha",
    prefix: "bonjour-",
    suffix: "-hola",
    extname: ".md"
  }))
  .pipe(gulp.dest("./dist")); // ./dist/main/text/ciao/bonjour-aloha-hola.md
</pre>

<p>
Rename dest file name
Any source *-gulp.css will have dest file *-gulp-build.css
</p>
<pre class="example">
var gulp = require('gulp');

gulp.task('autoprefixer', function () {
  var postcss = require('gulp-postcss');
  var sourcemaps = require('gulp-sourcemaps');
  var rename = require('gulp-rename');
  var autoprefixer = require('autoprefixer');

  return gulp.src('**/*-gulp.css', {base: '.'})
    .pipe(sourcemaps.init())
    .pipe(postcss([autoprefixer()]))
    .pipe(sourcemaps.write('.'))
    .pipe(rename(function (path) {
      path.basename += '-build';
    }))
    .pipe(gulp.dest('.'));
});
</pre>
</div>
</div>

<div id="outline-container-org832c284" class="outline-5">
<h5 id="org832c284"><span class="section-number-5">12.5.12.4</span> gulp-sourcemaps</h5>
<div class="outline-text-5" id="text-12-5-12-4">
<p>
<a href="https://www.npmjs.com/package/gulp-sourcemaps">https://www.npmjs.com/package/gulp-sourcemaps</a>
</p>

<pre class="example">
var gulp = require('gulp');
var plugin1 = require('gulp-plugin1');
var plugin2 = require('gulp-plugin2');
var sourcemaps = require('gulp-sourcemaps');

gulp.task('javascript', function() {
  gulp.src('src/**/*.js')
    .pipe(sourcemaps.init())
      .pipe(plugin1())
      .pipe(plugin2())
    .pipe(sourcemaps.write())
    .pipe(gulp.dest('dist'));
});
</pre>
</div>
</div>

<div id="outline-container-orga36dc27" class="outline-5">
<h5 id="orga36dc27"><span class="section-number-5">12.5.12.5</span> gulp-postcss <a id="org0b6ad20">npm:gulp-postcss</a> <a href="https://github.com/postcss/gulp-postcss">Doc</a></h5>
<div class="outline-text-5" id="text-12-5-12-5">
<p>
npm i -D autoprefixer
npm i -D gulp-postcss
</p>

<pre class="example">
gulp.task('autoprefixer', function () {
  var postcss      = require('gulp-postcss');
  var sourcemaps   = require('gulp-sourcemaps');
  var autoprefixer = require('autoprefixer');

  return gulp.src('./src/*.css')
    .pipe(sourcemaps.init())
    .pipe(postcss([ autoprefixer() ]))
    .pipe(sourcemaps.write('.'))
    .pipe(gulp.dest('./dest'));
});
</pre>

<p>
Load multiple PostCSS plugins, refer to <a href="#org62d46f0">npm:autoprefixer</a> for options
</p>
<pre class="example">
var postcss = require('gulp-postcss');
var gulp = require('gulp');
var autoprefixer = require('autoprefixer');
var cssnano = require('cssnano');

gulp.task('css', function () {
    var plugins = [
        autoprefixer({browsers: ['last 1 version']}),
        cssnano()
    ];
    return gulp.src('./src/*.css')
        .pipe(postcss(plugins))
        .pipe(gulp.dest('./dest'));
});
</pre>
</div>

<ol class="org-ol">
<li><a id="org1e317b5"></a><a href="#org93e38c9">npm:postcss:options</a><br /></li>
</ol>
</div>
<div id="outline-container-org00ed5f1" class="outline-5">
<h5 id="org00ed5f1"><span class="section-number-5">12.5.12.6</span> gulp-responsive</h5>
<div class="outline-text-5" id="text-12-5-12-6">
<p>
<a href="https://github.com/mahnunchik/gulp-responsive">https://github.com/mahnunchik/gulp-responsive</a>
</p>
</div>

<ol class="org-ol">
<li><a id="org6d430c5"></a>Installation<br />
<div class="outline-text-6" id="text-12-5-12-6-1">
<p>
Requires global <a href="#org4fee16c">node-gyp</a> and dev dependency is sharp
</p>

<pre class="example">
npm install --save-dev gulp-responsive

// you may need to run this if there is still error, but I didn't need it
// npm -g install npm@latest
// https://github.com/lovell/sharp/issues/615
</pre>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgcf70fbc" class="outline-5">
<h5 id="orgcf70fbc"><span class="section-number-5">12.5.12.7</span> gulp-imagemin</h5>
<div class="outline-text-5" id="text-12-5-12-7">
<p>
<a href="https://www.npmjs.com/package/gulp-imagemin">https://www.npmjs.com/package/gulp-imagemin</a>
</p>

<p>
npm i -D gulp-imagemin
</p>

<p>
Come with 4 lossless plugins gifsicle, jpegtran, optipng, svgo
</p>
</div>
</div>

<div id="outline-container-org1176781" class="outline-5">
<h5 id="org1176781"><span class="section-number-5">12.5.12.8</span> gulp-svg-sprite</h5>
<div class="outline-text-5" id="text-12-5-12-8">
<p>
<a href="https://github.com/jkphl/svg-sprite">https://github.com/jkphl/svg-sprite</a>
<a href="https://github.com/jkphl/gulp-svg-sprite">https://github.com/jkphl/gulp-svg-sprite</a>
</p>

<p>
npm i -D gulp-svg-sprite
</p>

<p>
There're 5 modes :: css, view, defs, symbol, stack
</p>
</div>
</div>
</div>

<div id="outline-container-org527cd8d" class="outline-4">
<h4 id="org527cd8d"><span class="section-number-4">12.5.13</span> grunt</h4>
<div class="outline-text-4" id="text-12-5-13">
<p>
Install grunt globally and locally
</p>
<pre class="example">
npm install grunt-cli -g
npm install grunt-cli --save-dev

npm install grunt-contrib-jshint --save-dev
npm install grunt-contrib-less --save-dev
npm install grunt-autoprefixer --save-dev
npm install grunt-browserify --save-dev
npm install grunt-contrib-watch --save-dev

npm install jquery

// GruntFile.js
module.exports = function(grunt) {

  grunt.initConfig({
    jshint: {
      files: ["*.js", "lib/*.js", "test/*.js"],
      options: {
        esnext: true,
        globals: {
          jQuery: true
        }
      }
    },
    less: {
      production: {
        files: {
          "public/css/style.css": ["less/*.less"]
        }
      }
    },
    autoprefixer: {
      single_file: {
        src: "public/css/style.css",
        dest: "public/css/style.css"
      }
    },
    browserify: {
      client: {
        src: ["app-client.js"],
        dest: "public/js/bundle.js"
      }
    },
    watch: {
      css: {
        files: ["less/*.less"],
        tasks: ["css"]
      },
      scripts: {
        files: ["app-client.js", "lib/*.js"],
        tasks: ["jshint", "browserify"]
      }
    }
  });

  grunt.loadNpmTasks("grunt-contrib-jshint");
  grunt.loadNpmTasks("grunt-contrib-less");
  grunt.loadNpmTasks("grunt-autoprefixer");
  grunt.loadNpmTasks("grunt-browserify");
  grunt.loadNpmTasks("grunt-contrib-watch");

  grunt.registerTask("css", ["less", "autoprefixer"]);
  grunt.registerTask("js", ["browserify"]);

  grunt.registerTask("default", ["jshint", "css", "js"]);
};

// ./app-client.js
var $ = require("jquery");
var printTerms = require("./lib/printTerms");

// jQuery code


// run grunt
grunt

// open another session and run
grunt watch
</pre>
</div>
</div>

<div id="outline-container-org7c1e731" class="outline-4">
<h4 id="org7c1e731"><span class="section-number-4">12.5.14</span> webpack <a id="org412cd27">npm:webpack</a></h4>
<div class="outline-text-4" id="text-12-5-14">
<p>
<a href="https://angular.io/guide/webpack">https://angular.io/guide/webpack</a> <a href="#orge5dfe71">ng:cli:webpack</a>
</p>
</div>
<div id="outline-container-orgfc2b999" class="outline-5">
<h5 id="orgfc2b999"><span class="section-number-5">12.5.14.1</span> Multiple bundles</h5>
<div class="outline-text-5" id="text-12-5-14-1">
<pre class="example">
entry: {
  app: 'src/app.ts',
  vendor: 'src/vendor.ts'
},

output: {
  filename: '[name].js'
}
</pre>
</div>
</div>

<div id="outline-container-org13de5c9" class="outline-5">
<h5 id="org13de5c9"><span class="section-number-5">12.5.14.2</span> Rules</h5>
<div class="outline-text-5" id="text-12-5-14-2">
<pre class="example">
module: {

 rules: [
   {
     test: /\.ts$/,
     loader: 'awesome-typescript-loader'
   },
   {
     test: /\.css$/,
     loaders: 'style-loader!css-loader'
   }
 ]

}
</pre>
</div>
</div>

<div id="outline-container-orgf53a14b" class="outline-5">
<h5 id="orgf53a14b"><span class="section-number-5">12.5.14.3</span> Plugins</h5>
<div class="outline-text-5" id="text-12-5-14-3">
<pre class="example">
const { UglifyJsPlugin } = require('webpack').optimize;

plugins: [
  new UglifyJsPlugin({
    // config options
  })
]
</pre>

<p>
Webpack, the plugins, and the loaders are also installed as packages. They are listed in the updated packages.json.
</p>
</div>
</div>

<div id="outline-container-orgcfc13fb" class="outline-5">
<h5 id="orgcfc13fb"><span class="section-number-5">12.5.14.4</span> resolve</h5>
<div class="outline-text-5" id="text-12-5-14-4">
<p>
Most import statements don't mention the extension. Tell Webpack to resolve extension-less file requests by looking for matching files with .ts extension or .js extension.
</p>
<pre class="example">
"resolve": {
    "extensions": [
      ".ts",
      ".js"
    ],
    "modules": [
      "./node_modules",
      "./node_modules"
    ],
    "symlinks": true
}
</pre>
</div>
</div>

<div id="outline-container-org1a118d6" class="outline-5">
<h5 id="org1a118d6"><span class="section-number-5">12.5.14.5</span> webpack.(common|dev|prod).js</h5>
<div class="outline-text-5" id="text-12-5-14-5">
<p>
webpack.common.js
</p>
<pre class="example">
var webpack = require('webpack');
var HtmlWebpackPlugin = require('html-webpack-plugin');
var ExtractTextPlugin = require('extract-text-webpack-plugin');
var helpers = require('./helpers');

module.exports = {
  entry: {
    'polyfills': './src/polyfills.ts',
    'vendor': './src/vendor.ts',
    'app': './src/main.ts'
  },

  resolve: {
    extensions: ['.ts', '.js']
  },

  module: {
    rules: [
      {
        test: /\.ts$/,
        loaders: [
          {
            loader: 'awesome-typescript-loader',
            options: { configFileName: helpers.root('src', 'tsconfig.json') }
          } , 'angular2-template-loader'
        ]
      },
      {
        test: /\.html$/,
        loader: 'html-loader'
      },
      {
        test: /\.(png|jpe?g|gif|svg|woff|woff2|ttf|eot|ico)$/,
        loader: 'file-loader?name=assets/[name].[hash].[ext]'
      },
      {
        test: /\.css$/,
        exclude: helpers.root('src', 'app'),
        loader: ExtractTextPlugin.extract({ fallbackLoader: 'style-loader', loader: 'css-loader?sourceMap' })
      },
      {
        test: /\.css$/,
        include: helpers.root('src', 'app'),
        loader: 'raw-loader'
      }
    ]
  },

  plugins: [
    // Workaround for angular/angular#11580
    new webpack.ContextReplacementPlugin(
      // The (\\|\/) piece accounts for path separators in *nix and Windows
      /angular(\\|\/)core(\\|\/)@angular/,
      helpers.root('./src'), // location of your src
      {} // a map of your routes
    ),

    new webpack.optimize.CommonsChunkPlugin({
      name: ['app', 'vendor', 'polyfills']
    }),

    new HtmlWebpackPlugin({
      template: 'src/index.html'
    })
  ]
};
</pre>

<p>
webpack.dev.js extends webpack.common.js
</p>
<pre class="example">
var webpackMerge = require('webpack-merge');
var ExtractTextPlugin = require('extract-text-webpack-plugin');
var commonConfig = require('./webpack.common.js');
var helpers = require('./helpers');

module.exports = webpackMerge(commonConfig, {
  devtool: 'cheap-module-eval-source-map',

  output: {
    path: helpers.root('dist'),
    publicPath: '/',
    filename: '[name].js',
    chunkFilename: '[id].chunk.js'
  },

  plugins: [
    new ExtractTextPlugin('[name].css')
  ],

  devServer: {
    historyApiFallback: true,
    stats: 'minimal'
  }
});
</pre>
<p>
The HtmlWebpackPlugin, added in webpack.common.js, uses the <code>publicPath</code> and <code>filename</code> in <code>output</code> to generate appropriate &lt;script&gt; and &lt;link&gt; tags into the index.html.
</p>

<p>
<code>output</code> bundles in the dist folder, the dev server keeps all bundles in memory; it doesn't write them to disk. You won't find any files in the dist folder, at least not any generated from this development build.
</p>

<p>
Until the environment variable is set to production (webpack.DefinePlugin)
webpack.prod.js
</p>
<pre class="example">
var webpack = require('webpack');
var webpackMerge = require('webpack-merge');
var ExtractTextPlugin = require('extract-text-webpack-plugin');
var commonConfig = require('./webpack.common.js');
var helpers = require('./helpers');

const ENV = process.env.NODE_ENV = process.env.ENV = 'production';

module.exports = webpackMerge(commonConfig, {
  devtool: 'source-map',

  output: {
    path: helpers.root('dist'),
    publicPath: '/',
    filename: '[name].[hash].js',
    chunkFilename: '[id].[hash].chunk.js'
  },

  plugins: [
    new webpack.NoEmitOnErrorsPlugin(),
    new webpack.optimize.UglifyJsPlugin({ // https://github.com/angular/angular/issues/10618
      mangle: {
        keep_fnames: true
      }
    }),
    new ExtractTextPlugin('[name].[hash].css'),
    new webpack.DefinePlugin({
      'process.env': {
        'ENV': JSON.stringify(ENV)
      }
    }),
    new webpack.LoaderOptionsPlugin({
      htmlLoader: {
        minimize: false // workaround for ng2
      }
    })
  ]
});
</pre>

<p>
Angular CLI set ENV in this way. The EnvironmentPlugin is shorthand for using the DefinePlugin on process.env keys.
</p>
<pre class="example">
const { EnvironmentPlugin } = require('webpack');
"plugins": [
new EnvironmentPlugin({
    "NODE_ENV": "production"
  }),
]
</pre>

<p>
webpack.prod.js addtional plugins
</p>
<dl class="org-dl">
<dt>NoEmitOnErrorsPlugin</dt><dd>stops the build if there is an error.</dd>
<dt>UglifyJsPlugin</dt><dd>minifies the bundles.</dd>
<dt>ExtractTextPlugin</dt><dd>extracts embedded css as external files, adding cache-busting hash to the filename.</dd>
<dt>DefinePlugin</dt><dd>use to define environment variables that you can reference within the application.</dd>
<dt>LoaderOptionsPlugins</dt><dd>to override options of certain loaders.</dd>
</dl>
</div>
</div>

<div id="outline-container-org5904adf" class="outline-5">
<h5 id="org5904adf"><span class="section-number-5">12.5.14.6</span> Use of webpack.(common|dev|prod).js</h5>
<div class="outline-text-5" id="text-12-5-14-6">
<p>
src/index.html
</p>
<pre class="example">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;base href="/"&gt;
    &lt;title&gt;Angular With Webpack&lt;/title&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;my-app&gt;Loading...&lt;/my-app&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>

<p>
src/main.ts
</p>
<pre class="example">
import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';
import { enableProdMode } from '@angular/core';

import { AppModule } from './app/app.module';

if (process.env.ENV === 'production') {
  enableProdMode();
}

platformBrowserDynamic().bootstrapModule(AppModule);
</pre>

<p>
polyfills.ts is a good place to configure browser environment for production or development
</p>
<pre class="example">
import 'core-js/es6';
import 'core-js/es7/reflect';
require('zone.js/dist/zone');

if (process.env.ENV === 'production') {
  // Production
} else {
  // Development and test
  Error['stackTraceLimit'] = Infinity;
  require('zone.js/dist/long-stack-trace-zone');
}
</pre>

<p>
src/vendor.ts
</p>
<pre class="example">
// Angular
import '@angular/platform-browser';
import '@angular/platform-browser-dynamic';
import '@angular/core';
import '@angular/common';
import '@angular/http';
import '@angular/router';

// RxJS
import 'rxjs';

// Other vendors for example jQuery, Lodash or Bootstrap
// You can import js, ts, css, sass, ...
</pre>

<p>
Highlights
</p>

<ul class="org-ul">
<li>There are no &lt;script&gt; or &lt;link&gt; tags in the index.html. The HtmlWebpackPlugin inserts them dynamically at runtime.</li>

<li>The AppComponent in app.component.ts imports the application-wide css with a simple import statement.</li>

<li>The AppComponent itself has its own html template and css file. WebPack loads them with calls to require(). Webpack stashes those component-scoped files in the app.js bundle too. You don't see those calls in the source code; they're added behind the scenes by the angular2-template-loader plug-in.</li>

<li>The vendor.ts consists of vendor dependency import statements that drive the vendor.js bundle. The application imports these modules too; they'd be duplicated in the app.js bundle if the CommonsChunkPlugin hadn't detected the overlap and removed them from app.js.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org8e944e7" class="outline-4">
<h4 id="org8e944e7"><span class="section-number-4">12.5.15</span> PostCSS, postcss-cli cssnano autoprefixer</h4>
<div class="outline-text-4" id="text-12-5-15">
<p>
<a href="https://github.com/postcss/postcss/blob/master/docs/plugins.md">All PostCSS plugins</a>, <a href="https://www.postcss.parts/">online catalog</a>
</p>

<p>
Install npm package for a specific build tool e.g. <a href="#org0b6ad20">npm:gulp-postcss</a>
And install individual PostCSS plugin which is separate npm package
</p>

<p>
<a id="org93e38c9">npm:postcss:options</a>
Most PostCSS runners accept two parameters:
</p>
<ul class="org-ul">
<li>An array of plugins.</li>
<li>An object of options.</li>
</ul>

<p>
Common options:
</p>
<ul class="org-ul">
<li>syntax: an object providing a syntax parser and a stringifier.</li>
<li>parser: a special syntax parser (for example, SCSS).</li>
<li>stringifier: a special syntax output generator (for example, Midas).</li>
<li>map: source map options.</li>
<li>from: the input file name (most runners set it automatically).</li>
<li>to: the output file name (most runners set it automatically).</li>
</ul>

<pre class="example">
var gulp = require('gulp');
var postcss = require('gulp-postcss');
var nested = require('postcss-nested');
var sugarss = require('sugarss');

gulp.task('default', function () {
    var plugins = [nested];
    return gulp.src('in.sss')
        .pipe(postcss(plugins, { parser: sugarss }))
        .pipe(gulp.dest('out'));
});
</pre>
</div>

<div id="outline-container-org9735edc" class="outline-5">
<h5 id="org9735edc"><span class="section-number-5">12.5.15.1</span> postcss-cli <a id="org063e7bd">npm:postcss-cli</a></h5>
<div class="outline-text-5" id="text-12-5-15-1">
<p>
npm i -g|-D postcss-cli
</p>

<pre class="example">
npm i postcss-cli autoprefixer
npx postcss *.css --use autoprefixer -d build/
</pre>
</div>
</div>

<div id="outline-container-org1d483c1" class="outline-5">
<h5 id="org1d483c1"><span class="section-number-5">12.5.15.2</span> autoprefixer <a id="org62d46f0">npm:autoprefixer</a></h5>
<div class="outline-text-5" id="text-12-5-15-2">
<p>
Required by <a href="#org0b6ad20">npm:gulp-postcss</a>
</p>

<p>
It doesn't remove duplicate css rules and removes unwanted prefixes in source files.
</p>
</div>

<ol class="org-ol">
<li><a id="org85f6beb"></a>browserslist<br />
<div class="outline-text-6" id="text-12-5-15-2-1">
<p>
package.json
</p>

<p>
<a href="https://github.com/ai/browserslist#queries">https://github.com/ai/browserslist#queries</a>
Default
</p>
<pre class="example">
{
...,
  "browserslist": [
    "&gt; 0.5%",
    "last 2 versions",
    "Firefox ESR",
    "not dead"
  ],
...
}
</pre>
</div>
</li>

<li><a id="orgc77cacb"></a>Comment to turn off prefixing<br />
<div class="outline-text-6" id="text-12-5-15-2-2">
<p>
Autoprefixer is disabled for a specific rule <code>b</code>
</p>
<pre class="example">
a {
    transition: 1s; /* it will be prefixed */
}

b {
    /* autoprefixer: off */
    transition: 1s; /* it will not be prefixed */
}
</pre>

<pre class="example">
/* autoprefixer: off */
@supports (transition: all) {
    /* autoprefixer: on */
    a {
        /* autoprefixer: off */
    }
}
</pre>

<p>
For Sass, add ! so that <code>/*! autoprefixer: off */</code>
</p>
</div>
</li>

<li><a id="org17957d3"></a>Options<br />
<div class="outline-text-6" id="text-12-5-15-2-3">
<p>
autoprefixer({ cascade: false })
</p>

<dl class="org-dl">
<dt>browsers (array)</dt><dd>list of browsers query (like last 2 versions), which are supported in your project. We recommend to use browserslist config or browserslist key in package.json, rather than this option to share browsers with other tools. See Browserslist docs for available queries and default value.</dd>
<dt>env (string)</dt><dd>environment for Browserslist.</dd>
<dt>cascade (boolean)</dt><dd>should Autoprefixer use Visual Cascade, if CSS is uncompressed. Default: true</dd>
<dt>add (boolean)</dt><dd>should Autoprefixer add prefixes. Default is true.</dd>
<dt>remove (boolean)</dt><dd>should Autoprefixer [remove outdated] prefixes. Default is true.</dd>
<dt>supports (boolean)</dt><dd>should Autoprefixer add prefixes for @supports parameters. Default is true.</dd>
<dt>flexbox (boolean|string)</dt><dd>should Autoprefixer add prefixes for flexbox properties. With "no-2009" value Autoprefixer will add prefixes only for final and IE versions of specification. Default is true.</dd>
<dt>grid (boolean)</dt><dd>should Autoprefixer add IE prefixes for Grid Layout properties. Default is false.</dd>
<dt>stats (object)</dt><dd>custom usage statistics for &gt; 10% in my stats browsers query.</dd>
</dl>

<p>
Plugin object has info() method for debugging purpose.
</p>

<p>
You can use PostCSS processor to process several CSS files to increase performance.
</p>
</div>
</li>

<li><a id="org8d1c9e1"></a>Debug<br />
<div class="outline-text-6" id="text-12-5-15-2-4">
<p>
Show selected browsers and css properties will be prefixed
npx autoprefixer &#x2013;info
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgcd23dcb" class="outline-5">
<h5 id="orgcd23dcb"><span class="section-number-5">12.5.15.3</span> cssnano <a id="org428f3e8">npm:cssnano</a></h5>
<div class="outline-text-5" id="text-12-5-15-3">
<p>
Build on top of PostCSS, minify css
</p>
</div>
</div>

<div id="outline-container-orga44f0c0" class="outline-5">
<h5 id="orga44f0c0"><span class="section-number-5">12.5.15.4</span> precss <a id="org50c557f">npm:precss</a></h5>
<div class="outline-text-5" id="text-12-5-15-4">
<p>
Use Sass-like markup and staged CSS features in .css file.
npm install precss &#x2013;save-dev
</p>
</div>
</div>
</div>

<div id="outline-container-orgca1f633" class="outline-4">
<h4 id="orgca1f633"><span class="section-number-4">12.5.16</span> path <a id="org430cf58">nodejs:path</a></h4>
<div class="outline-text-4" id="text-12-5-16">
<pre class="example">
var path = require('path');
// path is native, get just the file name
console.log(path.basename(__filename));

// No trailing '/'
var dirUploads = path.join(__dirname, 'www', 'files', 'uploads');
</pre>
</div>
</div>

<div id="outline-container-org4e109e8" class="outline-4">
<h4 id="org4e109e8"><span class="section-number-4">12.5.17</span> fs</h4>
<div class="outline-text-4" id="text-12-5-17">
<p>
Default fs is not a Promise although it is async with callback.
Every function has a sync version. Just append Sync at the end.
They cannot be chained. Consider <a href="#org00847fb">nodejs:bluebird</a> or <a href="#org6b1ebce">nodejs:co</a>-fs
</p>
<pre class="example">
var fs = require('fs');
var data = require('./data1.json');
console.log(data.name); // data is an object
fs.readFile('./data1.json', 'utf-8', function(err, data) {
  // without specifying utf-8, file will be read as binary
  data = JSON.parse(data); // data is string
  console.log(data.name);
  // res.setHeader('Content-Type', 'text/html');
  // res.send(html);
});

// Read directory
fs.readdir('/root', function(err, data) {
  console.log(data); // data is array
  data.forEach(function(fname) {
    var file = path.join(__dirname, "lib", fname);
    var stats = fs.statSync(file);
    if (stats.isFile() &amp;&amp; fname !== '.DS_Store') {
      fs.readFile(file, "UTF-8", function(err, data) {
        console.log(data);
      });
    } 

  });
});

// Write file
var tomString = '{ "name": "Tom" }';
fs.writeFile('tom.json', tomString, function(err) {});
var timmy = {
  name: 'Timmy'
};

fs.writeFile('timmy.json', JSON.stringify(timmy));

// Append file
fs.appendFile('timmy.json', 'more text \n');

// Rename file
fs.rename('./lib/project-config.js', './lib/config.json');

// Move file
fs.rename('./lib/project-config.js', './config.json');

// Remove file
fs.unlink('./lib/config.json');

// New folder
if (!fs.existsSync("lib")) {
  fs.mkdir("lib", function(err) {});
}

// Rename or move
fs.rename('./assets/logs', './logs');

// Remove folder, folder must be empty
fs.rmdir('./logs');

// Remove all files from a directory
fs.readdirSync('./logs').forEach(function(fileName) {
  fs.unlinkSync('./logs/' + fileName);
});

// File read stream
var stream = fs.createReadStream('./chat.log', 'UTF-8');
var data = "";
stream.once('data', function() {
  console.log('Start reading file');
});
stream.on("data", function(chunk) {
  process.stdout.write(` chunk: ${chunk.length} |`);
  data += chunk;
});
stream.on('end', function() {
  console.log(data.length);
});

// File write stream
var stream = fs.createWriteStream('result.md');
stream.write(`${data}\n`);
stream.close();
</pre>
</div>
</div>

<div id="outline-container-org38293ef" class="outline-4">
<h4 id="org38293ef"><span class="section-number-4">12.5.18</span> co-fs, co <a id="orgc3e9bad">nodejs:co-fs</a> <a id="org6b1ebce">nodejs:co</a></h4>
<div class="outline-text-4" id="text-12-5-18">
<p>
Default fs doesn't support Promise or Generator Function
</p>
<pre class="example">
npm install co-fs
npm install co

var fs = require('co-fs');
co(function* () {
  var data = yield fs.readFile('./data1.json', 'utf-8');
  // fs.readFile is a promise by using co-fs
  console.log(data);
});
</pre>

<p>
Before co@4.0.0, co() returned a thunk, which is a callback, after it returns a promise
Chain
</p>
<pre class="example">
co(function* () {
  var result = yield Promise.resolve(true);
  return result;
})
.then(function (value) {
  console.log(value);
}, function (err) {
  console.error(err.stack);
});
</pre>

<p>
Convert co-generator function into a regular function which returns a promise
</p>
<pre class="example">
var fn = co.wrap(function* (val) {
  return yield Promise.resolve(val);
});

fn(true).then(function (val) {
  // do something
});
</pre>

<p>
Yieldables are
</p>
<ul class="org-ul">
<li>promises</li>
<li>thunks (functions)</li>
<li>array (parallel execution)</li>
<li>objects (parallel execution)</li>
<li>generators (delegation)</li>
<li>generator functions (delegation)</li>
</ul>

<p>
Resolve multiple promises in parallel
</p>
<pre class="example">
co(function* () {
  var a = Promise.resolve(1);
  var b = Promise.resolve(2);
  var res = yield [a,b];
}).catch(onerror);

function onerror(err) {
  console.error(err.stack);
}
</pre>
</div>
</div>

<div id="outline-container-orgb05ba19" class="outline-4">
<h4 id="orgb05ba19"><span class="section-number-4">12.5.19</span> http, https <a id="org0e5ae16">nodejs:http</a></h4>
<div class="outline-text-4" id="text-12-5-19">
<p>
It's sync request.
</p>
</div>
<div id="outline-container-orgea8728d" class="outline-5">
<h5 id="orgea8728d"><span class="section-number-5">12.5.19.1</span> request</h5>
<div class="outline-text-5" id="text-12-5-19-1">
<pre class="example">
var https = require('https');
var fs = require('fs');

var options = {
  hostname: "en.wikipedia.org",
  port: 443,
  path: "/wiki/George_Washington",
  method: "GET"
};

var req = https.request(options, function(res) {
  var responseBody = "";
  console.log(`Server Status: ${res.statusCode}`);
  console.log("Response Headers: %j", res.headers);
  res.setEncoding("UTF-8");
  res.once("data", function(chunk) {
    console.log(chunk);
  });

  res.on("data", function(chunk) {
    console.log(`--chunk-- ${chunk.length}`);
    responseBody += chunk;
  });

  res.on("end", function() {
    fs.writeFile("george-w.html", responseBody, function(err) {
      if (err) throw err;
    });
    console.log("File downloaded");
  });

});

// Set timeout
req.on('socket', function(socket) {
  socket.setTimeout(8000);
  socket.on('timeout', () =&gt; {
    req.abort();
    console.log('timeout');
  });
});

req.on("error", function(err) {
  if (err.code === 'ECONNRESET') {
    console.log("Timeout occurs");
  }
  console.log(`problem: ${err.message}`);
});

req.end();
</pre>
</div>
</div>

<div id="outline-container-orgf4664e7" class="outline-5">
<h5 id="orgf4664e7"><span class="section-number-5">12.5.19.2</span> server</h5>
<div class="outline-text-5" id="text-12-5-19-2">
<p>
Simple HTTP server which gives responses
</p>

<pre class="example">
var http = require('http');
var fs = require('fs');
var path = require('path');
var jsonFile = require('./data/inventory'); //inventory.json
// jsonFile is a json object, not string

var server = http
  .createServer(function (req, res) {
    if (req.url === '/') {
      fs.readFile("./public/index.html", "UTF-8", function (err, html) {
        res.writeHead(200, {"Content-Type": "text/html"});
        // res.write(html); res.end();
        res.end(html);
      });
    }
    else if (req.url.match(/.css$/)) {
      var cssPath = path.join(__dirname, 'public', req.url);
      var fileStream = fs.createReadStream(cssPath, "UTF-8");
      res.writeHead(200, {"Content-Type": "text/css"});
      fileStream.pipe(res);
    }
    else if (req.url.match(/.jpg$/)) {
      var imgPath = path.join(__dirname, 'public', req.url);
      var imgStream = fs.createReadStream(imgPath); // binary
      res.writeHead(200, {"Content-Type": "image/jpeg"});
      imgStream.pipe(res);
    }
    else if (req.url === 'getallorders') {
      res.writeHead(200, {"Content-Type": "text/json"});
      res.end(JSON.stringify(jsonFile));
    }
    else if (req.url === 'instock') {
      listInStock(res);
    }
    else if (req.url === 'form') {

      if (res.method === "GET") {
        res.writeHead(200, {"Content-Type": "text/html"});
        fs.createReadStream("./public/form.html", "UTF-8").pipe(res);
      }
      else if (req.method === "POST") {
        var body = "";
        // body will be a url encoded string with key-value pairs
        req.on("data", function(chunk) {
          body += chunk;
        });

        req.on("end", function() {
          res.writeHead(200, {"Content-Type": "text/html"});
          res.end(`${body}`);
        });
      }

    }
    else {
      res.writeHead(200, {"Content-Type": "text/plain"});
      res.end("404 File Not Found");
    }
  })
  .listen(3000);

function listInStock(res) {
  var inStock = jsonFile.filter(function(item) {
    return item.avail === "In Stock";
  });
  res.end(JSON.stringify(inStock));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org50e236c" class="outline-4">
<h4 id="org50e236c"><span class="section-number-4">12.5.20</span> cors</h4>
<div class="outline-text-4" id="text-12-5-20">
<p>
You don't need to config Nginx!
</p>
<pre class="example">
npm install cors

var express = require('express');
var cors = require('cors');
var app = express();

// Enable CORS for all routes/requests
app.use(cors());

app.get('/products/:id', function (req, res, next) {
  res.json({msg: 'This is CORS-enabled for all origins!'});
});

// Enable for one route
// Don't put cors() in app.route()
app.get('/products/:id', cors(corOptions), function (req, res, next) {
  res.json({msg: 'This is CORS-enabled for all origins!'})
})

// Options
var corsOptions = {
  origin: 'http://example.com',
  optionsSuccessStatus: 200
}

// Multiple domains
var whitelist = ['http://example1.com', 'http://example2.com']
var corsOptions = {
  origin: function (origin, callback) {
    if (whitelist.indexOf(origin) !== -1) {
      callback(null, true)
    } else {
      callback(new Error('Not allowed by CORS'))
    }
  }
}

// use the same cors(corsOptions)
</pre>
</div>
</div>

<div id="outline-container-org6c4080f" class="outline-4">
<h4 id="org6c4080f"><span class="section-number-4">12.5.21</span> xml2js</h4>
<div class="outline-text-4" id="text-12-5-21">
<p>
<a href="https://github.com/Leonidas-from-XIV/node-xml2js">https://github.com/Leonidas-from-XIV/node-xml2js</a>
</p>
<pre class="example">
npm install --save xml2js

var parseString = require('xml2js').parseString;
var xml = "&lt;root&gt;Hello xml2js!&lt;/root&gt;"
parseString(xml, function (err, result) {
    console.dir(result);
});
</pre>
</div>
</div>

<div id="outline-container-org36c4a91" class="outline-4">
<h4 id="org36c4a91"><span class="section-number-4">12.5.22</span> crypto</h4>
<div class="outline-text-4" id="text-12-5-22">
</div>
<div id="outline-container-org9c112cf" class="outline-5">
<h5 id="org9c112cf"><span class="section-number-5">12.5.22.1</span> HMAC</h5>
<div class="outline-text-5" id="text-12-5-22-1">
<p>
SSL certificate changes from SHA1 to SHA256 which is SHA2 algorithm.
</p>

<p>
One ASCII character is 8 bits.
One UTF-8 character is between 8 bits to 32 bits.
</p>

<p>
One ASCII character can be represented as 2 hex characters (UTF-8, etc.)
</p>

<p>
Output size of SHA256 is 256 bits, which is 256/8*2 = 64 hex characters
Output size of SHA1 is 160, which is 40 hex characters
</p>

<p>
The secret/key of SHA256 should at least contain 256 bits. But I use 128 bits.. Which is 32 hex characters.
</p>

<pre class="example">
var crypto = require('crypto')
 , text = 'hello'
 , key = 'abcdeg' // better to have 32 hex characters, but length could be any
 , hash

let hmac = crypto.createHmac('sha256', key);
hmac.write(text);
hmac.end();
let hash = hmac.read().toString('hex');
</pre>
</div>
</div>

<div id="outline-container-orgabd87b4" class="outline-5">
<h5 id="orgabd87b4"><span class="section-number-5">12.5.22.2</span> encrypt, decrypt <a id="orgd04953f">nodejs:decrypt</a></h5>
<div class="outline-text-5" id="text-12-5-22-2">
<p>
Refer to <a href="#org07a95a9">php:openssl_decrypt</a>
</p>

<p>
All AES, regardless 128/256 or key length, the output size depends on the input size
(floor(Input size / 16 bytes) + 1) * 16 bytes
</p>

<pre class="example">
const crypto = require('crypto');

const KEYAES = '64 hex characters'
const ALGORITHM = 'aes-256-cbc';

// store this keyAES256.toString('hex')
// convert hex to bytes
// keyAES256 = new buffer(keyAES256, 'hex');

function encrypt(plain_text) {
  var iv = crypto.randomBytes(16); // 16 text characters, 16 bytes or 32 hex characters
  // iv should be different every time

  var keyAES = new Buffer(KEYAES, 'hex');
  // var keyAES = crypto.randomBytes(32); // 32 text characters, 32 bytes or 64 hex characters
  // global KEYAES is keyAES.toString('hex')

  var cipher = crypto.createCipheriv(ALGORITHM, keyAES, iv);
  cipher.write('text to encrypt');
  cipher.end();

  var cipher_text = cipher.read().toString('hex');

  return cipher_text + '$' + iv.toString('hex');
}

function decrypt(cipher_text) {
  var cipher_blob = cipher_text.split("$");
  var ct = cipher_blob[0];
  var iv = new Buffer(cipher_blob[1], 'hex'); // get iv
  var keyAES = new Buffer(KEYAES, 'hex');

  decryptor = crypto.createDecipheriv(ALGORITHM, keyAES, iv);
  decryptor.write(ct, 'hex');
  decryptor.end();
  console.log(decryptor.read().toString('utf-8'));
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb41958b" class="outline-4">
<h4 id="orgb41958b"><span class="section-number-4">12.5.23</span> body-parser</h4>
<div class="outline-text-4" id="text-12-5-23">
<p>
parse POST data. Refer to <a href="#orgb1934c3">nodejs:express</a>
<code>npm install body-parser</code>
</p>

<p>
var express = require('express');
</p>
</div>
</div>

<div id="outline-container-org901966f" class="outline-4">
<h4 id="org901966f"><span class="section-number-4">12.5.24</span> httpster</h4>
<div class="outline-text-4" id="text-12-5-24">
<pre class="example">
npm install httpster -g
httpster -p 3000 -d ./public/

// Or httpster is installed locally
./node_modules/httpster/bin/httpster -p 3000 -d ./public/
</pre>
</div>
</div>

<div id="outline-container-orge79ec91" class="outline-4">
<h4 id="orge79ec91"><span class="section-number-4">12.5.25</span> express <a id="orgb1934c3">nodejs:express</a></h4>
<div class="outline-text-4" id="text-12-5-25">
</div>
<div id="outline-container-orgfb0a61c" class="outline-5">
<h5 id="orgfb0a61c"><span class="section-number-5">12.5.25.1</span> Sample</h5>
<div class="outline-text-5" id="text-12-5-25-1">
<pre class="example">
// my-express.js
var express = require('express');
var app = express();
var bodyParser =  require('body-parser');

app.set('port', process.env.PORT || 3000);

var skierTerms = [{},{}]; // javascript array/object. global to the project/app. Only reset when app is restarted.
app.set('appData', skierTerms);

// app.use() adds middlewares which run first

app.use(bodyParser.json()); // any data sent to this app (API) as .json, the data will be parsed
app.use(bodyParser.urlencoded({ extended: true })); // also parse url encoded data
// false uses the `querystring` library which means the data could be string or array
// true uses the `qs` library which means the data could be any type

// log every request
app.use(function(req, res, next) {
  console.log(`${req.method} request for '${req.url}' - ${JSON.stringify(req.body)}`);
  next(); // eventually, res.send('output');, so here is next
});

// default is index.html, server static files
app.use(express.static(__dirname));

app.use('/message', function(req, res) {
  console.log('user requested endpoint');
  res.send('response is hello');
});

app.use(require('./routes/index'));
app.use(require('./routes/dict-api'));

app.listen(app.get('port'), function() {
  // optional callback
});

// visit localhost:3000/message
// node my-express.js
// PORT=4000 node my-express.js
</pre>

<pre class="example">
// ./routes/dict-api.js
var express = require('express');
var router = express.Router();

router.use(bodyParser.json()); // any data sent to this app (API) as .json, the data will be parsed
router.use(bodyParser.urlencoded({ extended: false })); // also parse url encoded data

// same domain
router.get('/dict-api', function(req, res) {
  var skierTerms = req.app.get('appData');
  res.json(skierTerms); // send json variable, no need to stringify
});

router.post('/dict-api', function(req, res) {
  var skierTerms = req.app.get('appData');
  skierTerms.push(req.body);
  req.app.set('appData', skierTerms);
  res.json(skierTerms); // send json variable, no need to stringify
});

router.delete('dict-api/:term', function(req, res) {
  var skierTerms = req.app.get('appData');
  skierTerms = skierTerms.filter(function(def) {
    return def.term.toLowerCase() !== req.params.term.toLowerCase();
  });
  req.app.set('appData', skierTerms);
  res.json(skierTerms);
});

module.exports = router;
</pre>
</div>
</div>

<div id="outline-container-org4241cd7" class="outline-5">
<h5 id="org4241cd7"><span class="section-number-5">12.5.25.2</span> Routing</h5>
<div class="outline-text-5" id="text-12-5-25-2">
</div>
<ol class="org-ol">
<li><a id="org5694e2e"></a>Callbacks<br />
<div class="outline-text-6" id="text-12-5-25-2-1">
<p>
Instead of <code>next()</code> which skips to the next callback, <code>next('route')</code> can bypass all the remaining route callbacks of the current app.METHOD() or router.METHOD().
<code>next('router')</code> to skip the rest of the router's middleware functions the router instance
</p>

<pre class="example">
app.get('/example/a', function (req, res) {
  res.send('Hello from A!')
})

app.get('/example/b', function (req, res, next) {
  console.log('the response will be sent by the next function ...')
  next()
}, function (req, res) {
  res.send('Hello from B!')
})

var cb0 = function (req, res, next) {
  console.log('CB0')
  next()
}

var cb1 = function (req, res, next) {
  console.log('CB1')
  next()
}

var cb2 = function (req, res) {
  res.send('Hello from C!')
}

app.get('/example/c', [cb0, cb1, cb2])

var cb0 = function (req, res, next) {
  console.log('CB0')
  next()
}

var cb1 = function (req, res, next) {
  console.log('CB1')
  next()
}

app.get('/example/d', [cb0, cb1], function (req, res, next) {
  console.log('the response will be sent by the next function ...')
  next()
}, function (req, res) {
  res.send('Hello from D!')
})
</pre>
</div>
</li>

<li><a id="org33791c1"></a>Response methods<br />
<ol class="org-ol">
<li><a id="orgdc648d3"></a>res.send res.sendFile<br />
<div class="outline-text-7" id="text-12-5-25-2-2-1">
<pre class="example">
// Content-Type is automatically sent when res.send is used
res.send(new Buffer('whoop'));
res.send({ some: 'json' }); // Array or Object, Express responds with JSON
res.send('&lt;p&gt;some html&lt;/p&gt;'); // Content-Type text/html
res.status(404).send('Sorry, we cannot find that!');
res.status(500).send({ error: 'something blew up' });
</pre>
</div>
</li>

<li><a id="org16f7a65"></a>res.write res.end<br />
<div class="outline-text-7" id="text-12-5-25-2-2-2">
<p>
Quickly ends the response without any data.
</p>
<pre class="example">
// send multiple responses using res.write
res.write('1');
res.write('2');
res.setHeader('Content-Type', 'text/html');
res.end();
// res.status(404).end();
</pre>
</div>
</li>
</ol>
</li>

<li><a id="org398583a"></a>Parameters<br />
<div class="outline-text-6" id="text-12-5-25-2-3">
<pre class="example">
Route path: /users/:userId/books/:bookId
Request URL: http://localhost:3000/users/34/books/8989
req.params: { "userId": "34", "bookId": "8989" }

app.get('/users/:userId/books/:bookId', function (req, res) {
  res.send(req.params)
})

Route path: /user/:userId(\d+)
Request URL: http://localhost:3000/user/42
req.params: {"userId": "42"}

Request URL: /mv?id=abc
req.query: {id: "abc"}
</pre>

<p>
The name of route parameters must be made up of “word characters” ([A-Za-z0-9_]).
</p>

<p>
<code>-</code> and <code>.</code> are literal characters - and .
</p>

<p>
For using <code>*</code> as regex, use <code>{0,}</code> for Express 4.x, use <code>*</code> for Express 5.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org4bb82fd" class="outline-5">
<h5 id="org4bb82fd"><span class="section-number-5">12.5.25.3</span> Error-handling middleware</h5>
<div class="outline-text-5" id="text-12-5-25-3">
<p>
Error-handling middleware are defined last.
A built-in error handler is added at the end.
If <code>next(err)</code> is called and there're no custom error handler, it'll be handled by the built-in error handler.
In non-production environment (NODE_ENV=production), stack trace is printed.
</p>

<p>
For a custom error handler, if the headers have already been sent to the client, you'll need to call next(err) to let
the built-in error handler to close the connection and fail the request.
</p>

<p>
<code>next(err)</code> can be only called once otherwise there is an error
</p>

<pre class="example">
function errorHandler(err, req, res, next) {
  if (res.headersSent) {
    return next(err)
  }
  res.status(500)
  res.render('error', {error: err})
}
</pre>

<p>
Simple sample:
</p>
<pre class="example">
// 4 arguments
app.use(function (err, req, res, next) {
  console.error(err.stack);
  res.status(500).send('Error!');
})
</pre>

<p>
Multiple error handlers
</p>
<pre class="example">
// /index.js
app.use(logErrors)
app.use(clientErrorHandler)
app.use(errorHandler)

function logErrors (err, req, res, next) {
  console.error(err.stack)
  next(err)
}

function clientErrorHandler (err, req, res, next) {
  if (req.xhr) {
    res.status(500).send({ error: 'Something failed!' })
  } else {
    next(err)
  }
}

function errorHandler (err, req, res, next) {
  res.status(500)
  res.render('error', { error: err })
}
</pre>
</div>
</div>

<div id="outline-container-org661d5e7" class="outline-5">
<h5 id="org661d5e7"><span class="section-number-5">12.5.25.4</span> Built-in middleware</h5>
<div class="outline-text-5" id="text-12-5-25-4">
</div>
<ol class="org-ol">
<li><a id="org92cde2b"></a>express.static for serving static assets<br />
<div class="outline-text-6" id="text-12-5-25-4-1">
<pre class="example">
// syntax: express.static(root, [options])
// serve static files in /public directory
app.use(express.staic('public'));
</pre>
</div>
</li>
</ol>
</div>

<div id="outline-container-orga973e3e" class="outline-5">
<h5 id="orga973e3e"><span class="section-number-5">12.5.25.5</span> View Engine (ejs)</h5>
<div class="outline-text-5" id="text-12-5-25-5">
<pre class="example">
npm install ejs --save

// app.js
app.set('view engine', 'ejs');
app.set('view', './views'); // default

app.locals.siteTitle = 'Website Name'; // available to all views
// persist through the life of the app

// ./routes/index.js
router.get('/', function(req,res) {
  var data = req.app.get('appData');
  var pagePhotos = [];

  data.speakers.forEach(function() {
    pagePhotos = pagePhotos.concat(item.artwork);
  });

  res.render('index', {
    pageTitle: 'Home',
    artwork: pagePhotos,
    pageID: 'home'
  });
});

// ./views/index.ejs
&lt;!-- HTML Code --&gt;
&lt;%= siteTitle %&gt;
&lt;%= pageTitle %&gt;

&lt;body id="&lt;%= pageID %&gt;"&gt;

// if the variable is HTML, output as HTML
&lt;%- varHTML %&gt;

&lt;% if (typeof pageTitle !== "undefined") { %&gt;
  &lt;script src="abc.js"&gt;&lt;/script&gt;
&lt;% } %&gt;

&lt;% if (artwork.length &gt; 0) { %&gt;
  &lt;% for (i=0; i&lt; artwork.length; i++) { %&gt;
  &lt;img src="/images/artwork/&lt;%= artwork[i] %&gt;" alt="Artwork &lt;%= i %&gt;"&gt;
  &lt;% } %&gt;
&lt;% } %&gt;

&lt;% include partials/template/header.ejs %&gt;
// partial can use the parent view variables
</pre>
</div>
</div>
</div>

<div id="outline-container-org456dd0f" class="outline-4">
<h4 id="org456dd0f"><span class="section-number-4">12.5.26</span> sails</h4>
<div class="outline-text-4" id="text-12-5-26">
<pre class="example">
npm install sails -g
mkdir sails
cd sails
// Create a sails project with backend only
sails new --no-front-end

// create an api
sails generate api user

// 2 files are created
// ./sails/api/controllers/UserController.js
// ./sails/api/models/User.js
</pre>

<p>
Modify models/User.js, what attributes a user can have and the datatype?
</p>
<pre class="example">
module.exports = {
  attributes: {
    name: 'string'
  }
}
</pre>

<p>
Start sails, default port is 1337 :: <code>sails lift</code>
</p>

<p>
Perform CRUD by visiting url
</p>
<pre class="example">
localhost:1337/user/create?name=John
localhost:1336/user
</pre>
</div>
</div>

<div id="outline-container-orgba3eb14" class="outline-4">
<h4 id="orgba3eb14"><span class="section-number-4">12.5.27</span> koa</h4>
<div class="outline-text-4" id="text-12-5-27">
<p>
ES6
</p>
<pre class="example">
npm install koa

// koa-endpoint-demo.js
var koa = require('koa');
var app = new koa();
app.use(function* () {
  this.body = 'hello in the body tag';
});

app.listen(3000);
</pre>

<p>
Run it in harmony
</p>
<pre class="example">
node --harmony koa-endpoint-demo.js
</pre>
</div>
</div>

<div id="outline-container-org43f8cf3" class="outline-4">
<h4 id="org43f8cf3"><span class="section-number-4">12.5.28</span> Promise</h4>
<div class="outline-text-4" id="text-12-5-28">
</div>
<div id="outline-container-org79dc4bb" class="outline-5">
<h5 id="org79dc4bb"><span class="section-number-5">12.5.28.1</span> Basics</h5>
<div class="outline-text-5" id="text-12-5-28-1">
<p>
Promise is native, refer to <a href="#org00847fb">nodejs:bluebird</a>
</p>
<pre class="example">
var promise = new Promise(function(res, rej) {
  resolve();
  // or
  // reject();
});

promise.then(function() {
  console.log('then');
})
.catch(function() {
  console.error('failed');
});
</pre>
</div>
</div>

<div id="outline-container-orgdad69db" class="outline-5">
<h5 id="orgdad69db"><span class="section-number-5">12.5.28.2</span> http server example</h5>
<div class="outline-text-5" id="text-12-5-28-2">
<pre class="example">
const parseString = require('xml2js').parseString;

route.get('/auth/:site/:emailkey', function(req, res) {
  try {
    getUserInfo(req.params.site, req.params.emailkey, res);
  }
  catch (e) {
    res.json(e.message);
  } 
});

function getUserInfo(site, emailkey, res) {
  httpsRequest(httpsOptions)
    .then(function(body) {
      parseString(body, (err, result) =&gt; {
        res.json(result);
      });
    });
}

function httpsRequest(params) {
  return new Promise(function(resolve, reject) {
    let req = https.request(params, function(res) {
      let body = '';

      res.on('data', (chunk) =&gt; {
        body += chunk;
      });

      res.on('end', () =&gt; {
        promisesParser(body)
          .then((result) =&gt; {
            resolve(body);
          })
          .catch((err) =&gt; {
            reject(err);
          });
      });

    }); // https.request

    req.end();

  }); // Promise
}

function promiseParser(string) {
   return new Promise(function(resolve, reject) {
     parseString(string, function(err, result) {
       if (err) {
         reject(err);
       }
       else {
         resolve(result);
       }
     });
   });
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org05e9cad" class="outline-4">
<h4 id="org05e9cad"><span class="section-number-4">12.5.29</span> bluebird <a id="org00847fb">nodejs:bluebird</a></h4>
<div class="outline-text-4" id="text-12-5-29">
<pre class="example">
npm install bluebird

var fs = require('fs');
var Promise = require('bluebird');
Promise.promisifyAll(fs);
// append Async after every fs object (e.g. methods)
fs.readFileAsync('./data1.json')
  .then(JSON.parse)
  .then(function (val) {
    console.log(val);
  })
  .catch(SyntaxError, function(e) {
    console.error("invalid json in file");
  })
  .catch(function(e) {
    console.error("unable to read file");
  });
</pre>
</div>
</div>

<div id="outline-container-org5fa82cf" class="outline-4">
<h4 id="org5fa82cf"><span class="section-number-4">12.5.30</span> node-dev, nodemon, reload</h4>
<div class="outline-text-4" id="text-12-5-30">
<p>
node-dev restart automatically when there's a change
</p>
<pre class="example">
npm install node-dev -g
npm install nodemon -g
node-dev app.js
// vs node app.js

// nodemon can watch on a list of file types or ignore a file/folder
nodemon -e js,jade app --watch /another/folder/to/watch --ignore feedback.json --ignore aFolder/
</pre>

<p>
In Vagrant, use <code>nodemon -L index.js</code> for <code>--legacy-watch</code> restarting server
</p>

<p>
Create a WebSocket on the client and reload the browser when Express server is reloaded
</p>
<pre class="example">
npm install -g reload
npm install reload --save

var reload = require('reload');

// app.js
// after app.listen();
reload(server, app);

// In each route, add reload client js file.
router.get('/', function(req, rs) {
  res.write('&lt;script src="/reload/reload.js"&gt;&lt;/script&gt;');
});
</pre>
</div>
</div>

<div id="outline-container-org4d304b4" class="outline-4">
<h4 id="org4d304b4"><span class="section-number-4">12.5.31</span> jshint</h4>
<div class="outline-text-4" id="text-12-5-31">
<p>
Check javascript syntax
</p>
<pre class="example">
npm install jshint -g
jshint app.js

// In app.js, insert a comment at top to give extra instructions
// Use ES6 standard
/* jshint esnext: true */
</pre>
</div>
</div>

<div id="outline-container-org3019be5" class="outline-4">
<h4 id="org3019be5"><span class="section-number-4">12.5.32</span> ws</h4>
<div class="outline-text-4" id="text-12-5-32">
<p>
Refer to <a href="#org6fb8196">js:ws</a> for client
</p>
<pre class="example">
npm install ws --save

var WebSocketServer = require('ws');
var wss = new WebSocketServer({port:3000});
wss.on('connection', function(ws) {
  wss.on('message', function(msg) {
    if (message === 'exit') {
      ws.close();
    }
    else {
      // broadcast
      wss.clients.forEach(function(client) {
        client.send(msg);
      });
    }
  });
  ws.send('Welcome to cyber chat');
});
</pre>
</div>
</div>

<div id="outline-container-org78bb957" class="outline-4">
<h4 id="org78bb957"><span class="section-number-4">12.5.33</span> socket.io</h4>
<div class="outline-text-4" id="text-12-5-33">
<pre class="example">
npm install socket.io --save

var express = require('express');
var http = require('http'); // socket.io requires http
var app = express();
var server = http.createServer(app).listen(3000);
var io = require('socket.io')(server); // change http server to a socket server
// Or io can be attached later: require('socket.io')();

app.use(express.static('./public'));

// socket is attached later
// io.attach(server);

io.on('connection', function(socket) {
  socket.on('chat', function(msg) {
    socket.broadcast.emit('message', message);
  });
  socket.emit('message', 'Welcome to cyber chat');
});

// socket.io-client.min.js
// main.js
var socket = io("http://localhost:3000");
socket.on('disconnect', function() {
  // do something
});
socket.on('connect', function() {
  // do something
});
socket.on('message', function(msg) {
  console.log(msg);
});

socket.emit('chat', input.value);
</pre>
</div>
</div>

<div id="outline-container-org383fc82" class="outline-4">
<h4 id="org383fc82"><span class="section-number-4">12.5.34</span> mocha, chai, nock, rewire, sinon</h4>
<div class="outline-text-4" id="text-12-5-34">
<pre class="example">
npm install mocha -g
npm install chai --save-dev

// nock is an http mocking and expectations library
npm install nock --save-dev

// rewire adds special setter and getter to modules to modify their values
// https://www.npmjs.com/package/rewire
npm install rewire --save-dev
npm install sinon --save-dev

// ./test/tools-spec.js
var expect = require('chai').expect;
var tools = require('../lib/tools'); // tools.js
var nock = require('nock');

// Test function printName()
describe('printName()', function() {
  // Test 1
  it("should print the last name first", function() {
    var results = tools.printName({ first: "Li", last: "Banks" });
    expect(results).to.equal("Banks, Alex");
  });
});

// Test async function loadWiki()
describe('loadWiki()', function() {
  this.timeout(5000); // default timeout is 2 seconds
  // Test 1
  it("Load Abraham Lincon's wiki page", function(done) {
    tools.loadWiki({ first: 'Abraham', last: 'Lincooln'}, function(html) {
      expect(html).to.be.ok;
      done(); // if done() is not run, test will fail
    });
  });
});
var expect = require('chai').expect;
var tools = require('../lib/tools'); // tools.js
var nock = require('nock');
var rewire = require('rewire');

var order = rewire('../lib/order');
// instead of require(), use rewire() which can change data later

// Test function printName()
describe('printName()', function() {
  // Test 1
  it("should print the last name first", function() {
    var results = tools.printName({ first: "Li", last: "Banks" });
    expect(results).to.equal("Banks, Alex");
  });
});

// Test async function loadWiki()
describe('loadWiki()', function() {
  //this.timeout(5000); // default timeout is 2 seconds

  before(function() {
    // before runs before all tests in this block
    // mock server, save testing time
    nock('https://en.wikipedia.org')
      .get('/wiki/Abraham_Lincoln')
      .reply(200, `--html-code--`);
  });

  // Test 1
  it("Load Abraham Lincon's wiki page", function(done) {
    tools.loadWiki({ first: 'Abraham', last: 'Lincooln'}, function(html) {
      //expect(html).to.be.ok;
      expect(html).to.equal('--html-code--');
      done(); // if done() is not run, test will fail
    });
  });
});

describe('Ordering Items', function() {
  beforeEach(function() {
    // beforeEach runs before each test in this block
    this.testData = [
      {sku: "AAA", qty: 10},
      {sku: "BBB", qty: 10}
    ];
    // modify data for testing purpose
    order.__set__("inventoryData", this.testData);
  });

  it('order an item when there are enough in stock', function(done) {
    order.orderItem('BBB', 3, function() {
      // orderItem subtracts 3 from inventory
      done();
    });
  });

});
var expect = require('chai').expect;
var tools = require('../lib/tools'); // tools.js
var nock = require('nock');
var rewire = require('rewire');
var sinon = require('sinon');

var order = rewire('../lib/order');
// instead of require(), use rewire() which can change data later

// Test function printName()
describe('printName()', function() {
  // Test 1
  it("should print the last name first", function() {
    var results = tools.printName({ first: "Li", last: "Banks" });
    expect(results).to.equal("Banks, Alex");
  });
});

// Test async function loadWiki()
describe('loadWiki()', function() {
  //this.timeout(5000); // default timeout is 2 seconds

  before(function() {
    // before runs before all tests in this block
    // mock server, save testing time
    nock('https://en.wikipedia.org')
      .get('/wiki/Abraham_Lincoln')
      .reply(200, `--html-code--`);
  });

  // Test 1
  it("Load Abraham Lincon's wiki page", function(done) {
    tools.loadWiki({ first: 'Abraham', last: 'Lincooln'}, function(html) {
      //expect(html).to.be.ok;
      expect(html).to.equal('--html-code--');
      done(); // if done() is not run, test will fail
    });
  });
});

describe('Ordering Items', function() {
  beforeEach(function() {
    // beforeEach runs before each test in this block
    this.testData = [
      {sku: "AAA", qty: 10},
      {sku: "BBB", qty: 10}
    ];
    // modify data for testing purpose
    order.__set__("inventoryData", this.testData);

    this.console = {
      // overwrite a function with a fake function
      log: sinon.spy()
    };

    order.__set__('console', this.console);

    this.warehouse = {
      packageAndShip: sinon.stub().yields(1098765)
    };

    order.__set__('warehouse', this.warehouse);

  });

  it('order an item when there are enough in stock', function(done) {
    var _this = this;

    order.orderItem('BBB', 3, function(done) {
      // orderItem subtracts 3 from inventory

      expect(_this.console.log.callCount).to.equal(2);

      done();
    });
  });

  describe('Warehouse interaction', function() {
    beforeEach(function() {
      this.callback = sinon.spy();
      order.orderItem("BBB", 2, callback);
    });

    it('receives a tracking number', function() {
      expect(this.callback.calledWith(1098765)).to.equal(true);
    });

    it('calls packageAndShip with the correct sku and quantity', function() {
      expect(this.warehouse.packageAndShip.calledWith("BBB",2)).to.equal(true);
    });

  });

});

// ./lib/tools.js
var https = require('https');
module.exports = {
  printName(person) {
    return `${person.last}, ${person.first}`;
  },
  loadWiki(person, callback) {
    var url = `https://en.wikipedia.org/wiki/${person.first}_${person.last}`;
    https.get(url, function(res) {
      var body = "";
      res.setEncoding('UTF-8');
      res.on("data", function(chunk) {
        body += chunk;
      });
      res.on("end", function() {
        callback(body);
      });
    });
  }
};

// ./lib/order.js
var inventoryData = require('../data/inventory');
var warehouse = require('./warehouse');

function findItem(sku) {
  var i = inventoryData.map(item =&gt; item.sku).indexOf(sku);
  if (i === -1) {
    console.log(`Item - ${sku} not found`);
    return null;
  } else {
    return inventoryData[i];
  }
}

function isInStock(sku, qty) {
  var item = findItem(sku);
  return item &amp;&amp; item.qty &gt;= qty;
}

function order(sku, quantity, complete) {
  complete = complete || function () {};
  if (isInStock(sku, quantity)) {
    console.log(`ordering ${quantity} of item # ${sku}`);
    warehouse.packageAndShip(sku, quantity, function (tracking) {
      console.log(`order shipped, tracking - ${tracking}`);
      complete(tracking);
    });
    return true;
  } else {
    console.log(`there are not ${quantity} of item '${sku}' in stock`);
    return false;
  }
}

module.exports.orderItem = order;

// run mocha
mocha
</pre>

<p>
mocha command not found, add this to package.json
</p>
<pre class="example">
"scripts": {
  "test": "mocha -R spec"
}
</pre>

<p>
<code>-R spec</code> is used to console.log inside tests it()
</p>
</div>
</div>

<div id="outline-container-org3bc1520" class="outline-4">
<h4 id="org3bc1520"><span class="section-number-4">12.5.35</span> supertest, cheerio</h4>
<div class="outline-text-4" id="text-12-5-35">
<pre class="example">
npm install supertest --save-dev
npm install cheerio --save-dev

// ./app.js is an express app

// ./test/app-spec.js
var request = require("supertest");
var expect = require('chai').expect;
var cheerio = require("cheerio");
var rewire = require('rewire');
var app = rewire('../app');

describe("Dictionary App", function () {

    it("Loads the home page", function(done) {
        request(app).get("/").expect(200).end(function(err, res) {
          var $ = cheerio.load(res.text); // jQuery DOM!
          var pageHeading = $("body&gt;h1:first-child").text();
          expect(pageHeading).to.equal("Skier Dictionary");
          done();
        });
    });

    describe("Dictionary API", function () {

        beforeEach(function () {

                this.defs = [
                {
                    term: "One",
                    defined: "Term One Defined"
                },
                {
                    term: "Two",
                    defined: "Term Two Defined"
                }
            ];

            app.__set__("skierTerms", this.defs);
        });

        it("GETS dictionary-api", function(done) {
            var defs = this.defs;
            request(app).get("/dictionary-api").expect(200).end(function(err, res) {
                var terms = JSON.parse(res.text);
                expect(terms).to.deep.equal(defs);
                done();
            });
        });

        it("POSTS dictionary-api", function(done) {
            request(app)
               .post("/dictionary-api")
               .send({ "term": "Three", "defined": "Term Three Defined"})
               .expect(200)
               .end(done);
        });

        it("DELETES dictionary-api", function(done) {
            request(app)
               .delete("/dictionary-api/One")
               .expect(200)
               .end(done);
        });

    });

});
</pre>
</div>
</div>

<div id="outline-container-org1466f9c" class="outline-4">
<h4 id="org1466f9c"><span class="section-number-4">12.5.36</span> istanbul</h4>
<div class="outline-text-4" id="text-12-5-36">
<p>
Code coverage report (testing).
</p>

<pre class="example">
npm install istanbul -g

# at ./
istanbul cover _mocha

# ./coverage/lconv-report/index.html
</pre>
</div>
</div>

<div id="outline-container-orga508829" class="outline-4">
<h4 id="orga508829"><span class="section-number-4">12.5.37</span> svgo <a id="orga34c902">nodejs:svgo</a></h4>
<div class="outline-text-4" id="text-12-5-37">
<p>
<a href="https://github.com/svg/svgo">https://github.com/svg/svgo</a>
</p>

<pre class="example">
// I found windows has permission issue if it's installed globally
npm install svgo

// optimize the svg
./node_modules/svgo abc.svg

// output the svg to data uri URL encoded
// enc, unenc, base64
svgo abc.svg --datauri enc

// increase precision number of decimal points
svgo a.svg --precision=8

// output result STDOUT. if not, the file will be overwritten
svgo abc.svg --datauri enc -o -
</pre>

<p>
<a id="org6de4804">nodejs:svgo:move styles</a>
</p>

<p>
Usually it's good in IE11 but if it still doesn't work, refer to <a href="#orgb6db2e6">svg:ie11</a>
</p>

<p>
AI already makes .svg and you want to move styles to inline
svgo abc.svg &#x2013;enable=inlineStyles &#x2013;config '{ "plugins": [ { "inlineStyles": { "onlyMatchedOnce": false } }] }'
</p>

<p>
Move style attribute from each node to attributes :: style="width:&#x2026;;height:&#x2026;;" to width="&#x2026;" height="&#x2026;"
svgo abc.svg &#x2013;enable=convertStyleToAttrs
</p>

<p>
&#x2013;enable=PLUGIN : Enable plugin by name, "&#x2013;enable={PLUGIN3,PLUGIN4}" for multiple plugins
</p>

<p>
Batch convert all *.svg files in a folder and output to another folder
svgo -f ../path/to/folder/with/svg/files -o ../path/to/folder/with/svg/output
</p>
</div>
</div>
</div>

<div id="outline-container-org26c5ec7" class="outline-3">
<h3 id="org26c5ec7"><span class="section-number-3">12.6</span> Custom Module</h3>
<div class="outline-text-3" id="text-12-6">
<pre class="example">
// my-module.js
// Export one property at a time
exports.myText = 'hello';

// Variables local to the module will be private

// my-square.js, square module
// Root of this module is a function
// Or you want to export a complete object in one assignment instead of building it one property at a time
// Assign it to `module.exports` instead of `exports`
module.exports = (width) =&gt; {
  return {
   area: () =&gt; width ** 2
  }
}

// module-demo.js
var myModule= require('./my-module.js');
const square = require('./my-square.js');
const mySquare = square(2);
console.log(myModule.myText);
console.log(`The area of my square is ${mySquare.area()}`);

// node module-demo.js

// Initiate the custom module, adding package.json file
npm init

// --save flag will add/remove dependency to package.js
npm install cors --save
npm remove cors --save

// delete ./node_modules and run this to install all dependencies
npm install
</pre>

<p>
Call local functions
</p>
<pre class="example">
var _foo = function () {
  return ('foo');
}
var _bar = function () {
  return _foo();
}
module.exports = {
  foo: _foo,
  bar: _bar
};
</pre>
</div>

<div id="outline-container-orgb03ea4c" class="outline-4">
<h4 id="orgb03ea4c"><span class="section-number-4">12.6.1</span> package.json, node-inspector</h4>
<div class="outline-text-4" id="text-12-6-1">
<p>
npm install node-inspector -g
</p>

<p>
npm install
npm start (or test, publish, install)
npm run dev (custom process)
npm run debug
</p>

<pre class="example">
{
  "name": "ski-dictionary",
  "version": "1.0.0",
  "description": "A collection of skier terms and definitions",
  "main": "app.js",
  "scripts": {
    "predebug": "grunt",
    "debug": "open http://localhost:3000 &amp; open http://localhost:8080/debug?port=5858",
    "prestart": "grunt",
    "start": "node app",
    "predev": "grunt",
    "dev": "open http://localhost:3000 &amp; node-dev app &amp; grunt watch"
  },
  "keywords": [
    "ski",
    "terms",
    "dictionary"
  ],
  "author": "Alex Banks",
  "license": "MIT",
  "dependencies": {
    "body-parser": "^1.14.1",
    "cors": "^2.7.1",
    "express": "^4.13.3",
    "jquery": "^2.1.4"
  },
  "devDependencies": {
    "grunt": "^0.4.5",
    "grunt-autoprefixer": "^3.0.3",
    "grunt-browserify": "^4.0.1",
    "grunt-contrib-jshint": "^0.11.3",
    "grunt-contrib-less": "^1.0.1",
    "grunt-contrib-watch": "^0.6.1"
  }
}
</pre>

<p>
<code>npm install --production</code> or when NODE_ENV environment variable is production, npm will not install modules listed in devDependencies
</p>
</div>
</div>
</div>

<div id="outline-container-org9bb4db1" class="outline-3">
<h3 id="org9bb4db1"><span class="section-number-3">12.7</span> <a href="#org4fee16c">node-gyp</a> <a id="org4fee16c">node-gyp</a></h3>
<div class="outline-text-3" id="text-12-7">
<p>
Some plugins need <a href="https://github.com/TooTallNate/node-gyp">node-gyp</a> installed
Open PowerShell with admin right
</p>
<pre class="example">
npm install --global --production windows-build-tools
npm install --global node-gyp
</pre>

<p>
<a href="https://github.com/felixrieseberg/windows-build-tools">windows-build-tools</a> downloads and installs VC++ Build Tools and Python 2.7, configuring maching and npm appropriately.
</p>

<p>
The install is conflict-free meaning that they do not mess with existing installations of VS, C++ Build Tools or Python.
</p>
</div>
</div>

<div id="outline-container-org02f63ee" class="outline-3">
<h3 id="org02f63ee"><span class="section-number-3">12.8</span> npm dependency ~ vs ^ <a id="org6565a64">nodejs:semver</a></h3>
<div class="outline-text-3" id="text-12-8">
<p>
^1.2.3 will match any 1.x.x latest release but will miss 2.0.0 (e.g. allow minor and patch but not major)
~1.2.3 will match any 1.2.x versions but will miss 1.3.0 (e.g. allow patch but not minor or major)
^, caret, is the default now
</p>
</div>
</div>
</div>

<div id="outline-container-org9ba9e80" class="outline-2">
<h2 id="org9ba9e80"><span class="section-number-2">13</span> Angular</h2>
<div class="outline-text-2" id="text-13">
</div>
<div id="outline-container-orgcf12062" class="outline-3">
<h3 id="orgcf12062"><span class="section-number-3">13.1</span> Who use Angular?</h3>
<div class="outline-text-3" id="text-13-1">
<p>
<a href="https://www.paypal.com">https://www.paypal.com</a> <a href="https://www.theguardian.com">https://www.theguardian.com</a>
</p>
</div>
</div>

<div id="outline-container-org981294e" class="outline-3">
<h3 id="org981294e"><span class="section-number-3">13.2</span> 1.x AngularJS</h3>
<div class="outline-text-3" id="text-13-2">
</div>
<div id="outline-container-org6507395" class="outline-4">
<h4 id="org6507395"><span class="section-number-4">13.2.1</span> Structure</h4>
<div class="outline-text-4" id="text-13-2-1">
<p>
<a href="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular.js">https://ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular.js</a>
jquery
common/common.module.js
// angular.module('ajsNgComponents', []);
common/config.js <a href="#org343b0ac">ng:config</a>
common/filters.js <a href="#org1e44764">ng:filter</a>
common/fitlerableCategories.js <a href="#orgb1cb3e0">ng:factory</a>
</p>
</div>
</div>

<div id="outline-container-org3b3d93e" class="outline-4">
<h4 id="org3b3d93e"><span class="section-number-4">13.2.2</span> Calling Order</h4>
<div class="outline-text-4" id="text-13-2-2">
<p>
app.config()
app.run() 
directive's compile functions (if exist)
app.controller()
directive's link functions
</p>
</div>
</div>

<div id="outline-container-orge931669" class="outline-4">
<h4 id="orge931669"><span class="section-number-4">13.2.3</span> Config <a id="org343b0ac">ng:config</a></h4>
<div class="outline-text-4" id="text-13-2-3">
<p>
<a id="org0300227">ng:html5mode</a>
</p>
<pre class="example">
angular
  .module('ajsNgComponents')
  .config(locatgionProviderConfig)
  // .config is to run a Provider function
  // ng:provider
  .value('layout','boxed_fullwidth')
  .value('layoutClass', {
    boxed_fullwidth: 'col-lg-3 col-md-4 col-sm-6 col-xs-12',
    boxed_left: 'col-lg-4 col-md-6 col-sm-6 col-xs-12',
    boxed_right: 'col-lg-4 col-md-6 col-sm-6 col-xs-12'
  });

// Enable html5mode
locatgionProviderConfig.$inject = ['$locationProvider'];
function locatgionProviderConfig($locationProvider) {
  $locationProvider.html5Mode({
    enabled: true,
    requireBase: false
  });
}
</pre>
</div>
</div>

<div id="outline-container-orgcbffa9d" class="outline-4">
<h4 id="orgcbffa9d"><span class="section-number-4">13.2.4</span> Run</h4>
<div class="outline-text-4" id="text-13-2-4">
<p>
Run injection is a bit different
</p>
<pre class="example">
app.run(ajsRun);
// Not app.run('ajsRun', ajsRun);

ajsRun.$inject = ['$rootScope'];
function ajsRun($rootScope) {

}

</pre>
</div>
</div>

<div id="outline-container-orgfca8245" class="outline-4">
<h4 id="orgfca8245"><span class="section-number-4">13.2.5</span> Filter <a id="org1e44764">ng:filter</a></h4>
<div class="outline-text-4" id="text-13-2-5">
<pre class="example">
angular
  .module('ajsNgComponents')
  .filter('singleListingFilter', singleListingFilter)
  .filter('item_category_value', item_category_value)
  .filter('ignore_empty_value', ignore_empty_value)
  .filter('translate', translate);

// $scope can't be injected to filter
// Instead, pass scope.varname as a param into filter.
// Or inject $rootScope

// In view
/*
&lt;tr ng-repeat="detail in details | ignore_empty_value:aListing"
 ng-init="detail = aListing.post_meta.options[detailKey]"&gt;
  &lt;td ng-bind="(detail.name | translate:detail)"&gt;&lt;/td&gt;
  &lt;td ng-bind="(detail.value | translate)"&gt;&lt;/td&gt;
&lt;/tr&gt;
*/

function singleListingFilter() {
  return function(items,var1) {
    var r = [];
    for (var i= 0, len=items.length; i&lt; len; i++) {
      if (items[i].id == var1){
        r.push(items[i]);
        break;
      }
    }
    return r;
  };
}

// &lt;td ng-bind="((x.options | item_category_value:detail:lwp_options) | translate)"&gt;&lt;/td&gt;
function item_category_value() {
  return function(options, category, lwp_options) {
    var value = "";
    return value;
  };
}

function ignore_empty_value() {
  return function(items, aListing) {
    var r = [];
    angular.forEach(items, function(item) {
      if (aListing.post_meta.options[item].value) {
        r.push(item);
      }
    });
    return r;
  };
}

translate.$inject = ['$rootScope'];
function translate($rootScope) {
  return function(word, languages) {
    var r = word;
    if (typeof $rootScope.lang !== "undefined") {
      if ( typeof languages !== "undefined"
        &amp;&amp; typeof languages['lang'] !== "undefined"
        &amp;&amp; typeof languages['lang'][$rootScope.lang] !== "undefined") {
        r = languages['lang'][$rootScope.lang];
      }
      else {
        r = $rootScope.translate_text(word);
      }
    }
    return r;
  };
}
</pre>
</div>
</div>

<div id="outline-container-org62f358c" class="outline-4">
<h4 id="org62f358c"><span class="section-number-4">13.2.6</span> Factory <a id="orgb1cb3e0">ng:factory</a></h4>
<div class="outline-text-4" id="text-13-2-6">
<p>
Factory is better than app.value();
</p>
<pre class="example">
(function() {
  'use strict';
  angular
    .module('ajsNgComponents')
    .factory('filterableCategories', filterableCategories)
    .factory('clientId', clientIdFactory)
    .factory('apiToken', apiTokenFactory);

  // Inject $rootScope so that any method defined here can use
  filterableCategories.$inject = ['$rootScope'];
  function filterableCategories($rootScope) {
    return {
      getFilters: getFilters,
      getListingsFilterObjByURL: getListingsFilterObjByURL,
      getSelectedFiltersObjByURL: getSelectedFiltersObjByURL,
      getSearchInventoryDropdown: getSearchInventoryDropdown
    };

    function getFilters(filterable_categories, lwp_options) {
      // $rootScope can be used here
      var r = [];
      return r;
    }
  }

  function clientIdFactory() {
    return '123';
  }

  apiTokenFactory.$inject = ['clientId'];
  function apiTokenFactory(clientId) {
    var encrypt = function(data1, data2) {
      return data1+data2;
    }
    var secret = window.localStorage.getItem('secret');
    var apiToken = encrypt(clientId, secret);
    return apiToken;
  }

})();
</pre>
</div>
</div>

<div id="outline-container-org2179f5a" class="outline-4">
<h4 id="org2179f5a"><span class="section-number-4">13.2.7</span> Service <a id="org23de8d3">ng:service</a></h4>
<div class="outline-text-4" id="text-13-2-7">
<pre class="example">
app.service('unicornLauncher', UnicornLauncherService);
UnicornLauncherService.$inject = ['apiToken'];
function UnicornLauncherService(apiToken) {
  this.launchedCount = 0;
  this.launch = function () {
    // Use apiToken to do something
    this.launchedCount++;
  }
}
</pre>
</div>
</div>

<div id="outline-container-orgda61c74" class="outline-4">
<h4 id="orgda61c74"><span class="section-number-4">13.2.8</span> Provider <a id="org4b5392e">ng:provider</a></h4>
<div class="outline-text-4" id="text-13-2-8">
<p>
Provider is a service and it's the only thing can be inserted to .config
</p>

<p>
Instantiation happens in config
</p>
<pre class="example">
app.config(myProviderConfig);
myProviderConfig.$inject = ['myProviderProvider'];
function myProviderConfig(myProviderProvider){
  myProviderProvider.thingFromConfig = 'This was set in config';
});
</pre>

<p>
Define myProvider
</p>
<pre class="example">
app.provider('myProvider', function(){
 // app.config() can only access the next 2 lines
 this._artist = '';
 this.thingFromConfig = '';

 this.$get = function(){
   var that = this;

   return {
     getArtist: function(){
       return that._artist;
     },
     thingOnConfig: that.thingFromConfig,
     unicornLauncher: newUnicornLauncher
   }

   newUnicornLauncher.$inject = ['apiToken'];
   function newUnicornLaunder(apiToken) {
     return new UnicornLauncherService(apiToken);
   }

 }
});
</pre>

<pre class="example">
app.controller('myProvider', function($scope, myProvider){
  $scope.artist = myProvider.getArtist();
  $scope.data.thingFromConfig = myProvider.thingOnConfig;
});
</pre>
</div>
</div>

<div id="outline-container-orga704ce0" class="outline-4">
<h4 id="orga704ce0"><span class="section-number-4">13.2.9</span> Change URL without reloading page</h4>
<div class="outline-text-4" id="text-13-2-9">
<p>
First enable <a href="#org0300227">ng:html5mode</a>
</p>

<p>
inject $location and $window
</p>
<pre class="example">
myNewUrl = '/path/?p=1&amp;q=2';
$location.url(myNewUrl);
$location.replace();
$window.history.pushState(null, 'any', $location.absUrl());
</pre>
</div>
</div>
</div>

<div id="outline-container-org5f19a52" class="outline-3">
<h3 id="org5f19a52"><span class="section-number-3">13.3</span> 2.x Angular</h3>
<div class="outline-text-3" id="text-13-3">
<p>
<a href="https://github.com/planetoftheweb/learnangular">https://github.com/planetoftheweb/learnangular</a>
<a href="https://github.com/coursefiles/angular2-essential-training">https://github.com/coursefiles/angular2-essential-training</a>
</p>
</div>

<div id="outline-container-org4ba9af1" class="outline-4">
<h4 id="org4ba9af1"><span class="section-number-4">13.3.1</span> QuickStart seed</h4>
<div class="outline-text-4" id="text-13-3-1">
</div>
<div id="outline-container-org92e876b" class="outline-5">
<h5 id="org92e876b"><span class="section-number-5">13.3.1.1</span> Install</h5>
<div class="outline-text-5" id="text-13-3-1-1">
<p>
Local dev env which is the same as <a href="https://embed.plnkr.co/?show=preview&amp;show=app%2Fapp.component.ts">Online playground</a>
<a href="https://angular.io/guide/setup">https://angular.io/guide/setup</a>
</p>

<pre class="example">
git clone https://github.com/angular/quickstart.git quickstart
cd quickstart
npm install
npm start
// Default port is localhost:3000
</pre>

<p>
Backup <code>.gitignore</code> 
</p>

<p>
And remove git-related artifacts
</p>
<pre class="example">
// OS/X
xargs rm -rf &lt; non-essential-files.osx.txt
rm src/app/*.spec*.ts
rm non-essential-files.osx.txt

// Windows cmd
for /f %i in (non-essential-files.txt) do del %i /F /S /Q
rd .git /s /q
rd e2e /s /q
</pre>
</div>
</div>

<div id="outline-container-orgbd1e67b" class="outline-5">
<h5 id="orgbd1e67b"><span class="section-number-5">13.3.1.2</span> .gitignore</h5>
<div class="outline-text-5" id="text-13-3-1-2">
<pre class="example">
.idea
node_modules

jspm_packages
npm-debug.log
debug.log
src/**/*.js
!src/systemjs.config.extras.js
!src/systemjs.config.js
!src/systemjs-angular-loader.js
*.js.map
e2e/**/*.js
e2e/**/*.js.map
_test-output
_temp
</pre>
</div>
</div>

<div id="outline-container-orge360b55" class="outline-5">
<h5 id="orge360b55"><span class="section-number-5">13.3.1.3</span> Files</h5>
<div class="outline-text-5" id="text-13-3-1-3">
<p>
<a href="https://angular.io/guide/setup-systemjs-anatomy">https://angular.io/guide/setup-systemjs-anatomy</a>
</p>

<p>
src/main.ts
It's loaded in index.html as in
<code>System.import('main.js').catch(function(err){ console.error(err); });</code>
Refer to <a href="#orga5e88e9">ng:bootstrap</a>
</p>

<p>
src/systemjs.config.js
It's loaded in index.html. Tells systemJS module loader where to find modules referenced in JS <code>import</code> statements.
e.g. <code>import { Component } from '@angular/core'</code>
</p>

<p>
src/tsconfig.json :: how to transpile TypeScript files into JS files
</p>

<p>
src/app/app.module.ts :: <a href="#orgaa5fc9e">ng:root module</a>
src/app/app.component.ts :: tree of components <a href="#orgfe78fae">ng:component</a>
</p>

<p>
package.json
tslint.json :: Inspect TypeScript code and complains when there's violation
bs-config.json :: lite-server BrowserSync setting
</p>
</div>
</div>
</div>

<div id="outline-container-org05b9555" class="outline-4">
<h4 id="org05b9555"><span class="section-number-4">13.3.2</span> SystemJS vs Webpack</h4>
<div class="outline-text-4" id="text-13-3-2">
<p>
Quickstart uses SystemJS to dynamically load files on demand on the client side. It's also called lazy load.
Angular CLI uses Webpack to prepare files. Also does file minifying, transpilation (e.g. from SASS to CSS).
</p>
</div>
</div>

<div id="outline-container-orgaa2ce37" class="outline-4">
<h4 id="orgaa2ce37"><span class="section-number-4">13.3.3</span> package.json</h4>
<div class="outline-text-4" id="text-13-3-3">
<p>
<a href="https://angular.io/guide/npm-packages">https://angular.io/guide/npm-packages</a>
</p>
</div>

<div id="outline-container-org998eec9" class="outline-5">
<h5 id="org998eec9"><span class="section-number-5">13.3.3.1</span> devDependencies</h5>
<div class="outline-text-5" id="text-13-3-3-1">
<pre class="example">
"devDependencies": {
    "concurrently": "^3.2.0",
    "lite-server": "^2.2.2", // static file server
    "typescript": "~2.1.0", // tsc TypeScript compiler

    "canonical-path": "0.0.2",
    "tslint": "^3.15.1",
    "lodash": "^4.16.4",
    "jasmine-core": "~2.4.1",
    "karma": "^1.3.0",
    "karma-chrome-launcher": "^2.0.0",
    "karma-cli": "^1.0.1",
    "karma-jasmine": "^1.0.2",
    "karma-jasmine-html-reporter": "^0.2.2",
    "protractor": "~4.0.14",
    "rimraf": "^2.5.4",

    "@types/node": "^6.0.46",
    "@types/jasmine": "2.5.36"
}
</pre>
</div>
</div>

<div id="outline-container-org9429c1d" class="outline-5">
<h5 id="org9429c1d"><span class="section-number-5">13.3.3.2</span> dependencies</h5>
<div class="outline-text-5" id="text-13-3-3-2">
<pre class="example">
"dependencies": {
    "@angular/common": "~4.0.0", // common services, pipes, and directives provided by Angular
    "@angular/compiler": "~4.0.0", // Angular Template Compiler
    "@angular/core": "~4.0.0", // e.g. all metadata decorators, Component, Directive, dependency injection and component lifecycle hooks
    "@angular/forms": "~4.0.0",
    "@angular/http": "~4.0.0", // Angular's HTTP client.
    "@angular/platform-browser": "~4.0.0", // DOM and browser related. Native directives, pipes, etc. Help render into DOM.
    "@angular/platform-browser-dynamic": "~4.0.0", 
    // Include Providers and a bootstrap method for apps that compile templates on the client.
    // Don't use offline compilation, use this for bootstrapping during dev and for bootstrapping plunker samples
    "@angular/router": "~4.0.0", // Component router

    "angular-in-memory-web-api": "~0.3.0", // Angular simulates a remote server's web api without requiring an actual server or real HTTP calls.
    "systemjs": "0.19.40", // A dynamic module loader compatible with ES2015 module specs. Alternative webpack
    "core-js": "^2.4.1", // polyfill
    "rxjs": "5.0.1", // polyfill
    "zone.js": "^0.8.4" // polyfill
}
</pre>
</div>
</div>

<div id="outline-container-org2c0a988" class="outline-5">
<h5 id="org2c0a988"><span class="section-number-5">13.3.3.3</span> scripts</h5>
<div class="outline-text-5" id="text-13-3-3-3">
<pre class="example">
"scripts": {
    "build": "tsc -p src/",
    "build:watch": "tsc -p src/ -w",
    "build:e2e": "tsc -p e2e/",
    "serve": "lite-server -c=bs-config.json",
    "serve:e2e": "lite-server -c=bs-config.e2e.json",
    "prestart": "npm run build",
    "start": "concurrently \"npm run build:watch\" \"npm run serve\"",
    "pree2e": "npm run build:e2e",
    "e2e": "concurrently \"npm run serve:e2e\" \"npm run protractor\" --kill-others --success first",
    "preprotractor": "webdriver-manager update",
    "protractor": "protractor protractor.config.js",
    "pretest": "npm run build",
    "test": "concurrently \"npm run build:watch\" \"karma start karma.conf.js\"",
    "pretest:once": "npm run build",
    "test:once": "karma start karma.conf.js --single-run",
    "lint": "tslint ./src/**/*.ts -t verbose"
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaf896f5" class="outline-4">
<h4 id="orgaf896f5"><span class="section-number-4">13.3.4</span> tsconfig.json, d.ts, lib.d.ts</h4>
<div class="outline-text-4" id="text-13-3-4">
<p>
<a href="https://angular.io/guide/typescript-configuration">https://angular.io/guide/typescript-configuration</a>
<a href="http://www.typescriptlang.org/docs/handbook/tsconfig-json.html">http://www.typescriptlang.org/docs/handbook/tsconfig-json.html</a>
</p>

<p>
Quickstart src/tsconfig.json
</p>
<pre class="example">
{
  "compilerOptions": {
    "target": "es5",
    "module": "commonjs",
    "moduleResolution": "node",
    "sourceMap": true,
    "emitDecoratorMetadata": true,
    "experimentalDecorators": true,
    "lib": [ "es2015", "dom" ],
    "noImplicitAny": true,
    "suppressImplicitAnyIndexErrors": true
  }
}
</pre>

<p>
Angular CLI src/tsconfig.app.json extends ./tsconfig.json. See ./.angular-cli.json
</p>

<p>
d.ts file is a TypeScript Declaration file, which tells the compiler what libraries you load.
</p>

<p>
Libraries, such as jQuery and Angular extend the JavaScript environment with features and syntax.
<code>node_modules/@angular/core/</code> folder contains several d.ts files. You don't need to do anything to get these typing files for Angular library packages.
</p>

<p>
lib.XXX.d.ts
Typescript includes many lib.XXX.d.ts files for you to load ambient declarations.
In tsconfig.json for Quickstart, there's a line to load lib.es2015.d.ts and lib.dom.d.ts
Based on the <code>--target</code>, TypeScript adds other declarations automatically like <code>Promose</code> if the target is <code>es6</code>
</p>
<pre class="example">
"lib": ["es2015", "dom"]
</pre>

<p>
Since many libraries, e.g. jQuery, Jasmine and Lodash, do not include d.ts files in npm packages.
</p>

<p>
npm install these scoped packages <code>@types/*</code> and Typescript automatically recognizes them.
Quickstart dependencies have 2: <code>@types/node</code> <code>@types/jasmine</code>
</p>
</div>
</div>

<div id="outline-container-orgac15fd3" class="outline-4">
<h4 id="orgac15fd3"><span class="section-number-4">13.3.5</span> lite-server</h4>
<div class="outline-text-4" id="text-13-3-5">
<p>
<a href="https://www.npmjs.com/package/lite-server">https://www.npmjs.com/package/lite-server</a>
</p>
</div>
</div>

<div id="outline-container-org7a10b2f" class="outline-4">
<h4 id="org7a10b2f"><span class="section-number-4">13.3.6</span> CLI</h4>
<div class="outline-text-4" id="text-13-3-6">
<p>
<a href="https://github.com/angular/angular-cli">https://github.com/angular/angular-cli</a>
<a href="https://github.com/angular/angular-cli/wiki">https://github.com/angular/angular-cli/wiki</a>
</p>
</div>

<div id="outline-container-orge764a00" class="outline-5">
<h5 id="orge764a00"><span class="section-number-5">13.3.6.1</span> Install &amp; Update</h5>
<div class="outline-text-5" id="text-13-3-6-1">
<pre class="example">
# Install or update
npm install -g @angular/cli
</pre>

<p>
Update :: update both the global package and your project's local package.
</p>

<pre class="example">
# Global package:

npm uninstall -g @angular/cli
npm cache clean
npm install -g @angular/cli@latest
Local project package:

rm -rf node_modules dist 
# use this in Windows Command Prompt
# rmdir /S/Q node_modules dist
# use this in Windows PowerShell
# rm -r -fo node_modules,dist
npm install --save-dev @angular/cli@latest
npm install
</pre>
</div>
</div>

<div id="outline-container-orgf4820d3" class="outline-5">
<h5 id="orgf4820d3"><span class="section-number-5">13.3.6.2</span> Generate Component, Directive, Pipes and Services</h5>
<div class="outline-text-5" id="text-13-3-6-2">
<p>
CLI adds reference in app.module.ts automatically.
</p>
<pre class="example">
# ng generate
ng g component my-new-component
ng g component ../newer-cmp
ng g component feature/new-cmp
ng g directive new-directive
ng g pipe new-pipe
ng g service new-service
ng g class new-class
ng g guard new-guard
ng g interface new-interface
ng g enum new-enum
ng g module new-module 
</pre>
</div>
</div>

<div id="outline-container-org3ca9c5a" class="outline-5">
<h5 id="org3ca9c5a"><span class="section-number-5">13.3.6.3</span> New project</h5>
<div class="outline-text-5" id="text-13-3-6-3">
<pre class="example">
ng new my-project
cd my-project
ng serve
</pre>

<p>
src/index.html doesn't include any javascript files while quickstart includes some.
</p>
</div>
</div>

<div id="outline-container-orgdda643e" class="outline-5">
<h5 id="orgdda643e"><span class="section-number-5">13.3.6.4</span> build</h5>
<div class="outline-text-5" id="text-13-3-6-4">
<p>
<code>ng build --prod</code> :: Delete and add files to ./dist
</p>

<p>
All commands that build or serve your project, <code>ng build/serve/e2e</code>, will delete the output directory (dist/ by default). This can be disabled via the <code>--no-delete-output-path</code> (or <code>--delete-output-path=false</code>) flag.
</p>
</div>
</div>

<div id="outline-container-orga579e0b" class="outline-5">
<h5 id="orga579e0b"><span class="section-number-5">13.3.6.5</span> eject <a id="orge5dfe71">ng:cli:webpack</a></h5>
<div class="outline-text-5" id="text-13-3-6-5">
<p>
Do this after you have stopped <code>ng serve</code>. This will copy the webpack configuration and modify .angular-cli.json and package.json.
Do <code>git status --ignored</code> to see the webpack configurations.
After <code>ng eject</code>, ng commands will not work. See changes in package.json. Such as: instead of <code>ng serve</code>, do <code>npm run build &amp; npm run start</code>
You can now modify webpack configuration with real effects.
</p>

<p>
<code>ng eject --prod</code> production environment. It includes UglifyJsPlugin
<a href="#org412cd27">npm:webpack</a>
</p>

<p>
Bundle files are main.ts, polyfills.ts and styles.css
</p>
</div>
</div>
</div>

<div id="outline-container-orgf7b600d" class="outline-4">
<h4 id="orgf7b600d"><span class="section-number-4">13.3.7</span> Polyfills</h4>
<div class="outline-text-4" id="text-13-3-7">
<p>
<a href="https://angular.io/guide/browser-support">Other polyfills</a>
</p>
<pre class="example">
&lt;script src="node_modules/core-js/client/shim.min.js"&gt;&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-org01f140d" class="outline-4">
<h4 id="org01f140d"><span class="section-number-4">13.3.8</span> Bootstrap <a id="orga5e88e9">ng:bootstrap</a></h4>
<div class="outline-text-4" id="text-13-3-8">
<p>
Create a browser platform for dynamic compilation (JIT) and bootstraps the AppModule by referring to the root module app.module.ts
Refer to <a href="#orgaa5fc9e">ng:root module</a>
</p>
<pre class="example">
import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';

import { AppModule } from './app/app.module';

platformBrowserDynamic().bootstrapModule(AppModule);
</pre>
</div>
</div>

<div id="outline-container-org50a724b" class="outline-4">
<h4 id="org50a724b"><span class="section-number-4">13.3.9</span> Root Module <a id="orgaa5fc9e">ng:root module</a></h4>
<div class="outline-text-4" id="text-13-3-9">
<pre class="example">
import { NgModule }      from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { AppComponent }  from './app.component';
// import { FormsModule } from '@angular/forms';

// This decorator makes AppModule as an Angular module class (NgModule class).
// a metadata object to tell Angular how to compile and launch the app
@NgModule({
  // Only put NgModule classes in imports array
  imports:      [ BrowserModule
    // , FormsModule
  ],
  // Only declarables - components, directives and pipes - belong in declarations array. Not NgModule classes
  declarations: [ AppComponent ],
  // Create components listed in the bootstrap array and insert each one into browser DOM
  // It's common to only include one tree of components, which is one file: app.component.ts
  bootstrap:    [ AppComponent ]
})
export class AppModule { }
</pre>
</div>
</div>

<div id="outline-container-org4887cf9" class="outline-4">
<h4 id="org4887cf9"><span class="section-number-4">13.3.10</span> ngModule</h4>
<div class="outline-text-4" id="text-13-3-10">
<p>
<a href="https://angular.io/guide/ngmodule">https://angular.io/guide/ngmodule</a>
</p>
</div>
</div>

<div id="outline-container-org73ec0ae" class="outline-4">
<h4 id="org73ec0ae"><span class="section-number-4">13.3.11</span> Component</h4>
<div class="outline-text-4" id="text-13-3-11">
<p>
<a id="orgfe78fae">ng:component</a> is to create a new html element. It's also a directive with a template
Refer to <a href="#orge565b9e">ng:api:component</a>
</p>

<p>
src/app/app.component.ts
</p>
<pre class="example">
import { Component } from '@angular/core';

// Decorator
@Component({
  selector: 'my-app',
  template: `&lt;h1&gt;Hello {{name}}&lt;/h1&gt;`,
  inputs: ['inputVar1'],  // Use this or @Input. Refer to ng:input output
  outputs: ['outputVar1'], // Use this or @Output. Refer to ng:input output
})
export class AppComponent  { name = 'Angular'; }
</pre>
</div>
</div>

<div id="outline-container-orgec1b9a4" class="outline-4">
<h4 id="orgec1b9a4"><span class="section-number-4">13.3.12</span> Template</h4>
<div class="outline-text-4" id="text-13-3-12">
</div>
<div id="outline-container-org4ef59d1" class="outline-5">
<h5 id="org4ef59d1"><span class="section-number-5">13.3.12.1</span> Files</h5>
<div class="outline-text-5" id="text-13-3-12-1">
<p>
src/app/[component-name]/[component-name].component.html
src/app/[component-name]/[component-name].component.css
src/app/[component-name]/[component-name].component.ts
</p>

<p>
src/app/heroes/heroes.component.ts
Use component-relative URLs, prefixed with <code>./</code>
</p>
<pre class="example">
@Component({
  selector: 'toh-heroes',
  templateUrl: './heroes.component.html', // template or templateUrl, can't be both
  styleUrls:  ['./heroes.component.css'] // each css file is independent! Don't worry about CSS conflicts
  // , styles: [ ".btn {background-color: green;}", ".btn:hover {background-color: pink;}"]
})

export class HeroesComponent implements OnInit {
  /* name = 'abc'; 
     artists: string[]; // could be any
  */
  /* or 
     name: string;
     constructor() {
       this.name = 'abc';
       this.artists = ["1", "2"]
     }
  */

  heroes: Observable&lt;Hero[]&gt;;
  selectedHero: Hero;

 onClick(e) {
  // event
  // console.log(e);
  this.name = e.target.innerHTML;
 }

 addArtist(v) {
   if (v!=='') {
     this.artists.push({
       name: v,
       school: 'abc'
     });
   } 
 } 

 constructor(private heroService: HeroService) { }

  ngOnInit() {
    this.heroes = this.heroService.getHeroes();
  }
}
</pre>

<p>
src/app/heroes/heroes.component.html
</p>
<pre class="example">
&lt;div&gt;
  &lt;h2&gt;My Heroes&lt;/h2&gt;
  &lt;ul class="heroes"&gt;
    &lt;li *ngFor="let hero of heroes | async" (click)="selectedHero=hero"&gt;
      &lt;span class="badge"&gt;{{hero.id}}&lt;/span&gt; {{hero.name}}
    &lt;/li&gt;
  &lt;/ul&gt;
  &lt;div *ngIf="selectedHero"&gt;
    &lt;h2&gt;{{selectedHero.name | uppercase}} is my hero&lt;/h2&gt;
  &lt;/div&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org61e1a2e" class="outline-5">
<h5 id="org61e1a2e"><span class="section-number-5">13.3.12.2</span> <code>{{ }}</code></h5>
<div class="outline-text-5" id="text-13-3-12-2">
<p>
Nonsupported in <code>{{ }}</code>
</p>
<ul class="org-ul">
<li>Assignments</li>
<li>Newing up variables</li>
<li>Chaining expressions</li>
<li>Incrementing/decrementing</li>
</ul>

<p>
A function can be run
</p>
<pre class="example">
&lt;div&gt;{{ wasWatched() }}&lt;/div&gt;

export class MediaItemComponent { 
  wasWatched() {
    return true;
  }
}
</pre>
</div>
</div>

<div id="outline-container-orgb80cc82" class="outline-5">
<h5 id="orgb80cc82"><span class="section-number-5">13.3.12.3</span> Styles</h5>
<div class="outline-text-5" id="text-13-3-12-3">
<p>
Module bundler like Webpack can load sytles from external files at build time.
<code>styles: [require('my.component.css')]</code>
</p>

<p>
Use <code>:host</code> to target the host element (one element)
</p>

<p>
<code>:host-context()</code> looks for a CSS class in any ancestor of the component host element, up to the document root. 
The :host-context() selector is useful when combined with another selector.
</p>

<p>
This applies a background-color style to all &lt;h2&gt; elements inside the component, 
only if some ancestor element has the CSS class theme-light.
</p>

<pre class="example">
:host-context(.theme-light) h2 {
  background-color: #eef;
}
</pre>

<p>
<code>/deep/</code> or <code>&gt;&gt;&gt;</code> works to any depth of nested components, and it applies to both the view children and content children of the component.
</p>

<p>
This targets all &lt;h3&gt; elements, from the host element down through this component to all of its child elements in the DOM.
</p>
<pre class="example">
:host /deep/ h3 {
  font-style: italic;
}
</pre>

<p>
Use <code>/deep/</code> and <code>&gt;&gt;&gt;</code> selectors only with emulated view encapsulation. 
Emulated is the default and most commonly used <a href="https://angular.io/guide/component-styles#view-encapsulation">view encapsulation</a>. Refer to <a href="#org0c2ec36">ng:view encapsulation</a>
</p>

<p>
Use <code>&lt;link&gt;</code> in template, path is relative to the root.
</p>
<pre class="example">
@Component({
  selector: 'hero-team',
  template: `
    &lt;link rel="stylesheet" href="app/hero-team.component.css"&gt;
    &lt;h3&gt;Team&lt;/h3&gt;
    &lt;ul&gt;
      &lt;li *ngFor="let member of hero.team"&gt;
        {{member}}
      &lt;/li&gt;
    &lt;/ul&gt;`
})
</pre>

<p>
Use <code>@imports</code> inside my.component.css
</p>
<pre class="example">
@import 'hero-details-box.css';
</pre>

<p>
<a id="org0c2ec36">ng:view encapsulation</a>
Default is ViewEncapsulation.Emulated, rename CSS code to scope the CSS to the component's view.
ViewEncapsulation.None adds CSS to the global styles.
ViewEncapsulation.Native uses browser's native shadow DOM to attach a shadow DOM to the component's host element.
</p>

<p>
If the encapsulation is set to ViewEncapsulation.Emulated and the component has no styles nor styleUrls, the encapsulation will automatically be switched to ViewEncapsulation.None.
</p>
<pre class="example">
@Component({
  selector: 'toh-heroes',
  templateUrl: './heroes.component.html',
  styleUrls:  ['./heroes.component.css'],
  encapsulation: ViewEncapsulation.Emulated
})
</pre>
</div>
</div>

<div id="outline-container-org248b412" class="outline-5">
<h5 id="org248b412"><span class="section-number-5">13.3.12.4</span> Event <code>(eventType)</code></h5>
<div class="outline-text-5" id="text-13-3-12-4">
<p>
<a href="https://angular.io/guide/template-syntax#event-binding">https://angular.io/guide/template-syntax#event-binding</a>
</p>

<pre class="example">
(click)="onClick($event)"
(input)="name=$event.target.value"
(keyup.enter)="addArtist(newArtist.value); newArtist.value=''"
</pre>

<p>
$event is a DOM event object
</p>
</div>
</div>

<div id="outline-container-org443ff8a" class="outline-5">
<h5 id="org443ff8a"><span class="section-number-5">13.3.12.5</span> Template Reference variable <code>#var</code></h5>
<div class="outline-text-5" id="text-13-3-12-5">
<pre class="example">
&lt;input #newArtist (keyup.enter)="addArtist(newArtist.value); newArtist.value=''"&gt;
&lt;button (click)="addArtist(newArtist.value); newArtist.value=''"&gt;Add&lt;/button&gt;
</pre>

<p>
<code>#newArtist</code> can be used anywhere in the template.
</p>
</div>
</div>

<div id="outline-container-org0a37db9" class="outline-5">
<h5 id="org0a37db9"><span class="section-number-5">13.3.12.6</span> One-way binding</h5>
<div class="outline-text-5" id="text-13-3-12-6">
<pre class="example">
// Instead of
&lt;lable&gt;Search &lt;span *ngIf="name"&gt;for: {{ name }}&lt;/span&gt;&lt;/label&gt;

// Use
&lt;lable&gt;Search &lt;span *ngIf="name" [innerHTML]="' for: ' + name"&gt;&lt;/span&gt;&lt;/lable&gt;
// [innerHTML] can be bind-innerHTML

// Or use
&lt;span innerHTML="{{ ' for: ' + name }}"

// DOM element attribute
&lt;img [src]="iconUrl"/&gt;

// Bind clicked DOM element to a variable
&lt;ul class="heroes"&gt;
  &lt;li #selectedHero *ngFor="let hero of heroes | async" (click)="onClick(hero, selectedHero)"&gt;
    &lt;span class="badge"&gt;{{hero.id}}&lt;/span&gt; {{hero.name}}
  &lt;/li&gt;
&lt;/ul&gt;

// inside export class
onClick(item, myElement) {
  this.name = item.name;
  myElement.style.backgroundColor="red";
}
</pre>
</div>
</div>

<div id="outline-container-org4c4ba63" class="outline-5">
<h5 id="org4c4ba63"><span class="section-number-5">13.3.12.7</span> Two-way binding <code>[(x)]</code> <code>[(ngModel)]</code> <code>[ngModel]</code> <code>(ngModelChange)</code></h5>
<div class="outline-text-5" id="text-13-3-12-7">
<pre class="example">
&lt;input #newArtist 
[value]="name"
(input)="name=$event.target.value"
(keyup.enter)="addArtist(newArtist.value); newArtist.value=''"&gt;

// It's equivalent to
&lt;input #newArtist 
[(ngModel)]="name"
(keyup.enter)="addArtist(newArtist.value); newArtist.value=''"&gt;
</pre>

<pre class="example">
&lt;input
  [ngModel]="currentHero.name"
  (ngModelChange)="setUppercaseName($event)"&gt;
</pre>

<p>
ngModel needs <a href="#org517a6f3">ng:FormsModule</a>
</p>
</div>
</div>

<div id="outline-container-orgc8cf631" class="outline-5">
<h5 id="orgc8cf631"><span class="section-number-5">13.3.12.8</span> @Input, @Output <a id="orgdd38f1c">ng:input output</a></h5>
<div class="outline-text-5" id="text-13-3-12-8">
<p>
media-item.component.ts
</p>
<pre class="example">
import { Component, Input } from '@angular/core';

@Component({
    selector: 'mw-media-item',
    templateUrl: './media-item.component.html',
    styleUrls: ['./media-item.component.css']
})
export class MediaItemComponent {
    // @Input('mediaItemToWatch') mediaItem;
    // The mediaItemToWatch is an alias of mediaItem
    // It's not recommended to have alias
    @Input() mediaItem;

    // strict typing
    @Input()  size: number | string;

    @Output() delete = new EventEmitter();
    // Notice delete is defined in sub component and exists inside mw-media-item DOM element

    onDelete() {
       // emit an event to the parent app.component.ts
       this.delete.emit(this.mediaItem);
    }

}
</pre>

<p>
app.component.ts
</p>
<pre class="example">
export class AppComponent {
  onMediaItemDelete(mediaItem) {

  }

  firstMediaItem = {
    id: 1,
    name: "Firebug",
    medium: "Series",
    category: "Science Fiction",
    year: 2010,
    watchedOn: 1294166565384,
    isFavorite: false
  };
}
</pre>

<p>
mediaItem can be used as a new property for binding <code>[mediaItem]</code> or <code>{{mediaItem}}</code>
app.component.html
</p>
<pre class="example">
&lt;section&gt;
  &lt;header&gt;
    &lt;h1&gt;Media Watch List&lt;/h1&gt;
    &lt;p class="description"&gt;Keeping track of the media I want to watch.&lt;/p&gt;
  &lt;/header&gt;
  &lt;mw-media-item 
    [mediaItem]="firstMediaItem"
    (delete)="onMediaItemDelete($event)"&gt;&lt;/mw-media-item&gt;
&lt;/section&gt;
</pre>

<p>
media-item.component.html
</p>
<pre class="example">
&lt;h2&gt;{{ mediaItem.name }}&lt;/h2&gt;
&lt;div&gt;Watched on {{ mediaItem.watchedOn }}&lt;/div&gt;
&lt;div&gt;{{ mediaItem.category }}&lt;/div&gt;
&lt;div&gt;{{ mediaItem.year }}&lt;/div&gt;
&lt;div class="tools"&gt;
  &lt;a class="delete" (click)="onDelete()"&gt;
    remove
  &lt;/a&gt;
  &lt;a class="details"&gt;
    watch
  &lt;/a&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org6799947" class="outline-5">
<h5 id="org6799947"><span class="section-number-5">13.3.12.9</span> Structural directives (builtin) <code>ngIf</code> <code>ngFor</code> <code>ngSwitch</code> <code>&lt;ng-container&gt;</code></h5>
<div class="outline-text-5" id="text-13-3-12-9">
<pre class="example">
&lt;div *ngIf="mediaItem.watchedOn"&gt;Watched on {{ mediaItem.watchedOn }} &lt;/div&gt;
</pre>

<p>
Even though ngIf is true, only &lt;div&gt; will display
</p>
<pre class="example">
&lt;template [ngIf]="mediaItem.watchedOn"&gt;
  &lt;div&gt;Watched on {{ mediaItem.watchedOn }} &lt;/div&gt;
&lt;/template&gt;
</pre>

<p>
ngFor :: refer to <a href="#org4d91dea">ng:pipe</a>
</p>

<p>
ngSwitch
</p>
<pre class="example">
&lt;div [ngSwitch]="hero?.emotion"&gt;
  &lt;happy-hero    *ngSwitchCase="'happy'"    [hero]="hero"&gt;&lt;/happy-hero&gt;
  &lt;sad-hero      *ngSwitchCase="'sad'"      [hero]="hero"&gt;&lt;/sad-hero&gt;
  &lt;confused-hero *ngSwitchCase="'confused'" [hero]="hero"&gt;&lt;/confused-hero&gt;
  &lt;unknown-hero  *ngSwitchDefault           [hero]="hero"&gt;&lt;/unknown-hero&gt;
&lt;/div&gt;
</pre>

<p>
Only one structural directive can be applied to one host element
</p>

<p>
<code>&lt;ng-container&gt;</code>
This is almost works like <code>&lt;template&gt;</code>
</p>
<pre class="example">
&lt;p&gt;
  I turned the corner
  &lt;span *ngIf="hero"&gt;
    and saw {{hero.name}}. I waved
  &lt;/span&gt;
  and continued on my way.
&lt;/p&gt;
</pre>

<p>
In &lt;select&gt;, before we do and dropdown is empty because a browser won't display an &lt;option&gt; within a &lt;span&gt;.
</p>
<pre class="example">
&lt;div&gt;
  Pick your favorite hero
  (&lt;label&gt;&lt;input type="checkbox" checked (change)="showSad = !showSad"&gt;show sad&lt;/label&gt;)
&lt;/div&gt;
&lt;select [(ngModel)]="hero"&gt;
  &lt;span *ngFor="let h of heroes"&gt;
    &lt;span *ngIf="showSad || h.emotion !== 'sad'"&gt;
      &lt;option [ngValue]="h"&gt;{{h.name}} ({{h.emotion}})&lt;/option&gt;
    &lt;/span&gt;
  &lt;/span&gt;
&lt;/select&gt;
</pre>

<pre class="example">
&lt;div&gt;
  Pick your favorite hero
  (&lt;label&gt;&lt;input type="checkbox" checked (change)="showSad = !showSad"&gt;show sad&lt;/label&gt;)
&lt;/div&gt;
&lt;select [(ngModel)]="hero"&gt;
  &lt;ng-container *ngFor="let h of heroes"&gt;
    &lt;ng-container *ngIf="showSad || h.emotion !== 'sad'"&gt;
      &lt;option [ngValue]="h"&gt;{{h.name}} ({{h.emotion}})&lt;/option&gt;
    &lt;/ng-container&gt;
  &lt;/ng-container&gt;
&lt;/select&gt;
</pre>
</div>
</div>

<div id="outline-container-org129df1a" class="outline-5">
<h5 id="org129df1a"><span class="section-number-5">13.3.12.10</span> Attribute directives (builtin) <code>ngClass</code> <code>ngStyle</code></h5>
<div class="outline-text-5" id="text-13-3-12-10">
<p>
media-list.component.html
</p>
<pre class="example">
&lt;section&gt;
  &lt;mw-media-item
    [ngClass]="{'medium-movies': mediaItem.medium==='Movies', 'medium-series':mediaItem.medium==='Series'}" 
    *ngFor="let mediaItem of mediaItems"
    [mediaItem]="mediaItem"
    (delete)="onMediaItemDelete($event)"&gt;&lt;/mw-media-item&gt;
&lt;/section&gt;
</pre>

<p>
<code>[class]</code> or <code>[style]</code> with a string can also be used
</p>
<pre class="example">
&lt;!-- Reset class to badCurly only --&gt;
&lt;div class="bad curly special"
     [class]="badCurly"&gt;Bad curly&lt;/div&gt;

&lt;!-- toggle the "special" class on/off with a property --&gt;
&lt;div [class.special]="isSpecial"&gt;The class binding is special&lt;/div&gt;


&lt;button [style.color]="isSpecial ? 'red': 'green'"&gt;Red&lt;/button&gt;
&lt;button [style.background-color]="canSave ? 'cyan': 'grey'" &gt;Save&lt;/button&gt;
&lt;button [style.font-size.em]="isSpecial ? 3 : 1" &gt;Big&lt;/button&gt;
&lt;button [style.font-size.%]="!isSpecial ? 150 : 50" &gt;Small&lt;/button&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org8ce0e94" class="outline-4">
<h4 id="org8ce0e94"><span class="section-number-4">13.3.13</span> Pipe <a id="org4d91dea">ng:pipe</a></h4>
<div class="outline-text-4" id="text-13-3-13">
</div>
<div id="outline-container-org6892dcc" class="outline-5">
<h5 id="org6892dcc"><span class="section-number-5">13.3.13.1</span> Builtin pipes</h5>
<div class="outline-text-5" id="text-13-3-13-1">
<p>
<a href="https://angular.io/api?query=pipe">https://angular.io/api?query=pipe</a>
</p>

<p>
uppercase, lowercase, titlecase
</p>
</div>
<ol class="org-ol">
<li><a id="org9e08dbd"></a><a href="https://angular.io/api/common/DatePipe">Date</a><br />
<div class="outline-text-6" id="text-13-3-13-1-1">
<p>
<code>date_expression | date[:format]</code>
format
'medium': equivalent to 'yMMMdjms' (e.g. Sep 3, 2010, 12:05:08 PM for en-US)
'short': equivalent to 'yMdjm' (e.g. 9/3/2010, 12:05 PM for en-US)
'fullDate': equivalent to 'yMMMMEEEEd' (e.g. Friday, September 3, 2010 for en-US)
'longDate': equivalent to 'yMMMMd' (e.g. September 3, 2010 for en-US)
'mediumDate': equivalent to 'yMMMd' (e.g. Sep 3, 2010 for en-US)
'shortDate': equivalent to 'yMd' (e.g. 9/3/2010 for en-US)
'mediumTime': equivalent to 'jms' (e.g. 12:05:08 PM for en-US)
'shortTime': equivalent to 'jm' (e.g. 12:05 PM for en-US)
</p>

<pre class="example">
&lt;p&gt;Today is {{today | date}}&lt;/p&gt;
&lt;p&gt;Or if you prefer, {{today | date:'fullDate'}}&lt;/p&gt;
&lt;p&gt;The time is {{today | date:'jmZ'}}&lt;/p&gt;
</pre>
</div>
</li>

<li><a id="orgcb53894"></a>slice<br />
<div class="outline-text-6" id="text-13-3-13-1-2">
<p>
slice:start[:end]
</p>
<pre class="example">
&lt;h2&gt;{{ mediaItem.name | slice:0:10 }}&lt;/h2&gt;
</pre>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgfd35288" class="outline-5">
<h5 id="orgfd35288"><span class="section-number-5">13.3.13.2</span> Custom pipe</h5>
<div class="outline-text-5" id="text-13-3-13-2">
<p>
<a href="https://angular.io/guide/pipes">https://angular.io/guide/pipes</a>
</p>

<p>
src/app/search.pipe.ts
</p>
<pre class="example">
import { Pipe, PipeTransform } from '@angular/core';

@Pipe({
  name: 'search',
  // Default is pure, which means the pipe doesn't change the data
  // pure: true,
})

export class SearchPipe implements PipeTransform {
  // pipe is used in ngFor, the first parameter is the pipe data without specifying in template
  transform(pipeData, pipeModifier) {
    return  pipeData.filter((eachItem)=&gt; {
      return eachItem['name'].toLowerCase().includes(pipeModifier.toLowerCase()) 
          || eachItem['reknown'].toLowerCase().includes(pipeModifier.toLowerCase());
    });
  }

  // Another example for ngFor pipe. It returns an array
  transform(mediaItems) {
    var categories = [];
    mediaItems.forEach(mediaItem =&gt; {
      if (categories.indexOf(mediaItem.category) &lt;= -1) {
        categories.push(mediaItem.category);
      }
    });
    return categories.join(', ');
  }

 /* Another transform interface example */
 /*
 transform(value: number, exponent: string): number {
    let exp = parseFloat(exponent);
    return Math.pow(value, isNaN(exp) ? 1 : exp);
 }
 */

}
</pre>

<p>
app.html
</p>
<pre class="example">
&lt;ul class="artistlist cf"
  *ngIf="query"&gt;
  &lt;li class="artistlist-item cf"
    (click)="showArtist(item); query=''"
    *ngFor="let item of (artists | search: query)"&gt;
    &lt;artist-item class="content" [artist]=item&gt;&lt;/artist-item&gt;
  &lt;/li&gt;
&lt;/ul&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org848d902" class="outline-4">
<h4 id="org848d902"><span class="section-number-4">13.3.14</span> Directive <a id="orgcf849fb">ng:directive</a></h4>
<div class="outline-text-4" id="text-13-3-14">
</div>
<div id="outline-container-org1e5965b" class="outline-5">
<h5 id="org1e5965b"><span class="section-number-5">13.3.14.1</span> Custom attribute directive <code>HostListener</code> <code>HostBinding</code></h5>
<div class="outline-text-5" id="text-13-3-14-1">
<p>
It's better to add prefix 'my' to selector name
hightlight.directive.ts
</p>
<pre class="example">
import { Directive, ElementRef, HostListener, Input } from '@angular/core';

@Directive({
  selector: '[myHighlight]'
})
export class HighlightDirective {

  constructor(private el: ElementRef) { }

  @Input() defaultColor: string;

  @Input('myHighlight') highlightColor: string;

  @HostListener('mouseenter') onMouseEnter() {
    this.highlight(this.highlightColor || this.defaultColor || 'red');
  }

  @HostListener('mouseleave') onMouseLeave() {
    this.highlight(null);
  }

  private highlight(color: string) {
    this.el.nativeElement.style.backgroundColor = color;
  }
}
</pre>

<p>
app.component.html
</p>
<pre class="example">
&lt;h1&gt;My First Attribute Directive&lt;/h1&gt;

&lt;h4&gt;Pick a highlight color&lt;/h4&gt;
&lt;div&gt;
  &lt;input type="radio" name="colors" (click)="color='lightgreen'"&gt;Green
  &lt;input type="radio" name="colors" (click)="color='yellow'"&gt;Yellow
  &lt;input type="radio" name="colors" (click)="color='cyan'"&gt;Cyan
&lt;/div&gt;
&lt;p [myHighlight]="color"&gt;Highlight me!&lt;/p&gt;

&lt;p [myHighlight]="color" defaultColor="violet"&gt;
  Highlight me too!
&lt;/p&gt;

&lt;hr&gt;
&lt;p&gt;&lt;i&gt;Mouse over the following lines to see fixed highlights&lt;/i&gt;&lt;/p&gt;

&lt;p [myHighlight]="'yellow'"&gt;Highlighted in yellow&lt;/p&gt;
&lt;p myHighlight="orange"&gt;Highlighted in orange&lt;/p&gt;
</pre>

<p>
Another example using HostBinding which binds host (DOM) property to a getter or another property
favorite.directive.ts
</p>
<pre class="example">
import { Directive, HostBinding, Input } from '@angular/core';

@Directive({
  selector: '[mwFavorite]'
})
export class FavoriteDirective {
  @HostBinding('class.is-favorite') isFavorite; 
  // Use ~isFavorite = true~ to set a default
  @Input() set mwFavorite(value) {
    this.isFavorite = value;
  }
  /*
 @HostBinding('attr.something') get something() { 
    return this.somethingElse; 
 }
 */
}
</pre>

<p>
media-item.component.html
</p>
<pre class="example">
&lt;h2&gt;{{ mediaItem.name }}&lt;/h2&gt;
&lt;template [ngIf]="mediaItem.watchedOn"&gt;
  &lt;div&gt;Watched on {{ mediaItem.watchedOn }}&lt;/div&gt;
&lt;/template&gt;
&lt;div&gt;{{ mediaItem.category }}&lt;/div&gt;
&lt;div&gt;{{ mediaItem.year }}&lt;/div&gt;
&lt;div class="tools"&gt;
  &lt;svg
    [mwFavorite]="mediaItem.isFavorite"
    class="favorite" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"&gt;
    &lt;path d="M12 9.229c.234-1.12 1.547-6.229 5.382-6.229 2.22 0 4.618 1.551 4.618 5.003 0 3.907-3.627 8.47-10 12.629-6.373-4.159-10-8.722-10-12.629 0-3.484 2.369-5.005 4.577-5.005 3.923 0 5.145 5.126 5.423 6.231zm-12-1.226c0 4.068 3.06 9.481 12 14.997 8.94-5.516 12-10.929 12-14.997 0-7.962-9.648-9.028-12-3.737-2.338-5.262-12-4.27-12 3.737z"
    /&gt;
  &lt;/svg&gt;
  &lt;a class="delete" (click)="onDelete()"&gt;
    remove
  &lt;/a&gt;
  &lt;a class="details"&gt;
    watch
  &lt;/a&gt;
&lt;/div&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org759b7f5" class="outline-4">
<h4 id="org759b7f5"><span class="section-number-4">13.3.15</span> Model and Custom Component</h4>
<div class="outline-text-4" id="text-13-3-15">
<p>
src/app/app.component.ts
</p>
<pre class="example">
import { Component } from '@angular/core';
import { ArtistItemComponent } from './artists/artist-item/artist-item.component';

// Model
export class Artist {
  name: string,
  shortname: string,
  reknown: string,
  bio: string
}

@Component({
  selector: 'my-app',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent { 
  artists = ARTISTS;
  currentArtist: Artist;
}

var ARTISTS: Artist[] = [...]
</pre>

<p>
src/app/app.component.html
</p>
<pre class="example">
&lt;div class="card search"&gt;
  &lt;h1 class="search-headline"&gt;Artist Directory&lt;/h1&gt;
  &lt;label class="search-label"&gt;search
    &lt;span *ngIf="query"
      [innerHTML]="' for: ' + query"&gt;&lt;/span&gt;&lt;/label&gt;
    &lt;input class="search-input"
      [(ngModel)]="query" placeholder="type in search term here"&gt;
&lt;/div&gt;&lt;!-- card search --&gt;

&lt;ul class="artistlist cf"&gt;
  &lt;li class="artistlist-item cf"
    *ngFor="let item of artists"&gt;
    &lt;artist-item class="content" [artist]=item&gt;&lt;/artist-item&gt;
  &lt;/li&gt;
&lt;/ul&gt;
</pre>

<p>
src/app/app.module.ts
</p>
<pre class="example">
import { NgModule } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { FormsModule } from '@angular/forms';

import { AppComponent } from './app.component';
import { ArtistItemComponent } from './artists/artist-item/artist-item.component';

@NgModule({
  imports: [
    BrowserModule, FormsModule
  ],
  declarations: [
    AppComponent, ArtistItemComponent
  ],
  bootstrap: [
    AppComponent
  ]
})

export class AppModule {}
</pre>

<p>
src/app/artists/artist-item/artist-item.component.ts
</p>
<pre class="example">
import { Component } from '@angular/core';

@Component({
  selector: 'artist-item',
  templateUrl: './artist-item.component.html',
  styleUrls: ['./artist-item.component.css'],
  inputs: ['artist']
})

export class ArtistItemComponent {}
</pre>

<p>
src/app/artists/artist-item/artist-item.component.html
</p>
<pre class="example">
&lt;img class="artist-img" 
  src="images/{{artist.shortname}}_tn.jpg"
  alt="{{artist.name}} photo"&gt;
&lt;div class="artist-info"&gt;
  &lt;h2 class="artist-name"&gt;{{ artist.name }}&lt;/h2&gt;
  &lt;h3 class="artist-reknown"&gt;{{ artist.reknown }}&lt;/h3&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-orge7517f3" class="outline-4">
<h4 id="orge7517f3"><span class="section-number-4">13.3.16</span> Form</h4>
<div class="outline-text-4" id="text-13-3-16">
</div>
<div id="outline-container-orgea1925c" class="outline-5">
<h5 id="orgea1925c"><span class="section-number-5">13.3.16.1</span> Template driven <code>ngModel</code> <code>ngSubmit</code></h5>
<div class="outline-text-5" id="text-13-3-16-1">
<p>
The form element has a name, then directly use ngModel
Template driven form requires <a id="org517a6f3">ng:FormsModule</a>
<a href="https://github.com/coursefiles/angular2-essential-training/blob/04_03b/app">https://github.com/coursefiles/angular2-essential-training/blob/04_03b/app</a>
</p>

<p>
<a href="https://github.com/coursefiles/angular2-essential-training/blob/04_03b/app/app.module.ts">https://github.com/coursefiles/angular2-essential-training/blob/04_03b/app/app.module.ts</a>
</p>

<p>
src/app/media-item-form.component.ts
</p>
<pre class="example">
import { Component } from '@angular/core';

@Component({
  selector: 'mw-media-item-form',
  templateUrl: 'app/media-item-form.component.html',
  styleUrls: ['app/media-item-form.component.css']
})
export class MediaItemFormComponent {
  onSubmit(mediaItem) {
    console.log(mediaItem);
  }
}
</pre>

<p>
src/app/media-item-form.component.html
</p>
<pre class="example">
&lt;header&gt;
  &lt;h2&gt;Add Media to Watch&lt;/h2&gt;
&lt;/header&gt;
&lt;form
  #mediaItemForm="ngForm"
  (ngSubmit)="onSubmit(mediaItemForm.value)"&gt;
  &lt;ul&gt;
    &lt;li&gt;
      &lt;label for="medium"&gt;Medium&lt;/label&gt;
      &lt;select name="medium" id="medium" ngModel&gt;
        &lt;option value="Movies"&gt;Movies&lt;/option&gt;
        &lt;option value="Series"&gt;Series&lt;/option&gt;
      &lt;/select&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;label for="name"&gt;Name&lt;/label&gt;
      &lt;input type="text" name="name" id="name" ngModel&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;label for="category"&gt;Category&lt;/label&gt;
      &lt;select name="category" id="category" ngModel&gt;
        &lt;option value="Action"&gt;Action&lt;/option&gt;
        &lt;option value="Science Fiction"&gt;Science Fiction&lt;/option&gt;
        &lt;option value="Comedy"&gt;Comedy&lt;/option&gt;
        &lt;option value="Drama"&gt;Drama&lt;/option&gt;
        &lt;option value="Horror"&gt;Horror&lt;/option&gt;
        &lt;option value="Romance"&gt;Romance&lt;/option&gt;
      &lt;/select&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;label for="year"&gt;Year&lt;/label&gt;
      &lt;input type="text" name="year" id="year" maxlength="4" ngModel&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
  &lt;button type="submit"&gt;Save&lt;/button&gt;
&lt;/form&gt;
</pre>
</div>
</div>

<div id="outline-container-orgbd94e58" class="outline-5">
<h5 id="orgbd94e58"><span class="section-number-5">13.3.16.2</span> Model driven, Validation</h5>
<div class="outline-text-5" id="text-13-3-16-2">
<p>
Model driven form requires <a id="orga26d9a4">ng:ReactiveFormsModule</a> instead of FormsModule. Both can be loaded at the same time
</p>

<p>
<a id="orga779cae">ng:FormGroup</a> <a id="org4363e74">ng:FormControl</a> <a id="org13e0c96">ng:Validators</a>
</p>

<p>
<a href="https://github.com/coursefiles/angular2-essential-training/tree/04_04b/app">https://github.com/coursefiles/angular2-essential-training/tree/04_04b/app</a>
</p>

<p>
<a href="https://github.com/coursefiles/angular2-essential-training/blob/04_04b/app/app.module.ts">https://github.com/coursefiles/angular2-essential-training/blob/04_04b/app/app.module.ts</a>
</p>

<p>
media-item-form.component.ts
</p>
<pre class="example">
import { Component } from '@angular/core';
import { FormGroup, FormControl, Validators } from '@angular/forms';

@Component({
  selector: 'mw-media-item-form',
  templateUrl: 'app/media-item-form.component.html',
  styleUrls: ['app/media-item-form.component.css']
})
export class MediaItemFormComponent {
  form;

  ngOnInit() {
    this.form = new FormGroup({
      medium: new FormControl('Movies'),
      name: new FormControl('', Validators.compose([
        Validators.required, // this field has to pass
        Validators.pattern('[\\w\\-\\s\\/]+')
      ])), // builtin validator
      /* if it's wrong, DOM will have ng-invalid css class but it's not mandatory
      name: new FormControl('', Validators.pattern('[\\w\\-\\s\\/]+')),
      */
      category: new FormControl(''),
      year: new FormControl('', this.yearValidator),
    });
  }  

  yearValidator(control) {
    if (control.value.trim().length === 0) {
      return null;
    }
    let year = parseInt(control.value);
    let minYear = 1800;
    let maxYear = 2500;
    if (year &gt;= minYear &amp;&amp; year &lt;= maxYear) {
      return null;
    } else {
      return {
        'year': {
          min: minYear,
          max: maxYear
        }
      };
    }
  }

  onSubmit(mediaItem) {
    console.log(mediaItem);
  }
}
</pre>

<p>
media-item-form.component.html
</p>
<pre class="example">
&lt;form
  [formGroup]="form"
  (ngSubmit)="onSubmit(form.value)"&gt;
  &lt;ul&gt;
    &lt;li&gt;
      &lt;label for="medium"&gt;Medium&lt;/label&gt;
      &lt;select name="medium" id="medium" formControlName="medium"&gt;
        &lt;option value="Movies"&gt;Movies&lt;/option&gt;
        &lt;option value="Series"&gt;Series&lt;/option&gt;
      &lt;/select&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;label for="name"&gt;Name&lt;/label&gt;
      &lt;input type="text" name="name" id="name" formControlName="name"&gt;
      &lt;div *ngIf="form.controls.name.errors?.pattern" class="error"&gt;
        Name has invalid characters
      &lt;/div&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;label for="category"&gt;Category&lt;/label&gt;
      &lt;select name="category" id="category" formControlName="category"&gt;
        &lt;option value="Action"&gt;Action&lt;/option&gt;
        &lt;option value="Science Fiction"&gt;Science Fiction&lt;/option&gt;
        &lt;option value="Comedy"&gt;Comedy&lt;/option&gt;
        &lt;option value="Drama"&gt;Drama&lt;/option&gt;
        &lt;option value="Horror"&gt;Horror&lt;/option&gt;
        &lt;option value="Romance"&gt;Romance&lt;/option&gt;
      &lt;/select&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;label for="year"&gt;Year&lt;/label&gt;
      &lt;input type="text" name="year" id="year" maxlength="4" formControlName="year"&gt;
      &lt;div *ngIf="form.controls.year.errors?.year" class="error"&gt;
        Must be between 
        {{form.controls.year.errors?.year.min}} 
        and 
        {{form.controls.year.errors?.year.max}}
      &lt;/div&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
  &lt;button type="submit" [disabled]="!form.valid"&gt;Save&lt;/button&gt;
&lt;/form&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org9912918" class="outline-4">
<h4 id="org9912918"><span class="section-number-4">13.3.17</span> Service, Dependency Injection</h4>
<div class="outline-text-4" id="text-13-3-17">
<p>
Either use constructor or @Inject to include a service.
Define services in a provider, when service is injected, if it has been created before, reuse it. If not, create it.
Service is singleton and once it's been created, it will be injectable across the app's life time.
</p>

<p>
Unlike componet, directive and pipe, if a service needs other dependencies, the service needs @Injectable decorator. Refer to <a href="#org381714a">ng:http:get</a>
</p>

<p>
Angular services :: Http, FormBuilder, Router
</p>
</div>

<div id="outline-container-org29af6c0" class="outline-5">
<h5 id="org29af6c0"><span class="section-number-5">13.3.17.1</span> FormBuilder</h5>
<div class="outline-text-5" id="text-13-3-17-1">
<p>
<a id="org24ab562">ng:FormBuilder</a> saves from importing FormControl and FormGroup
</p>

<pre class="example">
import { Component } from '@angular/core';
import { Validators, FormBuilder } from '@angular/forms';

@Component({
  selector: 'mw-media-item-form',
  templateUrl: 'app/media-item-form.component.html',
  styleUrls: ['app/media-item-form.component.css']
})
export class MediaItemFormComponent {
  form;

  constructor(private formBuilder: FormBuilder) {}

  ngOnInit() {
    this.form = this.formBuilder.group({
      medium: this.formBuilder.control('Movies'),
      name: this.formBuilder.control('', Validators.compose([
        Validators.required,
        Validators.pattern('[\\w\\-\\s\\/]+')
      ])),
      category: this.formBuilder.control(''),
      year: this.formBuilder.control('', this.yearValidator),
    });
  }

  yearValidator(control) {
    if (control.value.trim().length === 0) {
      return null;
    }
    let year = parseInt(control.value);
    let minYear = 1800;
    let maxYear = 2500;
    if (year &gt;= minYear &amp;&amp; year &lt;= maxYear) {
      return null;
    } else {
      return {
        'year': {
          min: minYear,
          max: maxYear
        }
      };
    }
  }

  onSubmit(mediaItem) {
    console.log(mediaItem);
  }
}
</pre>
</div>
</div>

<div id="outline-container-orgcc5925f" class="outline-5">
<h5 id="orgcc5925f"><span class="section-number-5">13.3.17.2</span> Custom service and inject variable</h5>
<div class="outline-text-5" id="text-13-3-17-2">
<p>
<a href="https://github.com/coursefiles/angular2-essential-training/tree/05_06b/app">https://github.com/coursefiles/angular2-essential-training/tree/05_06b/app</a>
<a href="https://github.com/coursefiles/angular2-essential-training/tree/05_07b/app">https://github.com/coursefiles/angular2-essential-training/tree/05_07b/app</a>
</p>

<p>
app.module.ts
</p>
<pre class="example">
import { MediaItemService } from './media-item.service'; // inject as a class

// inject as a value
// https://angular.io/api/core/ValueProvider
const lookupLists = {
  mediums: ['Movies', 'Series']
};

@NgModule({
  imports: [ ... ],
  declarations: [ ... ],
  providers: [
    MediaItemService,
    { provide: 'lookupListToken', useValue: lookupLists }
  // Another value provider
  // , { provide: 'lookupListToken2', useValue: 'abc' }
  ],
  bootstrap: [
    AppComponent
  ]
})
export class AppModule {}
</pre>

<p>
media-item.service.ts
</p>
<pre class="example">
export class MediaItemService {
  get() {
    return this.mediaItems;
  }

  add(mediaItem) {
    this.mediaItems.push(mediaItem);
  }

  delete(mediaItem) {
    let index = this.mediaItems.indexOf(mediaItem);
    if(index &gt;= 0) {
      this.mediaItems.splice(index, 1);
    }
  }

  mediaItems = [
    {
      id: 1,
      name: "Firebug",
      medium: "Series",
      category: "Science Fiction",
      year: 2010,
      watchedOn: 1294166565384,
      isFavorite: false
    },
    {...}
  ];
}
</pre>

<p>
media-item-list.component.ts
</p>
<pre class="example">
import { Component } from '@angular/core';

import { MediaItemService } from './media-item.service';

@Component({
  selector: 'mw-media-item-list',
  templateUrl: 'app/media-item-list.component.html',
  styleUrls: ['app/media-item-list.component.css']
})
export class MediaItemListComponent {
  mediaItems;

  constructor(private mediaItemService: MediaItemService) {}

  ngOnInit() {
    this.mediaItems = this.mediaItemService.get();
  }

  onMediaItemDelete(mediaItem) {
    this.mediaItemService.delete(mediaItem);
  }

}
</pre>

<p>
media-item-form.component.ts
</p>
<pre class="example">
import { Component, Inject } from '@angular/core';
// Inject is for injecting the ValueProvider

import { Validators, FormBuilder } from '@angular/forms';

import { MediaItemService } from './media-item.service';

@Component({
  selector: 'mw-media-item-form',
  templateUrl: 'app/media-item-form.component.html',
  styleUrls: ['app/media-item-form.component.css']
})
export class MediaItemFormComponent {
  form;

  constructor(
    private formBuilder: FormBuilder,
    private mediaItemService: MediaItemService,
    @Inject('lookupListToken') public lookupLists) {}

  // private can be used inside the class here as this.xxx
  // public can be used outside the class such as in template as xxx

  ngOnInit() {
    this.form = this.formBuilder.group({ ... });
  }

  yearValidator(control) { ... }

  onSubmit(mediaItem) {
    this.mediaItemService.add(mediaItem);
  }
}
</pre>

<p>
media-item-form.component.html
</p>
<pre class="example">
&lt;form
  [formGroup]="form"
  (ngSubmit)="onSubmit(form.value)"&gt;
  &lt;ul&gt;
    &lt;li&gt;
      &lt;label for="medium"&gt;Medium&lt;/label&gt;
      &lt;select name="medium" id="medium" formControlName="medium"&gt;
        &lt;option *ngFor="let medium of lookupLists.mediums" value="{{medium}}"&gt;{{medium}}&lt;/option&gt;
      &lt;/select&gt;
    &lt;/li&gt;
    ...li
  &lt;/ul&gt;
&lt;/form&gt;
</pre>
</div>
</div>

<div id="outline-container-orgc1a6b1c" class="outline-5">
<h5 id="orgc1a6b1c"><span class="section-number-5">13.3.17.3</span> OpaqueToken, InjectionToken</h5>
<div class="outline-text-5" id="text-13-3-17-3">
<p>
Use this rather than ValueProvider
OpaqueToken is deprecated, use InjectionToken
<a href="https://angular.io/guide/dependency-injection#injection-token">https://angular.io/guide/dependency-injection#injection-token</a>
</p>

<p>
<a href="https://github.com/coursefiles/angular2-essential-training/tree/06_01b/app">https://github.com/coursefiles/angular2-essential-training/tree/06_01b/app</a>
</p>

<p>
providers.ts
</p>
<pre class="example">
import { OpaqueToken } from '@angular/core';

export const lookupListToken = new OpaqueToken('lookupListToken');

export const lookupLists = {
  mediums: ['Movies', 'Series']
};
</pre>

<p>
app.module.ts
</p>
<pre class="example">
import { lookupListToken, lookupLists } from './providers';

@NgModule({
  imports: [ ...  ],
  declarations: [ ... ],
  providers: [
    MediaItemService,
    { provide: lookupListToken, useValue: lookupLists }
  ],
  bootstrap: [
    AppComponent
  ]
})
export class AppModule {}
</pre>

<p>
media-item-form.component.ts
</p>
<pre class="example">
import { lookupListToken } from './provders';

 constructor(
    private formBuilder: FormBuilder,
    private mediaItemService: MediaItemService,
    @Inject(lookupListToken) public lookupLists) {}
</pre>
</div>
</div>

<div id="outline-container-org8f68c60" class="outline-5">
<h5 id="org8f68c60"><span class="section-number-5">13.3.17.4</span> Http</h5>
<div class="outline-text-5" id="text-13-3-17-4">
<p>
<a href="https://angular.io/guide/http">https://angular.io/guide/http</a>
</p>
</div>

<ol class="org-ol">
<li><a id="org7d09095"></a>mock back end <a id="orgd5feecd">ng:mock back end</a><br />
<div class="outline-text-6" id="text-13-3-17-4-1">
<p>
<a href="https://angular.io/guide/http#in-mem-web-api">https://angular.io/guide/http#in-mem-web-api</a>
<a href="https://angular.io/api/http/XHRBackend">https://angular.io/api/http/XHRBackend</a>
<a href="https://github.com/coursefiles/angular2-essential-training/tree/06_03b/app">https://github.com/coursefiles/angular2-essential-training/tree/06_03b/app</a>
</p>

<p>
app.module.ts
</p>
<pre class="example">
import { NgModule } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { ReactiveFormsModule } from '@angular/forms';
import { HttpModule, XHRBackend } from '@angular/http';

import { AppComponent } from './app.component';
import { MediaItemComponent } from './media-item.component';
import { MediaItemListComponent } from './media-item-list.component';
import { FavoriteDirective } from './favorite.directive';
import { CategoryListPipe } from './category-list.pipe';
import { MediaItemFormComponent } from './media-item-form.component';
import { MediaItemService } from './media-item.service';
import { lookupListToken, lookupLists } from './providers';
// new
import { MockXHRBackend } from './mock-xhr-backend';

@NgModule({
  imports: [
    BrowserModule,
    ReactiveFormsModule,
    HttpModule
  ],
  declarations: [
    AppComponent,
    MediaItemComponent,
    MediaItemListComponent,
    FavoriteDirective,
    CategoryListPipe,
    MediaItemFormComponent
  ],
  providers: [
    MediaItemService,
    { provide: lookupListToken, useValue: lookupLists },
    // new
    { provide: XHRBackend, useClass: MockXHRBackend }
  ],
  bootstrap: [
    AppComponent
  ]
})
export class AppModule {}
</pre>

<p>
<a href="https://github.com/coursefiles/angular2-essential-training/blob/06_03b/app/mock-xhr-backend.ts">https://github.com/coursefiles/angular2-essential-training/blob/06_03b/app/mock-xhr-backend.ts</a>
mock-xhr-backend.ts
</p>
</div>
</li>

<li><a id="org763489c"></a>get <a id="org381714a">ng:http:get</a><br />
<div class="outline-text-6" id="text-13-3-17-4-2">
<p>
http.get() returns an Observable&lt;Response&gt;. Refer to <a href="#orgeebf565">js:observable</a>
Observable.map() is one of RxJS operators needed to be imported
</p>

<p>
RxJS is a 3rd party library implements async Observable pattern.
</p>

<p>
<a href="https://github.com/coursefiles/angular2-essential-training/tree/06_04b/app">https://github.com/coursefiles/angular2-essential-training/tree/06_04b/app</a>
</p>

<p>
It uses the paths defined in <a href="#orgd5feecd">ng:mock back end</a>
</p>

<p>
media-item.service.ts
</p>
<pre class="example">
// new
import { Injectable } from '@angular/core';
import { Http } from '@angular/http';
import 'rxjs/add/operator/map';

// This custom service class needs dependency injection, so it needs a decorator Injectable
@Injectable()
export class MediaItemService {
  constructor(private http: Http) {}

  get() {
    // new
    return this.http.get('mediaitems')
      .map(response =&gt; {
        return response.json().mediaItems;
      });
  }

  add(mediaItem) {
    this.mediaItems.push(mediaItem);
  }

  delete(mediaItem) {
    let index = this.mediaItems.indexOf(mediaItem);
    if(index &gt;= 0) {
      this.mediaItems.splice(index, 1);
    }
  }

  mediaItems = [ {}, ... ];
}
</pre>

<p>
media-item-list.component.ts
</p>
<pre class="example">
ngOnInit() {
    this.getMediaItems(this.medium);
}
getMediaItems(medium) {
    this.medium = medium;
    this.mediaItemService.get()
      .subscribe(mediaItems =&gt; {
        this.mediaItems = mediaItems;
      });
}
</pre>
</div>
</li>

<li><a id="orgead0275"></a>get with URLSearchParams<br />
<div class="outline-text-6" id="text-13-3-17-4-3">
<p>
<a href="https://github.com/coursefiles/angular2-essential-training/tree/06_05b/app">https://github.com/coursefiles/angular2-essential-training/tree/06_05b/app</a>
</p>

<p>
media-item.service.ts
</p>
<pre class="example">
import { Injectable } from '@angular/core';
import { Http, URLSearchParams } from '@angular/http';
import 'rxjs/add/operator/map';
// Other Observable operators
// import 'rxjs/add/operator/catch'

@Injectable()
export class MediaItemService {
  constructor(private http: Http) {}

  get(medium) {
    let searchParams = new URLSearchParams();
    searchParams.append('medium', medium);
    // searchParams.set('medium', medium);
    return this.http.get('mediaitems', { search: searchParams })
      .map(response =&gt; {
        return response.json().mediaItems;
      });
  }

  add(mediaItem) { ... }

  delete(mediaItem) { ... }

  mediaItems = [ {}, ... ];
}
</pre>

<p>
media-item-list.component.ts
</p>
<pre class="example">
ngOnInit() {
    this.getMediaItems(this.medium);
}
getMediaItems(medium) {
    this.medium = medium;
    this.mediaItemService.get(medium)
      .subscribe(mediaItems =&gt; {
        this.mediaItems = mediaItems;
      });
}
</pre>
</div>
</li>

<li><a id="org321afd1"></a>post, put, delete<br />
<div class="outline-text-6" id="text-13-3-17-4-4">
<p>
<a href="https://github.com/coursefiles/angular2-essential-training/tree/07_01b/app">https://github.com/coursefiles/angular2-essential-training/tree/07_01b/app</a>
</p>

<p>
media-item.service.ts
</p>
<pre class="example">
import { Injectable } from '@angular/core';
import { Http, URLSearchParams } from '@angular/http';
import 'rxjs/add/operator/map';

@Injectable()
export class MediaItemService {
  constructor(private http: Http) {}

  get(medium) {
    let searchParams = new URLSearchParams();
    searchParams.append('medium', medium);
    return this.http.get('mediaitems', { search: searchParams })
      .map(response =&gt; {
        return response.json().mediaItems;
      });
  }

  add(mediaItem) {
    // new
    return this.http.post('mediaitems', mediaItem)
      .map(response =&gt; {});
  }

  delete(mediaItem) {
    // new
    return this.http.delete(`mediaitems/${mediaItem.id}`)
      .map(response =&gt; {});
  }
}
</pre>

<p>
media-item-form.component.ts
</p>
<pre class="example">
import { Component, Inject } from '@angular/core';
import { Validators, FormBuilder } from '@angular/forms';

import { MediaItemService } from './media-item.service';
import { lookupListToken } from './providers';

@Component({
  selector: 'mw-media-item-form',
  templateUrl: 'app/media-item-form.component.html',
  styleUrls: ['app/media-item-form.component.css']
})
export class MediaItemFormComponent {
  form;

  constructor(
    private formBuilder: FormBuilder,
    private mediaItemService: MediaItemService,
    @Inject(lookupListToken) public lookupLists) {}

  ngOnInit() {
    this.form = this.formBuilder.group({
      medium: this.formBuilder.control('Movies'),
      name: this.formBuilder.control('', Validators.compose([
        Validators.required,
        Validators.pattern('[\\w\\-\\s\\/]+')
      ])),
      category: this.formBuilder.control(''),
      year: this.formBuilder.control('', this.yearValidator),
    });
  }

  yearValidator(control) {
    if (control.value.trim().length === 0) {
      return null;
    }
    let year = parseInt(control.value);
    let minYear = 1800;
    let maxYear = 2500;
    if (year &gt;= minYear &amp;&amp; year &lt;= maxYear) {
      return null;
    } else {
      return {
        'year': {
          min: minYear,
          max: maxYear
        }
      };
    }
  }

  onSubmit(mediaItem) {
    // new
    this.mediaItemService.add(mediaItem)
      .subscribe();
  }
}
</pre>

<p>
media-item-list.component.ts
</p>
<pre class="example">
import { Component } from '@angular/core';

import { MediaItemService } from './media-item.service';

@Component({
  selector: 'mw-media-item-list',
  templateUrl: 'app/media-item-list.component.html',
  styleUrls: ['app/media-item-list.component.css']
})
export class MediaItemListComponent {
  medium = '';
  mediaItems = [];

  constructor(private mediaItemService: MediaItemService) {}

  ngOnInit() {
    this.getMediaItems(this.medium);
  }

  onMediaItemDelete(mediaItem) {
    // new
    this.mediaItemService.delete(mediaItem)
      .subscribe(() =&gt; {
        this.getMediaItems(this.medium);
      });
  }

  getMediaItems(medium) {
    this.medium = medium;
    this.mediaItemService.get(medium)
      .subscribe(mediaItems =&gt; {
        this.mediaItems = mediaItems;
      });
  }
}
</pre>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org0ad39a2" class="outline-4">
<h4 id="org0ad39a2"><span class="section-number-4">13.3.18</span> Route</h4>
<div class="outline-text-4" id="text-13-3-18">
</div>
<div id="outline-container-orgc6b8d67" class="outline-5">
<h5 id="orgc6b8d67"><span class="section-number-5">13.3.18.1</span> base href, config and register routes</h5>
<div class="outline-text-5" id="text-13-3-18-1">
<p>
<a href="https://github.com/coursefiles/angular2-essential-training/tree/07_03b/app">https://github.com/coursefiles/angular2-essential-training/tree/07_03b/app</a>
</p>

<p>
index.html
</p>
<pre class="example">
&lt;base href="/"&gt;
</pre>

<p>
app.routing.ts
</p>
<pre class="example">
import { Routes, RouterModule } from '@angular/router';

import { MediaItemFormComponent } from './media-item-form.component';
import { MediaItemListComponent } from './media-item-list.component';

const appRoutes: Routes = [
  { path: 'add', component: MediaItemFormComponent },
  { path: ':medium', component: MediaItemListComponent },
  { path: '', pathMatch: 'full', redirectTo: 'all' }
];

export const routing = RouterModule.forRoot(appRoutes);
</pre>

<p>
app.module.ts
</p>
<pre class="example">
import { routing } from './app.routing';

@NgModule({
  imports: [
    BrowserModule,
    ReactiveFormsModule,
    HttpModule,
    routing
  ],
  ...
})
</pre>
</div>
</div>

<div id="outline-container-org82d8366" class="outline-5">
<h5 id="org82d8366"><span class="section-number-5">13.3.18.2</span> router-outlet</h5>
<div class="outline-text-5" id="text-13-3-18-2">
<p>
app.component.html
Before, both form and list are loaded.
</p>
<pre class="example">
&lt;section&gt;
  &lt;header&gt;
    &lt;h1&gt;Media Watch List&lt;/h1&gt;
    &lt;p class="description"&gt;Keeping track of the media I want to watch.&lt;/p&gt;
  &lt;/header&gt;
  &lt;mw-media-item-form&gt;&lt;/mw-media-item-form&gt;
  &lt;mw-media-item-list&gt;&lt;/mw-media-item-list&gt;
&lt;/section&gt;
</pre>

<p>
After, form or list is loaded based on the current router state. The loaded component is the next sibling of the router-outlet HTML element.
</p>
<pre class="example">
&lt;section&gt;
  &lt;header&gt;
    &lt;h1&gt;Media Watch List&lt;/h1&gt;
    &lt;p class="description"&gt;Keeping track of the media I want to watch.&lt;/p&gt;
  &lt;/header&gt;
  &lt;router-outlet&gt;&lt;/router-outlet&gt;
&lt;/section&gt;
</pre>

<p>
<a href="https://angular.io/api/router/RouterOutlet">https://angular.io/api/router/RouterOutlet</a>
</p>
</div>
</div>

<div id="outline-container-org79e66da" class="outline-5">
<h5 id="org79e66da"><span class="section-number-5">13.3.18.3</span> routerLink</h5>
<div class="outline-text-5" id="text-13-3-18-3">
<p>
app.component.html
</p>
<pre class="example">
&lt;nav&gt;
  &lt;a routerLink="/"&gt;
    &lt;img src="media/04.png" class="icon" /&gt;
  &lt;/a&gt;
  &lt;a routerLink="/Movies"&gt;
    &lt;img src="media/03.png" class="icon" /&gt;
  &lt;/a&gt;
  &lt;a routerLink="/Series"&gt;
    &lt;img src="media/02.png" class="icon" /&gt;
  &lt;/a&gt;
&lt;/nav&gt;
</pre>
</div>
</div>

<div id="outline-container-orge9f9174" class="outline-5">
<h5 id="orge9f9174"><span class="section-number-5">13.3.18.4</span> read route in component</h5>
<div class="outline-text-5" id="text-13-3-18-4">
<p>
media-item-list.component.ts
</p>
<pre class="example">
import { Component } from '@angular/core';
import { ActivatedRoute } from '@angular/router'; // new

import { MediaItemService } from './media-item.service';

@Component({
  selector: 'mw-media-item-list',
  templateUrl: 'app/media-item-list.component.html',
  styleUrls: ['app/media-item-list.component.css']
})
export class MediaItemListComponent {
  medium = '';
  mediaItems = [];
  paramsSubscription; // new

  constructor(
    private mediaItemService: MediaItemService,
    private activatedRoute: ActivatedRoute // new
  ) {}

  ngOnInit() {
    // before 
    // this.getMediaItems(this.medium);

    // now
    this.paramsSubscription = this.activatedRoute.params
      .subscribe(params =&gt; {
        let medium = params['medium'];
        if(medium.toLowerCase() === 'all') {
          medium = '';
        }
        this.getMediaItems(medium);
      });
  }

  // new
  ngOnDestroy() {
    this.paramsSubscription.unsubscribe();
  }

  onMediaItemDelete(mediaItem) {
    this.mediaItemService.delete(mediaItem)
      .subscribe(() =&gt; {
        this.getMediaItems(this.medium);
      });
  }

  getMediaItems(medium) {
    this.medium = medium;
    this.mediaItemService.get(medium)
      .subscribe(mediaItems =&gt; {
        this.mediaItems = mediaItems;
      });
  }
}
</pre>
</div>
</div>

<div id="outline-container-org412669d" class="outline-5">
<h5 id="org412669d"><span class="section-number-5">13.3.18.5</span> Navigate in code</h5>
<div class="outline-text-5" id="text-13-3-18-5">
<p>
Form submit and navigate in code
media-item-form.component.ts
</p>
<pre class="example">
import { Component, Inject } from '@angular/core';
import { Validators, FormBuilder } from '@angular/forms';
import { Router } from '@angular/router'; // new

import { MediaItemService } from './media-item.service';
import { lookupListToken } from './providers';

@Component({
  selector: 'mw-media-item-form',
  templateUrl: 'app/media-item-form.component.html',
  styleUrls: ['app/media-item-form.component.css']
})
export class MediaItemFormComponent {
  form;

  constructor(
    private formBuilder: FormBuilder,
    private mediaItemService: MediaItemService,
    @Inject(lookupListToken) public lookupLists,
    private router: Router) {}

  ngOnInit() {
    this.form = this.formBuilder.group({
      medium: this.formBuilder.control('Movies'),
      name: this.formBuilder.control('', Validators.compose([
        Validators.required,
        Validators.pattern('[\\w\\-\\s\\/]+')
      ])),
      category: this.formBuilder.control(''),
      year: this.formBuilder.control('', this.yearValidator),
    });
  }

  yearValidator(control) {
    if (control.value.trim().length === 0) {
      return null;
    }
    let year = parseInt(control.value);
    let minYear = 1800;
    let maxYear = 2500;
    if (year &gt;= minYear &amp;&amp; year &lt;= maxYear) {
      return null;
    } else {
      return {
        'year': {
          min: minYear,
          max: maxYear
        }
      };
    }
  }

  onSubmit(mediaItem) {
    this.mediaItemService.add(mediaItem)
      .subscribe(() =&gt; {
        // new
        this.router.navigate(['/', mediaItem.medium]);
      });
  }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org561330d" class="outline-4">
<h4 id="org561330d"><span class="section-number-4">13.3.19</span> API</h4>
<div class="outline-text-4" id="text-13-3-19">
<p>
Search <a href="https://angular.io/api">https://angular.io/api</a>
</p>

<p>
<a id="orge565b9e">ng:api:component</a> <a href="https://angular.io/api/core/Component">https://angular.io/api/core/Component</a>
</p>
</div>
</div>

<div id="outline-container-org604529e" class="outline-4">
<h4 id="org604529e"><span class="section-number-4">13.3.20</span> Style Guide</h4>
<div class="outline-text-4" id="text-13-3-20">
</div>
<div id="outline-container-org0c8c7bb" class="outline-5">
<h5 id="org0c8c7bb"><span class="section-number-5">13.3.20.1</span> File Structure <a id="org81608ca">ng:file structure</a></h5>
<div class="outline-text-5" id="text-13-3-20-1">
<p>
<a href="https://angular.io/guide/styleguide#file-tree">https://angular.io/guide/styleguide#file-tree</a>
</p>

<p>
src/app/heroes/hero.component.ts
</p>
<pre class="example">
@Component({
  selector: 'toh-hero'
})
export class HeroComponent {}
</pre>

<p>
src/app/heroes/hero-list/hero-list.component.ts
</p>
<pre class="example">
import { Component, OnInit } from '@angular/core';

import { Hero, HeroService } from '../shared';

@Component({
  selector: 'toh-heroes',
  template: `
      &lt;pre&gt;{{heroes | json}}&lt;/pre&gt;
    `
})
export class HeroListComponent implements OnInit {
  heroes: Hero[] = [];

  constructor(private heroService: HeroService) { }

  ngOnInit() {
    this.heroService.getHeroes().subscribe(heroes =&gt; this.heroes = heroes);
  }
}
</pre>

<p>
src/app/heroes/shared/hero.service.ts|spec.ts
</p>
<pre class="example">
import { Injectable } from '@angular/core';
import { Http }       from '@angular/http';

import { Hero } from './hero.model';
import { ExceptionService, SpinnerService, ToastService } from '../../core';
export class HeroService {
  constructor(private http: Http) { }

  getHeroes() {
    return this.http.get('api/heroes')
      .map((response: Response) =&gt; &lt;Hero[]&gt;response.json().data);
  }
}
</pre>

<p>
src/app/heroes/shared/hero.model.ts
</p>
<pre class="example">
export class Hero {
  id: number;
  name: string;
}
</pre>

<p>
src/app/heroes/shared/hero-button.component.ts|html|css|spec.ts
</p>
</div>
</div>

<div id="outline-container-orgf21383f" class="outline-5">
<h5 id="orgf21383f"><span class="section-number-5">13.3.20.2</span> File name</h5>
<div class="outline-text-5" id="text-13-3-20-2">
<p>
Use dashes to separate words in file names (hero-list)
Use a dot to separate the descriptive name from the type (.component)
app/heroes/hero-list.component.ts
</p>

<p>
A file should have no more than 400 lines of code.
A small function should have no more than 75 lines.
</p>
</div>
</div>

<div id="outline-container-org7548546" class="outline-5">
<h5 id="org7548546"><span class="section-number-5">13.3.20.3</span> Symbol name and file name</h5>
<div class="outline-text-5" id="text-13-3-20-3">
<p>
Use upper camel case for class names
</p>
<pre class="example">
// hero-list.component.ts
@Component({ ... })
export class HeroListComponent { }

// validation.directive.ts
@Directive({ ... })
export class ValidationDirective { }

// app.module.ts
@NgModule({ ... })
export class AppModule

// init-caps.pipe.ts
@Pipe({ name: 'initCaps' })
export class InitCapsPipe implements PipeTransform {}

// user-profile.service.ts
@Injectable()
export class UserProfileService { }
</pre>
</div>
</div>

<div id="outline-container-org080579b" class="outline-5">
<h5 id="org080579b"><span class="section-number-5">13.3.20.4</span> Bootstrapping</h5>
<div class="outline-text-5" id="text-13-3-20-4">
<p>
Use main.ts as the file name
Include error handling
Don't put logic in this file.
</p>
<pre class="example">
import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';
import { AppModule }              from './app/app.module';
platformBrowserDynamic().bootstrapModule(AppModule)
  .then(success =&gt; console.log(`Bootstrap success`))
  .catch(err =&gt; console.error(err));
</pre>
</div>
</div>

<div id="outline-container-org1987408" class="outline-5">
<h5 id="org1987408"><span class="section-number-5">13.3.20.5</span> Directive selectors (lower camel case)</h5>
</div>
</div>
</div>
</div>

<div id="outline-container-org378eaec" class="outline-2">
<h2 id="org378eaec"><span class="section-number-2">14</span> Vue.js</h2>
<div class="outline-text-2" id="text-14">
</div>
<div id="outline-container-org16f2ac8" class="outline-3">
<h3 id="org16f2ac8"><span class="section-number-3">14.1</span> Who use Vue.js</h3>
<div class="outline-text-3" id="text-14-1">
<p>
GitLab <a href="https://github.com/alibaba/weex">https://github.com/alibaba/weex</a>
<a href="https://github.com/vuejs/awesome-vue#appswebsites">https://github.com/vuejs/awesome-vue#appswebsites</a>
</p>
</div>
</div>

<div id="outline-container-org4e44fa9" class="outline-3">
<h3 id="org4e44fa9"><span class="section-number-3">14.2</span> Builds</h3>
<div class="outline-text-3" id="text-14-2">
<p>
<a href="https://cdn.jsdelivr.net/npm/vue">https://cdn.jsdelivr.net/npm/vue</a> is the Runtime + Compiler UMD Minimized latest build
</p>

<p>
<a href="https://unpkg.com/vue">https://unpkg.com/vue</a> is the same above but not minimized (development).
</p>

<p>
Runtime only is good for webpack.
</p>

<p>
<a href="https://cdn.jsdelivr.net/npm/vue/dist/">All latest builds</a>
</p>
</div>
</div>

<div id="outline-container-orga8c8a9d" class="outline-3">
<h3 id="orga8c8a9d"><span class="section-number-3">14.3</span> Basics</h3>
<div class="outline-text-3" id="text-14-3">
<pre class="example">
&lt;script src="https://unpkg.com/vue"&gt;&lt;/script&gt;

&lt;div id="app"&gt;
  &lt;!-- bind attribute to a var --&gt;
  &lt;span v-bind:title="msg2"&gt;
    {{ message }}
  &lt;/span&gt;
  &lt;div&gt;
    &lt;span v-if="seen"&gt;Now you see me&lt;/span&gt;
  &lt;/div&gt;
  &lt;div&gt;
    &lt;ol&gt;
      &lt;li v-for="todo in todos"&gt;
        {{ todo.text }}
      &lt;/li&gt;
    &lt;/ol&gt;
  &lt;/div&gt;

  &lt;button v-on:click="reverseMessage"&gt;Reverse Message&lt;/button&gt;

  &lt;!-- 2 way binding --&gt;
  &lt;div&gt;
    &lt;input v-model="message"&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;script&gt;
  var my_vue_app = new Vue({
    el: '#app',
    data: {
      message: 'Hello Vue.js!',
      msg2: 'span title',
      seen: true,
      // my_vue_app.todos.push({ text: 'New item' })
      todos: [
        { text: 'Learn JavaScript' },
        { text: 'Learn Vue' },
        { text: 'Build something awesome' }
      ]
    },
    methods: {
      reverseMessage: function () {
        this.message = this.message.split('').reverse().join('')
      }
    }
  })
&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-org6b57345" class="outline-3">
<h3 id="org6b57345"><span class="section-number-3">14.4</span> Data and methods</h3>
<div class="outline-text-3" id="text-14-4">
<p>
<a id="orgfb81df4">vue:data</a>
</p>

<p>
Root-level reactive properties need to be defined when the instance was first created.
</p>
<pre class="example">
var data = {a:1}
var vm = new Vue({
  data: data
});

vm.a === data.a // true, they refer to the same object
vm.a = 2 // then data.a is 2, too
data.a = 3 // and vice-versa vm.a === 3

vm.b = 'hi' // the properties in data are active only when the instance was first created.
// a new property is defined after initialization, so it won't trigger view update.
// Define all variables with default values you need in initialization.
</pre>

<p>
Special instance properties and methods :: vm.$data, vm.$el, vm.$watch
</p>

<p>
Don't use arrow function
</p>
<pre class="example">
var data = { a: 1 }
var vm = new Vue({
  el: '#example',
  data: data
})
vm.$data === data // =&gt; true
vm.$el === document.getElementById('example') // =&gt; true
// $watch is an instance method
vm.$watch('a', function (newValue, oldValue) {
  // This callback will be called when `vm.a` changes
})
</pre>

<p>
Some plugins allow components to access/change specific root-level properties e.g. this.$store <a href="#org59a9684">vue:plugin:vuex</a>, this.$router <a href="#org601444e">vue:router</a>
This is specifically enabled in the plugin.
</p>
</div>

<div id="outline-container-org9ee2dd2" class="outline-4">
<h4 id="org9ee2dd2"><span class="section-number-4">14.4.1</span> Mutation, Vue.set</h4>
<div class="outline-text-4" id="text-14-4-1">
<p>
<a id="org04b13f1">vue:data:mutation</a>
Mutation methods :: when these methods are called, the views will be updated.
push, pop, shift, unshift, splice, sort, reverse
</p>

<p>
e.g. my_vue_app.items.push({ message: 'Baz'});
</p>

<p>
Non-mutating methods always return a new array.
</p>

<p>
e.g. filter, concat
</p>
<pre class="example">
example1.items = example1.items.filter(function (item) {
  return item.message.match(/Foo/)
})
</pre>

<p>
Add new prop reactivitely :: Don't use vm.items[indexOfItem] = newValue, instead use:
</p>
<pre class="example">
// Vue.set
Vue.set(example1.items, indexOfItem, newValue)

// Or

// Array.prototype.splice
example1.items.splice(indexOfItem, 1, newValue)
</pre>

<p>
Don't use vm.items.length = newLenth, instead use:
</p>
<pre class="example">
example1.items.splice(newLength)
</pre>

<p>
Add reactive properties to an object at root-level
</p>
<pre class="example">
var vm = new Vue({
  data: {
    userProfile: {
      name: 'Anika'
    }
  }
})

Vue.set(vm.userProfile, 'age', 27);

// or this.$set(this.userProfile, 'age', 27)
// or vm.$set
</pre>

<p>
The other way to add a new prop is to rebuild the object using Object.assign() or _.extend()
</p>

<pre class="example">
/* Don't do it directly
Object.assign(this.userProfile, {
  age: 27,
  favoriteColor: 'Vue Green'
})
*/

this.userProfile = Object.assign({}, this.userProfile, {
  age: 27,
  favoriteColor: 'Vue Green'
})
</pre>

<p>
<a href="#orgf9f5b9a">vue:plugin:vuex:mutations</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org5ee6cd3" class="outline-3">
<h3 id="org5ee6cd3"><span class="section-number-3">14.5</span> Instance Lifecycle Hooks</h3>
<div class="outline-text-3" id="text-14-5">
<p>
Data observation &gt; compile templates &gt; mount instance to DOM &gt; Update DOM when data changes
</p>

<p>
Don't use arrow function in those hooks e.g. <code>created: () =&gt; console.log(this.a)</code>
</p>

<p>
<a href="https://vuejs.org/v2/guide/instance.html#Lifecycle-Diagram">Full lifecycle diagram and hooks</a>
</p>
</div>

<div id="outline-container-org7609729" class="outline-4">
<h4 id="org7609729"><span class="section-number-4">14.5.1</span> beforeCreate, created</h4>
<div class="outline-text-4" id="text-14-5-1">
<p>
run code after an instance is created
</p>

<pre class="example">
new Vue({
  data: {
    a: 1
  },
  created: function () {
    // `this` points to the vm instance
    console.log('a is: ' + this.a)
  }
})
// =&gt; "a is: 1"
</pre>
</div>
</div>

<div id="outline-container-orgab691b7" class="outline-4">
<h4 id="orgab691b7"><span class="section-number-4">14.5.2</span> vm.$mount(el), beforeMount, mounted</h4>
</div>
<div id="outline-container-org46d87d0" class="outline-4">
<h4 id="org46d87d0"><span class="section-number-4">14.5.3</span> beforeUpdate, updated</h4>
</div>
<div id="outline-container-orga71829f" class="outline-4">
<h4 id="orga71829f"><span class="section-number-4">14.5.4</span> beforeDestroy, destroyed</h4>
</div>
</div>

<div id="outline-container-org233c7a2" class="outline-3">
<h3 id="org233c7a2"><span class="section-number-3">14.6</span> Component</h3>
<div class="outline-text-3" id="text-14-6">
</div>
<div id="outline-container-org0e1de28" class="outline-4">
<h4 id="org0e1de28"><span class="section-number-4">14.6.1</span> Basics</h4>
<div class="outline-text-4" id="text-14-6-1">
<p>
component name better to have all lowercase and must contain a hyphen.
</p>

<p>
Although these can be used in string templates
</p>
<pre class="example">
components: {
  'kebab-cased-component': { /* ... */ },
  camelCasedComponent: { /* ... */ },
  PascalCasedComponent: { /* ... */ }
}
</pre>

<pre class="example">
&lt;div id="app-7"&gt;
  &lt;ol&gt;
    &lt;!--
      Now we provide each todo-item with the todo object
      it's representing, so that its content can be dynamic.
      We also need to provide each component with a "key",
      which will be explained later.
    --&gt;
    &lt;todo-item
      v-for="item in groceryList"
      v-bind:todo="item"
      v-bind:key="item.id"&gt;
    &lt;/todo-item&gt;
  &lt;/ol&gt;
&lt;/div&gt;
</pre>

<pre class="example">
Vue.component('todo-item', {
  props: ['todo'],
  template: '&lt;li&gt;{{ todo.text }}&lt;/li&gt;'
})
var app7 = new Vue({
  el: '#app-7',
  data: {
    groceryList: [
      { id: 0, text: 'Vegetables' },
      { id: 1, text: 'Cheese' },
      { id: 2, text: 'Whatever else humans are supposed to eat' }
    ]
  }
})
</pre>

<p>
Vue.component registers a component globally. Make a component available only in the scope of another instance/component by registering it with the components instance option:
</p>

<pre class="example">
var Child = {
  template: '&lt;div&gt;A custom component!&lt;/div&gt;'
}
new Vue({
  // ...
  components: {
    // &lt;my-component&gt; will only be available in parent's template
    'my-component': Child
  }
})
</pre>

<p>
Component should be used in a way that has 3 parts 
</p>
<dl class="org-dl">
<dt>props</dt><dd>pass from parent to component</dd>
<dt>events</dt><dd>set parent based on events triggered from component</dd>
<dt>slots</dt><dd>customize, from parent, the look of the component</dd>
</dl>
<pre class="example">
&lt;my-component
  :foo="baz"
  :bar="qux"
  @event-a="doThis"
  @event-b="doThat"
&gt;
  &lt;img slot="icon" src="..."&gt;
  &lt;p slot="main-text"&gt;Hello!&lt;/p&gt;
&lt;/my-component&gt;
</pre>
</div>
</div>

<div id="outline-container-orga8e3135" class="outline-4">
<h4 id="orga8e3135"><span class="section-number-4">14.6.2</span> DOM Template Parsing Caveats</h4>
<div class="outline-text-4" id="text-14-6-2">
<p>
Becuase &lt;ul&gt;, &lt;ol&gt;, &lt;table&gt; and &lt;select&gt; need to have certain elements appearing inside them and some elements such as &lt;option&gt; can only appear inside certain other elements, it will lead to parsing issues if you do this
</p>
<pre class="example">
&lt;table&gt;
  &lt;my-row&gt;...&lt;/my-row&gt;
&lt;/table&gt;
</pre>

<p>
So better to do this
</p>
<pre class="example">
&lt;table&gt;
  &lt;tr is="my-row"&gt;&lt;/tr&gt;
&lt;/table&gt;
</pre>

<p>
camelCase vs. kebab-case
</p>


<p>
These limitations do not apply if you are using string templates from one of the following sources:
</p>
<ul class="org-ul">
<li>&lt;script type='text/x-template'&gt;</li>
<li>JavaScript inline template strings</li>
<li>.vue components</li>
</ul>

<p>
So, prefer using string templates whenever possible.
</p>
</div>
</div>

<div id="outline-container-org7ccc927" class="outline-4">
<h4 id="org7ccc927"><span class="section-number-4">14.6.3</span> Option data has to be a function</h4>
<div class="outline-text-4" id="text-14-6-3">
<p>
data is the initialization part that defines extra local data properties that are only available in the component.
</p>

<p>
3 simple-counter's have their own initializing part and scopes.
</p>
<pre class="example">
&lt;div id="example-2"&gt;
  &lt;simple-counter&gt;&lt;/simple-counter&gt;
  &lt;simple-counter&gt;&lt;/simple-counter&gt;
  &lt;simple-counter&gt;&lt;/simple-counter&gt;
&lt;/div&gt;

Vue.component('simple-counter', {
  template: '&lt;button v-on:click="counter += 1"&gt;{{ counter }}&lt;/button&gt;',
  data: function () {
    return {
      counter: 0
    }
  }
})
new Vue({
  el: '#example-2'
})
</pre>
</div>
</div>

<div id="outline-container-org14546c8" class="outline-4">
<h4 id="org14546c8"><span class="section-number-4">14.6.4</span> Option filters</h4>
<div class="outline-text-4" id="text-14-6-4">
<p>
Text formatting
</p>
<pre class="example">
&lt;!-- in mustaches --&gt;
{{ message | capitalize }}
&lt;!-- in v-bind --&gt;
&lt;div v-bind:id="rawId | formatId"&gt;&lt;/div&gt;

filters: {
  capitalize: function (value) {
    if (!value) return ''
    value = value.toString()
    return value.charAt(0).toUpperCase() + value.slice(1)
  }
}

// define globally
Vue.filter('capitalize', function (value) {
  if (!value) return ''
  value = value.toString()
  return value.charAt(0).toUpperCase() + value.slice(1)
})

// can be chained
{{ message | filterA | filterB }}

// can have arguments
{{ message | filterA('arg1', arg2) }}
</pre>
</div>
</div>

<div id="outline-container-orge271ad8" class="outline-4">
<h4 id="orge271ad8"><span class="section-number-4">14.6.5</span> Props down</h4>
<div class="outline-text-4" id="text-14-6-5">
<p>
Pass down prop from parent to child using child component's prop option.
</p>

<p>
When the parent property updates, it will flow down to the child but not the other way around.
</p>

<pre class="example">
Vue.component('child', {
  // declare the props
  props: ['message'],
  // like data, the prop can be used inside templates and
  // is also made available in the vm as this.message
  template: '&lt;span&gt;{{ message }}&lt;/span&gt;'
})

// parent page
&lt;child message="hello!"&gt;&lt;/child&gt;

// dynamic binding a parent variable
&lt;div&gt;
  &lt;input v-model="parentMsg"&gt;
  &lt;br&gt;
  &lt;child v-bind:my-message="parentMsg"&gt;&lt;/child&gt;
&lt;/div&gt;

// pass all properties of the parent as props to the child
todo: {
  text: 'Learn Vue',
  isComplete: false
}

&lt;todo-item v-bind="todo"&gt;&lt;/todo-item&gt;

&lt;todo-item
  v-bind:text="todo.text"
  v-bind:is-complete="todo.isComplete"
&gt;&lt;/todo-item&gt;
</pre>

<p>
Literal vs Dynamic
</p>
<pre class="example">
&lt;!-- this passes down a plain string "1" --&gt;
&lt;comp some-prop="1"&gt;&lt;/comp&gt;

&lt;!-- this passes down an actual number --&gt;
&lt;comp v-bind:some-prop="1"&gt;&lt;/comp&gt;
</pre>
</div>

<div id="outline-container-org9be2f86" class="outline-5">
<h5 id="org9be2f86"><span class="section-number-5">14.6.5.1</span> Don't mutate a prop of child component</h5>
<div class="outline-text-5" id="text-14-6-5-1">
<p>
You shouldn't mutate a prop insde a child component. Refer to <a href="#org04b13f1">vue:data:mutation</a>
</p>

<p>
Because objects and arrays in JavaScript are passed by reference. So mutating the object or array inside the child will affect parent state.
</p>

<p>
Instead you should do the following:
</p>
<ul class="org-ul">
<li>Define a local data prop that uses the prop's initial value as its initial value</li>
</ul>
<pre class="example">
props: ['initialCounter'],
data: function () {
  return { counter: this.initialCounter }
}
</pre>

<ul class="org-ul">
<li>Define a computed prop that is computed from the prop's value</li>
</ul>
<pre class="example">
props: ['size'],
computed: {
  normalizedSize: function () {
    return this.size.trim().toLowerCase()
  }
}
</pre>
</div>
</div>

<div id="outline-container-org1ba1706" class="outline-5">
<h5 id="org1ba1706"><span class="section-number-5">14.6.5.2</span> prop validation</h5>
<div class="outline-text-5" id="text-14-6-5-2">
<p>
When prop validation fails, Vue will produce a console warning (if using the development build). Note that props are validated before a component instance is created, so within default or validator functions, instance properties such as from data, computed, or methods will not be available.
</p>

<pre class="example">
Vue.component('example', {
  props: {
    // basic type check (`null` means accept any type)
    propA: Number,

    // multiple possible types
    propB: [String, Number],

    // a required string
    propC: {
      type: String,
      required: true
    },

    // a number with default value
    propD: {
      type: Number,
      default: 100
    },

    // object/array defaults should be returned from a
    // factory function
    propE: {
      type: Object,
      default: function () {
        return { message: 'hello' }
      }
    },

    // custom validator function
    propF: {
      validator: function (value) {
        return value &gt; 10
      }
    }
  }
})
</pre>
</div>

<ol class="org-ol">
<li><a id="org3d4bf45"></a>type<br />
<div class="outline-text-6" id="text-14-6-5-2-1">
<p>
type can be one of the following instructors
String
Number
Boolean
Function
Object
Array
Symbol
</p>

<p>
In addition, type can also be a custom constructor function and the assertion will be made with an instanceof check.
</p>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org2d386c7" class="outline-4">
<h4 id="org2d386c7"><span class="section-number-4">14.6.6</span> Events Up</h4>
<div class="outline-text-4" id="text-14-6-6">
<p>
<a href="#orgcb22482">vue:event:component</a>
</p>
</div>
</div>

<div id="outline-container-org190ef67" class="outline-4">
<h4 id="org190ef67"><span class="section-number-4">14.6.7</span> DOM template</h4>
<div class="outline-text-4" id="text-14-6-7">
<p>
In non-string templates, camelCased prop names need to use their kebab-case equivalents
Refer to see what <a href="#orga134794">vue:string template</a> is.
</p>
<pre class="example">
Vue.component('child', {
  // camelCase in JavaScript
  props: ['myMessage'],
  template: '&lt;span&gt;{{ myMessage }}&lt;/span&gt;'
})
&lt;!-- kebab-case in HTML --&gt;
&lt;child my-message="hello!"&gt;&lt;/child&gt;
</pre>
</div>
</div>

<div id="outline-container-org67c7253" class="outline-4">
<h4 id="org67c7253"><span class="section-number-4">14.6.8</span> Except class and style :: parent attributes overwrite child component</h4>
<div class="outline-text-4" id="text-14-6-8">
<p>
Child component bs-date-input has this template
&lt;input type="date" class="form-control"&gt;
</p>

<p>
But the child component is called from parent with the type attribute as well.
</p>
<pre class="example">
&lt;bs-date-input
  data-3d-date-picker="true"
  class="date-picker-theme-dark"
  type="large"
&gt;&lt;/bs-date-input&gt;
</pre>

<p>
The final result is type="large" because the value provided to the component will replace the value set by the component.
</p>

<p>
Except class and style attributes.
</p>
</div>
</div>

<div id="outline-container-org17cd252" class="outline-4">
<h4 id="org17cd252"><span class="section-number-4">14.6.9</span> Slots</h4>
<div class="outline-text-4" id="text-14-6-9">
<p>
Parent content will be discarded unless the child component template contains at least one &lt;slot&gt; outlet.
</p>
</div>

<div id="outline-container-org895eae6" class="outline-5">
<h5 id="org895eae6"><span class="section-number-5">14.6.9.1</span> Basics</h5>
<div class="outline-text-5" id="text-14-6-9-1">
<p>
my-component template:
</p>
<pre class="example">
&lt;div&gt;
  &lt;h2&gt;I'm the child title&lt;/h2&gt;
  &lt;slot&gt;
    This will only be displayed if there is no content
    to be distributed.
  &lt;/slot&gt;
&lt;/div&gt;
</pre>

<p>
the parent
</p>
<pre class="example">
&lt;div&gt;
  &lt;h1&gt;I'm the parent title&lt;/h1&gt;
  &lt;my-component&gt;
    &lt;p&gt;This is some original content&lt;/p&gt;
    &lt;p&gt;This is some more original content&lt;/p&gt;
  &lt;/my-component&gt;
&lt;/div&gt;
</pre>

<p>
Result
</p>
<pre class="example">
&lt;div&gt;
  &lt;h1&gt;I'm the parent title&lt;/h1&gt;
  &lt;div&gt;
    &lt;h2&gt;I'm the child title&lt;/h2&gt;
    &lt;p&gt;This is some original content&lt;/p&gt;
    &lt;p&gt;This is some more original content&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org6b25895" class="outline-5">
<h5 id="org6b25895"><span class="section-number-5">14.6.9.2</span> Multiple slots</h5>
<div class="outline-text-5" id="text-14-6-9-2">
<p>
app-layout component with template
</p>
<pre class="example">
&lt;div class="container"&gt;
  &lt;header&gt;
    &lt;slot name="header"&gt;&lt;/slot&gt;
  &lt;/header&gt;
  &lt;main&gt;
    &lt;slot&gt;&lt;/slot&gt;
  &lt;/main&gt;
  &lt;footer&gt;
    &lt;slot name="footer"&gt;&lt;/slot&gt;
  &lt;/footer&gt;
&lt;/div&gt;
</pre>

<p>
Parent
</p>
<pre class="example">
&lt;app-layout&gt;
  &lt;h1 slot="header"&gt;Here might be a page title&lt;/h1&gt;
  &lt;p&gt;A paragraph for the main content.&lt;/p&gt;
  &lt;p&gt;And another one.&lt;/p&gt;
  &lt;p slot="footer"&gt;Here's some contact info&lt;/p&gt;
&lt;/app-layout&gt;
</pre>

<p>
Result
</p>
<pre class="example">
&lt;div class="container"&gt;
  &lt;header&gt;
    &lt;h1&gt;Here might be a page title&lt;/h1&gt;
  &lt;/header&gt;
  &lt;main&gt;
    &lt;p&gt;A paragraph for the main content.&lt;/p&gt;
    &lt;p&gt;And another one.&lt;/p&gt;
  &lt;/main&gt;
  &lt;footer&gt;
    &lt;p&gt;Here's some contact info&lt;/p&gt;
  &lt;/footer&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org36e38c9" class="outline-5">
<h5 id="org36e38c9"><span class="section-number-5">14.6.9.3</span> Scoped slot</h5>
<div class="outline-text-5" id="text-14-6-9-3">
<p>
From parent, create a temporary variable with an alias name which holds the props object passed from the child (props.text defined in child)
</p>

<p>
This provides a way for parent to customize the look of a component.
</p>

<p>
child component
</p>
<pre class="example">
&lt;div class="child"&gt;
  &lt;slot text="hello from child"&gt;&lt;/slot&gt;
&lt;/div&gt;
</pre>

<p>
Parent
</p>
<pre class="example">
&lt;div class="parent"&gt;
  &lt;child&gt;
    &lt;template slot-scope="props"&gt;
      &lt;span&gt;hello from parent&lt;/span&gt;
      &lt;span&gt;{{ props.text }}&lt;/span&gt;
    &lt;/template&gt;
  &lt;/child&gt;
&lt;/div&gt;
</pre>

<p>
Result
</p>
<pre class="example">
&lt;div class="parent"&gt;
  &lt;div class="child"&gt;
    &lt;span&gt;hello from parent&lt;/span&gt;
    &lt;span&gt;hello from child&lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;
</pre>

<p>
In 2.5.0+, slot-scope is no longer limited to &lt;template&gt; and can be used on any element or component.
</p>

<p>
Number of slots in parent do not need to match number of slots in component.
</p>

<p>
Parent :: customize the look for each list item
</p>
<pre class="example">
&lt;my-awesome-list :items="items"&gt;
  &lt;!-- scoped slot can be named too --&gt;
  &lt;li
    slot="item"
    slot-scope="props"
    class="my-fancy-item"&gt;
    {{ props.text }}
  &lt;/li&gt;
&lt;/my-awesome-list&gt;
</pre>

<p>
my-awesome-list component template
</p>
<pre class="example">
&lt;ul&gt;
  &lt;slot name="item"
    v-for="item in items"
    :text="item.text"&gt;
    &lt;!-- fallback content here --&gt;
  &lt;/slot&gt;
&lt;/ul&gt;
</pre>
</div>
</div>

<div id="outline-container-orgac4af8e" class="outline-5">
<h5 id="orgac4af8e"><span class="section-number-5">14.6.9.4</span> Destructuring for slot-scope</h5>
<div class="outline-text-5" id="text-14-6-9-4">
<pre class="example">
&lt;child&gt;
  &lt;span slot-scope="{ text }"&gt;{{ text }}&lt;/span&gt;
&lt;/child&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orge1dec69" class="outline-4">
<h4 id="orge1dec69"><span class="section-number-4">14.6.10</span> Dynamic component, v-bind:is, &lt;component&gt;, &lt;keep-alive&gt;</h4>
<div class="outline-text-4" id="text-14-6-10">
<pre class="example">
var vm = new Vue({
  el: '#example',
  data: {
    currentView: 'home'
  },
  components: {
    home: { /* ... */ },
    posts: { /* ... */ },
    archive: { /* ... */ }
  }
})

&lt;component v-bind:is="currentView"&gt;
  &lt;!-- component changes when vm.currentView changes! --&gt;
&lt;/component&gt;
</pre>

<p>
If &lt;transition&gt; is used, wrap &lt;keep-alive&gt; inside &lt;transition&gt;
</p>
<pre class="example">
&lt;keep-alive&gt;
  &lt;component :is="currentView"&gt;
    &lt;!-- inactive components will be cached! --&gt;
  &lt;/component&gt;
&lt;/keep-alive&gt;
</pre>
</div>
</div>

<div id="outline-container-orgc162f9d" class="outline-4">
<h4 id="orgc162f9d"><span class="section-number-4">14.6.11</span> Get Child Component One Time</h4>
<div class="outline-text-4" id="text-14-6-11">
<p>
$refs are only populated after the component has been rendered and it is not reactive.
</p>
<pre class="example">
&lt;div id="parent"&gt;
  &lt;user-profile ref="profile"&gt;&lt;/user-profile&gt;
&lt;/div&gt;

var parent = new Vue({ el: '#parent' })
// access child component instance
var child = parent.$refs.profile
</pre>
</div>
</div>

<div id="outline-container-orgbfdffc3" class="outline-4">
<h4 id="orgbfdffc3"><span class="section-number-4">14.6.12</span> Async Components</h4>
<div class="outline-text-4" id="text-14-6-12">
<p>
Define component as a factory function that asynchronously resolves the component definition.
The factory function will only be triggered when the component actually needs to be rendered and will cache the result for future re-renders.
</p>

<p>
Usually, component is defined using a name and an object of props.
</p>

<p>
A factory function can be used:
</p>
<pre class="example">
Vue.component('async-example', function (resolve, reject) {
  setTimeout(function () {
    // Pass the component definition to the resolve callback
    resolve({
      template: '&lt;div&gt;I am async!&lt;/div&gt;'
    })
  }, 1000)
})
</pre>

<p>
Webpack example
</p>
<pre class="example">
Vue.component('async-webpack-example', function (resolve) {
  // This special require syntax will instruct Webpack to
  // automatically split your built code into bundles which
  // are loaded over Ajax requests.
  require(['./my-async-component'], resolve)
})
</pre>
</div>

<div id="outline-container-orgba90e8f" class="outline-5">
<h5 id="orgba90e8f"><span class="section-number-5">14.6.12.1</span> Component factory function can return a Promise</h5>
<div class="outline-text-5" id="text-14-6-12-1">
<p>
(with Webpack)
</p>
<pre class="example">
Vue.component(
  'async-webpack-example',
  // The `import` function returns a `Promise`.
  () =&gt; import('./my-async-component')
)

new Vue({
  // ...
  components: {
    'my-component': () =&gt; import('./my-async-component')
  }
})
</pre>
</div>
</div>

<div id="outline-container-org58c5ab1" class="outline-5">
<h5 id="org58c5ab1"><span class="section-number-5">14.6.12.2</span> Component factory function can also return an object</h5>
<div class="outline-text-5" id="text-14-6-12-2">
<pre class="example">
const AsyncComp = () =&gt; ({
  // The component to load. Should be a Promise
  component: import('./MyComp.vue'),
  // A component to use while the async component is loading
  loading: LoadingComp,
  // A component to use if the load fails
  error: ErrorComp,
  // Delay before showing the loading component. Default: 200ms.
  delay: 200,
  // The error component will be displayed if a timeout is
  // provided and exceeded. Default: Infinity.
  timeout: 3000
})
</pre>
<p>
Refer to <a href="#org601444e">vue:router</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org9e554eb" class="outline-4">
<h4 id="org9e554eb"><span class="section-number-4">14.6.13</span> Recursive and Circular Reference</h4>
<div class="outline-text-4" id="text-14-6-13">
<p>
A component can recursively invoke itself in its own template
</p>

<p>
When a component is registered globally using Vue.component, the global ID is auto set as the component's name option
</p>
<pre class="example">
Vue.component('unique-name-of-my-component', {
  // ...
})

name: 'unique-name-of-my-component'
</pre>
</div>

<div id="outline-container-orgd7bbda2" class="outline-5">
<h5 id="orgd7bbda2"><span class="section-number-5">14.6.13.1</span> Recursive</h5>
<div class="outline-text-5" id="text-14-6-13-1">
<pre class="example">
name: 'stack-overflow',
template: '&lt;div&gt;&lt;stack-overflow&gt;&lt;/stack-overflow&gt;&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org6a503b2" class="outline-5">
<h5 id="org6a503b2"><span class="section-number-5">14.6.13.2</span> Circular reference</h5>
<div class="outline-text-5" id="text-14-6-13-2">
<p>
tree-folder component
</p>
<pre class="example">
&lt;p&gt;
  &lt;span&gt;{{ folder.name }}&lt;/span&gt;
  &lt;tree-folder-contents :children="folder.children"/&gt;
&lt;/p&gt;
</pre>

<p>
tree-folder-contents component
</p>
<pre class="example">
&lt;ul&gt;
  &lt;li v-for="child in children"&gt;
    &lt;tree-folder v-if="child.children" :folder="child"/&gt;
    &lt;span v-else&gt;{{ child.name }}&lt;/span&gt;
  &lt;/li&gt;
&lt;/ul&gt;
</pre>

<p>
tree-folder needs tree-folder-contents and tree-folder-contents needs tree-folder.
</p>

<p>
It's ok if no module system is used to import components (Webpack or Browserify).
</p>

<p>
You should do this
</p>
<pre class="example">
beforeCreate: function () {
  this.$options.components.TreeFolderContents = require('./tree-folder-contents.vue')
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org427cd80" class="outline-4">
<h4 id="org427cd80"><span class="section-number-4">14.6.14</span> inline-template</h4>
<div class="outline-text-4" id="text-14-6-14">
<p>
It makes the inner content as the component's template. Don't use it.
</p>
<pre class="example">
&lt;my-component inline-template&gt;
  &lt;div&gt;
    &lt;p&gt;These are compiled as the component's own template.&lt;/p&gt;
    &lt;p&gt;Not parent's transclusion content.&lt;/p&gt;
  &lt;/div&gt;
&lt;/my-component&gt;
</pre>
</div>
</div>

<div id="outline-container-org909a554" class="outline-4">
<h4 id="org909a554"><span class="section-number-4">14.6.15</span> X-Templates</h4>
<div class="outline-text-4" id="text-14-6-15">
<p>
Don't use.
</p>
<pre class="example">
&lt;script type="text/x-template" id="hello-world-template"&gt;
  &lt;p&gt;Hello hello hello&lt;/p&gt;
&lt;/script&gt;
Vue.component('hello-world', {
  template: '#hello-world-template'
})
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbf796b0" class="outline-3">
<h3 id="orgbf796b0"><span class="section-number-3">14.7</span> Template Syntax</h3>
<div class="outline-text-3" id="text-14-7">
</div>
<div id="outline-container-orged4dab3" class="outline-4">
<h4 id="orged4dab3"><span class="section-number-4">14.7.1</span> String template vs DOM template</h4>
<div class="outline-text-4" id="text-14-7-1">
<p>
String template <a id="orga134794">vue:string template</a>
</p>
<pre class="example">
Vue.component('my-component', {
  template: '&lt;p&gt;This is a String template, it iss passed as a string to the component.&lt;/p&gt;'
})
</pre>

<p>
DOM template
</p>
<pre class="example">
&lt;body&gt;
  &lt;div id="app"&gt; &lt;!-- your App is runnning in this div ---&gt;
    &lt;my-component&gt;&lt;/my-component&gt;
  &lt;/div&gt;

  &lt;template id="template-for-my-component"&gt;
    {{ message }}
  &lt;/template&gt;
&lt;/body&gt;
</pre>
</div>
</div>

<div id="outline-container-orgb78b947" class="outline-4">
<h4 id="orgb78b947"><span class="section-number-4">14.7.2</span> v-once on text or element</h4>
<div class="outline-text-4" id="text-14-7-2">
<p>
one-time interpolations and remain cached
</p>
<pre class="example">
&lt;span v-once&gt;This will never change: {{ msg }}&lt;/span&gt;

Vue.component('terms-of-service', {
  template: '\
    &lt;div v-once&gt;\
      &lt;h1&gt;Terms of Service&lt;/h1&gt;\
      ... a lot of static content ...\
    &lt;/div&gt;\
  '
})
</pre>
</div>
</div>

<div id="outline-container-orgc5bb8eb" class="outline-4">
<h4 id="orgc5bb8eb"><span class="section-number-4">14.7.3</span> v-html</h4>
<div class="outline-text-4" id="text-14-7-3">
<p>
&lt;div v-html="rawHtml"&gt;&lt;/div&gt;
Can't be used for components. Watch out for XSS
</p>
</div>
</div>

<div id="outline-container-org279ab92" class="outline-4">
<h4 id="org279ab92"><span class="section-number-4">14.7.4</span> v-bind:attributeName, :attributeName</h4>
<div class="outline-text-4" id="text-14-7-4">
<p>
&lt;button v-bind:disabled="isButtonDisabled"&gt;Button&lt;/button&gt;
&lt;button :disabled="isButtonDisabled"&gt;Button&lt;/button&gt;
</p>
</div>
</div>

<div id="outline-container-org6193900" class="outline-4">
<h4 id="org6193900"><span class="section-number-4">14.7.5</span> Expression</h4>
<div class="outline-text-4" id="text-14-7-5">
<p>
One single expression and it has a whitelist. Don't access user defined globals in template expressions.
</p>

<pre class="example">
{{ number + 1 }}
{{ ok ? 'YES' : 'NO' }}
{{ message.split('').reverse().join('') }}
&lt;div v-bind:id="'list-' + id"&gt;&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-orgc469046" class="outline-4">
<h4 id="orgc469046"><span class="section-number-4">14.7.6</span> Arguments :: v-bind:href, v-bind:class, v-on:click</h4>
<div class="outline-text-4" id="text-14-7-6">
</div>
<div id="outline-container-orgb59934c" class="outline-5">
<h5 id="orgb59934c"><span class="section-number-5">14.7.6.1</span> v-bind:href, v-on:click</h5>
<div class="outline-text-5" id="text-14-7-6-1">
<pre class="example">
&lt;a v-bind:href="url"&gt; ... &lt;/a&gt;
// bind element's href attribute to the value of the expression url
&lt;a v-on:click="doSomething"&gt; ... &lt;/a&gt;
// shorthand
&lt;a @click="doSomething"&gt;...&lt;/a&gt;
</pre>
</div>
</div>

<div id="outline-container-org243625e" class="outline-5">
<h5 id="org243625e"><span class="section-number-5">14.7.6.2</span> v-bind:class</h5>
<div class="outline-text-5" id="text-14-7-6-2">
<pre class="example">
&lt;div class="static"
     v-bind:class="{ active: isActive, 'text-danger': hasError }"&gt;
&lt;/div&gt;
// &lt;div class="static active"&gt;&lt;/div&gt;
data: {
  isActive: true,
  hasError: false
}
</pre>

<p>
Or 
</p>

<pre class="example">
&lt;div v-bind:class="classObject"&gt;&lt;/div&gt;

data: {
  classObject: {
    active: true,
    'text-danger': false
  }
}

// or even
data: {
  isActive: true,
  error: null
},
computed: {
  classObject: function () {
    return {
      active: this.isActive &amp;&amp; !this.error,
      'text-danger': this.error &amp;&amp; this.error.type === 'fatal'
    }
  }
}
</pre>

<p>
Array
</p>
<pre class="example">
&lt;div v-bind:class="[activeClass, errorClass]"&gt;&lt;/div&gt;
data: {
  activeClass: 'active',
  errorClass: 'text-danger'
}

&lt;div v-bind:class="[isActive ? activeClass : '', errorClass]"&gt;&lt;/div&gt;
&lt;div v-bind:class="[{ active: isActive }, errorClass]"&gt;&lt;/div&gt;
</pre>

<p>
When you use the class attribute on a custom component, those classes will be added to the component’s root element. Existing classes on this element will not be overwritten.
</p>

<pre class="example">
Vue.component('my-component', {
  template: '&lt;p class="foo bar"&gt;Hi&lt;/p&gt;'
})

&lt;my-component class="baz boo"&gt;&lt;/my-component&gt;

// the rendered HTML will be:
// &lt;p class="foo bar baz boo"&gt;Hi&lt;/p&gt;
// the same is also true for class bindings

&lt;my-component v-bind:class="{ active: isActive }"&gt;&lt;/my-component&gt;

// &lt;p class="foo bar active"&gt;Hi&lt;/p&gt;
</pre>
</div>
</div>

<div id="outline-container-org1bbab60" class="outline-5">
<h5 id="org1bbab60"><span class="section-number-5">14.7.6.3</span> v-bind:style</h5>
<div class="outline-text-5" id="text-14-7-6-3">
<p>
CSS vendor-prefixes are auto detected and added when v-bind:style is used
Use either camelCase or kebab-case for CSS property name
</p>
<pre class="example">
&lt;div v-bind:style="{ color: activeColor, fontSize: fontSize + 'px' }"&gt;&lt;/div&gt;
// kebob case
// &lt;div v-bind:style="{ color: activeColor, 'font-size': fontSize + 'px' }"&gt;&lt;/div&gt;

data: {
  activeColor: 'red',
  fontSize: 30
}

&lt;div v-bind:style="styleObject"&gt;&lt;/div&gt;
data: {
  styleObject: {
    color: 'red',
    fontSize: '13px'
  }
}
</pre>

<p>
Array
</p>
<pre class="example">
&lt;div v-bind:style="[baseStyles, overridingStyles]"&gt;&lt;/div&gt;
</pre>

<p>
You don't need to do this but since 2.3.0+
</p>
<pre class="example">
&lt;div v-bind:style="{ display: ['-webkit-box', '-ms-flexbox', 'flex'] }"&gt;&lt;/div&gt;
</pre>
<p>
This will only render the last value in the array which the browser supports.
</p>
</div>
</div>
</div>

<div id="outline-container-org5e01b72" class="outline-4">
<h4 id="org5e01b72"><span class="section-number-4">14.7.7</span> Modifiers :: v-on:submit.prevent</h4>
<div class="outline-text-4" id="text-14-7-7">
<p>
Refer to <a href="#org70de315">vue:event:modifiers</a>
</p>
<pre class="example">
&lt;form v-on:submit.prevent="onSubmit"&gt; ... &lt;/form&gt;
</pre>
</div>
</div>

<div id="outline-container-org8e20913" class="outline-4">
<h4 id="org8e20913"><span class="section-number-4">14.7.8</span> v-if, key attribute, v-show</h4>
<div class="outline-text-4" id="text-14-7-8">
<p>
When used together with v-if, v-for has a higher priority than v-if.
</p>

<pre class="example">
&lt;h1 v-if="ok"&gt;Yes&lt;/h1&gt;
&lt;h1 v-else&gt;No&lt;/h1&gt;
</pre>

<p>
Group with v-if on &lt;template&gt;. template element will not be included
</p>
<pre class="example">
&lt;template v-if="ok"&gt;
  &lt;h1&gt;Title&lt;/h1&gt;
  &lt;p&gt;Paragraph 1&lt;/p&gt;
  &lt;p&gt;Paragraph 2&lt;/p&gt;
&lt;/template&gt;
</pre>

<p>
v-else must immediately follow a v-if or v-else-if element.
</p>
<pre class="example">
&lt;div v-if="Math.random() &gt; 0.5"&gt;
  Now you see me
&lt;/div&gt;
&lt;div v-else&gt;
  Now you don't
&lt;/div&gt;
</pre>

<p>
v-else-if since 2.1.0+
</p>
<pre class="example">
&lt;div v-if="type === 'A'"&gt;
  A
&lt;/div&gt;
&lt;div v-else-if="type === 'B'"&gt;
  B
&lt;/div&gt;
&lt;div v-else-if="type === 'C'"&gt;
  C
&lt;/div&gt;
&lt;div v-else&gt;
  Not A/B/C
&lt;/div&gt;
</pre>

<p>
key attribute marks an element unique which means elements shouldn't be reused unless it has the same key
</p>
<pre class="example">
&lt;template v-if="loginType === 'username'"&gt;
  &lt;label&gt;Username&lt;/label&gt;
  &lt;input placeholder="Enter your username" key="username-input"&gt;
&lt;/template&gt;
&lt;template v-else&gt;
  &lt;label&gt;Email&lt;/label&gt;
  &lt;input placeholder="Enter your email address" key="email-input"&gt;
&lt;/template&gt;
</pre>

<p>
v-show toggles the element’s display CSS property based on the truthy-ness of the expression value.
</p>

<p>
v-show doesn’t support the &lt;template&gt; element, nor does it work with v-else.
</p>

<p>
v-if vs v-show
It's expensive to toggle v-if, so use it when the condition is unlikely to change over time.
</p>

<p>
v-if is lazy means if it's false on initial render, it will not do anything, the conditional block won't be rendered until the condition becomes true for the first time.
</p>

<p>
v-show always render.
</p>

<p>
Use v-show if it needs to be toggled very often.
</p>
</div>
</div>

<div id="outline-container-org422a0c1" class="outline-4">
<h4 id="org422a0c1"><span class="section-number-4">14.7.9</span> List, v-for</h4>
<div class="outline-text-4" id="text-14-7-9">
</div>
<div id="outline-container-org9e63dfe" class="outline-5">
<h5 id="org9e63dfe"><span class="section-number-5">14.7.9.1</span> Basics</h5>
<div class="outline-text-5" id="text-14-7-9-1">
<p>
v-for has full access to parent scope properties
</p>

<pre class="example">
// array
&lt;ul id="example-1"&gt;
  &lt;li v-for="item in items"&gt;
    {{ item.message }}
  &lt;/li&gt;
&lt;/ul&gt;
var example1 = new Vue({
  el: '#example-1',
  data: {
    items: [
      { message: 'Foo' },
      { message: 'Bar' }
    ]
  }
})

&lt;ul id="example-2"&gt;
  &lt;li v-for="(item, index) in items"&gt;
    {{ parentMessage }} - {{ index }} - {{ item.message }}
  &lt;/li&gt;
&lt;/ul&gt;

var example2 = new Vue({
  el: '#example-2',
  data: {
    parentMessage: 'Parent',
    items: [
      { message: 'Foo' },
      { message: 'Bar' }
    ]
  }
})

&lt;div v-for="item of items"&gt;&lt;/div&gt;

// object
&lt;ul id="v-for-object" class="demo"&gt;
  &lt;li v-for="value in object"&gt;
    {{ value }}
  &lt;/li&gt;
&lt;/ul&gt;

new Vue({
  el: '#v-for-object',
  data: {
    object: {
      firstName: 'John',
      lastName: 'Doe',
      age: 30
    }
  }
})

&lt;div v-for="(value, key) in object"&gt;
  {{ key }}: {{ value }}
&lt;/div&gt;

&lt;div v-for="(value, key, index) in object"&gt;
  {{ index }}. {{ key }}: {{ value }}
&lt;/div&gt;
</pre>

<p>
The default mode is only suitable when your list render output does not reply on child component state or temporary DOM state (e.g. form input values)
</p>

<p>
Provide a unqiue key attribute for each item.
</p>
<pre class="example">
&lt;div v-for="item in items" :key="item.id"&gt;
  &lt;!-- content --&gt;
&lt;/div&gt;
</pre>

<p>
Refer to <a href="#orgfb81df4">vue:data</a> for mutation and non-mutating methods
</p>
</div>
</div>

<div id="outline-container-orge93b844" class="outline-5">
<h5 id="orge93b844"><span class="section-number-5">14.7.9.2</span> Filtered/Sorted</h5>
<div class="outline-text-5" id="text-14-7-9-2">
<pre class="example">
&lt;li v-for="n in evenNumbers"&gt;{{ n }}&lt;/li&gt;

data: {
  numbers: [ 1, 2, 3, 4, 5 ]
},
computed: {
  evenNumbers: function () {
    return this.numbers.filter(function (number) {
      return number % 2 === 0
    })
  }
}
</pre>

<p>
In case when computed properties are not feasible e.g. inside nested v-for loops
</p>
<pre class="example">
&lt;li v-for="n in even(numbers)"&gt;{{ n }}&lt;/li&gt;
data: {
  numbers: [ 1, 2, 3, 4, 5 ]
},
methods: {
  even: function (numbers) {
    return numbers.filter(function (number) {
      return number % 2 === 0
    })
  }
}
</pre>
</div>
</div>

<div id="outline-container-org6aaddeb" class="outline-5">
<h5 id="org6aaddeb"><span class="section-number-5">14.7.9.3</span> range</h5>
<div class="outline-text-5" id="text-14-7-9-3">
<pre class="example">
&lt;div&gt;
  &lt;span v-for="n in 10"&gt;{{ n }} &lt;/span&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org87bf6d6" class="outline-5">
<h5 id="org87bf6d6"><span class="section-number-5">14.7.9.4</span> v-for on &lt;template&gt;</h5>
<div class="outline-text-5" id="text-14-7-9-4">
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">ul</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">template</span> <span style="color: #dbdb95;">v-for</span>=<span style="color: #e67128;">"item in items"</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">li</span>&gt;{{ item.msg }}&lt;/<span style="color: #00ede1; font-weight: bold;">li</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">li</span> <span style="color: #dbdb95;">class</span>=<span style="color: #e67128;">"divider"</span>&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">li</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">template</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">ul</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org92e0741" class="outline-5">
<h5 id="org92e0741"><span class="section-number-5">14.7.9.5</span> v-for with v-if</h5>
<div class="outline-text-5" id="text-14-7-9-5">
<pre class="example">
&lt;li v-for="todo in todos" v-if="!todo.isComplete"&gt;
  {{ todo }}
&lt;/li&gt;

// don't execute v-for at all
&lt;ul v-if="todos.length"&gt;
  &lt;li v-for="todo in todos"&gt;
    {{ todo }}
  &lt;/li&gt;
&lt;/ul&gt;
&lt;p v-else&gt;No todos left!&lt;/p&gt;
</pre>
</div>
</div>

<div id="outline-container-org9be46bc" class="outline-5">
<h5 id="org9be46bc"><span class="section-number-5">14.7.9.6</span> v-for with a component</h5>
<div class="outline-text-5" id="text-14-7-9-6">
<pre class="example">
&lt;my-component v-for="item in items" :key="item.id"&gt;&lt;/my-component&gt;

// pass data to component
&lt;my-component
  v-for="(item, index) in items"
  v-bind:item="item"
  v-bind:index="index"
  v-bind:key="item.id"
&gt;&lt;/my-component&gt;
</pre>
</div>
</div>

<div id="outline-container-org9e7a5b4" class="outline-5">
<h5 id="org9e7a5b4"><span class="section-number-5">14.7.9.7</span> Example</h5>
<div class="outline-text-5" id="text-14-7-9-7">
<p>
Because it has to be at least one &lt;li&gt; in &lt;ul&gt; to be valid. <code>is="todo-item"</code> is needed.
</p>
<pre class="example">
&lt;div id="todo-list-example"&gt;
  &lt;input
    v-model="newTodoText"
    v-on:keyup.enter="addNewTodo"
    placeholder="Add a todo"
  &gt;
  &lt;ul&gt;
    &lt;li
      is="todo-item"
      v-for="(todo, index) in todos"
      v-bind:key="todo.id"
      v-bind:title="todo.title"
      v-on:remove="todos.splice(index, 1)"
    &gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;

Vue.component('todo-item', {
  template: '\
    &lt;li&gt;\
      {{ title }}\
      &lt;button v-on:click="$emit(\'remove\')"&gt;X&lt;/button&gt;\
    &lt;/li&gt;\
  ',
  props: ['title']
})
new Vue({
  el: '#todo-list-example',
  data: {
    newTodoText: '',
    todos: [
      {
        id: 1,
        title: 'Do the dishes',
      },
      {
        id: 2,
        title: 'Take out the trash',
      },
      {
        id: 3,
        title: 'Mow the lawn'
      }
    ],
    nextTodoId: 4
  },
  methods: {
    addNewTodo: function () {
      this.todos.push({
        id: this.nextTodoId++,
        title: this.newTodoText
      })
      this.newTodoText = ''
    }
  }
})
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcd55b5c" class="outline-4">
<h4 id="orgcd55b5c"><span class="section-number-4">14.7.10</span> Event, v-on, @attributeName</h4>
<div class="outline-text-4" id="text-14-7-10">
</div>
<div id="outline-container-org1952938" class="outline-5">
<h5 id="org1952938"><span class="section-number-5">14.7.10.1</span> Basics</h5>
<div class="outline-text-5" id="text-14-7-10-1">
<pre class="example">
&lt;div id="example-1"&gt;
  &lt;button v-on:click="counter += 1"&gt;Add 1&lt;/button&gt;
  &lt;p&gt;The button above has been clicked {{ counter }} times.&lt;/p&gt;
&lt;/div&gt;
var example1 = new Vue({
  el: '#example-1',
  data: {
    counter: 0
  }
})
</pre>
</div>
</div>

<div id="outline-container-orgdcd7548" class="outline-5">
<h5 id="orgdcd7548"><span class="section-number-5">14.7.10.2</span> Method calling</h5>
<div class="outline-text-5" id="text-14-7-10-2">
<pre class="example">
&lt;div id="example-2"&gt;
  &lt;!-- `greet` is the name of a method defined below --&gt;
  &lt;button v-on:click="greet"&gt;Greet&lt;/button&gt;
&lt;/div&gt;
var example2 = new Vue({
  el: '#example-2',
  data: {
    name: 'Vue.js'
  },
  // define methods under the `methods` object
  methods: {
    greet: function (event) {
      // `this` inside methods points to the Vue instance
      alert('Hello ' + this.name + '!')
      // `event` is the native DOM event
      if (event) {
        alert(event.target.tagName)
      }
    }
  }
})
// you can invoke methods in JavaScript too
example2.greet() // =&gt; 'Hello Vue.js!'
</pre>
</div>
</div>

<div id="outline-container-orgf3a8abb" class="outline-5">
<h5 id="orgf3a8abb"><span class="section-number-5">14.7.10.3</span> Inline with $event</h5>
<div class="outline-text-5" id="text-14-7-10-3">
<pre class="example">
&lt;div id="example-3"&gt;
  &lt;button v-on:click="say('hi')"&gt;Say hi&lt;/button&gt;
  &lt;button v-on:click="say('what')"&gt;Say what&lt;/button&gt;
&lt;/div&gt;
new Vue({
  el: '#example-3',
  methods: {
    say: function (message) {
      alert(message)
    }
  }
})

&lt;button v-on:click="warn('Form cannot be submitted yet.', $event)"&gt;
  Submit
&lt;/button&gt;
methods: {
  warn: function (message, event) {
    // now we have access to the native event
    if (event) event.preventDefault()
    alert(message)
  }
}
</pre>
</div>
</div>

<div id="outline-container-org7d23e01" class="outline-5">
<h5 id="org7d23e01"><span class="section-number-5">14.7.10.4</span> Event Modifiers</h5>
<div class="outline-text-5" id="text-14-7-10-4">
<p>
<a id="org70de315">vue:event:modifiers</a>
</p>

<p>
.stop, .prevent, .capture, .self, .once
</p>

<pre class="example">
&lt;!-- the click event's propagation will be stopped --&gt;
&lt;a v-on:click.stop="doThis"&gt;&lt;/a&gt;

&lt;!-- the submit event will no longer reload the page --&gt;
&lt;form v-on:submit.prevent="onSubmit"&gt;&lt;/form&gt;

&lt;!-- modifiers can be chained :: chain stop and prevent. --&gt;
&lt;a v-on:click.stop.prevent="doThat"&gt;&lt;/a&gt;

&lt;!-- chain order matters. @click.prevent.self will prevent all clicks while @click.self.prevent will only prevent clicks on the element itself --&gt;

&lt;!-- just the modifier --&gt;
&lt;form v-on:submit.prevent&gt;&lt;/form&gt;

&lt;!-- use capture mode when adding the event listener --&gt;
&lt;!-- i.e. an event targeting an inner element is handled here before being handled by that element --&gt;
&lt;div v-on:click.capture="doThis"&gt;...&lt;/div&gt;

&lt;!-- only trigger handler if event.target is the element itself --&gt;
&lt;!-- i.e. not from a child element --&gt;
&lt;div v-on:click.self="doThat"&gt;...&lt;/div&gt;

&lt;!-- the click event will be triggered at most once. 2.1.4+ --&gt;
&lt;a v-on:click.once="doThis"&gt;&lt;/a&gt;
</pre>
</div>
</div>

<div id="outline-container-org05680d3" class="outline-5">
<h5 id="org05680d3"><span class="section-number-5">14.7.10.5</span> Event Key Modifiers <a id="org38e6179">vue:event:key modifiers</a></h5>
<div class="outline-text-5" id="text-14-7-10-5">
<pre class="example">
&lt;!-- only call vm.submit() when the keyCode is 13 --&gt;
&lt;input v-on:keyup.13="submit"&gt;

&lt;!-- also works for shorthand --&gt;
&lt;input @keyup.enter="submit"&gt;
</pre>

<p>
Full list :: .enter, .tab, .delete (both Delete and Backspace), .esc, .space, .up, .down, .left, .right
</p>

<p>
Define custom key modifier aliase
</p>
<pre class="example">
// enable v-on:keyup.f1
Vue.config.keyCodes.f1 = 112
</pre>

<p>
Directly use any valid key names provided by <a href="https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values">KeyboardEvent.key</a> as modifiers by converting them to kebab-case.
e.g. the handler will only be called if $event.key <code>=</code> 'PageDown'.
</p>
<pre class="example">
&lt;input @keyup.page-down="onPageDown"&gt;
</pre>

<p>
.ctrl, .alt, .shift, .meta (windows key or Mac's command key)
</p>
<pre class="example">
&lt;!-- Alt + C --&gt;
&lt;input @keyup.alt.67="clear"&gt;

&lt;!-- Ctrl + Click --&gt;
&lt;div @click.ctrl="doSomething"&gt;Do something&lt;/div&gt;
</pre>

<p>
.exact
</p>
<pre class="example">
&lt;!-- this will fire even if Alt or Shift is also pressed --&gt;
&lt;button @click.ctrl="onClick"&gt;A&lt;/button&gt;

&lt;!-- this will only fire when only Ctrl is pressed --&gt;
&lt;button @click.ctrl.exact="onCtrlClick"&gt;A&lt;/button&gt;
</pre>

<p>
.left, .right, .middle
</p>
</div>
</div>

<div id="outline-container-org9ee7db3" class="outline-5">
<h5 id="org9ee7db3"><span class="section-number-5">14.7.10.6</span> Event from child component. .sync <a id="orgcb22482">vue:event:component</a></h5>
<div class="outline-text-5" id="text-14-7-10-6">
<pre class="example">
&lt;div id="counter-event-example"&gt;
  &lt;p&gt;{{ total }}&lt;/p&gt;
  &lt;button-counter v-on:increment="incrementTotal"&gt;&lt;/button-counter&gt;
  &lt;button-counter v-on:increment="incrementTotal"&gt;&lt;/button-counter&gt;
&lt;/div&gt;

Vue.component('button-counter', {
  template: '&lt;button v-on:click="incrementCounter"&gt;{{ counter }}&lt;/button&gt;',
  data: function () {
    return {
      counter: 0
    }
  },
  methods: {
    incrementCounter: function () {
      this.counter += 1
      this.$emit('increment')
    }
  },
})
new Vue({
  el: '#counter-event-example',
  data: {
    total: 0
  },
  methods: {
    incrementTotal: function () {
      this.total += 1
    }
  }
})
</pre>

<p>
vm.$on can only listen events on teh current vm. But in order to listen from child components, you will need v-on in parent template
</p>
<pre class="example">
vm.$on('test', function (msg) {
  console.log(msg)
})
vm.$emit('test', 'hi')
// =&gt; "hi"
</pre>

<p>
In parent, when adding a native even (e.g. click) on a component, @click.native="parentMethod" is required.
</p>

<p>
.sync
By default one-way data flow from parent to child. There's time when modifying parent prop is desired. But try to avoid this.
</p>
<pre class="example">
&lt;comp :foo.sync="bar"&gt;&lt;/comp&gt;

// got expanded to

&lt;comp :foo="bar" @update:foo="val =&gt; bar = val"&gt;&lt;/comp&gt;

// For the child component to update foo‘s value, it needs to explicitly emit an event instead of mutating the prop:

this.$emit('update:foo', newValue)
</pre>
</div>
</div>

<div id="outline-container-org7774da0" class="outline-5">
<h5 id="org7774da0"><span class="section-number-5">14.7.10.7</span> Event in Form, v-model <a id="org37427fe">vue:event:v-model</a></h5>
<div class="outline-text-5" id="text-14-7-10-7">
<pre class="example">
&lt;input v-model="something"&gt;
// is equivalent of
&lt;input
  v-bind:value="something"
  v-on:input="something = $event.target.value"&gt;

// For a component
&lt;custom-input
  :value="something"
  @input="value =&gt; { something = value }"&gt;
&lt;/custom-input&gt;
</pre>

<p>
Custom form input
The key point is the component has to have props: ['value'] and emit an input event with the new value
</p>
</div>

<ol class="org-ol">
<li><a id="orgaa2e7bf"></a>text<br />
<div class="outline-text-6" id="text-14-7-10-7-1">
<pre class="example">
&lt;script src="https://cdn.rawgit.com/chrisvfritz/5f0a639590d6e648933416f90ba7ae4e/raw/974aa47f8f9c5361c5233bd56be37db8ed765a09/currency-validator.js"&gt;&lt;/script&gt;
&lt;div id="app"&gt;
  &lt;currency-input 
    label="Price" 
    v-model="price"
  &gt;&lt;/currency-input&gt;
  &lt;currency-input 
    label="Shipping" 
    v-model="shipping"
  &gt;&lt;/currency-input&gt;
  &lt;currency-input 
    label="Handling" 
    v-model="handling"
  &gt;&lt;/currency-input&gt;
  &lt;currency-input 
    label="Discount" 
    v-model="discount"
  &gt;&lt;/currency-input&gt;

  &lt;p&gt;Total: ${{ total }}&lt;/p&gt;
&lt;/div&gt;

Vue.component('currency-input', {
  template: '\
    &lt;div&gt;\
      &lt;label v-if="label"&gt;{{ label }}&lt;/label&gt;\
      $\
      &lt;input\
        ref="input"\
        v-bind:value="value"\
        v-on:input="updateValue($event.target.value)"\
        v-on:focus="selectAll"\
        v-on:blur="formatValue"\
      &gt;\
    &lt;/div&gt;\
  ',
  props: {
    value: {
      type: Number,
      default: 0
    },
    label: {
      type: String,
      default: ''
    }
  },
  mounted: function () {
    this.formatValue()
  },
  methods: {
    updateValue: function (value) {
      var result = currencyValidator.parse(value, this.value)
      if (result.warning) {
        this.$refs.input.value = result.value
      }
      this.$emit('input', result.value)
    },
    formatValue: function () {
      this.$refs.input.value = currencyValidator.format(this.value)
    },
    selectAll: function (event) {
      // Workaround for Safari bug
      // http://stackoverflow.com/questions/1269722/selecting-text-on-focus-using-jquery-not-working-in-safari-and-chrome
      setTimeout(function () {
        event.target.select()
      }, 0)
    }
  }
})

new Vue({
  el: '#app',
  data: {
    price: 0,
    shipping: 0,
    handling: 0,
    discount: 0
  },
  computed: {
    total: function () {
      return ((
        this.price * 100 + 
        this.shipping * 100 + 
        this.handling * 100 - 
        this.discount * 100
      ) / 100).toFixed(2)
    }
  }
})
</pre>
</div>
</li>

<li><a id="org4bbff34"></a>checkbox<br />
<div class="outline-text-6" id="text-14-7-10-7-2">
<p>
By default, v-model on a component uses value as the prop and input as the event, but some input types such as checkboxes and radio buttons may want to use the value prop for a different purpose. Using the model option can avoid the conflict in such cases
</p>
<pre class="example">
Vue.component('my-checkbox', {
  model: {
    prop: 'checked',
    event: 'change'
  },
  props: {
    checked: Boolean,
    // this allows using the `value` prop for a different purpose
    value: String
  },
  // ...
})

&lt;my-checkbox v-model="foo" value="some value"&gt;&lt;/my-checkbox&gt;

// is equivalent to
&lt;my-checkbox
  :checked="foo"
  @change="val =&gt; { foo = val }"
  value="some value"&gt;
&lt;/my-checkbox&gt;
</pre>
</div>
</li>
</ol>
</div>

<div id="outline-container-org8b7f344" class="outline-5">
<h5 id="org8b7f344"><span class="section-number-5">14.7.10.8</span> Use Event to transfer data between components that are not parent-child</h5>
<div class="outline-text-5" id="text-14-7-10-8">
<pre class="example">
var bus = new Vue()
bus.$emit('id-selected', 1)
// in component B's created hook
bus.$on('id-selected', function (id) {
  // ...
})
</pre>

<p>
If it's more complex, refer to <a href="#org1be60e5">vue:state management</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orgd34eab4" class="outline-4">
<h4 id="orgd34eab4"><span class="section-number-4">14.7.11</span> Form input, v-model</h4>
<div class="outline-text-4" id="text-14-7-11">
<p>
v-model will ignore the initial value, checked or selected.
</p>
</div>

<div id="outline-container-org16886bf" class="outline-5">
<h5 id="org16886bf"><span class="section-number-5">14.7.11.1</span> textarea</h5>
<div class="outline-text-5" id="text-14-7-11-1">
<pre class="example">
&lt;span&gt;Multiline message is:&lt;/span&gt;
&lt;p style="white-space: pre-line;"&gt;{{ message }}&lt;/p&gt;  &lt;br&gt;
&lt;textarea v-model="message" placeholder="add multiple lines"&gt;&lt;/textarea&gt;
</pre>
</div>
</div>

<div id="outline-container-orgf4d6eca" class="outline-5">
<h5 id="orgf4d6eca"><span class="section-number-5">14.7.11.2</span> checkbox</h5>
<div class="outline-text-5" id="text-14-7-11-2">
<pre class="example">
&lt;input type="checkbox" id="checkbox" v-model="checked"&gt;
&lt;label for="checkbox"&gt;{{ checked }}&lt;/label&gt;

&lt;!-- `toggle` is either true or false --&gt;
&lt;input type="checkbox" v-model="toggle"&gt;

// multiple checkboxes

&lt;div id='example-3'&gt;
  &lt;input type="checkbox" id="jack" value="Jack" v-model="checkedNames"&gt;
  &lt;label for="jack"&gt;Jack&lt;/label&gt;
  &lt;input type="checkbox" id="john" value="John" v-model="checkedNames"&gt;
  &lt;label for="john"&gt;John&lt;/label&gt;
  &lt;input type="checkbox" id="mike" value="Mike" v-model="checkedNames"&gt;
  &lt;label for="mike"&gt;Mike&lt;/label&gt;
  &lt;br&gt;
  &lt;span&gt;Checked names: {{ checkedNames }}&lt;/span&gt;
&lt;/div&gt;

new Vue({
  el: '#example-3',
  data: {
    checkedNames: []
  }
})


</pre>
</div>
</div>

<div id="outline-container-orgf686592" class="outline-5">
<h5 id="orgf686592"><span class="section-number-5">14.7.11.3</span> radio</h5>
<div class="outline-text-5" id="text-14-7-11-3">
<pre class="example">
&lt;input type="radio" id="one" value="One" v-model="picked"&gt;
&lt;label for="one"&gt;One&lt;/label&gt;
&lt;br&gt;
&lt;input type="radio" id="two" value="Two" v-model="picked"&gt;
&lt;label for="two"&gt;Two&lt;/label&gt;
&lt;br&gt;
&lt;span&gt;Picked: {{ picked }}&lt;/span&gt;

&lt;!-- `picked` is a string "a" when checked --&gt;
&lt;input type="radio" v-model="picked" value="a"&gt;
</pre>
</div>
</div>

<div id="outline-container-org40fec0f" class="outline-5">
<h5 id="org40fec0f"><span class="section-number-5">14.7.11.4</span> select</h5>
<div class="outline-text-5" id="text-14-7-11-4">
<pre class="example">
&lt;select v-model="selected"&gt;
  &lt;option disabled value=""&gt;Please select one&lt;/option&gt;
  &lt;option&gt;A&lt;/option&gt;
  &lt;option&gt;B&lt;/option&gt;
  &lt;option&gt;C&lt;/option&gt;
&lt;/select&gt;
&lt;span&gt;Selected: {{ selected }}&lt;/span&gt;

new Vue({
  el: '...',
  data: {
    selected: ''
  }
})

&lt;!-- `selected` is a string "abc" when selected --&gt;
&lt;select v-model="selected"&gt;
  &lt;option value="abc"&gt;ABC&lt;/option&gt;
&lt;/select&gt;

// select multiple
&lt;select v-model="selected" multiple&gt;
  &lt;option&gt;A&lt;/option&gt;
  &lt;option&gt;B&lt;/option&gt;
  &lt;option&gt;C&lt;/option&gt;
&lt;/select&gt;
&lt;br&gt;
&lt;span&gt;Selected: {{ selected }}&lt;/span&gt;

// select v-for
&lt;select v-model="selected"&gt;
  &lt;option v-for="option in options" v-bind:value="option.value"&gt;
    {{ option.text }}
  &lt;/option&gt;
&lt;/select&gt;
&lt;span&gt;Selected: {{ selected }}&lt;/span&gt;

new Vue({
  el: '...',
  data: {
    selected: 'A',
    options: [
      { text: 'One', value: 'A' },
      { text: 'Two', value: 'B' },
      { text: 'Three', value: 'C' }
    ]
  }
})
</pre>
</div>
</div>

<div id="outline-container-org69b5104" class="outline-5">
<h5 id="org69b5104"><span class="section-number-5">14.7.11.5</span> Use v-bind with v-model to prepopulate</h5>
<div class="outline-text-5" id="text-14-7-11-5">
<pre class="example">
&lt;input
  type="checkbox"
  v-model="toggle"
  v-bind:true-value="a"
  v-bind:false-value="b"
&gt;

// when checked:
vm.toggle === vm.a
// when unchecked:
vm.toggle === vm.b

&lt;input type="radio" v-model="pick" v-bind:value="a"&gt;
// when checked:
vm.pick === vm.a

&lt;select v-model="selected"&gt;
  &lt;!-- inline object literal --&gt;
  &lt;option v-bind:value="{ number: 123 }"&gt;123&lt;/option&gt;
&lt;/select&gt;
</pre>
</div>
</div>

<div id="outline-container-orgac20504" class="outline-5">
<h5 id="orgac20504"><span class="section-number-5">14.7.11.6</span> v-model modifiers</h5>
<div class="outline-text-5" id="text-14-7-11-6">
<pre class="example">
.lazy
&lt;!-- synced after "change" instead of "input" --&gt;
&lt;input v-model.lazy="msg" &gt;

.number :: typecast as a number
&lt;input v-model.number="age" type="number"&gt;

.trim
&lt;input v-model.trim="msg"&gt;
</pre>
</div>
</div>

<div id="outline-container-org380d49c" class="outline-5">
<h5 id="org380d49c"><span class="section-number-5">14.7.11.7</span> Event in v-model</h5>
<div class="outline-text-5" id="text-14-7-11-7">
<p>
<a href="#org37427fe">vue:event:v-model</a>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orge4f14f0" class="outline-3">
<h3 id="orge4f14f0"><span class="section-number-3">14.8</span> Computed Property, Watchers</h3>
<div class="outline-text-3" id="text-14-8">
</div>
<div id="outline-container-orge7a63a9" class="outline-4">
<h4 id="orge7a63a9"><span class="section-number-4">14.8.1</span> Computed property</h4>
<div class="outline-text-4" id="text-14-8-1">
<pre class="example">
&lt;div id="example"&gt;
  &lt;p&gt;Original message: "{{ message }}"&lt;/p&gt;
  &lt;p&gt;Computed reversed message: "{{ reversedMessage }}"&lt;/p&gt;
  &lt;!-- same as 
  &lt;p&gt;Reversed message: "{{ reverseMessage()  }}"&lt;/p&gt;
  --&gt;
&lt;/div&gt;

var vm = new Vue({
  el: '#example',
  data: {
    message: 'Hello'
  },
  computed: {
    // a computed getter
    reversedMessage: function () {
      // `this` points to the vm instance
      return this.message.split('').reverse().join('')
    }
  }
  /* same as method
  methods: {
    reverseMessage: function () {
      return this.message.split('').reverse().join('')
    }
  }
  */
})
</pre>

<p>
The computed property is cached until vm.$data.message is not changed. While method will run every time the view updates (re-render).
</p>

<p>
Hence, never define computed property without vm.$data e.g.
</p>
<pre class="example">
computed: {
  now: function () {
    return Date.now()
  }
}
</pre>

<p>
vm.watch is to watch a property vm.data.propA change.
</p>

<p>
Try to avoid using watch too much, use computed property instead
</p>

<p>
Instead of
</p>
<pre class="example">
var vm = new Vue({
  el: '#demo',
  data: {
    firstName: 'Foo',
    lastName: 'Bar',
    fullName: 'Foo Bar'
  },
  watch: {
    firstName: function (newval, oldval) {
      this.fullName = newval + ' ' + this.lastName
    },
    lastName: function (newval, oldval) {
      this.fullName = this.firstName + ' ' + newval
    }
  }
})
</pre>

<p>
Use
</p>
<pre class="example">
var vm = new Vue({
  el: '#demo',
  data: {
    firstName: 'Foo',
    lastName: 'Bar'
  },
  computed: {
    fullName: function () {
      return this.firstName + ' ' + this.lastName
    }
  }
})
</pre>

<p>
Computed setter
</p>
<pre class="example">
computed: {
  fullName: {
    // getter
    get: function () {
      return this.firstName + ' ' + this.lastName
    },
    // setter
    set: function (newValue) {
      var names = newValue.split(' ')
      this.firstName = names[0]
      this.lastName = names[names.length - 1]
    }
  }
}
</pre>
</div>
</div>

<div id="outline-container-org15e2399" class="outline-4">
<h4 id="org15e2399"><span class="section-number-4">14.8.2</span> Watchers</h4>
<div class="outline-text-4" id="text-14-8-2">
<pre class="example">
&lt;div id="watch-example"&gt;
  &lt;p&gt;
    Ask a yes/no question:
    &lt;input v-model="question"&gt;
  &lt;/p&gt;
  &lt;p&gt;{{ answer }}&lt;/p&gt;
&lt;/div&gt;

&lt;!-- Since there is already a rich ecosystem of ajax libraries    --&gt;
&lt;!-- and collections of general-purpose utility methods, Vue core --&gt;
&lt;!-- is able to remain small by not reinventing them. This also   --&gt;
&lt;!-- gives you the freedom to use what you're familiar with. --&gt;
&lt;script src="https://cdn.jsdelivr.net/npm/axios@0.12.0/dist/axios.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdn.jsdelivr.net/npm/lodash@4.13.1/lodash.min.js"&gt;&lt;/script&gt;
&lt;script&gt;
var watchExampleVM = new Vue({
  el: '#watch-example',
  data: {
    question: '',
    answer: 'I cannot give you an answer until you ask a question!'
  },
  watch: {
    // whenever question changes, this function will run
    question: function (newQuestion) {
      this.answer = 'Waiting for you to stop typing...'
      this.getAnswer()
    }
  },
  methods: {
    // _.debounce is a function provided by lodash to limit how
    // often a particularly expensive operation can be run.
    // In this case, we want to limit how often we access
    // yesno.wtf/api, waiting until the user has completely
    // finished typing before making the ajax request. To learn
    // more about the _.debounce function (and its cousin
    // _.throttle), visit: https://lodash.com/docs#debounce
    getAnswer: _.debounce(
      function () {
        if (this.question.indexOf('?') === -1) {
          this.answer = 'Questions usually contain a question mark. ;-)'
          return
        }
        this.answer = 'Thinking...'
        var vm = this
        axios.get('https://yesno.wtf/api')
          .then(function (response) {
            vm.answer = _.capitalize(response.data.answer)
          })
          .catch(function (error) {
            vm.answer = 'Error! Could not reach the API. ' + error
          })
      },
      // This is the number of milliseconds we wait for the
      // user to stop typing.
      500
    )
  }
})
&lt;/script&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org63a9f94" class="outline-3">
<h3 id="org63a9f94"><span class="section-number-3">14.9</span> Transition &amp; Animation</h3>
<div class="outline-text-3" id="text-14-9">
</div>
<div id="outline-container-org4723f11" class="outline-4">
<h4 id="org4723f11"><span class="section-number-4">14.9.1</span> &lt;transition&gt; wrapper component</h4>
<div class="outline-text-4" id="text-14-9-1">
<p>
Wrap v-if, v-show, dynamic components and component root nodes
</p>
</div>

<div id="outline-container-org9e6c5e8" class="outline-5">
<h5 id="org9e6c5e8"><span class="section-number-5">14.9.1.1</span> CSS Transition</h5>
<div class="outline-text-5" id="text-14-9-1-1">
<pre class="example">
&lt;div id="demo"&gt;
  &lt;button v-on:click="show = !show"&gt;
    Toggle
  &lt;/button&gt;
  &lt;transition name="fade"&gt;
    &lt;p v-if="show"&gt;hello&lt;/p&gt;
  &lt;/transition&gt;
&lt;/div&gt;
new Vue({
  el: '#demo',
  data: {
    show: true
  }
})
.fade-enter-active, .fade-leave-active {
  transition: opacity .5s
}
.fade-enter, .fade-leave-to /* .fade-leave-active below version 2.1.8 */ {
  opacity: 0
}

// more examples using pure css
/* Enter and leave animations can use different */
/* durations and timing functions.              */
.slide-fade-enter-active {
  transition: all .3s ease;
}
.slide-fade-leave-active {
  transition: all .8s cubic-bezier(1.0, 0.5, 0.8, 1.0);
}
.slide-fade-enter, .slide-fade-leave-to
/* .slide-fade-leave-active below version 2.1.8 */ {
  transform: translateX(10px);
  opacity: 0;
}
</pre>

<p>
Classes
*-enter :: before element inserted &gt; one frame after element is inserted
*-enter-active :: before element is inserted &gt; removed when transition/animation finishes. Use it to define during, delay and easing curve for the entering transition.
*-enter-to : one frame after element is inserted &gt; transition/animation finishes.
*-leave :: leave transition is triggered &gt; after one frame
*-leave-active :: leave transition is triggered &gt; transition/animation finishes. Use it to define duration, delay and easing curve for the leaving transition.
*-leave-to :: one frame after a leave transition is triggered &gt; transition/animation finishes.
</p>

<p>
*-enter is enter start, *-enter-to is enter end
*-leave is leave start, *-leave-to is leave end
</p>

<p>
v- prefix is used when &lt;transition&gt; has no name
</p>
</div>
</div>

<div id="outline-container-orgd2f37bf" class="outline-5">
<h5 id="orgd2f37bf"><span class="section-number-5">14.9.1.2</span> CSS Animations</h5>
<div class="outline-text-5" id="text-14-9-1-2">
<pre class="example">
&lt;div id="example-2"&gt;
  &lt;button @click="show = !show"&gt;Toggle show&lt;/button&gt;
  &lt;transition name="bounce"&gt;
    &lt;p v-if="show"&gt;Look at me!&lt;/p&gt;
  &lt;/transition&gt;
&lt;/div&gt;

new Vue({
  el: '#example-2',
  data: {
    show: true
  }
})

.bounce-enter-active {
  animation: bounce-in .5s;
}
.bounce-leave-active {
  animation: bounce-in .5s reverse;
}
@keyframes bounce-in {
  0% {
    transform: scale(0);
  }
  50% {
    transform: scale(1.5);
  }
  100% {
    transform: scale(1);
  }
}
</pre>
</div>
</div>

<div id="outline-container-org615cd97" class="outline-5">
<h5 id="org615cd97"><span class="section-number-5">14.9.1.3</span> Custom Transition Class</h5>
<div class="outline-text-5" id="text-14-9-1-3">
<p>
Override the default class names such as Animate.css
</p>
<pre class="example">
&lt;link href="https://cdn.jsdelivr.net/npm/animate.css@3.5.1" rel="stylesheet" type="text/css"&gt;
&lt;div id="example-3"&gt;
  &lt;button @click="show = !show"&gt;
    Toggle render
  &lt;/button&gt;
  &lt;transition
    name="custom-classes-transition"
    enter-active-class="animated tada"
    leave-active-class="animated bounceOutRight"
  &gt;
    &lt;p v-if="show"&gt;hello&lt;/p&gt;
  &lt;/transition&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-orgccde6a4" class="outline-5">
<h5 id="orgccde6a4"><span class="section-number-5">14.9.1.4</span> prop</h5>
<div class="outline-text-5" id="text-14-9-1-4">
<pre class="example">
&lt;transition :duration="1000"&gt;...&lt;/transition&gt;
&lt;transition :duration="{ enter: 500, leave: 800 }"&gt;...&lt;/transition&gt;
</pre>
</div>
</div>

<div id="outline-container-org686a379" class="outline-5">
<h5 id="org686a379"><span class="section-number-5">14.9.1.5</span> event hooks</h5>
<div class="outline-text-5" id="text-14-9-1-5">
<p>
When using JavaScript-only transitions, the done callbacks are required for the enter and leave hooks.
</p>
</div>

<ol class="org-ol">
<li><a id="org571eb55"></a>events<br />
<div class="outline-text-6" id="text-14-9-1-5-1">
<pre class="example">
&lt;transition
  v-on:before-enter="beforeEnter"
  v-on:enter="enter"
  v-on:after-enter="afterEnter"
  v-on:enter-cancelled="enterCancelled"
  v-on:before-leave="beforeLeave"
  v-on:leave="leave"
  v-on:after-leave="afterLeave"
  v-on:leave-cancelled="leaveCancelled"
&gt;
  &lt;!-- ... --&gt;
&lt;/transition&gt;
</pre>
</div>
</li>

<li><a id="orgcedf676"></a>methods<br />
<div class="outline-text-6" id="text-14-9-1-5-2">
<pre class="example">
// ...
methods: {
  // --------
  // ENTERING
  // --------
  beforeEnter: function (el) {
    // ...
  },
  // the done callback is optional when
  // used in combination with CSS
  enter: function (el, done) {
    // ...
    done()
  },
  afterEnter: function (el) {
    // ...
  },
  enterCancelled: function (el) {
    // ...
  },
  // --------
  // LEAVING
  // --------
  beforeLeave: function (el) {
    // ...
  },
  // the done callback is optional when
  // used in combination with CSS
  leave: function (el, done) {
    // ...
    done()
  },
  afterLeave: function (el) {
    // ...
  },
  // leaveCancelled only available with v-show
  leaveCancelled: function (el) {
    // ...
  }
}
</pre>

<p>
When javascript-only transistions, better to add v-bind:css="false"
</p>
</div>
</li>

<li><a id="org4e58213"></a>Example using Velocity.js<br />
<div class="outline-text-6" id="text-14-9-1-5-3">
<pre class="example">
&lt;!--
Velocity works very much like jQuery.animate and is
a great option for JavaScript animations
--&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.3/velocity.min.js"&gt;&lt;/script&gt;
&lt;div id="example-4"&gt;
  &lt;button @click="show = !show"&gt;
    Toggle
  &lt;/button&gt;
  &lt;transition
    v-on:before-enter="beforeEnter"
    v-on:enter="enter"
    v-on:leave="leave"
    v-bind:css="false"
  &gt;
    &lt;p v-if="show"&gt;
      Demo
    &lt;/p&gt;
  &lt;/transition&gt;
&lt;/div&gt;

new Vue({
  el: '#example-4',
  data: {
    show: false
  },
  methods: {
    beforeEnter: function (el) {
      el.style.opacity = 0
    },
    enter: function (el, done) {
      Velocity(el, { opacity: 1, fontSize: '1.4em' }, { duration: 300 })
      Velocity(el, { fontSize: '1em' }, { complete: done })
    },
    leave: function (el, done) {
      Velocity(el, { translateX: '15px', rotateZ: '50deg' }, { duration: 600 })
      Velocity(el, { rotateZ: '100deg' }, { loop: 2 })
      Velocity(el, {
        rotateZ: '45deg',
        translateY: '30px',
        translateX: '30px',
        opacity: 0
      }, { complete: done })
    }
  }
})
</pre>
</div>
</li>
</ol>
</div>

<div id="outline-container-org62c4a6e" class="outline-5">
<h5 id="org62c4a6e"><span class="section-number-5">14.9.1.6</span> Transition on Initial Render</h5>
<div class="outline-text-5" id="text-14-9-1-6">
<p>
Use appear attribute
</p>
<pre class="example">
// default only uses enter and leave
&lt;transition appear&gt;
  &lt;!-- ... --&gt;
&lt;/transition&gt;

// specify more or custom CSS classes
&lt;transition
  appear
  appear-class="custom-appear-class"
  appear-to-class="custom-appear-to-class" (2.1.8+)
  appear-active-class="custom-appear-active-class"
&gt;
  &lt;!-- ... --&gt;
&lt;/transition&gt;

// and custom javascript hooks
&lt;transition
  appear
  v-on:before-appear="customBeforeAppearHook"
  v-on:appear="customAppearHook"
  v-on:after-appear="customAfterAppearHook"
  v-on:appear-cancelled="customAppearCancelledHook"
&gt;
  &lt;!-- ... --&gt;
&lt;/transition&gt;
</pre>
</div>
</div>

<div id="outline-container-orgc95f6bc" class="outline-5">
<h5 id="orgc95f6bc"><span class="section-number-5">14.9.1.7</span> Transition between elements</h5>
<div class="outline-text-5" id="text-14-9-1-7">
<pre class="example">
&lt;transition&gt;
  &lt;button v-if="docState === 'saved'" key="saved"&gt;
    Edit
  &lt;/button&gt;
  &lt;button v-if="docState === 'edited'" key="edited"&gt;
    Save
  &lt;/button&gt;
  &lt;button v-if="docState === 'editing'" key="editing"&gt;
    Cancel
  &lt;/button&gt;
&lt;/transition&gt;

// It's equivalent to
&lt;transition&gt;
  &lt;button v-bind:key="docState"&gt;
    {{ buttonMessage }}
  &lt;/button&gt;
&lt;/transition&gt;

// ...
computed: {
  buttonMessage: function () {
    switch (this.docState) {
      case 'saved': return 'Edit'
      case 'edited': return 'Save'
      case 'editing': return 'Cancel'
    }
  }
}
</pre>
</div>
</div>

<div id="outline-container-org2bc950d" class="outline-5">
<h5 id="org2bc950d"><span class="section-number-5">14.9.1.8</span> Transition modes</h5>
<div class="outline-text-5" id="text-14-9-1-8">
<p>
Default behavior is entering and leaving happens simultaneously.
</p>
<pre class="example">
&lt;transition name="fade" mode="out-in"&gt;
  &lt;!-- ... the buttons ... --&gt;
&lt;/transition&gt;
</pre>

<p>
in-out :: new element transitions in first then when complete, the current element transitions out.
out-in :: current element transitions out first then when complete, the new element transitions in.
</p>
</div>
</div>

<div id="outline-container-org208197e" class="outline-5">
<h5 id="org208197e"><span class="section-number-5">14.9.1.9</span> Transition between dynamic components</h5>
<div class="outline-text-5" id="text-14-9-1-9">
<p>
key attribute is not required
</p>
<pre class="example">
&lt;transition name="component-fade" mode="out-in"&gt;
  &lt;component v-bind:is="view"&gt;&lt;/component&gt;
&lt;/transition&gt;

new Vue({
  el: '#transition-components-demo',
  data: {
    view: 'v-a'
  },
  components: {
    'v-a': {
      template: '&lt;div&gt;Component A&lt;/div&gt;'
    },
    'v-b': {
      template: '&lt;div&gt;Component B&lt;/div&gt;'
    }
  }
})
</pre>
</div>
</div>
</div>

<div id="outline-container-orga5c3a2b" class="outline-4">
<h4 id="orga5c3a2b"><span class="section-number-4">14.9.2</span> List transition &lt;transition-group&gt;</h4>
<div class="outline-text-4" id="text-14-9-2">
<p>
Default is to turn the &lt;transition-group&gt; to &lt;span&gt;, change it to p in tag attribute. 
key attribute is required.
</p>
</div>

<div id="outline-container-orge2a86b0" class="outline-5">
<h5 id="orge2a86b0"><span class="section-number-5">14.9.2.1</span> Animate entering and leaving</h5>
<div class="outline-text-5" id="text-14-9-2-1">
<pre class="example">
&lt;div id="list-demo"&gt;
  &lt;button v-on:click="add"&gt;Add&lt;/button&gt;
  &lt;button v-on:click="remove"&gt;Remove&lt;/button&gt;
  &lt;transition-group name="list" tag="p"&gt;
    &lt;span v-for="item in items" v-bind:key="item" class="list-item"&gt;
      {{ item }}
    &lt;/span&gt;
  &lt;/transition-group&gt;
&lt;/div&gt;

new Vue({
  el: '#list-demo',
  data: {
    items: [1,2,3,4,5,6,7,8,9],
    nextNum: 10
  },
  methods: {
    randomIndex: function () {
      return Math.floor(Math.random() * this.items.length)
    },
    add: function () {
      this.items.splice(this.randomIndex(), 0, this.nextNum++)
    },
    remove: function () {
      this.items.splice(this.randomIndex(), 1)
    },
  }
})

.list-item {
  display: inline-block;
  margin-right: 10px;
}
.list-enter-active, .list-leave-active {
  transition: all 1s;
}
.list-enter, .list-leave-to /* .list-leave-active below version 2.1.8 */ {
  opacity: 0;
  transform: translateY(30px);
}
</pre>
</div>
</div>

<div id="outline-container-org67f2808" class="outline-5">
<h5 id="org67f2808"><span class="section-number-5">14.9.2.2</span> Animate when order is changed, v-move, *-move class</h5>
<div class="outline-text-5" id="text-14-9-2-2">
<p>
Vue uses FLIP and FLIP doesn't work with elements set to display:inline. Set it to display: inline-block or place elements in a flex context.
</p>

<pre class="example">
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.14.1/lodash.min.js"&gt;&lt;/script&gt;
&lt;div id="flip-list-demo" class="demo"&gt;
  &lt;button v-on:click="shuffle"&gt;Shuffle&lt;/button&gt;
  &lt;transition-group name="flip-list" tag="ul"&gt;
    &lt;li v-for="item in items" v-bind:key="item"&gt;
      {{ item }}
    &lt;/li&gt;
  &lt;/transition-group&gt;
&lt;/div&gt;

new Vue({
  el: '#flip-list-demo',
  data: {
    items: [1,2,3,4,5,6,7,8,9]
  },
  methods: {
    shuffle: function () {
      this.items = _.shuffle(this.items)
    }
  }
})

.flip-list-move {
  transition: transform 1s;
}
</pre>
</div>
</div>


<div id="outline-container-org857dda3" class="outline-5">
<h5 id="org857dda3"><span class="section-number-5">14.9.2.3</span> javascript hooks</h5>
<div class="outline-text-5" id="text-14-9-2-3">
<p>
By assigning different delay, list items can be transitioned in/out in the same order as they first appeared.
</p>

<pre class="example">
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.3/velocity.min.js"&gt;&lt;/script&gt;
&lt;div id="staggered-list-demo"&gt;
  &lt;input v-model="query"&gt;
  &lt;transition-group
    name="staggered-fade"
    tag="ul"
    v-bind:css="false"
    v-on:before-enter="beforeEnter"
    v-on:enter="enter"
    v-on:leave="leave"
  &gt;
    &lt;li
      v-for="(item, index) in computedList"
      v-bind:key="item.msg"
      v-bind:data-index="index"
    &gt;{{ item.msg }}&lt;/li&gt;
  &lt;/transition-group&gt;
&lt;/div&gt;

new Vue({
  el: '#staggered-list-demo',
  data: {
    query: '',
    list: [
      { msg: 'Bruce Lee' },
      { msg: 'Jackie Chan' },
      { msg: 'Chuck Norris' },
      { msg: 'Jet Li' },
      { msg: 'Kung Fury' }
    ]
  },
  computed: {
    computedList: function () {
      var vm = this
      return this.list.filter(function (item) {
        return item.msg.toLowerCase().indexOf(vm.query.toLowerCase()) !== -1
      })
    }
  },
  methods: {
    beforeEnter: function (el) {
      el.style.opacity = 0
      el.style.height = 0
    },
    enter: function (el, done) {
      var delay = el.dataset.index * 150
      setTimeout(function () {
        Velocity(
          el,
          { opacity: 1, height: '1.6em' },
          { complete: done }
        )
      }, delay)
    },
    leave: function (el, done) {
      var delay = el.dataset.index * 150
      setTimeout(function () {
        Velocity(
          el,
          { opacity: 0, height: 0 },
          { complete: done }
        )
      }, delay)
    }
  }
})
</pre>
</div>
</div>
</div>

<div id="outline-container-org7da19c8" class="outline-4">
<h4 id="org7da19c8"><span class="section-number-4">14.9.3</span> Make transition reusable</h4>
<div class="outline-text-4" id="text-14-9-3">
<pre class="example">
Vue.component('my-special-transition', {
  template: '\
    &lt;transition\
      name="very-special-transition"\
      mode="out-in"\
      v-on:before-enter="beforeEnter"\
      v-on:after-enter="afterEnter"\
    &gt;\
      &lt;slot&gt;&lt;/slot&gt;\
    &lt;/transition&gt;\
  ',
  methods: {
    beforeEnter: function (el) {
      // ...
    },
    afterEnter: function (el) {
      // ...
    }
  }
})
</pre>

<p>
Functional component
</p>
<pre class="example">
Vue.component('my-special-transition', {
  functional: true,
  render: function (createElement, context) {
    var data = {
      props: {
        name: 'very-special-transition',
        mode: 'out-in'
      },
      on: {
        beforeEnter: function (el) {
          // ...
        },
        afterEnter: function (el) {
          // ...
        }
      }
    }
    return createElement('transition', data, context.children)
  }
})
</pre>
</div>
</div>

<div id="outline-container-org1e4e0aa" class="outline-4">
<h4 id="org1e4e0aa"><span class="section-number-4">14.9.4</span> State Transition</h4>
<div class="outline-text-4" id="text-14-9-4">
<p>
Achieve transition by changing state (e.g. prop) of data.
</p>
</div>

<div id="outline-container-org544bf28" class="outline-5">
<h5 id="org544bf28"><span class="section-number-5">14.9.4.1</span> Watchers, Tween.js, Color.js</h5>
<div class="outline-text-5" id="text-14-9-4-1">
<pre class="example">
&lt;script src="https://cdn.jsdelivr.net/npm/tween.js@16.3.4"&gt;&lt;/script&gt;
&lt;div id="animated-number-demo"&gt;
  &lt;input v-model.number="number" type="number" step="20"&gt;
  &lt;p&gt;{{ animatedNumber }}&lt;/p&gt;
&lt;/div&gt;

new Vue({
  el: '#animated-number-demo',
  data: {
    number: 0,
    animatedNumber: 0
  },
  watch: {
    number: function(newValue, oldValue) {
      var vm = this
      function animate () {
        if (TWEEN.update()) {
          requestAnimationFrame(animate)
        }
      }
      new TWEEN.Tween({ tweeningNumber: oldValue })
        .easing(TWEEN.Easing.Quadratic.Out)
        .to({ tweeningNumber: newValue }, 500)
        .onUpdate(function () {
          vm.animatedNumber = this.tweeningNumber.toFixed(0)
        })
        .start()
      animate()
    }
  }
})
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0fe71ad" class="outline-3">
<h3 id="org0fe71ad"><span class="section-number-3">14.10</span> Mixins</h3>
<div class="outline-text-3" id="text-14-10">
</div>
<div id="outline-container-org080e2bb" class="outline-4">
<h4 id="org080e2bb"><span class="section-number-4">14.10.1</span> Local vs Global</h4>
<div class="outline-text-4" id="text-14-10-1">
<pre class="example">
// define a mixin object
var myMixin = {
  created: function () {
    this.hello()
  },
  methods: {
    hello: function () {
      console.log('hello from mixin!')
    }
  }
}
// define a component that uses this mixin
var Component = Vue.extend({
  mixins: [myMixin]
})
var component = new Component() // =&gt; "hello from mixin!"
</pre>

<p>
Global mixin
</p>
<pre class="example">
// inject a handler for `myOption` custom option
Vue.mixin({
  created: function () {
    var myOption = this.$options.myOption
    if (myOption) {
      console.log(myOption)
    }
  }
})
new Vue({
  myOption: 'hello!'
})
// =&gt; "hello!"
</pre>
<p>
Use global mixins sparsely and carefully, because it affects every single Vue instance created, including third party components. In most cases, you should only use it for custom option handling like demonstrated in the example above. It’s also a good idea to ship them as Plugins to avoid duplicate application.
</p>
</div>
</div>

<div id="outline-container-org1e2ee49" class="outline-4">
<h4 id="org1e2ee49"><span class="section-number-4">14.10.2</span> Merge option with hook functions</h4>
<div class="outline-text-4" id="text-14-10-2">
<p>
mixin will be called before the component's own hooks.
</p>
<pre class="example">
var mixin = {
  created: function () {
    console.log('mixin hook called')
  }
}
new Vue({
  mixins: [mixin],
  created: function () {
    console.log('component hook called')
  }
})
// =&gt; "mixin hook called"
// =&gt; "component hook called"
</pre>
</div>
</div>

<div id="outline-container-org0cd000a" class="outline-4">
<h4 id="org0cd000a"><span class="section-number-4">14.10.3</span> Merge option with Object value</h4>
<div class="outline-text-4" id="text-14-10-3">
<p>
The component's options will take priority when conflict keys exist
</p>
<pre class="example">
var mixin = {
  methods: {
    foo: function () {
      console.log('foo')
    },
    conflicting: function () {
      console.log('from mixin')
    }
  }
}
var vm = new Vue({
  mixins: [mixin],
  methods: {
    bar: function () {
      console.log('bar')
    },
    conflicting: function () {
      console.log('from self')
    }
  }
})
vm.foo() // =&gt; "foo"
vm.bar() // =&gt; "bar"
vm.conflicting() // =&gt; "from self"
</pre>
</div>
</div>

<div id="outline-container-org696926b" class="outline-4">
<h4 id="org696926b"><span class="section-number-4">14.10.4</span> Custom Option Merge Strategies</h4>
<div class="outline-text-4" id="text-14-10-4">
<pre class="example">
Vue.config.optionMergeStrategies.myOption = function (toVal, fromVal) {
  // return mergedVal
}

var strategies = Vue.config.optionMergeStrategies
strategies.myOption = strategies.methods // the default strategy for most object-based options

// more advanced
const merge = Vue.config.optionMergeStrategies.computed
Vue.config.optionMergeStrategies.vuex = function (toVal, fromVal) {
  if (!toVal) return fromVal
  if (!fromVal) return toVal
  return {
    getters: merge(toVal.getters, fromVal.getters),
    state: merge(toVal.state, fromVal.state),
    actions: merge(toVal.actions, fromVal.actions)
  }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgefe5614" class="outline-3">
<h3 id="orgefe5614"><span class="section-number-3">14.11</span> Custom Directive</h3>
<div class="outline-text-3" id="text-14-11">
</div>
<div id="outline-container-orgf25797f" class="outline-4">
<h4 id="orgf25797f"><span class="section-number-4">14.11.1</span> Basics</h4>
<div class="outline-text-4" id="text-14-11-1">
<pre class="example">
&lt;input v-focus&gt;

// Register a global custom directive called v-focus
Vue.directive('focus', {
  // When the bound element is inserted into the DOM...
  inserted: function (el) {
    // Focus the element
    el.focus()
  }
})
</pre>

<p>
Register it locally for a component, using the directives option inside the component
</p>
<pre class="example">
directives: {
  focus: {
    // directive definition
    inserted: function (el) {
      el.focus()
    }
  }
}
</pre>
</div>
</div>

<div id="outline-container-org0a4bfbd" class="outline-4">
<h4 id="org0a4bfbd"><span class="section-number-4">14.11.2</span> Option - Hook Functions</h4>
<div class="outline-text-4" id="text-14-11-2">
<p>
Other than inserted, there're other optional hooks
</p>

<dl class="org-dl">
<dt>bind</dt><dd>called only once, when the directive is first bound to the element. This is where you can do one-time setup work.</dd>
<dt>inserted</dt><dd>called when the bound element has been inserted into its parent node (this only guarantees parent node presence, not necessarily in-document).</dd>
<dt>update</dt><dd>called after the containing component’s VNode has updated, but possibly before its children have updated. The directive’s value may or may not have changed, but you can skip unnecessary updates by comparing the binding’s current and old values (see below on hook arguments).</dd>
<dt>componentUpdated</dt><dd>called after the containing component’s VNode and the VNodes of its children have updated.</dd>
</dl>
<p>
unbind: called only once, when the directive is unbound from the element.
</p>

<p>
Shorthand for same behavior on bind and update
</p>
<pre class="example">
Vue.directive('color-swatch', function (el, binding) {
  el.style.backgroundColor = binding.value
})
</pre>
</div>

<div id="outline-container-orgf6224e6" class="outline-5">
<h5 id="orgf6224e6"><span class="section-number-5">14.11.2.1</span> Hooks are passed these arguments</h5>
<div class="outline-text-5" id="text-14-11-2-1">
<p>
Apart from el, you should treat these arguments as read-only and never modify them. If you need to share information across hooks, it is recommended to do so through element’s dataset.
</p>

<dl class="org-dl">
<dt>el</dt><dd>The element the directive is bound to. This can be used to directly manipulate the DOM.</dd>
<dt>binding</dt><dd>An object containing the following properties.
<dl class="org-dl">
<dt>name</dt><dd>The name of the directive, without the v- prefix.</dd>
<dt>value</dt><dd>The value passed to the directive. For example in v-my-directive="1 + 1", the value would be 2.</dd>
<dt>oldValue</dt><dd>The previous value, only available in update and componentUpdated. It is available whether or not the value has changed.</dd>
<dt>expression</dt><dd>The expression of the binding as a string. For example in v-my-directive="1 + 1", the expression would be "1 + 1".</dd>
<dt>arg</dt><dd>The argument passed to the directive, if any. For example in v-my-directive:foo, the arg would be "foo".</dd>
<dt>modifiers</dt><dd>An object containing modifiers, if any. For example in v-my-directive.foo.bar, the modifiers object would be { foo: true, bar: true }.</dd>
</dl></dd>
<dt>vnode</dt><dd>The virtual node produced by Vue’s compiler. See the VNode API for full details.</dd>
<dt>oldVnode</dt><dd>The previous virtual node, only available in the update and componentUpdated hooks.</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org519f47b" class="outline-4">
<h4 id="org519f47b"><span class="section-number-4">14.11.3</span> Example</h4>
<div class="outline-text-4" id="text-14-11-3">
<pre class="example">
&lt;div id="hook-arguments-example" v-demo:foo.a.b="message"&gt;&lt;/div&gt;

Vue.directive('demo', {
  bind: function (el, binding, vnode) {
    var s = JSON.stringify
    el.innerHTML =
      'name: '       + s(binding.name) + '&lt;br&gt;' +
      'value: '      + s(binding.value) + '&lt;br&gt;' +
      'expression: ' + s(binding.expression) + '&lt;br&gt;' +
      'argument: '   + s(binding.arg) + '&lt;br&gt;' +
      'modifiers: '  + s(binding.modifiers) + '&lt;br&gt;' +
      'vnode keys: ' + Object.keys(vnode).join(', ')
  }
})
new Vue({
  el: '#hook-arguments-example',
  data: {
    message: 'hello!'
  }
})

// result
name: "demo"
value: "hello!"
expression: "message"
argument: "foo"
modifiers: {"a":true,"b":true}
vnode keys: tag, data, children, text, elm, ns, context, functionalContext, functionalOptions, functionalScopeId, key, componentOptions, componentInstance, parent, raw, isStatic, isRootInsert, isComment, isCloned, isOnce, asyncFactory, asyncMeta, isAsyncPlaceholder
</pre>

<p>
Pass multiple values to directive
</p>
<pre class="example">
&lt;div v-demo="{ color: 'white', text: 'hello!' }"&gt;&lt;/div&gt;

Vue.directive('demo', function (el, binding) {
  console.log(binding.value.color) // =&gt; "white"
  console.log(binding.value.text)  // =&gt; "hello!"
})
</pre>
</div>
</div>
</div>

<div id="outline-container-org9fbae59" class="outline-3">
<h3 id="org9fbae59"><span class="section-number-3">14.12</span> Render Functions &amp; JSX</h3>
<div class="outline-text-3" id="text-14-12">
</div>
<div id="outline-container-orgf2bdd70" class="outline-4">
<h4 id="orgf2bdd70"><span class="section-number-4">14.12.1</span> Render function</h4>
<div class="outline-text-4" id="text-14-12-1">
<p>
To avoid duplicating &lt;slot&gt; in string template
</p>
<pre class="example">
&lt;anchored-heading :level="1"&gt;Hello world!&lt;/anchored-heading&gt;

&lt;script type="text/x-template" id="anchored-heading-template"&gt;
  &lt;h1 v-if="level === 1"&gt;
    &lt;slot&gt;&lt;/slot&gt;
  &lt;/h1&gt;
  &lt;h2 v-else-if="level === 2"&gt;
    &lt;slot&gt;&lt;/slot&gt;
  &lt;/h2&gt;
  &lt;h3 v-else-if="level === 3"&gt;
    &lt;slot&gt;&lt;/slot&gt;
  &lt;/h3&gt;
  &lt;h4 v-else-if="level === 4"&gt;
    &lt;slot&gt;&lt;/slot&gt;
  &lt;/h4&gt;
  &lt;h5 v-else-if="level === 5"&gt;
    &lt;slot&gt;&lt;/slot&gt;
  &lt;/h5&gt;
  &lt;h6 v-else-if="level === 6"&gt;
    &lt;slot&gt;&lt;/slot&gt;
  &lt;/h6&gt;
&lt;/script&gt;

Vue.component('anchored-heading', {
  template: '#anchored-heading-template',
  props: {
    level: {
      type: Number,
      required: true
    }
  }
})
</pre>

<p>
Use render function (reactive)
</p>
<pre class="example">
Vue.component('anchored-heading', {
  render: function (createElement) {
    return createElement(
      'h' + this.level,   // tag name
      this.$slots.default // array of children
    )
  },
  props: {
    level: {
      type: Number,
      required: true
    }
  }
})
</pre>
</div>

<div id="outline-container-org55e9edc" class="outline-5">
<h5 id="org55e9edc"><span class="section-number-5">14.12.1.1</span> createElement Arguments</h5>
<div class="outline-text-5" id="text-14-12-1-1">
<pre class="example">
// @returns {VNode}
createElement(
  // {String | Object | Function}
  // An HTML tag name, component options, or function
  // returning one of these. Required.
  'div',

  // {Object}
  // A data object corresponding to the attributes
  // you would use in a template. Optional.
  {
    // (see details in the next section below)
  },

  // {String | Array}
  // Children VNodes, built using `createElement()`,
  // or using strings to get 'text VNodes'. Optional.
  [
    'Some text comes first.',
    createElement('h1', 'A headline'),
    createElement(MyComponent, {
      props: {
        someProp: 'foobar'
      }
    })
  ]
)
</pre>

<pre class="example">
{
  // Same API as `v-bind:class`
  'class': {
    foo: true,
    bar: false
  },
  // Same API as `v-bind:style`
  style: {
    color: 'red',
    fontSize: '14px'
  },
  // Normal HTML attributes
  attrs: {
    id: 'foo'
  },
  // Component props
  props: {
    myProp: 'bar'
  },
  // DOM properties
  domProps: {
    innerHTML: 'baz'
  },
  // Event handlers are nested under `on`, though
  // modifiers such as in `v-on:keyup.enter` are not
  // supported. You'll have to manually check the
  // keyCode in the handler instead.
  on: {
    click: this.clickHandler
  },
  // For components only. Allows you to listen to
  // native events, rather than events emitted from
  // the component using `vm.$emit`.
  nativeOn: {
    click: this.nativeClickHandler
  },
  // Custom directives. Note that the binding's
  // oldValue cannot be set, as Vue keeps track
  // of it for you.
  directives: [
    {
      name: 'my-custom-directive',
      value: '2',
      expression: '1 + 1',
      arg: 'foo',
      modifiers: {
        bar: true
      }
    }
  ],
  // Scoped slots in the form of
  // { name: props =&gt; VNode | Array&lt;VNode&gt; }
  scopedSlots: {
    default: props =&gt; createElement('span', props.text)
  },
  // The name of the slot, if this component is the
  // child of another component
  slot: 'name-of-slot',
  // Other special top-level properties
  key: 'myKey',
  ref: 'myRef'
}
</pre>
</div>
</div>

<div id="outline-container-orga183a4c" class="outline-5">
<h5 id="orga183a4c"><span class="section-number-5">14.12.1.2</span> createElement Constraints</h5>
<div class="outline-text-5" id="text-14-12-1-2">
<p>
All VNodes in the component tree must be unique. This is invalid
</p>
<pre class="example">
render: function (createElement) {
  var myParagraphVNode = createElement('p', 'hi')
  return createElement('div', [
    // Yikes - duplicate VNodes!
    myParagraphVNode, myParagraphVNode
  ])
}
</pre>

<p>
Use factory function
</p>
<pre class="example">
render: function (createElement) {
  return createElement('div',
    Array.apply(null, { length: 20 }).map(function () {
      return createElement('p', 'hi')
    })
  )
}
</pre>
</div>
</div>

<div id="outline-container-orgbbd94ee" class="outline-5">
<h5 id="orgbbd94ee"><span class="section-number-5">14.12.1.3</span> render for v-if and v-for</h5>
</div>
<div id="outline-container-org5096551" class="outline-5">
<h5 id="org5096551"><span class="section-number-5">14.12.1.4</span> render for v-model</h5>
</div>
<div id="outline-container-org565795a" class="outline-5">
<h5 id="org565795a"><span class="section-number-5">14.12.1.5</span> redner for event &amp; key modifiers</h5>
</div>
<div id="outline-container-org481d1c3" class="outline-5">
<h5 id="org481d1c3"><span class="section-number-5">14.12.1.6</span> render for &lt;slot&gt;</h5>
<div class="outline-text-5" id="text-14-12-1-6">
<p>
Static slot contents as Arrays of VNodes from this.$slots
</p>
<pre class="example">
render: function (createElement) {
  // `&lt;div&gt;&lt;slot&gt;&lt;/slot&gt;&lt;/div&gt;`
  return createElement('div', this.$slots.default)
}
</pre>

<p>
Scoped slot
</p>
<pre class="example">
render: function (createElement) {
  // `&lt;div&gt;&lt;slot :text="msg"&gt;&lt;/slot&gt;&lt;/div&gt;`
  return createElement('div', [
    this.$scopedSlots.default({
      text: this.msg
    })
  ])
}

// pass scoped slots to a child component
render (createElement) {
  return createElement('div', [
    createElement('child', {
      // pass `scopedSlots` in the data object
      // in the form of { name: props =&gt; VNode | Array&lt;VNode&gt; }
      scopedSlots: {
        default: function (props) {
          return createElement('span', props.text)
        }
      }
    })
  ])
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd34a8ba" class="outline-4">
<h4 id="orgd34a8ba"><span class="section-number-4">14.12.2</span> JSX</h4>
</div>
</div>

<div id="outline-container-orgfd8e17f" class="outline-3">
<h3 id="orgfd8e17f"><span class="section-number-3">14.13</span> Plugin</h3>
<div class="outline-text-3" id="text-14-13">
<p>
<a id="org389e69a">vue:plugin</a>
Third party plugins and libraries
<a href="https://github.com/vuejs/awesome-vue#components--libraries">https://github.com/vuejs/awesome-vue#components--libraries</a>
</p>
</div>
<div id="outline-container-org2a0fffc" class="outline-4">
<h4 id="org2a0fffc"><span class="section-number-4">14.13.1</span> Basics</h4>
<div class="outline-text-4" id="text-14-13-1">
<p>
Plugins usually add global-level functionality to Vue. There is no strictly defined scope for a plugin - there are typically several types of plugins you can write:
</p>
<ul class="org-ul">
<li>Add some global methods or properties. e.g. vue-custom-element</li>
<li>Add one or more global assets: directives/filters/transitions etc. e.g. vue-touch</li>
<li>Add some component options by global mixin. e.g. vue-router</li>
<li>Add some Vue instance methods by attaching them to Vue.prototype.</li>
<li>A library that provides an API of its own, while at the same time injecting some combination of the above. e.g. vue-router</li>
</ul>

<p>
Official Vue.js plugins such as vue-router automatically calls Vue.use() if vue is available as a global variable.
</p>

<pre class="example">
MyPlugin.install = function (Vue, options) {
  // 1. add global method or property
  Vue.myGlobalMethod = function () {
    // something logic ...
  }
  // 2. add a global asset
  Vue.directive('my-directive', {
    bind (el, binding, vnode, oldVnode) {
      // something logic ...
    }
    ...
  })
  // 3. inject some component options
  Vue.mixin({
    created: function () {
      // something logic ...
    }
    ...
  })
  // 4. add an instance method
  Vue.prototype.$myMethod = function (methodOptions) {
    // something logic ...
  }
}
</pre>

<p>
Use a Plugin
</p>
<pre class="example">
// calls `MyPlugin.install(Vue)`
Vue.use(MyPlugin)

Vue.use(MyPlugin, { someOption: true })
</pre>

<pre class="example">
// When using CommonJS via Browserify or Webpack
var Vue = require('vue')

var VueRouter = require('vue-router')
// Don't forget to call this
Vue.use(VueRouter)
</pre>
</div>
</div>

<div id="outline-container-orgf0573c8" class="outline-4">
<h4 id="orgf0573c8"><span class="section-number-4">14.13.2</span> vuex Namespace in Plugin</h4>
<div class="outline-text-4" id="text-14-13-2">
<p>
<a href="#org2603bc9">vue:plugin:vuex:namespace in plugin</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org53efd35" class="outline-3">
<h3 id="org53efd35"><span class="section-number-3">14.14</span> Production Development</h3>
<div class="outline-text-3" id="text-14-14">
<p>
Without build tools, directly inject javascript
Prod :: <a href="https://cdn.jsdelivr.net/npm/vue">https://cdn.jsdelivr.net/npm/vue</a>
Dev :: <a href="https://unpkg.com/vue">https://unpkg.com/vue</a>
</p>
</div>
</div>

<div id="outline-container-orgab0dbe5" class="outline-3">
<h3 id="orgab0dbe5"><span class="section-number-3">14.15</span> vue-router</h3>
<div class="outline-text-3" id="text-14-15">
<p>
<a id="orgb71a4e7">vue:plugin:router</a> <a id="org601444e">vue:router</a>
VueRouter:option:x =&gt; option:x
</p>
</div>
<div id="outline-container-orge69e039" class="outline-4">
<h4 id="orge69e039"><span class="section-number-4">14.15.1</span> &lt;router-view&gt;, &lt;router-link&gt;, option:routes, this.$router, this.$route</h4>
<div class="outline-text-4" id="text-14-15-1">
<pre class="example">
&lt;script src="https://unpkg.com/vue/dist/vue.js"&gt;&lt;/script&gt;
&lt;script src="https://unpkg.com/vue-router/dist/vue-router.js"&gt;&lt;/script&gt;

&lt;div id="app"&gt;
  &lt;h1&gt;Hello App!&lt;/h1&gt;
  &lt;p&gt;
    &lt;!-- use router-link component for navigation. --&gt;
    &lt;!-- specify the link by passing the `to` prop. --&gt;
    &lt;!-- `&lt;router-link&gt;` will be rendered as an `&lt;a&gt;` tag by default --&gt;
    &lt;!-- it gets .router-link-active class when the route is matched --&gt;
    &lt;router-link to="/foo"&gt;Go to Foo&lt;/router-link&gt;
    &lt;router-link to="/bar"&gt;Go to Bar&lt;/router-link&gt;
  &lt;/p&gt;
  &lt;!-- route outlet --&gt;
  &lt;!-- component matched by the route will render here --&gt;
  &lt;router-view&gt;&lt;/router-view&gt;
&lt;/div&gt;
</pre>

<pre class="example">
// 0. If using a module system (e.g. via vue-cli), import Vue and VueRouter
// and then call `Vue.use(VueRouter)`.

// 1. Define route components.
// These can be imported from other files
const Foo = { template: '&lt;div&gt;foo&lt;/div&gt;' }
const Bar = { template: '&lt;div&gt;bar&lt;/div&gt;' }

// 2. Define some routes
// Each route should map to a component. The "component" can
// either be an actual component constructor created via
// `Vue.extend()`, or just a component options object.
// We'll talk about nested routes later.
const routes = [
  { path: '/foo', component: Foo },
  { path: '/bar', component: Bar }
]

// 3. Create the router instance and pass the `routes` option
// You can pass in additional options here, but let's
// keep it simple for now.
const router = new VueRouter({
  routes // short for `routes: routes`
})

// 4. Create and mount the root instance.
// Make sure to inject the router with the router option to make the
// whole app router-aware.
const app = new Vue({
  router
}).$mount('#app')

// Now the app has started!
</pre>

<p>
In any component, this.$router <a href="#orge4840d4">vue:router:router</a> and this.$route <a href="#org1761ad4">vue:router:route</a> are available
</p>
<pre class="example">
// Home.vue
export default {
  computed: {
    username () {
      // We will see what `params` is shortly
      return this.$route.params.username
    }
  },
  methods: {
    goBack () {
      window.history.length &gt; 1
        ? this.$router.go(-1)
        : this.$router.push('/')
    }
  }
}
</pre>
</div>
</div>

<div id="outline-container-org391737c" class="outline-4">
<h4 id="org391737c"><span class="section-number-4">14.15.2</span> option:routes, $route.params, regex, option:routes[]:name, option:routes[]:component</h4>
<div class="outline-text-4" id="text-14-15-2">
<pre class="example">
const User = {
  template: '&lt;div&gt;User {{ $route.params.id }}&lt;/div&gt;'
}

const router = new VueRouter({
  routes: [
    // dynamic segments start with a colon
    { path: '/user/:id', component: User }
  ]
})
</pre>
</div>

<div id="outline-container-org46946cb" class="outline-5">
<h5 id="org46946cb"><span class="section-number-5">14.15.2.1</span> regex pattern in option:routes</h5>
<div class="outline-text-5" id="text-14-15-2-1">
<p>
vue-router uses <a href="https://github.com/pillarjs/path-to-regexp">path-to-regexp</a> whihc is used by Express as well.
The earlier a route is defined, the higher priority it gets.
</p>

<pre class="example">
import Vue from 'vue'
import VueRouter from 'vue-router'

Vue.use(VueRouter)

// The matching uses path-to-regexp, which is the matching engine used
// by express as well, so the same matching rules apply.
// For detailed rules, see https://github.com/pillarjs/path-to-regexp
const router = new VueRouter({
  mode: 'history',
  base: __dirname,
  routes: [
    { path: '/' },
    // params are denoted with a colon ":"
    { path: '/params/:foo/:bar' },
    // a param can be made optional by adding "?"
    { path: '/optional-params/:foo?' },
    // a param can be followed by a regex pattern in parens
    // this route will only be matched if :id is all numbers
    { path: '/params-with-regex/:id(\\d+)' },
    // asterisk can match anything
    { path: '/asterisk/*' },
    // make part of the path optional by wrapping with parens and add "?"
    { path: '/optional-group/(foo/)?bar' }
  ]
})

new Vue({
  router,
  template: `
    &lt;div id="app"&gt;
      &lt;h1&gt;Route Matching&lt;/h1&gt;
      &lt;ul&gt;
        &lt;li&gt;&lt;router-link to="/"&gt;/&lt;/router-link&gt;&lt;/li&gt;
        &lt;li&gt;&lt;router-link to="/params/foo/bar"&gt;/params/foo/bar&lt;/router-link&gt;&lt;/li&gt;
        &lt;li&gt;&lt;router-link to="/optional-params"&gt;/optional-params&lt;/router-link&gt;&lt;/li&gt;
        &lt;li&gt;&lt;router-link to="/optional-params/foo"&gt;/optional-params/foo&lt;/router-link&gt;&lt;/li&gt;
        &lt;li&gt;&lt;router-link to="/params-with-regex/123"&gt;/params-with-regex/123&lt;/router-link&gt;&lt;/li&gt;
        &lt;li&gt;&lt;router-link to="/params-with-regex/abc"&gt;/params-with-regex/abc&lt;/router-link&gt;&lt;/li&gt;
        &lt;li&gt;&lt;router-link to="/asterisk/foo"&gt;/asterisk/foo&lt;/router-link&gt;&lt;/li&gt;
        &lt;li&gt;&lt;router-link to="/asterisk/foo/bar"&gt;/asterisk/foo/bar&lt;/router-link&gt;&lt;/li&gt;
        &lt;li&gt;&lt;router-link to="/optional-group/bar"&gt;/optional-group/bar&lt;/router-link&gt;&lt;/li&gt;
        &lt;li&gt;&lt;router-link to="/optional-group/foo/bar"&gt;/optional-group/foo/bar&lt;/router-link&gt;&lt;/li&gt;
      &lt;/ul&gt;
      &lt;p&gt;Route context&lt;/p&gt;
      &lt;pre&gt;{{ JSON.stringify($route, null, 2) }}&lt;/pre&gt;
    &lt;/div&gt;
  `
}).$mount('#app')
</pre>
</div>
</div>

<div id="outline-container-orgf5996ec" class="outline-5">
<h5 id="orgf5996ec"><span class="section-number-5">14.15.2.2</span> Named routes, option:routes[]:name</h5>
<div class="outline-text-5" id="text-14-15-2-2">
<pre class="example">
const router = new VueRouter({
  routes: [
    {
      path: '/user/:userId',
      name: 'user',
      component: User
    }
  ]
})

&lt;router-link :to="{ name: 'user', params: { userId: 123 }}"&gt;User&lt;/router-link&gt;
router.push({ name: 'user', params: { userId: 123 }})
</pre>
</div>
</div>
</div>

<div id="outline-container-org8218f98" class="outline-4">
<h4 id="org8218f98"><span class="section-number-4">14.15.3</span> option:routes[]:components, multiple &lt;router-view&gt;'s</h4>
<div class="outline-text-4" id="text-14-15-3">
<pre class="example">
&lt;router-view class="view one"&gt;&lt;/router-view&gt;
&lt;router-view class="view two" name="a"&gt;&lt;/router-view&gt;
&lt;router-view class="view three" name="b"&gt;&lt;/router-view&gt;

const router = new VueRouter({
  routes: [
    {
      path: '/',
      components: {
        default: Foo,
        a: Bar,
        b: Baz
      }
    }
  ]
})
</pre>
</div>
</div>

<div id="outline-container-orgbe455d2" class="outline-4">
<h4 id="orgbe455d2"><span class="section-number-4">14.15.4</span> option:routes[]:redirect, option:routes[]:alias</h4>
<div class="outline-text-4" id="text-14-15-4">
<p>
A redirect means when the user visits /a, and URL will be replaced by /b, and then matched as /b. 
</p>

<pre class="example">
const router = new VueRouter({
  routes: [
    { path: '/a', redirect: '/b' }
  ]
})

const router = new VueRouter({
  routes: [
    { path: '/a', redirect: { name: 'foo' }}
  ]
})

const router = new VueRouter({
  routes: [
    { path: '/a', redirect: to =&gt; {
      // the function receives the target route as the argument
      // return redirect path/location here.
    }}
  ]
})
</pre>

<p>
An alias of /a as /b means when the user visits /b, the URL remains /b, but it will be matched as if the user is visiting /a.
</p>

<pre class="example">
const router = new VueRouter({
  routes: [
    { path: '/a', component: A, alias: '/b' }
  ]
})
</pre>
</div>
</div>

<div id="outline-container-org7bacd1d" class="outline-4">
<h4 id="org7bacd1d"><span class="section-number-4">14.15.5</span> Route object, $route, this.$route, option:scrollBehavior <a id="org1761ad4">vue:router:route</a></h4>
<div class="outline-text-4" id="text-14-15-5">
<p>
<a href="https://router.vuejs.org/en/api/route-object.html">https://router.vuejs.org/en/api/route-object.html</a>
$route =&gt; this.$route, router.match(location)
</p>
<pre class="example">
router.beforeEach((to, from, next) =&gt; {
  // `to` and `from` are both route objects
})

const router = new VueRouter({
  scrollBehavior (to, from, savedPosition) {
    // `to` and `from` are both route objects
  }
})
</pre>

<p>
$route.path :: absolute path e.g. /foo/bar
$route.params :: {} or key/value pairs of dynamic segments and star segments
$route.query :: {} or key/vale pairs of the query string /foo?user=1 $route.query.user == 1
$route.hash :: empty string or anything with #.
$route.fullPath :: string query and hash
$route.matched :: e.g. /foo/bar, then .matched is an array of objects in parent to child order.
</p>
</div>
</div>

<div id="outline-container-org674b5f4" class="outline-4">
<h4 id="org674b5f4"><span class="section-number-4">14.15.6</span> option:scrollBehavior</h4>
<div class="outline-text-4" id="text-14-15-6">
<pre class="example">
const router = new VueRouter({
  routes: [...],
  scrollBehavior (to, from, savedPosition) {
    // return desired position
  }
})
</pre>

<p>
savedPosition, is only available if this is a popstate navigation (triggered by the browser's back/forward buttons).
</p>

<p>
Should return either one of these
</p>
<ul class="org-ul">
<li>{ x: number, y: number }</li>
<li>{ selector: string, offset? : { x: number, y: number }}</li>
</ul>

<p>
Scroll to top for all route navigations
</p>
<pre class="example">
scrollBehavior (to, from, savedPosition) {
  return { x: 0, y: 0 }
}
</pre>

<pre class="example">
scrollBehavior (to, from, savedPosition) {
  if (savedPosition) {
    return savedPosition
  } else {
    return { x: 0, y: 0 }
  }
}

// scroll to anchor
scrollBehavior (to, from, savedPosition) {
  if (to.hash) {
    return {
      selector: to.hash
      // , offset: { x: 0, y: 10 }
    }
  }
}
</pre>
</div>
</div>

<div id="outline-container-org2997650" class="outline-4">
<h4 id="org2997650"><span class="section-number-4">14.15.7</span> option:routes[]:props, component:props</h4>
<div class="outline-text-4" id="text-14-15-7">
<p>
Decouple $route in component. Before
</p>
<pre class="example">
const User = {
  template: '&lt;div&gt;User {{ $route.params.id }}&lt;/div&gt;'
}
const router = new VueRouter({
  routes: [
    { path: '/user/:id', component: User }
  ]
})
</pre>

<p>
Now
</p>
<pre class="example">
const User = {
  props: ['id'],
  template: '&lt;div&gt;User {{ id }}&lt;/div&gt;'
}
const router = new VueRouter({
  routes: [
    { path: '/user/:id', component: User, props: true }

    // for routes with named views, you have to define the `props` option for each named view:
    {
      path: '/user/:id',
      components: { default: User, sidebar: Sidebar },
      props: { default: true, sidebar: false }
    }
  ]
})
</pre>

<p>
option:routes[]:props is set to true, the route.params will be set as the component props.
</p>

<p>
props is an object
</p>
<pre class="example">
const router = new VueRouter({
  routes: [
    { path: '/hello/:name', component: Hello, props: true }, // Pass route.params to props
    { path: '/promotion/from-newsletter', component: Promotion, props: { newsletterPopup: false } },
    { path: '/static', component: Hello, props: { name: 'world' }}, // static values
  ]
})
</pre>

<p>
props is a function
The URL /search?q=vue would pass {query: 'vue'} as props to the SearchUser component.
</p>
<pre class="example">
function dynamicPropsFn (route) {
  const now = new Date()
  return {
    name: (now.getFullYear() + parseInt(route.params.years)) + '!'
  }
}

const router = new VueRouter({
  routes: [
    { path: '/search', component: SearchUser, props: (route) =&gt; ({ query: route.query.q }) }
    { path: '/dynamic/:years', component: Hello, props: dynamicPropsFn }, // custom logic for mapping between route and props
  ]
})
</pre>
</div>
</div>

<div id="outline-container-orga4f01b1" class="outline-4">
<h4 id="orga4f01b1"><span class="section-number-4">14.15.8</span> React to params changes, component:watch, component:beforeRouteUpdate</h4>
<div class="outline-text-4" id="text-14-15-8">
<p>
<a id="org98e4cba">vue:router:react</a>
<a id="orgda1af86">vue:router:component:beforeRouteUpdate</a> <a id="org18c952d">vue:router:component:watch</a>
params or query chnages won't trigger enter/leave navigation guards and hence this is needed to react to changes.
</p>
<pre class="example">
const User = {
  template: '...',
  watch: {
    '$route' (to, from) {
      // react to route changes...
    }
  }
}
</pre>

<pre class="example">
const User = {
  template: '...',
  beforeRouteUpdate (to, from, next) {
    // react to route changes...
    // don't forget to call next()
  }
}
</pre>
</div>
</div>

<div id="outline-container-orgfa40c99" class="outline-4">
<h4 id="orgfa40c99"><span class="section-number-4">14.15.9</span> Nested routes, &lt;router-view&gt;, option:routes:children</h4>
<div class="outline-text-4" id="text-14-15-9">
<p>
/user/foo/profile (component:user and component:profile) and /user/foo/posts (component:user and component:posts)
</p>

<pre class="example">
&lt;div id="app"&gt;
  &lt;router-view&gt;&lt;/router-view&gt;
&lt;/div&gt;

const User = {
  template: `
    &lt;div&gt;User {{ $route.params.id }}&lt;/div&gt;
    &lt;router-view&gt;&lt;/router-view&gt;
  `
}

const router = new VueRouter({
  routes: [
    { path: '/user/:id', component: User,
      children: [
        // UserHome will be rendered inside User's &lt;router-view&gt;
        // when /user/:id is matched
        { path: '', component: UserHome },

        {
          // UserProfile will be rendered inside User's &lt;router-view&gt;
          // when /user/:id/profile is matched
          path: 'profile',
          component: UserProfile
        },

        {
          // UserPosts will be rendered inside User's &lt;router-view&gt;
          // when /user/:id/posts is matched
          path: 'posts',
          component: UserPosts
        }
      ]
    }
  ]
})
</pre>
</div>

<div id="outline-container-org80a64c6" class="outline-5">
<h5 id="org80a64c6"><span class="section-number-5">14.15.9.1</span> option:routes:children[]:meta</h5>
<div class="outline-text-5" id="text-14-15-9-1">
<pre class="example">
const router = new VueRouter({
  routes: [
    {
      path: '/foo',
      component: Foo,
      children: [
        {
          path: 'bar',
          component: Bar,
          // a meta field
          meta: { requiresAuth: true }
        }
      ]
    }
  ]
})
</pre>

<pre class="example">
router.beforeEach((to, from, next) =&gt; {
  if (to.matched.some(record =&gt; record.meta.requiresAuth)) {
    // this route requires auth, check if logged in
    // if not, redirect to login page.
    if (!auth.loggedIn()) {
      next({
        path: '/login',
        query: { redirect: to.fullPath }
      })
    } else {
      next()
    }
  } else {
    next() // make sure to always call next()!
  }
})
</pre>
</div>
</div>
</div>

<div id="outline-container-org7506382" class="outline-4">
<h4 id="org7506382"><span class="section-number-4">14.15.10</span> Programmatic Navigation, this.$router, router.*</h4>
<div class="outline-text-4" id="text-14-15-10">
<p>
<a id="orge4840d4">vue:router:router</a> <a id="orgb864fa9">vue:router:router.push</a>
Both router and this.$router can be used in component. this.$router means vue-router is imported in every component.
<code>&lt;router-link :to="..."&gt;</code> is equivalent to <code>router.push(...)</code>
</p>

<p>
params are ignored if a path is provided.
</p>

<pre class="example">
// literal string path
router.push('home')

// object
router.push({ path: 'home' })

// named route
router.push({ name: 'user', params: { userId: 123 }})

// with query, resulting in /register?plan=private
router.push({ path: 'register', query: { plan: 'private' }})
</pre>

<pre class="example">
const userId = 123
router.push({ name: 'user', params: { userId }}) // -&gt; /user/123
router.push({ path: `/user/${userId}` }) // -&gt; /user/123
// This will NOT work
router.push({ path: '/user', params: { userId }}) // -&gt; /user
</pre>
</div>

<div id="outline-container-org31364e1" class="outline-5">
<h5 id="org31364e1"><span class="section-number-5">14.15.10.1</span> router.push, router.replace, router.push.onComplete, router.push.onAbort</h5>
<div class="outline-text-5" id="text-14-15-10-1">
<p>
Callbacks as the 2nd and 3rd arguments.
onComplete :: after all async hooks are resolved
onAbort :: navigated to the same route, or to a different route before current navigation has finished.
</p>

<p>
If destination is the same as the current route and only params are changing (/users/1 -&gt; /users/2), use beforeRouteUpdate to react.
<a href="#org98e4cba">vue:router:react</a>
</p>

<p>
router.push(location, onComplete?, onAbort?)
router.replace(location, onComplete?, onAbort?) :: without pushing a new history entry
</p>
</div>
</div>

<div id="outline-container-org665dcc3" class="outline-5">
<h5 id="org665dcc3"><span class="section-number-5">14.15.10.2</span> router.go(n)</h5>
<div class="outline-text-5" id="text-14-15-10-2">
<p>
Similar to window.history.go(n)
</p>

<pre class="example">
// go forward by one record, the same as history.forward()
router.go(1)

// go back by one record, the same as history.back()
router.go(-1)

// go forward by 3 records
router.go(3)

// fails silently if there aren't that many records.
router.go(-100)
router.go(100)
</pre>
</div>
</div>
</div>

<div id="outline-container-org4534500" class="outline-4">
<h4 id="org4534500"><span class="section-number-4">14.15.11</span> option:mode</h4>
<div class="outline-text-4" id="text-14-15-11">
<p>
Default is hash mode, change to history mode to change URL without a page reload.
</p>

<pre class="example">
const router = new VueRouter({
  mode: 'history',
  routes: [
    // some path
    // catch 404
    { path: '*', component: NotFoundComponent }
  ]
})
</pre>

<p>
Apache
</p>
<pre class="example">
&lt;IfModule mod_rewrite.c&gt;
  RewriteEngine On
  RewriteBase /
  RewriteRule ^index\.html$ - [L]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . /index.html [L]
&lt;/IfModule&gt;
</pre>

<p>
nginx
</p>
<pre class="example">
location / {
  try_files $uri $uri/ /index.html;
}
</pre>
</div>
</div>

<div id="outline-container-org0a7156b" class="outline-4">
<h4 id="org0a7156b"><span class="section-number-4">14.15.12</span> Guards</h4>
<div class="outline-text-4" id="text-14-15-12">
<ul class="org-ul">
<li>Navigation triggered.</li>
<li>Call leave guards in deactivated components.</li>
<li>Call global beforeEach guards.</li>
<li>Call beforeRouteUpdate guards in reused components (2.2+).</li>
<li>Call beforeEnter in route configs.</li>
<li>Resolve async route components.</li>
<li>Call beforeRouteEnter in activated components.</li>
<li>Call global beforeResolve guards (2.5+).</li>
<li>Navigation confirmed.</li>
<li>Call global afterEach hooks.</li>
<li>DOM updates triggered.</li>
<li>Call callbacks passed to next in beforeRouteEnter guards with instantiated instances.</li>
</ul>
</div>

<div id="outline-container-org5a798d6" class="outline-5">
<h5 id="org5a798d6"><span class="section-number-5">14.15.12.1</span> global, router.beforeEach, router.beforeResolve, router.afterEach</h5>
<div class="outline-text-5" id="text-14-15-12-1">
<p>
Guards/hooks may be resolved asynchronously, the navigation is considered pending before all hooks have been resolved (confirmed).
<a id="orgda6c37c">vue:router:router.beforeEach</a>
</p>

<pre class="example">
const router = new VueRouter({ ... })

router.beforeEach((to, from, next) =&gt; {
  // ...
})
</pre>

<p>
Always call next function to resolve.
</p>

<p>
next() :: move on to the next hook in the pipeline.
next(false) :: abort the current navigation. If the URL was changed (either manually by the user or via back button), it will be reset to that of the from route.
next('<i>') or next({ path: '</i>' }) :: redirect to a different location. The current navigation will be aborted and a new one will be started. A location object can be passed. Refer to <a href="#orgb864fa9">vue:router:router.push</a>
next(error) :: navigation will be aborted and the error will be passed to callbacks registered via router.onError().
</p>

<p>
router.beforeResolve is similar to router.beforeEach with the difference that resolve guards will be called right before the navigation is confirmed, after all in-component guards and async route components are resolved.
</p>

<p>
router.afterEach do not get a next function and cannot affect the navigation
</p>

<pre class="example">
router.afterEach((to, from) =&gt; {
  // ...
})
</pre>
</div>
</div>

<div id="outline-container-orgbc92327" class="outline-5">
<h5 id="orgbc92327"><span class="section-number-5">14.15.12.2</span> per-route, option:routes[]:beforeEnter</h5>
<div class="outline-text-5" id="text-14-15-12-2">
<p>
Same as <a href="#orgda6c37c">vue:router:router.beforeEach</a>
</p>
<pre class="example">
const router = new VueRouter({
  routes: [
    {
      path: '/foo',
      component: Foo,
      beforeEnter: (to, from, next) =&gt; {
        // ...
      }
    }
  ]
})
</pre>
</div>
</div>

<div id="outline-container-org7d5a398" class="outline-5">
<h5 id="org7d5a398"><span class="section-number-5">14.15.12.3</span> in-component, component:beforeRouteEnter, component:beforeRouteUpdate, component:beforeRouteLeave</h5>
<div class="outline-text-5" id="text-14-15-12-3">
<pre class="example">
const Foo = {
  template: `...`,
  beforeRouteEnter (to, from, next) {
    // called before the route that renders this component is confirmed.
    // does NOT have access to `this` component instance,
    // because it has not been created yet when this guard is called!

    // you can access to component instance via `vm`

    next(vm =&gt; {
      // it will be called when the navigation is confirmed
      // access to component instance via `vm`
    })
  },
  beforeRouteUpdate (to, from, next) {
    // called when the route that renders this component has changed,
    // but this component is reused in the new route.
    // For example, for a route with dynamic params `/foo/:id`, when we
    // navigate between `/foo/1` and `/foo/2`, the same `Foo` component instance
    // will be reused, and this hook will be called when that happens.
    // has access to `this` component instance.
  },
  beforeRouteLeave (to, from, next) {
    // called when the route that renders this component is about to
    // be navigated away from.
    // has access to `this` component instance.

    const answer = window.confirm('Do you really want to leave? you have unsaved changes!')
    if (answer) {
      next()
    } else {
      next(false)
    }    
  }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org032da40" class="outline-4">
<h4 id="org032da40"><span class="section-number-4">14.15.13</span> Fetch data</h4>
<div class="outline-text-4" id="text-14-15-13">
<p>
Fetch after navigation
</p>
<pre class="example">
&lt;template&gt;
  &lt;div class="post"&gt;
    &lt;div class="loading" v-if="loading"&gt;
      Loading...
    &lt;/div&gt;

    &lt;div v-if="error" class="error"&gt;
      {{ error }}
    &lt;/div&gt;

    &lt;div v-if="post" class="content"&gt;
      &lt;h2&gt;{{ post.title }}&lt;/h2&gt;
      &lt;p&gt;{{ post.body }}&lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
export default {
  data () {
    return {
      loading: false,
      post: null,
      error: null
    }
  },
  created () {
    // fetch the data when the view is created and the data is
    // already being observed
    this.fetchData()
  },
  watch: {
    // call again the method if the route changes
    '$route': 'fetchData'
  },
  methods: {
    fetchData () {
      this.error = this.post = null
      this.loading = true
      // replace `getPost` with your data fetching util / API wrapper
      getPost(this.$route.params.id, (err, post) =&gt; {
        this.loading = false
        if (err) {
          this.error = err.toString()
        } else {
          this.post = post
        }
      })
    }
  }
}
</pre>

<p>
Fetch before navigation
</p>
<pre class="example">
export default {
  data () {
    return {
      post: null,
      error: null
    }
  },
  beforeRouteEnter (to, from, next) {
    getPost(to.params.id, (err, post) =&gt; {
      next(vm =&gt; vm.setData(err, post))
    })
  },
  // when route changes and this component is already rendered,
  // the logic will be slightly different.
  beforeRouteUpdate (to, from, next) {
    this.post = null
    getPost(to.params.id, (err, post) =&gt; {
      this.setData(err, post)
      next()
    })
  },
  methods: {
    setData (err, post) {
      if (err) {
        this.error = err.toString()
      } else {
        this.post = post
      }
    }
  }
}
</pre>
</div>
</div>

<div id="outline-container-orgc9aef6b" class="outline-4">
<h4 id="orgc9aef6b"><span class="section-number-4">14.15.14</span> Lazy loading</h4>
<div class="outline-text-4" id="text-14-15-14">
<p>
Only load components when they are triggered by navigation
</p>
<pre class="example">
const Foo = () =&gt; Promise.resolve({ /* component definition */ })
import('./Foo.vue') // returns a Promise
</pre>

<p>
Webpack
</p>
<pre class="example">
const Foo = () =&gt; import('./Foo.vue')

// everything is the same in router config
const router = new VueRouter({
  routes: [
    { path: '/foo', component: Foo }
  ]
})
</pre>

<p>
Group multiple components and lazy load them
</p>

<pre class="example">
const Foo = () =&gt; import(/* webpackChunkName: "group-foo" */ './Foo.vue')
const Bar = () =&gt; import(/* webpackChunkName: "group-foo" */ './Bar.vue')
const Baz = () =&gt; import(/* webpackChunkName: "group-foo" */ './Baz.vue')
</pre>
</div>
</div>
</div>

<div id="outline-container-org413a440" class="outline-3">
<h3 id="org413a440"><span class="section-number-3">14.16</span> State Management, Vuex</h3>
<div class="outline-text-3" id="text-14-16">
<p>
<a id="org1be60e5">vue:state management</a> <a id="org59a9684">vue:plugin:vuex</a>
</p>
</div>
<div id="outline-container-orga261e61" class="outline-4">
<h4 id="orga261e61"><span class="section-number-4">14.16.1</span> Basics, option:state</h4>
<div class="outline-text-4" id="text-14-16-1">
<p>
vuex is a <a href="#org389e69a">vue:plugin</a>
</p>

<p>
<a href="https://vuex.vuejs.org/en/">Vuex Doc</a>
</p>

<p>
npm install vuex &#x2013;save
</p>

<p>
./src/store/store.js (or index.js)
</p>
<pre class="example">
import Vue from 'vue'
import Vuex from 'vuex'

Vue.use(Vuex)

export default new Vuex.Store({
  state: {
    count: 0
  },
  mutations: {
    increment: state =&gt; state.count++, // shorthand for
    // increment (state) { state.count++ } 
    decrement: state =&gt; state.count--
  },
  actions: {
    // actions can be defined directly here to so that
    // they can interact with other actions/modules
  }
})
</pre>

<p>
./src/main.js
</p>
<pre class="example">
import Vue from 'vue'
import App from './App'
import router from './router'
import store from './store/store' // new, if store/index.js is used, use ./store

Vue.config.productionTip = false

/* eslint-disable no-new */
new Vue({
  el: '#app',
  router,
  store, // new
  template: '&lt;App/&gt;',
  components: { App }

})
</pre>

<p>
App.vue
</p>
<pre class="example">
&lt;template&gt;
  &lt;div id="app"&gt;
    &lt;img src="./assets/logo.png"&gt;
    &lt;router-view/&gt;
    &lt;p&gt;{{ count }}&lt;/p&gt;
    &lt;p&gt;
      &lt;button @click="increment"&gt;+&lt;/button&gt;
      &lt;button @click="decrement"&gt;-&lt;/button&gt;
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;

export default {
  name: 'app',
  computed: {
    count () {
      return this.$store.state.count
    }
  },
  methods: {
    increment () {
      this.$store.commit('increment')
    },
    decrement () {
      this.$store.commit('decrement')
    }
  }
}
&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-org4aa669a" class="outline-4">
<h4 id="org4aa669a"><span class="section-number-4">14.16.2</span> mapState in component computed props</h4>
<div class="outline-text-4" id="text-14-16-2">
<p>
mapState is to get state as it is without calculation or maybe has to do calculations with local state.
It can save some keystrokes:
Before App.vue
</p>
<pre class="example">
&lt;script&gt;
export default {
  name: 'app',
  computed: {
    count () {
      return this.$store.state.count
    }
  },
  // some methods: {}
}
&lt;/script&gt;
</pre>

<p>
Use mapState
</p>
<pre class="example">
// in full builds helpers are exposed as Vuex.mapState
import { mapState } from 'vuex'

export default {
  // ...
  computed: mapState({
    // arrow functions can make the code very succinct!
    count: state =&gt; state.count,

    // passing the string value 'count' is same as `state =&gt; state.count`
    countAlias: 'count',

    // to access local state with `this`, a normal function must be used
    countPlusLocalState (state) {
      return state.count + this.localCount
    }
  })
}
</pre>

<p>
Use array in mapState to map this.count to store.state.count
</p>
<pre class="example">
computed: mapState([
  // map this.count to store.state.count
  'count'
])
</pre>

<p>
mapState returns an object inside the component's computed. How to combine with other computed properties?
</p>
<pre class="example">
computed: {
  localComputed () { /* ... */ },
  // mix this into the outer object with the object spread operator
  ...mapState({
    // ...
  })
}
</pre>
</div>
</div>

<div id="outline-container-org3540c9e" class="outline-4">
<h4 id="org3540c9e"><span class="section-number-4">14.16.3</span> option:getters, mapGetters in component computed props</h4>
<div class="outline-text-4" id="text-14-16-3">
<p>
getters or mapGetters are to get state and compute on it.
</p>

<p>
./src/store/store.js
</p>
<pre class="example">
const store = new Vuex.Store({
  state: {
    todos: [
      { id: 1, text: '...', done: true },
      { id: 2, text: '...', done: false }
    ]
  },
  getters: {
    doneTodos: state =&gt; {
      return state.todos.filter(todo =&gt; todo.done)
    },
    doneTodosCount: (state, getters) =&gt; {
      return getters.doneTodos.length
    },
    // pass parameter
    getTodoById: (state, getters) =&gt; (id) =&gt; {
      return state.todos.find(todo =&gt; todo.id === id)
    }
  }
})

store.getters.doneTodos // -&gt; [{ id: 1, text: '...', done: true }]
store.getters.doneTodosCount // -&gt; 1
store.getters.getTodoById(2) // -&gt; { id: 2, text: '...', done: false }
</pre>

<p>
In component
</p>
<pre class="example">
computed: {
  doneTodosCount () {
    return this.$store.getters.doneTodosCount
  }
}
</pre>

<p>
mapGetters in component computed props
</p>
<pre class="example">
import { mapGetters } from 'vuex'

export default {
  // ...
  computed: {
    // mix the getters into computed with object spread operator
    ...mapGetters([
      'doneTodosCount',
      'anotherGetter',
      // ...
    ])
  }
}
</pre>

<p>
Change name
</p>
<pre class="example">
...mapGetters({
  // map `this.doneCount` to `store.getters.doneTodosCount`
  doneCount: 'doneTodosCount'
})
</pre>
</div>
</div>

<div id="outline-container-org5ba0834" class="outline-4">
<h4 id="org5ba0834"><span class="section-number-4">14.16.4</span> option:mutations, commit/mapMutations in component, Synchronous <a id="orgf9f5b9a">vue:plugin:vuex:mutations</a></h4>
<div class="outline-text-4" id="text-14-16-4">
<p>
Mutation is the only way to actually change state
</p>

<p>
Mutation is defined in Vuex and it has to be synchronous!
</p>

<p>
Add new prop to state
</p>
<pre class="example">
Vue.set(obj, 'newProp', 123)

// or rebuild the whole state
state.obj = { ...state.obj, newProp: 123 }
</pre>
</div>

<div id="outline-container-orgf2109fb" class="outline-5">
<h5 id="orgf2109fb"><span class="section-number-5">14.16.4.1</span> Mutation in store, commit in component</h5>
<div class="outline-text-5" id="text-14-16-4-1">
<pre class="example">
export default new Vuex.Store({
  state: {
    count: 1
  },
  mutations: {
    increment: state =&gt; state.count++, // shorthand for
    // increment (state) { state.count++ } 
  }
})
</pre>

<p>
commit in component
</p>
<pre class="example">
methods: {
  increment () {
    this.$store.commit('increment')
  },
  decrement () {
    this.$store.commit('decrement')
  }
}
</pre>

<p>
Mutation-Commit with payload
</p>
<pre class="example">
mutations: {
  increment (state, payload) {
    state.count += payload.amount
  }
}

// in component
methods: {
  increment: () {
    this.$store.commit('increment', {
      amount: 10
    })
    // object commit form
    /*
    this.$store.commit({
      type: 'increment',
      amound: 10
    })
    */
  }
}
</pre>
</div>
</div>

<div id="outline-container-orgdd6fa03" class="outline-5">
<h5 id="orgdd6fa03"><span class="section-number-5">14.16.4.2</span> mapMutations in component</h5>
<div class="outline-text-5" id="text-14-16-4-2">
<p>
save typing in component without typing commit
</p>
<pre class="example">
import { mapMutations } from 'vuex'

export default {
  // ...
  methods: {
    ...mapMutations([
      'increment', // map `this.increment()` to `this.$store.commit('increment')`

      // `mapMutations` also supports payloads:
      'incrementBy' // map `this.incrementBy(amount)` to `this.$store.commit('incrementBy', amount)`
    ]),
    ...mapMutations({
      add: 'increment' // map `this.add()` to `this.$store.commit('increment')`
    })
  }
}
</pre>
</div>
</div>

<div id="outline-container-org8ad67ae" class="outline-5">
<h5 id="org8ad67ae"><span class="section-number-5">14.16.4.3</span> Constant for Mutation</h5>
<div class="outline-text-5" id="text-14-16-4-3">
<pre class="example">
// mutation-types.js
export const SOME_MUTATION = 'SOME_MUTATION'

// store.js
import Vuex from 'vuex'
import { SOME_MUTATION } from './mutation-types'

const store = new Vuex.Store({
  state: { ... },
  mutations: {
    // we can use the ES2015 computed property name feature
    // to use a constant as the function name
    [SOME_MUTATION] (state) {
      // mutate state
    }
  }
})
</pre>
</div>
</div>
</div>

<div id="outline-container-orge9760f4" class="outline-4">
<h4 id="orge9760f4"><span class="section-number-4">14.16.5</span> option:actions with context, dispatch/mapActions in component, Asynchronous</h4>
<div class="outline-text-4" id="text-14-16-5">
<p>
Actions commit mutations
</p>
</div>

<div id="outline-container-org8348c9f" class="outline-5">
<h5 id="org8348c9f"><span class="section-number-5">14.16.5.1</span> Basics</h5>
<div class="outline-text-5" id="text-14-16-5-1">
<pre class="example">
const store = new Vuex.Store({
  state: {
    count: 0
  },
  mutations: {
    increment (state) {
      state.count++
    }
  },
  actions: {
    increment (context) {
      // context exposes the same set of methods/props on the store instance
      // e.g. context.state, context.getters
      // but context is not the store instance
      context.commit('increment')
    }

    /* the above can be shortened to

    increment ({ commit }) {
      commit('increment')
    }
    */

  }
})
</pre>

<p>
In component
</p>
<pre class="example">
this.$store.dispatch('increment')
</pre>
</div>
</div>

<div id="outline-container-org3b02114" class="outline-5">
<h5 id="org3b02114"><span class="section-number-5">14.16.5.2</span> mapActions and Asynchronous</h5>
<div class="outline-text-5" id="text-14-16-5-2">
<p>
store.js
</p>
<pre class="example">
actions: {
  // checkout only needs commit and state from context
  // products is a payload
  checkout ({ commit, state }, products) {

    // save the items currently in the cart
    const savedCartItems = [...state.cart.added]

    // send out checkout request, and optimistically
    // clear the cart
    commit(types.CHECKOUT_REQUEST)

    // the shop API accepts a success callback and a failure callback
    shop.buyProducts(

      products,

      // handle success
      () =&gt; commit(types.CHECKOUT_SUCCESS),

      // handle failure
      () =&gt; commit(types.CHECKOUT_FAILURE, savedCartItems)

    )
  }
}
</pre>

<p>
In component
</p>
<pre class="example">
import { mapActions } from 'vuex'

export default {
  // ...
  methods: {
    ...mapActions([
      'increment', // map `this.increment()` to `this.$store.dispatch('increment')`

      // `mapActions` also supports payloads:
      'incrementBy' // map `this.incrementBy(amount)` to `this.$store.dispatch('incrementBy', amount)`
    ]),
    ...mapActions({
      add: 'increment' // map `this.add()` to `this.$store.dispatch('increment')`
    })
  }
}
</pre>
</div>
</div>

<div id="outline-container-org20eb369" class="outline-5">
<h5 id="org20eb369"><span class="section-number-5">14.16.5.3</span> Series of actions, return Promise</h5>
<div class="outline-text-5" id="text-14-16-5-3">
<pre class="example">
actions: {
  actionA ({ commit }) {
    return new Promise((resolve, reject) =&gt; {
      setTimeout(() =&gt; {
        commit('someMutation')
        resolve()
      }, 1000)
    })
  },
  actionB ({ dispatch, commit }) {
    return dispatch('actionA').then(() =&gt; {
      commit('someOtherMutation')
    })
  }
}
</pre>

<pre class="example">
store.dispatch('actionA').then(() =&gt; {
  // ...
})
</pre>
</div>
</div>

<div id="outline-container-orgbc4eb14" class="outline-5">
<h5 id="orgbc4eb14"><span class="section-number-5">14.16.5.4</span> Series of actions, async/await</h5>
<div class="outline-text-5" id="text-14-16-5-4">
<p>
<a href="#org4617f13">js:async/await</a>
</p>
<pre class="example">
// assuming `getData()` and `getOtherData()` return Promises

actions: {
  async actionA ({ commit }) {
    commit('gotData', await getData())
  },
  async actionB ({ dispatch, commit }) {
    await dispatch('actionA') // wait for `actionA` to finish
    commit('gotOtherData', await getOtherData())
  }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org6b20db6" class="outline-4">
<h4 id="org6b20db6"><span class="section-number-4">14.16.6</span> option:modules</h4>
<div class="outline-text-4" id="text-14-16-6">
<pre class="example">
const moduleA = {
  state: { ... },
  mutations: { ... },
  actions: { ... },
  getters: { ... }
}

const moduleB = {
  state: { ... },
  mutations: { ... },
  actions: { ... }
}

const store = new Vuex.Store({
  modules: {
    a: moduleA,
    b: moduleB
  }
})

store.state.a // -&gt; `moduleA`'s state
store.state.b // -&gt; `moduleB`'s state
</pre>

<p>
Register a module after the store has been created
</p>
<pre class="example">
// register a module `myModule`
store.registerModule('myModule', {
  // ...
})

// register a nested module `nested/myModule`
store.registerModule(['nested', 'myModule'], {
  // ...
})

store.unregisterModule(moduleName)
</pre>
</div>

<div id="outline-container-org97eaf6d" class="outline-5">
<h5 id="org97eaf6d"><span class="section-number-5">14.16.6.1</span> Module local state and rootState</h5>
<div class="outline-text-5" id="text-14-16-6-1">
<pre class="example">
const moduleA = {
  state: { count: 0 },
  mutations: {
    increment (state) {
      // `state` is the local module state
      state.count++
    }
  },

  getters: {
    doubleCount (state, rootState) {
      // rootState is root state
      return state.count * 2 + rootState.count
    }
  }

  actions: {
    incrementIfOddOnRootSum ({ state, commit, rootState }) {
      // local state
      if ((state.count + rootState.count) % 2 === 1) {
        commit('increment')
      }
    }
  }
}
</pre>
</div>
</div>

<div id="outline-container-org34f7fd9" class="outline-5">
<h5 id="org34f7fd9"><span class="section-number-5">14.16.6.2</span> Namespace</h5>
<div class="outline-text-5" id="text-14-16-6-2">
<p>
Namespaced getters and actions will receive localized getters, dispatch and commit. In other words, you can use the module assets without writing prefix in the same module.
</p>
<pre class="example">
const store = new Vuex.Store({
  modules: {
    account: {
      namespaced: true,

      // module assets
      state: { ... }, // module state is already nested and not affected by namespace option
      getters: {
        isAdmin () { ... } // -&gt; getters['account/isAdmin']
      },
      actions: {
        login () { ... } // -&gt; dispatch('account/login')
      },
      mutations: {
        login () { ... } // -&gt; commit('account/login')
      },

      // nested modules
      modules: {
        // inherits the namespace from parent module
        myPage: {
          state: { ... },
          getters: {
            profile () { ... } // -&gt; getters['account/profile']
          }
        },

        // further nest the namespace
        posts: {
          namespaced: true,

          state: { ... },
          getters: {
            popular () { ... } // -&gt; getters['account/posts/popular']
          }
        }
      }
    }
  }
})
</pre>

<p>
In component
</p>
<pre class="example">
computed: {
  ...mapState({
    a: state =&gt; state.some.nested.module.a,
    b: state =&gt; state.some.nested.module.b
  })
},
methods: {
  ...mapActions([
    'some/nested/module/foo',
    'some/nested/module/bar'
  ])
}
</pre>

<p>
Or this
</p>
<pre class="example">
computed: {
  ...mapState('some/nested/module', {
    a: state =&gt; state.a,
    b: state =&gt; state.b
  })
},
methods: {
  ...mapActions('some/nested/module', [
    'foo',
    'bar'
  ])
}
</pre>

<p>
Or
</p>
<pre class="example">
import { createNamespacedHelpers } from 'vuex'

const { mapState, mapActions } = createNamespacedHelpers('some/nested/module')

export default {
  computed: {
    // look up in `some/nested/module`
    ...mapState({
      a: state =&gt; state.a,
      b: state =&gt; state.b
    })
  },
  methods: {
    // look up in `some/nested/module`
    ...mapActions([
      'foo',
      'bar'
    ])
  }
}
</pre>
</div>
</div>

<div id="outline-container-org267e6bb" class="outline-5">
<h5 id="org267e6bb"><span class="section-number-5">14.16.6.3</span> rootGetters</h5>
<div class="outline-text-5" id="text-14-16-6-3">
<pre class="example">
modules: {
  foo: {
    namespaced: true,

    getters: {
      // `getters` is localized to this module's getters
      // you can use rootGetters via 4th argument of getters
      someGetter (state, getters, rootState, rootGetters) {
        getters.someOtherGetter // -&gt; 'foo/someOtherGetter'
        rootGetters.someOtherGetter // -&gt; 'someOtherGetter'
      },
      someOtherGetter: state =&gt; { ... }
    },

    actions: {
      // dispatch and commit are also localized for this module
      // they will accept `root` option for the root dispatch/commit
      someAction ({ dispatch, commit, getters, rootGetters }) {
        getters.someGetter // -&gt; 'foo/someGetter'
        rootGetters.someGetter // -&gt; 'someGetter'

        dispatch('someOtherAction') // -&gt; 'foo/someOtherAction'
        dispatch('someOtherAction', null, { root: true }) // -&gt; 'someOtherAction'

        commit('someMutation') // -&gt; 'foo/someMutation'
        commit('someMutation', null, { root: true }) // -&gt; 'someMutation'
      },
      someOtherAction (ctx, payload) { ... }
    }
  }
}
</pre>
</div>
</div>

<div id="outline-container-orgb1a1e9d" class="outline-5">
<h5 id="orgb1a1e9d"><span class="section-number-5">14.16.6.4</span> Namespace in Plugin Development <a id="org2603bc9">vue:plugin:vuex:namespace in plugin</a></h5>
<div class="outline-text-5" id="text-14-16-6-4">
<pre class="example">
// get namespace value via plugin option
// and returns Vuex plugin function
export function createPlugin (options = {}) {
  return function (store) {
    // add namespace to plugin module's types
    const namespace = options.namespace || ''
    store.dispatch(namespace + 'pluginAction')
  }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb772bc7" class="outline-4">
<h4 id="orgb772bc7"><span class="section-number-4">14.16.7</span> option:strict, strict mode</h4>
<div class="outline-text-4" id="text-14-16-7">
<p>
In strict mode, whenever Vuex state is mutated outside of mutation handlers, an error will be thrown. This ensures that all state mutations can be explicitly tracked by debugging tools.
</p>
<pre class="example">
const store = new Vuex.Store({
  // ...
  strict: process.env.NODE_ENV !== 'production'
})
</pre>
</div>
</div>

<div id="outline-container-org0435b4b" class="outline-4">
<h4 id="org0435b4b"><span class="section-number-4">14.16.8</span> option:watch</h4>
<div class="outline-text-4" id="text-14-16-8">
<p>
watch(getter: Function, cb: Function, options?: Object)
</p>

<p>
Reactively watch a getter function's return value, and call the callback when the value changes. The getter receives the store's state as the only argument. Accepts an optional options object that takes the same options as Vue's vm.$watch method.
</p>

<p>
To stop watching, call the returned handle function.
</p>
</div>
</div>

<div id="outline-container-org2ef05b6" class="outline-4">
<h4 id="org2ef05b6"><span class="section-number-4">14.16.9</span> option:plugin</h4>
<div class="outline-text-4" id="text-14-16-9">
<p>
plugins option that exposes hooks for each mutation. A Vuex plugin is simply a function that receives the store as the only argument
</p>
<pre class="example">
const myPlugin = store =&gt; {
  // called when the store is initialized
  store.subscribe((mutation, state) =&gt; {
    // called after every mutation.
    // The mutation comes in the format of `{ type, payload }`.
  })
}

const store = new Vuex.Store({
  // ...
  plugins: [myPlugin]
})
</pre>
</div>
</div>

<div id="outline-container-org35a0139" class="outline-4">
<h4 id="org35a0139"><span class="section-number-4">14.16.10</span> App Structure, Example</h4>
<div class="outline-text-4" id="text-14-16-10">
<p>
<a href="https://github.com/vuejs/vuex/tree/dev/examples/shopping-cart">Shopping Cart Example</a>
</p>
<pre class="example">
├── index.html
├── main.js
├── api
│   └── ... # abstractions for making API requests
├── components
│   ├── App.vue
│   └── ...
└── store
    ├── index.js          # where we assemble modules and export the store
    ├── actions.js        # root actions
    ├── mutations.js      # root mutations
    └── modules
        ├── cart.js       # cart module
        └── products.js   # products module
</pre>

<p>
./api/shop.js
</p>
<pre class="example">
/**
 * Mocking client-server processing
 */
const _products = [
  {"id": 1, "title": "iPad 4 Mini", "price": 500.01, "inventory": 2},
  {"id": 2, "title": "H&amp;M T-Shirt White", "price": 10.99, "inventory": 10},
  {"id": 3, "title": "Charli XCX - Sucker CD", "price": 19.99, "inventory": 5}
]

export default {
  getProducts (cb) {
    setTimeout(() =&gt; cb(_products), 100)
  },

  buyProducts (products, cb, errorCb) {
    setTimeout(() =&gt; {
      // simulate random checkout failure.
      (Math.random() &gt; 0.5 || navigator.userAgent.indexOf('PhantomJS') &gt; -1)
        ? cb()
        : errorCb()
    }, 100)
  }
}
</pre>

<p>
./store/index.js
</p>
<pre class="example">
import Vue from 'vue'
import Vuex from 'vuex'
import * as actions from './actions'
import * as getters from './getters'
import cart from './modules/cart'
import products from './modules/products'
import createLogger from '../../../src/plugins/logger'

Vue.use(Vuex)

const debug = process.env.NODE_ENV !== 'production'

export default new Vuex.Store({
  actions,
  getters,
  modules: {
    cart,
    products
  },
  strict: debug,
  plugins: debug ? [createLogger()] : []
})
</pre>

<p>
./store/modules/products.js
</p>
<pre class="example">
import shop from '../../api/shop'
import * as types from '../mutation-types'

// initial state
const state = {
  all: []
}

// getters
const getters = {
  allProducts: state =&gt; state.all
}

// actions
const actions = {
  getAllProducts ({ commit }) {
    shop.getProducts(products =&gt; {
      commit(types.RECEIVE_PRODUCTS, { products })
    })
  }
}

// mutations
const mutations = {
  [types.RECEIVE_PRODUCTS] (state, { products }) {
    state.all = products
  },

  [types.ADD_TO_CART] (state, { id }) {
    state.all.find(p =&gt; p.id === id).inventory--
  }
}

export default {
  state,
  getters,
  actions,
  mutations
}
</pre>

<p>
./components/App.vue
</p>
<pre class="example">
&lt;template&gt;
  &lt;div id="app"&gt;
    &lt;h1&gt;Shopping Cart Example&lt;/h1&gt;
    &lt;hr&gt;
    &lt;h2&gt;Products&lt;/h2&gt;
    &lt;product-list&gt;&lt;/product-list&gt;
    &lt;hr&gt;
    &lt;cart&gt;&lt;/cart&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import ProductList from './ProductList.vue'
import Cart from './Cart.vue'
export default {
  components: { ProductList, Cart }
}
&lt;/script&gt;
</pre>

<p>
./component/ProductList.vue
</p>
<pre class="example">
&lt;template&gt;
  &lt;ul&gt;
    &lt;li v-for="p in products"&gt;
      {{ p.title }} - {{ p.price | currency }}
      &lt;br&gt;
      &lt;button
        :disabled="!p.inventory"
        @click="addToCart(p)"&gt;
        Add to cart
      &lt;/button&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/template&gt;

&lt;script&gt;
import { mapGetters, mapActions } from 'vuex'
export default {
  computed: mapGetters({
    products: 'allProducts'
  }),
  methods: mapActions([
    'addToCart'
  ]),
  created () {
    this.$store.dispatch('getAllProducts')
  }
}
&lt;/script&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orge312031" class="outline-3">
<h3 id="orge312031"><span class="section-number-3">14.17</span> Dev - Webpack Template</h3>
<div class="outline-text-3" id="text-14-17">
</div>
<div id="outline-container-org877530b" class="outline-4">
<h4 id="org877530b"><span class="section-number-4">14.17.1</span> Basics</h4>
<div class="outline-text-4" id="text-14-17-1">
<p>
Install node module vue-cli
</p>
<pre class="example">
npm install -g vue-cli
vue init webpack my-project
cd my-project
npm install
npm run dev
</pre>

<p>
Other template can be used
</p>

<pre class="example">
# vue init &lt;template-name&gt; &lt;project-name&gt;
vue init webpack-simple my-project

# Template on github
vue init username/repo my-project

# Template on Bitbucket
vue init bitbucket:username/repo my-project

# for a tag or branch
vue init bitbucket:username/repo#branch my-project

# local template
vue init ~/fs/path/to-custom-template my-project
</pre>

<p>
<a href="https://vuejs-templates.github.io/webpack/structure.html">Webpack Template Doc</a>
</p>
</div>
</div>

<div id="outline-container-org2025179" class="outline-4">
<h4 id="org2025179"><span class="section-number-4">14.17.2</span> npm</h4>
<div class="outline-text-4" id="text-14-17-2">
<p>
Default port is 8080 and it can be auto adjusted.
It loads the <a href="https://github.com/vuejs-templates/webpack">vuejs-templates/webpack</a>
npm run dev includes
</p>
<ul class="org-ul">
<li>webpack + vue-loader for single file Vue components</li>
<li>state preserving hot-reload</li>
<li>state preserving compilation error overlay</li>
<li>Lint-on-save with ESLint</li>
<li>Source maps</li>
</ul>

<p>
npm run build :: build for production
</p>
<ul class="org-ul">
<li>UglifyJS</li>
<li>html-minifier <a href="https://github.com/kangax/html-minifier">https://github.com/kangax/html-minifier</a></li>
<li>CSS across all components extracted into a single file and minified with <a href="https://github.com/ben-eb/cssnano">cssnano</a></li>
<li>Static assets compiled with versio hashes for efficient long-term caching and an auto-generated production index.html with proper URLs to these generated assets</li>
<li>Use <code>npm run build --report</code> to build with bundle size analytics</li>
</ul>

<p>
npm run unit :: unit tests run in PhantomJS with Karma + Mocha + karma-webpack
</p>
<ul class="org-ul">
<li>support ES2015+ in test files</li>
<li>support all webpack loaders</li>
<li>easy mock injection</li>
</ul>

<p>
num run e2e :: end-to-end tests with Nightwatch
</p>
<ul class="org-ul">
<li>run tests in multiple browsers in parallel</li>
<li>works with one command out of the box
<ul class="org-ul">
<li>Selenium and chromedrive dependencies automatically handled</li>
<li>automatically spawns the Selenium Server</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org44afcdb" class="outline-4">
<h4 id="org44afcdb"><span class="section-number-4">14.17.3</span> Structure</h4>
<div class="outline-text-4" id="text-14-17-3">
<pre class="example">
.
├── build/                      # webpack config files for dev and prod. Don't touch unless to customize Webpack loaders
│   └── ...                     # e.g. webpack.base.conf.js
├── config/
│   ├── index.js                # main project config. vue:webpack:integrate backend
│   └── ...
├── src/                        # app files
│   ├── main.js                 # app entry file
│   ├── App.vue                 # main app component
│   ├── components/             # ui components
│   │   └── ...
│   └── assets/                 # module assets (processed by webpack)
│       └── ...
├── static/                     # pure static assets (directly copied and not processed by Webpack)
├── test/
│   └── unit/                   # unit tests
│   │   ├── specs/              # test spec files
│   │   ├── index.js            # test build entry file
│   │   └── karma.conf.js       # test runner config file
│   └── e2e/                    # e2e tests
│   │   ├── specs/              # test spec files
│   │   ├── custom-assertions/  # custom assertions for e2e tests
│   │   ├── runner.js           # test runner script
│   │   └── nightwatch.conf.js  # test runner config file
├── .babelrc                    # babel config
├── .postcssrc.js               # postcss config
├── .eslintrc.js                # eslint config
├── .editorconfig               # editor config
├── index.html                  # index.html template. Webpack will generate assets and auto inject into it during dev and builds.
└── package.json                # build scripts and dependencies
</pre>
</div>
</div>

<div id="outline-container-org8957d8e" class="outline-4">
<h4 id="org8957d8e"><span class="section-number-4">14.17.4</span> Linter configuration</h4>
<div class="outline-text-4" id="text-14-17-4">
<p>
Modify ./.eslintrc.js
Add under rule
</p>
<pre class="example">
"semi": [2, "always"]
</pre>

<p>
Preset standard is set. <a href="https://github.com/standard/standard/blob/master/docs/RULES-en.md">Checkout all the rules</a>.
</p>
</div>
</div>

<div id="outline-container-org9e5ee4d" class="outline-4">
<h4 id="org9e5ee4d"><span class="section-number-4">14.17.5</span> CSS Pre-processor</h4>
<div class="outline-text-4" id="text-14-17-5">
<p>
This boilerplate has pre-configured LESS, SASS, Stylus adn PostCSS.
Just install the appropriate webpack loader.
</p>

<pre class="example">
npm install sass-loader node-sass --save-dev
</pre>

<p>
After, in *.vue components
</p>
<pre class="example">
&lt;style lang="scss"&gt;
/* write SASS! */
&lt;/style&gt;
</pre>

<p>
lang="scss" corresponds to the CSS-superset syntax (with curly braces and semicolons).
lang="sass" corresponds to the indentation-based syntax.
</p>

<p>
Standalone CSS Files
Import global and custom style files from your root App.vue component
</p>
<pre class="example">
&lt;!-- App.vue --&gt;
&lt;style src="./styles/global.less" lang="less"&gt;&lt;/style&gt;
</pre>

<p>
For other 3rd party, e.g. Bootstrap, place them inside /static and reference them directly in index.html.
</p>
</div>
</div>

<div id="outline-container-org99d53e6" class="outline-4">
<h4 id="org99d53e6"><span class="section-number-4">14.17.6</span> Processed Static Assets =&gt; /src/assets</h4>
<div class="outline-text-4" id="text-14-17-6">
<p>
In *.vue components, all templates and CSS are parsed by vue-html-loader and css-loader to look for asset URLs.
</p>

<p>
<code>&lt;img src="./logo.png"&gt;</code> and <code>background: url(./logo.png)</code>, is a relative asset path and will be resolved by Webpack as a module dependency.
</p>

<p>
These assets may be inlined/copied/renamed during build.
</p>

<p>
Recommended :: put each component in its own directory with its static assets right next to it and continue to use relative path.
</p>

<dl class="org-dl">
<dt>Relative URLs</dt><dd>e.g. ./assets/logo.png will be interpreted as a module dependency. They will be replaced with an auto-generated URL based on your Webpack output configuration.</dd>

<dt>Non-prefixed URLs</dt><dd>e.g. assets/logo.png will be treated the same as the relative URLs and translated into ./assets/logo.png.</dd>

<dt>URLs prefixed with ~</dt><dd>are treated as a module request, similar to require('some-module/image.png'). You need to use this prefix if you want to leverage Webpack's module resolving configurations. For example if you have a resolve alias for assets, you need to use &lt;img src="~assets/logo.png"&gt; to ensure that alias is respected.</dd>

<dt>Root-relative URLs</dt><dd>e.g. /assets/logo.png are not processed at all.</dd>
</dl>

<p>
Files in ./src/assets/ or any webpack processed assets may be copied to \((build.assetsRoot)\)(build.assetsSubDirectory)
</p>

<p>
If assets are inserted via JavaScript like computed property, you need to do it in this way
</p>
<pre class="example">
computed: {
  background () {
    return require('./bgs/' + this.id + '.jpg')
  }
}
</pre>

<p>
Limitation :: all images under ./bgs/ will be included in the final build.
</p>

<p>
Files in ./static/ will be directly copied to \((build.assetsPublicPath)\)(build.assetsSubDirectory). Refer to <a href="#org3c1cdec">vue:webpack:config:index.js</a>
</p>

<p>
Files in ./static/ should be referenced as absolute path like <i>static</i>[filename]. If $(build.assetsSubDirectory) is changed, you need to change in the reference as well.
</p>
</div>
</div>

<div id="outline-container-orge66b767" class="outline-4">
<h4 id="orge66b767"><span class="section-number-4">14.17.7</span> Integrate with Backend <a id="org3675419">vue:webpack:integrate backend</a></h4>
<div class="outline-text-4" id="text-14-17-7">
</div>
<div id="outline-container-orgd6bdc26" class="outline-5">
<h5 id="orgd6bdc26"><span class="section-number-5">14.17.7.1</span> Proxy requests to a backend</h5>
<div class="outline-text-5" id="text-14-17-7-1">
<p>
In <code>config/index.js</code>, edit dev.proxyTable option
Proxy the request /api/posts/1 to <a href="http://jsonplaceholder.typicode.com/posts/1">http://jsonplaceholder.typicode.com/posts/1</a>.
</p>
<pre class="example">
module.exports = {
  // ...
  dev: {
    proxyTable: {
      // proxy all requests starting with /api to jsonplaceholder
      '/api': {
        target: 'http://jsonplaceholder.typicode.com',
        changeOrigin: true,
        pathRewrite: {
          '^/api': ''
        }
      }
    }
  }
}
</pre>

<p>
It uses <a href="https://github.com/chimurai/http-proxy-middleware">http-proxy-middleware</a>
</p>

<pre class="example">
proxyTable: {
  '**': {
    target: 'http://jsonplaceholder.typicode.com',
    filter: function (pathname, req) {
      return pathname.match('^/api') &amp;&amp; req.method === 'GET'
    }
  }
}
</pre>
</div>
</div>

<div id="outline-container-org5bb7c81" class="outline-5">
<h5 id="org5bb7c81"><span class="section-number-5">14.17.7.2</span> Backend path</h5>
<div class="outline-text-5" id="text-14-17-7-2">
<p>
Default ./config/index.js <a id="org3c1cdec">vue:webpack:config:index.js</a>
</p>
<pre class="example">
var path = require('path')

module.exports = {
  build: {
    index: path.resolve(__dirname, 'dist/index.html'),
    // has to be absolute
    // e.g. path.resolve(__dirname, 'resources/views/index.blade.php'),

    assetsRoot: path.resolve(__dirname, 'dist'), // final after build is /dist/static
    // path.resolve(__dirname, 'public/');

    assetsSubDirectory: 'static', // changing this also means absolute paths for real static assets need to be changed 
    assetsPublicPath: '/',
    productionSourceMap: true
  },
  dev: {
    port: 8080,
    proxyTable: {}
  }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org498f119" class="outline-4">
<h4 id="org498f119"><span class="section-number-4">14.17.8</span> .vue file vue-loader</h4>
<div class="outline-text-4" id="text-14-17-8">
<p>
.vue file name
Add attribute <code>lang</code> to chnage language :: &lt;style lang="sass"&gt;
</p>

<p>
&lt;template&gt; :: default html, 0 or 1 template block.
&lt;script&gt; :: default js (ES2015 if babel-loader or buble-loader exists). - or 1 script block. require() can be used. With ES2015, import and export can also be used. The result is to export a Vue.js component option object. An extended constructor created by Vue.extend() can also be exported.
</p>

<p>
&lt;style&gt; :: default css. 
</p>
<ul class="org-ul">
<li>Multiple blocks.</li>
<li>Can have scoped or mobile attributes.</li>
<li><a href="#orgad74b31">vue:loader:scoped css</a>, <a href="#org66232d0">vue:loader:css modules</a></li>
<li>can have mixed encapsulation modes</li>
</ul>
</div>

<div id="outline-container-org464786c" class="outline-5">
<h5 id="org464786c"><span class="section-number-5">14.17.8.1</span> scoped css <a id="orgad74b31">vue:loader:scoped css</a></h5>
<div class="outline-text-5" id="text-14-17-8-1">
<p>
Scoped to current component.
</p>

<pre class="example">
&lt;style scoped&gt;
.example {
  color: red;
}
&lt;/style&gt;

&lt;template&gt;
  &lt;div class="example"&gt;hi&lt;/div&gt;
&lt;/template&gt;
</pre>

<p>
Parent component's styles will not leak into child components.
However, a child component's root node will be affected by both the parent's scoped CSS and the child's scoped CSS.
So that the parent can style the child root element for layout purpose.
</p>

<p>
Deep selector
</p>
<pre class="example">
&lt;style scoped&gt;
.a &gt;&gt;&gt; .b { /* ... */ }
&lt;/style&gt;

// will be compiled into
.a[data-v-f3f3eg9] .b { /* ... */ }

// may use /deep/ combinator instead for &gt;&gt;&gt; in other pre-processors, like SASS
</pre>
</div>
</div>

<div id="outline-container-orgc0f564c" class="outline-5">
<h5 id="orgc0f564c"><span class="section-number-5">14.17.8.2</span> CSS Modules</h5>
<div class="outline-text-5" id="text-14-17-8-2">
<p>
<a id="org66232d0">vue:loader:css modules</a>
<a href="https://vue-loader.vuejs.org/en/features/css-modules.html">https://vue-loader.vuejs.org/en/features/css-modules.html</a>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgde58304" class="outline-3">
<h3 id="orgde58304"><span class="section-number-3">14.18</span> Ajax, axios</h3>
<div class="outline-text-3" id="text-14-18">
<p>
<a href="https://github.com/axios/axios">https://github.com/axios/axios</a>
<a href="https://rubyplus.com/articles/5051-Using-vue-cli-and-axios-in-Vue-js-2">https://rubyplus.com/articles/5051-Using-vue-cli-and-axios-in-Vue-js-2</a>
</p>

<pre class="example">
npm install axios --save

// just import it and use it wherever you want
&lt;script&gt;
  import axios from 'axios'

  export default {
    name: 'app',
    data: function () {
      return {
        articles: []
      }
    },
    methods: {
      fetchArticles: function () {
        axios.get('http://localhost:3000/articles').then((response) =&gt; {
          this.articles = response.data
        }, (error) =&gt; {
          console.log(error)
        })
      }
    },
    mounted: function () {
      this.fetchArticles()
    }
  }
&lt;/script&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-org41ea313" class="outline-2">
<h2 id="org41ea313"><span class="section-number-2">15</span> Prerender.io</h2>
<div class="outline-text-2" id="text-15">
<p>
<a href="https://github.com/prerender/prerender">https://github.com/prerender/prerender</a>
</p>

<p>
Install middleware on .htaccess to rewrite search engine traffic to prerender server
</p>

<p>
example.com is your site and its .htaccess is
</p>
<pre class="example">
# Change YOUR_TOKEN to your prerender token and uncomment that line if you want to cache urls and view crawl stats
# Change http://example.com (at the end of the last RewriteRule) to your website url

&lt;IfModule mod_headers.c&gt;
    #RequestHeader set X-Prerender-Token "YOUR_TOKEN"
&lt;/IfModule&gt;

&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On

    &lt;IfModule mod_proxy_http.c&gt;
        RewriteCond %{HTTP_USER_AGENT} baiduspider|facebookexternalhit|twitterbot|rogerbot|linkedinbot|embedly|quora\ link\ preview|showyoubot|outbrain|pinterest|slackbot|vkShare|W3C_Validator [NC,OR]
        RewriteCond %{QUERY_STRING} _escaped_fragment_

# Only proxy the request to Prerender if it's a request for HTML
        RewriteRule ^(?!.*?(\.js|\.css|\.xml|\.less|\.png|\.jpg|\.jpeg|\.gif|\.pdf|\.doc|\.txt|\.ico|\.rss|\.zip|\.mp3|\.rar|\.exe|\.wmv|\.doc|\.avi|\.ppt|\.mpg|\.mpeg|\.tif|\.wav|\.mov|\.psd|\.ai|\.xls|\.mp4|\.m4a|\.swf|\.dat|\.dmg|\.iso|\.flv|\.m4v|\.torrent|\.ttf|\.woff))(.*) http://service.prerender.io/http://example.com/$2 [P,L]
    &lt;/IfModule&gt;
&lt;/IfModule&gt;
</pre>

<p>
Install prerender on prerender server
</p>
<pre class="example">
$ git clone https://github.com/prerender/prerender.git
$ cd prerender
$ npm install
$ node server.js
</pre>

<p>
Prerender will now be running on <a href="http://localhost:3000">http://localhost:3000</a>. If you wanted to start a web app that ran on say, <a href="http://localhost:8000">http://localhost:8000</a>, you can now visit the URL <a href="http://localhost:3000/http://localhost:8000">http://localhost:3000/http://localhost:8000</a> to see how your app would render in Prerender.
</p>

<p>
:3000/<a href="http://:8000">http://:8000</a> may return something that is 504. Don't worry it will work after Rewrite.
</p>

<p>
Change options in ./server.js
</p>

<p>
For better result, add this to every page and search engine will add <code>?_escaped_fragment_=</code> to the URL
</p>
<pre class="example">
&lt;meta name="fragment" content="!"&gt;
</pre>

<p>
html5 push state :: URL <code>http://example.com/user/1</code> becomes <code>http://example.com/user/1?_escaped_fragment_=</code>
hashbang :: <code>http://example.com/#!/user/1</code> becomes <code>http://example.com/?_escaped_fragment_=/user/1</code>
</p>
</div>
</div>

<div id="outline-container-orga2dab1e" class="outline-2">
<h2 id="orga2dab1e"><span class="section-number-2">16</span> Social Media</h2>
<div class="outline-text-2" id="text-16">
</div>
<div id="outline-container-org1c433bd" class="outline-3">
<h3 id="org1c433bd"><span class="section-number-3">16.1</span> Twitter</h3>
<div class="outline-text-3" id="text-16-1">
</div>
<div id="outline-container-orgc3a1c27" class="outline-4">
<h4 id="orgc3a1c27"><span class="section-number-4">16.1.1</span> Compose link with prepopulated Tweet</h4>
<div class="outline-text-4" id="text-16-1-1">
<p>
<a href="https://dev.twitter.com/web/tweet-button/web-intent">https://dev.twitter.com/web/tweet-button/web-intent</a>
</p>

<pre class="example">
https://twitter.com/intent/tweet?
</pre>

<p>
Query Parameters
</p>
<dl class="org-dl">
<dt>text</dt><dd><code>Hello%20World</code></dd>
<dt>url</dt><dd><code>https%3A%2F%2Fexample.com%2F</code></dd>
<dt>hashtags</dt><dd><code>nature,sunset</code></dd>
</dl>
</div>
</div>

<div id="outline-container-org9bc5693" class="outline-4">
<h4 id="org9bc5693"><span class="section-number-4">16.1.2</span> View a topic</h4>
<div class="outline-text-4" id="text-16-1-2">
<p>
<a href="https://twitter.com/hashtag/hastagname?src=hash">https://twitter.com/hashtag/hastagname?src=hash</a>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org090ce44" class="outline-2">
<h2 id="org090ce44"><span class="section-number-2">17</span> SEO</h2>
<div class="outline-text-2" id="text-17">
</div>
<div id="outline-container-org9726691" class="outline-3">
<h3 id="org9726691"><span class="section-number-3">17.1</span> Starter Guide</h3>
<div class="outline-text-3" id="text-17-1">
<p>
<a href="https://support.google.com/webmasters/answer/7451184?hl=en">https://support.google.com/webmasters/answer/7451184?hl=en</a>
<a href="https://www.google.com/intl/en_us/insidesearch/">Everything about Google Search</a>
<a href="https://support.google.com/webmasters/answer/35769/?hl=en">Webmaster Guidelines</a> <a href="https://developers.google.com/search/">Google Developer: Search</a>
</p>
</div>
</div>

<div id="outline-container-orge06f7d7" class="outline-3">
<h3 id="orge06f7d7"><span class="section-number-3">17.2</span> <a href="https://testmysite.thinkwithgoogle.com/">Google Test Mobile Speed</a></h3>
</div>
<div id="outline-container-org58d5422" class="outline-3">
<h3 id="org58d5422"><span class="section-number-3">17.3</span> Google My Business</h3>
<div class="outline-text-3" id="text-17-3">
<p>
Register <a href="https://www.google.com/business/">https://www.google.com/business/</a>
</p>

<p>
Insights
</p>
<ul class="org-ul">
<li>Direct Search and Discovery Search</li>
<li>Search views and Maps views</li>
<li>Visit your website, Request directions, Call you, View photos</li>
</ul>

<p>
API : <a href="https://developers.google.com/my-business/">https://developers.google.com/my-business/</a>
</p>
</div>
</div>

<div id="outline-container-org01da825" class="outline-3">
<h3 id="org01da825"><span class="section-number-3">17.4</span> Google Analytics</h3>
<div class="outline-text-3" id="text-17-4">
</div>
<div id="outline-container-org74f2e57" class="outline-4">
<h4 id="org74f2e57"><span class="section-number-4">17.4.1</span> Limits and Versions</h4>
<div class="outline-text-4" id="text-17-4-1">
<p>
GA sets and reads cookies for each unique domain e.g. www.example.com and dogtoys.example.com have 2 different cookies. Javascript document.domain
</p>

<p>
GA for FireBase is free and limited to track mobile apps.
</p>

<p>
GA 360 is a paid per year service that includes a Service Level Agreement (SLA) that supports higher hit volumes.
<a href="https://www.lunametrics.com/services/google-analytics-360-hub/feature-comparison/">https://www.lunametrics.com/services/google-analytics-360-hub/feature-comparison/</a>
</p>
<ul class="org-ul">
<li>10M hits per month free and up to several billions. Data freshness is 24-48 hours vs 4 hour guarantee (most 15-20min)</li>
<li>Roll-up reporting aggregates data from multiple Analytics properties and lets you see that data together in the same reports. e.g. website and mobile app stats</li>
<li>GA has sampling occur in Property while 360 has sampling occur in View. Default sample is 250k visits (sessions) and can be changed to 500k per property vs 360 100M sessions per view. Standard report always has unsampled data and if you add a segment, create a report, filter the report, then sampled data will be used.</li>
<li>So Filter won't affect sampling in 360</li>
<li>360 can use Google BigQuery</li>
<li>360 has 10 times more custom dimensions &amp; metrics. Standard only has 20 and 20 for dimensions and metrics.</li>
<li>360 has more integration e.g. DoubleClick Campaign Manager, DoubleClick Bid Manager, DoubleClick for Publishers, Salesforce Marketing Cloud while GA has only AdWords and AdSense. Import stats from AdWords to GA and GA exports remarketing audiences to AdWords.</li>
<li>360 can query-time import custom data sources (compare historic data and view the new imported data) while GA just imports</li>
<li>The standard attribution modeling tool can give some formula-based models for attributing conversions to channels (like first-touch, last-touch, time decay, etc.). But which of those is the “right” model? GA360 includes a data driven attribution model, which actually uses an algorithm on your data to understand where different channels make the most impact.</li>
<li>Enhanced custom funnel reporting options. e.g. How many users view the page then scroll to 50% then scroll to the end of article then scroll to the end of page</li>
<li>360 has custom tables, unsampled reports</li>
</ul>

<p>
Non-360 way to cut down hits per month
</p>
<ul class="org-ul">
<li>Separate traffic by setting up new property</li>
<li>Cut down spam traffic</li>
</ul>
</div>

<div id="outline-container-orgc7872dc" class="outline-5">
<h5 id="orgc7872dc"><span class="section-number-5">17.4.1.1</span> Hit limits</h5>
<div class="outline-text-5" id="text-17-4-1-1">
<p>
10 million hits per month per property
500 hits per session for legacy tracking library (ga.js)
200,000 hits per user per day, 500 hits per session (universal analytics)
</p>
</div>
</div>
</div>

<div id="outline-container-org6d37d28" class="outline-4">
<h4 id="org6d37d28"><span class="section-number-4">17.4.2</span> Views, Filters, Segments</h4>
<div class="outline-text-4" id="text-17-4-2">
<p>
Under Admin, you can build Views. Views can have Filters. Views collect data when they are created.
Changes on Views and Filters will affect future data only.
</p>

<p>
Under Views, there're a lot of reports. Apply Segments to reports to filter out data 
without destroying Views data.
</p>

<p>
Up to 25 views per property. 35 days to recover a deleted View.
</p>

<p>
You should always have a View without Filters to capture all data.
</p>
</div>

<div id="outline-container-org88bf583" class="outline-5">
<h5 id="org88bf583"><span class="section-number-5">17.4.2.1</span> Filter</h5>
<div class="outline-text-5" id="text-17-4-2-1">
<p>
A Filter is to filter out the types of traffic you don't want and save the data to your View.
</p>
<ul class="org-ul">
<li>Filter might take 24 hours to activate</li>
<li>Filter will limit the stats data from the moment it is fully activated</li>
</ul>

<p>
In order to show only traffic that are on a set of pages, you can:
</p>
<ul class="org-ul">
<li>Figure out a Regex statement and use it as the filter that is inside the View &gt; Default Segment.
○ You can't save this filter. You have to do it manually every time you want the report
○ You can see the filtered results right away and you can see previous stats</li>
<li>Use javascript to submit Custom Variable on those pages and set to Page-level. 
○ Create a new View with Admin &gt; Property &gt; View &gt; Filter 
○ You have to wait 24 hours to let the stats to be recorded from then
○ You can't see the previous stats</li>
</ul>

<p>
Filters are account-level. If filters are changed on View level, they are also changed on account-level.
</p>

<p>
You can refer to this for constructing your <a href="#org03ff199">ga:regex</a> in Admin &gt; Property &gt; View &gt; Filter or the normal filter.
</p>

<p>
You should create 3 views :: Unfiltered, Main and Test. Test new filters on Test View first and then apply to actual views.
</p>

<p>
<a href="https://www.lunametrics.com/blog/2015/12/10/basic-google-analytics-filters/">Basic GA Filters</a>
</p>

<p>
Custom Filter - Advanced
</p>

<p>
Extract 2 values from 2 fields (Field A and B), and output that to a field.
</p>

<p>
The output field can be a Custom Field or a system field (e.g. Request URI, override the field value) or a User Defined value.
</p>

<p>
Request URI includes URL parameters but without domain and protocol
</p>

<p>
Custom Field 1 and 2 are used only in filters. Appears on GA report Audience &gt; Custom &gt; Custom Variables
</p>

<p>
User Defined value can be set in javascript and it's a single value. Appears on GA report Audience &gt; Custom &gt; User Defined
</p>

<p>
Example, only include traffic that URI has utm_source=MV_* and utm_medium=email
</p>

<p>
Advanced Filter
Field A (utm_source=MV_[^&amp;]*)
Field B (utm_medium=email)
Output to Custom Field 1: $A1&amp;$B1
</p>

<p>
Setting Field 1 and 2 are required, Override Output Field
</p>

<p>
Custom Filter
Include, Custom Field 1, utm_source=[^&amp;]*&amp;utm_medium=email
</p>
</div>
</div>

<div id="outline-container-org80965cd" class="outline-5">
<h5 id="org80965cd"><span class="section-number-5">17.4.2.2</span> System Filters</h5>
<div class="outline-text-5" id="text-17-4-2-2">
<p>
<a href="https://support.google.com/analytics/answer/1034380">https://support.google.com/analytics/answer/1034380</a>
</p>
</div>
</div>

<div id="outline-container-orgf500bab" class="outline-5">
<h5 id="orgf500bab"><span class="section-number-5">17.4.2.3</span> Include domain names (Custom Filter)</h5>
<div class="outline-text-5" id="text-17-4-2-3">
<p>
Filter Type: Custom filter &gt; Advanced
Field A: Hostname Extract A: (.*)
Field B: Request URI Extract: (.*)
Output To: Request URI Constructor: $A1$B1
</p>
</div>
</div>
</div>

<div id="outline-container-org2ebd5b3" class="outline-4">
<h4 id="org2ebd5b3"><span class="section-number-4">17.4.3</span> Dimensions vs Metrics <a id="orgf1f264a">ga:dimensions</a> <a id="org8b29e5b">ga:metrics</a> <a id="org56a6c98">ga:scope</a></h4>
<div class="outline-text-4" id="text-17-4-3">
<p>
Each cell shows the value in the corresponding metric column that also belong to the corresponding dimension row.
</p>

<p>
e.g. metric is Goal completion and dimension is country. Table shows number of goal completions in each country.
</p>

<p>
Which dimension value has the highest metric? e.g. Which page category (custom dimension) has the highest pageviews (built-in metrics).
</p>

<p>
Filters are applied to dimensions.
</p>

<p>
Dimension can have one of these levels or scope <a href="https://support.google.com/analytics/answer/2709828#scope">https://support.google.com/analytics/answer/2709828#scope</a>
</p>
<dl class="org-dl">
<dt>Product</dt><dd>value is applied to the product for which it has been set (Enhanced Ecommerce only)</dd>
<dt>Hit</dt><dd>a single action e.g. pageview, event. A hit can associate with multiple products</dd>
<dt>Session</dt><dd>has multiple hits. Timeout limit by default is 30 minutes. Max can go to 4 hours. Admin &gt; Property</dd>
<dt>User</dt><dd>a cookie that has sessions</dd>
</dl>

<p>
Metric can only have Hit or Product level.
</p>

<p>
All standard <a href="https://developers.google.com/analytics/devguides/reporting/core/dimsmets">Dimensions &amp; Metrics Explorer</a> in what scope.
</p>

<p>
Metrics can be set as KPI's to indicate macro or micro conversions.
</p>
</div>

<div id="outline-container-org9535f4d" class="outline-5">
<h5 id="org9535f4d"><span class="section-number-5">17.4.3.1</span> Custom dimensions and metrics <a id="orge2829c0">ga:custom dimensions</a></h5>
<div class="outline-text-5" id="text-17-4-3-1">
<p>
<a href="https://support.google.com/analytics/answer/2709828">https://support.google.com/analytics/answer/2709828</a>
Custom Dimension can be used as secondary dimension in standard reports but as primary in Custom Reports and can be used as <a href="#orgc4d0243">ga:segment</a>.
Allow you to combine Analytics data with non-Analytics data, e.g. CRM data. For example:
</p>

<ul class="org-ul">
<li>If you store the gender of signed-in users in a CRM system, you could combine this information with your Analytics data to see Pageviews by gender.</li>
<li>If you're a game developer, metrics like "level completions" or "high score" may be more relevant to you than pre-defined metrics like Screenviews. By tracking this data with custom metrics, you can track progress against your most important metrics in flexible and easy-to-read custom reports.</li>
</ul>
<p>
Custom dimensions can appear as primary dimensions in Custom Reports. You can also use them as Segments and secondary dimensions in standard reports.
</p>

<p>
Up to 20 custom dimensions and 20 custom metrics.
</p>
</div>
</div>

<div id="outline-container-orgf5362f3" class="outline-5">
<h5 id="orgf5362f3"><span class="section-number-5">17.4.3.2</span> Calculated Metric</h5>
<div class="outline-text-5" id="text-17-4-3-2">
<p>
Admin &gt; Property &gt; View &gt; Calculated Metrics
</p>
</div>
</div>
</div>

<div id="outline-container-org7c87c81" class="outline-4">
<h4 id="org7c87c81"><span class="section-number-4">17.4.4</span> Bounce</h4>
<div class="outline-text-4" id="text-17-4-4">
<p>
A bounce is counted when there's only one pageview in one user session
</p>
</div>
</div>

<div id="outline-container-org2377d6c" class="outline-4">
<h4 id="org2377d6c"><span class="section-number-4">17.4.5</span> Audience</h4>
<div class="outline-text-4" id="text-17-4-5">
</div>
<div id="outline-container-org950ef1f" class="outline-5">
<h5 id="org950ef1f"><span class="section-number-5">17.4.5.1</span> User, New User, Session</h5>
<div class="outline-text-5" id="text-17-4-5-1">
<p>
Tracking id :: UA-12315-12 (tid) where account id is 12315 
Property id :: UA-12315-12 is the same as the tracking id.
User (cid, client id) :: The total number of users for the requested time period. Long time cookie. Same browser and same device.
</p>

<p>
New User :: The number of users whose session was marked as a first-time session.
</p>

<p>
Sessions :: Short time cookie. Each session from a unique user will get its own incremental index starting from 1 for the first session. Subsequent sessions do not change previous session indices. For example, if a user has 4 sessions to the website, sessionCount for that user will have 4 distinct values of ‘1’ through ‘4’.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Cookie</td>
<td class="org-left">Expiration</td>
<td class="org-left">Description</td>
</tr>

<tr>
<td class="org-left">_ga</td>
<td class="org-left">2 yrs</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">_gid</td>
<td class="org-left">24 hours</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">_gat</td>
<td class="org-left">1 minute</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">AMP_TOKEN</td>
<td class="org-left">30 secs to 1 yr</td>
<td class="org-left">Client ID from AMP Client ID service.</td>
</tr>

<tr>
<td class="org-left">_gac_&lt;property-id&gt;</td>
<td class="org-left">90 days</td>
<td class="org-left">GA is linked with AdWords account, AdWords website conversion tags</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
_ga or _gid cookie example
</p>
<pre class="example">
GA1.2.2033959936.1513880474
2033959936.1513880474 is the client id
</pre>

<p>
By default, gtag.js has automatic cookie domain configuration enabled. When enabled, automatic cookie domain configuration sets the _ga cookie to the highest level domain it can. For example, if your website address is blog.example.co.uk, gtag.js will set the cookie domain to example.co.uk. If gtag.js detects that you're running a server locally (e.g. localhost), it automatically sets the cookie_domain to 'none'.
</p>

<p>
To turn off automatic cookie domain configuration, update the config for your property to specify a value for the cookie_domain parameter:
</p>
<div class="org-src-container">
<pre class="src src-js">gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA_TRACKING_ID'</span>, {
  <span style="color: #e67128;">'cookie_domain'</span>: <span style="color: #e67128;">'blog.example.co.uk'</span>
});
</pre>
</div>

<p>
Cross-domain tracking allows you to see sessions from 2 sites as single session. Also called site linking.
This code will append the linker parameter to any links on the page that point to the target domain 'example.com':
</p>
<div class="org-src-container">
<pre class="src src-js">gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA_TRACKING_ID'</span>, {
  <span style="color: #e67128;">'linker'</span>: {
    <span style="color: #e67128;">'domains'</span>: [<span style="color: #e67128;">'example.com'</span>]
  }
});
</pre>
</div>

<p>
If the destination domain has been configured to automatically link domains, it will accept linker parameters by default.
</p>

<p>
If the destination domain is not configured to automatically link domains, you can instruct the destination page to look for linker parameters by setting the accept_incoming property of the linker parameter to true on the destination property's config:
</p>
<div class="org-src-container">
<pre class="src src-js">gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA_TRACKING_ID'</span>, {
  <span style="color: #e67128;">'linker'</span>: {
    <span style="color: #e67128;">'accept_incoming'</span>: <span style="color: #008b8b;">true</span>
  }
});
</pre>
</div>

<p>
Single snippet on all domains
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #74af68;">// </span><span style="color: #74af68;">on example-1.com</span>
gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA_TRACKING_ID_1'</span>, {
  <span style="color: #e67128;">'linker'</span>: {
    <span style="color: #e67128;">'domains'</span>: [<span style="color: #e67128;">'example-1.com'</span>, <span style="color: #e67128;">'example-2.com'</span>]
  }
});

<span style="color: #74af68;">// </span><span style="color: #74af68;">on example-2.com</span>
gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA_TRACKING_ID_2'</span>, {
  <span style="color: #e67128;">'linker'</span>: {
    <span style="color: #e67128;">'domains'</span>: [<span style="color: #e67128;">'example-1.com'</span>, <span style="color: #e67128;">'example-2.com'</span>]
  }
});
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcd3d9f8" class="outline-5">
<h5 id="orgcd3d9f8"><span class="section-number-5">17.4.5.2</span> Active user</h5>
<div class="outline-text-5" id="text-17-4-5-2">
<p>
Users that initiate session(s) in the last n days. Also called site reach, stickiness.
7-Day Active Users: the number of unique users who initiated sessions on your site or app from January 22 through January 28 (the last 7 days of your date range).
</p>
</div>
</div>

<div id="outline-container-orgc66b741" class="outline-5">
<h5 id="orgc66b741"><span class="section-number-5">17.4.5.3</span> Cohort Analysis</h5>
<div class="outline-text-5" id="text-17-4-5-3">
<p>
Cohort analysis helps you understand the behavior of component groups of users apart from your user population as a whole. Examples of how you can use cohort analysis include to see how the behavior and performance of individual.
</p>

<p>
e.g. Group an audience based on their acquisition date and then compare behavior metrics over a series of weeks
</p>

<p>
Cohort type :: the only option now is Acquisition Date :: the first time a user is recognized as interacting with your content. When selected in the Cohort Analysis report, the cohorts are grouped based on when users started their first sessions.
</p>

<p>
Say metric is Pageviews and Date Range is 7 days. Today's April 12
For users visited the website for the first time on April 12-7 = April 5, they also visit n PageViews on Day 1 the next day April 6.
</p>

<p>
Metric User Retention :: The number of users in the cohort who returned in the Nth time period (day, week, month) divided by the total number of users in the cohort.
</p>

<p>
e.g. 3.02% of the users who visited the website for the first time on April 5, also visit the website on the next day, April 6 (Day 1).
</p>
</div>
</div>

<div id="outline-container-org00b10c7" class="outline-5">
<h5 id="org00b10c7"><span class="section-number-5">17.4.5.4</span> Interests <a id="orgca6e7f1">ga:audience:interests</a></h5>
<div class="outline-text-5" id="text-17-4-5-4">
<dl class="org-dl">
<dt>Affinity</dt><dd>with passion or interests in an area but not necessarily looking to buy</dd>
<dt>In-Market</dt><dd>looking to buy</dd>
<dt>(no term)</dt><dd>Other</dd>
</dl>

<p>
Enable Demographics and Interests Report :: <a href="https://support.google.com/analytics/answer/2819948">https://support.google.com/analytics/answer/2819948</a>
</p>
</div>
</div>

<div id="outline-container-orgaaa1feb" class="outline-5">
<h5 id="orgaaa1feb"><span class="section-number-5">17.4.5.5</span> Audiences</h5>
<div class="outline-text-5" id="text-17-4-5-5">
<p>
This report shows only audiences you create in Analytics. The new audience will have up to 30 days of data and you can use it in 24-48 hours.
</p>
<ul class="org-ul">
<li>At any one time, you can have a maximum of 20 audiences published to Analytics. 2000 audiences per property.</li>
<li>Audiences that are based on custom dimensions that use query-time import mode are not supported. Audience data is evaluated at processing time.</li>
<li>Audiences are available only in the view in which you create them.</li>
</ul>
</div>

<ol class="org-ol">
<li><a id="org18b393e"></a>Create Audience <a id="org41e00d3">ga:audience:create</a><br />
<div class="outline-text-6" id="text-17-4-5-5-1">
<p>
Enable Demographics and Intersts Report <a href="#orgca6e7f1">ga:audience:interests</a>
Basics :: <a href="https://support.google.com/analytics/answer/2611404">https://support.google.com/analytics/answer/2611404</a>
Go to Admin &gt; a property &gt; Audience Definitions &gt; Audiences &gt; New Audience
</p>

<p>
Create an audience is like <a href="#org7c7440b">ga:segment:create</a>
A segment can be imported as an Audience :: <a href="https://support.google.com/analytics/answer/6015314">https://support.google.com/analytics/answer/6015314</a>
</p>

<p>
Refer to <a href="#org811bc47">ga:remarketing</a>
</p>
<dl class="org-dl">
<dt>Remarketing audiences examples</dt><dd><a href="https://support.google.com/analytics/answer/2611820">https://support.google.com/analytics/answer/2611820</a></dd>
<dt>State-based audiences examples</dt><dd><a href="https://support.google.com/analytics/answer/6212382">https://support.google.com/analytics/answer/6212382</a></dd>
</dl>

<p>
AdWords Search Remarketing
</p>
<ul class="org-ul">
<li>requires 1000+ unique users (cookies)</li>
<li>GA's demographics dimensions cannot be used for AdWords Search Remarketing</li>
</ul>

<p>
AdWords Display Remarketing
</p>
<ul class="org-ul">
<li>requires 100+ unique users</li>
</ul>

<p>
Analytics Remarketing Audience vs AdWords Remarketing Tag :: <a href="https://support.google.com/analytics/answer/2611268">https://support.google.com/analytics/answer/2611268</a>
</p>

<p>
Create 2 or more identical audiences and run a different ad campaign for each audience as Analytics assigns each users to one of 100 User Buckets ::
<a href="https://support.google.com/analytics/answer/6155470">https://support.google.com/analytics/answer/6155470</a>
</p>
</div>
</li>

<li><a id="orgb143e30"></a>Preconfig new audience<br />
<div class="outline-text-6" id="text-17-4-5-5-2">
<ul class="org-ul">
<li>Smart List: Let Google manage the audience for you.</li>

<li>All Users: All users to your site or app who already have the necessary advertising cookies or mobile-advertising IDs.</li>

<li>New Users: Any users who have conducted only one session on your site or app.</li>

<li>Returning Users: Any users who have conducted more than one session on your site or app.</li>

<li>Users who visited a specific section of my site/app
<ul class="org-ul">
<li>Click the edit icon, and enter the URL of a page or directory on your site, or a screen in your app. This option uses the contains match type, and matches any URL that contains the string you enter here.</li>
<li>If there are more than 1000 page/screen URLs for your site/app, then Analytics displays matches as you enter text only if matches are found within the first 1000 URLs. If there are no matches in the first 1000 URLs, then Analytics displays nothing. In this case, you can copy and paste the URL from a browser, or from some other source of URLs like a spreadsheet.</li>
</ul></li>

<li>Users who completed a goal conversion: Click the edit icon, and select a goal from the menu. This option requires that you have previously configured Analytics Goals.</li>

<li>Users who completed a transaction: This is already configured to include any user with more than zero transactions.</li>
</ul>
</div>
</li>

<li><a id="org85759f0"></a>Use Audiences<br />
<div class="outline-text-6" id="text-17-4-5-5-3">
<p>
<a href="https://support.google.com/analytics/answer/7280979">https://support.google.com/analytics/answer/7280979</a>
</p>

<p>
After you create an audience and publish it to Analytics, it is available as a primary dimension in the Audience &gt; Audiences report, as a secondary dimension in other reports, and as a dimension in segments, custom reports, and custom funnels.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org07314ae" class="outline-5">
<h5 id="org07314ae"><span class="section-number-5">17.4.5.6</span> User Explorer</h5>
<div class="outline-text-5" id="text-17-4-5-6">
<p>
Instead of aggregating users or user sessions, this shows each user/session's
</p>
<ul class="org-ul">
<li>Sessions</li>
<li>Avg. session Duration</li>
<li>Bounce rate</li>
<li>Revenue</li>
<li>Transactions</li>
<li>Goal Conversion Rate</li>
</ul>
</div>
</div>

<div id="outline-container-org2644152" class="outline-5">
<h5 id="org2644152"><span class="section-number-5">17.4.5.7</span> Benchmarking</h5>
<div class="outline-text-5" id="text-17-4-5-7">
<p>
You can choose from over 1600 industry categories, using a menu in the Benchmarking reports. You can further refine the data by geographic location and select from seven traffic size classifications, allowing you to compare your property against properties with similar traffic levels in your industry. For example, you can compare your property with all properties in the “All Hotels and Accommodations” industry in the United Kingdom that receive 500 to 1000 average daily sessions.
</p>

<p>
Compare in
</p>
<ul class="org-ul">
<li>Channels</li>
<li>Location</li>
<li>Devices</li>
</ul>
</div>
</div>

<div id="outline-container-org15db1a4" class="outline-5">
<h5 id="org15db1a4"><span class="section-number-5">17.4.5.8</span> Users Flow</h5>
<div class="outline-text-5" id="text-17-4-5-8">
<p>
Segment does not work.. To show google/cpc, change the first dimension item from Country to Source/Medium = google/cpc
</p>
</div>
</div>
</div>

<div id="outline-container-org7fcf32e" class="outline-4">
<h4 id="org7fcf32e"><span class="section-number-4">17.4.6</span> Acquisition <a id="org053e7c6">ga:channel</a></h4>
<div class="outline-text-4" id="text-17-4-6">
<p>
Channel is the traffic source :: organic search, direct, referral, social, cpc, email, display.
</p>

<p>
You can change the Default Channel Grouping :: Admin &gt; Property &gt; View &gt; Channel Settings &gt; Channel Grouping &gt; Default Channel Grouping
Or add a custom channel grouping :: Admin &gt; Property &gt; View &gt; Custom Channel Grouping
</p>
<pre class="example">
You want to define a channel to include traffic from a campaign containing the term January (e.g., January1, 2ndJanuary, January). Instead of specifying the rule as January (which will only return January), enter it as .*January.* 
</pre>

<p>
Medium is more like channels, and source provides more specific about the medium.
</p>

<p>
Source: Every referral to a web site has an origin, or source. Possible sources include: “google” (the name of a search engine), “facebook.com” (the name of a referring site), “spring_newsletter” (the name of one of your newsletters), and “direct” (users that typed your URL directly into their browser, or who had bookmarked your site).
</p>

<p>
Medium: Every referral to a website also has a medium. Possible medium include: “organic” (unpaid search), “cpc” (cost per click, i.e. paid search), “referral” (referral), “email” (the name of a custom medium you have created), “none” (direct traffic has a medium of “none”).
</p>

<p>
Keyword: When SSL search is employed, Keyword will have the value (not provided).
</p>

<p>
Campaign is the name of the referring AdWords campaign or a custom campaign that you have created.
</p>

<p>
Content (Ad Content) :: a specific link or content item in a custom campaign. For example, if you have two call-to-action links within the same email message, you can use different Content values to differentiate them so that you can tell which version is most effective. AdWords Ad or extension name.
</p>

<p>
Term :: search keywords
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Email campaign</td>
<td class="org-left">Paid search campaign</td>
</tr>

<tr>
<td class="org-left">Campaign Source</td>
<td class="org-left">newsletter1</td>
<td class="org-left">yahoo</td>
</tr>

<tr>
<td class="org-left">Campaign Medium</td>
<td class="org-left">email</td>
<td class="org-left">cpc</td>
</tr>

<tr>
<td class="org-left">Campaign Term</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">the search term associated with this traffic</td>
</tr>

<tr>
<td class="org-left">Campaign Content</td>
<td class="org-left">call_to_action_2</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Campaign Name</td>
<td class="org-left">productxyz</td>
<td class="org-left">productxyz</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Naming is case sensitive and spaces are converted to _
</p>

<p>
Use source/medium google/cpc to have AdWords Search and Display Networks.
To distinguish Paid Search and Display, use Default Channel Grouping
To distinguish Google Search and Search Partners, use Ad Distribution Network.
</p>

<p>
Once AdWords account(s) is linked to GA, you can see relevant reports in Acquisition &gt; AdWords
<a href="#orgf1f264a">ga:dimensions</a>
</p>
<ul class="org-ul">
<li>Accounts, Campaigns, Treemaps, Bid Adjustment, Keywords, Search Queries, Hour of Day, Destination URLs, Display Targeting, Video Campaigns, Shopping Campaigns</li>
</ul>

<p>
<a href="#org8b29e5b">ga:metrics</a>
</p>
<ul class="org-ul">
<li>Acquisition
<ul class="org-ul">
<li>Clicks, Cost, CPC, Users</li>
</ul></li>
<li>Behavior
<ul class="org-ul">
<li>Bounce Rate, Pages/Session</li>
</ul></li>
<li>Conversion by each goal
<ul class="org-ul">
<li>Conversion rate, Transactions, Revenue</li>
</ul></li>
</ul>

<p>
For some dimension, you can filter by Device type on the top.
</p>
</div>
</div>

<div id="outline-container-org0ee58ce" class="outline-4">
<h4 id="org0ee58ce"><span class="section-number-4">17.4.7</span> Behavior</h4>
<div class="outline-text-4" id="text-17-4-7">
<p>
How users navigate between pages
content :: Speed, Search, Events
</p>
</div>

<div id="outline-container-org800f833" class="outline-5">
<h5 id="org800f833"><span class="section-number-5">17.4.7.1</span> Content Grouping</h5>
<div class="outline-text-5" id="text-17-4-7-1">
<p>
Admin &gt; Property &gt; View &gt; Content Grouping
</p>

<p>
e.g. Webpages have
Men
</p>
<ul class="org-ul">
<li>Shirts</li>
<li>Pants</li>
<li>Accessories</li>
</ul>

<p>
Women
</p>
<ul class="org-ul">
<li>Tops</li>
<li>Slacks</li>
<li>Skirts &amp; Dresses</li>
<li>Accessories</li>
</ul>

<p>
Clothing, Men, and Women are options in the Primary Dimension &gt; Content Grouping menu.
When you select Clothing as the primary dimension, Men and Women are the dimension values in the first column of the report table.
When you select Men as the primary dimension, Shirts, Pants, and Accessories are the dimension values in the first column of the table.
For each dimension value (Content Group), you see behavioral metrics like Pageviews and Bounce Rate.
</p>

<div class="org-src-container">
<pre class="src src-js">&#8203;gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA_TRACKING_NUMBER'</span>, {
  <span style="color: #e67128;">'content_group&lt;Index Number&gt;'</span>: <span style="color: #e67128;">'&lt;Group Name&gt;'</span>
}
<span style="color: #74af68;">// </span><span style="color: #74af68;">example</span>

&#8203;gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA_TRACKING_NUMBER'</span>, {
  <span style="color: #e67128;">'content_group1'</span>: <span style="color: #e67128;">'shoes'</span>
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf6673bc" class="outline-5">
<h5 id="orgf6673bc"><span class="section-number-5">17.4.7.2</span> Behavior Flow</h5>
<div class="outline-text-5" id="text-17-4-7-2">
<p>
Change the dimension (green box on the left) to Campaign to show AdWords campaign(s) behavior flow.
</p>
</div>
</div>
</div>

<div id="outline-container-org8938d26" class="outline-4">
<h4 id="org8938d26"><span class="section-number-4">17.4.8</span> Conversions</h4>
<div class="outline-text-4" id="text-17-4-8">
<p>
Goals, Ecommerce, Multi-Channel Funnels, Attribution
</p>
</div>

<ol class="org-ol">
<li><a id="org2319ea8"></a>Multi-Channel Funnels<br />
<div class="outline-text-6" id="text-17-4-8-0-1">
<p>
Assisted Conversions
What are the sources contribution in terms of:
</p>
<dl class="org-dl">
<dt>Last interaction</dt><dd>the interaction that immediately precedes the conversion.</dd>
<dt>Assist interaction</dt><dd>any interaction that is on the conversion path but is not the last interaction.</dd>
<dt>First interaction</dt><dd>the first interaction on the conversion path; it's a kind of assist interaction.</dd>
</dl>

<p>
Time Lag :: how many days a conversion is made
</p>

<p>
Top Conversion Paths :: what sources were went through before a conversion is made
</p>

<p>
Path length :: how many interactions took before a conversion is made.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgc3e8c55" class="outline-4">
<h4 id="orgc3e8c55"><span class="section-number-4">17.4.9</span> Add Google Search Console to a property</h4>
<div class="outline-text-4" id="text-17-4-9">
<p>
There will be a new section in the report called Acquisition &gt; Search Console
Need to go back to Search Console to see keywords report
GA shows keyword only for non-google-logged-in users that use google to search
<a id="orgfc93f50">google:ga:search console</a>
</p>
</div>
</div>

<div id="outline-container-org1689160" class="outline-4">
<h4 id="org1689160"><span class="section-number-4">17.4.10</span> Campaigns and Goals track across user session</h4>
</div>
<div id="outline-container-orgda217f0" class="outline-4">
<h4 id="orgda217f0"><span class="section-number-4">17.4.11</span> Goal vs Event</h4>
<div class="outline-text-4" id="text-17-4-11">
<p>
<a href="http://www.metricmogul.co.uk/5-simple-differences-between-goals-and-events-in-google-analytics-and-when-to-use-them/">http://www.metricmogul.co.uk/5-simple-differences-between-goals-and-events-in-google-analytics-and-when-to-use-them/</a>
</p>

<p>
<a id="orgabfefe8">ga:goal</a>
</p>
<ul class="org-ul">
<li>A goal provides additional data such as conversion rate in Acquisition reports</li>
<li>A goal will only record once per session. Newsletter sign up twice with 2 emails, only one conversion is recorded.</li>
<li>An event can be anything. A goal has to be a destination, duration, pages per session or based on an event.</li>
<li>A goal can be based on an event.</li>
<li>Goal flow report.</li>
<li>Up to 20 goals per View.</li>
</ul>

<p>
Types of a Goal
</p>
<dl class="org-dl">
<dt>Desitnation</dt><dd>the only type that is possible to track funnels</dd>
<dt>Duration</dt><dd>Sessions that last a specific amount of time or longer</dd>
<dt>(no term)</dt><dd>Pages/Screens per session</dd>
<dt>Event</dt><dd>multiple events in one session but event goal is counted as one</dd>
<dt>(no term)</dt><dd>Smart Goal</dd>
</dl>

<p>
<a href="https://support.google.com/analytics/answer/1116091#matchTypes">Destination Goal match types: begin with, equal to &amp; RegEx</a>
</p>

<p>
A conversion is counted once per session per goal.
</p>

<p>
Events are good for
</p>
<ul class="org-ul">
<li>Downloaded file (shows which pages have the pdf file link)</li>
<li>Link (outbound)</li>
</ul>

<p>
The first 10 event hits sent to Analytics are tracked immediately, thereafter tracking is rate limited to one event hit per second.
</p>

<p>
It's better to setup events and setup goals as the event goal type.
</p>
</div>
</div>

<div id="outline-container-org4f79695" class="outline-4">
<h4 id="org4f79695"><span class="section-number-4">17.4.12</span> Segment <a id="orgc4d0243">ga:segment</a></h4>
<div class="outline-text-4" id="text-17-4-12">
<p>
A Segment is to filter out the <code>user sessions</code> that you don't want without destroying your View data.
</p>

<p>
Segment occurs after sampling in Property for GA Standard.
</p>

<p>
Say you have 2 segments: All Users and New Users. Metrics inside each type of report will be divided into 2 so that you can compare.
</p>

<p>
Say you want to use Segment to only include user sessions that have been to a url.
Go to the newly created Segment, you will still see those user sessions have been to other pages.
</p>

<p>
Ideas :: <a href="https://searchenginewatch.com/sew/how-to/2268458/16-secret-google-analytics-advanced-segments-worth-their-weight-in-gold">https://searchenginewatch.com/sew/how-to/2268458/16-secret-google-analytics-advanced-segments-worth-their-weight-in-gold</a>
</p>
</div>

<div id="outline-container-org2a06c02" class="outline-5">
<h5 id="org2a06c02"><span class="section-number-5">17.4.12.1</span> Converter segment <a id="orgee48dad">ga:segment:converter</a></h5>
<div class="outline-text-5" id="text-17-4-12-1">
<p>
Refer to <a href="#orgabfefe8">ga:goal</a>
</p>

<p>
Include user sessions that have finished a goal. You can copy this system goal and make it your own e.g. finish a specific goal
</p>

<p>
Some stats you may find is that people who convert have lower bounce rate, higher pages/session, higher avg. session duration.
</p>
</div>
</div>

<div id="outline-container-org694d6a3" class="outline-5">
<h5 id="org694d6a3"><span class="section-number-5">17.4.12.2</span> Custom segment - AdWords Search <a id="orga1e5e6b">adwords:segment:search</a></h5>
<div class="outline-text-5" id="text-17-4-12-2">
<p>
Users Include Source/Medium = google/cpc AND Default Channel Grouping = Paid Search
</p>
</div>
</div>

<div id="outline-container-org59fd01d" class="outline-5">
<h5 id="org59fd01d"><span class="section-number-5">17.4.12.3</span> Create a segment <a id="org7c7440b">ga:segment:create</a></h5>
<div class="outline-text-5" id="text-17-4-12-3">
<p>
Refer to <a href="#org41e00d3">ga:audience:create</a>
<a href="https://support.google.com/analytics/answer/3124493">https://support.google.com/analytics/answer/3124493</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org3b644a7" class="outline-4">
<h4 id="org3b644a7"><span class="section-number-4">17.4.13</span> Tracking Code :: gtag.js, analytics.js</h4>
<div class="outline-text-4" id="text-17-4-13">
<p>
The most recent version is gtag.js (Global site tag). <a href="https://developers.google.com/analytics/devguides/collection/gtagjs/">Documentation</a>. <a href="https://developers.google.com/analytics/devguides/collection/gtagjs/migration">Migrate from analytics.js to gtag.js</a>.
Previous version
</p>
<ul class="org-ul">
<li>analytics.js (Universal). <a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/">Documentation is here.</a> <a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/command-queue-reference">ga commands, objects, fields reference</a></li>
</ul>
</div>

<div id="outline-container-orgb1f994b" class="outline-5">
<h5 id="orgb1f994b"><span class="section-number-5">17.4.13.1</span> Custom parameters for dynamic remarketing <a id="org4849cd6">ga:dynamic remarketing</a></h5>
<div class="outline-text-5" id="text-17-4-13-1">
<p>
<a href="https://support.google.com/adwords/answer/3103357">https://support.google.com/adwords/answer/3103357</a>
</p>

<div class="org-src-container">
<pre class="src src-html"><span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">Global Site Tag (gtag.js) - Google AdWords: 123456789 </span><span style="color: #74af68;">--&gt;</span>
&lt;<span style="color: #00ede1; font-weight: bold;">script</span> async <span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"https://www.googletagmanager.com/gtag/js?id=AW-123456789"</span>&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'AW-123456789');
&lt;/<span style="color: #00ede1; font-weight: bold;">script</span>&gt;

<span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">Event snippet for Example dynamic remarketing page </span><span style="color: #74af68;">--&gt;</span>
&lt;<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
  gtag('event', 'page_view', {'send_to': 'AW-123456789',
   'ecomm_prodid': 'REPLACE_WITH_STRING_VALUE',
   'ecomm_pagetype': 'REPLACE_WITH_STRING_VALUE',
   'ecomm_totalvalue': 'REPLACE_WITH_STRING_VALUE'
  });
&lt;/<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
</pre>
</div>

<p>
Have to use certain parameters for certain business type. <a href="https://support.google.com/adwords/answer/7305793">Here're the list of parameters</a>.
</p>

<p>
First, setup Custom Dimensions based on business type. <a href="https://support.google.com/analytics/answer/3455600">https://support.google.com/analytics/answer/3455600</a>
</p>

<p>
Next, implement tags like the above on the website
</p>

<p>
Then setup these Dynamic Attributes in GA &gt; Admin &gt; Property &gt; Audience Definitions &gt; Dynamic Attributes. This step also shares the attributes with AdWords accounts.
<a href="https://support.google.com/analytics/answer/6002231">https://support.google.com/analytics/answer/6002231</a>
</p>

<p>
Then you can setup Dynamic Remarketing on AdWords
</p>

<p>
Maximum duration that a user can be included in a remarketing audience is 540 days.
</p>
</div>
</div>

<div id="outline-container-orgd158de1" class="outline-5">
<h5 id="orgd158de1"><span class="section-number-5">17.4.13.2</span> Send to multiple property id's</h5>
<div class="outline-text-5" id="text-17-4-13-2">
<div class="org-src-container">
<pre class="src src-js">ga(<span style="color: #e67128;">'create'</span>, <span style="color: #e67128;">'UA-XXXXX-Y'</span>, <span style="color: #e67128;">'auto'</span>);
ga(<span style="color: #e67128;">'create'</span>, <span style="color: #e67128;">'UA-XXXXX-Z'</span>, <span style="color: #e67128;">'auto'</span>, <span style="color: #e67128;">'clientTracker'</span>);

ga(<span style="color: #e67128;">'send'</span>, <span style="color: #e67128;">'pageview'</span>);
ga(<span style="color: #e67128;">'clientTracker.send'</span>, <span style="color: #e67128;">'pageview'</span>);
</pre>
</div>

<p>
gtag.js
</p>
<div class="org-src-container">
<pre class="src src-js">gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA-TRACKING_ID-1'</span>, { <span style="color: #e67128;">'groups'</span>: <span style="color: #e67128;">'group1'</span> });
gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA-TRACKING_ID-2'</span>, { <span style="color: #e67128;">'groups'</span>: <span style="color: #e67128;">'group1'</span> });

<span style="color: #74af68;">// </span><span style="color: #74af68;">Routes to 'GA-TRACKING_ID-1' and 'GA-TRACKING_ID-2'</span>
gtag(<span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'sign_in'</span>, { <span style="color: #e67128;">'send_to'</span>: <span style="color: #e67128;">'group1'</span> });

<span style="color: #74af68;">// </span><span style="color: #74af68;">The following two lines are equivalent:</span>
gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA-TRACKING_ID-1'</span>);
gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA-TRACKING_ID-1'</span>, { <span style="color: #e67128;">'groups'</span>: <span style="color: #e67128;">'default'</span> });
</pre>
</div>

<p>
Full example :: send to a specific property instead of groups
</p>
<div class="org-src-container">
<pre class="src src-js">&lt;script <span style="color: #ffad29; font-weight: bold;">async</span> src=<span style="color: #e67128;">"https://www.googletagmanager.com/gtag/js?id=GA-TRACKING_ID-1"</span>&gt;
&lt;/script&gt;
&lt;script&gt;
  window.dataLayer = window.dataLayer || [];
  <span style="color: #ffad29; font-weight: bold;">function</span> <span style="color: #00ede1; font-weight: bold;">gtag</span>(){dataLayer.push(<span style="color: #008b8b;">arguments</span>);}
  gtag(<span style="color: #e67128;">'js'</span>, <span style="color: #ffad29; font-weight: bold;">new</span> <span style="color: #34cae2;">Date</span>());

  <span style="color: #74af68;">// </span><span style="color: #74af68;">Global configs</span>
  gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA-TRACKING_ID-1'</span>);
  gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'AW-CONVERSION_ID'</span>);
  gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'DC-FLOODLIGHT_ID'</span>);

  <span style="color: #74af68;">// </span><span style="color: #74af68;">Track AdWords conversions</span>
  gtag(<span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'conversion'</span>, {
      <span style="color: #e67128;">'send_to'</span>: <span style="color: #e67128;">'AW-CONVERSION_ID/AbC-D_efG-h12_34-567'</span>,
      <span style="color: #e67128;">'value'</span>: 1.0,
      <span style="color: #e67128;">'currency'</span>: <span style="color: #e67128;">'USD'</span>
  });

  <span style="color: #74af68;">// </span><span style="color: #74af68;">Track Floodlight conversions</span>
  gtag(<span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'conversion'</span>, {
    <span style="color: #e67128;">'allow_custom_scripts'</span>: <span style="color: #008b8b;">true</span>,
    <span style="color: #e67128;">'send_to'</span>: <span style="color: #e67128;">'DC-FLOODLIGHT_ID/actions/locat304+standard'</span>
  });

  <span style="color: #74af68;">// </span><span style="color: #74af68;">route ecommerce add_to_cart event to AdWords and Analytics</span>
  gtag(<span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'add_to_cart'</span>, {
    <span style="color: #e67128;">'send_to'</span>: [
      <span style="color: #e67128;">'GA-TRACKING_ID-1'</span>,
      <span style="color: #e67128;">'AW-CONVERSION_ID'</span>
    ],
    <span style="color: #e67128;">'items'</span>: [
      <span style="color: #e67128;">'id'</span>: <span style="color: #e67128;">'U1234'</span>,
      <span style="color: #e67128;">'ecomm_prodid'</span>: <span style="color: #e67128;">'U1234'</span>,
      <span style="color: #e67128;">'name'</span>: <span style="color: #e67128;">'Argyle Funky Winklepickers'</span>,
      <span style="color: #e67128;">'list'</span>: <span style="color: #e67128;">'Search Results'</span>,
      <span style="color: #e67128;">'category'</span>: <span style="color: #e67128;">'Footwear'</span>,
      <span style="color: #e67128;">'quantity'</span>: 1,
      <span style="color: #e67128;">'ecomm_totalvalue'</span>: 123.45,
      <span style="color: #e67128;">'price'</span>: 123.45
    ]
  });
&lt;/script&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdfb24dd" class="outline-5">
<h5 id="orgdfb24dd"><span class="section-number-5">17.4.13.3</span> ga Command Queue and Object Methods</h5>
<div class="outline-text-5" id="text-17-4-13-3">
<p>
<a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/tracking-snippet-reference">https://developers.google.com/analytics/devguides/collection/analyticsjs/tracking-snippet-reference</a>
</p>

<div class="org-src-container">
<pre class="src src-html"><span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">Google Analytics </span><span style="color: #74af68;">--&gt;</span>
&lt;<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-XXXXX-Y', 'auto'); // create a tracker instance
ga('send', 'pageview');
&lt;/<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
<span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">End Google Analytics </span><span style="color: #74af68;">--&gt;</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-js">ga(<span style="color: #e67128;">'command_name'</span>, ...); <span style="color: #74af68;">// </span><span style="color: #74af68;">this is called command queue. Command can be a tracker method, a ga Object Method, or a method that is defined in a plugin</span>

<span style="color: #74af68;">// </span><span style="color: #74af68;">Use a ready callback to call a ga Object Method</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">ga.getAll() // wrong</span>
ga(<span style="color: #ffad29; font-weight: bold;">function</span>(<span style="color: #dbdb95;">tracker</span>) {
  <span style="color: #ffad29; font-weight: bold;">var</span> <span style="color: #dbdb95;">trackers</span> = ga.getAll();
});
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb5ba662" class="outline-5">
<h5 id="orgb5ba662"><span class="section-number-5">17.4.13.4</span> ga Command Queue</h5>
<div class="outline-text-5" id="text-17-4-13-4">
<p>
Add a command to the queue :: ga(command, [&#x2026;fields], [fieldsObject])
</p>
<dl class="org-dl">
<dt>command</dt><dd><ul class="org-ul">
<li>[trackerName.][pluginName:]methodName</li>
<li>The name of the method to be scheduled for execution. When not specifying a plugin name, this method must be one of the command methods listed below.</li>
</ul></dd>
<dt>&#x2026;fields</dt><dd>One or more optional convenience parameters for quickly specifying common fields.</dd>
<dt>fieldsObject</dt><dd>An object for specifying any remaining values not specified in any of the fields parameters.</dd>
</dl>

<p>
Commands
</p>
<dl class="org-dl">
<dt>create</dt><dd>create a tracker instance. same as ga Object Method create</dd>
<dt>remove</dt><dd>remove a tracker instance. same as ga Object Method remove</dd>
<dt>send</dt><dd>same as <a href="#orgb0c4f93">ga:tracker:send</a> <a id="orgdee0bca">ga:ga:send</a></dd>
<dt>set</dt><dd>set a field on a tracker object. Same as <a href="#org68cbfd8">ga:tracker:set</a></dd>
<dt>require</dt><dd>require an analytics.js plugin</dd>
<dt>provide</dt><dd>provide an analytics.js plugin and its methods for use with the ga() command queue. Add command</dd>
</dl>
</div>
</div>

<div id="outline-container-orgd8900c8" class="outline-5">
<h5 id="orgd8900c8"><span class="section-number-5">17.4.13.5</span> ga Object Method</h5>
<div class="outline-text-5" id="text-17-4-13-5">
<p>
create :: create a tracker instance
getByName :: get a tracker instance by name
getAll :: get all tracker instances
remove :: remove a tracker instance
</p>
</div>
</div>
</div>

<div id="outline-container-org73c5bae" class="outline-4">
<h4 id="org73c5bae"><span class="section-number-4">17.4.14</span> Tracker Object Methods</h4>
<div class="outline-text-4" id="text-17-4-14">
<p>
get :: get the value of a field stored on the tracker <a id="orgf620a13">ga:tracker:get</a>
set :: set a field value on the tracker <a id="org68cbfd8">ga:tracker:set</a>
send :: send a hit to Google Analytics. Same as <a href="#orgdee0bca">ga:ga:send</a>
</p>
</div>

<div id="outline-container-org6a34a99" class="outline-5">
<h5 id="org6a34a99"><span class="section-number-5">17.4.14.1</span> set</h5>
<div class="outline-text-5" id="text-17-4-14-1">
<p>
When a tracker's field is set, tracker will use that as default for all following actions/commands/methods e.g. send a hit. Use custom variable to subsitute into each action's required parameters instead of overwrite a tracker's field.
</p>
</div>
</div>

<div id="outline-container-org396a30f" class="outline-5">
<h5 id="org396a30f"><span class="section-number-5">17.4.14.2</span> send <a id="orgb0c4f93">ga:tracker:send</a></h5>
<div class="outline-text-5" id="text-17-4-14-2">
<p>
tracker.send([hitType], [&#x2026;fields], [fieldsObject]);
ga('[trackerName.]send', [hitType], [&#x2026;fields], [fieldsObject]);
</p>

<p>
Used in <a href="#org129a65f">ga:goal and funnel</a>
Use <a href="#org1ae8443">ga:fieldsObject</a>
</p>

<p>
hitType :: 
</p>
<dl class="org-dl">
<dt>pageview</dt><dd><a href="#org084028e">ga:fieldsObject:page</a></dd>
<dt>event</dt><dd></dd>

<dt>social</dt><dd></dd>

<dt>timing</dt><dd></dd>
</dl>
</div>

<ol class="org-ol">
<li><a id="orgdf72f52"></a>Send pageview - Page Tracking<br />
<div class="outline-text-6" id="text-17-4-14-2-1">
<p>
<a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/pages">https://developers.google.com/analytics/devguides/collection/analyticsjs/pages</a>
ga('send', 'pageview', [page], [fieldsObject]);
</p>

<p>
Pageview fields (tracker object fields)
</p>
<dl class="org-dl">
<dt>title</dt><dd>It's set to document.title when tracker is created</dd>
<dt>location</dt><dd>either location or the page is required. It's set to document.location when tracker is created
<ul class="org-ul">
<li>The anchor portion is ignored. Including campaign parameters in anchor but they're processed in a special way</li>
</ul></dd>
<dt>page</dt><dd>default is not set. If set, location field gets overwritten when send method is run but tracker's location field is still not modified. <a href="#org084028e">ga:fieldsObject:page</a></dd>
</dl>

<p>
Always define tracker.page which is only used in send method. Don't modify location of document.location. Or you can use self define page variable and pass it to send method without changing tracker.page which will always be used in send method.
</p>

<p>
For SPA, you can use a plugin to track complex pageviews :: <a href="https://github.com/googleanalytics/autotrack">https://github.com/googleanalytics/autotrack</a>
</p>

<div class="org-src-container">
<pre class="src src-js">ga(<span style="color: #e67128;">'send'</span>, <span style="color: #e67128;">'pageview'</span>);

ga(<span style="color: #e67128;">'send'</span>, {
  hitType: <span style="color: #e67128;">'pageview'</span>,
  page: location.pathname
});

ga(<span style="color: #ffad29; font-weight: bold;">function</span>(<span style="color: #dbdb95;">tracker</span>) {
  <span style="color: #74af68;">// </span><span style="color: #74af68;">Sets the page field to "/about.html".</span>
  tracker.set(<span style="color: #e67128;">'page'</span>, <span style="color: #e67128;">'/about.html'</span>);
});

<span style="color: #74af68;">// </span><span style="color: #74af68;">normalize /user/USER_ID/profile, /user/USER_ID/account, /user/USER_ID/notifications with thousands of USER_ID</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">to </span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">/user/profile, /user/account, /user/notifications</span>
<span style="color: #ffad29; font-weight: bold;">if</span> (document.location.pathname.indexOf(<span style="color: #e67128;">'user/'</span> + userID) &gt; -1) {
  <span style="color: #ffad29; font-weight: bold;">var</span> <span style="color: #dbdb95;">page</span> = document.location.pathname.replace(<span style="color: #e67128;">'user/'</span> + userID, <span style="color: #e67128;">'user'</span>);
  ga(<span style="color: #e67128;">'send'</span>, <span style="color: #e67128;">'pageview'</span>, page);
}

ga(<span style="color: #ffad29; font-weight: bold;">function</span>(<span style="color: #dbdb95;">tracker</span>) {
  <span style="color: #74af68;">// </span><span style="color: #74af68;">Sends an event hit for the tracker named "myTracker" with the</span>
  <span style="color: #74af68;">// </span><span style="color: #74af68;">following category, action, and label, and sets the nonInteraction</span>
  <span style="color: #74af68;">// </span><span style="color: #74af68;">field value to true.</span>
  tracker.send(<span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'link'</span>, <span style="color: #e67128;">'click'</span>, <span style="color: #e67128;">'http://example.com'</span>, {
    nonInteraction: <span style="color: #008b8b;">true</span>
  });
});
</pre>
</div>
</div>
</li>

<li><a id="org5e6ff0c"></a>Funnel and Goal (send pageview) <a id="org129a65f">ga:goal and funnel</a><br />
<div class="outline-text-6" id="text-17-4-14-2-2">
<p>
Goal is defined in Admin &gt; Account &gt; Property &gt; View
Funnel is step to a Goal.
</p>

<p>
Goal or funnel must use the pageview hitType.
</p>

<p>
When path is very dynamic, you may need to send pageview with a static path in order to capture goal or funnel destination URL.
</p>

<p>
And you may need to filter out those destination URL's in another GA View. Don't filter the current GA View.
</p>

<p>
View the Virtual Pageview in Reporting &gt; Real-Time &gt; Content
View the converted goal in real time Reporting &gt; Real-Time &gt; Conversions
</p>

<pre class="example">
ga('send', 'pageview', '/ga_goal/goal1/goal1_variant1.html');
ga('send', 'pageview', '/ga_goal/goal1/goal1_variant2.html');
ga('send', 'pageview', '/ga_goal/goal1/step1/goal1_variant1.html');
ga('send', 'pageview', '/ga_goal/goal1/step2/goal1_variant1.html');
...

gtag('config', 'GA_TRACKING_ID', {
  'page_title' : 'homepage',
  'page_path': '/ga_goal/goal1/goal1_variant1.html'
});
</pre>
</div>
</li>

<li><a id="org82a978b"></a>Send Event - play, call, scroll<br />
<div class="outline-text-6" id="text-17-4-14-2-3">
<p>
Reporting &gt; Behavior &gt; Events
Category &gt; Action &gt; Label &gt; Value
</p>

<p>
Syntax: 
<code>gtag('event', eventName, eventParameters);</code>
<code>ga('send', 'event', [eventCategory], [eventAction], [eventLabel], [eventValue], [fieldsObject]);</code>
</p>

<dl class="org-dl">
<dt><code>eventName</code></dt><dd>same as <code>eventAction</code></dd>
</dl>

<div class="org-src-container">
<pre class="src src-js">gtag(<span style="color: #e67128;">'event'</span>, &lt;action&gt;, {
  <span style="color: #e67128;">'event_category'</span>: &lt;category&gt;,
  <span style="color: #e67128;">'event_label'</span>: &lt;label&gt;,
  <span style="color: #e67128;">'value'</span>: &lt;value&gt;
});

gtag(<span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'play'</span>, {
  <span style="color: #e67128;">'event_category'</span>: <span style="color: #e67128;">'Videos'</span>,
  <span style="color: #e67128;">'event_label'</span>: <span style="color: #e67128;">'Fall Campaign'</span>
});

$(<span style="color: #e67128;">"a[href^='tel:+18881234567']"</span>).click(<span style="color: #ffad29; font-weight: bold;">function</span>(<span style="color: #dbdb95;">event</span>){
    gtag(<span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'click'</span>, {
      <span style="color: #e67128;">'event_category'</span>: <span style="color: #e67128;">'phone call'</span>,
      <span style="color: #e67128;">'event_label'</span>: <span style="color: #e67128;">'1 (888) 123-4567'</span>,
      <span style="color: #e67128;">'value'</span>: 100
    })
});

$(<span style="color: #e67128;">"a[href^='tel:']"</span>).click(<span style="color: #ffad29; font-weight: bold;">function</span>(<span style="color: #dbdb95;">event</span>){
      <span style="color: #ffad29; font-weight: bold;">var</span> <span style="color: #dbdb95;">$target</span>=$(event.target);
      <span style="color: #74af68;">//</span><span style="color: #74af68;">console.log($target.attr('href'));</span>
      gtag(<span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'click'</span>, {
        <span style="color: #e67128;">'event_category'</span>: <span style="color: #e67128;">'Call from website'</span>,
        <span style="color: #e67128;">'event_label'</span>: $target.attr(<span style="color: #e67128;">'href'</span>),
        <span style="color: #e67128;">'value'</span>: <span style="color: #e67128;">'100'</span>
      });
});
</pre>
</div>

<dl class="org-dl">
<dt><code>&lt;category&gt;</code></dt><dd>the string that appears as the event category</dd>
<dt><code>&lt;action&gt;</code></dt><dd>the string that appears as the event action in Google Analytics Event reports</dd>
<dt><code>&lt;label&gt;</code></dt><dd>the string that appears as the event label</dd>
<dt><code>&lt;value&gt;</code></dt><dd>a non-negative integer that appears as the event value. Usually monetary value</dd>
</dl>

<p>
<a href="https://developers.google.com/analytics/devguides/collection/gtagjs/events">https://developers.google.com/analytics/devguides/collection/gtagjs/events</a>
<a href="https://support.google.com/analytics/answer/1033068#Anatomy">https://support.google.com/analytics/answer/1033068#Anatomy</a>
</p>

<p>
By default, the event hit is considered an interaction hit, which means that it is included in bounce rate calculations.
</p>

<p>
If the event is set to non_interaction true, then the event is not a hit.
</p>

<div class="org-src-container">
<pre class="src src-js">gtag(<span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'video_auto_play_start'</span>, {
  <span style="color: #e67128;">'event_label'</span>: <span style="color: #e67128;">'My promotional video'</span>,
  <span style="color: #e67128;">'event_category'</span>: <span style="color: #e67128;">'video_auto_play'</span>,
  <span style="color: #e67128;">'non_interaction'</span>: <span style="color: #008b8b;">true</span>
});
</pre>
</div>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #74af68;">// </span><span style="color: #74af68;">scroll depth compared to the root element</span>
<span style="color: #ffad29; font-weight: bold;">var</span> <span style="color: #dbdb95;">element_to_track</span> = <span style="color: #e67128;">'html'</span>;
<span style="color: #ffad29; font-weight: bold;">var</span> <span style="color: #dbdb95;">scroll_reach</span> = 0;
<span style="color: #ffad29; font-weight: bold;">var</span> <span style="color: #dbdb95;">temp_scroll_reach</span> = 0;
<span style="color: #ffad29; font-weight: bold;">var</span> <span style="color: #dbdb95;">scroll_reach_pixels</span> = 0;
<span style="color: #ffad29; font-weight: bold;">var</span> <span style="color: #dbdb95;">temp_scroll_reach_pixels</span> = 0;

$(window).scroll(<span style="color: #ffad29; font-weight: bold;">function</span>(){
  temp_scroll_reach = Math.floor(
    100 *
    ( $(window).scrollTop() + $(window).height() - $(element_to_track).position().top)
    / $(element_to_track).height()
  );
  temp_scroll_reach_pixels =
    Math.floor($(window).scrollTop() + $(window).height());
  <span style="color: #ffad29; font-weight: bold;">if</span>(temp_scroll_reach &gt; scroll_reach){
    scroll_reach = temp_scroll_reach;
    scroll_reach_pixels = temp_scroll_reach_pixels;
  }
});

<span style="color: #ffad29; font-weight: bold;">function</span> <span style="color: #00ede1; font-weight: bold;">sendGAreq</span>() {
  <span style="color: #74af68;">// </span><span style="color: #74af68;">Old ga.js</span>
  <span style="color: #74af68;">// </span><span style="color: #74af68;">_trackEvent(category, action, opt_label, opt_value, opt_noninteraction)</span>
  <span style="color: #74af68;">//</span><span style="color: #74af68;">_gaq.push(['_trackEvent', 'Scroll Depth', 'Percentage', '', scroll_reach]);</span>
  <span style="color: #74af68;">//</span><span style="color: #74af68;">_gaq.push(['_trackEvent', 'Scroll Depth', 'Pixels', '', scroll_reach_pixels]);</span>
  <span style="color: #74af68;">// </span><span style="color: #74af68;">New analytics.js</span>
  <span style="color: #74af68;">// </span><span style="color: #74af68;">ga('send', 'event', [eventCategory], [eventAction], [eventLabel], [eventValue], [fieldsObject]);</span>
  ga(<span style="color: #e67128;">'send'</span>, <span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'Scroll Depth'</span>, <span style="color: #e67128;">'Percentage'</span>, <span style="color: #e67128;">''</span>, scroll_reach);
  ga(<span style="color: #e67128;">'send'</span>, <span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'Scroll Depth'</span>, <span style="color: #e67128;">'Pixels'</span>, <span style="color: #e67128;">''</span>, scroll_reach);
}

<span style="color: #74af68;">/* </span><span style="color: #74af68;">report only after a user exists the website */</span>
$(window).bind(<span style="color: #e67128;">'beforeunload'</span>, <span style="color: #ffad29; font-weight: bold;">function</span>() {sendGAreq();});

</pre>
</div>
</div>
</li>

<li><a id="org3454619"></a>Send dimension and metrics<br />
<div class="outline-text-6" id="text-17-4-14-2-4">
<p>
Configure and send custom dimensions
</p>
<div class="org-src-container">
<pre class="src src-js">ga(<span style="color: #e67128;">'send'</span>, <span style="color: #e67128;">'pageview'</span>, {
  <span style="color: #e67128;">'dimension15'</span>:  <span style="color: #e67128;">'My Custom Dimension'</span>
});

<span style="color: #74af68;">// </span><span style="color: #74af68;">gtag has to run 2 commands to accomplish the same</span>

<span style="color: #74af68;">// </span><span style="color: #74af68;">Configures custom dimension&lt;Index&gt; to use the custom parameter</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">'dimension_name' for 'GA_TRACKING_ID', where &lt;Index&gt; is a number</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">representing the index of the custom dimension.</span>
gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA_TRACKING_ID'</span>, {
  <span style="color: #e67128;">'custom_map'</span>: {<span style="color: #e67128;">'dimension&lt;Index&gt;'</span>: <span style="color: #e67128;">'dimension_name'</span>}
});
<span style="color: #74af68;">// </span><span style="color: #74af68;">Sends the custom dimension to Google Analytics.</span>
gtag(<span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'any_event_name'</span>, {<span style="color: #e67128;">'dimension_name'</span>: dimension_value});

<span style="color: #74af68;">// </span><span style="color: #74af68;">Maps 'dimension2' to 'age'.</span>
gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA_TRACKING_ID'</span>, {
  <span style="color: #e67128;">'custom_map'</span>: {<span style="color: #e67128;">'dimension2'</span>: <span style="color: #e67128;">'age'</span>}
});
<span style="color: #74af68;">// </span><span style="color: #74af68;">Sends an event that passes 'age' as a parameter.</span>
gtag(<span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'age_dimension'</span>, {<span style="color: #e67128;">'age'</span>: 12});
</pre>
</div>

<p>
Configure and send custom metrics
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #74af68;">// </span><span style="color: #74af68;">Configures custom metric&lt;Index&gt; to use the custom parameter</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">'metric_name' for GA_TRACKING_ID, where &lt;Index&gt; is a number</span>
<span style="color: #74af68;">// </span><span style="color: #74af68;">representing the index of the custom metric.</span>

ga(<span style="color: #e67128;">'send'</span>, <span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'category'</span>, <span style="color: #e67128;">'action'</span>, {
  <span style="color: #e67128;">'metric18'</span>: 8000
});
ga(<span style="color: #e67128;">'send'</span>, <span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'category'</span>, <span style="color: #e67128;">'action'</span>, {
  <span style="color: #e67128;">'metric19'</span>: 24.99
});

<span style="color: #74af68;">// </span><span style="color: #74af68;">gtag has to run 2 commands to achieve the same</span>

gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA_TRACKING_ID'</span>, {
  <span style="color: #e67128;">'custom_map'</span>: {<span style="color: #e67128;">'metric&lt;Index&gt;'</span>: <span style="color: #e67128;">'metric_name'</span>}
});
<span style="color: #74af68;">// </span><span style="color: #74af68;">Sends the custom dimension to Google Analytics.</span>
gtag(<span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'any_event_name'</span>, {<span style="color: #e67128;">'metric_name'</span>: metric_value});

<span style="color: #74af68;">// </span><span style="color: #74af68;">Maps 'metric5' to 'avg_page_load_time'.</span>
gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA_TRACKING_ID'</span>, {
  <span style="color: #e67128;">'custom_map'</span>: {<span style="color: #e67128;">'metric5'</span>: <span style="color: #e67128;">'avg_page_load_time'</span>}
});
<span style="color: #74af68;">// </span><span style="color: #74af68;">Sends an event that passes 'avg_page_load_time' as a parameter.</span>
gtag(<span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'load_time_metric'</span>, {<span style="color: #e67128;">'avg_page_load_time'</span>: 1});
</pre>
</div>

<p>
Configure and send both custom dimensions and custom metrics
</p>
<div class="org-src-container">
<pre class="src src-js">gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'GA_TRACKING_ID'</span>, {
   <span style="color: #e67128;">'custom_map'</span>: {
     <span style="color: #e67128;">'dimension2'</span>: <span style="color: #e67128;">'age'</span>,
     <span style="color: #e67128;">'metric5'</span>: <span style="color: #e67128;">'avg_page_load_time'</span>
   }
});

gtag(<span style="color: #e67128;">'event'</span>, <span style="color: #e67128;">'foo'</span>, {<span style="color: #e67128;">'age'</span>: 12, <span style="color: #e67128;">'avg_page_load_time'</span>: 1});
</pre>
</div>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #74af68;">// </span><span style="color: #74af68;">Set tracker's custom dimension so that all later hits will have this</span>
ga(<span style="color: #e67128;">'set'</span>, <span style="color: #e67128;">'dimension5'</span>, <span style="color: #e67128;">'custom data'</span>);

<span style="color: #74af68;">// </span><span style="color: #74af68;">set both</span>
ga(<span style="color: #e67128;">'set'</span>, {
  <span style="color: #e67128;">'dimension5'</span>: <span style="color: #e67128;">'custom dimension data'</span>,
  <span style="color: #e67128;">'metric5'</span>: <span style="color: #e67128;">'custom metric data'</span>
});
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org871b6a5" class="outline-4">
<h4 id="org871b6a5"><span class="section-number-4">17.4.15</span> fieldsObject <a id="org1ae8443">ga:fieldsObject</a></h4>
<div class="outline-text-4" id="text-17-4-15">
<p>
<a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference">https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference</a>
</p>
</div>

<div id="outline-container-orgad1efa9" class="outline-5">
<h5 id="orgad1efa9"><span class="section-number-5">17.4.15.1</span> page <a id="org084028e">ga:fieldsObject:page</a></h5>
<div class="outline-text-5" id="text-17-4-15-1">
<p>
text begins with /
</p>
</div>
</div>

<div id="outline-container-org00ce2de" class="outline-5">
<h5 id="org00ce2de"><span class="section-number-5">17.4.15.2</span> Custom Dimensions and Metrics <a id="org55fb6e5">ga:fieldsObject:customs</a></h5>
<div class="outline-text-5" id="text-17-4-15-2">
<p>
<a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference#customs">https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference#customs</a>
</p>
</div>
</div>

<div id="outline-container-orge5a6461" class="outline-5">
<h5 id="orge5a6461"><span class="section-number-5">17.4.15.3</span> hitCallback</h5>
<div class="outline-text-5" id="text-17-4-15-3">
<pre class="example">
var form = document.getElementById('signup-form');

// Adds a listener for the "submit" event.
form.addEventListener('submit', function(event) {

  // Prevents the browser from submitting the form
  // and thus unloading the current page.
  event.preventDefault();

  // Sends the event to Google Analytics and
  // resubmits the form once the hit is done.
  ga('send', 'event', 'Signup Form', 'submit', {
    hitCallback: function() {
      form.submit();
    }
  });

  // or 
  ga('send', 'event', 'Signup Form', 'submit', {
    transport: 'beacon'
  });

  form.submit();
});
</pre>
</div>
</div>
</div>
<div id="outline-container-org03c4cb0" class="outline-4">
<h4 id="org03c4cb0"><span class="section-number-4">17.4.16</span> Regular Expressions <a id="org03ff199">ga:regex</a></h4>
<div class="outline-text-4" id="text-17-4-16">
<p>
<a href="https://support.google.com/analytics/answer/1034324?hl=en">https://support.google.com/analytics/answer/1034324?hl=en</a>
</p>

<p>
Use <code>\</code> to escape. Need to escape the following metacharacters
. ? + * | ^ $ ( ) [ ] -
</p>

<p>
Metacharacters are no longer special inside of square brackets. Except - ^ and the \
</p>

<p>
[0-9]{1,2} repeat the number at least 1 time and no more than 2 times.
</p>

<p>
<a href="http://www.mysite.com/shopping?qsrc=35&amp;o=0&amp;x=ref&amp;stf=CA:LO&amp;q=lava+lamp">http://www.mysite.com/shopping?qsrc=35&amp;o=0&amp;x=ref&amp;stf=CA:LO&amp;q=lava+lamp</a>
</p>

<p>
Use <code>(q=[^&amp;]*)</code> to grab <code>q=lava+lamp</code> in Request URI
</p>

<p>
<a href="http://www.analyticsmarket.com/freetools/regex-tester">http://www.analyticsmarket.com/freetools/regex-tester</a>
<a href="http://www.lunametrics.com/regex-book/Regular-Expressions-Google-Analytics.pdf">http://www.lunametrics.com/regex-book/Regular-Expressions-Google-Analytics.pdf</a>
</p>
</div>

<div id="outline-container-orgb60f4b8" class="outline-5">
<h5 id="orgb60f4b8"><span class="section-number-5">17.4.16.1</span> Include multiple words but order does not matter</h5>
<div class="outline-text-5" id="text-17-4-16-1">
<p>
word1+word2+word3
</p>
</div>
</div>
</div>

<div id="outline-container-org735e801" class="outline-4">
<h4 id="org735e801"><span class="section-number-4">17.4.17</span> TS: Too Many Self-referrals</h4>
<div class="outline-text-4" id="text-17-4-17">
<p>
Reporting &gt; Acquisition &gt; All Traffic &gt; Referrals, you will find the website's url is the source
And the percentage is high compared to other Referral Sources.
3 reasons:
</p>
<ol class="org-ol">
<li>Users sessions idle for 30 minutes and become active. This should be &lt; 10% of traffic</li>
<li>Cross domain (need to bring it down to 0 self-referral)</li>
<li>A lot of traffic and sessions are created by spammers to a landing page</li>
</ol>
<p>
(most likely homepage with url parameters)  with a fake referral path as the website.
</p>

<p>
You cannot use View Filter to filter out referral domain&#x2026;
</p>

<p>
You can also create a segment without affecting the data. 
Conditions &gt; Filter: Sessions, Exclude &gt; Source / Medium &gt; contains &gt; OHG.com / referral
</p>

<p>
Ghosts :: send request to GA directly without visiting your site. Use random UA-ID and destination url.
</p>
<ul class="org-ul">
<li>Identify the source domain of referral traffic Report &gt; Acquisition &gt; Source/Medium, change primary dimension to Source and secondary dimension to Hostname. If Hostname is not your webiste, then the Source is the ghost's referral domain. Full Referrer dimension shows referrer's domain and path.</li>
<li>Create a filter under Property &gt; View to only include Hostname that is your website
<ul class="org-ul">
<li>Custom &gt; Include &gt; Hostname &gt; yourmaindomain\.com|anotheruseddomain\.com</li>
</ul></li>
</ul>

<p>
Don't do this as it will turn all referral traffic coming from that domain as direct traffic!
</p>
<ul class="org-ul">
<li>Go to Admin &gt; Account &gt; Property &gt; Tracking Info &gt; Referral Exclusion List &gt; add domain</li>
</ul>
<p>
abc.com also matches www.abc.com because domain name CONTAINS
</p>
<ul class="org-ul">
<li>Usually you add your own domain to Referral Exclusion List</li>
</ul>

<p>
<a href="https://moz.com/blog/stop-ghost-spam-in-google-analytics-with-one-filter">https://moz.com/blog/stop-ghost-spam-in-google-analytics-with-one-filter</a>
More detail instructions :: <a href="https://carloseo.com/removing-google-analytics-spam/">https://carloseo.com/removing-google-analytics-spam/</a>
</p>
</div>
</div>

<div id="outline-container-orgdb77b1d" class="outline-4">
<h4 id="orgdb77b1d"><span class="section-number-4">17.4.18</span> Analytics Solutions Gallery</h4>
<div class="outline-text-4" id="text-17-4-18">
<p>
<a href="https://analytics.google.com/analytics/gallery">https://analytics.google.com/analytics/gallery</a>
</p>

<p>
A gallery may contain Custom Reports, Dashboard, Segments, etc.
</p>

<p>
Imported gallery will show in Admin &gt; View &gt; Share Assets
</p>

<p>
Dashboards, Custom Reports, Segments, Goals, and Custom Attribution Models can be shared in the Solutions Gallery
</p>
</div>
</div>

<div id="outline-container-org21a17f9" class="outline-4">
<h4 id="org21a17f9"><span class="section-number-4">17.4.19</span> Email tracking, Measurement Protocol</h4>
<div class="outline-text-4" id="text-17-4-19">
<p>
The Google Analytics Measurement Protocol allows developers to make HTTP requests to send raw user interaction data directly to Google Analytics servers.
<a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/email">https://developers.google.com/analytics/devguides/collection/protocol/v1/email</a>
</p>
</div>
</div>

<div id="outline-container-org0631d04" class="outline-4">
<h4 id="org0631d04"><span class="section-number-4">17.4.20</span> Google Analytis Core Reporting API</h4>
</div>
<div id="outline-container-org06d8d24" class="outline-4">
<h4 id="org06d8d24"><span class="section-number-4">17.4.21</span> Learn</h4>
<div class="outline-text-4" id="text-17-4-21">
<p>
<a href="https://analytics.google.com/analytics/academy/">https://analytics.google.com/analytics/academy/</a>
</p>
</div>
</div>

<div id="outline-container-orgf8712af" class="outline-4">
<h4 id="orgf8712af"><span class="section-number-4">17.4.22</span> Remarketing with Analytics <a id="org811bc47">ga:remarketing</a></h4>
<div class="outline-text-4" id="text-17-4-22">
<p>
<a href="https://support.google.com/analytics/topic/2611283">https://support.google.com/analytics/topic/2611283</a>
</p>

<p>
Setup audience in GA can use all GA dimensions/metrics, sequence segment and regex compared to audience setup in AdWords with AdWords global site tag.
</p>

<p>
Best Practice :: <a href="https://support.google.com/adwords/topic/3122879">https://support.google.com/adwords/topic/3122879</a>
AdWords Remarketing Best Practices :: <a href="https://support.google.com/adwords/answer/6178664">https://support.google.com/adwords/answer/6178664</a>
</p>

<dl class="org-dl">
<dt>Enable Advertising Features (Remarketing and Advertising Reporting Features)</dt><dd>Admin &gt; Property &gt; Tracking Info &gt; Data Collection</dd>
<dt>(no term)</dt><dd>Ensure Analytics &gt; Admin &gt; Account &gt; Account Settings has enabled all Data Sharing</dd>
<dt>Link AdWords to Google Analytics</dt><dd><a href="https://support.google.com/adwords/answer/6209127">https://support.google.com/adwords/answer/6209127</a>
<ul class="org-ul">
<li>The same Google Account should have Edit permission for the Analytics property and Admin access for the AdWords manager account.</li>
<li>One AdWords manager account can have multiple managed accounts. After linking, or those accounts can use the Google Analytics property.</li>
<li id="Share Manager Account's Remarketing Lists"><a href="https://support.google.com/adwords/answer/6123188">https://support.google.com/adwords/answer/6123188</a></li>
</ul></dd>
<dt>(no term)</dt><dd><a href="#org41e00d3">ga:audience:create</a></dd>
<dt>Troubleshoot</dt><dd><a href="https://support.google.com/analytics/answer/3052703">https://support.google.com/analytics/answer/3052703</a></dd>
</dl>
</div>
</div>

<div id="outline-container-orgc2a95fc" class="outline-4">
<h4 id="orgc2a95fc"><span class="section-number-4">17.4.23</span> Dynamic Remarketing with Analytics <a id="orgf2c4b0a">ga:dynamic remarketing</a></h4>
<div class="outline-text-4" id="text-17-4-23">
<p>
<a href="https://support.google.com/analytics/topic/3455490">https://support.google.com/analytics/topic/3455490</a>
</p>
</div>
</div>

<div id="outline-container-org3778f83" class="outline-4">
<h4 id="org3778f83"><span class="section-number-4">17.4.24</span> Transfer a property</h4>
<div class="outline-text-4" id="text-17-4-24">
<p>
<a href="https://support.google.com/analytics/answer/6370521">https://support.google.com/analytics/answer/6370521</a>
</p>

<ul class="org-ul">
<li>Have <code>Manage Users</code> and <code>Edit</code> permissions on both the source and destination accounts</li>
</ul>
</div>
</div>

<div id="outline-container-org0ce4e1f" class="outline-4">
<h4 id="org0ce4e1f"><span class="section-number-4">17.4.25</span> Checklist</h4>
<div class="outline-text-4" id="text-17-4-25">
<ul class="org-ul">
<li>Audience &gt; Audiences &gt; enable Demographics and Interest Reports</li>
<li>Admin &gt; Property Settings &gt; 
<ul class="org-ul">
<li>Enable Demographics and Interest Reports <a href="#orgca6e7f1">ga:audience:interests</a></li>
<li>In-Page Analytics, Use enhanced link attribution</li>
<li>Search Console</li>
</ul></li>
<li>Admin &gt; Adwords Linking</li>
<li>Admin &gt; Audience Definitions &gt; Audiences
<dl class="org-dl">
<dt><a href="https://support.google.com/analytics/answer/2444872">Enable Remarketing</a></dt><dd>Admin &gt; Property &gt; Tracking Info &gt; Data Collection</dd>
<dt>(no term)</dt><dd>Set Audience Destinations to the corresponding AdWords account</dd>
<dt>(no term)</dt><dd>Define your audience and give a name</dd>
<dt>(no term)</dt><dd>In AdWords campaign &gt; Audience &gt; Edit &gt; under Targeting, Remarketing to select the list from GA</dd>
</dl></li>
<li>Admin &gt; Properties &gt; View
<dl class="org-dl">
<dt>Create 3 views</dt><dd>All website data, external traffic only, test view</dd>
<dt>(no term)</dt><dd>For external traffice only view, enable Bot Filtering - Exclude all hits from known bots and spiders</dd>
<dt>(no term)</dt><dd>Duplicate External Traffic Only view as Test View</dd>
</dl></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org4aa9eca" class="outline-3">
<h3 id="org4aa9eca"><span class="section-number-3">17.5</span> Google Optimise</h3>
<div class="outline-text-3" id="text-17-5">
<p>
Optimize vs Optimize 360 :: <a href="https://www.google.com/analytics/optimize/compare/">https://www.google.com/analytics/optimize/compare/</a>
</p>

<p>
A cookie is set when a user enters a variant and the user will continue to see that variant until both _ga and _gaexp cookies are removed.
</p>

<p>
Free version can only have one container in one account (container is like property in GA). Container ID is like GTM-XXXXX
</p>

<p>
An experiment runs on all pages unless you have targeting setup and you can select a page to run the editor to configure the variants.
</p>

<p>
Link to GA can compare GA metrics in variants.
</p>
</div>
</div>

<div id="outline-container-org73b3061" class="outline-3">
<h3 id="org73b3061"><span class="section-number-3">17.6</span> GA Dev Tools: <a href="https://ga-dev-tools.appspot.com/query-explorer/">Query Explorer</a></h3>
</div>
<div id="outline-container-org8281e98" class="outline-3">
<h3 id="org8281e98"><span class="section-number-3">17.7</span> GA Dev Tools: Campaign URL Builder</h3>
<div class="outline-text-3" id="text-17-7">
<ul class="org-ul">
<li><a href="https://ga-dev-tools.appspot.com/campaign-url-builder/">Google Analytics Campaign URL Builder</a></li>
</ul>

<p>
Fields
</p>
<dl class="org-dl">
<dt>Required</dt><dd>Medium, Source, Campaign <a href="#org053e7c6">ga:channel</a></dd>
<dt>Optional</dt><dd>Content (differentiate ads or links that point to the same URL), Term (the paid keywords)</dd>
</dl>

<p>
e.g.
</p>
<ul class="org-ul">
<li>Medium:cpc, Source:google, Campaign:Campaign Name, Term:running+shoes</li>

<li><a href="https://developers.google.com/analytics/devguides/collection/android/v4/campaigns#google-play-url-builder">Google Play URL Builder</a> for advertising an Android app</li>
<li><a href="https://developers.google.com/analytics/devguides/collection/ios/v3/campaigns#ios-url-builder">iOS Campaign Tracking URL Builder</a> for advertising an iOS app</li>
</ul>
</div>
</div>

<div id="outline-container-orgf1fa90b" class="outline-3">
<h3 id="orgf1fa90b"><span class="section-number-3">17.8</span> Google Search Console <a id="org5e9364e">google:search console</a></h3>
<div class="outline-text-3" id="text-17-8">
<p>
Add a new property for https if the website is upgraded from http. Stats are separated.
</p>

<p>
Google recommends creating 2 properties per root domain per schema (http/https). domainroot.com and www.domainroot.com
</p>

<p>
<a href="https://support.google.com/webmasters/">https://support.google.com/webmasters/</a>
</p>
</div>

<div id="outline-container-orgd57ed64" class="outline-4">
<h4 id="orgd57ed64"><span class="section-number-4">17.8.1</span> Search Traffic Report</h4>
<div class="outline-text-4" id="text-17-8-1">
<p>
<a id="org415cbb3">google:search console:search traffic report</a>
Search Traffic &gt; Search Analytics :: which search query end up to your site
</p>
<dl class="org-dl">
<dt>impressions</dt><dd>how many times your site appears on search result page</dd>
<dt>click</dt><dd>how many times people click on your website on search result page</dd>
<dt>position</dt><dd>avg of the topmost position.</dd>
</dl>

<p>
Only 3 months of search traffic stats are available
</p>

<p>
What are impressions, position and clicks? <a href="https://support.google.com/webmasters/answer/7042828">https://support.google.com/webmasters/answer/7042828</a>
</p>

<p>
<a href="#org1398647">wp:plugin:wordpress-seo</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org63528d9" class="outline-3">
<h3 id="org63528d9"><span class="section-number-3">17.9</span> Google Trends</h3>
<div class="outline-text-3" id="text-17-9">
<p>
Compare search terms in different Google Search platforms and see their related topics and related queries.
</p>

<p>
A B
</p>
<ul class="org-ul">
<li>must contain both words</li>
<li>order doesn't matter</li>
<li>other words can be added before, after or in-between</li>
<li>Spelling is exact</li>
</ul>

<p>
"A B"
</p>
<ul class="org-ul">
<li>exact phrase inside double quotation marks</li>
<li>other words can only be added before or after</li>
</ul>

<p>
A + B
</p>
<ul class="org-ul">
<li>A or B</li>
</ul>

<p>
A - B
</p>
<ul class="org-ul">
<li>contain A but exclude B</li>
</ul>

<p>
center + centre + centere
</p>
<ul class="org-ul">
<li>include alternative spellings. Consider each version of a word a different search.</li>
</ul>

<p>
Special characters
Apostrophe, single quotes and parentheses will be ignored
<code>women's tennis world ranking</code> you get result for <code>womens tennis world ranking</code>
</p>

<p>
Terms vs Topics
</p>
<ul class="org-ul">
<li>Term is literal match
<ul class="org-ul">
<li>banana matches "banana sandwich"</li>
<li>"banana sandwich" matches "banana for lunch" and "peanut butter sandwich"</li>
</ul></li>

<li>Topic is a group of terms that share the same concept in any language.
<ul class="org-ul">
<li>London matches "capital of the UK"</li>
<li>also matches "Londres" which is London in Spanish</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org3dfc567" class="outline-3">
<h3 id="org3dfc567"><span class="section-number-3">17.10</span> Google Shopping Insights</h3>
<div class="outline-text-3" id="text-17-10">
<p>
Search products (Google defines them). For US only. Nation &gt; region &gt; city level.
By age, household income, sex, device.
</p>
</div>
</div>

<div id="outline-container-org9c7033b" class="outline-3">
<h3 id="org9c7033b"><span class="section-number-3">17.11</span> Google AdWords, Google Keyword Planner, Google Video Advertising</h3>
<div class="outline-text-3" id="text-17-11">
</div>
<div id="outline-container-orgae79de3" class="outline-4">
<h4 id="orgae79de3"><span class="section-number-4">17.11.1</span> Keyword Planner</h4>
<div class="outline-text-4" id="text-17-11-1">
<p>
Hiking &gt; hike &gt; backpacking &gt; backpack
</p>

<p>
KP shows you a keyword's search volume, avg cpc and give you recommendation on other relelvant keywords.
</p>
</div>
</div>

<div id="outline-container-orgf4c1c9b" class="outline-4">
<h4 id="orgf4c1c9b"><span class="section-number-4">17.11.2</span> Google Ads - AdWords</h4>
<div class="outline-text-4" id="text-17-11-2">
<p>
AdWords requires 1+ hour/week and AdWords Express requires 15 min/week. Express only has text ads on Search and Google Maps and doesn't require to have a website. <a href="https://support.google.com/adwords/answer/7539883">Academy for Ads</a> <a href="http://school4seo.com/category/google-adwords-advance-search/">http://school4seo.com/category/google-adwords-advance-search/</a> <a href="https://academy.exceedlms.com/student/catalog/list?category_ids=53">https://academy.exceedlms.com/student/catalog/list?category_ids=53</a>
</p>
</div>

<div id="outline-container-org57ca280" class="outline-5">
<h5 id="org57ca280"><span class="section-number-5">17.11.2.1</span> Campaign Goals</h5>
<div class="outline-text-5" id="text-17-11-2-1">
<p>
Build awareness
</p>
<dl class="org-dl">
<dt>Targeting</dt><dd>Demographics, Affinity/custom affinity audiences, Managed Placements</dd>
<dt>Measure</dt><dd>Views, Impressions, Unique users, Awareness lift, Ad recall lift</dd>
<dt>Solutions</dt><dd>six-second, non-skippable, in-stream video ads, Masthead</dd>
</dl>
<p>
Influence consideration
</p>
<dl class="org-dl">
<dt>Targeting</dt><dd>In-market audiences, Audience keywords, Similar audiences, Audience Keyword targeting, Content keyword targeting, Topic targeting</dd>
<dt>Measure</dt><dd>View-through rate, Watch time, Favorability lift, Consideration lift, Brand interest lift</dd>
<dt>Solutions</dt><dd>TrueView in-stream ads, Gmail</dd>
</dl>
<p>
Drive action
</p>
<dl class="org-dl">
<dt>Targeting</dt><dd>Display remarketing, Dynamic remarketing</dd>
<dt>Measure</dt><dd>clicks, calls, sign-ups, app installs, purchase intent lift, sales</dd>
<dt>Solutions</dt><dd>Gmail</dd>
</dl>
<p>
Grow loyalty
</p>
<dl class="org-dl">
<dt>Targeting</dt><dd>Display remarketing</dd>
</dl>
</div>
</div>

<div id="outline-container-org77a3ba1" class="outline-5">
<h5 id="org77a3ba1"><span class="section-number-5">17.11.2.2</span> Keywords Match Type</h5>
<div class="outline-text-5" id="text-17-11-2-2">
<p>
<a id="orgf76c11f">adwords:keywords match types</a>
Default broad match :: <code>hiking tour northern california</code>
</p>
<ul class="org-ul">
<li>match with queries with any order and any additional words</li>
<li>match with synonyms and mispellings</li>
<li>partial match is allowed "best hiking" query matches <code>hiking tour northern california</code></li>
</ul>

<p>
Modified broad match :: + sign includes broad match but excludes synonyms
</p>
<ul class="org-ul">
<li><code>+gel batteries</code> must include gel or its synonym, batteries may not present.</li>
<li><code>gel +batteries</code> must include batteries or its different forms, gen may not present.</li>
</ul>

<p>
Phrase match with double quotes :: any queries match <code>"hiking tour northern california"</code> in any order with additional words
</p>

<p>
Exact match and only these words :: <code>[hiking tours northern california]</code>
</p>

<p>
Negative match :: <code>-dog</code>, <code>-wallpaper</code>, <code>-screensavers</code>, <code>-pictures</code> to ignore queries that have this negative word
</p>

<p>
<a href="#org6dd2b2c">google:search operators</a> are ignored
</p>

<p>
<a href="https://support.google.com/adwords/answer/7476658">https://support.google.com/adwords/answer/7476658</a>
<a href="https://support.google.com/adwords/answer/2472708?hl=en">https://support.google.com/adwords/answer/2472708?hl=en</a>
</p>
</div>
</div>

<div id="outline-container-org56249d6" class="outline-5">
<h5 id="org56249d6"><span class="section-number-5">17.11.2.3</span> Negative keywords</h5>
<div class="outline-text-5" id="text-17-11-2-3">
<p>
Negative broad match :: ad won't show if the search contains all negative keyword terms, even if the order is different. <code>running shoes</code>
Phrase match :: ad won't show if the search contains the exact keyword terms in the same order.
Exact match :: ad won't show if the search contains the exact keyword terms, in the same order, without extra words.
</p>

<p>
<a href="https://komarketing.com/blog/200-plus-negative-keywords-to-consider-for-b2b-ppc/">https://komarketing.com/blog/200-plus-negative-keywords-to-consider-for-b2b-ppc/</a>
hawaii
career
careers
"new balance sale"
"sale in new brunswick"
</p>
</div>
</div>

<div id="outline-container-orga67a8ee" class="outline-5">
<h5 id="orga67a8ee"><span class="section-number-5">17.11.2.4</span> Campaigns, Ad groups</h5>
<div class="outline-text-5" id="text-17-11-2-4">
<dl class="org-dl">
<dt>Campaign</dt><dd>It's usually for a type of product you sell. If budget or location targeting is changed, create another campaign
<dl class="org-dl">
<dt>Setting</dt><dd>frequency capping, start/end dates, budget, goal, locations, language, bidding strategy, devices, content exclusions, IP exclusions, dynamic ads feeds, ad rotation, campaign URL options
<dl class="org-dl">
<dt>Frequency capping</dt><dd>level can be set ad, ad group and this campaign</dd>
</dl></dd>
<dt>Drafts &amp; Experiments</dt><dd>A draft inherits all settings from a campaign and almost any ads and ad groups can be changed. After a draft is made, it can be applied to the original campaign or creat an experiment to test how changes perform against your original campaign
<dl class="org-dl">
<dt>Limitation</dt><dd><a href="https://support.google.com/google-ads/answer/6318732">some features and reports that are not available for drafts, and some features aren't supported by experiments</a></dd>
<dt>Experiments</dt><dd>while multiple drafts for a given campaign, only one draft can run as an experiment at a time
<ul class="org-ul">
<li>Specify how long to run and how much original campaign's traffic (and budget) to use for the experiment</li>
<li>Later, an experiment can be applied to the original campaign or convert the experiment to a new campaign</li>
</ul></dd>
</dl></dd>
</dl></dd>

<dt>Ad group</dt><dd>It holds one or more ads which target a shared set of keywords (theme) or a set cost-per-click (CPC) bid
<ul class="org-ul">
<li>To show ads that are relevant to the searches of people you're trying to reach, bundle related ads together with related keywords into an ad group. That way, all of your related ads can be shown to customers searching for similar things</li>
<li>For each ad group, use keywords related to that theme. Consider also having your ads mention at least one of your keywords in its headline</li>
<li id="Setting">bidding, ad rotation, ad group targeting, landing pages, keywords, placements, demographics, audiences, narrow targeting, observations, automated targeting
<dl class="org-dl">
<dt>Ad Group Targeting</dt><dd>audiences, demographics, keywords, placements, additional observations, automated targeting</dd>
</dl></li>
</ul></dd>

<dt>Ad</dt><dd>URL, creative, Search Ad (title, URL, description)</dd>
</dl>

<p>
<a href="https://support.google.com/adwords/answer/6372655?hl=en">Organize account with ad groups</a>
</p>

<p>
Linking to someone's AdWords account lets that person advertise your locations with location extensions.
Linking to someone's Merchant Center account lets that person advertise your products with local inventory ads.
</p>

<p>
Dynamic Search Ads
</p>
<ul class="org-ul">
<li>A campaign can enable DSA and the default ad group (1st ad group when a new Search campaign is created) is a dynamic ad group</li>
<li>Standard Ad Group can be added as well.</li>
<li>Only Dynamic Search Ads can be added to this dynamic ad group. For each ad, provide just a description field</li>
<li>Dynamic Ads Targets are created to categorize webpages of your destination website (domain). And you can further select categories to target the Dynamic Search Ads created in this dynamic ad group</li>
</ul>
</div>
</div>

<div id="outline-container-orgc69bc9c" class="outline-5">
<h5 id="orgc69bc9c"><span class="section-number-5">17.11.2.5</span> Placement</h5>
<div class="outline-text-5" id="text-17-11-2-5">
<p>
Locations on the Display Network where your ad can appear. Examples include relevant websites and apps that partner with Google to show ads.
</p>
</div>
</div>

<div id="outline-container-org308d055" class="outline-5">
<h5 id="org308d055"><span class="section-number-5">17.11.2.6</span> Quality Score, Ad Rank, Ad Position</h5>
<div class="outline-text-5" id="text-17-11-2-6">
<dl class="org-dl">
<dt>Relevancy</dt><dd>someone searches "snowboard rentals" and your ad uses keyphrase "Snowboard rentals Tahoe"</dd>
<dt>Click-through rate (CTR)</dt><dd>clicks over views.</dd>
<dt>Account history</dt><dd>AdWords account</dd>
<dt>Landing page relevancy</dt><dd>content match what people search (bounce rate)</dd>
</dl>

<p>
<a id="orgfc16cf6">adwords:ad rank</a>
Ad Rank = Quality Score x Maximum bid x ad formats.
</p>
</div>
</div>

<div id="outline-container-org5082530" class="outline-5">
<h5 id="org5082530"><span class="section-number-5">17.11.2.7</span> Media Cost Model</h5>
<div class="outline-text-5" id="text-17-11-2-7">
<p>
Campaign goals decide on which media cost model you should use.
</p>

<p>
Use manual bidding first and after the campaign is already getting at least 15 conversions and 15 clicks per month, automated bidding can help:
</p>
<dl class="org-dl">
<dt>Maximize clicks</dt><dd>Good for advertisers just starting off with online marketing who are most interested in getting customers to their website.</dd>
<dt>Ad revenue</dt><dd>Target return-on-ad-spend (tROAS). Good for advertisers who know the exact value of each conversion.</dd>
<dt>Ad conversions</dt><dd>Good for advertisers looking to drive conversions. "auction-time bidding"
<dl class="org-dl">
<dt>Enhanced cost per click (ECPC)</dt><dd>described later</dd>
<dt>Maximize conversions</dt><dd>max number of conversions. May use up all daily budget for one conversion.</dd>
<dt>Target cost per acquisition (tCPA)</dt><dd>max number of conversions while maintaining avg CPA. Good for multiple campaigns with various CPA. Some bids might cost higher than the corresponding target you set but some are lower in order to make up the avg cost is within your set target. CPA is the average amount you pay for a conversion.</dd>
</dl></dd>
</dl>

<p>
Cost per Click (CPC) is determined by max bid + Quality Score + Ad Rank and compare those against your competitors. Drive traffic.
</p>

<p>
Set Max. CPC to = your profit x commission for Google x your conversion rate
</p>

<p>
$100 x 0.3 x 1% = $.30
1% conversion rate is based on 1000 views of the page and 10 people buy
</p>

<p>
Manual CPC :: each keyword or Ad Group would have the same bid.
</p>

<p>
Automatic CPC :: there're some bid strategies under this category. Max CPC cannot be set.
</p>

<p>
Enhanced CPC (ECPC) :: relies on Google’s own historical data to help you predict where and when to adjust bids you set manually in order to get more conversions. Its CPC is constrained by Max CPC you set.
</p>
<ul class="org-ul">
<li>e.g. if a campaign’s performance looks promising it will automatically raise bids to ‘capture’ more results (for less money). Similarly, it will also drop bids if necessary to help you save on wasted ad spend if performance starts to slide.</li>
<li>it's better to turn it off initially and let AdWords collect data and further turn it on</li>
<li>individual CPC might exceed Max CPC you set, but avg CPC is below Max CPC</li>
</ul>

<p>
CPC, CPA and CPM are 3 bidding strategies but each one can be further optimized based on bid modifiers which are rules that raise or lower bids based on:
</p>
<ul class="org-ul">
<li>Geographic locations</li>
<li id="Device">although more traffic from mobile but conversion rate is higher on desktop</li>
<li>Dayparting</li>
</ul>

<p>
3 phases
</p>
<dl class="org-dl">
<dt>Brand awareness</dt><dd>Let the world know about you. Requires larger budget due to the longer path to conversion and the scale at which you try to reach people.</dd>
<dt>Influence consideration</dt><dd>Encourage customers to explore you.</dd>
<dt>Driving action or sale</dt><dd>lower funnel usually requires less budget.</dd>
</dl>
</div>

<ol class="org-ol">
<li><a id="orgc1cdd1a"></a>CPA :: boost sales<br />
<div class="outline-text-6" id="text-17-11-2-7-1">
<p>
Cost Per Action (or conversion)
</p>
</div>
</li>

<li><a id="org1347ab4"></a>CPM, vCPM :: brand awareness<br />
<div class="outline-text-6" id="text-17-11-2-7-2">
<p>
Applies only to the Display Network (along with remarketing campaigns, too). Here you pay a cost (like a few cents or dollars) per one thousand impressions.
</p>

<p>
vCPM :: viewable cost per thousand impressions. Cost a bit more than CPM.
</p>
</div>
</li>

<li><a id="org8cedd91"></a>CPV :: boost video views<br />
<div class="outline-text-6" id="text-17-11-2-7-3">
<p>
cost per view for video or click on it.
</p>
</div>
</li>

<li><a id="org39ba811"></a>Bid Simulators<br />
<div class="outline-text-6" id="text-17-11-2-7-4">
<p>
<a href="https://support.google.com/adwords/answer/2470105">https://support.google.com/adwords/answer/2470105</a>
</p>

<p>
Click Campaigns, Ad groups, or Keywords.
If you're in Campaigns, the icon is in the "Daily budgets" column.
If you're in Ad groups or Keywords, the icon is in the "Default max. CPC" column.
</p>

<p>
Some reasons why bid simulators do not show
</p>
<ul class="org-ul">
<li>Search and Display campaigns that use Manual CPC, Enhanced cost-per-click, and Target CPA bid strategies.</li>
<li>campaign has reached or nearly reached its daily budget at least once in the last 7 days</li>
<li>a campaign, keyword, ad group, or product group was recently added, or didn't receive many impressions or clicks in the last 7 days.</li>
<li>campaign uses shared budgets</li>
</ul>
</div>
</li>

<li><a id="org216e0d7"></a>First-page bid estimate<br />
<div class="outline-text-6" id="text-17-11-2-7-5">
<p>
For CPC, AdWords can show estimates for showing your ad on:
</p>

<ul class="org-ul">
<li>First page</li>
<li id="Top of page">at the top of first page</li>
<li>First position</li>
</ul>

<p>
AdWords &gt; Keywords &gt; Add columns &gt; Attributes &gt; Est. first page bid, Est. top of page bid, Est. first pos. bid
</p>
</div>
</li>

<li><a id="org48c815a"></a>Bid Adjustments<br />
<div class="outline-text-6" id="text-17-11-2-7-6">
<p>
Bid adjustment is available in <a href="#orgcc4e963">adwords:targeting</a>
</p>

<p>
Search Network :: Clicking “Advanced bid adj.” opens the Interactions page, where you can set your bid adjustments for calls.
</p>

<p>
Decrease a bid by 100% is to completely exclude the ad from a targeting setting.
</p>
</div>
</li>

<li><a id="org84c81f1"></a>Daily budget<br />
<div class="outline-text-6" id="text-17-11-2-7-7">
<p>
Divide by 30.4 that is avg number of days per month.
</p>

<p>
Delivery method
</p>
<ul class="org-ul">
<li>Standard</li>
<li>Accelerated</li>
</ul>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgc1455c7" class="outline-5">
<h5 id="orgc1455c7"><span class="section-number-5">17.11.2.8</span> Networks, Campaign Types, Ad Formats</h5>
<div class="outline-text-5" id="text-17-11-2-8">
<p>
Search network is likely to bring more traffic to your site.
Display network is for driving awareness e.g. promote for a new website or something that has a new concept
</p>

<p>
<a href="https://support.google.com/adwords/answer/2567043">All campaign types</a>
</p>
</div>

<ol class="org-ol">
<li><a id="org3a77a65"></a>Search Network<br />
<div class="outline-text-6" id="text-17-11-2-8-1">
<p>
Google Search, Shopping, Maps and Google Play for websites and Google apps. Also Google Search Parnters.
Search Parnters :: non-Google websites, as well as YouTube and other Google sites. CTR for ads on search partner sites doesn't impact Quality Score on google.com. It is included by default. To remove it AdWords account &gt; Settings &gt; select campaign &gt; Networks &gt; uncheck Include Google search partners
</p>

<p>
Ad formats
</p>
<dl class="org-dl">
<dt>text ads</dt><dd>Search Network and Search Partners</dd>
<dt>ad extension</dt><dd><a href="#org925ae3e">adwords:ad extension</a></dd>
<dt>(no term)</dt><dd><a href="https://support.google.com/adwords/answer/2471185?hl=en">dynamic search ads</a></dd>
<dt>shopping ads</dt><dd>Google Search, Shopping, Search Partners</dd>
<dt>image ads</dt><dd>Display Network, Search Partners but not Google Search Network</dd>
<dt>video ads</dt><dd>Display Network, Search Parnter Networks but not Google Search Network</dd>
<dt>app promotion ads</dt><dd>Search Network, Display Network</dd>
<dt>call-only ads</dt><dd>Search Network</dd>
</dl>
</div>
</li>

<li><a id="org48ad1a8"></a>Display Network<br />
<div class="outline-text-6" id="text-17-11-2-8-2">
<p>
Shows ads on other websites, other apps, YouTube, Gmail, Blogger. New or changes can take 12-24 hours to apply.
</p>

<p>
Display Network can target audiences by interests, topics, placements. <a href="#orgcc4e963">adwords:targeting</a>
</p>

<p>
Ad formats
</p>
<dl class="org-dl">
<dt>Responsive ads</dt><dd>responsive can fit in all available sizes and can transform into text or image ads.
<ul class="org-ul">
<li>Landscape: ideally sized at 1200 x 628</li>
<li>Square: ideally sized at 1200 x 1200</li>
<li>A short headline (25 characters or fewer) which appears in tight ad spaces. It may or may not appear with a description.</li>
<li>A long headline (90 characters or fewer) which appears instead of the short headline in larger ads.
In some cases, it may be shortened with ellipses. It also may or may not appear with a description.</li>
<li>A description which may appear with the headline and invite users to take action. It also may be shortened with ellipses.</li>
</ul></dd>
<dt>Image ads</dt><dd>Creat as many sizes and formats as possible in order to reach on Display Network.</dd>
<dt>(no term)</dt><dd>rich media ads</dd>
<dt>Engagement ads</dt><dd>image and video ads on YouTube and across the Display Network</dd>
<dt>Gmail ads</dt><dd>expandable ads on the top tabs of people's inboxes. Can't use affinity, remarketing or remarking-based audiences. May interests and domain targeting (receive emails from).</dd>
<dt>Video ads</dt><dd>remarketing on people who view your YouTube videos or channel as they browse Display Network.</dd>
<dt>(no term)</dt><dd>app promotion ads</dd>
<dt>(no term)</dt><dd><a href="#org925ae3e">adwords:ad extension</a></dd>
</dl>
</div>
</li>

<li><a id="org74bb6c9"></a>Shopping<br /></li>
<li><a id="orge1ef29d"></a>Video<br />
<div class="outline-text-6" id="text-17-11-2-8-4">
<dl class="org-dl">
<dt>TrueView in-stream ads</dt><dd>YouTube and across Display Network sites, games, or apps.</dd>
<dt>TrueView video discovery ads</dt><dd>YouTube.</dd>
<dt>Bumper ads</dt><dd>6 seconds or less.</dd>
</dl>
</div>
</li>

<li><a id="org270ffa2"></a>Universal App<br />
<div class="outline-text-6" id="text-17-11-2-8-5">
<p>
Downloads of your app
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org446a3cf" class="outline-5">
<h5 id="org446a3cf"><span class="section-number-5">17.11.2.9</span> Targeting options <a id="orgcc4e963">adwords:targeting</a></h5>
<div class="outline-text-5" id="text-17-11-2-9">
<dl class="org-dl">
<dt>Keywords</dt><dd>try to include between 5 and 20 keywords per ad group
<dl class="org-dl">
<dt>Audience</dt><dd>Show ads to people likely to be interested in these keywords and also on webpages, apps, and videos related to these keywords</dd>
<dt>Content</dt><dd>Only show ads on webpages, apps, and videos related to these keywords e.g. webpage's concepts.</dd>
</dl></dd>
<dt>(no term)</dt><dd>Audience
<dl class="org-dl">
<dt>Interests and habits (Affinity and custom affinity)</dt><dd>types of websites not webpages the audience have visited. This is for running TV ad.
<ul class="org-ul">
<li>Affinity is more general.</li>
<li><a href="https://support.google.com/adwords/answer/2497941">Custom Affinity</a> can have these 
<ul class="org-ul">
<li>Interests entered as keywords</li>
<li>URL</li>
<li>places</li>
<li>apps</li>
</ul></li>
<li>Custom Affinity is only for Display Campaign</li>
</ul></dd>
<dt>Life evnets</dt><dd>engage with viewers on YouTube and Gmail</dd>
<dt>Researching or planning (In-market and custom intent)</dt><dd>likely buyers</dd>
<dt>(no term)</dt><dd>Remarketing
<dl class="org-dl">
<dt>Similar Audience</dt><dd>better to create another campaign. Not all custom audience list can have a similar audience.</dd>
</dl></dd>
</dl></dd>
<dt>Demographics</dt><dd>age, gender, income</dd>
<dt>Topics</dt><dd>topics a webpage has e.g. central theme</dd>
<dt>Placements</dt><dd>specific websites your ad will show on. May also be specific YouTube videos, channel.</dd>

<dt>(no term)</dt><dd>Ad schedule</dd>

<dt>Locations</dt><dd>majority of consumers want ads customized to their city, zip code, or immediate surroundings</dd>
<dt>(no term)</dt><dd>Settings
<ul class="org-ul">
<li>Devices</li>
<li>Languages</li>
<li>IP exclusions</li>
<li>Content exclusions</li>
<li id="Dynamic ads">use Data feed to show different ads based on audience who have visited certain webpages on your website with custom parameters tagged. Refer to <a href="#org4849cd6">ga:dynamic remarketing</a> for tagging.
<ul class="org-ul">
<li><a href="https://support.google.com/adwords/answer/6053288">Create data feed</a></li>
<li><a href="https://support.google.com/adwords/answer/3265299">Create responsive ads</a></li>
<li><a href="https://support.google.com/adwords/answer/6077124">Full guide on Dynamic remarketing</a></li>
<li><a href="https://support.google.com/adwords/answer/6178664">Remarketing and Dynamic Remarketing best practices</a></li>
</ul></li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-org8fc4783" class="outline-5">
<h5 id="org8fc4783"><span class="section-number-5">17.11.2.10</span> Ad Group Automated Targeting</h5>
<div class="outline-text-5" id="text-17-11-2-10">
<p>
Only for Display Network, under Ad Group &gt; Settings &gt; Automated targeting
Conservative automation :: default
Aggressive automation :: broader match. e.g. if your keyword is “pens,” conservative targeting may extend to “felt-tip pens" and “ballpoint pens,” but aggressive targeting might show your ads in contexts related to “whiteboard markers” or “mechanical pencils”—if there’s data to suggest that those keywords will lead to conversions. Plus, automatic targeting works for remarketing. Aggressive targeting is available for all Display Network campaigns with at least 15 conversions per month. It costs a little bit more than Conservative.
</p>

<p>
When to use automatic targeting
</p>
<ul class="org-ul">
<li>Find more customers</li>
<li>Identify the best targeting to reach your most likely customers</li>
<li>Increase reach without increasing bids or cost per customer</li>
</ul>
</div>
</div>

<div id="outline-container-org4929ad2" class="outline-5">
<h5 id="org4929ad2"><span class="section-number-5">17.11.2.11</span> Ad Formats in networks</h5>
<div class="outline-text-5" id="text-17-11-2-11">
<p>
<a href="https://support.google.com/adwords/answer/1722124">https://support.google.com/adwords/answer/1722124</a>
</p>
</div>

<ol class="org-ol">
<li><a id="orgd7d2826"></a>text ad<br />
<div class="outline-text-6" id="text-17-11-2-11-1">
<p>
<a id="org0b0a0a0">adwords:text ad</a>
Goal :: specific, actionable, and relevant. <a href="https://support.google.com/adwords/answer/6167122">Best practice</a>.
Required *
</p>
<dl class="org-dl">
<dt>*Headline</dt><dd>consider including at leat one keyword. 2 fields up to 30 characters each. Fields are combined with hyphen.</dd>
<dt>*URL</dt><dd>Path field appear as www.example.com/Indoor-Plants but actual is different.</dd>
<dt>*Description</dt><dd>80 characters</dd>
</dl>

<p>
Some good phrases are:
</p>
<ul class="org-ul">
<li>Shop now, Buy now, Get an instant quote online, See pricing</li>
</ul>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgdae68fb" class="outline-5">
<h5 id="orgdae68fb"><span class="section-number-5">17.11.2.12</span> Ad extension</h5>
<div class="outline-text-5" id="text-17-11-2-12">
</div>
<ol class="org-ol">
<li><a id="org2ef4c5d"></a>Basics <a id="org925ae3e">adwords:ad extension</a><br />
<div class="outline-text-6" id="text-17-11-2-12-1">
<p>
Extension appears with ads on the Search Network. Some extensions might also appear with ads on the Display Network.
</p>

<p>
Extensions are free to use. <a href="https://support.google.com/adwords/answer/7332837">List of extensions</a>.
</p>

<p>
Factors determining when they show:
</p>

<ul class="org-ul">
<li>Your Ad Rank, which combines your bid, the quality of your ad and landing page, Ad Rank thresholds, context of the person’s search, and expected impact of extensions and other ad formats. AdWords requires a minimum Ad Rank (factoring in your extensions) before showing extensions. So, you may need to increase your bid or your ad quality (or both) in order for your extensions to show.</li>

<li>The position of your ad on the Google search results page. There’s a limited amount of space available above Google search results for ad extensions, and ads in higher positions get the first opportunity to show extensions.  Ads in lower positions generally won’t have more extensions than ads in higher positions. Plus, the AdWords system generally won’t allow ads in lower positions to get more incremental clicks from extensions than the incremental clicks they’d get from moving up to a higher position. To show ads in higher positions, generally you need to increase your ad quality, bid, or both.</li>

<li>Other extensions you’ve enabled. In each auction, we'll generally show your highest performing and most useful combination of eligible extensions and formats. You will not be able to get a combination of extensions which gives more expected click-through-rate (CTR) than the expected CTR of a higher ad position.</li>
</ul>

<p>
Both ad formats and ad extension could help your ad's Ad Rank!
</p>

<p>
Extensions can be set on campaign level.
</p>
</div>
</li>

<li><a id="org1983d45"></a>Location extension<br />
<div class="outline-text-6" id="text-17-11-2-12-2">
<p>
Works on both Search and Display Network including Google Maps.
<a href="https://support.google.com/adwords/answer/7040605">https://support.google.com/adwords/answer/7040605</a>
</p>

<p>
Encourage people to visit your business by showing your location, a call button, and a link to your business details page—which can include your hours, photos of your business, and directions to get there.
</p>
</div>
</li>

<li><a id="org3123bcd"></a>Call extension<br />
<div class="outline-text-6" id="text-17-11-2-12-3">
<p>
Has some limitation on Display Network.
</p>
</div>
</li>

<li><a id="org1d8a8cc"></a>Message<br />
<div class="outline-text-6" id="text-17-11-2-12-4">
<p>
Encourage people to send you text messages from your ad.
</p>
</div>
</li>

<li><a id="org1837fd7"></a>Price<br />
<div class="outline-text-6" id="text-17-11-2-12-5">
<p>
Showcase your services or product categories with their prices, so that people can browse your products right from your ad.
</p>
</div>
</li>

<li><a id="org2b4e222"></a>Promotion<br />
<div class="outline-text-6" id="text-17-11-2-12-6">
<p>
Highlight specific sales and promotions across your ads (e.g., 30% off rose bouquets)
</p>
</div>
</li>

<li><a id="orgb0a9bdc"></a>App<br />
<div class="outline-text-6" id="text-17-11-2-12-7">
<p>
Available globally for Android and iOS mobile devices, including tablets.
</p>
</div>
</li>

<li><a id="org1ac2db0"></a>Sitelink<br />
<div class="outline-text-6" id="text-17-11-2-12-8">
<p>
Show six to eight additional links to different pages on her site. e.g. store hours, location details, and popular bouquets
</p>
</div>
</li>

<li><a id="orgbbcc5f7"></a><a href="https://support.google.com/adwords/answer/7506719">callout</a><br />
<div class="outline-text-6" id="text-17-11-2-12-9">
<p>
Callouts can improve your text ads by promoting unique offers to shoppers, like free shipping or 24-hour customer service. When customers see your ads, they get detailed information about your business, products, and services.
</p>

<p>
2 to 6 callouts show in addition to the text of your ad. Ads with callout extensions can show at the top and bottom of Google search results. When callout extensions show, they appear below your ad copy.
</p>

<p>
Free Shipping · 24-7 Customer Service · Price Matching
</p>

<p>
Callout text is limited to 25 characters in most languages, or 12 characters in double-width languages (like Chinese, Japanese, and Korean).
</p>
</div>
</li>

<li><a id="org9ecc110"></a><a href="https://support.google.com/adwords/answer/6280012">Structured snippet</a><br />
<div class="outline-text-6" id="text-17-11-2-12-10">
<p>
Highlight specific aspects of your products and services with structured snippets extensions. Structured snippets show beneath your text ad in the form of a header (ex: "Destinations") and list of values (ex: "Hawaii, Costa Rica, South Africa").
</p>

<p>
Services: Tech Support, E-Waste Recycling, Computer Repair
</p>

<p>
List of headers
Amenities
Brands
Courses
Degree programs
Destinations
Featured hotels
Insurance coverage
Models
Neighborhoods
Service catalog
Shows
Styles
Types
</p>

<p>
It can show up to 2 headers at a time, while ads that show on mobile and tablet devices will only show one header. AdWords algorithmically decides the best header or combination of headers to show, so it’s best to add as many headers as possible that are relevant to your business.
</p>
</div>
</li>

<li><a id="org5379306"></a>Universal extensions<br />
<div class="outline-text-6" id="text-17-11-2-12-11">
<p>
Sitelink, Callout and Structured Snippets are called universal extensions that fit all business objectives.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgbf48a3a" class="outline-5">
<h5 id="orgbf48a3a"><span class="section-number-5">17.11.2.13</span> Ad customizers</h5>
<div class="outline-text-5" id="text-17-11-2-13">
<p>
<a href="https://support.google.com/adwords/answer/6072565?hl=en">https://support.google.com/adwords/answer/6072565?hl=en</a>
</p>
</div>
</div>

<div id="outline-container-org4c0f272" class="outline-5">
<h5 id="org4c0f272"><span class="section-number-5">17.11.2.14</span> ValueTrack URL parameters</h5>
<div class="outline-text-5" id="text-17-11-2-14">
<p>
These parameters can be used in Final URL and Tracking Template. Here's an example of Tracking Template
</p>
<pre class="example">
{lpurl}?matchtype={matchtype}&amp;device={device}
</pre>

<p>
All parameters <a href="https://support.google.com/adwords/answer/6305348">https://support.google.com/adwords/answer/6305348</a>
<code>{keyword}</code> :: For the Search Network: the keyword from your account that matches the search query, unless you are using a Dynamic Search ad, which returns a blank value. For the Display Network: the keyword from your account that matches the content.
</p>

<p>
Parallel tracking should be enabled :: AdWords account &gt; All campaigns &gt; Settings &gt; Account Settings &gt; Tracking &gt; Parallel tracking
</p>
</div>
</div>

<div id="outline-container-orgfc7556e" class="outline-5">
<h5 id="orgfc7556e"><span class="section-number-5">17.11.2.15</span> Supported Ad Sizes</h5>
<div class="outline-text-5" id="text-17-11-2-15">
<p>
Square and rectangle
200 × 200	Small square
240 × 400	Vertical rectangle
250 × 250	Square
250 × 360	Triple widescreen
300 × 250	Inline rectangle
336 × 280	Large rectangle
580 × 400	Netboard
</p>

<p>
Leaderboard
468 × 60	Banner
728 × 90	Leaderboard
930 × 180	Top banner
970 × 90	Large leaderboard
970 × 250	Billboard
980 × 120	Panorama
</p>

<p>
Skyscraper
120 × 600	Skyscraper
160 × 600	Wide skyscraper
300 × 600	Half-page
300 × 1050	Portrait
</p>

<p>
Mobile
300 × 50	Mobile banner
320 × 50	Mobile banner
320 × 100	Large mobile banner
</p>

<p>
Most popular for responsive ad (covers 95% in Display Network) :: 300x250, 728x90, 1600x600, 320x50, 300x600
</p>
</div>
</div>

<div id="outline-container-orgba932c2" class="outline-5">
<h5 id="orgba932c2"><span class="section-number-5">17.11.2.16</span> Conversion tracking</h5>
<div class="outline-text-5" id="text-17-11-2-16">
<p>
Website conversion tracking with Google Analytics :: <a href="https://support.google.com/adwords/answer/6095821">https://support.google.com/adwords/answer/6095821</a>
</p>

<ul class="org-ul">
<li>If GA has linked to the AdWords account and goals are defined on GA, AdWords conversion tag may not be necessary to put on the website. But AdWords conversion stats are 9 hours behind GA goal conversion stats.</li>

<li id="Set up conversion tracking using Google Ads conversion tag (on websites, mobile apps, call tracking)"><a href="https://support.google.com/adwords/answer/1722054">https://support.google.com/adwords/answer/1722054</a></li>
</ul>

<p>
View-through conversion
</p>
<ul class="org-ul">
<li>Measures how many visitors saw ads on Google Display Network and YouTube Video but did not interact/click but they later complete a conversion on your site</li>
<li>Google Ads conversion tracking is required. Cannot simply setup goals on Google Analytics</li>
</ul>

<p>
Check conversion tracking tag :: <a href="https://support.google.com/adwords/answer/1722021">https://support.google.com/adwords/answer/1722021</a>
</p>

<p>
<a href="https://support.google.com/adwords/answer/6270625">Conversion tracking data (columns)</a>
</p>

<p>
Use global site tag on website same as remarketing
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">script</span> async
<span style="color: #dbdb95;">src</span>=<span style="color: #e67128;">"https://www.googletagmanager.com/gtag/js?id=AW-CONVERSION_ID"</span>&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
&lt;<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'AW-CONVERSION_ID'); // or you just add this to your existing GA global site tag

  // If you want to manually send an event to mark a conversion:
  // gtag('event', 'conversion', {'send_to': 'AW-CONVERSION_ID/conversion-unique-specific-hash-id'});
&lt;/<span style="color: #00ede1; font-weight: bold;">script</span>&gt;
</pre>
</div>

<p>
Import GA goals and transactions to AdWords conversion tracking :: Tools &gt; Measurement &gt; Conversions &gt; New &gt; Import Google Analytics
New stats are imported when Import is clicked. Conversion data can be seen on AdWords within 2 days.
</p>
</div>

<ol class="org-ol">
<li><a id="org306ef9d"></a>Phone <a id="org16fa8e0">adwords:conversion:phone</a><br />
<div class="outline-text-6" id="text-17-11-2-16-1">
<p>
Call Extension or call-only ad, enable Call Reporting and you have to change "count conversions as" to a new Conversion tracking instead of the default "Calls from ads"
</p>

<p>
<a href="https://support.google.com/adwords/answer/6095882">https://support.google.com/adwords/answer/6095882</a>
</p>

<p>
Measurement &gt; Conversions &gt; Add new Phone calls - Calls from ads using call extensions or call-only ads
</p>

<p>
After that, go back to your existing call extension or call-only ad or when you create them from now on
Select the conversion action you just created as Count conversion as
</p>
</div>

<ol class="org-ol">
<li><a id="org454229b"></a>Calls to a phone number on your website<br />
<div class="outline-text-7" id="text-17-11-2-16-1-1">
<p>
<a href="https://support.google.com/adwords/answer/6095883">https://support.google.com/adwords/answer/6095883</a>
Set up a conversion action as usual :: Measurement &gt; Conversions &gt; Add new Phone calls - Calls to a phone number on your website
</p>

<p>
It prompts the phone snippet based on your option. Sample in header
</p>
<pre class="example">
gtag('config', 'AW-CONVERSION_ID');

&lt;script&gt;
  gtag('config', 'AW-CONVERSION_ID/CONVERSION_LABEL', {
    'phone_conversion_number': '1-650-555-5555'
  });
&lt;/script&gt;
</pre>

<p>
If you select "Don't enter a number"
</p>
<div class="org-src-container">
<pre class="src src-js">gtag(<span style="color: #e67128;">'config'</span>, <span style="color: #e67128;">'AW-CONVERSION_ID/CONVERSION_LABEL'</span>, {
  <span style="color: #e67128;">'phone_conversion_number'</span>: <span style="color: #e67128;">'1-650-555-5555'</span>,
  <span style="color: #e67128;">'phone_conversion_callback'</span>:<span style="color: #ffad29; font-weight: bold;">function</span>(<span style="color: #dbdb95;">formatted_number</span>, <span style="color: #dbdb95;">mobile_number</span>) {
  <span style="color: #74af68;">// </span><span style="color: #74af68;">formatted_number: number to display, in the same format as the </span>
  <span style="color: #74af68;">//     </span><span style="color: #74af68;">number passed to 'phone_conversion_number'. </span>
  <span style="color: #74af68;">//     </span><span style="color: #74af68;">(in this case, '1-650-555-5555')</span>
  <span style="color: #74af68;">// </span><span style="color: #74af68;">mobile_number: number formatted for use in a clickable link</span>
  <span style="color: #74af68;">//      </span><span style="color: #74af68;">with tel:-URI (in this case, '+16505555555')</span>
  <span style="color: #ffad29; font-weight: bold;">var</span> <span style="color: #dbdb95;">e</span> = document.getElementById(<span style="color: #e67128;">"number"</span>);
  e.innerHTML = <span style="color: #e67128;">""</span>;
  <span style="color: #74af68;">// </span><span style="color: #74af68;">e.href = "tel:" + mobile_number;</span>
  e.appendChild(document.createTextNode(formatted_number));
  };,
  <span style="color: #e67128;">'phone_conversion_options'</span>:timeout=20;cache=<span style="color: #008b8b;">false</span><span style="color: #e67128;">'</span>
<span style="color: #e67128;">});</span>
</pre>
</div>

<p>
Adding this will get a telephone number and replace the contents of all spans of the given class
</p>
<pre class="example">
phone_conversion_css_class: 'number'
</pre>

<pre class="example">
&lt;span class="number"&gt;1-800-123-4567&lt;/span&gt;
</pre>
</div>
</li>
</ol>
</li>

<li><a id="org78b0709"></a>Attribution Modeling<br />
<div class="outline-text-6" id="text-17-11-2-16-2">
<p>
It is only available for clicks on Search Network and Shopping ads on Google.com. Which ad click makes the final conversion?
</p>

<p>
Data-driven :: only available for search campaigns with 15k+ Google.com search clicks and 600 conversions per conversion type over 30 days.
Position-based :: 40% of credit to both first and last clicked ads and corresponding keywords, remaining 20% spread out across the other clicks
Time decay :: More credit to clicks that happened closer in time to the conversion
Linear :: Credit for the conversion is shared equally across all clicks on the path
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgbfef2ea" class="outline-5">
<h5 id="orgbfef2ea"><span class="section-number-5">17.11.2.17</span> Remarketing Audience, Customer Match</h5>
<div class="outline-text-5" id="text-17-11-2-17">
<p>
One account has one AdWords tag as in Audience sources. Other sources include Google Analytics, YouTube.
</p>

<p>
Ways to remarket with AdWords :: <a href="https://support.google.com/adwords/answer/2453998?hl=en">https://support.google.com/adwords/answer/2453998?hl=en</a>
</p>
</div>

<ol class="org-ol">
<li><a id="org0747e00"></a>Rules and Templates<br />
<div class="outline-text-6" id="text-17-11-2-17-1">
<p>
Rules :: <a href="https://support.google.com/adwords/answer/6297497">https://support.google.com/adwords/answer/6297497</a>
</p>

<p>
Standard parameters include URL, Referrer (e.g. www.google.com coming from search or anothersite.com), parameters sent through the event snippets and attributes from Google Merchant Center.
</p>

<p>
Path and URL query parameters can be targetted. But not #
</p>

<p>
Template :: <a href="https://support.google.com/adwords/answer/6297549">https://support.google.com/adwords/answer/6297549</a>
</p>
<ul class="org-ul">
<li>Visitors of a page
<ul class="org-ul">
<li>Add multiple conditions and if any condition met, then add to the list</li>
</ul></li>

<li>Visitors of a page who also visited another page
<ul class="org-ul">
<li>To create a list of people who visited pages A, B, and C, first create a list of people who visited pages A and B using this template. Then, using the "Visitors of a page" template, create a list of people who visited page C. Then, create a custom combination using these two lists.</li>
<li>Only on Display Network</li>
</ul></li>

<li>Visitors of page who did not visit another page
<ul class="org-ul">
<li>When you create a list using this template, you narrow your audience. To be on your list, visitors need to visit the page defined in the first rule AND not visit any of the pages defined in the second rule. This is what makes this template different from the "Visitors of a page" template. When you create a list using the "Visitors of a page" template, you can add different conditions to the rule, but people who match ANY of the conditions (as opposed to ALL of the conditions) will be added to the remarketing list.</li>
<li>Only on Display Network</li>
</ul></li>

<li>Visitors of a page during specific dates
<ul class="org-ul">
<li>When creating lists with specific dates, lists' membership duration may also determine when people are removed from the list. Visitors are added to the list if they've visited the pages on the selected dates, and will stay on the list for the amount of time specified by the membership duration.</li>
</ul></li>

<li>Visitors of a page with a specific tag
<ul class="org-ul">
<li>Awhile ago, an airline added a remarketing tag to sections of their website about popular routes. Creating a rule based on the URL for those sections would be too complex using rules. The airline could create a remarketing list of people who visited sections of the website about the popular route by using the "Visitors of a page with a specific tag" template, and selecting the tag that was implemented a while ago on those pages.</li>
<li>When you use the "Visitors of a page with a specific tag" template, you can select existing AdWords conversion tracking tags as well. Selecting a conversion tracking tag can be helpful if you haven't been able to add the remarketing tag to the conversion page but still want to reach or exclude this audience.</li>
</ul></li>
</ul>
</div>
</li>

<li><a id="orga1b208c"></a>Custom Combination List<br />
<div class="outline-text-6" id="text-17-11-2-17-2">
<p>
<a href="https://support.google.com/adwords/answer/2549111">https://support.google.com/adwords/answer/2549111</a>
</p>
</div>
</li>

<li><a id="orgfcea23a"></a>Customer Match<br />
<div class="outline-text-6" id="text-17-11-2-17-3">
<p>
It's for Search, YouTube and Gmail Networks.
</p>
<ul class="org-ul">
<li>Upload a list as an Audience List to match Google accounts.
<ul class="org-ul">
<li>Email, Phone, First Name, Last Name, Country, Zip, and Mobile Device ID (multiple email and postal columns are allowed)</li>
<li><a href="https://support.google.com/adwords/answer/7474166">https://support.google.com/adwords/answer/7474166</a></li>
</ul></li>
<li>Similar audience targeting based on your Customer Match audiences is available for YouTube and Gmail.</li>
</ul>
</div>
</li>
</ol>
</div>

<div id="outline-container-org3c7ae7e" class="outline-5">
<h5 id="org3c7ae7e"><span class="section-number-5">17.11.2.18</span> Reports</h5>
<div class="outline-text-5" id="text-17-11-2-18">
</div>
<ol class="org-ol">
<li><a id="org360305c"></a>System Reports<br />
<div class="outline-text-6" id="text-17-11-2-18-1">
<p>
Search terms :: When you use broad-match keywords (the default setting), your ads can appear when someone searches for a variation of your keyword, like a similar phrase or related word. To see a list of searches that have triggered your ad, use the Search terms report. You can use this report to identify relevant terms that are driving traffic to your website, and then add them as new keywords. Or, if any of the keywords are irrelevant to your business, you can add them as negative keywords so they won't trigger your ads.
</p>

<p>
Paid and organic report :: how people got to you — comparing Google’s free organic search results to your paid AdWords ads. Learn the ways customers are looking for products and services like yours and update your own keyword list or create new ad groups to directly target them. In order to access this report you’ll need to link Google Webmaster Tools to Google AdWords. AdWords &gt; Linked Accounts.
</p>

<p>
User locations :: physical locations
Geographic :: Location of interest and physical locations.
</p>

<p>
Landing page experience :: located under Keywords &gt; a keyword &gt; column Status to review Ad Rank
</p>

<p>
Wrench icon &gt; Measurement &gt; Search Attribution :: Once you've set up conversion tracking, you'll have access to a handy set of reports about your conversions. Attribution reports show you the paths customers take to complete a conversion, and attribute the conversion to different ads, clicks, and factors along the way.
</p>

<p>
Return on investment ROI is calculated with this formula: (Revenue - Cost) / Cost. Example: If your ad resulted in $1,200 of sales for a product that cost $600 to make, and your advertising cost was $200, then your ROI is [$1,200 - ($600 + $200)] / ($600 + $200) = 50% ROI.
</p>

<p>
Segments
For any reports, you can click on 3 bars next to filter to create segment
</p>
<ul class="org-ul">
<li>Network</li>
<li>Device</li>
<li>Time</li>
<li>Click type</li>
<li>Conversions</li>
<li>Top vs. Other</li>
<li>Keyword text</li>
</ul>

<p>
<a href="https://support.google.com/adwords/answer/2579754">Auction Insights</a> :: how well you did in auctions compared to other advertisers that compete with you? Available to Search Network and Shopping. Keywords &gt; Auction Insights
</p>

<p>
Reach Metrics (only in Campaigns):
</p>
<dl class="org-dl">
<dt>Unique users</dt><dd>same user but across multiple devices</dd>
<dt>(no term)</dt><dd>Unique cookies</dd>
<dt>Unique viewers</dt><dd>same as cookie but for Video ads only</dd>
<dt>Frequency</dt><dd>an estimate of the average number of times a unique cookie was exposed to your ad over a given time period.</dd>
</dl>

<p>
Low CTR but a lot of impressions :: If the goal is max sales, try to lower the Max CPC.
</p>

<p>
High conversion rate and low CPC :: increase Max CPC for this keyword.
</p>
</div>
</li>

<li><a id="orgd9b408d"></a>Custom Reports<br />
<div class="outline-text-6" id="text-17-11-2-18-2">
<p>
Custom reports are made on Account level. Filter to a specifc campaign if necessary.
</p>

<p>
e.g. Row:Campaign Columns:All stats include Phone impressions, Phone calls and phone-through rate (Call details).
</p>

<p>
Individual row and column can be further filtered.
</p>

<p>
If you want to break down to individual goals, use GA.
</p>

<p>
GA does not show AdWords phone conversion.
</p>
</div>

<ol class="org-ol">
<li><a id="orgf5d9037"></a>Breakdown Conversions inside Google Ads<br />
<div class="outline-text-7" id="text-17-11-2-18-2-1">
<p>
Breakdown conversions #1 (User Location &amp; Ad Groups)
</p>
<dl class="org-dl">
<dt>Rows</dt><dd>Ad group, Most specific location target, Region, Conversion action, Device, Day</dd>
<dt>Columns</dt><dd>Conversions</dd>
</dl>

<p>
Breakdown conversions #2 (Search Term &amp; Ads)
</p>
<dl class="org-dl">
<dt>Rows</dt><dd>Ad, Search term, Conversion action, Device, Day</dd>
<dt>Columns</dt><dd>Conversions</dd>
</dl>

<p>
Breakdown conversions #3 (Hours of Day &amp; Ad Groups)
</p>
<dl class="org-dl">
<dt>Rows</dt><dd>Ad Group, Hour of Day, Conversion Action, Device, Day</dd>
<dt>Columns</dt><dd>Conversions</dd>
</dl>

<p>
Breakdown conversions #4 (Extensions &amp; Ad Groups)
</p>
<dl class="org-dl">
<dt>Rows</dt><dd>Extension, Ad Group, Day, Conversion Action, Device, Day</dd>
<dt>Columns</dt><dd>Conversions</dd>
</dl>
</div>
</li>
</ol>
</li>
</ol>
</div>

<div id="outline-container-orge7c65c8" class="outline-5">
<h5 id="orge7c65c8"><span class="section-number-5">17.11.2.19</span> Autotagging</h5>
<div class="outline-text-5" id="text-17-11-2-19">
<p>
Always enable autotagging in AdWords :: Previous view &gt; Gear icon &gt; Account Settings &gt; Preferences &gt; Tracking &gt; Auto-tagging
</p>

<p>
Benefits of auto-tagging <a href="https://support.google.com/analytics/answer/1733663">https://support.google.com/analytics/answer/1733663</a>
If the final URL contains any of the following, manual tagging is used:
</p>
<ul class="org-ul">
<li>utm_source, utm_medium, utm_campaign, utm_content, utm_term</li>
</ul>

<p>
When auto-tagging is used, gclid=abc parameter is appended to the rul. Auto-tagging only works with Google Analytics e.g. other 3rd party tools which only use UTM parameters.
</p>

<p>
You can add UTM parameters and with auto-tagging on, UTM parameters and gclid will be in the URL. You can also let GA take the UTM parameters you specifiy instead of the values that gclid can bring.
</p>
<ul class="org-ul">
<li><a href="https://support.google.com/analytics/answer/1033981?hl=en">https://support.google.com/analytics/answer/1033981?hl=en</a></li>
</ul>

<p>
Caution :: Don't include hash in the final URL with auto-tagging on! as gclid URL parameter will not be caught as url parameter.
</p>
</div>
</div>

<div id="outline-container-orgc44037c" class="outline-5">
<h5 id="orgc44037c"><span class="section-number-5">17.11.2.20</span> Automated Rules</h5>
<div class="outline-text-5" id="text-17-11-2-20">
<p>
Automated rules are added to a campaign (e.g. enable and disable a campaign), an ad group, an ad or extension and others based on time or performance.
</p>

<p>
<a href="https://support.google.com/google-ads/answer/2497710?co=ADWORDS.IsAWNCustomer=true&amp;hl=en">https://support.google.com/google-ads/answer/2497710?co=ADWORDS.IsAWNCustomer=true&amp;hl=en</a>
</p>

<p>
Manage Rules under Reports in the top bar between Go To and Tools.
</p>
</div>
</div>
</div>

<div id="outline-container-org4018ed5" class="outline-4">
<h4 id="org4018ed5"><span class="section-number-4">17.11.3</span> Make ads</h4>
<div class="outline-text-4" id="text-17-11-3">
<p>
<a href="http://www.richmediagallery.com/">http://www.richmediagallery.com/</a>
</p>
</div>
</div>

<div id="outline-container-orgf26b081" class="outline-4">
<h4 id="orgf26b081"><span class="section-number-4">17.11.4</span> Google Video Advertising</h4>
<div class="outline-text-4" id="text-17-11-4">
<p>
<a href="https://support.google.com/displayspecs">https://support.google.com/displayspecs</a>
AdWords :: <a href="https://support.google.com/adwords/answer/2375464">https://support.google.com/adwords/answer/2375464</a>
</p>

<p>
Google Preferred :: Goolgle serve your video ads on YouTube videos that are the top 5% content across highly popular channels, playlists or video collections. Videos are divided into several categories.
</p>

<p>
Desktop and Mobile Video Mastheads :: <a href="https://support.google.com/displayspecs/answer/6244544">https://support.google.com/displayspecs/answer/6244544</a>. YouTube homepage 100% share of voice, target country and device and device.
</p>

<p>
DoubleClick Bid Manager :: programmatic buying platform
</p>
</div>

<div id="outline-container-org52e73fe" class="outline-5">
<h5 id="org52e73fe"><span class="section-number-5">17.11.4.1</span> TrueView in-stream ads</h5>
<div class="outline-text-5" id="text-17-11-4-1">
</div>
<ol class="org-ol">
<li><a id="orga5be826"></a>TrueView in-stream<br />
<div class="outline-text-6" id="text-17-11-4-1-1">
<p>
In-stream ads play before or during another video from a YouTube partner. Viewers see five seconds of your video and then have the choice to keep watching or skip it.
</p>

<p>
You pay when a viewer watches for at least 30 seconds or to the end of the video (whichever is shorter) or clicks on a card or other elements of your in-stream creative.
</p>

<p>
Interactive Features you can add:
</p>
<ul class="org-ul">
<li>Call-to-action overlays</li>
<li>End screens</li>
<li>Cards</li>
<li>Auto end screens</li>
</ul>
<p>
<a href="https://support.google.com/youtube/answer/150471?hl=en">https://support.google.com/youtube/answer/150471?hl=en</a>
</p>
</div>
</li>

<li><a id="orgcfde12a"></a>TrueView video discovery<br />
<div class="outline-text-6" id="text-17-11-4-1-2">
<p>
Video discovery ads appear alongside other YouTube videos, in YouTube search pages, or on websites on the Google Display Network that match your target audience.
</p>

<p>
You pay only when a viewer chooses to watch your video by clicking on the ad.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-orge36319c" class="outline-5">
<h5 id="orge36319c"><span class="section-number-5">17.11.4.2</span> Measure &amp; Solutions</h5>
<div class="outline-text-5" id="text-17-11-4-2">
<p>
Awareness 
</p>
<ul class="org-ul">
<li>Views, Impressions, Unique users, Awareness lift, Ad recall lift</li>
<li id="Bumper ads">six-second, non-skippable, in-stream video ads</li>
<li>Masthead</li>
</ul>

<p>
Consideration
</p>
<ul class="org-ul">
<li>View-through rate, Watch time, Favorability lift, Consideration lift, Brand interest lift</li>
<li>TrueView in-stream ads</li>
</ul>

<p>
Action
</p>
<ul class="org-ul">
<li>Clicks, Calls, Sign-ups, App installs, Purchase intent lift, Sales</li>
</ul>
</div>
</div>

<div id="outline-container-org52a006f" class="outline-5">
<h5 id="org52a006f"><span class="section-number-5">17.11.4.3</span> Video Remarketing</h5>
<div class="outline-text-5" id="text-17-11-4-3">
<p>
Remarketing lists :: YouTube related actions or Google Search Display behaviors. Views, likes, commenting, sharing and subscribing, as well as visiting channels, videos or even mastheads
</p>

<p>
These lists can be used in existing, new and even Search and Display campaigns.
</p>

<p>
In AdWords :: Linked Accounts &gt; Youtube channel &gt; you own or someone else owns
</p>

<p>
YouTube users :: viewed any video from a channel, viewed certain videos, viewed any video (as an ad) from a channel, viewed certain videos as ads, subscribed to a channel, visited a channel page, liked any video from a channel, added any video from a channel to a playlist, commented on any video from a channel, shared any video from a channel
</p>

<p>
Features on AdWords after linking YouTube channel to an AdWords account
</p>
<dl class="org-dl">
<dt>View counts and calls-to-action</dt><dd>view ad completion rates of videos, create CTA overlays on videos from linked channels.</dd>
<dt>Remarketing</dt><dd>create lists based on viewers' past interactions on linked channels</dd>
<dt>Engagement</dt><dd>view earned actions metrics from videos and video ads from linked channels.</dd>
</dl>

<p>
Multiple AdWords accounts can be linked to a YouTube channel.
</p>

<p>
Metrics
</p>
<dl class="org-dl">
<dt>View rate</dt><dd>% of people who choose to watch video ads after seeing the video ad's thumbnail.</dd>
<dt>Avg. CPV</dt><dd>cost per view</dd>
<dt>(no term)</dt><dd>CTR</dd>
<dt>(no term)</dt><dd>Cost</dd>
<dt>Earned actions</dt><dd>happen when a viewer watches a video ad and then takes a related action on YouTube.
<dl class="org-dl">
<dt>Earned views</dt><dd>watch subsequent videos on the channel or Watch pages</dd>
<dt>Earned subscribers</dt><dd>happen when a viewer subscribes to your channel.</dd>
</dl></dd>
<dt>YouTube Analytics</dt><dd><ul class="org-ul">
<li>Audience retention report (e.g. relative audience retention for a video compared to the YouTube average for similar videos)</li>
<li id="Engagement">calls-to-action and other interactive elements, # of shares, where/when you gain or loose subscribers</li>
</ul></dd>
</dl>

<p>
Contact Google representative to conduct a Brand Lift survey to show metrics in business meaning :: lifts in awareness, ad recall, brand interest, consideration, brand favorability, purchase intent. You will need to provide several of your competitors in order to conduct the survey.
</p>
</div>
</div>

<div id="outline-container-org8682403" class="outline-5">
<h5 id="org8682403"><span class="section-number-5">17.11.4.4</span> YouTube Advertising</h5>
<div class="outline-text-5" id="text-17-11-4-4">
<p>
<a href="https://www.youtube.com/yt/advertise/">https://www.youtube.com/yt/advertise/</a>
Learn how to make a video <a href="https://creatoracademy.youtube.com/page/welcome">https://creatoracademy.youtube.com/page/welcome</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org6b76020" class="outline-4">
<h4 id="org6b76020"><span class="section-number-4">17.11.5</span> <a href="https://www.richmediagallery.com/">Google Rich Media Gallery</a></h4>
<div class="outline-text-4" id="text-17-11-5">
<p>
Templates, Learn, Formats/Ad Format Gallery
</p>
</div>
</div>
</div>

<div id="outline-container-orgc7c62ee" class="outline-3">
<h3 id="orgc7c62ee"><span class="section-number-3">17.12</span> LinkedIn Marketing Solutions</h3>
<div class="outline-text-3" id="text-17-12">
<p>
LinkedIn advertising hierarchy
</p>
<ul class="org-ul">
<li>account &gt; campaign group &gt; campaign &gt; ad</li>
<li id="account">currency, LinkedIn Company Page</li>
<li id="campaign group">budget, start/end dates, status:active</li>
<li id="campaign">define possible ad formats: Sponsored Content, Sponsored InMail and Text Ads</li>
</ul>

<p>
LinkedIn Insight Tag
</p>
<ul class="org-ul">
<li>A LinkedIn account can have multiple accounts and each account associates with one company page. Each Insight tag is unique to one account and thus one company page</li>
<li>An account can add multiple users. Each user under an account has a unique Insight tag</li>
<li>A tag can be on multiple websites and domains have to be verified on LinkedIn Campaign Manager</li>
<li>A tag can provide conversion tracking, learn audience and collect audience for remarketing</li>
</ul>
</div>
</div>

<div id="outline-container-orgd6cab99" class="outline-3">
<h3 id="orgd6cab99"><span class="section-number-3">17.13</span> Google Tag Manager</h3>
<div class="outline-text-3" id="text-17-13">
<p>
<a href="https://support.google.com/tagmanager/">https://support.google.com/tagmanager/</a>
</p>
</div>
</div>

<div id="outline-container-org05edbab" class="outline-3">
<h3 id="org05edbab"><span class="section-number-3">17.14</span> Keywords on websites</h3>
<div class="outline-text-3" id="text-17-14">
<p>
Page title 65 characters. A list of keywords (&lt;=3) with separators can be used. Order matters.
Only one &lt;h1&gt;
</p>

<p>
Select some of the following keywords to track in those KRT.
</p>
<ul class="org-ul">
<li>Use Keyword Research Tools (KRT) to find what keywords are within the search engine ranking.</li>
<li>Use Google Search Console to see which keywords/queries end up to your site.</li>
</ul>
</div>
</div>

<div id="outline-container-orgf40b708" class="outline-3">
<h3 id="orgf40b708"><span class="section-number-3">17.15</span> Link building, Search Visibility</h3>
<div class="outline-text-3" id="text-17-15">
<p>
Website A has 10 links to your site and website B has 5 links to your site.
</p>

<p>
You have 2 domains (linking root domains) that have a total of 15 links (external links) to your site.
</p>

<p>
Followed vs nofollow links.
</p>

<p>
Search Visibility represents estimated click-through rate based on the average ranking position of all of your tracked keywords.
e.g. CTR of position #1 is 33-45%.
</p>
</div>
</div>

<div id="outline-container-org1ee07ee" class="outline-3">
<h3 id="org1ee07ee"><span class="section-number-3">17.16</span> Site Audit Tools - check js errors, GA tagging, etc.</h3>
<div class="outline-text-3" id="text-17-16">
</div>
<div id="outline-container-org0afd4a1" class="outline-4">
<h4 id="org0afd4a1"><span class="section-number-4">17.16.1</span> ObservePoint</h4>
</div>
</div>
<div id="outline-container-orgb823a4b" class="outline-3">
<h3 id="orgb823a4b"><span class="section-number-3">17.17</span> SEO and PPC Strategy</h3>
<div class="outline-text-3" id="text-17-17">
</div>
<div id="outline-container-orgf8a90bc" class="outline-4">
<h4 id="orgf8a90bc"><span class="section-number-4">17.17.1</span> SpyFu.com</h4>
<div class="outline-text-4" id="text-17-17-1">
<p>
Free and no registration is required.
</p>
<ul class="org-ul">
<li>organic keywords, monthly SE organic clicks</li>
<li>Google organic clicks vs paid clicks</li>
<li>paid keywords, monthly PPC clicks, monthly Google Ads budget</li>
<li>top organic/paid keywords and cost and CPC per paid keyword</li>
<li>Google Ads history including real ads and corresponding landing pages</li>
<li>Inbound Links</li>
</ul>
</div>
</div>

<div id="outline-container-orga81d464" class="outline-4">
<h4 id="orga81d464"><span class="section-number-4">17.17.2</span> SERanking.com</h4>
<div class="outline-text-4" id="text-17-17-2">
<p>
Free and no registration is required.
Same as SpyFu but it breaks down by country and different SE.
</p>
</div>
</div>

<div id="outline-container-org4abc694" class="outline-4">
<h4 id="org4abc694"><span class="section-number-4">17.17.3</span> Moz.com</h4>
<div class="outline-text-4" id="text-17-17-3">
<p>
Moz uses Jumpshot's clickstream data combined with Google AdWords.
Moz Pro tools
</p>
<dl class="org-dl">
<dt>Link Explorer</dt><dd>Page Authority, Domain Authority, Linking Domains, Inbound Links, Ranking Keywords, etc. Run it for all websites.</dd>
</dl>
</div>

<div id="outline-container-org26a36b5" class="outline-5">
<h5 id="org26a36b5"><span class="section-number-5">17.17.3.1</span> Free tools</h5>
<div class="outline-text-5" id="text-17-17-3-1">
<p>
<a href="https://moz.com/free-seo-tools">https://moz.com/free-seo-tools</a>
Keyword Explorer :: free for 20 queries per month
MozBar :: Chrome extension to show Page Authority, Domain Authority, MozRank, MozTrust
</p>
</div>

<ol class="org-ol">
<li><a id="org88cb079"></a>Keyword Explorer<br />
<div class="outline-text-6" id="text-17-17-3-1-1">
<p>
Some other competitors are Raven SEO Tools, SEMrush.com, WordTracker
Pro :: 5k queries per month
Difficulty
</p>
<dl class="org-dl">
<dt>Low</dt><dd>20-35</dd>
<dt>Middle</dt><dd>36-50</dd>
<dt>Tough</dt><dd>51-65</dd>
<dt>Very difficult</dt><dd>66-80</dd>
</dl>

<p>
Usually you should invest on high volume keyword with lower difficulty.
</p>

<p>
When you search on Google, it tells number of results. The more results means more competition.
</p>

<p>
Keyword Analysis is about to analyze how people use keywords to search content that you provide (e.g. you provide California Vacations)
</p>
<dl class="org-dl">
<dt>Groups</dt><dd>food? activity?</dd>
<dt>(no term)</dt><dd>Concepts</dd>
<dt>Phrase pattern</dt><dd>people search vacation ideas more than vacation packages</dd>
<dt>(no term)</dt><dd>Prefix</dd>
<dt>(no term)</dt><dd>Suffix</dd>
<dt>(no term)</dt><dd>Synonyms</dd>
<dt>Plurals</dt><dd>people use singular when they want to be specific and plurals when they want general info</dd>
</dl>
</div>
</li>

<li><a id="orgf313924"></a>Open Site Explorer (similar to Link Explorer)<br /></li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orgb766110" class="outline-3">
<h3 id="orgb766110"><span class="section-number-3">17.18</span> Conversion Rate Optimization - CRO</h3>
<div class="outline-text-3" id="text-17-18">
<p>
<a href="https://unbounce.com/landing-page-analyzer/">https://unbounce.com/landing-page-analyzer/</a>
</p>

<p>
Landing page builder :: <a href="https://instapage.com/">https://instapage.com/</a> <a href="https://www.leadpages.net/">https://www.leadpages.net/</a>
</p>

<p>
Track phone calls <a href="https://www.callrail.com/">https://www.callrail.com/</a>
</p>

<p>
Marketing page builder, A/B testing :: <a href="https://www.optimizely.com/">https://www.optimizely.com/</a>, Google Optimize
</p>
</div>
</div>

<div id="outline-container-org5a9d93a" class="outline-3">
<h3 id="org5a9d93a"><span class="section-number-3">17.19</span> Remarketing vs Retargeting</h3>
<div class="outline-text-3" id="text-17-19">
<p>
Remarketing is an umbrella term which covers offline, phone, email, social media and websites. Retargeting is a subset of remarketing
</p>

<p>
Retargeting:
</p>
<ul class="org-ul">
<li>people have been on your site</li>
<li>people have been on a competitor site</li>
</ul>
</div>
</div>

<div id="outline-container-org3643f05" class="outline-3">
<h3 id="org3643f05"><span class="section-number-3">17.20</span> Competitive Marketing</h3>
<div class="outline-text-3" id="text-17-20">
<p>
<a href="https://www.wordstream.com/blog/ws/2016/05/16/competitive-advertising">https://www.wordstream.com/blog/ws/2016/05/16/competitive-advertising</a>
</p>

<ul class="org-ul">
<li>Using Facebook Ad, you can target people with interests in our competitor’s company name</li>
<li>Use YouTube campaigns, you can target people with searches for our competitor’s videos on YouTube</li>
<li>Use Gmail campaigns, you can target people with interests in our competitor’s company name and its products. E.g. target people who are interested in Sephora</li>
<li>Use Display campaigns, you can target people with visits to AND interests in a specific domain. This is new but it is different from remarketing audience. But it’s powerful enough!</li>
<li>Use Twitter Ads, you can download a competitor’s followers and setup Twitter Ads to target those followers.</li>
</ul>
</div>
</div>

<div id="outline-container-orgbb108b8" class="outline-3">
<h3 id="orgbb108b8"><span class="section-number-3">17.21</span> Optimize Images</h3>
<div class="outline-text-3" id="text-17-21">
<p>
<a href="https://moz.com/ugc/10-tips-for-optimizing-your-images-for-search">https://moz.com/ugc/10-tips-for-optimizing-your-images-for-search</a>
</p>

<p>
Google Image sitemaps <a href="https://support.google.com/webmasters/answer/178636">https://support.google.com/webmasters/answer/178636</a>
Google Image guildlines <a href="https://support.google.com/webmasters/answer/114016">https://support.google.com/webmasters/answer/114016</a>
</p>
</div>
</div>

<div id="outline-container-org04a5769" class="outline-3">
<h3 id="org04a5769"><span class="section-number-3">17.22</span> SERP Features</h3>
<div class="outline-text-3" id="text-17-22">
<p>
<a href="https://moz.com/blog/mega-serp-a-visual-guide-to-google">https://moz.com/blog/mega-serp-a-visual-guide-to-google</a>
<a href="https://moz.com/learn/seo/serp-features">https://moz.com/learn/seo/serp-features</a>
</p>
</div>
</div>

<div id="outline-container-org670647f" class="outline-3">
<h3 id="org670647f"><span class="section-number-3">17.23</span> Rich snippet, JSON-LD <a id="org63ffcf7">google:json-ld</a></h3>
<div class="outline-text-3" id="text-17-23">
<p>
LD stands for linked data.
Google Search Console &gt; Structured Data Markup Helper
</p>

<p>
<a href="https://json-ld.org/">https://json-ld.org/</a>
</p>

<p>
<a href="https://search.google.com/structured-data/testing-tool">https://search.google.com/structured-data/testing-tool</a>
<a href="https://developers.google.com/search/docs/guides/prototype">https://developers.google.com/search/docs/guides/prototype</a>
Guides
<a href="https://developers.google.com/search/docs/guides/search-gallery">https://developers.google.com/search/docs/guides/search-gallery</a>
Product Guide
<a href="https://developers.google.com/search/docs/data-types/product">https://developers.google.com/search/docs/data-types/product</a>
</p>

<p>
Full Vocabulary Schema.org <a href="https://schema.org/docs/full.html">https://schema.org/docs/full.html</a>
</p>

<p>
Reminder json shouldn't have double quotes or / backslashes. Any Unicode character should be fine.
</p>

<p>
Multiple <code>&lt;script type="application/ld+json"&gt;</code> are ok.
</p>
</div>

<div id="outline-container-org76917b3" class="outline-4">
<h4 id="org76917b3"><span class="section-number-4">17.23.1</span> keywords and syntax tokens</h4>
<div class="outline-text-4" id="text-17-23-1">
</div>
<div id="outline-container-orgcbf9321" class="outline-5">
<h5 id="orgcbf9321"><span class="section-number-5">17.23.1.1</span> @id</h5>
<div class="outline-text-5" id="text-17-23-1-1">
<p>
The node with @id can be referrenced either internally or externally on internet. The hash indicates Organization object not a page
</p>

<pre class="example">
{
"@context": "http://schema.org",
"@id": "https://www.apple.com/#organization"
"@type": "Organization",
}
</pre>
</div>
</div>

<div id="outline-container-org570b954" class="outline-5">
<h5 id="org570b954"><span class="section-number-5">17.23.1.2</span> @graph</h5>
<div class="outline-text-5" id="text-17-23-1-2">
<p>
Contain an array of nodes that are linked using @id
</p>
</div>
</div>
</div>

<div id="outline-container-org56ac3a9" class="outline-4">
<h4 id="org56ac3a9"><span class="section-number-4">17.23.2</span> Product</h4>
<div class="outline-text-4" id="text-17-23-2">
<pre class="example">
&lt;script type="application/ld+json"&gt;
{
  "@context" : "http://schema.org",
  "@type" : "Product",
  "name" : "Product 1",
  "image" : "http://mysite.com/uploads/1.jpg"
}
&lt;/script&gt;
</pre>

<p>
Multiple products
</p>
<pre class="example">
&lt;script type="application/ld+json"&gt;
[ {
  "@context" : "http://schema.org",
  "@type" : "Product",
  "name" : "Product 1",
  "image" : "http://mysite.com/uploads/1.jpg"
}, {
  "@context" : "http://schema.org",
  "@type" : "Product",
  "name" : "Product 2",
  "image" : "http://mysite.com/uploads/2.jpg"
} ]
&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-org89302d2" class="outline-4">
<h4 id="org89302d2"><span class="section-number-4">17.23.3</span> <a href="https://schema.org/Organization">Organization</a>, <a href="http://schema.org/WebSite">Website</a></h4>
<div class="outline-text-4" id="text-17-23-3">
<p>
<a id="org5f9da20">google:json-ld:organization</a>
Refer to <a href="#org5639fed">wp:plugin:wordpress-seo:json-ld</a>
</p>

<pre class="example">
{
  "@context": "http:\/\/schema.org",
  "@type": "Organization",
  "url": "https:\/\/mywebsite.com\/",
  "sameAs": [],
  "@id": "#organization",
  "name": "My Organization Name",
  "logo": "http:\/\/mywebsite.com\/wp-content\/uploads\/2018\/02\/logo.jpg",
  "contactPoint": [
    { "@type": "ContactPoint",
      "telephone": "+1-401-555-1212",
      "contactType": "customer service"
    }
  ]
}
</pre>
</div>
</div>

<div id="outline-container-org48a2128" class="outline-4">
<h4 id="org48a2128"><span class="section-number-4">17.23.4</span> <a href="https://schema.org/ContactPoint">ContactPoint</a></h4>
<div class="outline-text-4" id="text-17-23-4">
<p>
<a href="https://developers.google.com/search/docs/data-types/corporate-contact">https://developers.google.com/search/docs/data-types/corporate-contact</a>
</p>
</div>
</div>

<div id="outline-container-orge21821c" class="outline-4">
<h4 id="orge21821c"><span class="section-number-4">17.23.5</span> <a href="http://schema.org/LocalBusiness">LocalBusiness</a></h4>
<div class="outline-text-4" id="text-17-23-5">
<p>
<a href="https://developers.google.com/search/docs/data-types/local-business">https://developers.google.com/search/docs/data-types/local-business</a>
<a href="https://www.chrisains.com/seo/local-business-schema-mark-via-json-ld/">https://www.chrisains.com/seo/local-business-schema-mark-via-json-ld/</a>
</p>

<p>
It should have single address.
</p>
<pre class="example">
&lt;script type="application/ld+json"&gt;
{
    "@context" : "http://schema.org",
    "@type" : "LocalBusiness",
    "name" : "Your Business Name",
    "url" : "http://www.your-domain.co.uk",
    "logo": "http://www.your-domain.co.uk/images/your-logo.png",
    "image": "http://www.your-domain.co.uk/images/your-image.png",
    "address": {
        "@type" : "PostalAddress",
        "streetAddress": "1 The High Street",
        "addressLocality": "Colchester",
        "addressRegion": "Essex",
        "addressCountry": "US",
        "postalCode": "CO1 1AB",
        "telephone" : "01234 567 891"
    },
    "openingHours": [ "Mo-Fr 09:00-18:00", "Sa 10:00-16:00" ],
    "priceRange": "$$$",
    "geo": {
      "@type": "GeoCoordinates",
      "latitude": "40.75",
      "longitude": "73.98"
    },
    "hasmap" : "https://www.google.co.uk/maps/place/Buckingham+Palace/@51.501364,-0.1440787,17z/data=!3m1!4b1!4m5!3m4!1s0x48760520cd5b5eb5:0xa26abf514d902a7!8m2!3d51.501364!4d-0.14189",
    "sameAs" : [ "https://www.facebook.com/chrisains",
        "https://twitter.com/chrisains",
        "https://plus.google.com/+ChrisAinsworth",
        "https://www.youtube.com/user/chrisains1982" ] 
}
&lt;/script&gt;
</pre>

<p>
Multiple LocalBusiness's. This method Google shows no organization&#x2026;
</p>
<pre class="example">
// Include google:json-ld:organization

// LocalBusiness 1
{
  ...,
  @id: "https://example.com/url-first-location",
  ...,
  "parentOrganization": {
    "@type": "Organization",
    "@id": "Same as organization:@id",
    "name": "Same as organization:name" // Google requires a name for object
  }
}
</pre>
</div>
</div>

<div id="outline-container-org623a0c6" class="outline-4">
<h4 id="org623a0c6"><span class="section-number-4">17.23.6</span> OpeningHoursSpecification</h4>
<div class="outline-text-4" id="text-17-23-6">
<pre class="example">
"openingHoursSpecification": [
  {
    "@type": "OpeningHoursSpecification",
    "dayOfWeek": [
      "Monday",
      "Tuesday",
      "Wednesday",
      "Thursday",
      "Friday"
    ],
    "opens": "09:00",
    "closes": "21:00"
  },
  {
    "@type": "OpeningHoursSpecification",
    "dayOfWeek": [
      "Saturday",
      "Sunday"
    ],
    "opens": "10:00",
    "closes": "23:00"
  }
]
</pre>

<p>
Open 6pm on Saturday and close on 3am on Sunday
</p>
<pre class="example">
"openingHoursSpecification": {
  "@type": "OpeningHoursSpecification",
  "dayOfWeek": "Saturday",
  "opens": "18:00",
  "closes": "03:00"
}
</pre>

<p>
Open all day on Saturday and close all day on Sunday
</p>
<pre class="example">
"openingHoursSpecification": [
  {
    "@type": "OpeningHoursSpecification",
    "dayOfWeek": "Saturday",
    "opens": "00:00",
    "closes": "23:59"
  },
  {
    "@type": "OpeningHoursSpecification",
    "dayOfWeek": "Sunday",
    "opens": "00:00",
    "closes": "00:00"
  }
]
</pre>

<p>
Close for Winter
</p>
<pre class="example">
"openingHoursSpecification": {
  "@type": "OpeningHoursSpecification",
  "opens": "00:00",
  "closes": "00:00",
  "validFrom": "2015-12-23",
  "validThrough": "2016-01-05"
}
</pre>
</div>
</div>

<div id="outline-container-orga65e267" class="outline-4">
<h4 id="orga65e267"><span class="section-number-4">17.23.7</span> CreativeWork</h4>
<div class="outline-text-4" id="text-17-23-7">
<p>
<a href="https://schema.org/CreativeWork">https://schema.org/CreativeWork</a>
</p>

<p>
More specific types e.g. Article,  Blog, Book, Comment, Game, Map, Movie, Website etc.
</p>
</div>
</div>
</div>

<div id="outline-container-org974f43e" class="outline-3">
<h3 id="org974f43e"><span class="section-number-3">17.24</span> Remove URL from Google Index</h3>
<div class="outline-text-3" id="text-17-24">
<p>
This is to permanently remove a url from Google Search
</p>
<ul class="org-ul">
<li>Make the URL return 404 or 410 status</li>
<li>Don't block access to that URL using robots.txt</li>
<li>Return meta tag <code>&lt;meta name="robots" content="noindex, nofollow"&gt;</code></li>
<li>Return `X-Robots-Tag` HTTP header</li>
</ul>
<pre class="example">
&lt;Files ~ "\.pdf$"&gt;
  Header set X-Robots-Tag "noindex, nofollow"
&lt;/Files&gt;

$apacheURL = (strlen($_SERVER['REQUEST_URI'])) ?
  substr($_SERVER['REQUEST_URI'],1) : $_SERVER['REQUEST_URI'];
$noIndexNoFollow = array(
  "~^subscriber-services/trucking-renewal(.*)~i",
  "~^lookup-subscription(.*)~i",
  "~^users/(.*)~i",
  "~^user/(.*)~i",
);

if (!empty($apacheURL)) {
  foreach ($noIndexNoFollow as $key =&gt; $value) {
    $matches = array();
    if (preg_match($value, $apacheURL, $matches)) {
      header("X-Robots-Tag: noindex, nofollow", true);
    }
  }
}
</pre>

<p>
Go to Google Search Console and Fetch as Google to manually tell Google update index for that URL 
To check if the URL is removed: Make a <a href="https://www.google.com/webmasters/tools/removals">removal request</a> and it will tell you if the URL is removed.
</p>
</div>
</div>

<div id="outline-container-org6516fba" class="outline-3">
<h3 id="org6516fba"><span class="section-number-3">17.25</span> robots.txt</h3>
<div class="outline-text-3" id="text-17-25">
<p>
Default
</p>
<pre class="example">
User-agent: *
Disallow: /wp-admin/
Disallow: /wp-content/plugins/
Disallow: /readme.html
Disallow: /refer/

Sitemap: http://www.codeinwp.com/post-sitemap.xml

# Allow a useragent
# User-agent: PowerMapper
# Allow: /
</pre>
</div>
</div>

<div id="outline-container-org7419a04" class="outline-3">
<h3 id="org7419a04"><span class="section-number-3">17.26</span> Design &amp; User Experience</h3>
<div class="outline-text-3" id="text-17-26">
<p>
48 pixels width and height for buttons and they should be 32 pixels width and height separated apart.
</p>
</div>
</div>

<div id="outline-container-orgb92a4a2" class="outline-3">
<h3 id="orgb92a4a2"><span class="section-number-3">17.27</span> hreflang <a id="orge790135">html:hreflang</a></h3>
<div class="outline-text-3" id="text-17-27">
<p>
<a href="https://support.google.com/webmasters/answer/189077">https://support.google.com/webmasters/answer/189077</a>
Google Search Console looks for hreflang to determine language and location. Say if you want to target a generic domain like .com to a specific country/language, you should use hreflang and set in Google Search Console.
</p>

<p>
For more than one language, use multilingual plugins like <a href="#orgf8be1fc">wp:plugin:polylang</a> to insert hreflang
</p>

<p>
3 ways to implement
</p>
<ul class="org-ul">
<li>Inside <code>&lt;head&gt;</code></li>
<li>HTTP response header</li>
</ul>
<p>
To indicate a different language version of a URL (e.g. PDF)
</p>

<pre class="example">
Link: &lt;http://es.example.com/document.pdf&gt;; rel="alternate"; hreflang="es", &lt;http://en.example.com/document.pdf&gt;; rel="alternate"; hreflang="en", &lt;http://de.example.com/document.pdf&gt;; rel="alternate"; hreflang="de"
</pre>
<ul class="org-ul">
<li>Sitemap</li>
</ul>
</div>

<div id="outline-container-orgdf043e8" class="outline-4">
<h4 id="orgdf043e8"><span class="section-number-4">17.27.1</span> Inside <code>&lt;head&gt;</code></h4>
<div class="outline-text-4" id="text-17-27-1">
<pre class="example">
// General
&lt;link rel="alternate" hreflang="en-gb" href="http://en-gb.example.com/page.html" /&gt;
&lt;link rel="alternate" hreflang="en-us" href="http://en-us.example.com/page.html" /&gt;
&lt;link rel="alternate" hreflang="en"    href="http://en.example.com/page.html" /&gt;
&lt;link rel="alternate" hreflang="de"    href="http://de.example.com/page.html" /&gt;
&lt;link rel="alternate" hreflang="x-default" href="http://www.example.com/" /&gt;
// The reserved value hreflang="x-default" is used when no other language/region matches the user's browser setting. This value is optional, but recommended, as a way for you to control the page when no languages match. A good use is to target your site's homepage where there is a clickable map that enables the user to select their country.

// wp
&lt;?php global $wp;
      $current_url = home_url(add_query_arg(array(), $wp-&gt;request)); 
      // echo esc_url($current_url);
?&gt;
&lt;link rel="alternate" hreflang="&lt;?php echo get_bloginfo('language'); ?&gt;" href="http://es.example.com/" /&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org8a74fac" class="outline-3">
<h3 id="org8a74fac"><span class="section-number-3">17.28</span> Market Research</h3>
<div class="outline-text-3" id="text-17-28">
<p>
<a href="https://www.comscore.com/">https://www.comscore.com/</a>
30M Canadian Digital Audience, 11M Tablet, 18M Smartphone, 28M Desktop - 2017
Computer usage peaks at 7-8AM and all devices usage peak at 5-8PM - 2017
Mobile app usage is 86% compared to Mobile Web is 16% - 2017
Total time spent for all internet across devices: Desktop:38%, Smartphone App:38%
Total time spent for social media acrss devices: Desktop:21%, Smartphone App:50%
</p>
</div>
</div>

<div id="outline-container-org54267e3" class="outline-3">
<h3 id="org54267e3"><span class="section-number-3">17.29</span> Privacy Policy</h3>
<div class="outline-text-3" id="text-17-29">
<p>
<a href="https://www.digitalocean.com/legal/privacy/">https://www.digitalocean.com/legal/privacy/</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org1017bd2" class="outline-2">
<h2 id="org1017bd2"><span class="section-number-2">18</span> UX and Design</h2>
<div class="outline-text-2" id="text-18">
</div>
<div id="outline-container-orgddb478f" class="outline-3">
<h3 id="orgddb478f"><span class="section-number-3">18.1</span> Optimal Workshop</h3>
<div class="outline-text-3" id="text-18-1">
<p>
Usability Testing
</p>
<dl class="org-dl">
<dt>Tree testing</dt><dd>test how well readers can find specific content through navigation</dd>
<dt>Card sorting</dt><dd>how readers would sort or categorize content sections</dd>
<dt>First click testing</dt><dd>what is the first click if readers want specific content?</dd>
</dl>

<p>
<a href="https://www.ontario.ca/page/service-design-playbook">Ontario Digital Service - Service Design Playbook</a>
</p>
<ul class="org-ul">
<li>Ethnographic research</li>
<li>Personas</li>
<li>Journey maps</li>
<li>Service blueprints</li>
<li>Affinity mapping</li>
<li>Inclusive Design</li>
</ul>
</div>
</div>

<div id="outline-container-org5b1c800" class="outline-3">
<h3 id="org5b1c800"><span class="section-number-3">18.2</span> Mobile Design</h3>
<div class="outline-text-3" id="text-18-2">
<p>
Easy navigation
</p>
<ul class="org-ul">
<li>CTA button in front and centre position</li>
<li>Secondary CTA in menu or below the fold</li>
<li>Keep menu short, always have a button to go home</li>
</ul>
<p>
Easy search
</p>
<ul class="org-ul">
<li>Search should be one of the first things at the top users see</li>
<li>Display high relevant search results first</li>
<li>Provide search filters, preview of # of results, don't show zero results</li>
<li>Provide previous search</li>
<li>Ask questions to prefill filters</li>
</ul>
<p>
Easy conversions
</p>
<ul class="org-ul">
<li>Don't put gate too early which asks for commitment before users actually use the site</li>
<li>Prefill fields</li>
<li>Provide CTA for users don't want to fill up complex forms</li>
<li>Finish converting on another device on another day e.g. save and email jobs to apply for later</li>
</ul>
<p>
Easy forms
</p>
<ul class="org-ul">
<li>Provider features e.g. number pads, date picker</li>
<li>Users like tapping toggles instead of text enter or dropdown menu</li>
<li>Error-check entries immediately</li>
<li>Multi-part form with progress bar on top</li>
</ul>
<p>
Easy on mobile
</p>
<ul class="org-ul">
<li>Make product images expandable</li>
<li>Provide comparison features</li>
<li>Be responsive with visual feedback after significant actions</li>
<li>Ask for permissions in context e.g. show overlay over a map to ask for permissions for geolocation</li>
</ul>
</div>
</div>

<div id="outline-container-orgb84d9a4" class="outline-3">
<h3 id="orgb84d9a4"><span class="section-number-3">18.3</span> Google Material Design</h3>
<div class="outline-text-3" id="text-18-3">
<p>
Material Design Guidelines :: <a href="https://material.io/design/">https://material.io/design/</a>
</p>

<p>
Material Design Components (MDC)
</p>

<p>
Codelabs :: <a href="https://codelabs.developers.google.com/?cat=Design">https://codelabs.developers.google.com/?cat=Design</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orge8de443" class="outline-2">
<h2 id="orge8de443"><span class="section-number-2">19</span> Linux</h2>
<div class="outline-text-2" id="text-19">
</div>
<div id="outline-container-orgecc4987" class="outline-3">
<h3 id="orgecc4987"><span class="section-number-3">19.1</span> <a href="http://explainshell.com">Explain Shell</a></h3>
<div class="outline-text-3" id="text-19-1">
<p>
<a href="#org17ed2a3">bash:man</a>
</p>

<p>
which commandname :: show the executable path for the current environment
whereis commandname :: only searches certain directories but return path and also man page path
</p>
</div>
</div>

<div id="outline-container-org528098b" class="outline-3">
<h3 id="org528098b"><span class="section-number-3">19.2</span> System Version, Distro</h3>
<div class="outline-text-3" id="text-19-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>uanme -a</code></td>
<td class="org-left">all info</td>
</tr>

<tr>
<td class="org-left"><code>uname -r</code></td>
<td class="org-left">Kernal release</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>cat /etc/*release</code></td>
<td class="org-left">Linux distro</td>
</tr>

<tr>
<td class="org-left"><code>cat /etc/issue</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>cat /proc/version</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>lsb_release -a</code></td>
<td class="org-left">Ubuntu only</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>uname -a</li>
</ul>
<p>
Linux your-server-name 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
</p>

<p>
-n :: network node host name :: your-server-name
-r :: kernal release :: 4.4.0-116-generic
-v :: kernal version :: #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018
-m :: machine hardware name :: x86_64
-p :: processor type :: x86_64
-i :: hardware platform :: x86_64
-o :: operating system :: GNU/Linux
</p>

<ul class="org-ul">
<li>lsb_release -a</li>
</ul>
<p>
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 16.04.3 LTS
Release:        16.04
Codename:       xenial
</p>

<p>
lsb_release can be changed by apt-get dist-upgrade. After running it, lsb_release shows 16.04.04 using kernal 4.4.0-116-generic
</p>

<p>
When Ubuntu is first installed as 16.04.0, kernal generic 4.4 is installed and kernal 4.4.0-x will always be used when 16.04.0 is upgraded to 16.04.x
</p>

<p>
It looks like if generic kernal version is installed at the first place, it will stay at that version until special action to replace the generic kernal.
</p>
</div>

<div id="outline-container-org28b6878" class="outline-4">
<h4 id="org28b6878"><span class="section-number-4">19.2.1</span> Debian</h4>
<div class="outline-text-4" id="text-19-2-1">
<p>
cat /etc/debian_version
cat /etc/os-release
</p>
</div>
</div>

<div id="outline-container-orgf82842e" class="outline-4">
<h4 id="orgf82842e"><span class="section-number-4">19.2.2</span> Upgrade</h4>
<div class="outline-text-4" id="text-19-2-2">
<ul class="org-ul">
<li>sudo apt-get upgrade (-s for dry run)</li>
</ul>
<p>
Install newest versions of all packages currently installed on the system from the sources /etc/apt/sources.list
Packages currently installed with new versions will be retrieved and upgraded. No packages are removed or added. e.g. upgrade Firefox use this.
New versions of currently installed packages that cannot be upgraded without changing the install status of another package will be left at their current version. An update must be performed first so that apt-get knows that new versions of packages are available.
</p>

<ul class="org-ul">
<li>sudo apt-get -s dist-upgrade (-s for dry run)</li>
</ul>
<p>
In addition to performing the function of upgrade, also intelligently handles changing dependencies with new versions of packages; apt-get has a "smart" conflict resolution system, and it will attempt to upgrade the most important packages at the expense of less important ones if necessary. So, dist-upgrade command may remove some packages. The /etc/apt/sources.list file contains a list of locations from which to retrieve desired package files. See also apt_preferences(5) for a mechanism for overriding the general settings for individual packages.
</p>

<p>
By applying all package upgrades, the latest stable kernel will be pulled in.
</p>

<ul class="org-ul">
<li>sudo apt-get full-upgrade (Ubuntu 14.04+)</li>
</ul>
<p>
full-upgrade performs the function of upgrade but may also remove installed packages if that is required in order to resolve a package conflict.
</p>

<p>
CentOS :: <code>sudo yum update</code>
Fedora :: sudo dnf update
</p>

<p>
sudo reboot
</p>
</div>
</div>

<div id="outline-container-org8e0ea99" class="outline-4">
<h4 id="org8e0ea99"><span class="section-number-4">19.2.3</span> Ubuntu upgrade to a newer release</h4>
<div class="outline-text-4" id="text-19-2-3">
<p>
sudo do-release-upgrade
</p>

<p>
update-manager-core is needed
sudo apt-get install update-manager-core
</p>

<p>
Usually do these 2 first sudo apt-get update, upgrade and dist-grade and then do-release-upgrade
</p>

<p>
<a href="https://www.digitalocean.com/community/tutorials/how-to-upgrade-to-ubuntu-16-04-lts">https://www.digitalocean.com/community/tutorials/how-to-upgrade-to-ubuntu-16-04-lts</a>
</p>
</div>
</div>

<div id="outline-container-org2fc8b7d" class="outline-4">
<h4 id="org2fc8b7d"><span class="section-number-4">19.2.4</span> Kernal Bootloader</h4>
<div class="outline-text-4" id="text-19-2-4">
<p>
By default, the highest versioned kernel will boot.
</p>

<p>
To see the boot order:
grep 'menuentry ' $(find /boot -name "grub.cfg") | cut -f 2 -d "'" | nl -v 0
</p>

<p>
Default 0 will boot. To change, edit /etc/default/grub
</p>
<pre class="example">
. . .
GRUB_DEFAULT=saved
GRUB_SAVEDEFAULT=true
GRUB_DISABLE_SUBMENU=y
. . .
</pre>

<p>
More info: <a href="https://www.digitalocean.com/community/tutorials/how-to-update-a-digitalocean-server-s-kernel#booting-to-a-non-default-kernel-on-grub-2-distributions">https://www.digitalocean.com/community/tutorials/how-to-update-a-digitalocean-server-s-kernel#booting-to-a-non-default-kernel-on-grub-2-distributions</a>
Ubuntu 12.04, 14.04 and 16.04 uses Grub 2
</p>
</div>
</div>

<div id="outline-container-orgd504593" class="outline-4">
<h4 id="orgd504593"><span class="section-number-4">19.2.5</span> Shutdown Ubuntu</h4>
<div class="outline-text-4" id="text-19-2-5">
<p>
shutdown -h now
</p>
</div>
</div>
</div>

<div id="outline-container-org1bbec35" class="outline-3">
<h3 id="org1bbec35"><span class="section-number-3">19.3</span> Environment and Shell Variables</h3>
<div class="outline-text-3" id="text-19-3">
<p>
Child processes inherit the environmental variables of the parent process.
</p>

<p>
List all env. variables :: <code>printenv</code> or <code>env</code>
Get an env. variable :: <code>printenv HOME</code> or <code>echo $HOME</code>
</p>

<p>
Set an env. variable for the current shell and all processes started from current shell :: <code>export TERM=xterm-256color</code>
Set an env. variable using a shell variable :: <code>export TEST_VAR</code>
</p>

<p>
Set variable only for current shell :: VARNAME="value"
</p>

<p>
Set permanently for all future bash sessions, add such line to .bashrc file in $HOME
Set permanently and system wide (all users, all processes) add set variable in /etc/environment
<code>sudo nano /etc/environment</code>, then logout from current user and login again.
</p>

<p>
Use <code>env</code> to modify the environment that programs run in
</p>
<pre class="example">
env VAR1="blahblah" command_to_run command_options
</pre>

<p>
List all variables - shell, environmental, local and shell functions :: <code>set</code>
List only shell and environmental variables only :: <code>(set -o posix; set)</code>
</p>

<p>
Shell and env. variables should in uppercase while local variables should be in lowercase
</p>

<p>
Set a shell variable :: <code>TEST_VAR='Hello World!'</code>
Confirm a variable is not an env. variable :: <code>printenv | grep TEST_VAR</code>
Search a variable :: <code>set | grep TEST_VAR</code>
</p>

<p>
Demote an env. variable to shell variable :: <code>export -n TEST_VAR</code>
Unset a shell or env. variable :: <code>unset TEST_VAR</code>
</p>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">PWD</td>
<td class="org-left">Current directory</td>
</tr>

<tr>
<td class="org-left">OLDPWD</td>
<td class="org-left">Previous directory. <code>cd -</code></td>
</tr>

<tr>
<td class="org-left">_</td>
<td class="org-left">The most recent previously executed command</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Shell Variables</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org246e4fc" class="outline-3">
<h3 id="org246e4fc"><span class="section-number-3">19.4</span> User Management, Superuser, sudo</h3>
<div class="outline-text-3" id="text-19-4">
</div>
<div id="outline-container-orge972dd6" class="outline-4">
<h4 id="orge972dd6"><span class="section-number-4">19.4.1</span> Create and delete a user, Add user to sudo group <a id="orga16f4ec">linux:user</a></h4>
<div class="outline-text-4" id="text-19-4-1">
<p>
<code>sudo adduser corey</code>
<code>sudo deluser corey</code>
</p>

<p>
sudo is a group
As root user, run this to add the user to the sudo group
</p>
<pre class="example">
gpasswd -a username sudo
# or
# usermod -aG sudo username
# to list groups a user is in
groups username
</pre>

<p>
gpasswd is the same as to add user to a group
</p>
<pre class="example">
sudo usermod -aG agroupname ausername
# -aG keeps the existing groups the user belongs to and add the user to another group
</pre>

<p>
Use useradd for non-interactive (Docker)
<code>--usergroup, -U</code> :: Create a group with the same nanme as the user. 
<code>--create-home, -m</code> :: Create home directory if does not exist.
<code>--shell, -s</code> :: Assign a default shell for this user. <code>/bin/false</code> returns false then exit (logout).
</p>
<pre class="example">
useradd --user-group --create-home --shell /bin/false newusername
</pre>

<p>
<code>-o -u 1000</code> :: change UID to 1000, -o is to allow duplicate UID
</p>
</div>
</div>

<div id="outline-container-org7bb048c" class="outline-4">
<h4 id="org7bb048c"><span class="section-number-4">19.4.2</span> Group sudo</h4>
<div class="outline-text-4" id="text-19-4-2">
<p>
Run <code>visudo</code> to see permissions given to each group
And check sudo environment variable setting
</p>

<pre class="example">
root ALL=(ALL:ALL) ALL
</pre>
<p>
User root can run sudo as all hosts (1st ALL), all users, all groups and apply to all commands.
</p>

<p>
Start with % means is a group
</p>
<pre class="example">
%sudo   ALL=(ALL:ALL) ALL 
</pre>

<p>
Which group a user belongs to <code>groups username</code>
</p>

<p>
<a href="https://www.digitalocean.com/community/tutorials/how-to-edit-the-sudoers-file-on-ubuntu-and-centos">More info</a>
</p>
</div>
</div>

<div id="outline-container-orgad9c33a" class="outline-4">
<h4 id="orgad9c33a"><span class="section-number-4">19.4.3</span> Change a user's password</h4>
<div class="outline-text-4" id="text-19-4-3">
<p>
Login as root and run <code>passwd</code>, <code>sudo passwd ausername</code>
</p>
</div>
</div>

<div id="outline-container-orgd4c1b90" class="outline-4">
<h4 id="orgd4c1b90"><span class="section-number-4">19.4.4</span> List all users <code>cut -d: -f1 /etc/passwd</code> or <code>cat /etc/passwd</code></h4>
<div class="outline-text-4" id="text-19-4-4">
<ul class="org-ul">
<li>Login username</li>
<li>Password (always x)</li>
<li>UID (&lt;500 are system accounts, &gt; 500 are users)</li>
<li>Group ID (GID)</li>
<li>Comment field</li>
<li>Location of HOME directory</li>
<li>Default shell for the user</li>
</ul>
</div>
</div>

<div id="outline-container-orgde47f45" class="outline-4">
<h4 id="orgde47f45"><span class="section-number-4">19.4.5</span> Switch to superuser</h4>
<div class="outline-text-4" id="text-19-4-5">
<ul class="org-ul">
<li>Debian <code>sudo su</code></li>
<li>RedHat <code>sudo -</code></li>
</ul>
</div>
</div>

<div id="outline-container-org15db066" class="outline-4">
<h4 id="org15db066"><span class="section-number-4">19.4.6</span> Login to another user, Run command as another user</h4>
<div class="outline-text-4" id="text-19-4-6">
<p>
Login (need to type password) <code>/bin/su - username</code>
Run as a user (need to type password) <code>/bin/su - username -c 'whoami'</code>
</p>

<p>
As root user, run as another user without typing password <code>sudo -H -u username bash -c 'whoami'</code>
-H :: to use the target user's home directory
</p>
</div>
</div>

<div id="outline-container-orgdbb549f" class="outline-4">
<h4 id="orgdbb549f"><span class="section-number-4">19.4.7</span> Sudo run multiple commands</h4>
<div class="outline-text-4" id="text-19-4-7">
<p>
<code>sudo bash -c 'apt-get update;apt-get install'</code>
</p>
</div>
</div>

<div id="outline-container-org10ce5b5" class="outline-4">
<h4 id="org10ce5b5"><span class="section-number-4">19.4.8</span> Pass password as a file to sudo</h4>
<div class="outline-text-4" id="text-19-4-8">
<p>
<a id="org42611d6">linux:sudo:password</a>
<code>sudo -S your_script -var1 &lt;/path/to/file.txt</code>
</p>
</div>
</div>

<div id="outline-container-orgab9eed5" class="outline-4">
<h4 id="orgab9eed5"><span class="section-number-4">19.4.9</span> Require no password when sudo is run as another user <a id="orgf3161d5">linux:sudo:nopassword</a></h4>
<div class="outline-text-4" id="text-19-4-9">
<p>
User abc has sudo privilege. When abc is signed in and run a script/command that requires sudo, system will ask for password
<code>sudo ./path/to/script.sh</code> This bash file can contain <code>make start</code> where recipes may not have sudo in front.
</p>

<p>
Bypass so password input is not required
</p>

<p>
Instead of changing <code>/etc/sudoers</code> file directly, create/edit a file <code>/etc/sudoers.d/mybypass</code>
</p>
<pre class="example">
# See if there are some sample
sudo ls -al /etc/sudoers.d/

# found one sample
sudo cat /etc/sudoers.d/mybypass

# have to use visudo to edit /etc/sudoers and /etc/sudoers.d/anyfile files.
# -f is to specify a file, otherwise is the default /etc/sudoers file
sudo visudo -f /etc/sudoers.d/mybypass

# Add this line
abc ALL = (root) NOPASSWD: /path/to/script.sh
# allow user abc on ALL hosts to run a specific command without entering password
# all other sudo commands will still require a password

# ~/etc/sudoers.d/mybypass file should have permission 0440 and owner:group is root:root
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbd45e97" class="outline-3">
<h3 id="orgbd45e97"><span class="section-number-3">19.5</span> SSH, scp, sshpass <a id="org31ed5e3">linux:ssh</a> <a id="orge67d153">bash:ssh</a> <a id="orge79c91e">bash:scp</a></h3>
<div class="outline-text-3" id="text-19-5">
<p>
Refer to <a href="#orgeecb892">aws:scp</a> <a href="#orged28a75">linux:package:openssh-client</a>
</p>
</div>

<div id="outline-container-org088a543" class="outline-4">
<h4 id="org088a543"><span class="section-number-4">19.5.1</span> Transfer Client Key to Host</h4>
<div class="outline-text-4" id="text-19-5-1">
<p>
Generate a private key on your local machine <code>ssh-keygen -t rsa</code>
Under folder <code>/Users/username/.ssh/</code> id_rsa.pub is the public key and id_rsa is the private key
</p>
<dl class="org-dl">
<dt>Show the public key and later copy to cloud server</dt><dd><code>cat ~/.ssh/id_rsa.pub</code></dd>
</dl>

<p>
When using private key you might encounter <code>Permissions 0777 for '~/.ssh/id_rsa_your_private_key' are too open</code>
Use <code>chmod 400 ~/.ssh/id_rsa_your_private_key</code> to fix it <a href="#orgcf2eaa1">chmod:400</a>
</p>
</div>

<div id="outline-container-org4541b17" class="outline-5">
<h5 id="org4541b17"><span class="section-number-5">19.5.1.1</span> Manual way</h5>
<div class="outline-text-5" id="text-19-5-1-1">
<p>
On the remote server, login as a normal user <code>sudo su - username</code>
Create <code>/.ssh directory ~mkdir .ssh</code> <code>chmod 700 .ssh</code>
Create file and paste the public key <code>nano .ssh/authorized_keys</code>
</p>

<p>
Or concatenate it onto <code>authorized_keys</code> file manually
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #74af68;"># </span><span style="color: #74af68;">backup first</span>
cp authorized_keys authorized_keys_Backup
cat id_rsa.pub &gt;&gt; authorized_keys
</pre>
</div>

<p>
Change permission <code>chmod 600 .ssh/authorized_keys</code> <a href="#orgef1fc26">chmod:600</a>
</p>

<p>
Add a name to id_rsa.pub
</p>
<pre class="example">
cat yourpubkey.pub
ssh-rsa longstring yourname@yourhost
</pre>
</div>
</div>

<div id="outline-container-org92a21d4" class="outline-5">
<h5 id="org92a21d4"><span class="section-number-5">19.5.1.2</span> Fast way</h5>
<div class="outline-text-5" id="text-19-5-1-2">
<p>
Append the client public key to remote host's <code>/.ssh/authorized_keys</code> :: <code>ssh-copy-id remoteusername@123.45.56.78</code>
Or specify a public key file :: <code>ssh-copy-id -i ~/.ssh/mykey remoteusername@123.45.56.78</code>
</p>
</div>
</div>

<div id="outline-container-org3667595" class="outline-5">
<h5 id="org3667595"><span class="section-number-5">19.5.1.3</span> Remove passphrase for private key id_rsa</h5>
<div class="outline-text-5" id="text-19-5-1-3">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #74af68;"># </span><span style="color: #74af68;">Make a backup</span>
cp ~/.ssh/id_rsa ~/.ssh/id_rsa.backup
rm ~/.ssh/id_rsa

<span style="color: #74af68;"># </span><span style="color: #74af68;">remove passphrase</span>
openssl rsa -in ~/.ssh/id_rsa -out ~/.ssh/id_rsa_new

<span style="color: #74af68;"># </span><span style="color: #74af68;">enter old passphrase</span>
cp ~/.ssh/id_rsa_new ~/.ssh/id_rsa
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgbc13344" class="outline-4">
<h4 id="orgbc13344"><span class="section-number-4">19.5.2</span> ssh config</h4>
<div class="outline-text-4" id="text-19-5-2">
<p>
Create ssh host alias and the private key to use in <code>~/.ssh/config</code> file
cd <code>/.ssh &amp;&amp; nano config, ~chmod 600 ~/.ssh/config</code>
</p>
<pre class="example">
Host *
  ServerAliveInterval 240
  ServerAliveCountMax 2

Host scotch
    HostName scotch.io
    User nick

Host example2
    HostName example.com
    User root

Host example3
    HostName 64.233.160.0
    User userxyz123
    Port 56000
    ServerAliveInterval 240
    ServerAliveCountMax 2

Host amazon1
    HostName ec2.amazon.com
    User ec2-user
    IdentityFile /path/to/special/privatekey/amazon.pem
</pre>

<p>
Sends a packet to the server every 240 seconds (4 minutes). If the client does not receive a response after 2 tries, it closes the connection.
</p>

<p>
In Putty, under Connection &gt; Seconds between keepalives &gt; 240
</p>
</div>
</div>

<div id="outline-container-org1e9979b" class="outline-4">
<h4 id="org1e9979b"><span class="section-number-4">19.5.3</span> Use private key from SSH server to connect</h4>
<div class="outline-text-4" id="text-19-5-3">
<p>
AWS uses .pem file as the private key on its SSH server.
Convert this .pem file in PuttyGen and later uses it to connect to AWS
Refer to <a href="#orgecb24f1">aws:ssh</a>
</p>
</div>
</div>

<div id="outline-container-orge8d0daf" class="outline-4">
<h4 id="orge8d0daf"><span class="section-number-4">19.5.4</span> Restart SSH <a id="org88ad0a8">linux:ssh:restart</a></h4>
<div class="outline-text-4" id="text-19-5-4">
<dl class="org-dl">
<dt>General</dt><dd><code>service ssh restart</code></dd>
<dt>Ubuntu</dt><dd><code>sudo systemctl reload sshd</code> (16.04) or <code>sudo systemctl restart sshd</code> (16.04) or <code>sudo restart ssh</code> (14.04)</dd>
</dl>
</div>
</div>

<div id="outline-container-orgf012090" class="outline-4">
<h4 id="orgf012090"><span class="section-number-4">19.5.5</span> Backup sshd_config file</h4>
<div class="outline-text-4" id="text-19-5-5">
<pre class="example">
sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.factory-defaults
sudo chmod a-w /etc/ssh/sshd_config.factory-defaults
</pre>
</div>
</div>

<div id="outline-container-org2ecd160" class="outline-4">
<h4 id="org2ecd160"><span class="section-number-4">19.5.6</span> Disallow SSH as root user, SSH Daemon Config <a id="orgf4a5402">linux:ssh:disallow_root</a></h4>
<div class="outline-text-4" id="text-19-5-6">
<p>
Login as root then
<code>nano /etc/ssh/sshd_config</code>
Change <code>PermitRootLogin yes</code> to no
Restart SSH
Before logout, open another terminal to see if it works.
</p>

<p>
Default SSH port is 22
</p>
</div>
</div>

<div id="outline-container-org976e16b" class="outline-4">
<h4 id="org976e16b"><span class="section-number-4">19.5.7</span> Disable Password Authentication</h4>
<div class="outline-text-4" id="text-19-5-7">
<p>
Force to use public key only instead of plain password only
<code>nano /etc/ssh/sshd_config</code>
Replace <code>#PasswordAuthentication yes</code> with <code>PasswordAuthentication no</code>
These are supposed to be default. If not, change to as below
</p>
<pre class="example">
PubkeyAuthentication yes
ChallengeResponseAuthentication no
</pre>

<p>
<a href="#org88ad0a8">linux:ssh:restart</a>
</p>
</div>
</div>

<div id="outline-container-org1fbfecc" class="outline-4">
<h4 id="org1fbfecc"><span class="section-number-4">19.5.8</span> Login without setting public keys <a id="orgda85400">bash:sshpass</a></h4>
<div class="outline-text-4" id="text-19-5-8">
<p>
<a href="https://www.cyberciti.biz/faq/noninteractive-shell-script-ssh-password-provider/">https://www.cyberciti.biz/faq/noninteractive-shell-script-ssh-password-provider/</a>
</p>

<pre class="example">
apt-get install sshpass

sshpass -p 't@uyM59bQ' ssh -o StrictHostKeyChecking=no username@server.example.com

# StrictHostKeyChecking is for shell script to ignore prompt

# Use a file for password, this is the most reliable way when it has special characters for rsync
echo 'myPassword' &gt; myfile
chmod 0400 myfile
sshpass -f myfile ssh vivek@server42.cyberciti.biz

# scp
sudo sshpass -p 'abc' scp -o StrictHostKeyChecking=no -r /local/path/archive/ user@1.2.3.4:/remote/path/dtp-tmp/

# use with rsync
rsync --rsh="sshpass -p myPassword ssh -l username" server.example.com:/var/www/html/ /backup/

# ssh -l means to specify a username to login

# use environment variable SSHPASS to store password and it has to SSHPASS
SSHPASS='yourPasswordHere'
rsync --rsh="sshpass -e ssh -l username" server.example.com:/var/www/html/ /backup/

# gpg encrypted file
echo 'mySshPasswordHere' &gt; .sshpassword
gpg -c .sshpassword
rm .sshpassword
gpg -d -q .sshpassword.gpg &gt; fifo; sshpass -f fifo ssh vivek@server1.cyberciti.biz
</pre>
</div>
</div>

<div id="outline-container-org9709bcf" class="outline-4">
<h4 id="org9709bcf"><span class="section-number-4">19.5.9</span> Random password</h4>
<div class="outline-text-4" id="text-19-5-9">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #74af68;"># </span><span style="color: #74af68;">base64 will likely to have = at the end, remove that to have length 16</span>
openssl rand -base64 17

<span style="color: #74af68;"># </span><span style="color: #74af68;">hex has only number and lowercased letters</span>
openssl rand -hex 16
</pre>
</div>
</div>
</div>

<div id="outline-container-org06e814a" class="outline-4">
<h4 id="org06e814a"><span class="section-number-4">19.5.10</span> Run command</h4>
<div class="outline-text-4" id="text-19-5-10">
<pre class="example">
ssh user1@server1 command1
ssh user1@server1 'command2'
ssh user1@server1 'command1 | command2'

ssh usehostinssh-config 'long command'

// escape single quote inside command
// wrong
ssh host1 'mysqldump -u user --password='$(dbpw)' dbname &gt; ~/db.sql'
// correct
ssh host1 'mysqldump -u user --password='"'"'$(dbpw)'"'"' dbname &gt; ~/db.sql'
</pre>
</div>
</div>

<div id="outline-container-orgec172dc" class="outline-4">
<h4 id="orgec172dc"><span class="section-number-4">19.5.11</span> SSH tunneling</h4>
<div class="outline-text-4" id="text-19-5-11">
<p>
Port forwarding is also called tunneling.
</p>

<p>
Say your IMAP port 143 to gmail is blocked by Wi-fi firewall. 
</p>

<p>
Default ssh port is 22. Default https port is 443.
</p>

<p>
For Github and BitBucket, you can directly change to use port 443 without doing anything.
</p>

<p>
If you have control of the target server's ssh server, simply just add port 443 to /etc/ssh/sshd_config and use -p 443 locally.
</p>

<pre class="example">
Host github.com
  Hostname ssh.github.com
  Port 443

Host bitbucket.org
  Hostname altssh.bitbucket.org
  Port 443
</pre>
</div>

<div id="outline-container-orge1e641b" class="outline-5">
<h5 id="orge1e641b"><span class="section-number-5">19.5.11.1</span> Port Forwarding via a single intermediate host</h5>
<div class="outline-text-5" id="text-19-5-11-1">
<p>
In the intermediate host with ssh server installed, add the line <code>Port 443</code> to /etc/ssh/sshd_config, <a href="#org88ad0a8">linux:ssh:restart</a>, <code>sudo ufw allow 443/tcp</code>
</p>

<p>
Check if it connects from local <code>ssh -p 443 my.server.com</code>
</p>

<p>
Then open, listen and forward port 10143 to destination imap.google.com at port 143 using intermediate host at 443
</p>
<pre class="example">
ssh -L localhost:10143:mail.google.com:143 -p 443 user@my.server.com
</pre>

<p>
Refer to <a href="#org96918c4">network:port</a> on port range you should use
</p>

<p>
Change email client setting to use localhost at port 10143
</p>

<p>
Multiple redirections can be set up in the same tunnel
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #74af68;"># </span><span style="color: #74af68;">add -f to go into background and -N to not launch a shell</span>
ssh -L localhost:10143:mail.google.com:143 localhost:10022:target.server.com:22 -p 443 user@my.server.com
</pre>
</div>

<p>
Now SSH to localhost:10022 will be forwarded to target_server_user@target.server.com:22 through SSH server user@my.server.com:443
</p>
<div class="org-src-container">
<pre class="src src-sh">ssh -p 10022 target_server_user@localhost
scp -P 10022 localhost:/target/server/path/ /local/path/
rsync -av -e <span style="color: #e67128;">"ssh -p 10022"</span> /target/server/path localhost:/local/path/
</pre>
</div>

<dl class="org-dl">
<dt>-L [bind_address:]port:host:hostport</dt><dd>specifies that the given port on the local (client) host is to be forwarded to the given host and port on the remote side. Allocate a socket to listen to <code>port</code> on the local side, optionally bound to the specified <code>bind_address</code>. Whenever a connection is made to this port, the connection is forwarded over the secure channel, and a connection is made to <code>host</code> port <code>hostport</code> from the remote machine.
<dl class="org-dl">
<dt>Summary</dt><dd>[localhost | bind_address]:port &gt; -p 443 user@my.server.com (SSH) &gt; host:hostport (access from my.server.com)</dd>
</dl></dd>

<dt>-D [bind_addres:]port</dt><dd>similar to -L but the destionation host:hostport is not specified. It's called dynamic application-level port forwarding.
<ul class="org-ul">
<li>e.g. <code>ssh -ND 10022 -p 443 user@my.server.com</code></li>
<li id="Putty">setup SSH to my.server.com as usual and then Connection &gt; SSH &gt; Tunnels &gt; Uncheck everything except adding source port e.g. 10022 so that Forwarded ports become D10022 and check Dynamic and Auto.</li>
<li id="Now a proxy server is set up">127.0.0.1:10022</li>
<li>On my.server.com, set up custom records to resolve domains in file <code>/etc/hosts</code></li>
<li><a href="http://michalcichon.blogspot.com/2014/03/ssh-tunneling-using-putty-and-google.html">Config to start Chrome using a proxy server</a></li>
</ul></dd>
</dl>

<div class="org-src-container">
<pre class="src src-sh">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe --proxy-server=<span style="color: #e67128;">"socks5://127.0.0.1:10022"</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">or</span>

chrome.exe --proxy-server=<span style="color: #e67128;">"socks5://127.0.0.1:10022"</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">The hostname for destination URLs will be resolved by the proxy server.</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">ftp:// URLs though a SOCKS proxy is not implemented</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">To prevent Chrome from sending any DNS requests over the network (e.g. DNS prefetch uses direct DNS resolve even though proxy is used)</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">--host-resolver-rules="MAP * ~NOTFOUND , EXCLUDE myproxy"</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">Verify proxy setting</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">chrome://net-internals/#proxy</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">Verify DNS resolving</span>
chrome://net-internals/#dns

<span style="color: #74af68;"># </span><span style="color: #74af68;">Verify proxy logic for individual requests</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">chrome://net-internals/#events</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">Use HTTP proxy "foopy:80" for http URLs and HTTP proxy "foopy2:80" for ftp URLs</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">Without scheme and a single proxy :: use that proxy for all URLs</span>
chrome.exe --proxy-server=<span style="color: #e67128;">"http=foopy:80;ftp=foopy2"</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">--proxy-bypass-list=(&lt;trailing_domain&gt;|&lt;ip-address&gt;)[:&lt;port&gt;][;...]</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">* can be used</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">--proxy-server="foopy:8080" --proxy-bypass-list="*.google.com;*foo.com;127.0.0.1:8080"</span>

</pre>
</div>

<dl class="org-dl">
<dt>-R [bind_address:]port:host:hostport</dt><dd>Specifies that the given port on the remote (server) host is to be forwarded to the given host and port on the local side. This works by allocating a socket to listen to <code>port</code> on the remote side, and whenever a connection is made to this port, the connection is forwarded over the secure channel, and a connection is made to <code>host</code> port <code>hostport</code> from the local machine.
<dl class="org-dl">
<dt>Summary</dt><dd><code>port</code> my.server.com (access from internet) &gt; -p 443 user@my.server.com (SSH) &gt; from remote forward to host:hostport (at local).</dd>
<dt>(no term)</dt><dd>host:hostport is usually localhost:8888</dd>
<dt>(no term)</dt><dd>e.g. people on the internet my.server.com:9000 to access your localhost:8001. Run this locally, and the SSH server my.server.com will open a port 9000 which forwards request to your localhost:8001</dd>
<dt>(no term)</dt><dd><code>ssh -R 9000:localhost:8001 -p 443 user@my.server.com</code></dd>
<dt>(no term)</dt><dd>In order to use -R, on my.server.com add this line to /etc/ssh/sshd_config then <a href="#org88ad0a8">linux:ssh:restart</a></dd>
</dl></dd>
</dl>
<pre class="example">
GatewayPorts yes
</pre>

<dl class="org-dl">
<dt>-g</dt><dd>allows remote hosts to connect to local forwarded ports.</dd>
<dt>-N</dt><dd>don't run command. Just forwarding ports.</dd>
</dl>
</div>
</div>

<div id="outline-container-org31629ee" class="outline-5">
<h5 id="org31629ee"><span class="section-number-5">19.5.11.2</span> SOCKS server</h5>
<div class="outline-text-5" id="text-19-5-11-2">
<p>
Run a SOCKS server on a given port, and set applications to use SOCKS, either natively or forcibly.
When the app uses SOCKS, all its network connections are routed through the SOCKS server which forwards it to all your server on internet.
</p>

<p>
Open port 443 on my.server.com like the above solution.
</p>

<p>
Install tsocks on localhost <code>sudo apt-get install tsocks</code> and configure tsocks, /etc/tsocks.conf, near the end, change it to
</p>
<pre class="example">
server -127.0.0.1 port = 1080
</pre>

<p>
Bind traffic to local port 1080 to the jump host. Run locally
<code>ssh -D 1080 -p 443 user@my.server.com</code>
</p>

<p>
Run applications using tsocks. Run locally:
<code>tsocks skype tsocks kopete tsocks kmail tsocks ftp someserver.com tsocks ssh user@target.server.com</code>
</p>

<p>
Notes
</p>
<ul class="org-ul">
<li>FTP has to be in passive mode</li>
<li>Some applications might not support tsocks</li>
</ul>
</div>
</div>

<div id="outline-container-org236b321" class="outline-5">
<h5 id="org236b321"><span class="section-number-5">19.5.11.3</span> SOCKS on Windows</h5>
<div class="outline-text-5" id="text-19-5-11-3">
<p>
Windows <code>Internet Options</code> can set SOCKS5 as proxy. However, DNS will be resolved locally at client. While Chrome and FireFox support resolving DNS on the proxy DNS.
</p>

<p>
On Windows, use the portable <a href="https://www.sockscap64.com/homepage/">SocksCap64</a>, run it as admin, setup SOCKS5 proxy, and add individual Windows application as executable, select the app and click Run!
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org272750c" class="outline-3">
<h3 id="org272750c"><span class="section-number-3">19.6</span> fail2ban <a id="org03459e3">linux:fail2ban</a></h3>
<div class="outline-text-3" id="text-19-6">
<p>
Ban access to services (e.g. SSH) for max tries and ban time based on service's log.
</p>

<p>
Check if it's installed <code>ll /etc/fail2ban</code>
</p>

<p>
Install <code>sudo apt-get update</code> <code>sudo apt-get install fail2ban</code>
Create jail.local based on jail.conf by commenting out every line
</p>
<pre class="example">
awk '{ printf "# "; print; }' /etc/fail2ban/jail.conf | sudo tee /etc/fail2ban/jail.local
</pre>

<p>
Modify jail.local <code>sudo nano /etc/fail2ban/jail.local</code>
</p>

<p>
By default, fail2ban is enabled for sshd service only and disabled for every service (allow every access).
</p>
<pre class="example">
[DEFAULT]
ignoreip = 127.0.0.1/8

# 600 seconds = 10 minutes
bantime = 600
maxretry = 3

# 3 tries within 10 minutes
findtime = 600

# For a service, fail2ban can search if a log file has certain text and mark it as a authentication failure
[nginx-http-auth]
enabled = true

# regex pattern is defined in /etc/fail2ban/filter.d/ngix-http-auth.conf
# You usually don't modify these .conf files
</pre>

<p>
Restart the service <code>sudo service fail2ban restart</code>
</p>

<p>
To see which service has fail2ban enabled <code>sudo fail2ban-client status</code>
</p>

<p>
To see detail about a service that has fail2ban enabled <code>sudo fail2ban-client status sshd</code>
</p>

<p>
To unban an IP for service <code>sudo fail2ban-client set apache unbanip 111.111.111.111</code>
</p>

<p>
<a href="https://www.digitalocean.com/community/tutorials/how-to-protect-ssh-with-fail2ban-on-ubuntu-14-04">More info</a>
</p>

<p>
<a href="https://www.digitalocean.com/community/tutorials/how-to-protect-an-apache-server-with-fail2ban-on-ubuntu-14-04">Apache and fail2ban</a>
</p>
</div>
</div>

<div id="outline-container-org5d480b6" class="outline-3">
<h3 id="org5d480b6"><span class="section-number-3">19.7</span> System</h3>
<div class="outline-text-3" id="text-19-7">
<p>
Resource Limits
<code>sudoedit /etc/security/limits.conf</code>
</p>

<p>
System Logs
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">/var/log/syslog</td>
<td class="org-left">general system log</td>
</tr>

<tr>
<td class="org-left">/var/log/auth.log</td>
<td class="org-left">system auth logs</td>
</tr>

<tr>
<td class="org-left">/var/log/mail.log</td>
<td class="org-left">system mail logs</td>
</tr>

<tr>
<td class="org-left">/var/log/messages</td>
<td class="org-left">general log messages</td>
</tr>

<tr>
<td class="org-left">/var/log/dmesg</td>
<td class="org-left">kernel ring buffer msg, e.g. system bootup</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Search a word `warthog` in .gz files
<code>zgrep -i warthog /var/log/*.gz</code> 
</p>
</div>
</div>

<div id="outline-container-org4da0a6a" class="outline-3">
<h3 id="org4da0a6a"><span class="section-number-3">19.8</span> Filesystem</h3>
<div class="outline-text-3" id="text-19-8">
</div>
<div id="outline-container-org9f627d3" class="outline-4">
<h4 id="org9f627d3"><span class="section-number-4">19.8.1</span> /dev /mnt /media</h4>
<div class="outline-text-4" id="text-19-8-1">
<p>
<code>/dev/sd*1</code> :: sd for SATA or SCSI drive, numeric 1 for partition, * for a, b, etc.
<code>/dev/hd*1</code> :: hd for IDE drive, * for a, b, etc.
<code>/media/win1</code>
</p>
<ul class="org-ul">
<li>virtual directory  where files are accessed file here.</li>
<li>Equivalent to d:\. One or more partitions can be assigned to one media</li>
</ul>

<p>
<code>sudo mkdir /media/win2</code> :: create a virtual directory is easy
<code>sudo mkdir /mnt/my_mount</code> :: also creates a virtual directory
</p>

<p>
<code>sudo mount -t ext4 /dev/sda1 /mnt/my_mount</code> :: Mount a partitioned device to a virtual directory
<code>sudo gedit /etc/fstab</code>
, <code>/dev/hdb1 media/win1 vfat users,rw,owner,umask=000 0 0</code>
, then reload <code>sudo mount -a</code>
</p>
<ul class="org-ul">
<li>Permanently mount during bootime</li>
</ul>
</div>
</div>

<div id="outline-container-orgb1bf5e3" class="outline-4">
<h4 id="orgb1bf5e3"><span class="section-number-4">19.8.2</span> bindfs <a id="org45a08b4">linux:bindfs</a></h4>
<div class="outline-text-4" id="text-19-8-2">
<p>
Tested on Ubuntu Xenial
Create a user devone and mount /home/devone/websites/application1 to /var/www/application1 which is owned by www-data
devone can create/edit files while the destination folder maintain the same owner www-data and permissions.
</p>
<pre class="example">
apt-get update
apt-get -y install bindfs

adduser devone
mkdir -p /home/devone/websites/application1
chown -Rf devone:devone /home/devone/websites
chmod -Rf 770 /home/devone/websites

nano /etc/fstab
bindfs#/var/www/application1 /home/devone/websites/application1 fuse force-user=devone,force-group=devone,create-for-user=www-data,create-for-group=www-data,create-with-perms=0644,chgrp-ignore,chown-ignore,chmod-ignore 0 0  

mount /home/devone/websites/application1
// if your system yells about force-user or force-group not being defined:
// replace force-user by owner
// replace force-group by group

// Test
su - devone
cd ~/websites/application1
touch hello.txt
ls -al hello.txt
-rwxrwx--- 1 devone devone 0 sept. 10 17:15 hello.txt

exit
cd /var/www/application1
ls -al hello.txt
-rwxrwx--- 1 www-data www-data 0 sept. 10 17:15 helloworld.txt
</pre>

<p>
Make sure www-data user owns /var/www can prevent devone directly access the folder
</p>
<pre class="example">
chown www-data:www-data /var/www
chmod 770 /var/www
</pre>

<p>
If /etc/fstab is modified and you want to remount to reflect the changes. Unmount the existing first
</p>
<pre class="example">
umount /home/devone/websites/application1
// if that fails, try to navigate out of the /home/devone/websites/application1 for all users
// or use -l for lazy and -f for force
// umount -l /home/devone/websites/application1
mount /home/devone/websites/application1

// or mount -a to mount all entries in /etc/fstabs
</pre>

<p>
<a href="http://blog.netgusto.com/solving-web-file-permissions-problem-once-and-for-all/">http://blog.netgusto.com/solving-web-file-permissions-problem-once-and-for-all/</a>
</p>
</div>
</div>

<div id="outline-container-org3ee0a75" class="outline-4">
<h4 id="org3ee0a75"><span class="section-number-4">19.8.3</span> /etc system configuration files</h4>
</div>
<div id="outline-container-org62cc9c3" class="outline-4">
<h4 id="org62cc9c3"><span class="section-number-4">19.8.4</span> Disk space <a id="org8443723">linux:du</a></h4>
<div class="outline-text-4" id="text-19-8-4">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>df -h</code></td>
<td class="org-left">Disk usage on OS</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">h for human-readable.</td>
</tr>

<tr>
<td class="org-left"><code>du -sh</code></td>
<td class="org-left">Current folder size. -s shows total only</td>
</tr>

<tr>
<td class="org-left"><code>du -sh ./*</code></td>
<td class="org-left">List sizes of 1st level child folders and files</td>
</tr>

<tr>
<td class="org-left"><code>du -sh ./wp-content/*</code></td>
<td class="org-left">List sizes of 1st level child folders of one folder</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Disk usage in current folder including all sub folders but excluding one sub folder
du &#x2013;exclude=./wp-content/uploads &#x2013;exclude=./wp-content/error_log -sh
</p>

<p>
du &#x2013;exclude-from 'path/to/files.txt'
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #74af68;"># </span><span style="color: #74af68;">Only get down to 1 level. When max-depth &gt; 0, -s cannot be used.</span>
du --max-depth=1 -h

<span style="color: #74af68;"># </span><span style="color: #74af68;">sort by size in MB</span>
du --max-depth=1 -h -m | sort -h

<span style="color: #74af68;"># </span><span style="color: #74af68;">Do not count subdirectories size</span>
du --max-depth=1 -Sh
</pre>
</div>

<p>
Search which directory has taken up space
Highlight lines that have M or G in front for file size
</p>

<div class="org-src-container">
<pre class="src src-sh">du -cha --max-depth=1 / | sort -h | grep -E <span style="color: #e67128;">"^[0-9\.]*[MG]"</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">say /var has taken up space</span>
du -cha --max-depth=1 /var | sort -h | grep -E <span style="color: #e67128;">"^[0-9\.]*[MG]"</span>
</pre>
</div>

<pre class="example">
du -cha --max-depth=1 / | sort -h | grep -E "^[0-9\.]*[MG]"

// say /var has taken up space
du -cha --max-depth=1 /var | sort -h | grep -E "^[0-9\.]*[MG]"
</pre>

<p>
du options
</p>
<dl class="org-dl">
<dt>-c, &#x2013;total</dt><dd>have a grand total line at the bottom</dd>
<dt>-a, &#x2013;all</dt><dd>write counts for all files, not just directories</dd>
<dt>-m</dt><dd>same as &#x2013;block-size=1M</dd>
<dt>-B, &#x2013;block-size=SIZE</dt><dd>SIZE can be K, M, G, T, P, E, Z, Y</dd>
</dl>
</div>

<div id="outline-container-org370478f" class="outline-5">
<h5 id="org370478f"><span class="section-number-5">19.8.4.1</span> Large file deleted but still no space</h5>
<div class="outline-text-5" id="text-19-8-4-1">
<p>
Delete file reserved by process
</p>
<pre class="example">
sudo lsof / | grep deleted
</pre>

<p>
Either restart the service that is using the file or kill the process
</p>

<p>
check inodes usage. Delete old files to release inodes
</p>
<pre class="example">
sudo df -i /
</pre>
</div>
</div>

<div id="outline-container-org9cf43d9" class="outline-5">
<h5 id="org9cf43d9"><span class="section-number-5">19.8.4.2</span> /tmp is mounted as overflow (often sized at 1MB).</h5>
<div class="outline-text-5" id="text-19-8-4-2">
<p>
It's likely due to /tmp was not specified as its own partition and the root filesystem filled up and "/tmp" was remounted as a fallback.
After space has been cleared, just unmount the fallback and it should remount at tis original point.
</p>
<pre class="example">
sudo umount overflow
# or
sudo umount /tmp
</pre>
</div>
</div>

<div id="outline-container-org48382cd" class="outline-5">
<h5 id="org48382cd"><span class="section-number-5">19.8.4.3</span> Swap</h5>
<div class="outline-text-5" id="text-19-8-4-3">
<pre class="example">
free
# if swap is not enabled, it shows
Swap: 0 0 0

# or another to see if swap is on, is to list
sudo swapon --show
</pre>
</div>

<ol class="org-ol">
<li><a id="orga7de319"></a>Swap partition is recommended<br /></li>
<li><a id="orgf64f0c0"></a>Swap file<br />
<div class="outline-text-6" id="text-19-8-4-3-2">
<p>
<a href="https://www.digitalocean.com/community/tutorials/how-to-configure-virtual-memory-swap-file-on-a-vps">https://www.digitalocean.com/community/tutorials/how-to-configure-virtual-memory-swap-file-on-a-vps</a>
</p>

<p>
<a id="org6aa3753">linux:dd</a>
Swap file on Linux is a disk image e.g. /var/swap.img. Size is better 1 or 2x available system Ram. Run as root
</p>
<pre class="example">
cd /var
touch swap.img
chmod 600 swap.img

# fill the file with zeroes for 1gb or 1024mb
dd if=/dev/zero of=/var/swap.img bs=1024k count=1000

# or use this line to change file size
sudo fallocate -l 1G /var/swap.img

# initialize the swap filesystem
mkswap /var/swap.img

# enable swap file for the current boot
swapon /var/swap.img

# swapoff /var/swap.img

# Make it ready at boot, add a line to /etc/fstab, be careful!! Don't overwrite, just add a new line
echo "/var/swap.img none swap sw 0 0" &gt;&gt; /etc/fstab

# in case you run sudo
# echo "/var/swap.img none swap sw 0 0" | sudo tee -a /etc/fstab &gt; /dev/null

# set how likely Linux virtual memory manager to use swap. 100 means it uses swap as much as possible and leave memory free.
# list all options
sysctl -a

# just VM options
sysctl -a | grep vm.

# or this way to see swappiness value
cat /proc/sys/vm/swappiness

# default seems to be 60 (you can also modify /etc/sysctl.conf file)
sysctl -w vm.swappiness=30
</pre>

<p>
/etc/fstab format
</p>

<p>
<i>var/swap.img :: File system specifier :: For disk-based file systems, either a device file name (/dev/sda1), a file system label specification (LABEL=</i>), or a devlabel-managed symbolic link (/dev/homedisk)
none :: Mount point :: Except for swap partitions, this field specifies the mount point to be used when the file system is mounted (/boot)
swap :: File system type :: The type of file system present on the specified device (note that auto may be specified to select automatic detection of the file system to be mounted, which is handy for removable media units such as diskette drives)
sw :: Mount options :: A comma-separated list of options that can be used to control mount's behavior (noauto,owner,kudzu)
0 :: Dump frequency :: If the dump backup utility is used, the number in this field controls dump's handling of the specified file system
0 :: File system check order :: Controls the order in which the file system checker fsck checks the integrity of the file systems
</p>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-orgd95c1c3" class="outline-4">
<h4 id="orgd95c1c3"><span class="section-number-4">19.8.5</span> File permission</h4>
<div class="outline-text-4" id="text-19-8-5">
</div>
<div id="outline-container-org34be00b" class="outline-5">
<h5 id="org34be00b"><span class="section-number-5">19.8.5.1</span> Return list of files in Octal</h5>
<div class="outline-text-5" id="text-19-8-5-1">
<pre class="example">
for f in $(ls -a); do stat -c "%a %n" $f; done;

# for a file or directory
stat -c "%a %n" /var/www/html
</pre>
</div>
</div>

<div id="outline-container-org3be1141" class="outline-5">
<h5 id="org3be1141"><span class="section-number-5">19.8.5.2</span> Change permission - chmod</h5>
<div class="outline-text-5" id="text-19-8-5-2">
<p>
Octal mode. <a href="https://chmod-calculator.com/">Convert to Octal Mode</a> <a href="http://permissions-calculator.org/decode/">Convert to Permissions Bit</a>
</p>
<pre class="example">
chmod 400 ~/path/to/file.php
</pre>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Permissions</td>
<td class="org-right">Binary</td>
<td class="org-right">Octal</td>
<td class="org-left">Description</td>
</tr>

<tr>
<td class="org-left">---</td>
<td class="org-right">000</td>
<td class="org-right">0</td>
<td class="org-left">No permissions</td>
</tr>

<tr>
<td class="org-left">&#x2013;x</td>
<td class="org-right">001</td>
<td class="org-right">1</td>
<td class="org-left">Execute only</td>
</tr>

<tr>
<td class="org-left">-w-</td>
<td class="org-right">10</td>
<td class="org-right">2</td>
<td class="org-left">Write only</td>
</tr>

<tr>
<td class="org-left">-wx</td>
<td class="org-right">11</td>
<td class="org-right">3</td>
<td class="org-left">Write and execute</td>
</tr>

<tr>
<td class="org-left">r--</td>
<td class="org-right">100</td>
<td class="org-right">4</td>
<td class="org-left">Read-only</td>
</tr>

<tr>
<td class="org-left">r-x</td>
<td class="org-right">101</td>
<td class="org-right">5</td>
<td class="org-left">Read and execute</td>
</tr>

<tr>
<td class="org-left">rw-</td>
<td class="org-right">110</td>
<td class="org-right">6</td>
<td class="org-left">Read and write</td>
</tr>

<tr>
<td class="org-left">rwx</td>
<td class="org-right">111</td>
<td class="org-right">7</td>
<td class="org-left">full</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
owner-group-public
</p>

<p>
400 :: r---&#x2013;&#x2014; e.g. ssh private keys in ~/.ssh/ <a id="orgcf2eaa1">chmod:400</a>
440 :: read for owner and group, but none for public <a id="org8ddd0a3">chmod:440</a>
555 :: read and execute (can't modify) for all <a id="orgb0127ec">chmod:555</a>
700 :: rwx-&#x2013;&#x2014; full for owner <a id="orgdcb6e86">chmod:700</a>
*755 :: rwxr-xr-x (e.g. wordpress directory) Default directory permission and default executable file permission <a id="org6531cc6">chmod:755</a>
770 :: rwxrwx&#x2014; <a id="orgf1fbb9d">chmod:770</a>
775 :: rwxrwxr-x <a id="orgf4eb564">chmod:775</a>
*777 :: -rwxrwxrwx Directory's full permission <a id="org64d7111">chmod:777</a>
600 :: -rw-&#x2013;&#x2014; only owner can read and write file <a id="orgef1fc26">chmod:600</a>
*644 :: -rw-r&#x2013;r&#x2013; (e.g. wordpress .php files) <a id="orgd10f1c9">chmod:644</a>
*660 :: rw-rw-&#x2014; (e.g. wp-config.php) <a id="org47b1f63">chmod:660</a>
666 :: anyone can read and write. File full permission. <a id="orgf389488">chmod:666</a>
664 :: rw-rw-r&#x2013; <a id="org12a168a">chmod:664</a>
</p>

<p>
By default, umask is 0022. 
A file's full permission is 666. So new file has this default permission: 666-022 = 644
A directory's full permission is 777. So new directory has default permission: 777-022 = 755
</p>

<p>
Return umask simply run <code>umask</code>
</p>

<p>
Permanently set umask in ~/.bashrc <code>umask 0022</code>
</p>

<p>
chmod a-w /path/to/afile
</p>

<p>
u = user that owns the file
g = group that owns the file
o = other (everyone else)
a = all (everybody)
</p>

<p>
r = read, w = write, x = execute
</p>

<p>
a-w :: remove write permission for all
</p>

<p>
<a href="#org855c406">wp:check file permissions</a>
</p>
</div>
</div>

<div id="outline-container-orgb5c697a" class="outline-5">
<h5 id="orgb5c697a"><span class="section-number-5">19.8.5.3</span> Change owner:group for a folder - chown</h5>
<div class="outline-text-5" id="text-19-8-5-3">
<pre class="example">
sudo chown -R user:group aFolder
</pre>

<p>
List files or directories that are not a user or group
</p>
<pre class="example">
find . -type d -not -group test -o -type f -not -user test
</pre>
</div>
</div>

<div id="outline-container-org78c7d30" class="outline-5">
<h5 id="org78c7d30"><span class="section-number-5">19.8.5.4</span> Create several users for SFTP and final file permissions are www-data <a id="org490d2a6">linux:permission:users</a></h5>
<div class="outline-text-5" id="text-19-8-5-4">
<p>
If more than one users are needed, try <a href="#org45a08b4">linux:bindfs</a>
</p>

<p>
Otherwise, add user to group www-data and change default <a href="#orga70d167">wp:file permissions</a> from <a href="#orgd10f1c9">chmod:644</a> files <a href="#org6531cc6">chmod:755</a> directories to <a href="#org12a168a">chmod:664</a> for files and <a href="#orgf4eb564">chmod:775</a> for directories
This way new file will be the user not www-data but editing/uploading exising files will remain www-data:www-data
<a href="#org855c406">wp:check file permissions</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org7037690" class="outline-4">
<h4 id="org7037690"><span class="section-number-4">19.8.6</span> Symbolic Link</h4>
<div class="outline-text-4" id="text-19-8-6">
<p>
Symbolic link <code>abc</code> at user home folder, point it to existing folder <code>xyz</code> at user home folder
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #74af68;"># </span><span style="color: #74af68;">ln -s source_file myfile</span>
ln -s ~/xyz ~/abc

<span style="color: #74af68;"># </span><span style="color: #74af68;">Relative Path :: you are at ~/abc/xyz, you want to creat ~/abc/xyz/sym to point to existing folder ~/abc/efg/source</span>
ln -s ../eft/source/ sym
</pre>
</div>

<p>
Directly go to the actual folder by calling ~/abc
</p>
<pre class="example">
cd -P ~/abc
</pre>

<p>
To create a symlink on Windows, enable Developer Mode first and
</p>
<div class="org-src-container">
<pre class="src src-bash">mklink symlinkgoesto myfolder\mytargetfolder
</pre>
</div>
</div>
</div>

<div id="outline-container-org6bf8606" class="outline-4">
<h4 id="org6bf8606"><span class="section-number-4">19.8.7</span> Search files or directories, sort by size <a id="orgf308e98">bash:find</a></h4>
<div class="outline-text-4" id="text-19-8-7">
<p>
By file or directory name
</p>
<pre class="example">
ls -l my_scr?pt
ls -l my*
ls -l my_s*t
ls -l my_scr[ai]t
ls -l f[a-i]ll
ls -l f[!a]ll
</pre>

<p>
<a id="org6e50952">linux:find</a> :: Return path of matched files or directories
</p>

<p>
Search by name of files :: -name -iname
</p>
<pre class="example">
find ./targetFolder -type f -name "abc*"
</pre>

<p>
Name case insensitive use -iname instead of -name
</p>

<p>
Search by name of directories
</p>
<pre class="example">
find ./targetFolder -type d -name "abc*"
</pre>

<p>
Combine search criteria
AND
</p>
<pre class="example">
# Start with abc and file extension is php
find -name 'abc*' -name '*.php'

# Start with abc and file extension is not php
find -name 'abc*' ! -name '*.php'
</pre>

<p>
OR
</p>
<pre class="example">
find -name '*.php' -o -name '*.txt'
</pre>

<p>
Search by size (K, M, G for kb, mb and gb)
</p>
<pre class="example">
find . -type f -size +10000K
</pre>

<p>
Search by modified date
</p>
<pre class="example">
# Search text files that are modified less than 14 days ago
find . -type f -mtime -14 ! -iname '*.jpg' ! -iname '*.png'

# Modified between 50 and 100 days ago
find . -type f mtime +50 -mtime -100
</pre>

<p>
Recent modified files recursive (file status change)
</p>
<pre class="example">
# last 5 minute
find -cmin -5

# Last day 1440, Last 31 days 44640
</pre>

<p>
<code>-iname</code> case insensitive while <code>-name</code> is case sensitive
</p>

<p>
Chain find command with other commands
</p>
<pre class="example">
# {} is each result of find.
# \; denotes the end of ls command
find . -size +100M -exec ls -lh {} \;
</pre>

<p>
Get top 10 largest files in current folder
</p>
<pre class="example">
find . -type f -exec du -Sh {} + | sort -rh | head -n 10
</pre>

<p>
Assume it's at ~ folder, and here's the structure
</p>
<pre class="example">
~/1/2/3
~/a/1/2/3
~/afile
</pre>

<p>
At <code>, ~find .</code> will return
</p>
<pre class="example">
./1
./a
/afile
</pre>

<p>
The depth of <code>./1</code> and <code>./a</code> is 1.
</p>

<p>
While at ~, <code>find ~/</code> will return
</p>
<pre class="example">
/home/user/1
/home/user/a
/home/user/afile
</pre>

<p>
The depth of <code>/home/user/1</code> and <code>/home/user/a</code> related to <code>~</code> is 1
</p>

<p>
To find any folder that is named <code>1</code> but not at first level
</p>
<pre class="example">
find ~ -mindepth 1 -iname 1
</pre>

<p>
File count and Exclude Path
</p>
<pre class="example">
# Exclude abc/.git directory
find abc/ -type f -not -path "abc/.git/*" | wc -l

# If abc is the current directory
find . -type f -not -path "./.git/*" | wc -l

# Count for files and folders
find . | wc -l
</pre>

<p>
Check file permissions <a href="#org855c406">wp:check file permissions</a>
</p>
</div>
</div>

<div id="outline-container-orgc08c49e" class="outline-4">
<h4 id="orgc08c49e"><span class="section-number-4">19.8.8</span> Search Text in Files <a id="org0d53bdf">linux:grep</a></h4>
<div class="outline-text-4" id="text-19-8-8">
<pre class="example">
grep --color -HRi "google\.com" /root/dir

# Only file names
grep --color -HRi "abc" /root/dir | cut -d: -f1

# Unique file names
grep --color -HRi "abc" /root/dir | cut -d: -f1 | sort -u

# Exclude file types
grep --color -HRi --exclude=\*.{pdf,jpg,jpeg,JPG,mp3,png,bmp,sql} "abc" .

# Exclude binary files
grep --color -HIRin --exclude=\*.{pdf,jpg,jpeg,JPG,mp3,png,bmp,sql} "abc" .

# Return 5 trailing lines and 10 leading lines for each match
grep -A 5 -B 10 prefork.c /etc/httpd/conf/httpd/conf
</pre>

<dl class="org-dl">
<dt>&#x2013;color</dt><dd>hightlight</dd>
<dt>-H</dt><dd>return only the file names</dd>
<dt>-R</dt><dd>recursive</dd>
<dt>-i</dt><dd>ignore case</dd>
<dt>-I</dt><dd>process binary files as if they don't contain matching data</dd>
<dt>-n</dt><dd>line number</dd>
<dt>-A NUM</dt><dd>number of trailing lines of text</dd>
<dt>-B NUM</dt><dd>number of leading lines of text</dd>
<dt>(no term)</dt><dd>&#x2013;exclude-dir=node_modules</dd>
</dl>
</div>
</div>

<div id="outline-container-orgb9e5100" class="outline-4">
<h4 id="orgb9e5100"><span class="section-number-4">19.8.9</span> Folder structure <a id="orgae07a62">linux:tree</a></h4>
<div class="outline-text-4" id="text-19-8-9">
<div class="org-src-container">
<pre class="src src-sh">which tree
<span style="color: #74af68;"># </span><span style="color: #74af68;">apt-get install tree</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">list only folders without files</span>
tree -d test/

<span style="color: #74af68;"># </span><span style="color: #74af68;">list everything</span>
tree test/

<span style="color: #74af68;"># </span><span style="color: #74af68;">List first level child folder only for the current folder</span>
tree -d -L 1
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb6d7b59" class="outline-4">
<h4 id="orgb6d7b59"><span class="section-number-4">19.8.10</span> Compare files in 2 directories</h4>
<div class="outline-text-4" id="text-19-8-10">
<pre class="example">
diff --brief -Nr dir1/ dir2/
# -N shows difference of file existance

diff -r dir1/ dir2/
# shows text comparison as well
</pre>
</div>
</div>

<div id="outline-container-org18a47ad" class="outline-4">
<h4 id="org18a47ad"><span class="section-number-4">19.8.11</span> Compare text files</h4>
<div class="outline-text-4" id="text-19-8-11">
<pre class="example">
diff file1.txt file2.txt
# &lt; means the line belongs to the left file
# &gt; means the line belongs to the right file
</pre>
</div>
</div>

<div id="outline-container-org672c510" class="outline-4">
<h4 id="org672c510"><span class="section-number-4">19.8.12</span> Delete folders with a name</h4>
<div class="outline-text-4" id="text-19-8-12">
<pre class="example">
# Test it first
find ~/www -iname WEB-INF -exec ls {} \;

# Delete files in those folders
find ~/www -iname WEB-INF -exec rm -rf {} \;
</pre>
</div>
</div>

<div id="outline-container-org79d7f11" class="outline-4">
<h4 id="org79d7f11"><span class="section-number-4">19.8.13</span> ftp <a id="org8f1434a">bash:ftp</a></h4>
<div class="outline-text-4" id="text-19-8-13">
</div>
<div id="outline-container-org2e85dac" class="outline-5">
<h5 id="org2e85dac"><span class="section-number-5">19.8.13.1</span> Basics</h5>
<div class="outline-text-5" id="text-19-8-13-1">
<pre class="example">
ftp domain.com
ftp 192.168.0.1
ftp user@ftpdomain.com

// you get a prompt
ftp&gt;

// Commands
ls
cd afolder

// set local directory where downloaded files will be stored on your local environment (not the ftp server)
lcd /home/user/yourname

// download a file
get path/on/ftp/to/file

// download multiple files
mget *.xls

// for download, better use bash:wget

// upload a file that is in local folder
put filename

// upload a file that is in any folder on your local environment
put /home/user/your/path/to/a/file

// upload multiple files
mput *.xls

// close ftp connection
bye
exit
quit

// for help
help
</pre>
</div>
</div>


<div id="outline-container-org081b3ee" class="outline-5">
<h5 id="org081b3ee"><span class="section-number-5">19.8.13.2</span> lftp</h5>
<div class="outline-text-5" id="text-19-8-13-2">
<p>
<a href="http://lftp.yar.ru/lftp-man.html">http://lftp.yar.ru/lftp-man.html</a>
</p>

<pre class="example">
sudo apt-get install lftp
</pre>

<p>
To enable wildcard for rm, use glob
</p>

<pre class="example">
#!/bin/bash
ftpsite="ftp://yourftp.com"
ftpuser="b"
# password doesn't seem to have to be escaped like Makefile
ftppass="c"

# make sure you are sure which folder to delete before run mdelete and rmdir
# to delete ~/target/path/targetfolder

lftp u $ftpuser,$ftppass $ftpsite -e 'set ssl:check-hostname false;set ftp:list-options -a;' &lt;&lt;EOMYF
cd target/path
ls -d */ .*/
ls -d targetfolder/
rm -r targetfolder
rm -r targetfolder2
rm -r targetfolder3
glob -a rm -r ./*images*
quit
EOMYF

exit 0
</pre>
</div>
</div>

<div id="outline-container-orgd25c5c4" class="outline-5">
<h5 id="orgd25c5c4"><span class="section-number-5">19.8.13.3</span> Options for ftp command</h5>
<div class="outline-text-5" id="text-19-8-13-3">
<dl class="org-dl">
<dt>-i</dt><dd>turn off interactive prompting during multiple file transfers</dd>
<dt>-n</dt><dd>restrain from attempting auto-login upon initial connection</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org2504008" class="outline-4">
<h4 id="org2504008"><span class="section-number-4">19.8.14</span> cp <a id="orge5d9a6c">bash:cp</a></h4>
<div class="outline-text-4" id="text-19-8-14">
<pre class="example">
# Copy a sub folder abc/ in the current directory to a new directory ~/xyz with everything preserved
cp -a abc/ ~/xyz

# Duplicate subfolder abc and name it xyz
cp -a abc xyz
</pre>

<p>
-a :: -dR &#x2013;preserve=all
-d :: &#x2013;no-dereference &#x2013;preserve=links
-P, &#x2013;no-dereference :: never follow symbolic links in SOURCE
-R, -r, &#x2013;recursive
-f, &#x2013;force :: if an existing destination file cannot be opened, remove it and try again.
</p>

<p>
To copy and exclude some directories use rsync
</p>
<pre class="example">
rsync -Pavin sourceFolder/ /destinationFolder/ --exclude theFolderToExclude 
</pre>
</div>
</div>

<div id="outline-container-org9f92982" class="outline-4">
<h4 id="org9f92982"><span class="section-number-4">19.8.15</span> tar <a id="org79c3c72">bash:tar</a></h4>
<div class="outline-text-4" id="text-19-8-15">
</div>
<div id="outline-container-org219bd48" class="outline-5">
<h5 id="org219bd48"><span class="section-number-5">19.8.15.1</span> Compress and Read .tar file</h5>
<div class="outline-text-5" id="text-19-8-15-1">
<pre class="example">
# /home/targetFolder
cd /home
tar -cvzpf backup.tar.gz targetFolder

# Read .tar file
tar -tf backup.tar
# Read .tar.gz file
tar -tzf backup.tar.gz

# Count number of files
tar -tzf backup.tar.gz | wc -l

# targetFolder/index.html
# targetFolder/subfolder/index.html
# ...

# Exclude a folder
tar -cvzpf backup.tar.gz targetFolder --exclude='wp-content/uploads' --exclude='anotherFolder'

# Compress the current folder and save the archive in current folder
cd /home/targetFolder
tar -cvzpf backup.tar.gz .

# Compress the current folder and save the archive in one level above
tar -cvzpf ../backup.tar.gz .

# The archive structure is
# ./index.html
# ./subfolder/index.html
# ...
</pre>

<p>
Options
</p>
<dl class="org-dl">
<dt>-z</dt><dd>use gzip method</dd>
<dt>-c</dt><dd>create a new archive</dd>
<dt>-C</dt><dd>current directory</dd>
<dt>-v</dt><dd>verbose</dd>
<dt>-p</dt><dd>preserve permissions (default for superuser)</dd>
<dt>-f</dt><dd>use archive file as result or input. It follows the output/input filename</dd>
<dt>&#x2013;exclude</dt><dd>wrap in '' if it contains spaces</dd>
<dt>&#x2013;exclude='<b><i>*</i></b>'</dt><dd>ignore 3 levels deep</dd>
</dl>

<p>
Say you want compress the html folder at <i>var/www/html</i>, do this
</p>
<pre class="example">
tar -cvzpf mybk.tar.gz -C /var/www/html .
// tar -tzf mybk.tar.gz
//  ./fileone ./filetwo

// instead of
tar -cvzpf mybk.tar.gz /var/www/html
// tar -tzf mybk.tar.gz
// /var/www/html/fileone /var/www/html/filetwo

tar -cvzpf /path/to/mybk.tar.gz -C /var/www/html fileone
// tar -tzf /path/to/mybk.tar.gz
// ./fileone
</pre>

<p>
Dry run :: use - for tar file name and pipe with wc
</p>
<pre class="example">
tar -cvzpf - /var/www/html | wc -c
</pre>
</div>
</div>

<div id="outline-container-org0620246" class="outline-5">
<h5 id="org0620246"><span class="section-number-5">19.8.15.2</span> Uncompress</h5>
<div class="outline-text-5" id="text-19-8-15-2">
<pre class="example">
# Read the tar file first
tar -tf backup.tar.gz

# If file structure is
# targetFolder/index.html
# targetFolder/subfolder.html ...
# And put targetFolder so that /anotherfolder/targetFolder
# Copy .tar.gz to /anotherfolder
cd /anotherfolder
tar -xvzf backup.tar.gz

# If you don't want to copy .tar.gz to /anotherfolder, 
tar -xvzf /any/path/to/backup.tar.gz -C /path/to/anotherfolder/

# if you want to untar targetFolder only in the tar file
tar -xvzf /any/path/to/backup.tar.gz targetFolder

# if you want to untar targetFolder only and save the uncompressed as /anotherfolder/* not /anotherfolder/targetFolder
tar -xvzf /any/path/to/backup.tar.gz --strip-components=1

# If file structure is
# ./index.html
# ./subfolder/index.html ...
# Then copy backup.tar.gz to /anotherfolder/targetFolder
cd /anotherfolder/targetFolder
tar -xvzf backup.tar.gz

# tar -xvzf /any/path/to/backup.tag.gz -C /anotherFolder/targetFolder

# Uncompress file.gz, not file.tar.gz, 
gzip -d file.gz 

# The gz file will disappear
</pre>

<p>
Options
</p>
<dl class="org-dl">
<dt>-x</dt><dd>extract</dd>
<dt>-C</dt><dd>change the folder that the tar file will be uncompressed to. Without it, it will be the current folder</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-orge73da65" class="outline-4">
<h4 id="orge73da65"><span class="section-number-4">19.8.16</span> rsync</h4>
<div class="outline-text-4" id="text-19-8-16">
</div>
<div id="outline-container-orge23909c" class="outline-5">
<h5 id="orge23909c"><span class="section-number-5">19.8.16.1</span> Basic</h5>
<div class="outline-text-5" id="text-19-8-16-1">
<p>
Dry run first: <code>rsync -rlvzuPn --size-only $SOURCE $DESTINATION</code>
</p>

<p>
By default, rsync finds files that need to be transferred using a "quick check" algorithm that looks for files that have changed in size or in last-modified time. Any changes in the other preserved attributes (as requested by options) are made on the destination file directly when the quick check indicates that the file's data does not need to be updated.
</p>

<p>
-I, &#x2013;ignore-times: Normally rsync will skip any files that are already the same size and have the same modification timestamp. This option turns off this “quick check” behavior, causing all files to be updated.
</p>

<p>
&#x2013;size-only: This modifies rsync’s “quick check” algorithm for finding files that need to be transferred, changing it from the default of transferring files with either a changed size or a changed last-modified time to just looking for files that have changed in size. This is useful when starting to use rsync after using another mirroring system which may not preserve timestamps exactly.
</p>

<p>
-u: skip files that are newer in $DESTINATION
</p>

<p>
&#x2013;delete: To delete extra files from the receiving side (ones that aren't on the sending side), but only for the directories that are being synchronnized. By default, rsync does not delete files on the receiving side.
</p>

<p>
-r: recursive
-l: symlink
-z: compress
-v: verbose
-i: Very useful! Display change-summary for all updates, also use with &#x2013;stats
-P: &#x2013;progress &#x2013;partial, show progress and to resume interrupted transfers 
-n: dry run
</p>

<p>
-t: actually is very crucial. This tells rsync to transfer modification times along with the files and update them on the remote system. Unless &#x2013;size-only is used, missing -t or -a will cause the next transfer to behave as if it used -I, causing all files to be updated.
</p>

<p>
This command will not sync files with different permissions, ownership and modification time.
Review the results and remove dry run `-n` before running again.
</p>

<p>
-a: -rlptgoD recursive, symlink, same permissions, mod time, group/owner, device/special files
-p: the receiving rsync to set the destinaion permissions to be the same as the source permissions.
-g: To set the group of the destination file to be the same as the source file. Only if dest is run as super-user
-o: To set the owner of the destination file to be the same as the source file. Only if dest is run as super-user
-D: is equivalent to <code>--devices --specials</code>
</p>

<p>
&#x2013;devices: To transfer character and block device files to the remote system to recreate these devices.
&#x2013;specials: To transfer special files such as named sockets and fifos.
</p>

<p>
&#x2013;stats: show file-transfer stats: number of files, number of files transferred, Total file size in bytes, Total transferred file size
</p>

<p>
&#x2013;chown :: refer to -og, change owner:group on dest. <code>rsync -rlvzPitog --chown=www-data:www-data /source /destination</code>
</p>

<p>
&#x2013;exclude 'public_html/database.txt': exclude a file or directory, use multiple &#x2013;exclude
</p>

<p>
&#x2013;exclude-from '<i>home/backup/exclude.txt': exclude multiple files and folders, use relative path without leading .</i>
e.g.
</p>
<pre class="example">
afolder/*
</pre>

<p>
exclude.txt
</p>
<pre class="example">
sources
public_html/database.*
downloads/test/*
</pre>

<p>
&#x2013;ignore-existing :: skip updating files that already exist on the destination
</p>

<p>
Refer to <a href="#orgda85400">bash:sshpass</a> for &#x2013;rsh
</p>
</div>
</div>

<div id="outline-container-orgb9175b2" class="outline-5">
<h5 id="orgb9175b2"><span class="section-number-5">19.8.16.2</span> Change summary, compare 2 directories</h5>
<div class="outline-text-5" id="text-19-8-16-2">
<p>
For comparing, you don't need -a specifically -pgoD so that left -rlt
You need -vzPin
Probably include -t and &#x2013;size-only
</p>

<p>
rsync -rltvzPin wp-content/themes/my-theme/ sshconfighostname:/var/www/mylivesite/wp-content/themes/my-theme/
</p>

<p>
For current folder, use ./
</p>

<p>
Refer to <a href="#orgda85400">bash:sshpass</a>
</p>

<pre class="example">
.d..t...... ./
&lt;f.st...... footer.php
&lt;f.st...... front-page.php
.f..t...... functions.php
&lt;f.st...... header.php
.f..t...... index.php
.f..t...... page--coupon-image_tpl.php
.f..t...... page--coupons_tpl.php
.f..t...... style.css
.d..t...... lb/
cd+++++++++ lb/api-localbusiness/
&lt;f+++++++++ lb/api-localbusiness/cf-form-post.php
&lt;f+++++++++ lb/api-localbusiness/cf-form-post_rel0.php
&lt;f+++++++++ lb/api-localbusiness/cf-form-post_rel2.php
.d..t...... lb/css/
.f..t...... lb/css/font.css
&lt;f.st...... lb/css/style.css
.d..t...... lb/font/
.d..t...... lb/font/trade-gothic/
.f..t...... lb/font/trade-gothic/bold.eot
.f..t...... lb/font/trade-gothic/bold.otf
.d..t...... lb/img/
.f..t...... lb/img/alectra-logo.eps
.d..t...... lb/img/bg/
.f..t...... lb/img/bg/lp-bg_001.jpg
.f..t...... lb/img/bg/lp-bg_002.jpg
.d..t...... lb/img/icons/
.f..t...... lb/img/icons/contact.png
.f..t...... lb/img/icons/social-facebook.png
.d..t...... lb/img/icons/coupon/
.f..t...... lb/img/icons/coupon/icon-01.svg
.f..t...... lb/img/icons/coupon/icon-02.svg
.d..t...... lb/img/logos/
.f..t...... lb/img/logos/brampton-hydro.png
.f..t...... lb/img/logos/enersource.png
.d..t...... lb/js/
.f..t...... lb/js/app.js
.f..t...... lb/js/bicubic-interpolation.js
</pre>

<p>
YXcstpoguax
</p>

<p>
Y is update type
</p>
<ul class="org-ul">
<li>&lt; means a file is being transferred to the remote (sent)</li>
<li>&gt; means a file is being transferred to the local (received)</li>
<li>c means a local change/creation is occuring for the item (on the receiving side)</li>
<li>h means the item is a hard link to another item</li>
<li>. means the item is not being updated (though it might have attributes that are modified)</li>
<li>* means the rest of the itemized-output area contains a message (e.g. "deleting")</li>
</ul>

<p>
X is file-type :: f for a file, d for directory, L for symlink, D for a device, S for a special file (named sockets and fifos)
</p>

<p>
cstpoguax are attributes. 
</p>
<ul class="org-ul">
<li>"." stands for no change.</li>
<li>A newly created item replaces each letter with a "+"</li>
<li>An identical item replaces the dots with spaces</li>
<li>An unknown attribute replaces each letter with a "?" (could happen when talking to an older rsync)</li>

<li>c: checksum is different</li>
<li>s: file size is different and will be updated</li>
<li>t: modification time is different and is being updated to the sender's value (requires -t or &#x2013;times)</li>
<li>T: modification time will be set to the transfer time</li>
<li>p: permissions are different and are being updated to the sender's value (requires &#x2013;perms)</li>
<li>o: owner is different and is being updated to the sender's value (requires &#x2013;owner)</li>
<li>g: group is different and is being updated to the sender's value (requires &#x2013;group)</li>
<li>u: reserved for future use</li>
<li>a: ACL information changed</li>
<li>x: Extended attribute information changed.</li>
</ul>
</div>
</div>

<div id="outline-container-org8bdbdf3" class="outline-5">
<h5 id="org8bdbdf3"><span class="section-number-5">19.8.16.3</span> Filter rules (INCLUDE/EXCLUDE Patterns)</h5>
<div class="outline-text-5" id="text-19-8-16-3">
<p>
If the pattern ends with a / then it will only match a directory, not a regular file, symlink or device
If the pattern starts with a / then it is similar to a leading ^ in regular expressions. <code>lq/foorq</code> would match at any point in the hierarchy.
<code>oq*cq</code> matches any path component but it stops at slashes
use <code>**</code> to match anything, including slashes
<code>oq?cq</code> matches any character except a slash
<code>oq[cq</code> introduces a character class, e.g. [a-z] or
</p>
<pre class="example">
[[:alpha:]]
</pre>

<p>
A trailing <b>*</b> will match both the directory and everything in the directory e.g. <code>foldername/***</code>
</p>
</div>
</div>

<div id="outline-container-orgd4a84cd" class="outline-5">
<h5 id="orgd4a84cd"><span class="section-number-5">19.8.16.4</span> Examples</h5>
<div class="outline-text-5" id="text-19-8-16-4">
<ul class="org-ul">
<li>Dry, recursive, symlink, verbose, compress</li>
<li>show progress and make it possible to re-rsync if connection is lost</li>
<li>show changes in detail for each transferred file</li>
<li>update time on destination</li>
<li>don't transfer file if dest has mod time newer</li>
<li>update owner and group on dest to be the same as source</li>
<li>change owner:group on dest</li>
</ul>

<pre class="example">
rsync -rlvzPituogn --chown=www-data:www-data wp-content/ remote:path/to/wp-content
</pre>

<p>
Transfer everything from remote to local
</p>
<ul class="org-ul">
<li>verbose</li>
<li>show overall stats</li>
<li>show individual file log</li>
<li>show progress and re-sync possible</li>
<li>compress</li>
</ul>

<pre class="example">
rsync -avziPn --stats $(devhost):$(devhostdir)/wp-content/uploads/ wp-content/uploads/
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org4e77dc4" class="outline-3">
<h3 id="org4e77dc4"><span class="section-number-3">19.9</span> head, tail <a id="org6134e7e">bash:head</a> <a id="orgd11066b">linux:tail</a></h3>
<div class="outline-text-3" id="text-19-9">
<p>
Last 5 lines
</p>
<pre class="example">
tail -n5 /path/to/file
</pre>

<p>
Keep tailing
</p>
<pre class="example">
tail -f /var/log/messages
</pre>

<p>
Used in chain
</p>
<pre class="example">
ls -t | tail -n3
</pre>
</div>
</div>

<div id="outline-container-org0ff10d4" class="outline-3">
<h3 id="org0ff10d4"><span class="section-number-3">19.10</span> Processes</h3>
<div class="outline-text-3" id="text-19-10">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>ps -ef</code></td>
<td class="org-left">List of running processes</td>
</tr>

<tr>
<td class="org-left"><code>sudo ls -l /proc/PID/exe</code></td>
<td class="org-left">file path for command, sub PID</td>
</tr>

<tr>
<td class="org-left"><code>ps -f -p 123</code></td>
<td class="org-left">List file of a running process</td>
</tr>

<tr>
<td class="org-left"><code>ps axu</code></td>
<td class="org-left">List all processes for all users and</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">not started by a terminal (e.g. started by a daemon)</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">and show user columns</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
ps options
</p>
<dl class="org-dl">
<dt>f or F</dt><dd>full format. F for Ubuntu</dd>
<dt>e</dt><dd>all processes. same as -A</dd>
<dt>p</dt><dd>PID. same as p and &#x2013;pid</dd>
<dt>o</dt><dd>specify format e.g. -o pid,ppid,pgid,sid</dd>

<dt>ax</dt><dd>list all processes from all users that are not started by a terminal (e.g. started by a daemon)</dd>

<dt>u</dt><dd>Displays user-oriented output. This includes the USER, PID, %CPU, %MEM, SZ, RSS, TTY, STAT, STIME, TIME, and COMMAND fields.</dd>
<dt>l</dt><dd>Displays a long listing having the F, S, UID, PID, PPID, C, PRI, NI, ADDR, SZ, PSS, WCHAN, TTY, TIME, and CMD fields.
Note ::  -l doesn't include fields from -u</dd>

<dt>w</dt><dd>use with -f to show in unlimited width so that PPID and others are shown</dd>
</dl>
</div>

<div id="outline-container-orgc4b0ccc" class="outline-4">
<h4 id="orgc4b0ccc"><span class="section-number-4">19.10.1</span> pgrep, pkill</h4>
<div class="outline-text-4" id="text-19-10-1">
<pre class="example">
# Search a process by file name, return PID
pgrep newcomgo

# Kill a process by file name
pkill newcomgo
</pre>
</div>
</div>

<div id="outline-container-orga903db5" class="outline-4">
<h4 id="orga903db5"><span class="section-number-4">19.10.2</span> Parent process <a id="orge5ebae7">linux:process:parent</a></h4>
<div class="outline-text-4" id="text-19-10-2">
<p>
Parent process id is PPID. PPID is 1 means parent is not found.
Child process PID is 1234
</p>

<pre class="example">
# search in all processes
ps -feww 1234

# just return ppid
ps -o ppid= 1234

# return with custom format
ps -eo pid,ppid,comm | grep 1234

# search in all processes that may start by daemon
ps -axl | grep 1234
</pre>

<p>
A package <code>pstree</code> can be installed and used
<code>pstree -s -p 2072</code> outputs <code>init(1)───pulseaudio(2061)───gconf-helper(2072)</code>
</p>
</div>
</div>

<div id="outline-container-orgd2a5a0c" class="outline-4">
<h4 id="orgd2a5a0c"><span class="section-number-4">19.10.3</span> Run executable in background for all sessions</h4>
<div class="outline-text-4" id="text-19-10-3">
<p>
This should be enough. If not, use <a href="#org5628199">bash:screen</a>
</p>
<pre class="example">
nohup ./bin/newcomgo &amp;
</pre>
</div>
</div>

<div id="outline-container-orgf62664b" class="outline-4">
<h4 id="orgf62664b"><span class="section-number-4">19.10.4</span> jobs</h4>
<div class="outline-text-4" id="text-19-10-4">
<pre class="example">
# Add ~&amp;~ to put process list into background
(tar -cf 1.tar /home/1; tar -cf 2.tar /home/2)&amp;

# run a script file in background
./test5.sh &amp;

# If terminal session is ended (SIGHUP), background processes will be stopped, too
# Use nohup to block SIGHUP signals being sent to the process
nohup ./test1.sh &amp;

# It produeces a file `nohup.out` in the directory that the script is in which contains STDOUT and STDERR.
# No output to any terminals.

# To prevent background processes from seding error to terminal
./test5.sh 2&gt; /dev/null &amp;
</pre>

<p>
Run <code>jobs</code> to show what processes are running in background
Use <code>jobs -l</code> to list the PID
<code>kill PID</code> or <code>kill -KILL PID</code>
</p>
</div>
</div>

<div id="outline-container-org5be6594" class="outline-4">
<h4 id="org5be6594"><span class="section-number-4">19.10.5</span> top <a id="org5b94c10">linux:top</a></h4>
<div class="outline-text-4" id="text-19-10-5">
<p>
First line: current time, system up time, number of users logged in, load average (1, 5, 15 minutes; &gt;2 is busy). 
Second line: total processes: running, sleeping, stopped and zombie (have finished but parent process hasn't responded)
</p>

<p>
Third line: CPU utilization: us (user), sy (system), ni (nice: time running niced user processes), wa (time waiting for I/O completion), hi (time spent servicing hardware interrupts), si (software interrupts), st (stolen from this vm by the hypervisor)
</p>

<p>
Memory usage
</p>
<ul class="org-ul">
<li>Line 1 reflects physical memory: total, used, free and buffers</li>
<li>Line 2 reflects virtual memory: total, used, free and cached</li>
</ul>

<p>
Detailed for each process
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">PID</td>
<td class="org-left">The process ID of the process</td>
</tr>

<tr>
<td class="org-left">USER</td>
<td class="org-left">The user name of the owner of the process</td>
</tr>

<tr>
<td class="org-left">PR</td>
<td class="org-left">The priority of the process</td>
</tr>

<tr>
<td class="org-left">NI</td>
<td class="org-left">The nice value of the process</td>
</tr>
</tbody>
</table>
<ul class="org-ul">
<li>NI: The nice value of the process</li>
<li>VIRT: The total amount of virtual memory used by the process</li>
<li>RES: The amount of physical memory the process is using</li>
<li>SHR: The amount of memory the process is sharing with other processes</li>
<li>S: The process status (D = interruptible sleep, R = running, S = sleeping, T = traced</li>
<li>or stopped, or Z = zombie)</li>
<li>%CPU: The share of CPU time that the process is using</li>
<li>%MEM: The share of available physical memory the process is using</li>
<li>TIME+: The total CPU time the process has used since starting</li>
<li>COMMAND: The command line name of the process (program started)</li>
</ul>


<p>
Type `f` for interaction: set sort, display more fields/columns
</p>
</div>
</div>

<div id="outline-container-org43dbe73" class="outline-4">
<h4 id="org43dbe73"><span class="section-number-4">19.10.6</span> Multiple commands &amp;&amp; vs || vs ;</h4>
<div class="outline-text-4" id="text-19-10-6">
<p>
Commands behind ; are always run
Command behind &amp;&amp; is run only when the previous returns success
Command behind || is always run
So || is the opposite of &amp;&amp;
</p>

<pre class="example">
false; echo 'yes'
true; echo 'yes'
false &amp;&amp; echo 'yes'
false || echo 'yes'
</pre>
</div>
</div>
</div>

<div id="outline-container-org4930dc3" class="outline-3">
<h3 id="org4930dc3"><span class="section-number-3">19.11</span> Memory</h3>
<div class="outline-text-3" id="text-19-11">
<p>
Total memory: <code>grep MemTotal /proc/meminfo</code>
More info: <code>cat /proc/meminfo</code>
Memory usage: <code>free -ltm -c 2 -s 2</code> or just <code>free -mh</code>
Delay 2 seconds and repeat 2 times: <code>-c 2 -s 2</code>
</p>
<dl class="org-dl">
<dt>m</dt><dd>in megabyte. e.g. -g</dd>
<dt>t</dt><dd>show Total</dd>
<dt>l</dt><dd>show Low and High</dd>
<dt>(no term)</dt><dd>h</dd>
</dl>
<p>
Another way: <code>vmstat -s</code>
To see memory usage for each process, use <a href="#org5b94c10">linux:top</a> or <code>htop</code>
</p>

<p>
Before in Ubuntu it shows 6 columns and the -/+ buffers/cache row
             total       used       free     shared    buffers     cached
Mem:          7916       7645        271         99        455       1764
-/+ buffers/cache:       5426       2490
Swap:        24999        805      24194
</p>

<p>
used = total - free
</p>

<p>
Now the columns are and no -/+ buffers/cache row
              total        used        free      shared  buff/cache   available
Mem:           3553        1192         857          16        1504        2277
Swap:          3689           0        3689
</p>

<p>
used = total - free - cached - buffers
</p>

<p>
Buffers are file system metadata and cache is pages with actual contents of files or block devices.
Buff/cache will be freed up for newer applications that need memory to save I/O operations.
</p>

<p>
Linux OS always uses physical memory so free is always low.
</p>

<p>
A Linux system is really low on memory if the free value in -/+ buffers/cache: line gets low which is the available column in new Linux.
</p>
</div>
</div>

<div id="outline-container-org48ef0bc" class="outline-3">
<h3 id="org48ef0bc"><span class="section-number-3">19.12</span> Service</h3>
<div class="outline-text-3" id="text-19-12">
<p>
<code>service --status-all</code>
</p>
<ul class="org-ul">
<li>List all services (on '+', off '-', managed by Upstart '?')</li>
</ul>

<p>
<code>systemctl</code> :: List running services only with more detail
</p>

<p>
<code>service</code> operates on the daemon files in <code>/etc/init.d</code> which is an old init system.
</p>

<p>
<code>systemctl</code> operates on <code>/etc/systemd</code>. File in this folder will be used first otherwise fall back to old init.
</p>

<p>
Some daemon files can do restart and it might be the preferred way to interact with service. e.g.
<code>sudo /etc/init.d/jenkins restart</code>
</p>
</div>
</div>

<div id="outline-container-org184999c" class="outline-3">
<h3 id="org184999c"><span class="section-number-3">19.13</span> Network</h3>
<div class="outline-text-3" id="text-19-13">
<p>
All active NIC and IP addresses: <code>ifconfig</code>
All enabled and disabled NIC: <code>ifconfig -a</code>
View one NIC (interface): <code>ifconfig eth0</code>
</p>

<p>
Ethernet interface: eth0, eth1
Wireless network interface: wlan0, wlan1
Loopback interface for system internal communication: <code>lo</code>
</p>

<p>
Find default gateway <code>ip route | grep default</code>
</p>
</div>

<div id="outline-container-org744f604" class="outline-4">
<h4 id="org744f604"><span class="section-number-4">19.13.1</span> /etc/network/interfaces file</h4>
<div class="outline-text-4" id="text-19-13-1">
<p>
For Ubuntu and Debian.
</p>
<pre class="example">
iface eth0 inet static
# only one address, call static
  address 192.168.1.5

# netmask defines ip's within this range is considered under the same LAN
  netmask 255.255.255.0

# When this machine talks to an ip out of this LAN, a gateway is needed
  gateway 192.168.1.254

# DNS
  dns-nameservers 192.168.1.254 8.8.8.8
</pre>

<p>
Set interface to dhcp
</p>
<pre class="example">
auto eth0
iface eth0 inet dhcp
</pre>

<p>
After changing interfaces file, turn off and on the interface
</p>
<pre class="example">
sudo ifdown eth0 &amp;&amp; sudo ifup eth0
</pre>
</div>
</div>

<div id="outline-container-org1198835" class="outline-4">
<h4 id="org1198835"><span class="section-number-4">19.13.2</span> DNS <a id="orgf3ca904">linux:dns</a></h4>
<div class="outline-text-4" id="text-19-13-2">
<p>
<code>/etc/nsswitch.conf</code> and the line starting with ~hosts: ~ defines which files Linux should look for the IP of a domain.
</p>

<pre class="example">
hosts: files mdns4_minimal [NOTFOUND=return] dns
</pre>

<p>
First, <code>/etc/hosts</code> file.
</p>
<pre class="example">
127.0.0.1 localhost
127.0.1.1 your-computer-name
# 127.0.1.1 is fine when the computer is a client
# If the machine is a server and it has a static IP, should set it
</pre>

<p>
Second, it's a list of DNS nameservers you define. 
There's a package called <code>resolvconf</code> which handles the DNS nameservers. I guess if you change /etc/network/interfaces file to use <code>dns-nameservers</code>, it will add nameservers to <code>/etc/resolv.conf</code> which cannot be changed manually.
Thus, a list of DNS nameservers that are being used can be retrieved <code>cat /etc/resolv.conf</code>
</p>

<p>
To check if a domain is resovled, these commands are run based on <code>/etc/resolv.conf</code>
</p>
<pre class="example">
getent hosts google.com
host google.com
dig google.com
</pre>

<p>
dig can only follow through DNS management. If there's redirect done in Apache, Nginx or other codes, it won't follow through them.
</p>

<p>
Use <a href="#org1c3b962">linux:curl</a> to track further.
</p>

<p>
dig finds A record
</p>
<pre class="example">
dig google.com

# Or

dig google.com +short
</pre>

<p>
Query MX record
</p>
<pre class="example">
dig google.com MX
</pre>

<p>
Query All DNS records including NS, SOA
</p>
<pre class="example">
dig google.com ANY
</pre>

<p>
DNS Reverse Look-up
</p>
<pre class="example">
dig -x 72.30.38.140
</pre>

<p>
<a href="https://www.whatsmydns.net/">DNS Propagation Checker</a>
</p>
</div>
</div>

<div id="outline-container-org51bd95f" class="outline-4">
<h4 id="org51bd95f"><span class="section-number-4">19.13.3</span> Get Server's Public IP <a id="orga2a52f5">linux:get public ip</a></h4>
<div class="outline-text-4" id="text-19-13-3">
<pre class="example">
ip addr show eth0 | grep inet | awk '{ print $2; }' | sed 's/\/.*$//'
# or
curl http://icanhazip.com
</pre>
</div>
</div>

<div id="outline-container-orgf56984b" class="outline-4">
<h4 id="orgf56984b"><span class="section-number-4">19.13.4</span> <a href="#org747609d">CIDR Netmask</a> (Network Mask)</h4>
<div class="outline-text-4" id="text-19-13-4">
<p>
<a id="org747609d">CIDR netmask</a>
</p>
<ul class="org-ul">
<li>10.0.75.5/32 = 10.0.75.5 AND 255.255.255.255 = 10.0.75.5 (a single host)</li>
<li>10.0.75.5/24 = 10.0.75.5 AND 255.255.255.0 = 10.0.75.0 
(10.0.75.5 is in the 10.0.75.0 subnet)</li>
<li>10.0.75.5/16 = 10.0.75.5 AND 255.255.0.0     = 10.0.0.0</li>
<li>10.0.75.5/8  = 10.0.75.5 AND 255.0.0.0       = 10.0.0.0</li>
</ul>

<p>
Private IPv4 address spaces
</p>
<ul class="org-ul">
<li>10.0.0.0 - 10.255.255.254 = 10.0.0.0/8 (16 million number of addresses)</li>
<li>172.16.0.0 - 172.31.255.255 = 172.16.0.0/12 (255.240.0.0) (1 million number of addresses, 172.16.x.x - 172.31.x.x)</li>
<li>192.168.0.0 - 192.168.255.255 = 192.168.0.0/16 (65,536 number of addresses)</li>
</ul>

<p>
Internal network Class A :: 10.0.0.0 - 10.255.255.254 (10.0.0.0/8, total hosts: 16 million)
Internal network Class B :: 172.16.0.1 - 172.16.255.254 (172.16.0.0/16, total hosts: 65,534)
Internal network Class C :: 192.168.0.1 -192.168.0.254 (192.168.0.0/24, total hosts: 254)
</p>
</div>
</div>

<div id="outline-container-org112300e" class="outline-4">
<h4 id="org112300e"><span class="section-number-4">19.13.5</span> Port <a id="org96918c4">network:port</a></h4>
<div class="outline-text-4" id="text-19-13-5">
<p>
If a port is in use <code>telnet localhost 9000</code>, if it's connected, it's in use.
List all ports in use: <code>netstat -lp</code> or <code>netstat -nlp</code> to list in numeric form.
Search a port <code>netstat -nlp | grep 8000</code>
</p>

<p>
netstat options
</p>
<dl class="org-dl">
<dt>l</dt><dd>show only listening sockets</dd>
<dt>p</dt><dd>show PID and name of the program to which each socket belongs.</dd>
<dt>n</dt><dd>show numerical addresses instead of symbolic host, port or user names</dd>
<dt>t</dt><dd>tcp</dd>
<dt>u</dt><dd>udp</dd>
</dl>

<p>
List all command files (open files) that are using an Internet address (-i)
<code>-P</code> is to print port number
<code>lsof -Pi</code>
</p>

<p>
Filter any address of port 80 :: <code>lsof -i :80</code>
Full format
</p>
<pre class="example">
[46][protocol][@hostname|hostaddr][:service|port]

# 4 or 6 for IPv4 or IPv6
</pre>

<p>
It's better to use telnet IP_address port_number in an external computer to connect to a port to check
if it's in use.
</p>

<pre class="example">
# this can also list PID's that use the port
fuser 443/tcp -v

# and kill
fuser -k 443/tcp
</pre>

<p>
If process keeps coming back, consider find the parent process and kill it.
</p>

<p>
In Windows, to see if a port is being used in a local computer
</p>
<pre class="example">
netstat -an | find "8080"

// From outside, just telnet host port (or telnet host:port on Unix systems) to see if the connection is refused, accepted, or timeouts
</pre>

<p>
Use open ports that are in the range of 1024-49151.
0-1023 are well known ports
1024-65535 are registered ports
49152-65535 are dynamic ports and should not be prescribed to a protocol (e.g. random)
</p>
</div>
</div>

<div id="outline-container-org925545e" class="outline-4">
<h4 id="org925545e"><span class="section-number-4">19.13.6</span> Wireless network adapters <code>iwconfig</code></h4>
</div>

<div id="outline-container-orgcfbaf84" class="outline-4">
<h4 id="orgcfbaf84"><span class="section-number-4">19.13.7</span> Gather monthly bandwidth</h4>
<div class="outline-text-4" id="text-19-13-7">
<pre class="example">
sudo apt-get install vnstat
// check
vnstat
// tell it to monitor a network interface
vnstat -u -i eth0

// it will create a database for it, check what interface is being monitored
vnstat

// start daemon
sudo /etc/init.d/vnstat start

// read stats for an interface
vnstat -i eth0

// hourly -h, -d, -m
vnstat -h -i eth0

// live traffic -l

// top 10 days with highest traffic -t
</pre>

<p>
Info
tx :: transmit
rx :: receive
</p>
</div>
</div>

<div id="outline-container-org4852d68" class="outline-4">
<h4 id="org4852d68"><span class="section-number-4">19.13.8</span> Test email address if valid without sending</h4>
<div class="outline-text-4" id="text-19-13-8">
<pre class="example">
nslookup -q=mx gmail.com
</pre>

<p>
You will see this:
</p>
<pre class="example">
Server:         192.168.1.200
Address:        192.168.1.200#53

Non-authoritative answer:
gmail.com       mail exchanger = 10 alt1.gmail-smtp-in.l.google.com.
gmail.com       mail exchanger = 20 alt2.gmail-smtp-in.l.google.com.
gmail.com       mail exchanger = 5 gmail-smtp-in.l.google.com.
gmail.com       mail exchanger = 30 alt3.gmail-smtp-in.l.google.com.
gmail.com       mail exchanger = 40 alt4.gmail-smtp-in.l.google.com.

Authoritative answers can be found from:
alt1.gmail-smtp-in.l.google.com internet address = 173.194.205.26
alt1.gmail-smtp-in.l.google.com has AAAA address 2607:f8b0:400d:c02::1a
alt2.gmail-smtp-in.l.google.com internet address = 74.125.141.26
alt2.gmail-smtp-in.l.google.com has AAAA address 2607:f8b0:400c:c06::1a
gmail-smtp-in.l.google.com      internet address = 108.177.112.26
gmail-smtp-in.l.google.com      has AAAA address 2607:f8b0:4001:c12::1b
alt3.gmail-smtp-in.l.google.com internet address = 64.233.190.26
alt3.gmail-smtp-in.l.google.com has AAAA address 2800:3f0:4003:c01::1b
alt4.gmail-smtp-in.l.google.com internet address = 209.85.203.26
alt4.gmail-smtp-in.l.google.com has AAAA address 2a00:1450:400b:c03::1a
</pre>

<p>
Choose any one or the root one to telnet
</p>
<pre class="example">
telnet gmail-smtp-in.l.google.com 25

# if it's connected, it will say 220
# Then you first have to say HELO hi-whatever
HELO hi

# setup a From email, with &lt;&gt; brackets
mail from: &lt;youremail@gmail.com&gt;

# then specify the target email which you want to test
rcpt to: &lt;test@gmail.com&gt;

# If the target email is good, it will say 250 OK
# 550 and its message may say Recipient address rejected: User unknown in virtual alias table
quit
</pre>
</div>
</div>
</div>

<div id="outline-container-org6183d61" class="outline-3">
<h3 id="org6183d61"><span class="section-number-3">19.14</span> Firewall <a id="orgc265d09">linux:firewall</a> <a id="orgd3bb156">linux:ufw</a></h3>
<div class="outline-text-3" id="text-19-14">
<p>
Should be installed by default. <code>sudo aptitude install ufw</code> or <code>sudo apt-get install ufw</code>
<code>sudo ufw status verbose</code> to check if status is active.
<code>sudo ufw disable</code> and <code>sudo ufw enable</code> to restart firewall
Or just reload <code>sudo ufw reload</code>
<code>sudo ufw reset</code>
</p>

<p>
ufw comes with some profiles each of them is a setting for a service/app. Get all profiles <code>sudo ufw app list</code>
</p>
<pre class="example">
Available applications:
  Nginx Full
  Nginx HTTP
  Nginx HTTPS
  OpenSSH
</pre>

<p>
Refer to <a href="#org637f0c3">nginx:ufw</a> for further info. 
</p>

<p>
Default setting is no restriction on outgoing connection, deny all incoming connection
</p>

<p>
Allow OpenSSH app/profile first <code>sudo ufw allow OpenSSH</code> then <code>sudo ufw enable</code> enable ufw
</p>

<p>
Review setting <code>sudo vi /etc/default/ufw</code>
</p>

<p>
Make sure <code>IPV6=yes</code> in setting.
Make sure DEFAULT_FORWARD_POLICY="ACCEPT" if docker is installed
</p>

<p>
Allow a service <code>sudo ufw allow ssh</code>
Allow a port <code>sudo ufw allow 22/tcp</code>
Allow FTP <code>sudo ufw allow 21/tcp</code>
Allow a port range <code>sudo ufw allow 1000:2000/tcp</code>
Allow an IP <code>sudo ufw allow from 192.168.255.255</code>
</p>

<p>
Allow HTTP web server <code>sudo ufw allow 80/tcp</code>
Allow SSL/TLS <code>sudo ufw allow 443/tcp</code>
Allow SMTP email <code>sudo ufw allow 25/tcp</code>
</p>

<p>
List all rules <code>sudo ufw status numbered</code>
Delete a rule <code>sudo ufw delete [number]</code>
</p>

<p>
Or you can see added rules in command style <code>sudo ufw show added</code> (even works when ufw is inactive)
Then you delete <code>sudo ufw delete allow 22</code>
</p>

<p>
<a href="https://www.digitalocean.com/community/tutorials/ufw-essentials-common-firewall-rules-and-commands">More info</a>
</p>
</div>
</div>

<div id="outline-container-org7d7f602" class="outline-3">
<h3 id="org7d7f602"><span class="section-number-3">19.15</span> Timezone, NTP</h3>
<div class="outline-text-3" id="text-19-15">
<p>
<a id="orgd6c7694">linux:timezone</a>
Set timezone first <code>sudo dpkg-reconfigure tzdata</code>
</p>

<p>
Make sure Network Time Protocol daemon (NTP) is installed <code>which ntpd</code>
Install <code>sudo apt-get update</code> <code>sudo apt-get install ntp</code>
Do a sync 
<code>sudo service ntp stop</code> 
<code>sudo ntpd -gq</code>
<code>sudo service ntp start</code>
</p>

<p>
Port 123 has to be open (but I think the default ufw setting is ok)
</p>

<p>
For Debian/Ubuntu, /etc/timezone file stores the timezone. Default :: Etc/UTC
</p>

<p>
All timezones are stored in /usr/share/zoneinfo/$TZ
</p>

<p>
For Toronto, it's /usr/share/zoneinfo/America/Toronto file but it's a link to Montreal file.
</p>

<p>
Make this link to /etc/localtime and then change the timezone
</p>

<p>
Refer to <a href="#orgbf1b0e0">docker:timezone</a>
</p>
</div>
</div>

<div id="outline-container-org317f189" class="outline-3">
<h3 id="org317f189"><span class="section-number-3">19.16</span> Hardware</h3>
<div class="outline-text-3" id="text-19-16">
<p>
PCI devices: <code>lspci</code>
USB devices: <code>lsusb</code>
Most of devices: <code>lshal</code>
</p>
</div>
</div>

<div id="outline-container-orgaf1ccbc" class="outline-3">
<h3 id="orgaf1ccbc"><span class="section-number-3">19.17</span> Package &amp; Repository</h3>
<div class="outline-text-3" id="text-19-17">
<p>
<code>cat /etc/apt/sources.list</code>
</p>

<p>
Repositories
</p>
<ul class="org-ul">
<li>Main</li>
<li>Universe: maintained by Ubuntu community</li>
<li>Backports: newest version of pkg</li>
<li>Multiverse: not free pkg</li>
<li>Restricted: hardware drivers etc.</li>
</ul>

<p>
Sometimes archive.ubunut.com doesn't respond.. change it to us.archive.ubuntu.com
</p>
<pre class="example">
sed -i 's/archive\.ubuntu\.com/us\.archive\.ubuntu\.com/' /etc/apt/sources.list

# for EOL, change list
sed -i 's/archive\.ubuntu\.com/old-releases\.ubuntu\.com/g' /etc/apt/sources.list
sed -i 's/security\.ubuntu\.com/old-releases\.ubuntu\.com/g' /etc/apt/sources.list
</pre>
</div>

<div id="outline-container-org84d95b9" class="outline-4">
<h4 id="org84d95b9"><span class="section-number-4">19.17.1</span> Package Management</h4>
<div class="outline-text-4" id="text-19-17-1">
</div>
<div id="outline-container-orgdef8c75" class="outline-5">
<h5 id="orgdef8c75"><span class="section-number-5">19.17.1.1</span> Debian only <code>yum</code></h5>
<div class="outline-text-5" id="text-19-17-1-1">
<p>
<code>yum check-update</code> only checks if any updates are available for installed packages only.
</p>

<p>
<code>yum</code> doesn't need to <code>apt-get update</code> like Ubuntu. In fact, <code>yum update</code> updates every currently installed package which is equivalent to Ubuntu <code>apt-get update; apt-get upgrade</code>
</p>

<p>
Try to avoid <code>yum upgrade</code> as it forces the removal of obsolete packages. Same as <code>yum update --obsoletes</code>
</p>

<p>
<code>yum list tree</code> to list package 'tree' info
</p>

<p>
<code>yum list installed tree</code> If it returns error, it means the package tree is not installed.
</p>
</div>
</div>

<div id="outline-container-org80b2824" class="outline-5">
<h5 id="org80b2824"><span class="section-number-5">19.17.1.2</span> <code>dpkg</code> lowest level Ubuntu, Debian</h5>
<div class="outline-text-5" id="text-19-17-1-2">
<p>
List installed packages: <code>dpkg -l</code> 
How to read dpkg output
</p>
<ul class="org-ul">
<li>First 3 columns show Desired action, Package status and Error flags</li>
<li>Desired action
<ul class="org-ul">
<li>unknown (u), install (i), hold (h), remove  (r), purge (p)</li>
</ul></li>
<li>Package Status
<dl class="org-dl">
<dt>Not-installed</dt><dd><code>n</code></dd>
<dt>Config-files</dt><dd><code>c</code></dd>
<dt>Half-installed</dt><dd><code>H</code></dd>
<dt>Unpacked</dt><dd><code>U</code></dd>
<dt>Half-configured</dt><dd><code>F</code></dd>
<dt>Triggers-awaiting</dt><dd><code>W</code></dd>
<dt>Triggers-pending</dt><dd><code>t</code></dd>
<dt>Installed</dt><dd><code>i</code></dd>
</dl></li>
<li>Error flags
<ul class="org-ul">
<li>&lt;empty&gt; = (none), R = Reinst-required</li>
</ul></li>
</ul>

<p>
If a package is installed: <code>dpkg -l wget</code>
Search if a package is installed: <code>dpkg -l | grep wget</code> or <code>dpkg -l 'wget*'</code>
</p>

<p>
More info of an installed package :: <code>dpkg -s openssh-client</code>
</p>

<p>
See forward/reverse dependencies of a package use <code>apt-cache showpkg javacc</code>
</p>

<p>
List files owned by a package <code>dpkg -L cron</code>
</p>

<p>
Find which package owns a file <code>dpkg -S /etc/crontab</code>
</p>
</div>
</div>

<div id="outline-container-org6b68c20" class="outline-5">
<h5 id="org6b68c20"><span class="section-number-5">19.17.1.3</span> <code>apt-get</code> <code>apt-cache</code> Ubuntu</h5>
<div class="outline-text-5" id="text-19-17-1-3">
<p>
Since Ubuntu 16.04, apt is introduced and it's a subset of apt-get and apt-cache
</p>

<p>
Update list of available packages (<i>var/lib/apt/lists</i>) :: <code>apt-get update</code>
</p>

<p>
It might return failed to fetch error. Might be due to <a href="#orgf3ca904">linux:dns</a> nameserver is changed to a local ip in a docker container in a docker network.
Add a line <code>nameserver 8.8.8.8</code> to /etc/resolv.conf
This way the /etc/resolv.conf is not persisted. You can also config DNS in Docker daemon.
</p>
<pre class="example">
RUN echo "nameserver 10.1.1.1" &gt;&gt; /etc/resolv.conf &amp;&amp; \
    your-other-commands
</pre>

<p>
Install or upgrade a package :: <code>apt-get install openssh-client</code>
</p>

<p>
To simulate what would happen if you upgrade/install a package (press <code>n</code> to cancel)
<code>apt-get -s install openssh-client</code>
</p>

<p>
To upgrade all installed packages :: <code>apt-get upgrade</code>
</p>

<p>
To simulate what would happen if upgrade all (press <code>n</code> to cancel) :: <code>apt-get -V -s upgrade</code>
</p>

<p>
Remove previously downloaded packages (/var/cache/apt/archives)
<code>apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*</code> 
</p>

<p>
For Ubuntu lower than 14.04, use <code>dpkg -l</code> to list all installed packages on Ubuntu
Otherwise, use <code>apt list --installed</code>
</p>

<p>
To see if a package is installed :: <code>apt list -a --installed openssh-client</code>
</p>

<p>
Search package by regex name (return name and description only): <code>apt-cache search php</code>
Search packages with name starting php (return names only) :: <code>apt-cache pkgnames php5</code>
All packages' names (return names only) :: <code>apt-cache pkgnames</code>
</p>

<p>
Find out dependencies of a package: <code>apt-cache showpkg php5-xmlrpc</code>
</p>
<ul class="org-ul">
<li>Other packages must be installed before php5-xmlrpc (under Dependencies)</li>
<li>Other packages depend on php5-xmlrpc (under Reverse Depends)</li>
<li>Different versions of this package you can install (under Provides)</li>
</ul>

<p>
To compare installed version of a package with remote version :: <code>apt-cache policy openssh-client</code>
</p>
</div>
</div>

<div id="outline-container-org3ce5ed2" class="outline-5">
<h5 id="org3ce5ed2"><span class="section-number-5">19.17.1.4</span> <code>aptitude</code> Highest Level Debian</h5>
<div class="outline-text-5" id="text-19-17-1-4">
<p>
It's not installed by default on Ubuntu
It removes orphan packages automatically
</p>

<p>
List installed packages :: <code>aptitude</code>
</p>

<p>
See if a package is installed :: <code>aptitude search package_name</code>
</p>
<ul class="org-ul">
<li>Before each package name, if you see `i` the package is installed</li>
<li id="package is virtual (installed)"><code>v</code></li>
<li id="package is deleted but not configuration files"><code>c</code></li>
<li id="no trace at all or <code>v</code>, it's not installed"><code>p</code></li>
<li>There might be a second character which indicates the action to be performed on the package.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org352cbe5" class="outline-4">
<h4 id="org352cbe5"><span class="section-number-4">19.17.2</span> Ubuntu Packages</h4>
<div class="outline-text-4" id="text-19-17-2">
</div>
<div id="outline-container-orgb80c4a1" class="outline-5">
<h5 id="orgb80c4a1"><span class="section-number-5">19.17.2.1</span> openssh-client <a id="orged28a75">linux:package:openssh-client</a></h5>
<div class="outline-text-5" id="text-19-17-2-1">
<p>
Includes ssh, scp
</p>
<pre class="example">
apt-get update &amp;&amp; apt-get -y install openssh-client
</pre>
</div>
</div>

<div id="outline-container-orga511f21" class="outline-5">
<h5 id="orga511f21"><span class="section-number-5">19.17.2.2</span> sendmail <a id="org1ca1f0d">linux:sendmail</a></h5>
<div class="outline-text-5" id="text-19-17-2-2">
<pre class="example">
apt-get install sendmail
# get the hostname of the machine/container
hostname
# say hostname is abc123
cat /etc/hosts

# You should see something like this
127.0.0.1 localhost

# add this line to the end
127.0.0.1 localhost localhost.localdomain abc123

# Run the sendmail config, answer Y to everything, sendmail will be restarted after
sudo sendmailconfig

# restart apache
service apache2 restart

# you may need to run sendmailconfig again to do the config

# check other configs
cat /etc/mail/sendmail.conf
cat /etc/cron.d/sendmail
cat /etc/mail/sendmail.mc

# in case you want to restart sendmail
service sendmail restart
# or
/etc/init.d/sendmail restart

# run this to see which emails are sent/stuck in queue
sendmail -bp
</pre>

<p>
You should setup logging in app level, such as <a href="#org48d9813">php:ini:mail</a>
</p>

<p>
Executable is /usr/sbin/sendmail
</p>
</div>
</div>

<div id="outline-container-org8b3375c" class="outline-5">
<h5 id="org8b3375c"><span class="section-number-5">19.17.2.3</span> ssmtp <a id="org3cf6168">linux:ssmtp</a></h5>
<div class="outline-text-5" id="text-19-17-2-3">
<p>
ssmtp is a simple alternative to <a href="#org1ca1f0d">linux:sendmail</a> and it doesn't depend on it.
</p>
<ul class="org-ul">
<li>sendmail can receive emails</li>
<li>sendmail has mail queues</li>
<li>ssmtp is good for only one user to send emails</li>
</ul>
</div>
</div>

<div id="outline-container-orgc481bd9" class="outline-5">
<h5 id="orgc481bd9"><span class="section-number-5">19.17.2.4</span> postfix <a id="org431e53b">linux:postfix</a></h5>
<div class="outline-text-5" id="text-19-17-2-4">
<p>
It's more sophisticated than sendmail.
<code>apt-get install postfix</code> will remove sendmail automatically
</p>

<p>
<a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-postfix-on-ubuntu-16-04">https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-postfix-on-ubuntu-16-04</a>
<a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-postfix-as-a-send-only-smtp-server-on-ubuntu-16-04">https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-postfix-as-a-send-only-smtp-server-on-ubuntu-16-04</a>
</p>
<pre class="example">
apt-get update &amp;&amp; apt install mailutils
// Default is Internet site. Use TAB and ENTER
// System mail name: example.com // Use FQDN (bare domain)
sudo nano /etc/postfix/main.cf
</pre>

<p>
Setup to send only
</p>

<p>
Change to loopback interface, the virtual network interface that the server uses to communicate internally.
</p>
<pre class="example">
// inet_interfaces = all
inet_interfaces = loopback-only
</pre>

<p>
Similar to sendmail /etc/hosts setting
</p>
<pre class="example">
// mydestination = $myhostname, example.com, localhost.com, , localhost
mydestination = $myhostname, localhost.$mydomain, $mydomain
</pre>

<p>
Restart postfix
</p>
<pre class="example">
/etc/init.d/postfix status
postfix status
postfix start
sudo systemctl restart postfix

// Test
echo "This is the body of the email" | mail -s "This is the subject line" myemail@a.com

// From: sammy@example.com where sammy is Linux username and example.com is the server's hostname
</pre>

<p>
Forward emails sent to root
</p>
<pre class="example">
sudo nano /etc/aliases

// With the following, system generated emails are sent to the root user.
postmaster: root

// Add
root: myemail@a.com

// restart
sudo newaliases

// Test
echo "This is the body of the email" | mail -s "This is the subject line" root
</pre>
</div>
</div>

<div id="outline-container-org3fe0b8d" class="outline-5">
<h5 id="org3fe0b8d"><span class="section-number-5">19.17.2.5</span> rtorrent</h5>
<div class="outline-text-5" id="text-19-17-2-5">
<pre class="example">
apt-get install rtorrent
</pre>

<p>
Press Enter to enter and you will see <code>load.normal&gt;</code> at the bottom
</p>

<p>
Paste the link and press enter to load the torrent file, to download it, press up or down arrow and C-s to start the download.
</p>

<p>
C-q :: quit. Execute twice, it shuts down without sending a stop signal
C-s :: start download
C-d :: Stop an active download or remove an already stopped download
C-k :: stop and close an active download
C-r :: hash check a torrent before upload/download begins
Left or right arrow :: redirect to previous or next screen
Up or down arrow :: to select a torrent file. Selected one will have * in front.
</p>
</div>
</div>
</div>

<div id="outline-container-org1eebe2d" class="outline-4">
<h4 id="org1eebe2d"><span class="section-number-4">19.17.3</span> Ubuntu troubleshooting</h4>
<div class="outline-text-4" id="text-19-17-3">
</div>
<div id="outline-container-org7a96c9e" class="outline-5">
<h5 id="org7a96c9e"><span class="section-number-5">19.17.3.1</span> Unmet dependencies</h5>
<div class="outline-text-5" id="text-19-17-3-1">
<p>
Run these
</p>
<pre class="example">
sudo apt-get clean
sudo apt-get update
sudo apt-get -f install
# check if it returns error that about disk full error
# fix disk full error first
# install the package again
sudo apt-get install make
</pre>

<p>
If it still doesn't work or it has error, run these
</p>
<pre class="example">
sudo dpkg --configure -a
sudo apt-get -f install
</pre>

<p>
If the output is below, it means it failed.
</p>
<pre class="example">
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
</pre>

<p>
Next solution is to run
</p>
<pre class="example">
sudo apt-get -u dist-upgrade
</pre>

<p>
If it shows any held packages, it is best to eliminate them. Packages are held because of dependency conflicts that apt cannot resolve. Try this command to find and repair the conflicts:
</p>
<pre class="example">
sudo apt-get -o Debug::pkgProblemResolver=yes dist-upgrade
</pre>

<p>
If it cannot fix the conflicts, it will exit with:
0 upgraded, 0 newly installed, 0 to remove and 6 not upgraded.
</p>

<p>
Delete the held packages one by one, running dist-upgrade each time, until there are no more held packages. Then reinstall any needed packages. Be sure to use the &#x2013;dry-run option, so that you are fully informed of consequences:
</p>
<pre class="example">
sudo apt-get remove --dry-run package-name
</pre>

<p>
Since removing the package you are trying to install may not be ideal, you might also try finding a repository that has the packages you need to satisfy the dependencies.
</p>

<p>
Finally, if all else fails, you can attempt to satisfy the dependencies yourself, either by finding and installing the necessary packages, or by installing them from source and then creating “deb” packages for them.
</p>

<p>
<a href="https://askubuntu.com/questions/140246/how-do-i-resolve-unmet-dependencies-after-adding-a-ppa">https://askubuntu.com/questions/140246/how-do-i-resolve-unmet-dependencies-after-adding-a-ppa</a>
</p>
</div>
</div>

<div id="outline-container-org6a659b4" class="outline-5">
<h5 id="org6a659b4"><span class="section-number-5">19.17.3.2</span> /boot directory is full <a id="orgf02a155">linux:disk full</a></h5>
<div class="outline-text-5" id="text-19-17-3-2">
<p>
If it's full 100% <code>df -h</code>, all apt commands will not run.
</p>

<p>
Run this to get installed kernels except the currently running one.
</p>
<pre class="example">
sudo dpkg --list 'linux-image*'|awk '{ if ($1=="ii") print $2}'|grep -v `uname -r`
</pre>

<p>
Also keep track of the 2 newest versions. <code>uname -r</code> to check the current kernel version. e.g.
</p>
<pre class="example">
linux-image-4.4.0-31-generic
linux-image-4.4.0-36-generic
linux-image-4.4.0-38-generic
linux-image-4.4.0-42-generic
linux-image-4.4.0-45-generic
linux-image-4.4.0-47-generic
linux-image-4.4.0-51-generic
linux-image-4.4.0-53-generic
linux-image-extra-4.4.0-31-generic
linux-image-extra-4.4.0-36-generic
linux-image-extra-4.4.0-38-generic
linux-image-extra-4.4.0-42-generic
linux-image-extra-4.4.0-45-generic
linux-image-extra-4.4.0-47-generic
linux-image-extra-4.4.0-51-generic
linux-image-extra-4.4.0-53-generic
</pre>

<p>
Current kernel version is 4.4.0-34-generic
</p>

<p>
Remove other kernels except the current one and the 2 newest ones.
</p>

<p>
Before delete, check which will be deleted first
</p>
<pre class="example">
ll /boot/*-4.4.0-{31,36,38,42,45,47}-*
sudo rm -rf /boot/*-4.4.0-{31,36,38,42,45,47}-*
</pre>

<p>
<code>df -h</code> will show the space is reduced. Fix apt-get
</p>
<pre class="example">
sudo apt-get -f install
</pre>

<p>
If you run into an error that includes a line like "Internal Error: Could not find image (/boot/vmlinuz-3.2.0-56-generic)", then run the command <code>sudo apt-get purge linux-image-3.2.0-56-generic</code> (with your appropriate version).
</p>

<p>
Now apt-get should work. Finally, <code>sudo apt-get autoremove</code> to clear out the old kernel image packages that have been orphaned by the manual boot clean.
</p>

<p>
Run <code>sudo apt-get update</code> and maybe <code>sudo apt-get upgrade</code> after.
</p>

<p>
<a href="https://askubuntu.com/a/430944/481813">https://askubuntu.com/a/430944/481813</a>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org82e7448" class="outline-3">
<h3 id="org82e7448"><span class="section-number-3">19.18</span> Bash File, Input and Output</h3>
<div class="outline-text-3" id="text-19-18">
</div>
<div id="outline-container-org10c1d4d" class="outline-4">
<h4 id="org10c1d4d"><span class="section-number-4">19.18.1</span> File Descriptors</h4>
<div class="outline-text-4" id="text-19-18-1">
<p>
File descriptors. First 3 are reserved.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-left">STDIN</td>
<td class="org-left">Standard input</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">STDOUT</td>
<td class="org-left">Standard output (echo)</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">STDERR</td>
<td class="org-left">Standard error</td>
</tr>
</tbody>
</table>

<pre class="example">
# Redirect stdout, creates if not exist or overwrites a file
ls -al goodfile &gt; stdoutlogfile
# same as 2&gt;, 3&gt; etc.

# Redirect stdout, creates if not exist or appends to a file
ls -al goodfile &gt;&gt; stdoutlogfile
# same as &amp;&gt;&gt;, 2&gt;&gt;, 3&gt;&gt; etc.

# Redirect stderr
ls -al badfile 2&gt; errorlogfile

# Redirect stdout and stderr to different files
ls -al goodfile badfile 2&gt; errorlogfile 1&gt; normalOutput

# Redirect stdout and stderr to the same file
ls -al goodfile badfile &amp;&gt; errorAndOutput
</pre>

<p>
<a id="org0b6d249">bash:tee</a>
</p>

<pre class="example">
# Redirect stdout of a commannd to a file and display stdout
date | tee testfile

# Redirect stdout to a file and pass stdout to another command as stdin
date | tee testfile | less

# Capture stdout of a command to a variable
output=$(date)

# Capture stdout and stderr of a command to a variable
output=$(command_which_has_stdout_and_stderr 2&gt;&amp;1)

# Redirect stdout of a command to one or multiple files and save stdout to a variable
# a file must be behind a tee command
# By default tee overwrites the file. Use -a to append to the end
$output = $(date | tee testfile1 testfile2)

# Redirect stdout to a variable and display to terminal in real time (not to stdout!)
# Works on Ubuntu and RedHat
$output = $(date | tee /dev/tty)

# Redirect one file descriptor (M, default 1) to another file descriptor (N) M&gt;&amp;N
# Redirect a manually made error 
echo "This is an error" &gt;&amp;2

# Change a file descriptor to a file
exec 2&gt;errorLogFile
echo "This is STDOUT and STDOUT is not changed to a file yet"
exec 1&gt;stdOutFile
echo "This doesn't display as STDOUT is redirected to a file"
echo "This is an error and in errorLogFile" &gt;&amp;2
</pre>

<p>
Up to 9 open file descriptors can be used at a time.
</p>
<pre class="example">
# Open a custom file descriptor to a file
exec 3&gt;customLog
echo "This goes to file descriptor 3" &gt;&amp;3

# Open a custom file descriptor and redirects to STDOUT
exec 4&gt;&amp;1

# If you want to change the reserved file descriptors. Always backup and change back
exec 5&gt;&amp;1
exec 6&gt;&amp;2

# Backup STDIN is a little different
exec 7&lt;&amp;0
</pre>
</div>
</div>

<div id="outline-container-orgd047d97" class="outline-4">
<h4 id="orgd047d97"><span class="section-number-4">19.18.2</span> Array</h4>
<div class="outline-text-4" id="text-19-18-2">
<pre class="example">
# define empty array
myarray=()

# define indexed array with values
myarray=( one two three four five )
declare -a curlArgs=('-H' "keyheader: value" '-H' "2ndkeyheader: 2ndvalue")

# define array with strings
myarray=( 'Hello World' 'Another item' )

# Get at index 0
echo ${myarray[0]}

# print array as a whole delimited by space
echo ${myarray[@]}

# print array as a whole delimited by newline
printf "%s\n" "${myarray[@]}"

# Convert an array to string variable delimited by newline
printf -v stringvar "%s\n" "${myarray[@]}"

# Remove the final newline
stringvar=${stringvar%?}

# prepend
arr=("new_element1" "new_element2" "..." "new_elementN" "${arr[@]}")

# Append to array
arr=( "${arr[@]}" "new_element" )
myarray+=('foo')
myarray+=("$line")

# Append only if it's new
containsElement() {
 local e
 for e in "${@:2}"; do [[ "$e" == "$1" ]] &amp;&amp; return 0; done
 return 1 
}
if ! containElement "$line" "${myarray[@]}"; then
 myarray+=("$line")
fi

# Append to a specific index (e.g. at arr[2])
arr=( "${arr[@]:0:2}" "new_element" "${arr[@]:2}" )

# Remove an element at a specific index (e.g. arr[2])
arr=( "${arr[@]:0:2}" "${arr[@]:3}" )

# Length
echo Number of elements in array: ${#myarray[@]}

# Loop array
for i in "${myarray[@]}"; do
  echo "$i"
done
</pre>
</div>

<div id="outline-container-orgb687f1d" class="outline-5">
<h5 id="orgb687f1d"><span class="section-number-5">19.18.2.1</span> Associative array</h5>
<div class="outline-text-5" id="text-19-18-2-1">
<pre class="example">
declare -A mymap
mymap[foo]=bar
echo ${mymap[foo]}

declare -A MYMAP=( [foo]=bar [baz]=quux [corge]=grault )

k=baz
mymap[$k]=quux
${mymap[$k]} is the same as ${mymap[baz]}

Key with spaces can be double and single quoted but they are the same as not quoting them
mymap[foo a]="bar b"
mymap["foo a"]="bar b"
mymap['foo a']="bar b"

Testing whether a value is missing from an associative array
$ if [ ${MYMAP[foo]+_} ]; then echo "Found"; else echo "Not found"; fi
Found

$ if [ ${MYMAP[missing]+_} ]; then echo "Found"; else echo "Not found"; fi
Not found

$ declare -A MYMAP=( [foo a]=bar [baz b]=quux )
$ echo "${!MYMAP[@]}"  # Print all keys - quoted, but quotes removed by echo
foo a baz b

$ # Loop through all keys in an associative array
$ for K in "${!MYMAP[@]}"; do echo $K; done
foo a
baz b

$ # Looping through keys and values in an associative array
$ for K in "${!MYMAP[@]}"; do echo $K --- ${MYMAP[$K]}; done
foo a --- bar
baz b --- quux

Redeclare, clear the whole array
$ declare -A MYMAP
$ MYMAP[foo]=bar
$ echo ${MYMAP[foo]}
bar
$ declare -A MYMAP    # Re-declaring DOES NOT clear an associative array
$ echo ${MYMAP[foo]}
bar
$ unset MYMAP         # You need to unset and re-declare to get a cleared associative array
$ declare -A MYMAP
$ echo ${MYMAP[foo]}

Unset a key
$ MYMAP[foo]=bar
$ echo ${MYMAP[foo]}
bar
$ unset ${MYMAP[foo]} # WRONG
$ echo ${MYMAP[foo]}
bar
$ unset MYMAP[foo]    # To delete from an associative array, use "unset" with similar syntax to assigning
$                     # BUT see next section if key contains spaces
$ echo ${MYMAP[foo]}

$ MYMAP[baz]=quux
$ echo ${MYMAP[baz]}
quux
$ K=baz
$ unset MYMAP[$K]       # Can unset using a variable for the key too
$                       # BUT see next section if variable may contain spaces - always better to quote
$ echo ${MYMAP[baz]}

Unset a key that has spaces
$ unset MYMAP[foo Z]     # WRONG
$ unset MYMAP["foo Z"]    # You must quote keys containing spaces when you unset in an associative array
$ echo ${MYMAP[foo Z]}

Length, same as indexed array
$ declare -A MYMAP=( [foo a]=bar [baz b]=quux )
$ echo ${#MYMAP[@]}  # Number of keys in an associative array
</pre>
</div>
</div>
</div>

<div id="outline-container-org0296d2a" class="outline-4">
<h4 id="org0296d2a"><span class="section-number-4">19.18.3</span> echo and print</h4>
<div class="outline-text-4" id="text-19-18-3">
<pre class="example">
echo -e "Hello\nWorld"; 
# echo newline -e to use \n etc
# always wrap variable in double quotes to preserve newline character
echo "$output"
</pre>
</div>
</div>

<div id="outline-container-orga0b62a3" class="outline-4">
<h4 id="orga0b62a3"><span class="section-number-4">19.18.4</span> printf</h4>
<div class="outline-text-4" id="text-19-18-4">
<p>
Print multilines
</p>
<pre class="example">
printf '%s\n%s\n' "$line1" "$line2"
</pre>
</div>
</div>

<div id="outline-container-orgd497ab7" class="outline-4">
<h4 id="orgd497ab7"><span class="section-number-4">19.18.5</span> Read command output line by line</h4>
<div class="outline-text-4" id="text-19-18-5">
<pre class="example">
multiple_commands_output=""
output=$(drush command output contains multiple lines);
count=1
while IFS=$'\n' read -r line; do
  echo "Line number $count: $line"
  count=$[ $count + 1 ] 
done &lt;&lt;&lt; "$output"

multiple_commands_output="$multiple_commands_output""$output"$'\n'

;; # You don't have to change back IFS as it only affects the while loop
;; # newline character is \n
;; # read -r :: to ignore all backslashes
</pre>
</div>
</div>

<div id="outline-container-org325f414" class="outline-4">
<h4 id="org325f414"><span class="section-number-4">19.18.6</span> Multiple lines of text</h4>
<div class="outline-text-4" id="text-19-18-6">
<p>
Store as a variable
</p>
<pre class="example">
read -r -d '' VAR &lt;&lt; EOM
This is line 1.
This is line 2.
Line 3.
EOM

echo "$VAR"
</pre>
</div>
</div>
<div id="outline-container-orga01d080" class="outline-4">
<h4 id="orga01d080"><span class="section-number-4">19.18.7</span> Date format <a id="org2dcffc2">bash:date</a></h4>
<div class="outline-text-4" id="text-19-18-7">
<p>
date +%F :: YYYY-MM-DD
date +%H :: 00..23
date +%M :: minute 00..59
date +%S :: second 00..60
date +%T :: HH:MM:SS
date +%Z :: time zone e.g. EDT
</p>

<p>
date +%FT%T%Z :: 2017-10-13T16:39:02UTC
date +%FT%H%M%S :: 2017-10-13T16-39-02 use this as it is filename safe
</p>
</div>
</div>

<div id="outline-container-org5648560" class="outline-4">
<h4 id="org5648560"><span class="section-number-4">19.18.8</span> Last executed command</h4>
<div class="outline-text-4" id="text-19-18-8">
<pre class="example">
#!/bin/bash
set -o history -o histexpand
var1='hello'
echo $var1
echo !!
</pre>
</div>
</div>

<div id="outline-container-org62afba7" class="outline-4">
<h4 id="org62afba7"><span class="section-number-4">19.18.9</span> Passing arguments to command</h4>
<div class="outline-text-4" id="text-19-18-9">
<p>
Variable can be passed to a command as argument value which is preceded by the argument name
</p>
<pre class="example">
ua='User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36'
curl https://a.ca/ -L \
  -H "$ua"
</pre>

<p>
Argument name and value cannot be passed in the above way. Use array
</p>
<pre class="example">
// create a non-associative array
declare -a curlArgs=('-H' "keyheader: value" '-H' "2ndkeyheader: 2ndvalue")
curl "${curlArgs[@]}"
</pre>
</div>
</div>

<div id="outline-container-orgcba228c" class="outline-4">
<h4 id="orgcba228c"><span class="section-number-4">19.18.10</span> String Operators</h4>
<div class="outline-text-4" id="text-19-18-10">
<pre class="example">
# A string is delimited by :
# Get the last element
foo=1:2:3:4:5
echo ${foo##*:}

# '##' means greedy front trim
# * matches any character
# until the last ':'
# also work for space as delimiter
# ${foo##* }

# Concatenate string variables
z=""
a="Hello\n"
b="World\n"
c="!"

z="$z""$a"
z="$z""$b"

# insert a newline
z="$z""$c"$'\n'
</pre>
</div>
</div>

<div id="outline-container-orgea548ce" class="outline-4">
<h4 id="orgea548ce"><span class="section-number-4">19.18.11</span> String comparison</h4>
<div class="outline-text-4" id="text-19-18-11">
<pre class="example">
# Start with 'node'
if [[ $a == node* ]]; then

# Start with a string 'Hello World'
[[ $a == "Hello World"* ]]
</pre>
</div>
</div>

<div id="outline-container-orgf9b3570" class="outline-4">
<h4 id="orgf9b3570"><span class="section-number-4">19.18.12</span> Numeric comparison</h4>
<div class="outline-text-4" id="text-19-18-12">
<p>
Not floating-point values
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Equal</td>
<td class="org-left">$n1 -eq $n2</td>
</tr>

<tr>
<td class="org-left">greater or equal</td>
<td class="org-left">$n1 -ge $n2</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">$n1 -gt $n2</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">$n1 -le $n2</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">$n1 -lt $n2</td>
</tr>

<tr>
<td class="org-left">not equal</td>
<td class="org-left">$n1 -ne $n2</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgb961924" class="outline-4">
<h4 id="orgb961924"><span class="section-number-4">19.18.13</span> Bash: shell variable with default value</h4>
<div class="outline-text-4" id="text-19-18-13">
<p>
./yourcustom.sh var1 var2
</p>

<pre class="example">
this_var1=$1
this_var2=${10}

# maximum 11 variables
this_var3=${3:-"_"}
# if var3 is not provided, then default is string _
</pre>
</div>
</div>

<div id="outline-container-org44a4523" class="outline-4">
<h4 id="org44a4523"><span class="section-number-4">19.18.14</span> <a id="org5cf2f4d">Bash if</a></h4>
<div class="outline-text-4" id="text-19-18-14">
<pre class="example">
if [ conditions ]; then
 # commands
elif [ conditions ]; then
 # more commands
elif [ conditions ]; then
 # more commands
else
 # more commands
fi
</pre>
</div>
</div>

<div id="outline-container-orgcf879f7" class="outline-4">
<h4 id="orgcf879f7"><span class="section-number-4">19.18.15</span> Special Parameters</h4>
<div class="outline-text-4" id="text-19-18-15">
<p>
man bash
$@ =&gt; "$1" "$2" "$3" &#x2026;
</p>
</div>
</div>
</div>

<div id="outline-container-org31a2b3b" class="outline-3">
<h3 id="org31a2b3b"><span class="section-number-3">19.19</span> curl, wget</h3>
<div class="outline-text-3" id="text-19-19">
</div>
<div id="outline-container-org52e26e1" class="outline-4">
<h4 id="org52e26e1"><span class="section-number-4">19.19.1</span> curl <a id="org1c3b962">linux:curl</a></h4>
<div class="outline-text-4" id="text-19-19-1">
</div>
<div id="outline-container-orgd2ef0ed" class="outline-5">
<h5 id="orgd2ef0ed"><span class="section-number-5">19.19.1.1</span> Basic</h5>
<div class="outline-text-5" id="text-19-19-1-1">
<pre class="example">
dlDir=/home/lili/download/
dlFileName = ${dlDir}123.xml
curl "http://abc.com/123.xml" -L -o ${dlFileName}
</pre>
</div>
</div>

<div id="outline-container-orgde960b5" class="outline-5">
<h5 id="orgde960b5"><span class="section-number-5">19.19.1.2</span> Return HTTP response header only</h5>
<div class="outline-text-5" id="text-19-19-1-2">
<p>
<code>curl -m 120 -IL "http://url.com" &gt;&gt; /path/to/log.log</code>
e.g Drupal Cron URL response status
</p>
<pre class="example">
#!/bin/bash
curl -sL -o /dev/null -w "%{http_code}\n" "http://drupalcronurl" &gt;&gt; /path/to/your/cronlog
</pre>
</div>
</div>

<div id="outline-container-org25993be" class="outline-5">
<h5 id="org25993be"><span class="section-number-5">19.19.1.3</span> Download with HTTPS or HTTP authentication</h5>
<div class="outline-text-5" id="text-19-19-1-3">
<p>
Popup form or server authentication
<code>curl https://a.com/b.aspx -u user:password -L -o /path/to/xml.xml</code>
</p>
</div>
</div>

<div id="outline-container-org26c248c" class="outline-5">
<h5 id="org26c248c"><span class="section-number-5">19.19.1.4</span> <a id="org5c83800">cURL download only after or before a date</a></h5>
<div class="outline-text-5" id="text-19-19-1-4">
<p>
Works for ftp and Http
</p>
<pre class="example">
fileLocalTime=$(date -r "$localfile")
curl $remote_file_path -u $user:$password -o $localfile -R -z "${fileLocalTime}"

# default is "after"
# add a dash before date string will result in "before".
fileLocalTimeNew=$(date -r "$localfile")

if [ "$fileLocalTime" == "$fileLocalTimeNew" ]; then
 echo "the same"
else
 echo $fileLocalTime
 echo $fileLocalTimeNew
fi
</pre>
</div>
</div>

<div id="outline-container-org4bc2a9f" class="outline-5">
<h5 id="org4bc2a9f"><span class="section-number-5">19.19.1.5</span> HTTP POST <a id="orgd830136">linux:curl:post</a></h5>
<div class="outline-text-5" id="text-19-19-1-5">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #74af68;"># </span><span style="color: #74af68;">default POST is application/x-www-form-urlencoded</span>
curl -X POST -d <span style="color: #e67128;">"test=that&amp;test2=that2"</span> http://..

<span style="color: #74af68;"># </span><span style="color: #74af68;">explict -H 'Content-Type: application/x-www-form-urlencoded'</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">with a data file</span>
curl -X POST -d <span style="color: #e67128;">"@data.txt"</span> http://..

<span style="color: #74af68;"># </span><span style="color: #74af68;">json</span>
curl -X POST -H <span style="color: #e67128;">'Content-Type: application/json'</span> -d <span style="color: #e67128;">"{\"test\": \"that\"}"</span> http://..

<span style="color: #74af68;"># </span><span style="color: #74af68;">with a data file</span>
curl -X POST -d <span style="color: #e67128;">"@data.json"</span> http://..
</pre>
</div>
</div>
</div>

<div id="outline-container-org13a4043" class="outline-5">
<h5 id="org13a4043"><span class="section-number-5">19.19.1.6</span> Use different IP address from DNS</h5>
<div class="outline-text-5" id="text-19-19-1-6">
<p>
a.ca by DNS points to 1.2.3.4 IP, change it to a different IP 2.2.3.4 temporarily.
</p>
<div class="org-src-container">
<pre class="src src-sh">curl -L -v -I --resolve <span style="color: #e67128;">'a.ca:80:2.2.3.4'</span> http://a.ca

<span style="color: #74af68;"># </span><span style="color: #74af68;">https://a.ca still points to 1.2.3.4 as port 80 does not match the request a.ca@443</span>
curl -L -v -I --resolve <span style="color: #e67128;">'a.ca:80:2.2.3.4'</span> https://a.ca

<span style="color: #74af68;"># </span><span style="color: #74af68;">Use this instead</span>
curl -L -v -I --resolve <span style="color: #e67128;">'a.ca:443:2.2.3.4'</span> https://a.ca

<span style="color: #74af68;"># </span><span style="color: #74af68;">sub domain</span>
curl -L -v -I --resolve <span style="color: #e67128;">'www.a.ca:443:2.2.3.4'</span> https://www.a.ca

<span style="color: #74af68;"># </span><span style="color: #74af68;">--resolve &lt;host:port:address&gt; force resolve of HOST:PORT to ADDRESS</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8841a86" class="outline-5">
<h5 id="org8841a86"><span class="section-number-5">19.19.1.7</span> Fetch as Googlebot <a id="orgaabc56a">curl:ua:googlebot</a></h5>
<div class="outline-text-5" id="text-19-19-1-7">
<p>
Googlebot's user agent: <a href="https://support.google.com/webmasters/answer/1061943">https://support.google.com/webmasters/answer/1061943</a>
</p>

<div class="org-src-container">
<pre class="src src-sh">curl -A <span style="color: #e67128;">"Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)"</span> -v https://a.ca
</pre>
</div>
</div>
</div>

<div id="outline-container-org63912dc" class="outline-5">
<h5 id="org63912dc"><span class="section-number-5">19.19.1.8</span> Options</h5>
<div class="outline-text-5" id="text-19-19-1-8">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">L</td>
<td class="org-left">Follow through all redirects</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">redirect STDOUT to a file</td>
</tr>

<tr>
<td class="org-left">O</td>
<td class="org-left">save file using same file name in current folder</td>
</tr>

<tr>
<td class="org-left">I</td>
<td class="org-left">get header response only</td>
</tr>

<tr>
<td class="org-left">m</td>
<td class="org-left">timeout in seconds</td>
</tr>

<tr>
<td class="org-left">H</td>
<td class="org-left">request header. <code>-H "Accept-Charset: ISO-8859-1,utf-8;q=0.7"</code></td>
</tr>

<tr>
<td class="org-left">limit-rate</td>
<td class="org-left">limit download speed: &#x2013;limit-rate=200k. use k, m or g</td>
</tr>

<tr>
<td class="org-left">s</td>
<td class="org-left">suppress STDOUT</td>
</tr>

<tr>
<td class="org-left">w</td>
<td class="org-left">rewrite STDOUT</td>
</tr>

<tr>
<td class="org-left">R</td>
<td class="org-left">Keep remote file timestamp. &#x2013;remote-time</td>
</tr>

<tr>
<td class="org-left">z</td>
<td class="org-left"><a href="#org5c83800">cURL download only after or before a date</a></td>
</tr>

<tr>
<td class="org-left">d</td>
<td class="org-left">send POST data</td>
</tr>

<tr>
<td class="org-left">A</td>
<td class="org-left">&#x2013;user-agent</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-orgc24ba3b" class="outline-4">
<h4 id="orgc24ba3b"><span class="section-number-4">19.19.2</span> wget <a id="orge953206">bash:wget</a></h4>
<div class="outline-text-4" id="text-19-19-2">
<p>
Compared to curl, wget's advantages are:
</p>
<ul class="org-ul">
<li>recursive</li>
<li>continue downloading after broken transfer</li>
<li>Specify cookies in get request</li>
<li>Has redirect-following</li>
<li>Capture response such as time stamping from the remote resource.</li>
</ul>

<p>
Disadvantages are only HTTP/HTTPS/FTP, Basic auth over HTTP proxy, no SOCKS support
</p>

<p>
wget [option]&#x2026; [URL]&#x2026;
</p>

<pre class="example">
http://[username:password@]host[:port]/directory/file
ftp://[username:password@]host[:port]/directory/file
</pre>

<p>
Download all subfolders and files of an FTP folder
</p>
<pre class="example">
cd ~
wget --user=hello --password='mypassword' -cr ftp://server/path/to/test

# Default depth is 5, change it
wget -r -l 2 ftp://... 
# for infinite depth :: -l inf

# path/to/test is 3 depths, by default, 2 more levels can be downloaded

# ~/server/path/to/test/* will be downloaded

# -nH ~/path/to/test will be downloaded
# -nH --cut-dirs=1 ~/to/test will be downloaded
# -nH --cut-dirs=2 ~/test will be downloaded
# --cut-dirs=1 ~/server/to/test will be downloaded

# --ftp-user or --http-user can also be used. There's no difference

# Ignore folders (not file)
wget -cr -X path/to/folder/ignore/ ftp://server/path/to/folder/

# folder path/to/folder/ignore/ will not be downloaded

# wildcards can also be used
wget -cr -X path/to/folder/ignore*/ ftp://server/path/to/folder/

# ignore multiple folders
-X path/to/folder/ignore1,path/to/folder/ignore2

# Only include certain folders -I, exactly the same as -X

# Only download files -A
-A books*,zelazny*196[0-9],gif,jpg

gif and jpg are normal letters, they match the ending part of a file (not exactly file extension)

# Ignore certain files -R, exactly the same as -A

# -nH :: --no-host-directories :: use it with --cut-dirs. e.g. download http://a.com/ by default creates a.com/ directory

# -P :: --directory-prefix :: Default is . (the current directory)

# -N to retrieve timestamps so if local files are newer, skip download.

# -c :: enable continue download

# --limit-rate=20k :: limit download speed to 20kb/s, m or g can also be used

# -b :: put command run in background

# -O path/to/local/file :: output to a local file. Change downloaded filename

# Logging
# -v :: default
# -q :: complete quiet
# -nv :: only error and basic info are printed
</pre>

<p>
In summary, to download everything under <a href="ftp://server/path/to/test">ftp://server/path/to/test</a> to ~/test
</p>

<pre class="example">
cd ~ &amp;&amp; wget --user=abc --password='pass' -cr -l inf -N -nH --cut-dirs=2 ftp://server/path/to/test

# copy to ~/bk/test
cd ~ &amp;&amp; wget --user=abc --password='pass' -cr -l inf -N -nH --cut-dirs=2 -P bk/ ftp://server/path/to/test
</pre>

<p>
Download and update a subfolder
You have downloaded <a href="ftp://server/path/to/test/">ftp://server/path/to/test/</a>* to ~/test
Now you want to only re-download <a href="ftp://server/path/to/test/1/">ftp://server/path/to/test/1/</a>* and update ~/test/1
</p>
<pre class="example">
cd ~
wget --user=abc --password='pass' -cr -l inf -N -nH --cut-dirs=3 -P test/ ftp://server/path/to/test/1

# -P :: default is . (current folder) Prefix local directory
</pre>

<p>
<a href="https://www.gnu.org/software/wget/manual/wget.html">Manual</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org226e4de" class="outline-3">
<h3 id="org226e4de"><span class="section-number-3">19.20</span> Cron <a id="org745f2fb">linux:cron</a></h3>
<div class="outline-text-3" id="text-19-20">
</div>
<div id="outline-container-orgba8de11" class="outline-4">
<h4 id="orgba8de11"><span class="section-number-4">19.20.1</span> Cron table (crontab)</h4>
<div class="outline-text-4" id="text-19-20-1">
<p>
Each user can have his own cron table. Use <code>crontab</code> to manage a user's cron jobs
</p>

<p>
List current user's cron table (called crontab) <code>crontab -l</code>
List a user's cron table :: <code>crontab -u username -l</code>
User crontabs are in /var/spool/cron/*
</p>

<p>
List system-wide crontab. You shouldn't need to modify it. <code>cat /etc/crontab</code>
</p>

<p>
Packages usually saved under <i>etc/cron.d/* use the same syntax as /etc/crontab</i>
</p>

<p>
Backup your crontab before edit <code>crontab -l &gt; ~/cron.back</code>
To add entries to cron table <code>crontab -e</code>
</p>

<p>
<code>echo $PATH</code> may have to be copied to either the script file or crontab because <code>env</code> in cron is different from <code>env</code> the shell that you run the script in.
</p>

<pre class="example">
# Setup a Linux cron to run a Drupal Cron URL every 5 minutes
*/5 * * * * /path/to/rundrupalcron.sh
</pre>

<p>
There're 4 cron directories. Copy script files to one of them and run as root:
/etc/cron.daily
/etc/cron.hourly
/etc/cron.montly
/etc/cron.weekly
</p>

<p>
Packages put crontab file to folder /etc/cron.d/*
</p>
</div>
</div>

<div id="outline-container-orgc2b2c58" class="outline-4">
<h4 id="orgc2b2c58"><span class="section-number-4">19.20.2</span> User crontab syntax and system-wide syntax</h4>
<div class="outline-text-4" id="text-19-20-2">
<p>
User Crontab Syntax <code>min hour dayofmonth month dayofweek command</code>
</p>
<ul class="org-ul">
<li>/var/spool/cron/*</li>
</ul>

<p>
System Crontab Syntax <code>min hour dayofmonth month dayofweek user command</code>
</p>
<ul class="org-ul">
<li>/etc/crontab</li>
</ul>

<p>
range :: 1-5
wildcard :: *
</p>

<p>
<code>dayofweek</code> :: can be (mon, tue, wed, thu, fri, sat, sun) or (1, 2, 3, 4, 5, 6, 0)
</p>

<pre class="example">
# Last day of month 
00 12 * * * if [ `date +%d -d tomorrow` = 01 ] ; then ; command

# Every 15 minutes every Wednesday
*/15 * * * 3 echo "do something

# Every hour except 6am 
00 0-5,7-23 * * * echo "hi"
</pre>

<p>
Special strings to replace with all 5 time-and-date fields
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">@reboot</td>
<td class="org-left">Run once, at startup.</td>
</tr>

<tr>
<td class="org-left">@yearly</td>
<td class="org-left">Run once a year, "0 0 1 1 *".</td>
</tr>

<tr>
<td class="org-left">@annually</td>
<td class="org-left">(same as @yearly)</td>
</tr>

<tr>
<td class="org-left">@monthly</td>
<td class="org-left">Run once a month, "0 0 1 * *".</td>
</tr>

<tr>
<td class="org-left">@weekly</td>
<td class="org-left">Run once a week, "0 0 * * 0".</td>
</tr>

<tr>
<td class="org-left">@daily</td>
<td class="org-left">Run once a day, "0 0 * * *".</td>
</tr>

<tr>
<td class="org-left">@midnight</td>
<td class="org-left">(same as @daily)</td>
</tr>

<tr>
<td class="org-left">@hourly</td>
<td class="org-left">Run once an hour, "0 * * * *".</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgbb8f48f" class="outline-4">
<h4 id="orgbb8f48f"><span class="section-number-4">19.20.3</span> Sample</h4>
<div class="outline-text-4" id="text-19-20-3">
<pre class="example">
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
0 2 * * * /home/li/cron/a.sh
10 2 * * * /home/li/cron/b.sh
*/20 0-2,6-23 * * * /home/li/cron/c.sh
10 3 * * * /home/li/cron/d.sh
10 19 * * 0 /home/li/cron/e.sh
</pre>
</div>
</div>
</div>

<div id="outline-container-org8367bd7" class="outline-3">
<h3 id="org8367bd7"><span class="section-number-3">19.21</span> upx <a id="orgbf0a554">linux:upx</a></h3>
<div class="outline-text-3" id="text-19-21">
<p>
Executable file packer (compresser)
</p>

<pre class="example">
apt-get install upx-ucl

# Most compressed level. Result file go.upx
upx --brute go
</pre>
</div>
</div>

<div id="outline-container-org9091641" class="outline-3">
<h3 id="org9091641"><span class="section-number-3">19.22</span> Commands</h3>
<div class="outline-text-3" id="text-19-22">
</div>
<div id="outline-container-orgb66a3d0" class="outline-4">
<h4 id="orgb66a3d0"><span class="section-number-4">19.22.1</span> screen <a id="org5628199">bash:screen</a></h4>
<div class="outline-text-4" id="text-19-22-1">
<p>
Simply run <code>screen</code> creates a screen session.
</p>

<p>
In a screen session, multiple shell windows can be open from a single SSH session.
</p>

<p>
See if it's installed <code>which screen</code>.
</p>

<p>
For help :: <code>C-a ?</code> 
Create a window :: <code>C-a c</code>
Switch between windows: <code>C-a n</code> or <code>p</code> for previous window
Detach a window from the screen session and can be reattached later ::  <code>C-a d</code>
If network connection fails in one screen session, screen will automatically detach the session.
Reattach (when connection drops or you have detached froma a screen) :: <code>screen -r</code> or a specific screen
<code>screen -r 12345.pts-0.xxxx</code> or simply <code>screen -r 12345</code>
</p>

<p>
To get an alert when there's output registered on a specific screen, on that screen run <code>Ctrl-a M</code> and then switch to other screen
Or get an alert when there's no output <code>C-a _</code>
</p>

<p>
Lock a screen session when you need to go away <code>C-a x</code>
</p>

<p>
Stop the screen session :: <code>C-a k</code> or <code>exit</code> for each screen window.
</p>

<p>
List all screen sessions and status :: <code>screen -ls</code>
</p>

<p>
See window list <code>C-a "</code> it's double quote <code>S-'</code>
Rename current window :: <code>C-a A</code>
</p>

<p>
Run a background process after SSH signout
</p>
<pre class="example">
screen
nohup ./main &amp;
C-a d
exit
</pre>
</div>
</div>

<div id="outline-container-org732f080" class="outline-4">
<h4 id="org732f080"><span class="section-number-4">19.22.2</span> Run Sequentially</h4>
<div class="outline-text-4" id="text-19-22-2">
<p>
<code>lspci; lsusb</code>
If the first command not successful, 2nd command will not run: <code>lspci &amp;&amp; lspci</code>
</p>
</div>
</div>

<div id="outline-container-orgee6294e" class="outline-4">
<h4 id="orgee6294e"><span class="section-number-4">19.22.3</span> man <a id="org17ed2a3">bash:man</a></h4>
<div class="outline-text-4" id="text-19-22-3">
<p>
<code>man -k processes</code> Search `processes` in command names and description
<code>man -f ls</code> Search in command names and title
</p>
</div>
</div>

<div id="outline-container-orgc576586" class="outline-4">
<h4 id="orgc576586"><span class="section-number-4">19.22.4</span> <code>cd -</code> Navigate to previous directory (back)</h4>
</div>
<div id="outline-container-org6dadcc0" class="outline-4">
<h4 id="org6dadcc0"><span class="section-number-4">19.22.5</span> <code>wc</code></h4>
<div class="outline-text-4" id="text-19-22-5">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>-l</code></td>
<td class="org-left">Line Count</td>
<td class="org-left"><code>ps -ef \vert wc -l</code></td>
</tr>

<tr>
<td class="org-left"><code>-w</code></td>
<td class="org-left">Word Count</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>-c</code></td>
<td class="org-left">Byte Count</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>-m</code></td>
<td class="org-left">Character Count</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgc8a8d1e" class="outline-4">
<h4 id="orgc8a8d1e"><span class="section-number-4">19.22.6</span> Replace String  <code>sed</code> <a id="org97dacda">bash:sed</a></h4>
<div class="outline-text-4" id="text-19-22-6">
<p>
Replace all (g) Nick with John case-insensitive
cat report.txt | sed 's/Nick/John/gi' &gt; report_new.txt
</p>

<p>
sed SCRIPT INPUTFILE&#x2026;
or 
sed OPTIONS&#x2026; [SCRIPT] [INPUTFILE&#x2026;]
</p>

<p>
SCRIPT
</p>
<dl class="org-dl">
<dt>s command</dt><dd>'s/{regexp}/{replacement}/{flags}'
<dl class="org-dl">
<dt>{regexp}</dt><dd>To literally match string, wrap each letter in [ and ] and for ^ do [\^]
<ul class="org-ul">
<li>e.g. literal string '&amp;#x1f;' <code>sed 's/[&amp;][#][x][1][f][;]//gi' -i c.xml</code></li>
<li>literal string '&amp;#^x1f;' <code>sed 's/[&amp;][#][\^][x][1][f][;]//gi' -i c.xml</code></li>
</ul></dd>
<dt>{replacement}</dt><dd>You can use &amp; to subsitute the whole matched portion of the pattern.</dd>
</dl></dd>
</dl>

<p>
Refer to <a href="https://stackoverflow.com/questions/29613304/is-it-possible-to-escape-regex-metacharacters-reliably-with-sed">regexp and replacement escape</a>
</p>

<p>
OPTIONS
</p>
<dl class="org-dl">
<dt>-e SCRIPT</dt><dd>run several inline SCRIPT's described above</dd>
<dt>-f SCRIPT-FILE</dt><dd>Run commands in SCRIPT-FILE's</dd>
<dt>-i</dt><dd>files are edited in-place
<dl class="org-dl">
<dt>-i</dt><dd>original files are overwritten, no backup files are created</dd>
<dt>-i.backup or -i .backup (only Mac)</dt><dd>copy original to *.backup and change original files</dd>
</dl></dd>
<dt>(no term)</dt><dd>::</dd>
</dl>

<p>
For deleting only
sed "s/deletethis//g" -i input.txt
sed 's/&amp;#x1f;//gi' -i c.xml
For multiple files
sed 's/Nick/John/gi' *.txt
No backup
sed 's/Nick/John/gi' -i.backup *.txt
create backup files
</p>

<p>
Instead of / as delimiter, use | for handling string with / such as <code>http://</code>
</p>

<p>
Always use \ to escape no matter what delimiter is
</p>

<p>
Special characters to escape for {regexp}
Single quote :: \'
$ :: \$
. :: \.
<code>* :: \*</code>
[ :: \[
\ :: \\
] :: \]
^ :: \^
</p>

<p>
For inside bracket expression (list of characters), to literally include:
^ :: put it not at the beginning [ab^c]. If it's the only one, use [\^]
</p>
<ul class="org-ul">
<li>:: put it either at the start or end [-abc] or [abc-] not [a-bc]. If it's the only one, use [&#x00ad;]</li>
</ul>
<p>
] :: put it at the start []abc] or [^]abc] but not [abc]] nor [abc\]]. If it's the only one, [^]]
</p>

<p>
Special characters to escape for {replacement}
Single quote :: \'
&amp; and \ need to be escaped, as do the delimiter (usually /) and newlines \n
</p>

<p>
Notice :: escape \ is crucial because \number e.g. \1 is subsitution, \letter e.g. \n also has special meaning
</p>

<p>
Notice :: use double quotes for interpolation sed -e "s/$BRE/$REPL/"
</p>

<p>
<a href="https://www.gnu.org/software/sed/manual/sed.txt">man sed</a>
</p>
</div>
</div>

<div id="outline-container-org999ce58" class="outline-4">
<h4 id="org999ce58"><span class="section-number-4">19.22.7</span> Concatenate String with File</h4>
<div class="outline-text-4" id="text-19-22-7">
<p>
Append to the beginning
echo returns a newline
echo '&lt;?xml version="1.0"?&gt;' | cat - input.txt &gt; output.txt
</p>

<p>
'-' after 'cat' means to take the stdin from last command
</p>

<p>
Append to the end
echo 'end line' | cat input.txt - &gt; output.txt
</p>
</div>
</div>

<div id="outline-container-org0c8adf5" class="outline-4">
<h4 id="org0c8adf5"><span class="section-number-4">19.22.8</span> Change Encoding</h4>
<div class="outline-text-4" id="text-19-22-8">
<p>
Change from UCS-2 to UTF-8
iconv -f UCS-2 -t UTF-8 input.xml &gt; output.xml
</p>
</div>
</div>

<div id="outline-container-org6b11d63" class="outline-4">
<h4 id="org6b11d63"><span class="section-number-4">19.22.9</span> Comment out every line in a file and save as a new file</h4>
<div class="outline-text-4" id="text-19-22-9">
<p>
Add '# ' in front of every line
jail.conf is the source file, and jail.local is the destination file.
After it's run, jail.conf is not affected.
</p>
<pre class="example">
awk '{ printf "# "; print; }' /etc/fail2ban/jail.conf | sudo tee /etc/fail2ban/jail.local
</pre>
</div>
</div>

<div id="outline-container-orgb97e7ed" class="outline-4">
<h4 id="orgb97e7ed"><span class="section-number-4">19.22.10</span> sudo</h4>
<div class="outline-text-4" id="text-19-22-10">
<p>
Install sudo <code>apt-get update &amp;&amp; apt-get install -y sudo less</code>
Run sudo interactive <code>sudo -i</code>
</p>
</div>
</div>

<div id="outline-container-orgb1ab41b" class="outline-4">
<h4 id="orgb1ab41b"><span class="section-number-4">19.22.11</span> SHA, salt hashing <a id="org28db7d1">image:lucee:salt</a></h4>
<div class="outline-text-4" id="text-19-22-11">
<p>
./luceehashing.sh UIloginPassword salt
</p>
<pre class="example">
#!/bin/bash

SHA_ALGORITHM=256
SHA_COUNT=5

LUCEE_PASSWORD=${1:-"_"}
LUCEE_SALT=${2:-"_"}

if [ $LUCEE_PASSWORD == "_" ]; then
  LUCEE_PASSWORD=topsecret
fi
if [ $LUCEE_SALT == "_" ]; then
  LUCEE_SALT=$(uuidgen | tr a-z A-Z)
fi

COUNT=1
LUCEE_HASH=$(echo -n "${LUCEE_PASSWORD}:${LUCEE_SALT}" | shasum -a $SHA_ALGORITHM | cut -f1 -d' ')
while [ $COUNT -lt $SHA_COUNT ]; do
  LUCEE_HASH=$(echo -n $LUCEE_HASH | shasum -a $SHA_ALGORITHM | cut -f1 -d' ')
  COUNT=$((COUNT + 1))
done

echo "Lucee Admin Values"
echo "  hspw = $LUCEE_HASH"
echo "  salt = $LUCEE_SALT"
</pre>
</div>
</div>

<div id="outline-container-orgc92440a" class="outline-4">
<h4 id="orgc92440a"><span class="section-number-4">19.22.12</span> byobu</h4>
<div class="outline-text-4" id="text-19-22-12">
<p>
Create multiple terminals and switch between.
<code>apt-get install byobu</code>
</p>
</div>
</div>

<div id="outline-container-org37cac1a" class="outline-4">
<h4 id="org37cac1a"><span class="section-number-4">19.22.13</span> <code>w3m</code> Command line web browser</h4>
<div class="outline-text-4" id="text-19-22-13">
<p>
Ubuntu
</p>
<pre class="example">
apt-get install w3m
# S-Q to quit
</pre>
</div>
</div>

<div id="outline-container-org59fe73d" class="outline-4">
<h4 id="org59fe73d"><span class="section-number-4">19.22.14</span> set, <a id="org4b0f322"></a>&gt;</h4>
<div class="outline-text-4" id="text-19-22-14">
<pre class="example">
set -ex; command1; command2; ...
</pre>

<p>
-x :: enable a mode of the shell where all executed commands are printed to the terminal.
-e :: under common situation, exit when there's an error
</p>
</div>
</div>
</div>

<div id="outline-container-org88c5dbe" class="outline-3">
<h3 id="org88c5dbe"><span class="section-number-3">19.23</span> Cheat</h3>
<div class="outline-text-3" id="text-19-23">
<pre class="example">
sudo apt-get update &amp;&amp; sudo apt-get upgrade
sudo apt-get install python-pip
sudo pip install cheat
cheat -v
</pre>

<p>
Modify ~/.bashrc
</p>
<pre class="example">
# If not running interactively, don't do anything
case $- in
  *i*) ;;
    *) return;;
esac

export EDITOR="/usr/bin/nano"
export CHEATCOLORS=true

# don't put duplicate lines or lines starting with space in the history.
HISTCONTROL=ignoreboth
</pre>

<p>
Add to autocompletion
</p>
<pre class="example">
cd /etc/bash_completion.d/
# sudo wget https://raw.githubusercontent.com/chrisallenlane/cheat/master/cheat/autocompletion/cheat.bash
# cheat.bash is as follows
function _cheat_autocomplete {
    sheets=$(cheat -l | cut -d' ' -f1)
    COMPREPLY=()
    if [ $COMP_CWORD = 1 ]; then
        COMPREPLY=(`compgen -W "$sheets" -- $2`)
    fi
}

complete -F _cheat_autocomplete cheat
</pre>

<p>
<code>cheat -d</code> lists the directories that cheat sheets should be saved. One is ~/.cheat, the other is system
Each cheat sheet is a file, like ~/.cheat/ping
</p>
<pre class="example">
;; # some comments
ping -c 15 www.example.com

;; # another usage
ping ...
</pre>

<p>
<code>cheat -s packets</code> search all cheat sheets that has `packets` in commands and description.
Also return cheat sheet name
</p>

<p>
<code>cheat ping</code> show the `ping` cheat sheet
</p>
</div>
</div>

<div id="outline-container-org40c71c2" class="outline-3">
<h3 id="org40c71c2"><span class="section-number-3">19.24</span> Makefile <a id="org1844fb9">linux:makefile</a></h3>
<div class="outline-text-3" id="text-19-24">
<p>
Install in Ubuntu :: <code>sudo apt-get update &amp;&amp; sudo apt-get install make</code>
</p>

<p>
Create a Makefile in current folder
</p>
<div class="org-src-container">
<pre class="src src-makefile"><span style="color: #ffad29; font-weight: bold;">include</span> <span style="color: #dbdb95;">env_make</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">include a file which defines some variables</span>

<span style="color: #dbdb95;">NAME</span>=myimagename
<span style="color: #dbdb95;">VERSION</span>=0.1.0
<span style="color: #dbdb95;">REPO</span>=mydockerreponame
<span style="color: #74af68;"># </span><span style="color: #74af68;">define some variables</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">escape $ in string variable with $$, say password is $abc$ </span>
<span style="color: #dbdb95;">password</span>=$$abc$$

<span style="color: #74af68;"># </span><span style="color: #74af68;">trylogin:</span>
<span style="color: #74af68;">#     </span><span style="color: #74af68;">sshpass -p '$(</span><span style="color: #dbdb95;">password</span><span style="color: #74af68;">)' ssh -o StrictHostKeyChecking=no root@123.123.123.123</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">Define dynamic variable</span>
<span style="color: #dbdb95;">filename</span> := file_$(<span style="color: #dbdb95;">shell</span> date +%FT%T%Z).log

<span style="color: #00ede1; font-weight: bold;">.PHONY</span>: default build
<span style="color: #74af68;"># </span><span style="color: #74af68;">This tells make to not look elsewhere for commands default and build</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">Instead, run default and build as they are defined in this Makefile</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">Usually include all commands in this Makefile</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">command in Makefile is called target. Syntax of Makefile is</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">target ...: prerequisites ...</span>
<span style="color: #74af68;">#     </span><span style="color: #74af68;">recipe</span>
<span style="color: #74af68;">#     </span><span style="color: #74af68;">...</span>
<span style="color: #74af68;">#     </span><span style="color: #74af68;">...</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">A prerequisite is a file/command. It means to include a file</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">A recipe is an action (command). Every recipe line has to start with a tab character</span>

<span style="color: #00ede1; font-weight: bold;">default</span>:
        <span style="color: #34cae2;">@</span>echo <span style="color: #e67128;">"Some description"</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">If you run `make` in current folder without specifying which command, the first command will be run</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">@echo means it doesn't print out the actual command</span>

<span style="color: #00ede1; font-weight: bold;">all</span>: build
<span style="color: #74af68;"># </span><span style="color: #74af68;">the all command runs the build command</span>

<span style="color: #00ede1; font-weight: bold;">build</span>:
        <span style="color: #00ede1; font-weight: bold;">sudo docker build -t $(</span><span style="color: #00ede1; font-weight: bold;">NAME</span><span style="color: #00ede1; font-weight: bold;">)</span>:$(<span style="color: #dbdb95;">VERSION</span>) --rm .

<span style="color: #00ede1; font-weight: bold;">push</span>:
        <span style="color: #00ede1; font-weight: bold;">docker push $(</span><span style="color: #00ede1; font-weight: bold;">NAME</span><span style="color: #00ede1; font-weight: bold;">)/$(</span><span style="color: #00ede1; font-weight: bold;">REPO</span><span style="color: #00ede1; font-weight: bold;">)</span>:$(<span style="color: #dbdb95;">VERSION</span>)

<span style="color: #00ede1; font-weight: bold;">release</span>: build
        make push -e VERSION=$(<span style="color: #dbdb95;">VERSION</span>)
<span style="color: #74af68;"># </span><span style="color: #74af68;">`make release` runs `build` first, then run `push` with a parameter</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">can't put push as a prerequisite after `build` because it has to be run using a parameter</span>

<span style="color: #00ede1; font-weight: bold;">testecho</span>:
        <span style="color: #34cae2;">@</span>echo $$FOO
<span style="color: #74af68;"># </span><span style="color: #74af68;">make testecho FOO="a b c"</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">actually @echo $(</span><span style="color: #dbdb95;">foo</span><span style="color: #74af68;">) then ~make testecho foo="a b c"~</span>

<span style="color: #00ede1; font-weight: bold;">testsub</span>:
        <span style="color: #34cae2;">@</span>echo otheraction $(<span style="color: #dbdb95;">filter-out</span> <span style="color: #00ede1; font-weight: bold;">$</span><span style="color: #008b8b; font-weight: bold;">@</span>,$(<span style="color: #dbdb95;">MAKECMDGOALS</span>))

<span style="color: #74af68;"># </span><span style="color: #74af68;">make testsub a b c</span>
<span style="color: #74af68;"># </span><span style="color: #74af68; font-weight: bold;">$</span><span style="color: #008b8b; font-weight: bold;">@</span><span style="color: #74af68;"> is the target name, which is testsub</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">$(</span><span style="color: #dbdb95;">MAKECMDGOALS</span><span style="color: #74af68;">) is the list of targets, which is testsub a b c</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">This method requires you to put these 2 lines to the end of Makefile (remove leading #'s)</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">%:</span>
<span style="color: #74af68;">#    </span><span style="color: #74af68;">@:</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">%: is a target which matches every target</span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">@: is a recipe in which @ is the same as @echo. : means do nothing</span>

<span style="color: #74af68;"># </span><span style="color: #74af68;">Escaping $ might be needed for running sub command</span>

<span style="color: #00ede1; font-weight: bold;">start</span>:
        docker rm -f $$(docker ps -a -q)

<span style="color: #00ede1; font-weight: bold;">runrecipeinmiddle</span>:
        <span style="color: #34cae2;">-</span> echo do something
        <span style="color: #34cae2;">-</span> $(<span style="color: #dbdb95;">MAKE</span>) build

<span style="color: #74af68;"># </span><span style="color: #74af68;">- in front of command means ignore the exit status of the command so that a non-zero exit would not stop the recipe</span>
</pre>
</div>

<p>
Makefile :: make your-recipe
Makefile.test :: make -f Makefile.test your-recipe
Makefile.live :: make -f Makefile.live your-recipe
</p>

<p>
Be careful to close single quotes in @echo
</p>
</div>

<div id="outline-container-org93c0783" class="outline-4">
<h4 id="org93c0783"><span class="section-number-4">19.24.1</span> Characters to escape</h4>
<div class="outline-text-4" id="text-19-24-1">
<p>
<a href="https://www.cmcrossroads.com/article/gnu-make-escaping-walk-wild-side">https://www.cmcrossroads.com/article/gnu-make-escaping-walk-wild-side</a>
</p>
<pre class="example">
Escape # as \#
Escape $ as $$
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb7e0989" class="outline-3">
<h3 id="orgb7e0989"><span class="section-number-3">19.25</span> Nano <a id="org60c7e69">linux:nano</a></h3>
<div class="outline-text-3" id="text-19-25">
<dl class="org-dl">
<dt>Save</dt><dd>Ctrl + O</dd>
<dt>Exit</dt><dd>Ctrl + x</dd>
<dt>(no term)</dt><dd>Display line number and cursor position: C-c</dd>
<dt>(no term)</dt><dd>Uncut or paste text C-u</dd>
<dt>Search</dt><dd>C-w or F6, type string and enter to search, <code>Alt + W</code> to search next</dd>

<dt>(no term)</dt><dd>Select and copy, paste
<ul class="org-ul">
<li><code>Alt + Shift + A</code> or <code>C-6</code> to set mark, move cursor to selct</li>
<li><code>Alt + Shift + 6</code> or <code>M-6</code> to copy or use C-k to cut text</li>
<li>C-u to paste</li>
</ul></dd>

<dt>Turn off word wrap</dt><dd>Esc, release, then $ (shift+4)</dd>
<dt>Visually insert word wrap</dt><dd><code>Alt + Shift + 4</code></dd>
</dl>

<p>
By default, nano covert tab to 4 spaces. Turn off <code>Shift + Alt + Q</code>
</p>

<p>
Show line number when open <code>nano -c filename</code>
</p>
</div>
</div>

<div id="outline-container-orgc205a1b" class="outline-3">
<h3 id="orgc205a1b"><span class="section-number-3">19.26</span> Ubuntu Unity</h3>
<div class="outline-text-3" id="text-19-26">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">C-M t</td>
<td class="org-left">open Terminal</td>
</tr>

<tr>
<td class="org-left">M-&lt;F2&gt;</td>
<td class="org-left">run command/open app</td>
</tr>

<tr>
<td class="org-left">Super-T</td>
<td class="org-left">Open Trash</td>
</tr>

<tr>
<td class="org-left">Super-F</td>
<td class="org-left">Open Files</td>
</tr>

<tr>
<td class="org-left">Alt-`</td>
<td class="org-left">Switch between windows</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">of the current app</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org267f6c3" class="outline-3">
<h3 id="org267f6c3"><span class="section-number-3">19.27</span> Ubuntu Personal Package Archive PPA</h3>
<div class="outline-text-3" id="text-19-27">
<p>
Add a LibreOffice package from PPA to Software Sources
<code>sudo add-apt-repository ppa:libreoffice/ppa</code>, then <code>sudo apt-get update</code>
Remove the package source
<code>sudo add-apt-repository --remove ppa:libreoffice/ppa</code>, <code>apt-get update</code>
</p>

<p>
Remove it and downgrade back to previous version before using PPA
<code>sudo apt-get install ppa-purge</code>, <code>sudo ppa-purge ppa:libreoffice/ppa</code>
</p>
</div>
</div>

<div id="outline-container-org2812dcb" class="outline-3">
<h3 id="org2812dcb"><span class="section-number-3">19.28</span> Production Server Setup</h3>
<div class="outline-text-3" id="text-19-28">
<p>
<a href="#orga16f4ec">linux:user</a> :: Add a normal user, add the user to sudo group
<a href="#org31ed5e3">linux:ssh</a> :: Add ssh public key to the new user's .ssh folder
<a href="#orgf4a5402">linux:ssh:disallow_root</a> :: Disallow SSH in as root
<a href="#orgf3161d5">linux:sudo:nopassword</a> :: require no password for non-root users with sudo privilige/group
<a href="#orgc265d09">linux:firewall</a> :: configure firewall, open ports
<a href="#orgd6c7694">linux:timezone</a> :: setup timezone and sync time
</p>
</div>
</div>
</div>

<div id="outline-container-org1173e60" class="outline-2">
<h2 id="org1173e60"><span class="section-number-2">20</span> Domain Server, DNS Server, SSL/https</h2>
<div class="outline-text-2" id="text-20">
<p>
Refer to <a href="#orgf3ca904">linux:dns</a>
</p>
</div>

<div id="outline-container-orgfd047d7" class="outline-3">
<h3 id="orgfd047d7"><span class="section-number-3">20.1</span> DNS records: A AAAA ANAME CNAME TXT ALIAS URL</h3>
<div class="outline-text-3" id="text-20-1">
<p>
A hostname :: a sub domain. e.g. www
</p>

<p>
A records :: redirect hostname.domainname.com to an IP address. For the barebone domain name, the hostname is @
</p>

<p>
AAAA records :: same as A records but they are IPv6. Nowadays, both AAAA and A are needed
</p>

<p>
ANAME :: It's like CNAME. Name (from source domain) could be @. The value has to be another (target) apex domain. DNS resolves the target fully qualified domain name (FQDN) to an IP or multiple and also synthesize A records of the domain that points to the IP(s) of the FQDN. Since the target FQDN's IP is returned on the first lookup, it's faster than ALIAS record.
</p>

<p>
CNAME records :: point another subdomain (hostname) to an A record (e.g. hostname.domainname.com). It should only be used when there are no other records on that name. Don't use the bare domain in CNAME on the left hand side.
</p>

<p>
ALIAS records :: same as CNAME but it can coexist with other records on that name. It resolves the target domain to one or more A records. ALIAS's name can be (from source domain) anything, the value can be (target) any other external domain.
</p>

<p>
URL records :: redirect the name to the target name using HTTP 301 status code.
</p>

<p>
TXT record :: Google Search Console may add TXT @ google-site-verification=[code] TTL 1 Hour to verify site ownership.
</p>

<p>
The <code>A</code>, <code>CNAME</code>, <code>ALIAS</code> records causes a name to resolve to an IP. Vice-versa, the <code>URL</code> record redirects the name to a destination. The <code>URL</code> record is simple and effective way to apply a redirect for a name to another name, e.g. to redirect www.example.com to example.com
</p>

<p>
The <code>A</code> name must resolve to an IP, the <code>CNAME</code> and <code>ALIAS</code> record must point to a name.
</p>

<p>
The general rule is:
</p>

<ul class="org-ul">
<li>use an A record if you manage what IP addresses are assigned to a particular machine or if the IP are fixed (this is the most common case)</li>
<li>use a CNAME record if you want to alias a name to another name, and you don't need other records (such as MX records for emails) for the same name</li>
<li>use an ALIAS record if you are trying to alias the root domain (apex zone) or if you need other records for the same name</li>
<li>use the URL record if you want the name to redirect (change address) instead of resolving to a destination.</li>
</ul>

<p>
On bare/apex domain, usually A, ALIAS or ANAME record can be used. Only DNS Made Easy supports ANAME and DNSimple and others support ALIAS. ANAME and ALIAS are not industry standards.
</p>
</div>
</div>

<div id="outline-container-orgf45181b" class="outline-3">
<h3 id="orgf45181b"><span class="section-number-3">20.2</span> MX records and SPF record <a id="org455ff76">dns:mx</a></h3>
<div class="outline-text-3" id="text-20-2">
<dl class="org-dl">
<dt>HOSTNAME</dt><dd>e.g. use @ for barebone</dd>
<dt>Mail Providers Mail Server (or Value)</dt><dd>always end with "." e.g. alt4.aspmx.l.google.com.</dd>
<dt>Priority</dt><dd>the smaller the more important</dd>
</dl>

<p>
Google G Suite requires TTL to be 1 hour (3600). Priority might be different  by aspmx.l.google.com. must be the highest
Priority	Mail Server
1	ASPMX.L.GOOGLE.COM.
5	ALT1.ASPMX.L.GOOGLE.COM.
5	ALT2.ASPMX.L.GOOGLE.COM.
10	ALT3.ASPMX.L.GOOGLE.COM.
10	ALT4.ASPMX.L.GOOGLE.COM.
</p>

<p>
<a href="https://toolbox.googleapps.com/apps/checkmx/">Google G Suite Toolbox Check MX</a>
</p>

<p>
<a href="http://www.openspf.org/SPF_Record_Syntax">SPF record is a TXT record which has 0 or more ordered mechanisms</a>
<code>all | ip4 | ip6 | a | mx | ptr | exists | include</code>
</p>

<p>
Mechanism can be prefixed with 1 of 4 qualifiers. A qualifier means if the machanism matches the sender's IP, then return a result. If a mechanism matches the sender but no qualifier, then + is used. If no mechanism or modifier matches, then default result is Neutral. 
</p>
<pre class="example">
+ Pass
- Fail
~ SoftFail
? Neutral
</pre>

<pre class="example">
# Google G Suite SPF record
v=spf1 include:_spf.google.com ~all

# Add domain's A, MX records to the match list and always allow.
# Include a domain to the match list.
# Soft fail for all other senders IP or domains.
v=spf1 +a +mx include:_spf.google.com ip4:1.2.3.4 ip4:1.2.3.5 ip4:1.2.3.6 ~all
</pre>

<p>
Mechanism <code>all</code> matches all senders' IP's, and it's usually at the end. <code>-all</code> fail for all. <code>~all</code> soft fail for all. <code>+all</code> allows all senders.
</p>

<p>
Mechanism <code>mx</code> adds domain's MX details to the match list.
</p>

<p>
Mechanism <code>a</code> adds domain's A records to the match list.
</p>
</div>
</div>

<div id="outline-container-org23a537e" class="outline-3">
<h3 id="org23a537e"><span class="section-number-3">20.3</span> SOA record</h3>
<div class="outline-text-3" id="text-20-3">
<p>
The SOA record stores information about:
</p>
<ul class="org-ul">
<li>the name of the server that supplied the data for the zone;</li>
<li>the administrator of the zone; e.g. b.c.com is actually the email address b@c.com</li>
<li>the current version of the data file;</li>
<li>the number of seconds a secondary name server should wait before checking for updates;</li>
<li>the number of seconds a secondary name server should wait before retrying a failed zone transfer;</li>
<li>the maximum number of seconds that a secondary name server can use data before it must either be refreshed or expire;</li>
<li>and a default number of seconds for the time-to-live file on resource records.</li>
</ul>

<p>
A DNS zone is the part of a domain for which an individual DNS server is responsible. Each zone contains a single SOA record.
</p>

<p>
e.g. <code>ns2.a.com. b.c.com. 2018012804 10800 3600 604800 10800</code>
</p>
</div>
</div>

<div id="outline-container-org77a9c38" class="outline-3">
<h3 id="org77a9c38"><span class="section-number-3">20.4</span> redirect.center, redirect.name</h3>
<div class="outline-text-3" id="text-20-4">
<p>
If URL record is not available, use CNAME and <a href="http://redirect.center/">redirect.center</a> and redirect.name
Instructions: <a href="https://milanaryal.com/domain-redirecting-and-url-forwarding-with-a-simple-dns-record/">https://milanaryal.com/domain-redirecting-and-url-forwarding-with-a-simple-dns-record/</a>
</p>

<p>
redirect.center is especially good for redirect subdomain www.abc.com to google.com/path if the domain host doesn't support Domain Forwarding with path.
</p>

<p>
To redirect naked domain, use Forward Domain.
</p>

<pre class="example">
;; redirect google.example.com to google.com
google.example.com IN CNAME google.com.redirect.center

;; redirect google.example.com to google.com with a 302 status code
google.example.com IN CNAME google.com.opts-statuscode-302.redirect.center

;; If a user try to visit www.oldwebsite.com/about/ will redirect to path www.newwebsite.com/about/:
www.oldwebsite.com  IN  CNAME  www.newwebsite.com.opts-uri.redirect.center

;; opts-statuscode-{code} :: HTTP Status Code to be used in the redirect. 302, HTTP Status Code
;; opts-uri :: Append URI (if any) to the target URL
;; opts-slash
;; jobs.my-domain.com to http://www.my-domain.com/jobs
;; jobs IN CNAME to www.my-domain.com.opts-slash.jobs.redirect.center
;; multiple path components, jobs.my-domain.com to www.my-domain.com/jobs/xyz
;; jobs IN CNAME to www.my-domain.com.opts-slash.jobs.opts-slash.xyz.redirect.center

;; Use redirect.name instead of readirect.center
;; redirect google.example.com to google.com
google.example.com            IN  CNAME  alias.redirect.name
_redirect.google.example.com  IN  TXT    Redirects to https://www.google.com

;; redirect google.example.com to google.com with options
google.example.com            IN  CNAME  alias.redirect.name
_redirect.google.example.com  IN  TXT    Redirects from /* to https://www.google.com/*

;; Redirects to [target], where target is the target URL
;; Redirects from [path] to [target], where path is a path to match on the hostname
;; Redirects permanently to [target], where permanently redirects with a 301 status code (defaults to 302 otherwise)

;; redirect www.my-domain.com to https://my-domain.com
www.my-domain.com IN CNAME my-domain.com.opts-https.redirect.center
</pre>
</div>
</div>

<div id="outline-container-orgc5ab235" class="outline-3">
<h3 id="orgc5ab235"><span class="section-number-3">20.5</span> Domain Forwarding</h3>
<div class="outline-text-3" id="text-20-5">
<p>
Naked domain forwarding
Forward abc.com to <a href="http://google.com">http://google.com</a>
abc.com/xyz will become google.com/xyz in the address bar
</p>

<p>
Forward abc.com to <a href="http://google.com/xyz">http://google.com/xyz</a>
Some domain host and registration service might support that.
abc.com/ijk will become google.com/xyz/ijk in the address bar
</p>

<p>
Subdomain forwarding can be done as well.
</p>

<p>
Domain registrar might require to purchase SSL with domain in order to forward <a href="https://olddomain.com">https://olddomain.com</a> to <a href="https://newdomain.com">https://newdomain.com</a>
</p>

<p>
Mask is <a href="http://oldomain.com">http://oldomain.com</a> continues to appear as oldomain.com in address bar but it actually points to newdomain.com
</p>
</div>
</div>

<div id="outline-container-org019e11f" class="outline-3">
<h3 id="org019e11f"><span class="section-number-3">20.6</span> Domain Transfer</h3>
<div class="outline-text-3" id="text-20-6">
<ul class="org-ul">
<li>Make sure domain Admin contact email is valid. Unlock domain and remove privacy. Ask for auth code</li>
<li>Go to new registrar, in order to maintain the old nameservers, GoDaddy requires to setup DNS for the domain before request for domain transfer</li>
<li>Purchase domain transfer and enter auth code. .CA domains can be transferred immediately</li>
<li>On new registrar, create a DNS template and input old DNS records</li>
<li>At the end, change the nameservers to the new registrar and apply the DNS template with old records</li>
</ul>
</div>
</div>

<div id="outline-container-orgc64391a" class="outline-3">
<h3 id="orgc64391a"><span class="section-number-3">20.7</span> Addon domain</h3>
<div class="outline-text-3" id="text-20-7">
<p>
It's an addtional domain that the system stores as a subdomain
abc.com is registered in GoDaddy and will be added as an addon domain on abc.xyz.com. Change nameservers to the domain xyz.com host say ns.googlehosting.com ns2.googlehosting.com
Then in googlehosting, set it up as an addon domain :: abc.com &gt; subdomain abc.xyz.com, then specify the document root
</p>

<p>
abc.com will appear as parked on subdomain abc.xyz.com on the googlehosting
</p>

<p>
An addon domain has to be mapped to a main domain's subdomain. In this case, the subdomain is abc.xyz.com
</p>

<p>
Source domain is abc.com registered in GoDaddy and nameservers are later changed to destination domain's Google nameservers. Destination domain is abc.xyz.com and the root domain xyz.com is registered and DNS managed in Google.
</p>

<p>
You don't need to first create a subdomain and then create Addon domain. It will ask you to create a subdomain in the destination domain and point to a directory when you create an addon domain.
</p>

<p>
Source domain can be a subdomain e.g. s1.abc.com, change A record for s1.abc.com at GoDaddy to point to the destination's server IP. 
</p>
</div>
</div>

<div id="outline-container-org03ac48b" class="outline-3">
<h3 id="org03ac48b"><span class="section-number-3">20.8</span> Park domain</h3>
<div class="outline-text-3" id="text-20-8">
<p>
To park a domain means to make the domain as idle. Nameservers will be set to Default for example in GoDaddy.
</p>

<p>
Another instance is when you park multiple domains abc.net, abc.info to the main domain abc.com
</p>
</div>
</div>

<div id="outline-container-orgb006e69" class="outline-3">
<h3 id="orgb006e69"><span class="section-number-3">20.9</span> DNS History, IP location</h3>
<div class="outline-text-3" id="text-20-9">
<p>
<a href="https://securitytrails.com/dns-trails">https://securitytrails.com/dns-trails</a>
</p>

<p>
See all DNS records :: <a href="https://www.ultratools.com/tools/dnsLookup">https://www.ultratools.com/tools/dnsLookup</a>
</p>

<p>
Lookup domain registrar and nameservers use whois :: <a href="https://mxtoolbox.com/Whois.aspx">https://mxtoolbox.com/Whois.aspx</a>
</p>

<p>
Find IP location :: <a href="https://www.iplocation.net/">https://www.iplocation.net/</a>
</p>

<p>
DNS propagation :: <a href="https://www.whatsmydns.net/">https://www.whatsmydns.net/</a>
</p>
</div>
</div>

<div id="outline-container-orgf84a7ef" class="outline-3">
<h3 id="orgf84a7ef"><span class="section-number-3">20.10</span> AXFR and Find subdomains</h3>
<div class="outline-text-3" id="text-20-10">
<p>
Without DNS Zone file export, it's almost impossible to find all subdomains and their DNS records. The following can be used:
</p>
<ul class="org-ul">
<li>Brute force <code>dig a.x.com</code> <code>dig b.x.com</code></li>
<li id="<a href="https://pentest-tools.com/information-gathering/find-subdomains-of-domain">Pentest-tools.com - Find Subdomains</a>">not guaranteed to show all subdomains</li>
<li>If AXFR is enabled on DNS server and the IP from which this command is run is added as a secondary IP address to the target domain, the run <code>host -l x.com</code> or <code>dig @ns1.DomainsSOA.com x.com axfr</code></li>
<li>Use Google search results to filter out known subdomains <code>site:x.com -"www.x.com" -"a.x.com" -"b.x.com"</code></li>
</ul>

<p>
DNS servers host are known as zones. DNS zone transfer is to replicate db changes across several DNS servers. AXFR is referred as DNS zone transfer because it's the protocol used during a DNS zone transfer.
</p>

<p>
Initiate an AXFR zone-transfer request is simple and can be used by hackers. The below replicate x.com DNS records to the first nameserver.
<code>dig @ns1.DomainSOA.com x.com axfr</code>
</p>
</div>
</div>

<div id="outline-container-org4eded1e" class="outline-3">
<h3 id="org4eded1e"><span class="section-number-3">20.11</span> AutoSSL in WHM/cPanel <a id="org2bb4a59">autossl:whm</a></h3>
<div class="outline-text-3" id="text-20-11">
<p>
WHM and cPanel provides free SSL certificates for VPS and Dedicated server users.
<a href="http://www.inmotionhosting.com/support/edu/whm/creating-and-managing-accounts/using-auto-ssl">http://www.inmotionhosting.com/support/edu/whm/creating-and-managing-accounts/using-auto-ssl</a>
</p>

<p>
It uses SHA256 TLS v1 and expires every 90 days. TLS v1 must be disabled for eCommerce site by June 30, 2018. For non-eCommerce site, it's ok.
</p>

<p>
AutoSSL requires Domain Control Validation (DCV) - the domain has to have ns or A records point to the server that AutoSSL is generated. Otherwise, it will not do anything, not even creating .well-known folder.
</p>

<p>
First is to enable AutoSSL for WHM users. AutoSSL will check all root domains under the user account.
</p>

<p>
If you enable a user and the user has 1 root domain and several addon domains and subdomains, all will have SSL.
</p>

<p>
AutoSSL will include certificates for www. domains. e.g. www.yourrootdomain.com, www.yoursub.yourrootdomain.com 
yoursub.yourrootdomain.com was set up by you and you didn't setup www.yoursub.yourrootdomain.com
</p>

<p>
Use hosting nameservers in domain registrar. Log in WHM as root. Go to Manage AutoSSL.
</p>
<dl class="org-dl">
<dt>Providers</dt><dd>cPanel (powered by Comodo)</dd>
<dt>Options</dt><dd>Check all options.
<dl class="org-dl">
<dt>"Allow AutoSSL to replace invalid or expiring non-AutoSSL certificates"</dt><dd>enable this to allow AutoSSL to replace certs that the AutoSSL system did not issue e.g. you import purchased cert. Enable this will overwrite the imported cert with AutoSSL certificates.</dd>
</dl></dd>
<dt>Manage Users</dt><dd>Enable AutoSSL for relevant users</dd>
<dt>(no term)</dt><dd>Click on Run AutoSSL for All Users</dd>
<dt>(no term)</dt><dd>Check Logs</dd>
</dl>

<p>
SSL certificates should be now installed.
</p>

<p>
Check each domain SSL certificate using cPanel. SSL/TLS &gt; Certificates (CRT)
<a href="http://www.inmotionhosting.com/support/website/cpanel/add-delete-autossl-cpanel">http://www.inmotionhosting.com/support/website/cpanel/add-delete-autossl-cpanel</a>
</p>

<p>
A directory .well-known will be created in sub website directory if the parent website directory has AutoSSL
</p>
</div>
</div>

<div id="outline-container-orge1905d5" class="outline-3">
<h3 id="orge1905d5"><span class="section-number-3">20.12</span> Install SSL <a id="org4d89ba3">linux:ssl</a></h3>
<div class="outline-text-3" id="text-20-12">
<dl class="org-dl">
<dt>File .crt</dt><dd>certificate starts with <code>--BEGIN CERTIFICATE--</code></dd>
<dt>File .key</dt><dd>private key starts with <code>--BEGIN RSA PRIVATE KEY--</code></dd>
</dl>

<p>
Certificate Chain, Root Certificate, Intermediate Certificate, Root Certificate
Certificate Authorities issue SSL certificate
</p>
<ul class="org-ul">
<li>Install SSL certificate issued from CA1, this is called the end-user certificate.</li>
<li>CA1 utilizes a certificate issued by CA2 and CA2 utilizes a certificate issued by CA3</li>
<li>CA2's certificate is an intermediate CA.</li>
<li>CA3 is a root CA and its certificate is directly embeded in the web browser and is called root certificate since its CA is trusted by the browser.</li>
</ul>

<p>
Apache requires to bundle the intermediate certificates and assign the location of the bundle to <code>SSLCertificateChainFile</code> config.
Nginx requires to package the intermediate certificates in a single bundel with the end-user certificate.
</p>

<p>
Generate CSR (Certificate Signing Request) which gives a private key (myserver.key) and a CSR file (myserver.csr) with 2048 bits
</p>
<pre class="example">
openssl req –new –newkey rsa:2048 –nodes –keyout myserver.key –out myserver.csr

# Prompt for Common Name
# example.com for a single domain
# *.example.com for wildcard certificate
</pre>

<p>
Submit CSR to SSL authority to get .crt and use .key generated above and make them root user only.
</p>

<p>
<a href="https://medium.freecodecamp.org/how-to-get-https-working-on-your-local-development-environment-in-5-minutes-7af615770eec">Generate self-signed certificate</a>
</p>
<pre class="example">
# Create a Root SSL Certificate
# -new :: create a new private key and also certificate request (CR)
# and -x509 is to create a self signed certificate rather than a cerficiate request (CR)
# -nodes is to create private key without providing passphrase which is at least 4 letters long
openssl req -newkey rsa:4096 -nodes -keyout rootCA.key -x509 -days 1024 -out rootCA.pem

# enter random values for the prompt

# You can create a certificate with an existing key
# -new with -key creates a CR with an existing key
# openssl req -new -nodes -key rootCA.key -x509 -days 1024 -out rootCA.pem

# combine private key and certificate
# openssl pkcs12 -inkey rootCA.key -in rootCA.pem -export -out rootCA.p12
# validate p12 file
# openssl pkcs12 -in rootCA.p12 -noout -info

# add rootCA.p12 to trusted certificate. On Chrome, Settings &gt; Manage certificates &gt; Import under Trusted Root Certification Authorities
# After that, select the certificate with name Internet Widigits Pty Ltd. click Advanced and select all Certificate purposes
# Without doing the above step, https://localhost only works in InCognito mode.

# In docker-compose.yml
#     ports:
#      - "32012:80"
#      - "443:443"

# Inside the PHP + Apache container, copy the &lt;VirtualHost: *:80&gt; and make it *:443 and add 3 lines of SSL config as described in apache:ssl
# a2enmod ssl
# apache2ctl configtest
# apache2ctl graceful

# Now create domain certificate using the root SSL certificate

# create server.csr.cnf so you don't have to type
[req]
default_bits = 4096
prompt = no
default_md = sha256
distinguished_name = dn

[dn]
C=US
ST=RandomState
L=RandomCity
O=RandomOrganization
OU=RandomOrganizationUnit
emailAddress=hello@example.com
CN = localhost

# create v3.ext for creating X509 v3 certificate
authorityKeyIdentifier=keyid,issuer
basicConstraints=CA:FALSE
keyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment
subjectAltName = @alt_names

[alt_names]
DNS.1 = localhost

# Now create a certificate key for localhost using server.csr.cnf. The key is server.key. Also create a certificate signing request (CSR) server.csr
openssl req -new -nodes -out server.csr -newkey rsa:4096 -keyout server.key -config &lt;( cat server.csr.cnf )

# Genereate the domain certificate file server.crt using v3.ext that is created earlier
openssl x509 -req -in server.csr -CA rootCA.pem -CAkey rootCA.key -CAcreateserial -out server.crt -days 500 -extfile v3.ext
</pre>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #74af68;"># </span><span style="color: #74af68;">Read and verify a certificate</span>
openssl x509 -text -noout -in server.crt

<span style="color: #74af68;"># </span><span style="color: #74af68;">Read and verify a key</span>
openssl rsa -check -in server.key

<span style="color: #74af68;"># </span><span style="color: #74af68;">Read and very a CSR</span>
openssl req -text -noout -verify -in server.scr

<span style="color: #74af68;"># </span><span style="color: #74af68;">Read and verify a PKCS#12 file .pfx or .p12</span>
openssl pkcs12 -info -in rootCA.p12 -noout
</pre>
</div>

<p>
Combine certificates and install <a href="#org2fe41a1">nginx:ssl:config</a> <a href="#org6c71819">nginx:ssl:example</a>
</p>

<p>
<a href="#org529dc59">apache:ssl</a>
</p>
</div>
</div>

<div id="outline-container-org3a19e8a" class="outline-3">
<h3 id="org3a19e8a"><span class="section-number-3">20.13</span> SSL Testing Tools <a id="org119dd85">ssl:test</a></h3>
<div class="outline-text-3" id="text-20-13">
<p>
<a href="https://www.whynopadlock.com/">https://www.whynopadlock.com/</a>
Qualys <a href="https://www.ssllabs.com/ssltest/">https://www.ssllabs.com/ssltest/</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org3158307" class="outline-2">
<h2 id="org3158307"><span class="section-number-2">21</span> Docker</h2>
<div class="outline-text-2" id="text-21">
</div>
<div id="outline-container-org9a8101a" class="outline-3">
<h3 id="org9a8101a"><span class="section-number-3">21.1</span> Version, Info, Installation</h3>
<div class="outline-text-3" id="text-21-1">
<p>
Brief :: <code>docker --version</code>
Server and Client :: <code>sudo docker version</code>
Full :: <code>sudo docker info</code>
</p>

<p>
"Docker for Windows" needs Windows Hyper-V enabled. Command prompt is admin.
</p>

<p>
After installation, make sure <a href="#orgc265d09">linux:firewall</a> DEFAULT_FORWARD_POLICY="ACCEPT"
</p>

<p>
Use <code>systemctl</code> for managing Docker service.
</p>
</div>

<div id="outline-container-org2fb948f" class="outline-4">
<h4 id="org2fb948f"><span class="section-number-4">21.1.1</span> Without sudo</h4>
<div class="outline-text-4" id="text-21-1-1">
<p>
Users in user group <code>docker</code> can run docker commands without sudo.
</p>

<pre class="example">
# replace your username with ${USER}
sudo usermod -aG docker ${USER}

# to apply the new group membership, you can log out and back in, or run this
su - ${USER}

# print name (-n, --name) instead of a number and show group IDs (-G)
id -nG
</pre>
</div>
</div>

<div id="outline-container-orgca5d479" class="outline-4">
<h4 id="orgca5d479"><span class="section-number-4">21.1.2</span> Install on Digital Ocean</h4>
<div class="outline-text-4" id="text-21-1-2">
<p>
<a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-16-04">https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-16-04</a>
</p>
<pre class="example">
# Add GPG key
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -

# Add Docker repo to APT sources so that Docker is the most up to date
sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
sudo apt-get update

# query the APT cache, it will show docker-ce is from the docker repo
apt-cache policy docker-ce
sudo apt-get install -y docker-ce

# check if Docker is running
sudo systemctl status docker
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcb7b2c0" class="outline-3">
<h3 id="orgcb7b2c0"><span class="section-number-3">21.2</span> Command Help <code>docker docker-subcommand --help</code></h3>
</div>
<div id="outline-container-orgf2b4344" class="outline-3">
<h3 id="orgf2b4344"><span class="section-number-3">21.3</span> Images</h3>
<div class="outline-text-3" id="text-21-3">
<p>
List all images :: <code>docker images</code>
List all dangling images which can be removed :: <code>docker images -f "dangling=true"</code>
</p>

<p>
Remove all dangling images (-q is to return IDs only)
</p>
<pre class="example">
docker rmi $(docker images -f "dangling=true" -q --no-trunc)
</pre>

<p>
Remove all none images
<code>docker rmi $(docker images | grep "none" | awk '/ / { print $3 }')</code>
</p>

<p>
Download an image :: <code>docker pull phusion/baseimage</code> or with a tag <code>docker pull phusion/baseimage:0.9.18</code>
Remove an image :: <code>docker rmi imageName</code>
Save an image to tar file :: <code>docker save -o /path/docker-image-file.tar docker-image-name</code>
Import a tar to image :: <code>docker load -i /path/docker-image-file.tar</code>
</p>

<p>
Search image in Docker repository :: <code>docker search ubuntu</code>
</p>

<p>
<code>docker image inspect php:7.0-fpm</code> to see image setting
</p>

<p>
Extract Dockerfile from an image. Use one or more of below
</p>
<ul class="org-ul">
<li>Use <a href="#org863204d">image:dockerfile-from-image</a></li>
<li>docker image inspect &lt;image-name&gt;</li>
<li>docker history &#x2013;no-trunc &lt;image-name&gt;</li>
<li>sudo ./test.sh &lt;image-name&gt;</li>
</ul>

<pre class="example">
#!/bin/bash
docker history --no-trunc "$1" | \
sed -n -e 's,.*/bin/sh -c #(nop) \(MAINTAINER .*[^ ]\) *0 B,\1,p' | \
head -1
docker inspect --format='{{range $e := .Config.Env}}
ENV {{$e}}
{{end}}{{range $e,$v := .Config.ExposedPorts}}
EXPOSE {{$e}}
{{end}}{{range $e,$v := .Config.Volumes}}
VOLUME {{$e}}
{{end}}{{with .Config.User}}USER {{.}}{{end}}
{{with .Config.WorkingDir}}WORKDIR {{.}}{{end}}
{{with .Config.Entrypoint}}ENTRYPOINT {{json .}}{{end}}
{{with .Config.Cmd}}CMD {{json .}}{{end}}
{{with .Config.OnBuild}}ONBUILD {{json .}}{{end}}' "$1"
</pre>
</div>

<div id="outline-container-orgb2f8fe6" class="outline-4">
<h4 id="orgb2f8fe6"><span class="section-number-4">21.3.1</span> docker build, docker tag</h4>
<div class="outline-text-4" id="text-21-3-1">
<p>
With one Dockerfile in a folder (resource). Run to build :: <code>docker build -t your-image-name .</code>
</p>

<p>
Change myimage(:latest) to myimage:1.0
<code>docker tag myimage myimage:1.0</code>
</p>

<p>
Build an image and tag it with latest and 2.0
<code>docker build -t myimage:latest -t myimage:2.0 .</code>
</p>

<p>
Multiple Dockerfiles (Dockerfile1, Dockerfile2) in the current folder
<code>docker build -t your-image-name -f Dockerfile2 .</code>
</p>

<p>
Dockerfile and resource are in different folders (e.g. COPY a file from parent folder in Dockerfile)
<code>docker build -t your-image-name -f /path/Dockerfile.yourname /path/to/docker/</code>
</p>

<p>
Build a lot of times while testing a Dockerfile
</p>
<pre class="example">
docker build --rm --force-rm --no-cache -t my-image-name .
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb7e1511" class="outline-3">
<h3 id="orgb7e1511"><span class="section-number-3">21.4</span> run</h3>
<div class="outline-text-3" id="text-21-4">
</div>
<div id="outline-container-orgd78729d" class="outline-4">
<h4 id="orgd78729d"><span class="section-number-4">21.4.1</span> Interactive mode with tty <code>-it</code></h4>
<div class="outline-text-4" id="text-21-4-1">
<p>
If there's an  error, <code>cannot enable tty mode on non tty input</code>, try <code>-i</code> only.
</p>
</div>
</div>

<div id="outline-container-orgf497c9b" class="outline-4">
<h4 id="orgf497c9b"><span class="section-number-4">21.4.2</span> Run an image in a container and keep running in background</h4>
<div class="outline-text-4" id="text-21-4-2">
<pre class="example">
docker run --name wordpressdb -v=/vagrant/mydbdump:/tmp/mydbdump \
-v=/mydbdata:/var/lib/mysql \
-e MYSQL_ROOT_PASSWORD=password -e MYSQL_DATABASE=wordpress \
-d mysql:5.7.9
</pre>

<p>
Container name :: wordpressdb
Image name :: mysql:5.7.9
Detached mode (in background) :: -d
Insert environment variables :: -e
</p>
</div>
</div>

<div id="outline-container-org2cca2bd" class="outline-4">
<h4 id="org2cca2bd"><span class="section-number-4">21.4.3</span> Run an image in a temp container only once, then remove the container</h4>
<div class="outline-text-4" id="text-21-4-3">
<p>
A MySQL container, wordpressdb, created by mysql:5.7.9 image, is already running.
</p>

<p>
Start up another container using the same image
In this temp container, wordpressdb container can be discovered as wpdb (alias).
Then import a .sql file to wpdb
The temp container is then removed.
</p>

<p>
Refer to <a href="#org6a88ce0">docker:link</a>
</p>

<pre class="example">
docker run -it --rm \
-v=/vagrant/mydbdump:/tmp/mydbdump \
--link wordpressdb:wpdb mysql:5.7.9 \
sh -c \
'exec mysql -h"$WPDB_PORT_3306_TCP_ADDR" \
-P"$WPDB_PORT_3306_TCP_PORT" \
-uroot -p"$WPDB_ENV_MYSQL_ROOT_PASSWORD" \
wordpress &lt; /tmp/mydbdump/pantheon_db_sql'
</pre>
</div>
</div>

<div id="outline-container-orgec15a04" class="outline-4">
<h4 id="orgec15a04"><span class="section-number-4">21.4.4</span> Link</h4>
<div class="outline-text-4" id="text-21-4-4">
<p>
<a id="org6a88ce0">docker:link</a> is deprecated and it relies on Docker in default bridge network mode.
</p>
</div>
</div>

<div id="outline-container-org90d566c" class="outline-4">
<h4 id="org90d566c"><span class="section-number-4">21.4.5</span> &#x2013;name and &#x2013;hostname</h4>
<div class="outline-text-4" id="text-21-4-5">
<p>
Specify the container name using &#x2013;name
Inside the container, the container is called &#x2013;hostname=value
<code>docker run --hostname=value</code> OR <code>docker run -h value</code>
Combine &#x2013;name and &#x2013;hostname as much as you can
</p>
</div>
</div>

<div id="outline-container-orgc01d699" class="outline-4">
<h4 id="orgc01d699"><span class="section-number-4">21.4.6</span> &#x2013;privileged</h4>
<div class="outline-text-4" id="text-21-4-6">
<p>
e.g. allow docker container to run docker daemon, allow docker container to access all devices such as file systems.
</p>
</div>
</div>
</div>

<div id="outline-container-org2aa85cb" class="outline-3">
<h3 id="org2aa85cb"><span class="section-number-3">21.5</span> Containers cp logs stats start stop restart rm inspect</h3>
<div class="outline-text-3" id="text-21-5">
<dl class="org-dl">
<dt>List containers</dt><dd><code>docker ps -a</code></dd>
<dt>Stop and Start</dt><dd><code>docker stop containerName</code> <code>docker start containerName</code></dd>
<dt>Restart</dt><dd><code>docker restart containerName</code></dd>

<dt>Stop and remove</dt><dd><code>docker rm -f containerName</code></dd>
<dt>Stop and remove all containers</dt><dd><code>docker rm -f $(docker ps -a -q)</code></dd>
<dt>Stop and remove all exited containers</dt><dd><code>docker rm $(docker ps -qa --no-trunc --filter "status=exited")</code></dd>

<dt>Container log</dt><dd><code>docker logs -f containerName</code> -f to follow log output</dd>
</dl>
</div>

<div id="outline-container-org2184098" class="outline-4">
<h4 id="org2184098"><span class="section-number-4">21.5.1</span> docker inspect</h4>
<div class="outline-text-4" id="text-21-5-1">
<p>
<code>docker inspect containerName</code>
</p>

<dl class="org-dl">
<dt>Container network IP and settings</dt><dd><code>NetworkSetting &gt; IPAddress</code> or</dd>
</dl>
<div class="org-src-container">
<pre class="src src-bash">docker inspect containername | grep -i <span style="color: #e67128;">"IPAddress"</span>
</pre>
</div>

<dl class="org-dl">
<dt>Volume</dt><dd><code>Config &gt; Volumes</code> and <code>Mounts</code></dd>

<dt>Return true or false for container running state</dt><dd><code>docker inspect -f {{.State.Running}} $CONTAINER_ID</code></dd>
</dl>
</div>
</div>

<div id="outline-container-org1fbae5f" class="outline-4">
<h4 id="org1fbae5f"><span class="section-number-4">21.5.2</span> docker events - Show docker system log</h4>
</div>
<div id="outline-container-orga390385" class="outline-4">
<h4 id="orga390385"><span class="section-number-4">21.5.3</span> docker cp</h4>
<div class="outline-text-4" id="text-21-5-3">
<dl class="org-dl">
<dt>Copy files from container <code>ghost</code> to docker host</dt><dd><code>docker cp -L ghost:/usr/src/ghost/config.js ./config.js</code></dd>
<dt>Copy files from docker host to container</dt><dd><code>docker cp -L ./config.js ghost:/usr/src/ghost/config.js</code></dd>
<dt>Copy a folder, result <code>/var/www/transfer/web</code></dt><dd><code>docker cp web/. ghost:/var/www/transfer/web</code></dd>
<dt>Copy a folder, result <code>/var/www/transfer/web</code></dt><dd><code>docker cp web/ ghost:/var/www/transfer</code></dd>

<dt>-L</dt><dd>copy symbol link</dd>
<dt>-a</dt><dd>copy file permissions as well as userid:groupid</dd>
</dl>

<p>
SRC_PATH specifies a file
</p>
<ul class="org-ul">
<li>DEST_PATH does not exist
the file is saved to a file created at DEST_PATH</li>
<li>DEST_PATH does not exist and ends with /
Error condition: the destination directory must exist.</li>
<li>DEST_PATH exists and is a file
the destination is overwritten with the source file’s contents</li>
<li>DEST_PATH exists and is a directory
the file is copied into this directory using the basename from SRC_PATH</li>
</ul>

<p>
SRC_PATH specifies a directory
</p>
<ul class="org-ul">
<li>DEST_PATH does not exist
DEST_PATH is created as a directory and the contents of the source directory are copied into this directory</li>
<li>DEST_PATH exists and is a file
Error condition: cannot copy a directory to a file</li>
<li>DEST_PATH exists and is a directory
<ul class="org-ul">
<li>SRC_PATH does not end with /. (that is: slash followed by dot)
the source directory is copied into this directory</li>
<li>SRC_PATH does end with /. (that is: slash followed by dot)
the content of the source directory is copied into this directory</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgc27f979" class="outline-4">
<h4 id="orgc27f979"><span class="section-number-4">21.5.4</span> docker stats</h4>
<div class="outline-text-4" id="text-21-5-4">
<p>
Memory usage for all containers <code>docker stats -a</code> default just shows running containers
Show container names
</p>
<pre class="example">
docker stats --format "table {{.Name}}\t{{.Container}}\t{{.CPUPerc}}\t{{.MemPerc}}\t{{.MemUsage}}\t{{.PIDs}}"

;; # other column values
\t{{.NetIO}}\t{{.BlockIO}}
</pre>
</div>
</div>

<div id="outline-container-org89a397a" class="outline-4">
<h4 id="org89a397a"><span class="section-number-4">21.5.5</span> Save a running container to an image</h4>
<div class="outline-text-4" id="text-21-5-5">
<p>
First exit the container first
<code>docker commit -m "added node.js" -a "Author Name" 123456 my/ubuntu-nodejs</code>
</p>

<p>
Container id :: 123456. get this from <code>docker ps -a</code>
New image name :: my/ubuntu-nodejs
</p>
</div>
</div>

<div id="outline-container-orgdc85810" class="outline-4">
<h4 id="orgdc85810"><span class="section-number-4">21.5.6</span> Execute commands inside a running container</h4>
<div class="outline-text-4" id="text-21-5-6">
<p>
Login to container with bash open :: <code>docker exec -it containerName bash -I</code>
Long command (pure-pw only exists in container)
<code>docker exec -it containerName pure-pw useradd bob2 -f longpathto/passwd -m -u ftpuser -d /home/ftpusers/bob2</code>
Run multiple commands
<code>docker exec -it containerName bash -c 'cd /var/log; tar -cv ./file.log'</code>
</p>
</div>
</div>
</div>

<div id="outline-container-org8d358c8" class="outline-3">
<h3 id="org8d358c8"><span class="section-number-3">21.6</span> Network</h3>
<div class="outline-text-3" id="text-21-6">
<pre class="example">
;; # List networks
docker network ls

;; # Info about a network
docker network inspect the_network_id

;; # Remove networks
;; # returns error when last bridge is removed. It's normal
docker network rm $(docker network ls | grep "bridge" | awk '/ / { print $1 }')
</pre>

<p>
network has active end points. Find the Containers that has Name (mycontainer_name) and EndpointID
</p>
<pre class="example">
docker network inspect mynetwork_name

;; # you may need to stop and remove the container
docker rm -f mycontainer_name

;; # disconnect the container from a network
docker network disconnect -f mynetwork_name mycontainer_name

;; # run docker-compose down again
docker-compose down -v
</pre>
</div>
</div>

<div id="outline-container-orgc04c182" class="outline-3">
<h3 id="orgc04c182"><span class="section-number-3">21.7</span> My Network</h3>
<div class="outline-text-3" id="text-21-7">
<p>
Refer to <a href="#org747609d">CIDR Netmask</a> <a href="#org96918c4">network:port</a>
Personal dev projects use 172.20.x.0/24
Work dev projects use 172.19.x.0/24
</p>

<p>
Personal dev project port range up to 49151
</p>
<dl class="org-dl">
<dt>mysql</dt><dd>31000 to 31999</dd>
<dt>php  </dt><dd>32000 to 32999</dd>
</dl>

<p>
Personal dev project
</p>
<dl class="org-dl">
<dt>172.20.0.0/24</dt><dd>wordpress, port mysql:31000 php:32000</dd>
<dt>172.20.1.0/24</dt><dd>drupal 7,  port mysql:31001 php:32001</dd>
</dl>

<pre class="example">
networks:
  app_netsandbox:
    driver: bridge
    ipam:
      driver: default
      config:
      - subnet: 172.20.0.0/24
        gateway: 172.20.0.1
services:
  dbtest:
    networks:
      app_netsandbox:
        ipv4_address: 172.20.0.2
</pre>
</div>
</div>

<div id="outline-container-org7b9bbcf" class="outline-3">
<h3 id="org7b9bbcf"><span class="section-number-3">21.8</span> Volume</h3>
<div class="outline-text-3" id="text-21-8">
<pre class="example">
;; # List all volumes
docker volume ls

;; # Info about a volume
docker volume inspect the_vol_id

;; # Remove volumes
docker volume rm $(docker volume ls -qf dangling=true)
</pre>

<p>
On Windows, you may be forced to have named volume because file permissions cannot be set. In this case, you can access the named volume by starting another container.
Say yourContainerName has named volume pointed to /var/www/html
</p>
<pre class="example">
docker run -ti --volumes-from yourContainerName ubuntu
ll /var/www/html
</pre>
</div>
</div>

<div id="outline-container-org624bf73" class="outline-3">
<h3 id="org624bf73"><span class="section-number-3">21.9</span> Dockerfile</h3>
<div class="outline-text-3" id="text-21-9">
</div>
<div id="outline-container-org7dee04c" class="outline-4">
<h4 id="org7dee04c"><span class="section-number-4">21.9.1</span> CMD, RUN, ENTRYPOINT</h4>
<div class="outline-text-4" id="text-21-9-1">
<p>
There can only be one <code>CMD</code> in a Dockerfile or a chain of Dockerfiles included as in parent images.
If there're multiple, only the last one will run.
<code>CMD</code> is to provide defaults for a container that is already created from an image and running.
<code>RUN</code> runs a command and commits the result to an image at build time.
<code>CMD</code> doesn't execute anything at build time and it's not committed to the image.
<code>ENTRYPOINT</code> Docker's default entrypoint is <code>/bin/sh -c</code>. Actually every <code>RUN &lt;your command&gt;</code> is <code>/bin/sh -c &lt;your command&gt;</code>
Docker allows you to specify a different entrypoint for <code>docker run</code> e.g. <code>docker run -it ubuntu &lt;your command&gt;</code> is to run <code>/bin/sh -c &lt;your command&gt;</code> &lt;your command&gt; could be <code>bash</code>
<code>CMD</code> is just to provide paremeters to ENTRYPOINT when <code>docker run</code> is run. e.g. Ubuntu <code>CMD ["bash"]</code> then you can run <code>docker run -it ubuntu</code> to run <code>/bin/sh -c bash</code> directly
</p>

<p>
Example :: without ENTRYPOINT, this needs to run <code>docker run redisimg redis -H something -u toto get key</code>
With ENTRYPOINT, <code>ENTRYPOINT ["redis", "-H", "something", "-u", "toto"]</code>, only this needs to run
<code>docker run redisimg get key</code>
</p>

<p>
There're 3 forms of <code>CMD</code>
</p>
<pre class="example">
;; # exec form, json array
CMD ["executable", "param1", "param2"]

;; # as default parameters to ENTRYPOINT
CMD ["param1","param2"]

;; # shell form
CMD command param1 param2
</pre>

<p>
exec form doesn't have variable substitution
CMD ["echo", "$HOME"] won't output $HOME variable
</p>

<p>
Use shell form <code>CMD [ "sh", "-c", "echo $HOME" ]</code> or
<code>CMD echo $HOME</code> at default shell of the running container
</p>
</div>
</div>

<div id="outline-container-orgc174968" class="outline-4">
<h4 id="orgc174968"><span class="section-number-4">21.9.2</span> ADD vs COPY</h4>
<div class="outline-text-4" id="text-21-9-2">
<p>
COPY &lt;src&gt;&#x2026; &lt;dest&gt;
COPY ["&lt;src&gt;",&#x2026; "&lt;dest&gt;"] (this form is required for paths containing whitespace)
</p>

<p>
ADD and COPY are the same except 
</p>
<ul class="org-ul">
<li>ADD allows src to be an URL</li>
<li>If the src is an archive (tar) it will be unpacked</li>
</ul>

<p>
Always use COPY if it can do what you want
</p>
</div>
</div>

<div id="outline-container-orgcad304b" class="outline-4">
<h4 id="orgcad304b"><span class="section-number-4">21.9.3</span> Timezone <a id="orgbf1b0e0">docker:timezone</a></h4>
<div class="outline-text-4" id="text-21-9-3">
<pre class="example">
ENV TZ=America/Toronto
RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; echo $TZ &gt; /etc/timezone
</pre>
</div>
</div>

<div id="outline-container-org4af82e0" class="outline-4">
<h4 id="org4af82e0"><span class="section-number-4">21.9.4</span> ARG Debian (Jessie)</h4>
<div class="outline-text-4" id="text-21-9-4">
<p>
When building an image using Debian, a lot of these:
debconf: delaying package configuration, since apt-utils is not installed
</p>

<p>
<a id="org40fdaef">Dockerfile:ARG</a>
ARG :: defines a var that users can pass at build-time to the builder with the docker build command using the &#x2013;build-arg &lt;varname&gt;=&lt;value&gt; flag.
</p>

<p>
ARG acts like ENV but ENV always overrides ARG
</p>

<pre class="example">
FROM busybox
ARG user1
ARG buildno
</pre>

<p>
ARG defined before FROM is outside of build stage so it can't be used in any other instruction. Define ARG again after FROM
</p>
<pre class="example">
ARG VERSION=latest
FROM busybox:$VERSION
ARG VERSION
RUN echo $VERSION &gt; image_version
</pre>

<p>
In this case, a default value is defined
</p>
<pre class="example">
ARG DEBIAN_FRONTEND=noninteractive
RUN apt-get update &amp;&amp; apt-get install -y apt-utils
</pre>
</div>

<div id="outline-container-org108e1f8" class="outline-5">
<h5 id="org108e1f8"><span class="section-number-5">21.9.4.1</span> Predefined ARG variables</h5>
<div class="outline-text-5" id="text-21-9-4-1">
<p>
Docker has a set of predefined ARG variables without default values. Use it like without defining ARG in Dockerfile
</p>
<pre class="example">
docker build -t mycontainer . --build-arg &lt;varname&gt;=&lt;value&gt;
--build-arg HTTP_PROXY=http://user:pass@proxy.lon.example.com
</pre>

<p>
These predefined ARG variables are not saved in docker history so it's good to use them for passing sensitive info
HTTP_PROXY
http_proxy
HTTPS_PROXY
https_proxy
FTP_PROXY
ftp_proxy
NO_PROXY
no_proxy
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf224f22" class="outline-3">
<h3 id="orgf224f22"><span class="section-number-3">21.10</span> Docker Compose</h3>
<div class="outline-text-3" id="text-21-10">
<pre class="example">
docker-compose --version
docker-compose up -d

docker-compose up -d --force-recreate
# Force restart or recreate containers

docker-compose down -v
# remove containers and volumes

docker-compose down ---rmi local
# remove only images that don't have a custom tag set by the `image` field

docker-compose down --rmi all
# remove all images used by any service

docker-compose build
# build new image if there's any build directive

docker-compose up -d
# doesn't build image, it will use existing image

docker-compose up -d --build
# build new image and run

docker-compose ps
# shows containers info started by docker compose in current folder
</pre>
</div>

<div id="outline-container-org5e48c78" class="outline-4">
<h4 id="org5e48c78"><span class="section-number-4">21.10.1</span> Ubuntu 16.04 Installation</h4>
<div class="outline-text-4" id="text-21-10-1">
<p>
<a href="https://github.com/docker/compose/releases">Grab latest docker-compose version</a> say it's 1.16.1
</p>

<pre class="example">
sudo curl -o /usr/local/bin/docker-compose -L "https://github.com/docker/compose/releases/download/1.16.1/docker-compose-$(uname -s)-$(uname -m)"
;; # add execute permission
sudo chmod +x /usr/local/bin/docker-compose
docker-compose -v

;; # Test
nano docker-compose.yml
my-test:
  image: hello-world

;; # run
docker-compose up
docker rm &lt;container-id&gt;
docker rmi hello-world
</pre>
</div>
</div>

<div id="outline-container-orga3da460" class="outline-4">
<h4 id="orga3da460"><span class="section-number-4">21.10.2</span> YML</h4>
<div class="outline-text-4" id="text-21-10-2">
<p>
It has to be this name <code>docker-compose.yml</code> and don't include this file in sub directories.
</p>

<p>
Docker Engine version (docker version) 
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">Compose file format</td>
<td class="org-right">Docker Engine release</td>
</tr>

<tr>
<td class="org-right">3.0;3.1</td>
<td class="org-right">1.13.0+</td>
</tr>

<tr>
<td class="org-right">2.1</td>
<td class="org-right">1.12.0+</td>
</tr>

<tr>
<td class="org-right">2.0</td>
<td class="org-right">1.10.0+</td>
</tr>

<tr>
<td class="org-right">1.0</td>
<td class="org-right">1.9.1+</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-org1aab85e" class="outline-5">
<h5 id="org1aab85e"><span class="section-number-5">21.10.2.1</span> version (top level)</h5>
<div class="outline-text-5" id="text-21-10-2-1">
<pre class="example">
version: '2'
</pre>
</div>
</div>

<div id="outline-container-org1e6a237" class="outline-5">
<h5 id="org1e6a237"><span class="section-number-5">21.10.2.2</span> volumes (top level)</h5>
<div class="outline-text-5" id="text-21-10-2-2">
<p>
Check volumes created by Docker <code>docker volume ls</code>
Create a volume <code>docker volume create --name dbdata</code>
Remove a volume <code>docker volume rm dbdatavolume</code>
</p>

<pre class="example">
volumes:
# Named volume which can be used in all services
# this volume isn't mapped to anything in docker host!
# top-level volumes can't specify path to named volume.. You have to install other Docker plugin
  dbdata:
</pre>
</div>
</div>

<div id="outline-container-orgd9b07e9" class="outline-5">
<h5 id="orgd9b07e9"><span class="section-number-5">21.10.2.3</span> networks (top level) links (deprecated)</h5>
<div class="outline-text-5" id="text-21-10-2-3">
<p>
Every time <code>docker-compose up</code> creates a single network (per app) which all services in the app are on.
Let's say yml file is a folder called foldername
This avoids the need to use links
</p>
<pre class="example">
networks:
;; # network name is foldername_app_net
  app_net:
;; # bridge on a single host (default) and overlay on a Swarm
    driver: bridge
    ipam:
      driver: default
      config:
      - subnet: 172.18.0.0/16
        gateway: 172.18.0.1
</pre>

<p>
Then in a service, specify the ip
</p>
<pre class="example">
services:
 db:
   image: mysql:5.7.9
   container_name: db
   hostname: db
;; # links is deprecated. 
;; # links:
;; #   - thisserviceorotherservicename:mysql
;; # Use networks:aliases below for thisservice
   networks:
     app_net:
       ipv4_address: 172.18.0.2
       aliases:
         - mysql
   restart: always
</pre>
</div>

<ol class="org-ol">
<li><a id="org6bc15d6"></a>Use network defined in another docker-compose<br />
<div class="outline-text-6" id="text-21-10-2-3-1">
<pre class="example">
;; # ./app1/docker-compose.yml
networks:
  app_net:
    driver: bridge
    ipam:
      driver: default
      config:
      - subnet: 172.16.2.0/24
        gateway: 172.16.2.1
services:
  lucee:
    ...
    networks:
      app_net:
        ipv4_address: 172.16.2.3

;; # ./app2/docker-compose.yml
networks:
  app1_app_net:
    external: true
services:
  nodejs:
    ...
    networks:
      app1_app_net:
        ipv4_address: 172.16.2.4
</pre>
</div>
</li>
</ol>
</div>

<div id="outline-container-org24da7be" class="outline-5">
<h5 id="org24da7be"><span class="section-number-5">21.10.2.4</span> services</h5>
<div class="outline-text-5" id="text-21-10-2-4">
<pre class="example">
services:
  lucee:
    build: .
    # use Dockerfile to build an image
    image: cflucee:latest
    # specify image name which can be later used in other service
    # When there's build in yml, you need to add --build
    # docker-compose up -d --build
    container_name: lucee
    ports:
      - "80:80"
      - "8888:8888"
    volumes:
      - /host/path/to/folder1:/root/db/
      - /host/path/to/folder2:/var/log/nginx
    # equivalent to -t in docker run
    tty: true
    networks:
      app_net:
        ipv4_address: 172.18.0.3
</pre>

<p>
<code>EXPOSE</code> in Dockerfile and <code>-p</code> in <code>docker run -p 8080</code>
</p>
<ul class="org-ul">
<li>Neither specify EXPOSE nor -p
<ul class="org-ul">
<li>service in container will not be accessible from anywhere except from the container itself</li>
</ul></li>
<li>Only specify EXPOSE
<ul class="org-ul">
<li>The service in the container is not accessible from outside Docker, but from inside other Docker containers.</li>
<li>Good for inter-container communication</li>
</ul></li>
<li>Specify EXPOSE and -p
<ul class="org-ul">
<li>The service in the container is accessible from anywhere, even outside Docker</li>
</ul></li>
<li>Specify -p but not EXPOSE
<ul class="org-ul">
<li>It's like only specify EXPOSE</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org79b7cf7" class="outline-5">
<h5 id="org79b7cf7"><span class="section-number-5">21.10.2.5</span> Resources</h5>
<div class="outline-text-5" id="text-21-10-2-5">
<p>
<a href="https://docs.docker.com/compose/compose-file/compose-file-v2/#cpu-and-other-resources">compose file v2</a>
</p>
<pre class="example">
cpu_count: 2
cpu_percent: 50
cpus: 0.5
cpu_shares: 73
cpu_quota: 50000
cpuset: 0,1

user: postgresql
working_dir: /code

domainname: foo.com
hostname: foo
ipc: host
mac_address: 02:42:ac:11:65:43

mem_limit: 536870912 #512 MB 512*1024*1024, 128MB 134217728
memswap_limit: 2000000000
mem_reservation: 512m
privileged: true

oom_score_adj: 500
oom_kill_disable: true

read_only: true
shm_size: 64M
stdin_open: true
tty: true
</pre>

<p>
compose file v3
</p>
<pre class="example">
version: '3'
services:
  redis:
    image: redis:alpine
    deploy:
      resources:
        limits:
          cpus: '0.50'
          memory: 50M
        reservations:
          cpus: '0.25'
          memory: 20M
</pre>
</div>
</div>

<div id="outline-container-orgd533dba" class="outline-5">
<h5 id="orgd533dba"><span class="section-number-5">21.10.2.6</span> Pass arguments from Compose to Dockerfile</h5>
<div class="outline-text-5" id="text-21-10-2-6">
<p>
docker-compose.yml
</p>
<pre class="example">
version: '2'
services:
  web:
    build:
      context: ./web
      args:
        REQUIREMENTS: "envs/dev.env"
</pre>

<p>
Dockerfile
</p>
<pre class="example">
FROM python:3.5
ENV PYTHONUNBUFFERED 1
ENV APP_ROOT /usr/src/app
ARG REQUIREMENTS
...
COPY $REQUIREMENTS $APP_ROOT/
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orga62fa59" class="outline-3">
<h3 id="orga62fa59"><span class="section-number-3">21.11</span> Docker for Windows</h3>
<div class="outline-text-3" id="text-21-11">
<p>
Settings &gt; General &gt; Expose daemon on tcp://localhost:2375 without TLS.
This is to allow legacy clients/applications such as phpStorm to connect to the daemon.
</p>
</div>

<div id="outline-container-orga753387" class="outline-4">
<h4 id="orga753387"><span class="section-number-4">21.11.1</span> PowerShell Auto Complete</h4>
<div class="outline-text-4" id="text-21-11-1">
<p>
Win + x &gt; PowerShell (Admin)
Run these
</p>
<pre class="example">
;; # To allow downloaded scripts signed by trusted publishers to run on this computer
Set-ExecutionPolicy RemoteSigned

;; # Type y, check if this return RemoteSigned
get-executionpolicy

;; # Install PowerShell module posh-docker, it may also install NuGet package manager
Install-Module posh-docker

;; # Enable autocompletion for the current PowerShell only
Import-Module post-docker

;; # To make it persistent across all PowerShell sessions, we need to import the module to ~$PROFILE~
;; # Run this directly on PowerShell to create a profile if not exists and add the line
if (-Not (Test-Path $PROFILE)) {
    New-Item $PROFILE –Type File –Force
}

Add-Content $PROFILE "`nImport-Module posh-docker"

;; # check
cat $PROFILE
</pre>
</div>
</div>
</div>

<div id="outline-container-orge777b25" class="outline-3">
<h3 id="orge777b25"><span class="section-number-3">21.12</span> Docker Cloud</h3>
<div class="outline-text-3" id="text-21-12">
<p>
Docker Cloud uses Docker Hub as native registry.
</p>

<p>
Use Docker Hub credentials to <code>docker login</code>
</p>

<p>
Assume your Docker Hub username is abc, give a tag for your image
<code>docker tag myimage:mytag abc/myimage:mytag</code>
</p>

<p>
<code>docker push abc/myimage:mytag</code>
</p>

<p>
<code>docker logout</code>
</p>
</div>
</div>

<div id="outline-container-org3f81fd7" class="outline-3">
<h3 id="org3f81fd7"><span class="section-number-3">21.13</span> Common DevOps</h3>
<div class="outline-text-3" id="text-21-13">
</div>
<div id="outline-container-org8f30d1a" class="outline-4">
<h4 id="org8f30d1a"><span class="section-number-4">21.13.1</span> Files are in container</h4>
<div class="outline-text-4" id="text-21-13-1">
<p>
container path to code and files dcontainerpath :: /var/www/html
store code and files to this folder :: html
</p>
</div>

<div id="outline-container-orgd7c72a6" class="outline-5">
<h5 id="orgd7c72a6"><span class="section-number-5">21.13.1.1</span> Makefile at remote Prod/Live host /root/Makefile</h5>
<div class="outline-text-5" id="text-21-13-1-1">
<p>
Prepare in container a script to dump db :: /root/dump.sh
</p>
<pre class="example">
#!/bin/bash
mysqldump -u root --password='$mypass$' livedbname &gt; /root/myproject.sql
</pre>

<pre class="example">
.PHONY: info rmbkfolder bkfolder bkdb bkdbsamename tarall tarallexcludesamename drytarallexcludesamename tarcode taruploads taruploadsexclude

filename := $(shell date +%F)
# WordPress runs in container
dcontainer = mycontainername

# website root folder
dcontainerpath = /var/www/html

# container db dump script
dconainterdbdump = /root/dump.sh

# db dump location in container
dcontainerdbdumppath = /root

# host backup folder /root/html
bkpath = html

tarexclude = --exclude='wp-content/uploads' --exclude='sql-admin'
taruploadsexclude = --exclude='backupbuddy_backups'
tarallexclude = --exclude='wp-content/uploads/backupbuddy_bakcups' --exclude='sql-admin'

# myproject.sql
projectname = myproject

# prepare files to push to Live environment
transferpath = /web-root/transfer-files/dev-to-prod/source/

info:
        @echo first run bkfolder
        @echo then run make tarcode and make taruploads
        @echo run make tarall
        @echo run make taruploadsexclude if some directories need to be excluded
        @echo Finally, run rmbkfolder to release space

bkfolder: rmbkfolder
        @echo should use docker cp -a if it is supported
        docker cp -L $(dcontainer):$(dcontainerpath) $(bkpath)

rmbkfolder:
        rm -rf $(bkpath)

bkdb:
        docker exec $(dcontainer) $dcontainerdbdump
        docker cp $(dcontainer):$(dcontainerdbdumppath)/$(projectname).sql $(projectname)-$(filename).sql

bkdbsamename:
        docker exec $(dcontainer) $dcontainerdbdump
        docker cp $(dcontainer):$(dcontainerdbdumppath)/$(projectname).sql $(projectname).sql

tarall:
        tar -czpf all-$(filename).tar.gz -C $(bkpath) .

tarallexcludesamename:
        tar -czpf all.tar.gz -C $(bkpath) . $(tarallexclude))

drytarallexcludesamename:
        tar -cvzpf - -C $(bkpath) . $(tarallexclude)

tarcode:
        tar -czpf code-$(filename).tar.gz -C $(bkpath) . $(tarexclude)

taruploads:
        tar -czpf uploads-$(filename).tar.gz -C $(bkpath)/wp-content/uploads .

taruploadsexclude:
        tar -czpf uploads-exclude-$(filename).tar.gz -C $(bkpath)/wp-content/uploads . $(taruploadsexclude)

# copy code.tar.gz to /myproject/code.tar.gz
# cd /myproject &amp;&amp; tar -xvzf code.tar.gz
# make wp-content/uploads directory
# mkdir wp-content/uploads &amp;&amp; tar -xvzf uploads.tar.gz -C wp-content/uploads

cleantars:
        rm -rf all.tar.gz

# copy dev code to a transfer folder, remove wp-config.php and .htaccess

pushcodetolive:
        rsync -av ./$(bkpath)/ $(transferpath)
        rm $(transferpath)wp-config.php
        rm $(transferpath).htaccess
</pre>

<p>
Also prepare on Live host /root/devops-db.sh
</p>
<pre class="example">
#!/bin/bash
cd /root &amp;&amp; make bkdbsamename
</pre>

<p>
And /root/devops-files.sh
</p>
<pre class="example">
#!/bin/bash
cd /root &amp;&amp; make bkfolder &amp;&amp; make tarallexcludesamename
</pre>
</div>
</div>

<div id="outline-container-org7b73fa9" class="outline-5">
<h5 id="org7b73fa9"><span class="section-number-5">21.13.1.2</span> Sql dump inside container</h5>
<div class="outline-text-5" id="text-21-13-1-2">
<p>
Inside container /var/transfer/bash/dbdump.sh
</p>

<pre class="example">
;; #!/bin/bash

;; # Move to MySQL Dump Folder :
cd /var/transfer/sql-dump/

;; # Remove dump folder (if Exists):
rm -rf dev-to-prod

;; # Create and Enter Dump Folder :
mkdir dev-to-prod
cd dev-to-prod

;; # MySQL Dump A Copy of the Database to the server :
mysqldump -u root --password='dbpassword' dbname &gt; containername.sql

;; # Find &amp;&amp; Replace Dev URL with Prod URL :
sed 's|http://www\.dev.mywebsite.com\.com|http://www\.mywebsite\.com|g' containername.sql
</pre>
</div>
</div>

<div id="outline-container-org59519d4" class="outline-5">
<h5 id="org59519d4"><span class="section-number-5">21.13.1.3</span> local dev /root/Makefile</h5>
<div class="outline-text-5" id="text-21-13-1-3">
<p>
Create /root/myfile to store ssh plain password
</p>
<pre class="example">
echo '$mysshpass$' &gt; myfile
</pre>

<p>
Live environment has IP 1.2.3.4
Dev uses container devcontainer and database name is devdb
Dev container map files to dev host at /myproject/html
</p>

<p>
make importlivedb
</p>

<p>
/root/Makefile
</p>
<div class="org-src-container">
<pre class="src src-makefile"><span style="color: #00ede1; font-weight: bold;">.PHONY</span>: importlivedb importlivefiles

<span style="color: #dbdb95;">liveip</span>=1.2.3.4
<span style="color: #dbdb95;">liveuser</span>=root
<span style="color: #dbdb95;">livescriptdb</span>=/root/devops-db.sh
<span style="color: #dbdb95;">livescriptfiles</span>=/root/devops-files.sh
<span style="color: #dbdb95;">livedbfile</span>=/root/myproject.sql
<span style="color: #dbdb95;">livedbfilename</span>=myproject.sql

<span style="color: #dbdb95;">livetarfile</span>=/root/all.tar.gz

<span style="color: #dbdb95;">containername</span>=devcontainer

<span style="color: #dbdb95;">password</span>=$$mydevdbpassEscapeDollarSigns$$
<span style="color: #dbdb95;">dbname</span>=devdb
<span style="color: #dbdb95;">htmlpath</span>=/myproject/html
<span style="color: #dbdb95;">htmlparent</span>=/myproject

<span style="color: #dbdb95;">apacheuserandgroup</span>=www-data:www-data

<span style="color: #00ede1; font-weight: bold;">importlivedb</span>:
        <span style="color: #34cae2;">@</span>echo generate sql dump on Live
        sshpass -f myfile ssh -o StrictHostKeyChecking=no $(<span style="color: #dbdb95;">liveuser</span>)@$(<span style="color: #dbdb95;">liveip</span>) <span style="color: #e67128;">'$(</span><span style="color: #dbdb95;">livescriptdb</span><span style="color: #e67128;">)'</span>
        <span style="color: #34cae2;">@</span>echo download dump to here
        sshpass -f myfile scp -o StrictHostKeyChecking=no $(<span style="color: #dbdb95;">liveuser</span>)@$(<span style="color: #dbdb95;">liveip</span>):$(<span style="color: #dbdb95;">livedbfile</span>) .
<span style="color: #74af68;">#       </span><span style="color: #74af68;">ssh host1 'mysqldump -u user --password='"'"'$(</span><span style="color: #dbdb95;">dbpw</span><span style="color: #74af68;">)'"'"' dbname &gt; ~/cs-devops/db.sql'</span>
<span style="color: #74af68;">#       </span><span style="color: #74af68;">scp host1:~/cs-devops/db.sql db/</span>
        <span style="color: #34cae2;">@</span>echo change url in db file before import
        sed -i <span style="color: #e67128;">'s|http://www\.myweb\.com|http://dev\.myweb\.com|g'</span> $(<span style="color: #dbdb95;">livedbfilename</span>)
        sed -i <span style="color: #e67128;">'s|http://myweb\.com|http://dev\.myweb\.com|g'</span> $(<span style="color: #dbdb95;">livedbfilename</span>)
        cat $(<span style="color: #dbdb95;">livedbfilename</span>) | docker exec -i $(<span style="color: #dbdb95;">containername</span>) /usr/bin/mysql -u root --password=<span style="color: #e67128;">'$(</span><span style="color: #dbdb95;">password</span><span style="color: #e67128;">)'</span> $(<span style="color: #dbdb95;">dbname</span>)

<span style="color: #00ede1; font-weight: bold;">importlivefiles</span>:
        sshpass -f myfile ssh -o StrictHostKeyChecking=no $(<span style="color: #dbdb95;">liveuser</span>)@$(<span style="color: #dbdb95;">liveip</span>) <span style="color: #e67128;">'$(</span><span style="color: #dbdb95;">livescriptfiles</span><span style="color: #e67128;">)'</span>
        sshpass -f myfile scp -o StrictHostKeyChecking=no $(<span style="color: #dbdb95;">liveuser</span>)@$(<span style="color: #dbdb95;">liveip</span>):$(<span style="color: #dbdb95;">livetarfile</span>) ./all.tar.gz
        rm -rf html
        mkdir html
        tar -xzf all.tar.gz -C ./html
        cp -a $(<span style="color: #dbdb95;">htmlpath</span>)/wp-config.php .
        cp -a $(<span style="color: #dbdb95;">htmlpath</span>)/.htaccess .
        rm -rf $(<span style="color: #dbdb95;">htmlpath</span>)
        cp -a html $(<span style="color: #dbdb95;">htmlparent</span>)/
        cp -a wp-config.php $(<span style="color: #dbdb95;">htmlpath</span>)/
        cp -a .htaccess $(<span style="color: #dbdb95;">htmlpath</span>)/
        chown -R $(<span style="color: #dbdb95;">apacheuserandgroup</span>) $(<span style="color: #dbdb95;">htmlpath</span>)

<span style="color: #00ede1; font-weight: bold;">cleanupimport</span>:
        rm -rf all.tar.gz html $(<span style="color: #dbdb95;">livedbfilename</span>)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org62d23a1" class="outline-4">
<h4 id="org62d23a1"><span class="section-number-4">21.13.2</span> Check container status and restart services</h4>
<div class="outline-text-4" id="text-21-13-2">
<pre class="example">
#!/bin/bash
container=mycontainer
containerstatus=$(docker inspect -f {{.State.Running}} $container)

if [ "$containerstatus" != "true" ]; then
  echo "$container container is not started. Restarting.."
  docker restart $container
fi

containerstatus=$(docker inspect -f {{.State.Running}} $container)

if [ "$containerstatus" != "true" ]; then
  echo "By now container should be started but it is not.. Abort restarting mysql and apache in container"
else
  echo "Check mysql status in container"
  docker exec $container service mysql status
  if [ $? = "0" ]; then
    echo "mysql is running"
  else
    echo "Restarting mysql in container.."
    docker exec $container service mysql restart
    docker exec $container service mysql status
    if [ $? = "0" ]; then
      echo "mysql is restarted"
    else
      echo "mysql could not be restarted."
    fi
  fi

  echo "Check apache in container"
  docker exec $container service apache2 status
  if [ $? = "0" ]; then
     echo "apache is running"
  else
   echo "Restarting apache in container.."
   docker exec $container service apache2 restart
   docker exec $container service apache2 status
   if [ $? = "0" ]; then
     echo "apache is restarted"
   else
     echo "apache could not be restarted."
   fi
  fi

fi
</pre>
</div>
</div>

<div id="outline-container-org2cf9139" class="outline-4">
<h4 id="org2cf9139"><span class="section-number-4">21.13.3</span> Replace string in .sql</h4>
<div class="outline-text-4" id="text-21-13-3">
<p>
<a href="https://github.com/tazotodua/useful-php-scripts/blob/master/database-modifier-when-migrating-wordpress">https://github.com/tazotodua/useful-php-scripts/blob/master/database-modifier-when-migrating-wordpress</a>
<a href="https://interconnectit.com/products/search-and-replace-for-wordpress-databases/">https://interconnectit.com/products/search-and-replace-for-wordpress-databases/</a>
<a href="https://en-ca.wordpress.org/plugins/wp-migrate-db/">https://en-ca.wordpress.org/plugins/wp-migrate-db/</a>
<a href="https://wordpress.org/plugins/better-search-replace/">https://wordpress.org/plugins/better-search-replace/</a>
</p>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #ffad29; font-weight: bold;">UPDATE</span> wp_options <span style="color: #ffad29; font-weight: bold;">SET</span> option_value = replace(option_value, <span style="color: #e67128;">'http://olddomain.com'</span>, <span style="color: #e67128;">'http://newdomain.com'</span>) <span style="color: #ffad29; font-weight: bold;">WHERE</span> option_name = <span style="color: #e67128;">'home'</span> <span style="color: #ffad29; font-weight: bold;">OR</span> option_name = <span style="color: #e67128;">'siteurl'</span>;

<span style="color: #ffad29; font-weight: bold;">UPDATE</span> wp_posts <span style="color: #ffad29; font-weight: bold;">SET</span> guid = replace(guid, <span style="color: #e67128;">'http://olddomain.com'</span>,<span style="color: #e67128;">'http://newdomain.com'</span>);

<span style="color: #ffad29; font-weight: bold;">UPDATE</span> wp_posts <span style="color: #ffad29; font-weight: bold;">SET</span> post_content = replace(post_content, <span style="color: #e67128;">'http://olddomain.com'</span>, <span style="color: #e67128;">'http://newdomain.com'</span>);

<span style="color: #ffad29; font-weight: bold;">UPDATE</span> wp_postmeta <span style="color: #ffad29; font-weight: bold;">SET</span> meta_value = replace(meta_value, <span style="color: #e67128;">'http://olddomain.com'</span>, <span style="color: #e67128;">'http://newdomain.com'</span>);
</pre>
</div>

<p>
<a href="#org47dc20d">image:tatemz/wp-cli</a>
</p>
</div>
</div>

<div id="outline-container-org07bb747" class="outline-4">
<h4 id="org07bb747"><span class="section-number-4">21.13.4</span> Download files</h4>
<div class="outline-text-4" id="text-21-13-4">
<pre class="example">
csftp=ftp://example.com/var/www/html/
csftpuser=a
csftpp=b

dfolder1:
        wget --user=$(csftpuser) --password='$(csftpp)' -cr -l inf -nH --cut-dirs=3 -P bk/page/ $(csftp)folder1

dfolder2:
        wget --user=$(csftpuser) --password='$(csftpp)' -cr -l inf -nH --cut-dirs=3 -P bk/page/ $(csftp)folder2

dall: dfolder1 dfolder2
</pre>
</div>
</div>
</div>

<div id="outline-container-org45a4c88" class="outline-3">
<h3 id="org45a4c88"><span class="section-number-3">21.14</span> <a href="#org853ab24">image:debian:jessie</a> - Debian 8 <a id="org853ab24">image:debian:jessie</a></h3>
<div class="outline-text-3" id="text-21-14">
<p>
Parent: scratch (perfect for building base images such as debian and busybox
</p>
</div>
</div>

<div id="outline-container-orgb7a3e4a" class="outline-3">
<h3 id="orgb7a3e4a"><span class="section-number-3">21.15</span> <a href="#org98333c5">image:debian:stretch</a> - Debian 9 <a id="org98333c5">image:debian:stretch</a></h3>
</div>
<div id="outline-container-orgdd1e25c" class="outline-3">
<h3 id="orgdd1e25c"><span class="section-number-3">21.16</span> image:buildpack-deps:jessie-scm</h3>
<div class="outline-text-3" id="text-21-16">
<p>
Parent: buildpack-deps:jessie-curl
Available: git, curl, wget, openssh-client
</p>
</div>
</div>

<div id="outline-container-orgaf2bef2" class="outline-3">
<h3 id="orgaf2bef2"><span class="section-number-3">21.17</span> image:buildpack-deps:stretch-curl</h3>
<div class="outline-text-3" id="text-21-17">
<p>
Parent: <a href="#org98333c5">image:debian:stretch</a>
</p>
</div>
</div>

<div id="outline-container-orgc40703c" class="outline-3">
<h3 id="orgc40703c"><span class="section-number-3">21.18</span> image:php:5.6.31-apache-jessie <a id="orgeebe557">image:php:apache</a></h3>
<div class="outline-text-3" id="text-21-18">
<p>
Short name: php:5.6.31-apache
Parent: debian:jessie
<a href="https://github.com/docker-library/php/blob/0bb4068bd639ba98631bc2999e0d20cae583ec00/5.6/jessie/apache/Dockerfile">Dockerfile</a>
</p>

<p>
Refer to <a href="#org04efc39">apache:config</a>
</p>

<p>
PHP_INI_DIR :: /usr/local/etc/php (/conf.d)
</p>

<p>
APACHE_CONFDIR :: /etc/apache2
APACHE_ENVVAR ::  /etc/apache2/envvars
APACHE_RUN_USER :: www-data
APACHE_DOCUMENT_ROOT, WORKDIR :: <i>var/www/html
APACHE_LOG_DIR :: /var/log/apache2</i>
</p>

<p>
EXPOSE 80
CMD ["apache2-foreground"]
/usr/local/bin/apache2-foreground
</p>

<p>
/var/log/apache2/error.log =&gt; /dev/stderr
/var/log/apache2/access.log =&gt; /dev/stdout
/var/log/apache2/other_vhosts_access.log =&gt; /dev/stdout
</p>

<p>
copy host config/php.ini to <i>usr/local/etc/php/php.ini (name has to be exact) or copy php-prod.ini to /usr/local/etc/php/conf.d</i>
</p>

<p>
docker-php-ext-install uses docker-php-ext-enable which adds docker-php-ext-{ext-name}.ini to <i>usr/local/etc/php/conf.d</i>
</p>

<p>
If you want to get some from PHP's source, you can extract, use and delete it.
</p>
<pre class="example">
FROM php:7.0-apache
RUN docker-php-source extract \
    # do important things \
    &amp;&amp; docker-php-source delete
</pre>

<p>
Install PHP Core Extensions
</p>
<pre class="example">
FROM php:7.0-fpm
RUN apt-get update &amp;&amp; apt-get install -y \
        libfreetype6-dev \
        libjpeg62-turbo-dev \
        libmcrypt-dev \
        libpng-dev \
    &amp;&amp; docker-php-ext-install -j$(nproc) iconv mcrypt \
    &amp;&amp; docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \
    &amp;&amp; docker-php-ext-install -j$(nproc) gd
</pre>

<p>
Install PECL Extensions use docker-php-ext-enable
</p>
<pre class="example">
FROM php:7.1-fpm
RUN pecl install redis-3.1.0 \
    &amp;&amp; pecl install xdebug-2.5.0 \
    &amp;&amp; docker-php-ext-enable redis xdebug
FROM php:5.6-fpm
RUN apt-get update &amp;&amp; apt-get install -y libmemcached-dev zlib1g-dev \
    &amp;&amp; pecl install memcached-2.2.0 \
    &amp;&amp; docker-php-ext-enable memcached
</pre>

<p>
Install other extensions
</p>
<pre class="example">
FROM php:5.6-apache
RUN curl -fsSL 'https://xcache.lighttpd.net/pub/Releases/3.2.0/xcache-3.2.0.tar.gz' -o xcache.tar.gz \
    &amp;&amp; mkdir -p xcache \
    &amp;&amp; tar -xf xcache.tar.gz -C xcache --strip-components=1 \
    &amp;&amp; rm xcache.tar.gz \
    &amp;&amp; ( \
        cd xcache \
        &amp;&amp; phpize \
        &amp;&amp; ./configure --enable-xcache \
        &amp;&amp; make -j$(nproc) \
        &amp;&amp; make install \
    ) \
    &amp;&amp; rm -r xcache \
    &amp;&amp; docker-php-ext-enable xcache
</pre>

<p>
The docker-php-ext-* scripts can accept an arbitrary path, but it must be absolute (to disambiguate from built-in extension names), so the above example could also be written as the following:
</p>

<pre class="example">
FROM php:5.6-apache
RUN curl -fsSL 'https://xcache.lighttpd.net/pub/Releases/3.2.0/xcache-3.2.0.tar.gz' -o xcache.tar.gz \
    &amp;&amp; mkdir -p /tmp/xcache \
    &amp;&amp; tar -xf xcache.tar.gz -C /tmp/xcache --strip-Components=1 \
    &amp;&amp; rm xcache.tar.gz \
    &amp;&amp; docker-php-ext-configure /tmp/xcache --enable-xcache \
    &amp;&amp; docker-php-ext-install /tmp/xcache \
    &amp;&amp; rm -r /tmp/xcache
</pre>

<p>
copy host config/php.ini to <i>usr/local/etc/php/php.ini (name has to be exact) or copy php-prod.ini to /usr/local/etc/php/conf.d</i>
</p>
</div>

<div id="outline-container-org1aaf5f7" class="outline-4">
<h4 id="org1aaf5f7"><span class="section-number-4">21.18.1</span> Sample</h4>
<div class="outline-text-4" id="text-21-18-1">
<pre class="example">
FROM php:5.6.31-apache-jessie

# apt-utils has to be installed to avoid throwing errors during installation on Debian
RUN set -ex; \
    \
    apt-get update &amp;&amp; apt-get install -y \
            apt-utils \
            nano \
            libfreetype6-dev \
            libmcrypt-dev \
            libjpeg62-turbo-dev \
            libpng-dev \
    &amp;&amp; \
    apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/* &amp;&amp; \
    \
    docker-php-ext-install -j$(nproc) iconv mcrypt &amp;&amp; \
    docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ &amp;&amp; \
    docker-php-ext-install -j$(nproc) gd mysqli mysql pdo pdo_mysql pcntl zip opcache

COPY config/php-prod.ini /usr/local/etc/php/conf.d/

RUN { \
                echo 'opcache.memory_consumption=128'; \
                echo 'opcache.interned_strings_buffer=8'; \
                echo 'opcache.max_accelerated_files=4000'; \
                echo 'opcache.revalidate_freq=2'; \
                echo 'opcache.fast_shutdown=1'; \
                echo 'opcache.enable_cli=1'; \
        } &gt; /usr/local/etc/php/conf.d/opcache-recommended.ini

# enable apache modules
RUN a2enmod rewrite expires

VOLUME /var/www/html

# TODO chown -R www-data:www-data /var/www/html

CMD ["apache2-foreground"]
</pre>
</div>
</div>
</div>

<div id="outline-container-org050e1e0" class="outline-3">
<h3 id="org050e1e0"><span class="section-number-3">21.19</span> image:php53</h3>
<div class="outline-text-3" id="text-21-19">
</div>
<div id="outline-container-org2f512c9" class="outline-4">
<h4 id="org2f512c9"><span class="section-number-4">21.19.1</span> image:bylexus:apache-php53</h4>
<div class="outline-text-4" id="text-21-19-1">
<p>
Ubuntu 12.04 (LTS), Apache 2.2, PHP 5.3.10
Ubuntu Server 12.04, based on ubuntu docker image
apache2
php5
php5-cli
libapache2-mod-php5
php5-gd
php5-ldap
php5-mysql
php5-pgsql
</p>

<p>
docker pull bylexus/apache-php53
<a href="https://hub.docker.com/r/bylexus/apache-php53/">https://hub.docker.com/r/bylexus/apache-php53/</a>
</p>

<p>
document root /var/www
</p>

<p>
docker run -d -p 8080:80 \
    -v /home/user/webroot:/var/www \
    -e PHP_ERROR_REPORTING='E_ALL &amp; ~E_STRICT' \
    bylexus/apache-php53
-v [local path]:/var/www maps the container's webroot to a local path
-p [local port]:80 maps a local port to the container's HTTP port 80
-e PHP_ERROR_REPORTING=[php error_reporting settings] sets the value of error_reporting in the php.ini files.
</p>

<p>
Apache Logs
docker logs -f container-id
</p>
<ul class="org-ul">
<li>ErrorLog /dev/stdout</li>
<li>CustomLog /dev/stdout combined</li>
</ul>

<p>
/etc/php5/apache2/php.ini
/etc/php5/cli/php.ini
</p>

<p>
Default:
</p>
<ul class="org-ul">
<li>display_errors=ON</li>
<li>error_reporting=E_ALL &amp; ~E_DEPRECATED &amp; ~E_NOTICE
<ul class="org-ul">
<li>change it via -e PHP_ERROR_REPORTING=&#x2026;</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org9c0511e" class="outline-4">
<h4 id="org9c0511e"><span class="section-number-4">21.19.2</span> image:orsolin/php:5.3-apache</h4>
<div class="outline-text-4" id="text-21-19-2">
<p>
<a href="https://github.com/cristianorsolin/docker-php-5.3-apache">https://github.com/cristianorsolin/docker-php-5.3-apache</a>
</p>

<p>
This one is Debian and has curl
</p>
<pre class="example">
phphoht:
    image: orsolin/docker-php-5.3-apache
    container_name: phphoht
    volumes:
      - "./:/var/www/html"
    networks:
      app_nethoht:
        ipv4_address: 172.19.2.3
    ports:
       - "32003:80"
    depends_on:
      - dbhoht
    links:
      - dbhoht
</pre>
</div>
</div>
</div>

<div id="outline-container-org704d292" class="outline-3">
<h3 id="org704d292"><span class="section-number-3">21.20</span> <a href="#orga9f3df5">image:php:7</a> <a id="orga9f3df5">image:php:7</a></h3>
<div class="outline-text-3" id="text-21-20">
<p>
Tag latest is 7.2.3-cli-stretch
php:7.2.3-apache <a id="org8f67d0d">image:php:7:apache</a>
</p>

<p>
Installed PHP extensions
ftp mysqlnd mbstring ftp password-argon2 sodium curl libedit openssl zlib
</p>
</div>
</div>

<div id="outline-container-orga922bd3" class="outline-3">
<h3 id="orga922bd3"><span class="section-number-3">21.21</span> <a href="#org93d333e">image:mysql</a>:5.7.9 <a id="org93d333e">image:mysql</a></h3>
<div class="outline-text-3" id="text-21-21">
<p>
Parent :: <a href="#org853ab24">image:debian:jessie</a>
user:group :: mysql:mysql
Executable :: mysqld
</p>

<p>
EXPOSE 3306
</p>

<p>
mysql-data:/var/lib/mysql
mysql-log:/var/log/mysql
mysql-conf:/etc/mysql/conf.d
</p>
</div>

<div id="outline-container-org15f1828" class="outline-4">
<h4 id="org15f1828"><span class="section-number-4">21.21.1</span> Load configs</h4>
<div class="outline-text-4" id="text-21-21-1">
<p>
Startup config :: /etc/mysql/my.cnf and any .cnf files under /etc/mysql/conf.d 
Mount host directory to /etc/mysql/conf.d in container using <code>-v</code> in docker run
</p>

<p>
Instead of loading custom conf.d directory, tags (&#x2013;tag-name) can be used adjust the configs
</p>

<p>
For container that couldn't have more than 128M memory, use innodb-buffer-pool-size to scale it down.
</p>
<pre class="example">
docker run --name my-mysql-container \
  -e MYSQL_ROOT_PASSWORD=my-secret-pw \
  -d mysql:5.7.9 \
  --character-set-server=utf8mb4 \
  --collation-server=utf8mb4_unicode_ci
  --innodb-buffer-pool-size=50M
</pre>

<p>
In docker-compose.yml
</p>
<pre class="example">
command:
  mysqld --innodb-buffer-pool-size=50M
</pre>

<p>
More <a href="#org25924a8">mysql:config</a>
</p>
</div>
</div>

<div id="outline-container-orgb5145c4" class="outline-4">
<h4 id="orgb5145c4"><span class="section-number-4">21.21.2</span> Environment vars</h4>
<div class="outline-text-4" id="text-21-21-2">
<p>
-e :: set environment vars. None of these will have effect if the container is started with a data dir that already contains a db.
</p>

<p>
MYSQL_ROOT_PASSWORD :: required
MYSQL_DATABASE :: opt. a db to be created on image startup
MYSQL_USER, MYSQL_PASSWORD :: opt. create a user for MYSQL_DATABASE.
</p>

<p>
These vars can be loaded through a file
</p>
<pre class="example">
-e MYSQL_ROOT_PASSWORD_FILE=/run/secrets/mysql-root
</pre>
</div>
</div>

<div id="outline-container-org76c13a0" class="outline-4">
<h4 id="org76c13a0"><span class="section-number-4">21.21.3</span> Import .sql on image startup</h4>
<div class="outline-text-4" id="text-21-21-3">
<p>
Poibt a directory that has a .sh, .sql, and .sql.gz to a dir in container
</p>

<pre class="example">
-v /host/path/to/db-dir:/docker-entrypoint-initdb.d
</pre>

<p>
Importing needs a lot of memory. If host doesn't have 128M memory, try to import it locally and then rsync the persist data folder to host and chown -R 999:docker /path/to/persistdir accordingly on host.
</p>
</div>
</div>

<div id="outline-container-org8058f15" class="outline-4">
<h4 id="org8058f15"><span class="section-number-4">21.21.4</span> Access, view logs, db dump</h4>
<div class="outline-text-4" id="text-21-21-4">
<pre class="example">
docker exec -it my-mysql-container bash
docker logs my-mysql-container
docker exec some-mysql sh -c \
  'exec mysqldump --all-databases -uroot -p"$MYSQL_ROOT_PASSWORD"' &gt; /some/path/on/your/host/all-databases.sql
</pre>
</div>
</div>

<div id="outline-container-org25d7ac1" class="outline-4">
<h4 id="org25d7ac1"><span class="section-number-4">21.21.5</span> Persist data</h4>
<div class="outline-text-4" id="text-21-21-5">
<p>
A place to persist db data on host :: /my/own/datadir
</p>

<pre class="example">
-v /my/own/datadir:/var/lib/mysql
</pre>

<p>
For dev where db data can be imported and disposed when needed, use volume (e.g. dbdata)
</p>
<pre class="example">
version: '2'

volumes:
  dbdata:

networks:
  app_net:
    driver: bridge
    ipam:
      driver: default
      config:
      - subnet: 172.18.0.0/16
        gateway: 172.18.0.1

services:
  db:
    image: mysql:5.7.9
    container_name: db
    volumes:
      - "dbdata:/var/lib/mysql"
      - "/my/own/datadir:/docker-entrypoint-initdb.d"
    networks:
      app_net:
        ipv4_address: 172.18.0.2
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: d7
      MYSQL_DATABASE: d7
      MYSQL_USER: d7
      MYSQL_PASSWORD: d7
</pre>
</div>
</div>

<div id="outline-container-org5a7bb8e" class="outline-4">
<h4 id="org5a7bb8e"><span class="section-number-4">21.21.6</span> Example</h4>
<div class="outline-text-4" id="text-21-21-6">
<p>
To initialize a db, use docker run with data persist
</p>
<pre class="example">
docker run -it --name my-db-container \
  -v /host/path/to/dbdata:/var/lib/mysql \
  -v /host/path/to/db-dir:/docker-entrypoint-initdb.d \
  -e MYSQL_ROOT_PASSWORD=d7 \ 
  -e MYSQL_DATABASE=d7 \ 
  -e MYSQL_USER=d7 \ 
  -e MYSQL_PASSWORD=d7 \
  -d mysql:5.7.9 \
--innodb-buffer-pool-size=50M \
--innodb-buffer-pool-chunk-size=50M \
--max-allowed-packet=50M
</pre>

<p>
Check db status, then you docker-compose restart the container without specifying import directive in docker-compose.yml
</p>
<pre class="example">
mydbcontainer:
  image: mysql:5.7.9
  container_name: mydbcontainer
  volumes:
    - "/host/path/to/dbdata:/var/lib/mysql"
  command:
    mysqld --innodb-buffer-pool-size=50M --innodb-buffer-pool-chunk=50M --max-allowed-packet=16M
  restart: always
  networks:
    ...
</pre>
</div>
</div>
</div>

<div id="outline-container-org546a432" class="outline-3">
<h3 id="org546a432"><span class="section-number-3">21.22</span> image:wordpress</h3>
<div class="outline-text-3" id="text-21-22">
<p>
<a id="org22ac5b7">image:wordpress:apache</a>
wordpress:4.9.3-php7.1-apache
Parent :: php:7.1-apache <a href="#orgeebe557">image:php:apache</a> <a href="#org8f67d0d">image:php:7:apache</a>
</p>

<p>
Tag latest is 4.9.4-php7.2-apache
</p>

<p>
Installed PHP extensions
gd mysqli opcache
</p>
</div>

<div id="outline-container-org73fdc91" class="outline-4">
<h4 id="org73fdc91"><span class="section-number-4">21.22.1</span> docker-compose.yml</h4>
<div class="outline-text-4" id="text-21-22-1">
<pre class="example">
version: '2'
volumes:
  dbsandboxwp:
networks:
  app_netsandboxwp:
    driver: bridge
    ipam:
      driver: default
      config:
      - subnet: 172.20.0.0/24
        gateway: 172.20.0.1
services:
  dbsandboxwp:
    image: mysql:5.7.9
    container_name: dbsandboxwp
    networks:
      app_netsandboxwp:
        ipv4_address: 172.20.0.2
    ports:
      - "31000:3306"
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: wp
      MYSQL_DATABASE: wp
      MYSQL_USER: wp
      MYSQL_PASSWORD: wp

  phpsandboxwp:
    image: wordpress:4.9.3-php7.1-apache
    container_name: phpsandboxwp
    volumes:
      - "./:/var/www/html"
    restart: always
    networks:
      app_netsandboxwp:
        ipv4_address: 172.20.0.3
    environment:
      WORDPRESS_DB_HOST: dbsandboxwp
      WORDPRESS_DB_PASSWORD: wp
      WORDPRESS_DB_USER: wp
      WORDPRESS_DB_NAME: wp
      WORDPRESS_TABLE_PREFIX: wp_
    # environment variables honor mysql
    # WORDPRESS_DB_HOST WORDPRESS_DB_PASSWORD
    # environment variables default
    # WORDPRESS_DB_USER root
    # WORDPRESS_DB_NAME wordpress
    # WORDPRESS_TABLE_PREFIX ""
    ports:
      - "32000:80"
    depends_on:
      - dbsandboxwp
    links:
      - dbsandboxwp
</pre>
</div>
</div>
</div>

<div id="outline-container-org058609c" class="outline-3">
<h3 id="org058609c"><span class="section-number-3">21.23</span> image:drupal</h3>
<div class="outline-text-3" id="text-21-23">
<p>
<a id="org5108166">image:drupal:apache</a>
drupal:7.56-apache
Parent :: php:7.0-apache
</p>
</div>

<div id="outline-container-org7225e7c" class="outline-4">
<h4 id="org7225e7c"><span class="section-number-4">21.23.1</span> docker-compose.yml</h4>
<div class="outline-text-4" id="text-21-23-1">
<p>
docker run -ti &#x2013;rm &#x2013;volumes-from phpsandboxd7 &#x2013;name html-data ubuntu:xenial
docker cp html-data:/var/www/html .
</p>

<pre class="example">
version: '2'
volumes:
  volsandboxd7:
networks:
  app_netsandboxd7:
    driver: bridge
    ipam:
      driver: default
      config:
      - subnet: 172.20.1.0/24
        gateway: 172.20.1.1
services:
  dbsandboxd7:
    image: mysql:5.7.9
    container_name: dbsandboxd7
    networks:
      app_netsandboxd7:
        ipv4_address: 172.20.1.2
        aliases:
          - mysql
    ports:
      - "31001:3306"
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: d7
      MYSQL_DATABASE: d7
      MYSQL_USER: d7
      MYSQL_PASSWORD: d7

  phpsandboxd7:
    image: drupal:7.56-apache
    container_name: phpsandboxd7
    volumes:
      - volsandboxd7:/var/www/html
;; #      - /var/www/html/modules
;; #      - /var/www/html/profiles
;; #      - /var/www/html/sites
;; #      - /var/www/html/themes
    restart: always
    networks:
      app_netsandboxd7:
        ipv4_address: 172.20.1.3
        aliases:
          - drupal
    ports:
      - "32001:80"
    depends_on:
      - dbsandboxd7
</pre>
</div>
</div>
</div>

<div id="outline-container-org80bd8f8" class="outline-3">
<h3 id="org80bd8f8"><span class="section-number-3">21.24</span> <a href="#org47dc20d">image:tatemz/wp-cli</a> <a id="org47dc20d">image:tatemz/wp-cli</a></h3>
<div class="outline-text-3" id="text-21-24">
<p>
<a href="https://github.com/tatemz/docker-wpcli">https://github.com/tatemz/docker-wpcli</a>
</p>

<p>
Refer to <a href="#org9b5498f">wp-cli:search-replace</a>
</p>

<pre class="example">
docker-compose run --rm my-wpcli
docker-compose run --rm my-wpcli db check
docker-compose run --rm my-wpcli post list
docker-compose run --rm my-wpcli db search 'https?://' --regex --stats

# For some reason, the following only works when run in PowerShell
# This replaces A with B for the current database without changing it but instead export it.
docker-compose run --rm my-wpcli search-replace 'http://live.ca' 'http://localhost:9999' --export=/var/www/html/devops/db/export.sql

# There's no way to search/replace multiple strings. Do it one by one
docker-compose run --rm my-wpcli search-replace 'https://live.ca' 'http://localhost:9999'

# at the end export it
docker-compose run --rm my-wpcli db export --add-drop-table /var/www/html/devops/db/dump.sql
</pre>
</div>
</div>

<div id="outline-container-org66f5740" class="outline-3">
<h3 id="org66f5740"><span class="section-number-3">21.25</span> <a href="#orgc182daf">image:wordpress:cli</a> <a id="orgc182daf">image:wordpress:cli</a></h3>
<div class="outline-text-3" id="text-21-25">
<p>
wordpress:cli-php5.6 wordpress-cli-2-php5.6 wordpress:cli-2.0-php5.6 wordpress:cli-2.0.0-php5.6
wordpress:cli-php7.0
wordpress:cli-php7.1
wordpress:cli-php7.2
</p>

<pre class="example">
docker pull wordpress:cli-php7.0

docker run -it --rm --volumes-from mywp --network container:mywp wordpress:cli-php7.0 user list
</pre>
</div>
</div>

<div id="outline-container-orgbaa83f5" class="outline-3">
<h3 id="orgbaa83f5"><span class="section-number-3">21.26</span> image:lucee <a id="orgebcb573">docker:image:lucee</a></h3>
<div class="outline-text-3" id="text-21-26">
<p>
Image name: <a href="https://hub.docker.com/r/lucee/lucee4-nginx/">lucee/lucee4-nginx</a>
Parent Images: lucee/lucee4 &gt; tomcat:8.0.36-jre8 &gt; openjdk:8-jre &gt; buildpack-deps:stretch-curl
</p>
</div>

<div id="outline-container-org4988000" class="outline-4">
<h4 id="org4988000"><span class="section-number-4">21.26.1</span> docker-compose.yml Dockerfile</h4>
<div class="outline-text-4" id="text-21-26-1">
<p>
docker-compose.yml
</p>
<pre class="example">
version: '2'
networks:
  app_net:
    driver: bridge
    ipam:
      driver: default
      config:
      - subnet: 172.16.2.0/24
        gateway: 172.16.2.1
services:
  lucee:
    build: .
    image: cflucee:latest
    container_name: lucee
    ports:
      - "80:80"
      - "8888:8888"
    volumes:
      - /home/you/db/access:/root/db/
      - /home/you/www:/var/www
      # Scheduled tasks are setup in http://127.0.0.1:8888/lucee/admin/web.cfm
      # /home/you/www/WEB-INF/lucee/scheduler/scheduler.xml &gt; /var/wwww/WEB-INF/lucee/scheduler/scheduler.xml
      - /home/you/logs/tomcat:/usr/local/tomcat/logs
      - /home/you/logs/nginx:/var/log/nginx
      - /home/you/logs/lucee:/opt/lucee/web/logs
    networks:
      app_net:
        ipv4_address: 172.16.2.3

</pre>

<p>
Dockerfile
</p>
<pre class="example">
FROM lucee/lucee4-nginx:4.5.1.024

ENV TZ=America/Toronto
RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime &amp;&amp; echo $TZ &gt; /etc/timezone

;; # Copy UcanAccess
COPY ucanaccess/* /usr/local/tomcat/lib/

;; # Custom tags are manually copied to each host's root folder...
COPY config/customtags/* /opt/lucee/web/customtags/
;; # COPY config/customtags/* /opt/lucee/server/lucee-server/context/library/

;; # Tomcat configs
;; # COPY catalina.properties server.xml web.xml /usr/local/tomcat/conf/
COPY config/tomcat/server.xml /usr/local/tomcat/conf/
COPY config/tomcat/context.xml /usr/local/tomcat/conf/
;; # COPY config/tomcat/legacy_js.xml /usr/local/tomcat/conf/Catalina/127.0.0.1/legacy_js.xml

;; # Custom setenv.sh to load Lucee
COPY setenv.sh /usr/local/tomcat/bin/
RUN chmod a+x /usr/local/tomcat/bin/setenv.sh

;; # Default setenv.sh https://github.com/lucee/lucee-dockerfiles/blob/master/4.5/setenv.sh
;; # Added UcanAccess

;; # NGINX configs
COPY config/nginx/ /etc/nginx/
;; # /etc/nginx/nginx.conf :: Default not modified https://github.com/lucee/lucee-dockerfiles/blob/master/lucee-nginx/4.5/nginx.conf
;; # /etc nginx/default.conf :: https://github.com/lucee/lucee-dockerfiles/blob/master/lucee-nginx/4.5/default.conf

;; # Add datasources. Default https://github.com/lucee/lucee-dockerfiles/blob/master/4.5/lucee-server.xml
COPY config/lucee/lucee-server.xml /opt/lucee/server/lucee-server/context/lucee-server.xml

;; # Lucee server PRODUCTION configs
;; # COPY config/lucee/lucee-web.xml.cfm /opt/lucee/web/lucee-web.xml.cfm

;; # Deploy codebase to container
;; # COPY index.cfm /var/www
</pre>
</div>
</div>

<div id="outline-container-org4128ac7" class="outline-4">
<h4 id="org4128ac7"><span class="section-number-4">21.26.2</span> Add ucanaccess db driver to TomCat, Add M$ Access Datasources</h4>
<div class="outline-text-4" id="text-21-26-2">
<p>
Refer to <a href="#org4a00996">docker:image:tomcat</a>
</p>

<p>
Add Access datasource on yourdomain.com:8888/lucee/admin/server.cfm
Type: Other - JDBC Driver
Datasource name: abc
Class: net.ucanaccess.jdbc.UcanaccessDriver
Database: jdbc:ucanaccess:///home/MyName/www/database/MyMsAccessDB.mdb
</p>

<p>
Create a datasource using UI. One of the Lucee setting files will have this line in &lt;datasources&gt;
</p>
<pre class="example">
&lt;data-source allow="511" 
blob="false" 
class="net.ucanaccess.jdbc.UcanaccessDriver" 
clob="false" connectionTimeout="1" custom="" database="" dbdriver="Other" 
dsn="jdbc:ucanaccess:///home/MyName/www/database/MyMsAccessDB.mdb" 
host="" metaCacheTimeout="60000" name="abc" 
password="abc test password" 
storage="false" validate="false"/&gt;
</pre>
</div>
</div>

<div id="outline-container-org4c11974" class="outline-4">
<h4 id="org4c11974"><span class="section-number-4">21.26.3</span> Lucee server and web settings</h4>
<div class="outline-text-4" id="text-21-26-3">
<p>
Lucee server setting :: /opt/lucee/server/lucee-server/context/lucee-server.xml
Individual website setting :: /opt/lucee/web/lucee-web.xml.cfm
</p>
</div>
</div>

<div id="outline-container-org0968a01" class="outline-4">
<h4 id="org0968a01"><span class="section-number-4">21.26.4</span> Custom tags (.cfm|.cfc) under <i>opt/lucee/web/customtags</i></h4>
</div>
<div id="outline-container-org0e7fa1e" class="outline-4">
<h4 id="org0e7fa1e"><span class="section-number-4">21.26.5</span> Change Lucee Server Admin UI password</h4>
<div class="outline-text-4" id="text-21-26-5">
<p>
<a href="https://gist.github.com/jlamoree/6c1fc89ca3b8ce2581eb76dadeb1ee53">Use this with a salt</a> to generate hspw in Lucee server setting &lt;cfLuceeConfiguration hspw="" salt="" version="4.5"&gt;
Refer to <a href="#org28db7d1">image:lucee:salt</a>. It seems like you should use the salt that is in the default lucee-server.xml.
Can't use a random salt.
</p>
</div>
</div>

<div id="outline-container-org996f068" class="outline-4">
<h4 id="org996f068"><span class="section-number-4">21.26.6</span> How does it work with Nginx?</h4>
<div class="outline-text-4" id="text-21-26-6">
<p>
Lucee operates on TomCat port 8888 using 127.0.0.1. Nginx forwards 80 incoming traffic to port 8888. 
By default, only *.cfm|cfc|cfr files are forwarded to 8888. Add more files to /etc/nginx/conf.d/default.conf
</p>

<pre class="example">
location ~* \.(cfm|cfc|cfr|jpe?g|js|css|png|gif|html)$ {
    proxy_pass http://127.0.0.1:8888;
    proxy_redirect off;
    proxy_set_header Host $host;
    proxy_set_header X-Forwarded-Host $host;
    proxy_set_header X-Forwarded-Server $host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_connect_timeout 600;
    proxy_send_timeout 600;
    proxy_read_timeout 600;
    send_timeout 600;
  }
</pre>
</div>
</div>

<div id="outline-container-org2a2129a" class="outline-4">
<h4 id="org2a2129a"><span class="section-number-4">21.26.7</span> Virtual Directory and TomCat</h4>
<div class="outline-text-4" id="text-21-26-7">
<p>
Virtual Directory. Setup <a href="#org9b5b880">docker:image:tomcat:vd</a> first, then setup forwarding
</p>
<pre class="example">
location ~* /legacy_js {
  proxy_pass http://127.0.0.1:8888;
  proxy_redirect off;
  proxy_set_header Host $host;
  proxy_set_header X-Forwarded-Host $host;
  proxy_set_header X-Forwarded-Server $host;
  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_set_header X-Real-IP $remote_addr;
  proxy_connect_timeout 600;
  proxy_send_timeout 600;
  proxy_read_timeout 600;
  send_timeout 600;
}
</pre>
</div>
</div>

<div id="outline-container-org7a74966" class="outline-4">
<h4 id="org7a74966"><span class="section-number-4">21.26.8</span> Add hosts</h4>
<div class="outline-text-4" id="text-21-26-8">
<pre class="example">
server {
  listen 80 default_server;
  server_name domain1.com;
  index  index.cfm index.html index.htm;
  root   /var/www/site1;
  server_name_in_redirect off;

  include allcf/common.conf;

  location ~* (/legacy_js)|(\.(cfm|cfc|cfr|jpe?g|js|gif|css|png|html)$) {
    proxy_pass http://127.0.0.2:8888;
    proxy_redirect off;
    proxy_set_header Host 127.0.0.2;
    proxy_set_header X-Forwarded-Host $host;
    proxy_set_header X-Forwarded-Server $host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_connect_timeout 600;
    proxy_send_timeout 600;
    proxy_read_timeout 600;
    send_timeout 600;
  }

}

server {
  listen 80;
  server_name domain2.com;
  index  index.cfm index.html index.htm;
  root   /var/www/site2;
  server_name_in_redirect off;

  include allcf/common.conf;

  location ~* (/legacy_js)|(\.(cfm|cfc|cfr|jpe?g|js|gif|css|png|html)$) {
    proxy_pass http://127.0.0.3:8888;
    proxy_redirect off;
    proxy_set_header Host 127.0.0.3;
    proxy_set_header X-Forwarded-Host $host;
    proxy_set_header X-Forwarded-Server $host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_connect_timeout 600;
    proxy_send_timeout 600;
    proxy_read_timeout 600;
    send_timeout 600;
  }

}
</pre>

<p>
Add hosts in <a href="#org141028e">docker:image:tomcat:host</a>
</p>
</div>
</div>

<div id="outline-container-orge3d913d" class="outline-4">
<h4 id="orge3d913d"><span class="section-number-4">21.26.9</span> Scheduled Tasks</h4>
<div class="outline-text-4" id="text-21-26-9">
<p>
Create them in /lucee/admin/web.cfm
Checkout this file /var/www/WEB-INF/lucee/scheduler/scheduler.xml
</p>
</div>
</div>
</div>

<div id="outline-container-org92ac674" class="outline-3">
<h3 id="org92ac674"><span class="section-number-3">21.27</span> image:tomcat</h3>
<div class="outline-text-3" id="text-21-27">
<p>
<a id="org4a00996">docker:image:tomcat</a>
Image name: tomcat:8.0.36-jre8
</p>
</div>

<div id="outline-container-org8b2d81b" class="outline-4">
<h4 id="org8b2d81b"><span class="section-number-4">21.27.1</span> Settings</h4>
<div class="outline-text-4" id="text-21-27-1">
<p>
The default webapps (including TomCat Admin Console, localhost:8080/manager/html and .jar files) is in /usr/local/tomcat/webapps
The default connector port is 8080.
</p>

<p>
<a href="#orgebcb573">docker:image:lucee</a> deletes this webapps folder, place it under /usr/local/tomcat/lucee which contains all .jar files.
</p>

<p>
Include that directory in catelina.properties in common.loader=${catalina.home}/lucee/*.jar
</p>

<p>
Define a &lt;web-app&gt; with multiple servlets in ${catalina.home}/web.xml to handle all .html and .cf(m|c) files.
</p>

<p>
When the web-app and Lucee servlet are built, new Lucee admin paths (context) are built :: 
127.0.0.1:8888/lucee/admin/server.cfm and web.cfm
Corresponding paths are /opt/lucee/server(/lucee-server) and opt/lucee/web
</p>

<p>
In ${catalina.home}/server.xml, define Host(s) as usual. 
Each &lt;Host&gt; has appBase="webapps" which is a folder under /usr/local/tomcat. Using the empty webapps folder is fine.
</p>

<p>
Each &lt;Host&gt; can have multiple &lt;Context&gt; with different path/docBase. 
The root directory of each Host can have:
</p>
<dl class="org-dl">
<dt>META-INF folder</dt><dd>context.xml (server-dependent config, e.g. datasource),</dd>
<dt>WEB-INF folder</dt><dd>web.xml (server-independent config, e.g. servlet mappings, <a href="#orgebcb573">docker:image:lucee</a>:tasks)</dd>
</dl>

<p>
If there's ${catalina.home}/context.xml, all hosts have these settings and 
override &lt;Context&gt; set in &lt;Host&gt; in server.xml and override <code>&lt;Context&gt;</code> in any <code>META-INF/context.xml</code> under all hosts:
${catalina_home}/[enginename]/[host]/META-INF/context.xml
</p>

<p>
The only time <code>path</code> attribute in <code>&lt;Context&gt;</code> has any effect is in the server.xml
</p>
</div>
</div>

<div id="outline-container-orgba8c2b2" class="outline-4">
<h4 id="orgba8c2b2"><span class="section-number-4">21.27.2</span> Install UcanAccess JDBC driver to enable M$ Access datasource</h4>
<div class="outline-text-4" id="text-21-27-2">
<p>
Copy these jar files
</p>
<pre class="example">
COPY ucanaccess/* /usr/local/tomcat/lib/
</pre>
<p>
ucanaccess-4.0.1.jar
lib/*.jar (commons-lang, commons-logging, hsqldb, jackcess)
</p>

<p>
Add these 2 lines to setenv.sh
</p>
<pre class="example">
UCANACCESS_HOME=/usr/local/tomcat/lib;
export UCANACCESS_HOME;
</pre>

<p>
<a href="#orgebcb573">docker:image:lucee</a>
</p>
<pre class="example">
COPY setenv.sh /usr/local/tomcat/bin/
RUN chmod a+x /usr/local/tomcat/bin/setenv.sh
</pre>
</div>
</div>

<div id="outline-container-org254325a" class="outline-4">
<h4 id="org254325a"><span class="section-number-4">21.27.3</span> Setup Virtual Directory per Host <a id="org9b5b880">docker:image:tomcat:vd</a></h4>
<div class="outline-text-4" id="text-21-27-3">
<p>
In /usr/local/tomcat/conf/server.xml, you can see how many hosts are defined. e.g.
</p>
<pre class="example">
&lt;Server port="8005" shutdown="SHUTDOWN"&gt;
  &lt;Listener className="org.apache.catalina.startup.VersionLoggerListener" /&gt;
  &lt;Listener className="org.apache.catalina.core.AprLifecycleListener" SSLEngine="on" /&gt;
  &lt;Listener className="..." /&gt;

  &lt;Service name="Catalina"&gt;
    &lt;Connector executor="tomcatThreadPool"
               port="8888" protocol="HTTP/1.1"
               connectionTimeout="20000"
               redirectPort="8443" /&gt;

    &lt;Connector port="8009" protocol="AJP/1.3" redirectPort="8443" /&gt;

    &lt;Engine name="Catalina" defaultHost="127.0.0.1"&gt;
      &lt;Host name="127.0.0.1"  appBase="webapps"
            unpackWARs="true" autoDeploy="true"&gt;
        &lt;Valve className="org.apache.catalina.valves.RemoteIpValve"
               remoteIpHeader="X-Forwarded-For"
               requestAttributesEnabled="true" /&gt;
        &lt;Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"
               prefix="localhost_access_log" suffix=".txt"
               pattern="%h %l %u %t &amp;quot;%r&amp;quot; %s %b" /&gt;

        &lt;Context path="" docBase="/var/www/"&gt;
          &lt;JarScanner scanClassPath="false"/&gt;
        &lt;/Context&gt;
        &lt;!-- You can define virtual directory here or follow the way of adding vd.xml--&gt;
        &lt;!-- 
        &lt;Context path="/legacy_js" docBase="/path/outside/var/www/legacy_js"&gt;&lt;/Context&gt;
        --&gt;
      &lt;/Host&gt;
    &lt;/Engine&gt;

  &lt;/Service&gt;

&lt;/Server&gt;
</pre>

<p>
Method 1 is to add a &lt;Context&gt; tag in a &lt;Host&gt; in server.xml. But for me it doesn't work when multiple hosts
need to have the same vd and it creates a lot of other problems.
</p>

<p>
General rule :: don't include more than 1 &lt;Context&gt; in each &lt;Host&gt; in server.xml
</p>

<p>
Method 2 is to create a file legacy_js.xml under ${catalina_home}/conf/Catalina/127.0.0.1/
Where Catalina is the engine name and 127.0.0.1 is the Host name.
</p>
<pre class="example">
;; # legacy_js.xml
&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;Context docBase="/root/vd/legacy_js/"&gt;&lt;/Context&gt;
</pre>

<p>
<code>http://127.0.0.1/legacy_js/abc.js</code> points to <code>/root/vd/legacy_js/abc.js</code>
</p>

<p>
If it's foo#bar.xml then <code>http://127.0.0.1/foo/bar/abc.js</code>
</p>

<p>
Method 2 is not tested for multiple hosts usage&#x2026;
</p>

<p>
Method 3 is tested.
</p>

<p>
Create relative symbolic link for docker usage.
/var/www/site2/legacy_js point to ../site1/source_legacy_js
</p>

<pre class="example">
cd /var/www/site2
ln -s ../site1/source_legacy_js/ legacy_js
</pre>

<p>
TomCat can't follow relative symbolic link..
Add this line to ${catalina_home}/context.xml for TomCat 8
</p>
<pre class="example">
&lt;Resources allowLinking="true"&gt;&lt;/Resources&gt;
;; # For TomCat 7, add attribute allowLinking="true" to the only &lt;Context&gt;
</pre>

<p>
I recently found out Method 3 doesn't work.. Here's Method 4. 
Don't reverse proxy to TomCat at all, if vd has only static files. In nginx default.conf
</p>
<pre class="example">
location ~* ^/legacy_js {
;; # nginx serve the static files
}
location ~* \.(cfm|cfc|cfr|jpe?g|js)
</pre>
</div>
</div>

<div id="outline-container-org6486f5f" class="outline-4">
<h4 id="org6486f5f"><span class="section-number-4">21.27.4</span> Add host <a id="org141028e">docker:image:tomcat:host</a></h4>
<div class="outline-text-4" id="text-21-27-4">
<p>
Host name should be 127/8 ip address otherwise you need to setup DNS.
Refer to <a href="#org51d0388">docker:image:tomcat:log</a>
</p>

<pre class="example">
&lt;Host name="127.0.0.2" appBase="webapps"&gt;
  &lt;Valve className="org.apache.catalina.valves.RemoteIpValve"
         remoteIpHeader="X-Forwarded-For"
         requestAttributesEnabled="true" /&gt;
  &lt;Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"
         prefix="localhost_access_log" suffix=".txt"
         pattern="%h %l %u %t &amp;quot;%r&amp;quot; %s %b" /&gt;

  &lt;Context path="" docBase="/var/www/site1/"&gt;
    &lt;JarScanner scanClassPath="false"/&gt;
  &lt;/Context&gt;
&lt;/Host&gt;

&lt;Host name="127.0.0.3" appBase="webapps"&gt;
&lt;Valve className="org.apache.catalina.valves.RemoteIpValve"
       remoteIpHeader="X-Forwarded-For"
       requestAttributesEnabled="true" /&gt;
&lt;Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"
       prefix="localhost_access_log" suffix=".txt"
       pattern="%h %l %u %t &amp;quot;%r&amp;quot; %s %b" /&gt;
&lt;Context path="" docBase="/var/www/site2/"&gt;
  &lt;JarScanner scanClassPath="false"/&gt;
&lt;/Context&gt;
&lt;Context docBase="/var/www/vd/legacy_js/" path="/legacy_js"&gt;&lt;/Context&gt;
&lt;/Host&gt;
</pre>
</div>
</div>

<div id="outline-container-org29c98db" class="outline-4">
<h4 id="org29c98db"><span class="section-number-4">21.27.5</span> Restrict Access</h4>
<div class="outline-text-4" id="text-21-27-5">
<p>
Refer to <a href="#org51d0388">docker:image:tomcat:log</a>
</p>

<pre class="example">
&lt;!-- RemoteAddrValue is %a in log --&gt;
&lt;Valve className="org.apache.catalina.valves.RemoteAddrValve"
       allow="allow.com" /&gt;
&lt;!-- RemoteHostValue is %h in log --&gt;
&lt;Valve className="org.apache.catalina.valves.RemoteHostValve"
       allow="127.0.0.1,10.100.1.2" /&gt;
</pre>
</div>
</div>

<div id="outline-container-orgd4c4ce9" class="outline-4">
<h4 id="orgd4c4ce9"><span class="section-number-4">21.27.6</span> Logging</h4>
<div class="outline-text-4" id="text-21-27-6">
<p>
<a id="org51d0388">docker:image:tomcat:log</a>
Google :: tomcat access log value
pattern
</p>
<dl class="org-dl">
<dt>%h</dt><dd>remote host name. Or IP if enableLookups for the connector is false
If request is passed from Nginx (proxy_pass), it's 127.0.0.1
If request is directly from Internet, it's the requester's IP</dd>

<dt>%a</dt><dd>Remote IP address. Same as %h but IP only
If request is passed from Nginx (proxy_pass), it's 127.0.0.1
If request is directly from Internet, it's the requester's IP.</dd>

<dt>%v</dt><dd>Local server name.
If request is passed from Nginx (proxy_pass), it's the name of &lt;Host&gt; in Tomcat
If request is directly from Internet, it's the request domain name</dd>
<dt>%A</dt><dd>Local IP address. Tomcat server public IP</dd>
<dt>%{local}p</dt><dd>local port. Which is 80 or 8888 where is set in &lt;Connector&gt;</dd>
<dt>%{remote}p</dt><dd>remote port. IDK.. Maybe random</dd>
<dt>%{xxx}i</dt><dd>incoming header value. e.g. %{X-Forwarded-Host}</dd>
<dt>%{xxx}o</dt><dd>outgoing header value</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org1b9e76d" class="outline-3">
<h3 id="org1b9e76d"><span class="section-number-3">21.28</span> image:stilliard/pure-ftpd <a id="org758fab7">docker:image:ftp</a></h3>
<div class="outline-text-3" id="text-21-28">
<p>
Image name: stilliard/pure-ftpd:hardened
Parent image: debian:jessie
</p>

<p>
<a href="https://github.com/stilliard/docker-pure-ftpd">https://github.com/stilliard/docker-pure-ftpd</a>
By default, it only supports FTP not SFTP
</p>

<p>
Dockerfile <code>docker build -t myftp .</code>
</p>
<pre class="example">
FROM stilliard/pure-ftpd:hardened

;; # e.g. you could change the defult command run:
CMD /run.sh -c 30 -C 5 -l puredb:/etc/pure-ftpd/pureftpd.pdb -E -j -R -P $PUBLICHOST -p 30000:30009

;; # /usr/sbin/pure-ftpd

;; # -c 50, --maxclientsnumber (no more than 50 people at once)
;; # -C 10, --maxclientsperip (no more than 10 requests from the same ip)
;; # -l puredb:/etc/pure-ftpd/pureftpd.pdb, --login (login file for virtual users)
;; # -E, --noanonymous (only real users)
;; # -j, --createhomedir (auto create home directory if it doesn't already exist)
;; # -R, --nochmod (prevent usage of the CHMOD command)

;; # -tls 1, Enables optional TLS support

;; # In Compose

;; # -P $PUBLICHOST :: setting for PASV support, passed in your the PUBLICHOST env var
;; # -p 30000:30009 :: PASV port range
</pre>

<p>
docker-compose.yml
</p>
<pre class="example">
version: '2'
networks:
  app_net:
    driver: bridge
    ipam:
      driver: default
      config:
      - subnet: 172.16.3.0/24
        gateway: 172.16.3.1
services:
  myftp:
    build: .
    image: myftp:latest
    container_name: myftp
    environment:
      - PUBLICHOST=ftp.yourdomain.com
;; #     - ADDED_FLAGS=-d -d
    ports:
      - "21:21"
      - "30000-30009:30000-30009"
;; # open these many ports to support Passive Mode..
    volumes:
      - /host/storefiles/ftp:/home/ftpusers
      - /host/config/ftp/passwd:/etc/pure-ftpd/passwd
;; # persist the user database
;; # only one file under /etc/pure-ftpd/passwd which is pureftps.passwd and it contains the user database
;; #     - /host/config/ftp/ssl:/etc/ssl/private
;; # a single `pure-ftpd.pem` file with server's SSL certificates for TLS support
    networks:
      app_net:
        ipv4_address: 172.16.3.3
</pre>

<p>
Makefile
</p>
<pre class="example">
FTPCONFIG=/etc/pure-ftpd/passwd/pureftpd.passwd

.PHONY: default info start stop restart list adduser deluser

default:
        @echo "make [command]. Available commands are:"
        @echo "info, start, stop, restart, list, adduser, deluser"

info:
        @echo "List all virutal user: make list"
        @echo "Add a new user abc and make parent folder to /FTP"
        @echo 'make adduser username="abc" folder="FTP"'
        @echo 'Add a new user abc and make parent folder to root /'
        @echo 'make adduser username="abc" folder="application1"'
        @echo 'Delete a user abc: make deluser username="abc"'

start:
        sudo docker-compose up -d --build

stop:
        sudo docker-compose down -v

restart:
        sudo docker-compose down -v &amp;&amp; sudo docker-compose up -d --build

enter:
        sudo docker exec -it newcomftp bash -I

list:
        @echo "&lt;account&gt;:&lt;password&gt;:&lt;uid&gt;:&lt;gid&gt;:&lt;gecos&gt;:&lt;home directory&gt;:&lt;upload bandwidth&gt;:&lt;download bandwidth&gt;:&lt;upload ratio&gt;:&lt;download ratio&gt;:&lt;max number of connections&gt;:&lt;files quota&gt;:&lt;size quota&gt;:&lt;authorized local IPs&gt;:&lt;refused local IPs&gt;:&lt;authorized client IPs&gt;:&lt;refused client IPs&gt;:&lt;time restrictions&gt;"
        sudo cat ~/config/ftp/passwd/pureftpd.passwd

adduser:
        sudo docker exec -it myftp pure-pw useradd $$username -f $(FTPCONFIG) -m -u ftpuser -d /home/ftpusers/$$folder

deluser:
        sudo docker exec -it myftp pure-pw userdel $$username -f $(FTPCONFIG) -m
</pre>

<p>
Pureftp Manual
</p>
<ul class="org-ul">
<li><a href="https://download.pureftpd.org/pub/pure-ftpd/doc/README.Virtual-Users">Add User</a></li>
<li><a href="https://download.pureftpd.org/pub/pure-ftpd/doc/FAQ">FAQ</a></li>
<li><code>man pure-ftpd</code></li>
<li>Start running <code>/usr/sbin/pure-ftpd $some_flags</code></li>
</ul>

<p>
<a id="orga1ba231">ftp:passive mode</a>
FTP opens one channel for command and another for data.
</p>

<dl class="org-dl">
<dt>Active mode</dt><dd>client establishes the command channel (from client port X to server port 21) but the server establishes the data channel (from server port 20 to client port Y, where Y has been supplied by the client).</dd>

<dt>Passive mode</dt><dd>client establishes both channels. In that case, the server tells the client which port should be used for the data channel.</dd>
</dl>
</div>
</div>

<div id="outline-container-org161d103" class="outline-3">
<h3 id="org161d103"><span class="section-number-3">21.29</span> <a href="#org863204d">image:dockerfile-from-image</a></h3>
<div class="outline-text-3" id="text-21-29">
<p>
<a id="org863204d">image:dockerfile-from-image</a>
<a href="https://github.com/levonlee/dockerfile-from-image">https://github.com/levonlee/dockerfile-from-image</a>
</p>

<p>
docker run -v /var/run/docker.sock:/var/run/docker.sock dockerfile-from-image &lt;IMAGE_TAG_OR_ID&gt;
e.g.
docker run -v /var/run/docker.sock:/var/run/docker.sock dockerfile-from-image ubuntu
</p>

<p>
For windows
docker run -v //var/run/docker.sock:/var/run/docker.sock dockerfile-from-image ubuntu
</p>

<p>
Dockerfile (added one line: RUN chmod)
</p>
<pre class="example">
FROM alpine:3.2
MAINTAINER CenturyLink Labs &lt;clt-labs-futuretech@centurylink.com&gt;

RUN apk --update add ruby-dev ca-certificates &amp;&amp; \
    gem install --no-rdoc --no-ri docker-api &amp;&amp; \
    apk del ruby-dev ca-certificates &amp;&amp; \
    apk add ruby ruby-json &amp;&amp; \
    rm /var/cache/apk/*

ADD dockerfile-from-image.rb /usr/src/app/dockerfile-from-image.rb
RUN chmod +x /usr/src/app/dockerfile-from-image.rb

ENTRYPOINT ["/usr/src/app/dockerfile-from-image.rb"]
CMD ["--help"]
</pre>

<p>
dockerfile-from-image.rb (same as GitHub)
</p>
<pre class="example">
#! /usr/bin/env ruby
require 'docker'
require 'optparse'

NONE_TAG = '&lt;none&gt;:&lt;none&gt;'
NOP_PREFIX = '#(nop) '

options = {}
commands = []

;; # Default to -h if no arguments
ARGV &lt;&lt; '-h' if ARGV.empty?

OptionParser.new do |opts|
  opts.banner = "Usage: dockerfile-from-image.rb [options] &lt;image_id&gt;"

  opts.on("-f", "--full-tree", "Generate Dockerfile for all parent layers") do |f|
    options[:full] = f
  end

  opts.on_tail("-h", "--help", "Show this message") do
    puts opts
    exit
  end
end.parse!

image_id = ARGV.pop
abort('Error: Must specify image ID or tag') unless image_id

;; # Collect all image tags into a hash keyed by layer ID.
;; # Used to look-up potential FROM targets.
tags = Docker::Image.all.each_with_object({}) do |image, hsh|
  tag = image.info['RepoTags'].first
  hsh[image.id] = tag unless tag == NONE_TAG
end

loop do
;; # If the current ID has a tag, render FROM instruction and break
;; # (unless this is the first command)
  if !options[:full] &amp;&amp; commands &amp;&amp; tags.key?(image_id)
    commands &lt;&lt; "FROM #{tags[image_id]}"
    break
  end

  begin
    image = Docker::Image.get(image_id)
  rescue Docker::Error::NotFoundError
    abort('Error: specified image tag or ID could not be found')
  end

  cmd = image.info['ContainerConfig']['Cmd']

  if cmd &amp;&amp; cmd.size == 3
    cmd = cmd.last

    if cmd.start_with?(NOP_PREFIX)
      commands &lt;&lt; cmd.gsub(NOP_PREFIX,'').gsub(/^USER[ |\t]+\[(.*)\]/,'USER \1')
    else
      commands &lt;&lt; "RUN #{cmd}".split.join(' ')
    end
  end

  image_id = image.info['Parent']
  break if image_id == ''
end

puts commands.reverse
</pre>
</div>
</div>

<div id="outline-container-orgf3eeb01" class="outline-3">
<h3 id="orgf3eeb01"><span class="section-number-3">21.30</span> image:ubuntu</h3>
<div class="outline-text-3" id="text-21-30">
<p>
<code>docker run -it --rm --privileged ubuntu:xenial /bin/bash</code>
</p>

<p>
trusty: 14.04
xenial (latest): 16.04
</p>

<pre class="example">
services:
  nodejs:
    image: ubuntu:latest

tty: true
</pre>
</div>
</div>

<div id="outline-container-org5ef07cc" class="outline-3">
<h3 id="org5ef07cc"><span class="section-number-3">21.31</span> image:node</h3>
<div class="outline-text-3" id="text-21-31">
<p>
node:boron
Latest version 6.x (LTS)
Parent image: buildpack-deps:jessie
Available: git, openssh-client
</p>

<p>
Use <code>docker logs -f container_name</code> to tail log
</p>
</div>
</div>

<div id="outline-container-org2ed8aa1" class="outline-3">
<h3 id="org2ed8aa1"><span class="section-number-3">21.32</span> image:golang</h3>
<div class="outline-text-3" id="text-21-32">
<p>
golang:1.8
Parent image: buildpack-deps:jessie-scm
Available: make
Environment vars: GOPATH=/go
GOROOT: <i>usr/local/bin</i>
WORKDIR $GOPATH
</p>

<p>
<code>docker run -it --rm --name testgo golang:1.8 /bin/bash -I</code> to go in
</p>

<p>
Running <code>exec hello</code> inside container will exit the container
</p>

<p>
To download, compile and run and exit the container:
</p>
<pre class="example">
docker run --rm golang:1.8 sh -c "go get github.com/golang/example/hello/... &amp;&amp; exec hello"
</pre>

<p>
To download the compiled hello command to host directory <i>tmp/bin:
~docker run &#x2013;rm -v /tmp/bin:/go/bin golang:1.8 go get github.com/golang/example/hello</i>&#x2026;~
Then run <code>/tmp/bin/hello</code> where hello is the parent directory name
(For private repo, add <code>-it</code> for inputing username and password)
</p>
</div>
</div>
</div>

<div id="outline-container-orgb943c13" class="outline-2">
<h2 id="orgb943c13"><span class="section-number-2">22</span> Jenkins</h2>
<div class="outline-text-2" id="text-22">
</div>
<div id="outline-container-orgc65d1b5" class="outline-3">
<h3 id="orgc65d1b5"><span class="section-number-3">22.1</span> Install</h3>
<div class="outline-text-3" id="text-22-1">
<p>
Ubuntu or Debian-based
</p>
<pre class="example">
wget -q -O - https://pkg.jenkins.io/debian/jenkins.io.key | sudo apt-key add -
sudo sh -c 'echo deb http://pkg.jenkins.io/debian-stable binary/ &gt; /etc/apt/sources.list.d/jenkins.list'
sudo apt-get update
sudo apt-get install jenkins
</pre>

<p>
It will:
</p>
<ul class="org-ul">
<li>Setup Jenkins as a daemon launched on start. See /etc/init.d/jenkins for more details.</li>
<li>Create a jenkins user to run this service.</li>
<li>Direct console log output to the file <code>/var/log/jenkins/jenkins.log</code>. Check this file if you are troubleshooting Jenkins.</li>
<li>Populate <code>/etc/default/jenkins</code> with configuration parameters for the launch, e.g JENKINS_HOME</li>
<li>Set Jenkins to listen on port 8080. Access this port with your browser to start configuration.</li>
<li>If your /etc/init.d/jenkins file fails to start Jenkins, edit the /etc/default/jenkins to replace the line -&#x2014;HTTP_PORT=8080-&#x2014; with -&#x2014;HTTP_PORT=8081-&#x2014; Here, "8081" was chosen but you can put another port available.</li>
</ul>

<p>
To restart jenkins :: <code>sudo /etc/init.d/jenkins restart</code>
Usage: /etc/init.d/jenkins {start|stop|status|restart|force-reload}`
</p>
</div>
</div>

<div id="outline-container-org2442c85" class="outline-3">
<h3 id="org2442c85"><span class="section-number-3">22.2</span> config</h3>
<div class="outline-text-3" id="text-22-2">
<p>
nano /etc/default/jenkins
Disable DNS Multicast feature which will blow up jenkins log
</p>
<pre class="example">
Change this: JAVA_ARGS="-Djava.awt.headless=true"
To this: JAVA_ARGS="-Djava.awt.headless=true -Dhudson.DNSMultiCast.disabled=true"
Restart
service jenkins restart
</pre>

<p>
Or you can keep that feature on but just don't log
</p>

<p>
Manage Jenkins -&gt; System Log -&gt; Log Levels (on the left)
Add the following entry:
</p>

<p>
Name: javax.jmdns
Level: off
</p>
</div>
</div>

<div id="outline-container-orgd352f72" class="outline-3">
<h3 id="orgd352f72"><span class="section-number-3">22.3</span> Builds</h3>
<div class="outline-text-3" id="text-22-3">
<p>
Always use sudo to run commands
</p>
</div>
</div>
</div>

<div id="outline-container-orga2be444" class="outline-2">
<h2 id="orga2be444"><span class="section-number-2">23</span> Go</h2>
<div class="outline-text-2" id="text-23">
</div>
<div id="outline-container-org0bad04f" class="outline-3">
<h3 id="org0bad04f"><span class="section-number-3">23.1</span> Basics, Command</h3>
<div class="outline-text-3" id="text-23-1">
<p>
Go is just an executable script file. Uninstall on Windows, go to Control Panel if you install using msi
On Linux, uninstall by just replacing the bin folder
</p>

<p>
Install on Windows using zip, extract it to C:\go so C:\go\bin exists. Add C:\go\bin to PATH. GOPATH is C:\Users\username\go
Refer to <a href="#org127aa5e">phpstorm:golang</a>
</p>

<pre class="example">
echo $GOPATH
go version

;; # godoc &lt;package_name&gt;
godoc fmt

gofmt main.go
;; # -w write file
gofmt -w main.go

;; # Format all files in directory
go fmt ./...

;; # List environment variables
go env

;; # GOROOT = usr/local/go
;; # GOARCH and GOOS possible values
;; # cat $GOROOT/src/go/build/syslist.go

;; # Compile packages and dependencies based on 1 go file
go build main.go

;; # A package file name should be only lowercase letters

;; # Folder structure in GOPATH directory
;; # ./bin holds executables (compiled
;; # ./pkg
;; # ./src holds packages. In this folder, run go install
;; # to compile and executables in ./bin
;; # Change GOOS and GOARCH then go install again

;; # Standard library including builtin package are under $GOROOT/src, e.g. $GOROOT/src/fmt
;; # Or go online https://golang.org/pkg/fmt/
</pre>

<p>
In Go Playground, the system time is always the same
<a href="http://play.golang.org">http://play.golang.org</a>
</p>

<p>
<a href="https://github.com/golang/go/wiki/IDEsAndTextEditorPlugins">Supported IDEs</a>
</p>
</div>

<div id="outline-container-orgef1545f" class="outline-4">
<h4 id="orgef1545f"><span class="section-number-4">23.1.1</span> go run -race *.go</h4>
<div class="outline-text-4" id="text-23-1-1">
<p>
-race is to detect data race
./compare.go
</p>
<pre class="example">
package main
import (...)
func f1
func f2
</pre>

<p>
./main.go
</p>
<pre class="example">
package main
import (...)
func main() {
  f1()
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcd79cb8" class="outline-3">
<h3 id="orgcd79cb8"><span class="section-number-3">23.2</span> Syntax, Program Flow</h3>
<div class="outline-text-3" id="text-23-2">
<p>
Opening and closing brackets have to be in one line
</p>
<pre class="example">
// for ... {
// } else if x ==0 {
// } else {
</pre>

<p>
Define variable in block
</p>
<pre class="example">
if x :=-42; x &lt; 0 {
  // x will only be available in the if block
}
</pre>

<p>
Switch
</p>
<pre class="example">
import (
  "math/rand"
  "time"
)

rand.Seed(time.Now().Unix())

result := ""

switch dow := rand.Intn(6) + 1; dow {
// between 0 and 6. Result is between 1 and 7
  case 1:
    result = "Sunday!"
  case 7:
    result = "Saturday!"
  default:
    result = "Weekday!"
}
fmt.Println(result)

// Conditional expression in switch!
x := -42;
switch {
  case x &lt; 0:
    result = "Less than zero"
  case x == 0:
    result = "Equal to zero"
  default:
    result = "Greater than zero"
}
// By default, it breaks and goes to the end of switch if there's one case matched.
// break is not necessary but `fallthrough` replaces `break` in an opposite way
</pre>

<p>
for
</p>
<pre class="example">
sum = 0
for i := 0; i &lt; 10; i++ {
  sum += i
}

for sum &lt; 1000 {
 sum += sum
 fmt.Println(sum)
 if sum &gt; 200 {
   goto endofprogram
 }
}

endofprogram : fmt.Println("end of program")
// Use `break` or `continue` statements just like other language
</pre>
</div>
</div>

<div id="outline-container-orga0629a1" class="outline-3">
<h3 id="orga0629a1"><span class="section-number-3">23.3</span> Standard Library of packages</h3>
<div class="outline-text-3" id="text-23-3">
</div>
<div id="outline-container-orgc5a863b" class="outline-4">
<h4 id="orgc5a863b"><span class="section-number-4">23.3.1</span> builtin</h4>
<div class="outline-text-4" id="text-23-3-1">
<p>
<a href="http://golang.org/pkg/builtin/">http://golang.org/pkg/builtin/</a>
</p>
</div>

<div id="outline-container-org6dbf61e" class="outline-5">
<h5 id="org6dbf61e"><span class="section-number-5">23.3.1.1</span> new(), make()</h5>
<div class="outline-text-5" id="text-23-3-1-1">
<p>
new() :: Allocate but not initial memory. Results in 0 storage but return a memory address
make() :: Allocate and initialize memory. Results in non-zeroed storage and return a memory address
</p>

<p>
Zeroed storage means it can't accept value
</p>

<p>
Initialize complex objects before adding values. Declarations without make() can cause a panic
</p>
<pre class="example">
m := make(map[string]int)
m["key"] = 42
// map[key:42]
</pre>

<p>
Memory is deallocated by garbage collector (GC).
</p>

<p>
GC clears objects that are out of scope or set to nil
</p>
</div>
</div>
</div>

<div id="outline-container-orgb86a478" class="outline-4">
<h4 id="orgb86a478"><span class="section-number-4">23.3.2</span> fmt</h4>
<div class="outline-text-4" id="text-23-3-2">
</div>
<div id="outline-container-orgaff4996" class="outline-5">
<h5 id="orgaff4996"><span class="section-number-5">23.3.2.1</span> Output</h5>
<div class="outline-text-5" id="text-23-3-2-1">
<pre class="example">
package main
import (
  fmt
)
func main() {
  str1 := "one"
  str2 := "two"
  aNumber := 42
  // var aNumber int
  // default aNumber is zero
  // Implicit typing using :=
  isTrue := true

  // Explicit: const anInteger int = 42
  // Implicit const aString = ".."

  fmt.Println(str1, str2) // "one two"

  stringLength, err := fmt.Println(str1, str2)
  // function can return multiple values, a string and an error

  if err == nil {
    fmt.Println("String Length", stringLength)
  }

  // Without the if err == nil, it will throw an error because error is not defined
  // Use _ to ignore the err variable even if it's not returned
  stringLength, _ := fmt.Println(str1, str2)
  fmt.Println("String Length", stringLength)

  fmt.Printf("Value of aNumber: %v\n", aNumber)
  fmt.Printf("Value of isTrue: %v\n", isTrue)
  fmt.Printf("Value of aNumber as float: %.2f\n", float64(aNumber)) // 42.00
  fmt.Printf("Data types: %T, %T, %T, %T",
     str1, str2, aNumber, isTrue
  )
  // string, string, int, bool


  // Return a string
  myString := fmt.Sprintf("data types: %T, %T, %T, %T", str1, str2, aNumber, isTrue)
  fmt.Print(myString)
}
</pre>

<p>
%v :: only values
%+v :: add field names when printing struct
%#v :: add field names and name of the struct type when printing struct
%T :: type
%% :: literal %
</p>

<p>
Sprintf(format string, a &#x2026;interface{}) string :: format and return a string
Use this to convert a struct into string <code>str := fmt.Sprintf("%#v", val)</code>
</p>

<p>
Fprintf(w io.Writer, format string, a &#x2026;interface{}) (n int, err error)
</p>
</div>
</div>

<div id="outline-container-org14d5424" class="outline-5">
<h5 id="org14d5424"><span class="section-number-5">23.3.2.2</span> Input</h5>
<div class="outline-text-5" id="text-23-3-2-2">
<pre class="example">
import ("fmt")

func main() {
  var s1,s2 string
  fmt.Scanln(&amp;s1, &amp;s2)
  // Scan one line from terminal input, demilited by space
  fmt.Println(s1, s2)
}
</pre>

<pre class="example">
import (
  "fmt"
  "bufio"
  "os"
  "strconv"
  "strings"
)

func main() {
  // := is to declare and assign value to a new variable
  reader := bufio.NewReader(os.stdin)
  fmt.Print("Enter text: ")
  str, _ := reader.ReadString('\n')
  // Single quote means it's a byte not a string
  fmt.Print(str)
  // one two three

  fmt.Print("Enter text: ")
  str, _ = reader.ReadString('\n')
  f, err := strconv.ParseFloat(strings.TrimSpace(str), 64)
  if err != nill {
    fmt.Println(err)
  } else {
    fmt.Println("Value of number: ", f);
  }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd8d718a" class="outline-4">
<h4 id="orgd8d718a"><span class="section-number-4">23.3.3</span> strings</h4>
<div class="outline-text-4" id="text-23-3-3">
<p>
strings.ToUpper(str)
strings.Title(str) <i>/ Initial capped
strings.EqualFold(str1, str2) /</i> case-insensitive compare
<i>/ default == is case-sensitive
strings.Contains(str, "exp") /</i> true/false
</p>
</div>
</div>

<div id="outline-container-orgd99589b" class="outline-4">
<h4 id="orgd99589b"><span class="section-number-4">23.3.4</span> math</h4>
<div class="outline-text-4" id="text-23-3-4">
<pre class="example">
import (
  "fmt"
  "math/big"
  "math"
)
i1, i2, i3 := 12, 45, 68
intSum := i1 + i2 + i3 // Good!

f1, f2, f3 := 23.5, 65.1, 76.3
floatSum := f1 + f2 + f3 // Not good

var b1, b2, b3, bigSum big.Float
b1.SetFloat64(23.5)
b2.SetFloat64(65.1)
b3.SetFloat64(76.3)
bigSum.Add(&amp;b1, &amp;b2).Add(&amp;bigSum, &amp;b3)
fmt.Printf("BigSum = %.10g\n", &amp;bigSum)

circleradius := 15.5
circumference := circleRadius * math.Pi
fmt.Printf("Circumference: %.2f\n", circumference)
</pre>
</div>
</div>

<div id="outline-container-orgdc0e330" class="outline-4">
<h4 id="orgdc0e330"><span class="section-number-4">23.3.5</span> time</h4>
<div class="outline-text-4" id="text-23-3-5">
<pre class="example">
import (
  "fmt"
  "time"
)

t := time.Date(2009, time.November, 10, 23, 0,0,0, time.UTC)
now := time.Now()
fmt.Printf("Go launched at %s\n", t)
now.Month()
now.Day()
now.Weekday()

tomorrow := now.AddDate(0,0,1)

longFormat := "Monday, January 2, 2006"
fmt.Println("Tomorrow is ", tomorrow.Format(longFormat))

shortFormat := "1/2/06"

t := time.Now()

fmt.Printf("%d %02d %02d %02d %02d %02d\n",
t.Year(), t.Month(), t.Day(),
t.Hour(), t.Minute(), t.Second())
</pre>

<pre class="example">
start := time.Now()
// ...
end := time.Now()
delta := end.Sub(start)
// Or
fmt.Println(time.Since(start).Seconds())
</pre>
</div>
</div>

<div id="outline-container-org715ea6b" class="outline-4">
<h4 id="org715ea6b"><span class="section-number-4">23.3.6</span> sort</h4>
<div class="outline-text-4" id="text-23-3-6">
<p>
<a href="http://golang.org/pkg/sort">http://golang.org/pkg/sort</a>
</p>
</div>
</div>

<div id="outline-container-org4ba581e" class="outline-4">
<h4 id="org4ba581e"><span class="section-number-4">23.3.7</span> io, os, path</h4>
<div class="outline-text-4" id="text-23-3-7">
<pre class="example">
import (
  "io"
  "os"
  "io/ioutil"
  "path/filepath"
)

func main() {
  content := "Hello from Go!"
  file, err :=os.Create("./fromString.txt")
  checkError(err)

  defer file.Close()

  ln, err := io.WriteString(file, content)

  checkError(err)

  fmt.Printf("All done with file of %v characters", ln)

  // convert a string to binary
  bytes := []byte(content)
  // 0644 is file permission
  ioutil.WriteFile("./fromBytes.txt", bytes, 0644)

  // Read a file
  fileName := "./hello.txt"
  // read as binary
  content, err := ioutil.ReadFile(fileName)
  checkError(err) 
  // binary/byte
  fmt.Println(content)
  result := string(content)
  fmt.Println(result)

  // Reader a directory
  root, _ := filepath.Abs(".")

  fmt.Println(root)

  err := filepath.Walk(root, processPath)
  checkError(err)

}

func checkError(err error) {
  if err != nil {
    // Stop if there's an error
    panic(err)
  }
}

func processPath(path string, info os.Fileinfo, err error) error {
  if err != nil {
    return err
  }

  // not root
  if path != "." {
    if info.IsDir() {
      fmt.Println("Directory:", path)
    } else {
      fmt.Println("File:", path)
    }
  }

  return nil
}
</pre>

<p>
Print OS environments
</p>
<pre class="example">
// To set a key/value pair, use `os.Setenv`. To get a
// value for a key, use `os.Getenv`. This will return
// an empty string if the key isn't present in the
// environment.
os.Setenv("FOO", "1")
fmt.Println("FOO:", os.Getenv("FOO"))
fmt.Println("BAR:", os.Getenv("BAR"))

// Use `os.Environ` to list all key/value pairs in the
// environment. This returns a slice of strings in the
// form `KEY=value`. You can `strings.Split` them to
// get the key and value. Here we print all the keys.
fmt.Println()
for _, e := range os.Environ() {
     pair := strings.Split(e, "=")
     fmt.Println(pair[0])
}
</pre>
</div>
</div>

<div id="outline-container-orgab1ec6e" class="outline-4">
<h4 id="orgab1ec6e"><span class="section-number-4">23.3.8</span> path/filepath</h4>
<div class="outline-text-4" id="text-23-3-8">
<pre class="example">
filepath.Walk("../images/", func(path string, info os.FileInfo, err error) {
  if info.IsDir() {
    return nil
  }
  fmt.Println(path)
  return nil
})
</pre>
</div>
</div>

<div id="outline-container-org9bce77f" class="outline-4">
<h4 id="org9bce77f"><span class="section-number-4">23.3.9</span> encoding/json, encoding/csv</h4>
<div class="outline-text-4" id="text-23-3-9">
<p>
Refer to <a href="#org74e8a62">golang:net/http:json</a>
</p>
<pre class="example">
json.NewDecoder(r io.Reader) *Decoder
json.Unmarshal(data []byte, v interface{}) error

// convert any json string to struct
import ("encoding/json" "fmt" "reflect") 

var input = `
{
  "response_type": "in_channel",
  "text": "hello text",
  "attachments": [
    { "text": "attachment text" }
  ]
}
`
var val map[string]interface{}

if err := json.Unmarshal([]byte(input), $val); err != nil {
  panic(err)
}

fmt.Println(val)
// map[response_type:in_channel text:hello text attachments:[map[text:attachment text]]]
for k, v := range val {
  fmt.Println(k, reflect.TypeOf(v))
}
</pre>

<pre class="example">
import (
 "os"
 "encoding/csv"
)

f, err := os.Open("../abc.txt")
checkError(err)
defer f.Close()

rdr := csv.NewReader(f)
rdr.Comma = '\t'
rdr.TrimLeadingSpace = true
rows, err := rdr.ReadAll()
checkError(err)
for i, row := range rows {
  fmt.Println(row[i])
}
</pre>
</div>
</div>

<div id="outline-container-orgc086190" class="outline-4">
<h4 id="orgc086190"><span class="section-number-4">23.3.10</span> log</h4>
<div class="outline-text-4" id="text-23-3-10">
<p>
Output to stdout
</p>

<pre class="example">
import ( "log" )
log.Println(string(body))
</pre>

<p>
Write to os.Stdout os.Stderr
</p>
<pre class="example">
import (
"io"
"io/ioutil"
"log"
"os"
)
var (
  Trace *log.Logger
  Info *log.Logger
  Warning *log.Logger
  Error *log.Logger
)
func Init(
  traceHandle io.Writer,
  infoHandle io.Writer,
  warningHandle io.Writer,
  errorHandle io.Writer) {
  Trace = log.New(traceHandle, 
     "TRACE: ",
     log.Ldate|log.Ltime|log.Lshortfile)

  Info = log.New(infoHandle, 
     "INFO: ",
     log.Ldate|log.Ltime|log.Lshortfile)

  Warning = log.New(warningHandle, 
     "WARNING: ",
     log.Ldate|log.Ltime|log.Lshortfile)

  Error = log.New(errorHandle, 
     "ERROR: ",
     log.Ldate|log.Ltime|log.Lshortfile)

  // log.New(out io.Writer, prefix string, flag int)
}

func main() {
  // system devices that support io.Writer interface
  Init(ioutil.Discard, os.Stdout, os.Stdout, os.Stderr)

  // write to stdout
  Info.Pringln("...")
}
</pre>

<p>
Write to file
</p>
<pre class="example">
file, err := os.OpenFile("file.txt", os.O_CREATE|os.WRONLY|os.O_APPEND, 0666)
if err != nil {
  log.Fatalln("Failed to open log file", output, ":", err)
}

multi := io.MultiWriter(file, os.Stdout)

MyFile := log.New(multi,
       "PREFIX: ",
       log.Ldate|log.Ltime|log.shortfile)
</pre>

<p>
log.Fatalln("&#x2026;") same as Println() but followed by a call to os.Exit(1)
log.Panicln() same as Println() but followed by panic()
</p>
</div>
</div>

<div id="outline-container-orgde312ed" class="outline-4">
<h4 id="orgde312ed"><span class="section-number-4">23.3.11</span> os/exec</h4>
<div class="outline-text-4" id="text-23-3-11">
</div>
<div id="outline-container-org917e32c" class="outline-5">
<h5 id="org917e32c"><span class="section-number-5">23.3.11.1</span> Basics</h5>
<div class="outline-text-5" id="text-23-3-11-1">
<pre class="example">
import (
  "fmt"
  "os"
  "os/exec"
)

func main() {
  cmd := "curl"
  args := []string{"https://..."}

  /* if command contains wildecard *
     exec.Command("/bin/sh", "-c", "mv ./source_dir/* ./dest_dir")
   */

  // Simply run
  if err := exec.Command(cmd, args...).Run(); err != nil {
    fmt.Println(os.Stderr, err)
    os.Exit(1)
  }
  fmt.Println("Success!")
  // Simply run.

  // Run and catch STDOUT
  var (
    cmdOut []byte
    err error
  )

  if cmdOut, err = exec.Command(cmd, args...).Output(); err != nil {
    fmt.Fprintln(os.Stderr, "An error: ", err)
    os.Exit(1)
  }

  result := string(cmdOut)
  // Run and catch STDOUT

  // Catch output line by line as a stream
  // Use cmd.Start() and cmd.Wait()
  // Catch stdout by adding pipe

  cmd2 := exec.Command(cmd, args...)
  cmdReader, err := cmd2.StdoutPipe()
  if err != nil {
    fmt.Fprintln(os.Stderr, "Error creating StdoutPipe for cmd", err)
    os.Exit(1)
  }

  // import "bufio"
  scanner := bufio.NewScanner(cmdReader)
  go func() {
    for scanner.Scan() {
      fmt.Printf("Output header | %s\n", scanner.Text())
    }
  }()

  err = cmd2.Start()
  if err != nil {
    fmt.Fprintln(os.Stderr, "Error starting Cmd", err)
  }

  err = cmd2.Wait()
  if err != nil {
    fmt.Fprintln(os.Stderr, "Error waiting for Cmd", err)
    os.Exit(1) 
  }
  // Catch output line by line as a stream.
}
</pre>
</div>
</div>

<div id="outline-container-orgab2160a" class="outline-5">
<h5 id="orgab2160a"><span class="section-number-5">23.3.11.2</span> SSH command</h5>
<div class="outline-text-5" id="text-23-3-11-2">
<pre class="example">
type SSHCommander struct {
        User string
        IP   string
}

func (s *SSHCommander) Command(cmd ...string) *exec.Cmd {
        arg := append(
                []string{
                        fmt.Sprintf("%s@%s", s.User, s.IP),
                },
                cmd...,
        )
        return exec.Command("ssh", arg...)
}

func main() {
        commander := SSHCommander{"root", "50.112.213.24"}

        cmd := []string{
                "apt-get",
                "install",
                "-y",
                "jq",
                "golang-go",
                "nginx",
        }

        if err := commander.Command(cmd...); err != nil {
                fmt.Fprintln(os.Stderr, "There was an error running SSH command: ", err)
                os.Exit(1)
        }
}
</pre>
</div>
</div>

<div id="outline-container-org623070e" class="outline-5">
<h5 id="org623070e"><span class="section-number-5">23.3.11.3</span> Cmd</h5>
<div class="outline-text-5" id="text-23-3-11-3">
<p>
Customize a command before it gets run by Run, Output or CombinedOutput methods
</p>
<pre class="example">
cmd := "git"
args := []string{"status"}

cmd2 := exec.Command(cmd, arg...)
// Working directory otherwise is the process's current dir
cmd2.Dir = "/home/user/"
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc9ad966" class="outline-4">
<h4 id="orgc9ad966"><span class="section-number-4">23.3.12</span> net/http</h4>
<div class="outline-text-4" id="text-23-3-12">
</div>
<div id="outline-container-org22ce0e9" class="outline-5">
<h5 id="org22ce0e9"><span class="section-number-5">23.3.12.1</span> HTTP request</h5>
<div class="outline-text-5" id="text-23-3-12-1">
<pre class="example">
resp, err := http.Get("http://example.com/")
...
resp, err := http.Post("http://example.com/upload", "image/jpeg", &amp;buf)
...
resp, err := http.PostForm("http://example.com/form",
        url.Values{"key": {"Value"}, "id": {"123"}})
</pre>

<pre class="example">
import (
  "io/ioutil"
  "net/http"
  "encoding/json"
  "strings"
  "math/big"
)

type Tour struct {
  Name, Price string
}

func main() {
  url := "http://..."
  resp, err := http.Get(url)
  checkError(err)
  fmt.Printf("Response type: %T\n", resp)

  // Important!!!
  defer resp.Body.Close()

  bytes, err := ioutil.ReadAll(resp.body)
  checkError(err)
  content := string(bytes)
  fmt.Pritnln(content)

  tours := toursFromJson(content)
  fmt.Println(tours)

  for _, tour := range tours {
    // price is a string and convert to float
    price, _, _ := big.ParseFloat(tour.Price, 10, 2, big.ToZero)
    fmt.Printf("%v $%.2f\n", tour.Name, price)
  }
}

func toursFromJson(content string) []Tour {
  tours := make([]Tour, 0, 20)

  decoder := json.NewDecoder(strings.NewReader(content))

  _, err := decoder.Token()
  checkError(err)

  var tour Tour
  for decoder.More() {
    err := decoder.Decode(&amp;tour)
    checkError(err)
    tours = append(tours, tour)
  }

  return tours
}

</pre>

<p>
HTTP POST json
</p>
<pre class="example">
tmp := `{"text": "delayed response", "attachments": [{ "text": "test"}]}`
// or
// tmp, err := json.Marshal(myStruct)
req := bytes.NewBuffer([]byte(tmp))
resp, err := http.Post(sc.ResponseURL, "application/json", req)
checkError(err)
body, _ := ioutil.ReadAll(resp.Body)
fmt.Println(string(body))
</pre>
</div>
</div>

<div id="outline-container-org3dc4c32" class="outline-5">
<h5 id="org3dc4c32"><span class="section-number-5">23.3.12.2</span> HTTP server</h5>
<div class="outline-text-5" id="text-23-3-12-2">
</div>
<ol class="org-ol">
<li><a id="orgaf530d3"></a>Use http.Handle<br />
<div class="outline-text-6" id="text-23-3-12-2-1">
<pre class="example">
import (
  "fmt"
  "net/http"
  "html/template"
)

// default Handler
type Hello struct{}

// Implement handler that is an interface
func (h Hello) ServeHTTP(w http.ResponseWriter, r *http.Request) {
  fmt.Fprintf(w, "&lt;h1&gt;hello&lt;/h1&gt;")
}

// func Handle(pattern string, handler Handler)
// type Handler interface {
//  ServeHTTP(resp, *request)
// }

func main() {
  var h Hello
  err := http.ListenAndServe(":4000", h)
  // addr string, handler Handler
  // if handler is nil, DefaultServeMux is used
  // or localhost:4000 (only localhost:4000 listens. multiple domain, non localhost, can be resolved to the same server)
  checkError(err)
}
</pre>
</div>
</li>

<li><a id="org9becbdc"></a>Use http.HandleFunc<br />
<div class="outline-text-6" id="text-23-3-12-2-2">
<pre class="example">
// HandleFunc add handlers to DefaultServeMux
http.HandleFunc("/", func(w http.ResponseWriter, r *http.Request) {
  fmt.Fprintf(w, "hello html")
})

fmt.Println(http.ListenAndServe(":4000", h))
checkError(err)
</pre>
</div>
</li>

<li><a id="org9eccc51"></a>Template<br />
<div class="outline-text-6" id="text-23-3-12-2-3">
<pre class="example">
import "html/template"

type Page struct {
  Name string
}

func main() {
  templates := template.Must(template.ParseFiles("templates/index.html"))

  http.HandleFunc("/", func(w http.ResponseWriter, r *http.Request) {
    p := Page{Name: "Gopher"}

    if err := templates.ExecuteTemplate(w, "index.html", p); err !=  nil {
      http.Error(w, err.Error(), http.StatusInternalServerError)
    }
  })
}
</pre>

<p>
index.html
</p>
<pre class="example">
{{.Name}}
</pre>
<p>
If url.name is defined, then that will be displayed
</p>
</div>
</li>

<li><a id="org04b4bef"></a>Read POST data<br />
<ol class="org-ol">
<li><a id="org38bb0d0"></a>Content-Type json <a id="org74e8a62">golang:net/http:json</a><br />
<div class="outline-text-7" id="text-23-3-12-2-4-1">
<pre class="example">
type test_struct struct {
  Test string
  IsNew bool // JSON booleans
  Age float64 // JSON numbers
  myArray []interface{} // JSON arrays
  myObj map[string]interface{} // JSON objects
  isNull nil // JSON null
}

func test(w http.ResponseWriter, r *http.Request) {
  // Read body as a whole
  body, err := ioutil.ReadAll(r.Body)
  checkError(err)
  log.Println(string(body))

  //decoder := json.NewDecoder(r.Body)
  var t test_struct
  err = json.Unmarshal(body, &amp;t)
  checkError(err)
  fmt.Fprintf(w, t.Test)

  // Get Header
  if a := r.Header.Get("x-hub-signature"); len(a) == 0 {
    panic()
  }

}

func main() {
  http.HandleFunc("/test", test)
}
</pre>

<p>
See <a href="#orgd830136">linux:curl:post</a>
</p>
</div>
</li>

<li><a id="orge76067e"></a>Content-Type:application/x-www-form-urlencoded<br />
<div class="outline-text-7" id="text-23-3-12-2-4-2">
<pre class="example">
r.ParseForm()
r.Form.Get("key")
res := r.FormValue("&lt;your param name&gt;")
</pre>
</div>
</li>

<li><a id="orgc769395"></a>Return Json as application/json<br />
<div class="outline-text-7" id="text-23-3-12-2-4-3">
<pre class="example">
func testjson(w http.ResponseWriter, r *http.Request) {
  body, err := ioutil.ReadAll(r.Body)
  checkError(err)
  type slackResponse struct {
    ResponseType string `json:"response_type"`
    Text string `json:"text"`
    Attachments []map[string]string `json:"attachments"`
  }
  a2 := []map[string]string{map[string]string{"text": string(body)}}
  resp := slackResponse{"in_channel", a2}
  js, err := json.Marshal(resp)
  checkError(err)
  w.Header().Set("Content-Type", "application/json")
  w.Write(js)

  /* Or you can just output a json string
  var p = `{
  "response_type": "in_channel",
  "attachments": [
     {  "text": "%s" }
   ]
}`
   resp := fmt.Sprintf(p, string(body))
   w.Header().Set("Content-Type", "application/json")
   fmt.Fprintf(w, resp)
  */

}
func main() {
  http.HandleFunc("/json", testjson)
}
</pre>

<p>
More complicated value `attachments`
</p>
<pre class="example">
// this is the json to construct
// {"response_type":"in_channel","text":"hello text","attachments":[{"text":"attachment text"},{"text2":{"name":"hello"}}]}

type Profile struct {
        Response_type string `json:"response_type"`
        Text          string `json:"text"`
        Attachments []interface{} `json:"attachments"`
}

func main() {
        a2 := make([]interface{}, 2)
        a2[0] = map[string]string{"text": "attachment text"}
        a2[1] = map[string]map[string]string{"text2": map[string]string{"name": "hello"}}
        profile := Profile{"in_channel", "hello text", a2}
        js, err := json.Marshal(profile)
        checkError(err)
        fmt.Println(string(js))
        str := fmt.Sprintf("%#v", profile)
        fmt.Println(str)
}
</pre>
</div>
</li>
</ol>
</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org3ae5abe" class="outline-3">
<h3 id="org3ae5abe"><span class="section-number-3">23.4</span> Custom package, Third Party Package</h3>
<div class="outline-text-3" id="text-23-4">
<p>
For third-party packages, godoc.org and github.com/avelino/awesome-go
<a href="https://www.lynda.com/Go-tutorials/What-you-should-know-before-watching-course/439416/472998-4.html?srchtrk=index:1%0Alinktypeid:2%0Aq:go+language%0Apage:1%0As:relevance%0Asa:true%0Aproducttypeid:2">https://www.lynda.com/Go-tutorials/What-you-should-know-before-watching-course/439416/472998-4.html?srchtrk=index:1
linktypeid:2
q:go+language
page:1
s:relevance
sa:true
producttypeid:2</a>
$GOPATH/src/mypkg
</p>
<pre class="example">
package main
// define a package name.

// main() is the starting point in go run
func main() {
  n1, l1 := FullName("Zaphod", "Beeblerox")
}

// captital P means this method is public instead of private in this package
func Println() {
}

func addValues(value1 int, value2 int) int {
// can also be value1, value2 int
  return value1 + value2
}

func addAllValues(values ...int) int {
  sum := 0
  for i := range values {
    sum += values[i]
  }
  return sum
}

func FullName(f, l string) (string, int) {
  full := f + " " + l
  length := len(full)
  return full, length
}

func FullNameNakedReturn(f, l string) (full string, length int) {
  // The returned variables have already been declared
  // Don't use :=
  full = f + " " + l
  length = len(full)
  return
}

;; # mypkg.Println(...)

import (
  // github.com/username/reponame/foldername/example.go
  "github.com/username/reponame/foldername"
  // alias
  stdimage "image"
)

</pre>

<p>
All packages and codes should be under one go workspace which the folder at GOPATH.
Assuming GOPATH is ~/go in Windows installation.
</p>

<pre class="example">
cd ~/go
mkdir -p src/github.com
git clone ../gitusername/myreponame
~/go/src/github.com/gitusername/reponame/pkg1/pkg1.go
~/go/src/github.com/gitusername/reponame/pkg2/pkg2.go

;; # build all necessary packages
go get github.com/gitusername/reponame/...
;; # ~/go/bin/pkg1 (executable)
;; # ~/go/bin/pkg2 (executable)

;; # Build one package
go get github.com/gitusername/reponame/pkg1/...
;; # ~/go/bin/pkg1 (executable)

;; # At ~/go/src/github.com/gitusername/reponame, run this to see if there's compile error
go build ...

;; # At ~/go/src/github.com/gitusername/reponame, run this to format all .go files
go fmt ./...
</pre>
</div>
</div>

<div id="outline-container-org4baffff" class="outline-3">
<h3 id="org4baffff"><span class="section-number-3">23.5</span> Types</h3>
<div class="outline-text-3" id="text-23-5">
</div>
<div id="outline-container-org85235fb" class="outline-4">
<h4 id="org85235fb"><span class="section-number-4">23.5.1</span> Basic</h4>
<div class="outline-text-4" id="text-23-5-1">
<p>
float32 float54
complex64 complex128
Integers:
 int8 int16 int32 int64
 only positive numbers and zero (unsigned): uint8 uint16 uint32 uint64
 byte uint int uintptr
</p>

<p>
Data collections:
 Arrays Slices Maps Structs
</p>

<p>
Language organization:
 Functions Interfaces Channels
</p>

<p>
Data management
 Pointers
</p>

<p>
Type conversion
</p>
<pre class="example">
var int1 int = 5
var float1 float64 = 42
var s := `{ "votes": { "option": "3"} }`
sum := float64(int1) + float1
// convert string to byte
bytevar := []byte(s)

// convert string array to string
stringArray := []string{"Hello","world","!"}
justString := strings.Join(stringArray," ")

// Convert string to float golang:strconv
f, err := strconv.ParseFloat(strings.TrimSpace(str), 64)

// Delcare only for multiple variables
var (
  count int
  sum float64
)

var a, b string
a, b := "", ""
</pre>
</div>
</div>

<div id="outline-container-orga20fc80" class="outline-4">
<h4 id="orga20fc80"><span class="section-number-4">23.5.2</span> array</h4>
<div class="outline-text-4" id="text-23-5-2">
<p>
Array can't be sorted or resized
</p>
<pre class="example">
var colors [3]string
colors[0] = "Red"
colors[1] = "Green"
fmt.Println(colors)
// [Red Green]
fmt.Println(colors[1])
// Green

// Define in one line
var numbers = [5]int{5,3,1,2,4}

// Array length
// len(colors)

for i := 0; i &lt; len(colors); i++ {
  fmt.Println(colors[i])
}

for i := range colors {
  fmt.Pritnln(colors[i])
}
</pre>
</div>
</div>

<div id="outline-container-org5b65f96" class="outline-4">
<h4 id="org5b65f96"><span class="section-number-4">23.5.3</span> slice</h4>
<div class="outline-text-4" id="text-23-5-3">
<p>
slice is built on top of array
</p>
<pre class="example">
var colors = []string{"Red", "Green", "Blue"}
fmt.Println(colors)
// The same as array

// Add item to end of slice
colors = append(colors, "Purple")
// Remove the first item in slice
colors = append(colors[1:len(colors)])
// Below is the same to remove the firs item in slice
// as the default on the right of : is the length of the slice
colors = append(colors[1:])
// Remove the last item in slice
// the default on the left of : is 0
colors = append(colors[:len(colors)-1])

// Declare a slice using make
numbers := make([]int, 5, 10)
// 5 is inital size, 10 is capacity (optional)
// Current capacity cap(numbers)
// Define 5 values, then add another item, 
numbers = append(numbers, 123)
// cap(numbers) is 2+10 = 12

// import("sort")
sort.Ints(numbers) // ascending
</pre>
</div>
</div>

<div id="outline-container-orgb9c353f" class="outline-4">
<h4 id="orgb9c353f"><span class="section-number-4">23.5.4</span> map</h4>
<div class="outline-text-4" id="text-23-5-4">
<p>
Map is an unorderd collection of key-value pairs
</p>

<pre class="example">
states := make(map[string]string)
// empty: map[]
states["WA"] = "Washington"
states["OR"] = "Oregon"
// map[WA:Washington OR:Oregon]

delete(states, "OR")

for k, v := range states {
  fmt.Printf("%v: %v\n", k, v)
}

// create a slice to hold keys of a map
keys :=make([]string, len(states))
i := 0
for k := range states {
  keys[i] = k
  i++
}

sort.Strings(keys)

for i := range keys {
  fmt.Println(states[keys[i]])
}
</pre>
</div>
</div>

<div id="outline-container-orgf5fa869" class="outline-4">
<h4 id="orgf5fa869"><span class="section-number-4">23.5.5</span> struct, interface</h4>
<div class="outline-text-4" id="text-23-5-5">
<p>
Struct is a data structure. Similar to Java's classes: encapsulate data and methods. No inheritance.
</p>

<p>
Every value in Go is an instance of a type, and every type is an implementation of at least one interface, the interface without any methods.
</p>

<p>
You may see function like this.
</p>
<pre class="example">
func Errorf(format string, a ...interface{}) {}

// ...interface{} means it can be multiple values of all types
</pre>

<pre class="example">
type Dog struct {
  Breed string
  Weight int
  Sound string
}

// Define method for a Struct
func (d Dog) Speak() {
  // d is a reference (copy) of the original object
  // changing d here doesn't affect the variable in global scope
  fmt.Println(d.Sound)
}

func (d *Dog) SpeakThreeTimes() {
  // d is a point to the original object
  // Changing d here also changes the variable in global scope
  d.Sound = fmt.Sprintf("%v! %v! %v!", d.Sound, d.Sound, d.Sound)
  fmt.Println(d.Sound)
}

// Define an interface
type Animal interface {
  SpeakWord() string
}

func (d Dog) Speak() string {
  return "Woof!"
}

// Attach interface to other class

type Cat struct {
  // ...
}

func (c Cat) Speak() string {
  return "Meow!"
}

func main() {
  poodle := Dog{"Poodle", 34, "Woof"}
  // fmt.Println(poodle)
  // {Poodle, 34, Woof}

  // dump field name and values
  fmt.Printf("%+v\n", poodle)
  // {Breed:Poodle Weight:34 Sound:Woof}

  poodle.Sound = "Arf"

  poodle.Speak()

  poodle2 := Animal(Dog{})
  // This dog has an interface!
  // Or this dog is converted to interface Animal
  fmt.Println(poodle2)

  // Attach interface to multiple objects of different types
  animals := []Animal{Dog{}, Cat{}}
  for _, animal := range animals {
    // _ means to throw away the index
    fmt.Println(animal.Speak())
  }

}
</pre>
</div>
</div>

<div id="outline-container-org68738c1" class="outline-4">
<h4 id="org68738c1"><span class="section-number-4">23.5.6</span> pointer</h4>
<div class="outline-text-4" id="text-23-5-6">
<pre class="example">
// craete a pointer
var p *int
if p != nil {
  fmt.Println(*p)
} else {
  fmt.Println("p is nil")
}

var v int = 42
p = &amp;v
// explict
var value1 float64 = 42.13
pointer1 := &amp;value1
fmt.Println(*p)

*pointer1 = *pointer1 / 42
// both value1
fmt.Println(*pointer, value1)
</pre>
</div>
</div>

<div id="outline-container-org7cfe0c9" class="outline-4">
<h4 id="org7cfe0c9"><span class="section-number-4">23.5.7</span> error</h4>
<div class="outline-text-4" id="text-23-5-7">
<pre class="example">
import "errors"

myError := errors.New("My error string")
fmt.Println(myError)
// str := myError.Error()

attendance := map[string]bool{
  "Ann": true,
  "Mike": true}

attended, ok := attendance["Mike"]
if ok {
  // do things  
} else {
  // return error
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org0af0273" class="outline-3">
<h3 id="org0af0273"><span class="section-number-3">23.6</span> Concurrency</h3>
<div class="outline-text-3" id="text-23-6">
<pre class="example">

// Avoid race condition
var mu sync.Mutex
var wg sync.WaitGroup
wg.Add(len(paths))

for _, path := range paths {
  go func(path string) {
    pixels := getPixels(path)
    mu.Lock()
    {
      images = append(images, pixels)
    }
    mu.Unlock()
    wg.Done()
  }(path)
}
</pre>
</div>
</div>

<div id="outline-container-org86ca163" class="outline-3">
<h3 id="org86ca163"><span class="section-number-3">23.7</span> Structure</h3>
<div class="outline-text-3" id="text-23-7">
<pre class="example">
;; # $GOPATH
./src/libraries
./src/palindrome
./src/stringutil

;; # Go to the directory that has a go file that has main() function
;; # and run go install
</pre>

<p>
Defer
defer keyword only works within a function
Deferred statements are FILO and are run at the end of the current function, 
rather than waiting for the entire application
Good for disconnect database
</p>
<pre class="example">
defer fmt.Println("Statement 1")
defer fmt.Println("Statement 2")
defer fmt.Println("Statement 3")
defer fmt.Println("Undeferred statement")
// Undeferred statement, 3, 2, 1
</pre>
</div>
</div>

<div id="outline-container-orgbb8f39f" class="outline-3">
<h3 id="orgbb8f39f"><span class="section-number-3">23.8</span> Shrink compiled binary file size</h3>
<div class="outline-text-3" id="text-23-8">
<pre class="example">
;; # same as go get, go install
go build -ldflags="-s -w" cmd/go
</pre>

<p>
It strips the DWARF tables needed for debugging, but keeps the annotations needed for stack traces (also panic as well)
</p>

<p>
Then use <a href="#orgbf0a554">linux:upx</a> to further compress it.
</p>
</div>
</div>

<div id="outline-container-orga876e57" class="outline-3">
<h3 id="orga876e57"><span class="section-number-3">23.9</span> Project <a id="orge8aa17c">project:golang</a></h3>
<div class="outline-text-3" id="text-23-9">
</div>
<div id="outline-container-org3bd5901" class="outline-4">
<h4 id="org3bd5901"><span class="section-number-4">23.9.1</span> Github Webhook</h4>
<div class="outline-text-4" id="text-23-9-1">
<p>
main.go
</p>
<pre class="example">
package main

import (
        "fmt"
        "net/http"
        "io/ioutil"
        "os"
        "os/exec"
        "log"
        "crypto/hmac"
        "crypto/sha1"
        "encoding/hex"
        "encoding/json"
        "errors"
        "strings"
)

type test_struct struct {
        Repository map[string]interface{}
}

type GitHubHookContext struct {
        Signature string
        Event string
        Id string
        Payload []byte
}

type CIFolder struct {
        repo string
        Path string
}

func checkError(err error) {
        if err != nil {
                panic(err)
        }
}

func signBody(secret, body []byte) []byte {
        computed := hmac.New(sha1.New, secret)
        computed.Write(body)
        return []byte(computed.Sum(nil))
}

func verifySecret(secret []byte, signature string, body []byte) bool {

        const signaturePrefix = "sha1="
        const signatureLength = 45 // len(SignaturePrefix) + len(hex(sha1))

        if len(signature) != signatureLength || !strings.HasPrefix(signature, signaturePrefix) {
                return false
        }

        actual := make([]byte, 20)
        hex.Decode(actual, []byte(signature[5:]))

        return hmac.Equal(signBody(secret, body), actual)
}

func ParseGitHubHookContext(secret []byte, r *http.Request) (*GitHubHookContext, error) {

        hc := GitHubHookContext{}

        if hc.Signature = r.Header.Get("x-hub-signature"); len(hc.Signature) == 0 {
                return nil, errors.New("No signature!")
        }
        log.Println("Signature: ", hc.Signature)

        if hc.Event = r.Header.Get("x-github-event"); len(hc.Event) == 0 {
                return nil, errors.New("No event!")
        }
        log.Println("Event: ", hc.Event)

        if hc.Id = r.Header.Get("x-github-delivery"); len(hc.Id) == 0 {
                return nil, errors.New("No event Id!")
        }
        log.Println("ID: ", hc.Id)

        body, err := ioutil.ReadAll(r.Body)
        if err != nil {
                return nil, err
        }

        if !verifySecret(secret, hc.Signature, body) {
                return nil, errors.New("Invalid signature")
        }

        hc.Payload = body
        return &amp;hc, nil
}

func pullGitHub(path string) {
        var args []string
        args = []string{"reset", "--hard"}
        runCommands(path, "git", args, "git reset error: ")
        args = []string{"clean", "-df"}
        runCommands(path, "git", args, "git clean error: ")
        args = []string{"checkout", "master"}
        runCommands(path, "git", args, "git checkout master error: ")
        args = []string{"pull"}
        runCommands(path, "git", args, "git pull error: ")
}

func runCommands(path string, cmd string, args []string, msg string) {
        var (
                cmdOut []byte
                err error
        )
        outputArgs := strings.Join(args, " ")
        log.Println("Running ", cmd, outputArgs)
        actual := exec.Command(cmd, args...)
        actual.Dir = path
        if cmdOut, err = actual.Output(); err != nil {
                log.Println(os.Stderr, msg, err)
                os.Exit(1)
        }

        log.Println(string(cmdOut))
}

func main() {
        http.HandleFunc("/", func(w http.ResponseWriter, r *http.Request) {
                secret := os.Getenv("GB_WEBHOOK_KEY")
                hc, err := ParseGitHubHookContext([]byte(secret), r)
                if err != nil {
                        log.Printf("Failed processing hook! ('%s')", err)
                        panic(err)
                } else {

                        if hc.Event == "push" {
                                //log.Println(string(hc.Payload))
                                var t test_struct
                                err = json.Unmarshal(hc.Payload, &amp;t)
                                checkError(err)

                                switch reponame := t.Repository["full_name"]; reponame {
                                case "NewcomDev/nodejs":
                                        pullGitHub("/home/newcom/www/nodejs-dev")
                                }

                        }
                }

                fmt.Fprintf(w, "hello html")
                //out := fmt.Sprintf("%#v", r.URL)
                //fmt.Fprintf(w, out)
        })

        fmt.Println(http.ListenAndServe(":49162", nil))
}
</pre>

<pre class="example">
sudo docker run -it --rm --name testgo -v /home/newcom/digitalocean/docker/newcomgo:/go golang:1.8 /bin/bash -I
;; # Inside Golang
go build main.go

;; # Go to project folder
./main
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc1b817b" class="outline-3">
<h3 id="orgc1b817b"><span class="section-number-3">23.10</span> To Learn</h3>
<div class="outline-text-3" id="text-23-10">
<p>
Concurrency in Go
Goroutine
</p>
<ul class="org-ul">
<li>a lightweight synchronized thread managed by the runtime</li>
</ul>
<p>
Channel
</p>
<ul class="org-ul">
<li>a typed conduit for msgs between goroutines</li>
</ul>
<p>
Select
</p>
<ul class="org-ul">
<li>Lets a goroutine wait for multiple communication operations</li>
</ul>

<p>
Web Frameworks (REST)
</p>
<ul class="org-ul">
<li>Beego, Martini, Gorilla, Gocraft, Revel</li>
</ul>

<p>
Database Drivers
</p>
<ul class="org-ul">
<li>Standard db functions: database/sql</li>
<li>Driver interfaces: database/sql/driver</li>
<li><a href="https://github.com/golang/go/wiki/SQLDrivers">https://github.com/golang/go/wiki/SQLDrivers</a></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org91cffc7" class="outline-2">
<h2 id="org91cffc7"><span class="section-number-2">24</span> Vagrant</h2>
<div class="outline-text-2" id="text-24">
</div>
<div id="outline-container-org8cdbdac" class="outline-3">
<h3 id="org8cdbdac"><span class="section-number-3">24.1</span> Install</h3>
<div class="outline-text-3" id="text-24-1">
<p>
Install Oracle VM Virtualbox first
<a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a>
VirtualBox Oracle VM VirtualBox Extension Pack is needed
<a href="https://www.vagrantup.com/docs/virtualbox/">https://www.vagrantup.com/docs/virtualbox/</a>
VirtualBox version 5.0.x and 5.1.x are supported by Vagrant 1.x
</p>

<p>
Simply install the latest version of VirtualBox to upgrade
</p>

<p>
Error: "VT-x/AMD-V hardware acceleration is not available"
On Windows, check if Hyper-V is on by going to Windows Features.
Turn it off. As Windows takes over the hardware acceleration.
</p>

<p>
<code>optionalfeatures.exe</code> goes directly to Windows Features.
</p>

<p>
Then reboot and change UEFI or BIOS setting
</p>
<ul class="org-ul">
<li>name might be "Intel VT-x, VT-d, Virtualization Extensions, Vanderpool" under Chipset, Northbridge or CPU configuration.</li>
</ul>

<p>
Simply install the latest version to upgrade
<a href="https://www.vagrantup.com/downloads.html">https://www.vagrantup.com/downloads.html</a>
</p>

<pre class="example">
vagrant --version
;; # 1.x
where vagrant

;; # download image and create Vagrantfile
vagrant init hashicorp/precise64
vagrant up &amp;&amp; vagrant ssh
</pre>
</div>
</div>

<div id="outline-container-orgb5de0e9" class="outline-3">
<h3 id="orgb5de0e9"><span class="section-number-3">24.2</span> Vagrant VM, VirtualBox</h3>
<div class="outline-text-3" id="text-24-2">
<pre class="example">
;; # Status of all Vagrant VM's
vagrant global-status --prune

;; # List all running VirtualBox VMs
;; # vboxmanage.exe is not in PATH, change directory
cd /c/Program Files/Oracle/VirtualBox
vboxmanage list runningvms

;; # VirtualBox version
vboxmanage --version
</pre>
</div>
</div>

<div id="outline-container-org4ba8232" class="outline-3">
<h3 id="org4ba8232"><span class="section-number-3">24.3</span> Frequent commands</h3>
<div class="outline-text-3" id="text-24-3">
<pre class="example">
;; # force to run provision
vagrant up --provision
;; # or
vagrant reload --provision

;; # remove the current vagrant VM
vagrant destroy -f

;; # shut down and boot up
vagrant halt
vagrant up

;; # Hibernate
vagrant suspend

;; # Shut down and up
vagrant reload

;; # current vagrant vm running status
vagrant status

;; # Show current vagrant vm ssh config
vagrant ssh-config
;; # Usually it's 127.0.0.1:2222, notice the port may change as vagrant will auto select port if it's in use
</pre>
</div>
</div>

<div id="outline-container-org9a80617" class="outline-3">
<h3 id="org9a80617"><span class="section-number-3">24.4</span> Vagrantfile</h3>
<div class="outline-text-3" id="text-24-4">
<p>
ruby language
</p>
<pre class="example">
;; # -*- mode: ruby -*-
;; # vi: set ft=ruby :
ENV["LC_ALL"] = "en_US.UTF-8"
;; # In case host couldn't pass locale into vagrant

hostname = livagrantdev
cpus = 2
memory = 2048

@importmysql = &lt;&lt;SCRIPT
echo "docker run -it --rm -v /vagrant/mydbdump:/tmp/mydbdump"\
" --link wordpressdb:wpdb mysql:5.7.9 sh -c"\
" 'exec mysql"\
' -h"$WPDB_PORT_3306_TCP_ADDR" -P"$WPDB_PORT_3306_TCP_PORT"'\
' -uroot -p"$WPDB_ENV_MYSQL_ROOT_PASSWORD"'\
' wordpress &lt; /tmp/mydbdump/pantheon_db.sql'\
"'" &gt;&gt; /home/vagrant/import_db.sh
chmod +x /home/vagrant/import_db.sh
SCRIPT

Vagrant.configure(2) do |config|
;; # config.vm
        config.vm.box = username/boxname
;; # optional
;; # config.vm.box_version = "1.1.0"
;; # config.vm.box_url = "http://"

;; # hostname, appears when you vagrant ssh - vagrant@yourhostname
config.vm.hostname = hostname

;; # network
        config.vm.network "private_network", ip: "192.168.33.10"
;; # VMs in the the private network (VirtualBox) can communicate
;; # Give a static IP
        config.vm.network "forwarded_port", guest: 22, host: 2222, id: "ssh"
        config.vm.network "forwarded_port", guest: 80, host: 8080, auto_correct: true
;; # On local host (windows), 192.168.33.10:8080

;; # Synced folder
;; # default /vagrant
;; # Create a root folder (readonly) in guest machine to hold Dockerfiles for docker provisioner
;; # Create that folder if it doesn't exist in guest machine
        config.vm.synced_folder "./build/docker", "/docker_builds", create: true, mount_options: ["ro"]

        config.vm.provider "virtualbox" do |vb|
         vb.memory = memory
         vb.cpus = cpus
         vb.name = hostname
         # The name appears on VirtualBox GUI
         #  Can override any settings config.vm, config.ssh, config.winrm and config.vagrant
        end

;; # Provision
;; # Upload File using SSH user (vagrant)
        config.vm.provision "file", source: "~/.gitconfig", destination ".gitconfig"


;; # In line Shell
        config.vm.provision "shell", inline: @importmysql
;; # Path to script file Shell
;; # config.vm.provision "shell",

;; # Provisioner docker - install docker on the VM and pull images!
config.vm.provision "install_docker", type: "docker" do |d|
        d.pull_images "mysql:5.7.9"
        d.pull_images "wordpress"
;; # Need to create a root folder in guest machine to pull Dockerfile
        d.build_image "/docker_builds", args: "-t li-nginx-alpine -f /docker_builds/Dockerfile.li-nginx-alpine"
;; # This is the same as
;; # docker build -t li-nginx-alpine -f /docker_builds/Dockerfile.li-nginx-alpine /docker_builds/

end

;; # Provisioner docker_compose: install docker_compose on the VM!
;; # Require plugin `vagrant-docker-compose`
config.vm.provision "docker_compose_plugin", type: "docker_compose"

;; # config.ssh
;; # config.winrm
;; # config.vagrant

end
</pre>

<p>
Do a loop
</p>
<pre class="example">
(1..3).each do |i|
        config.vm.define "node-#{i}" do |node|
                node.vm.provision "shell",
                        inline: "echo hello from node #{i}"
        end
end
</pre>
</div>
</div>

<div id="outline-container-org5fb8eb4" class="outline-3">
<h3 id="org5fb8eb4"><span class="section-number-3">24.5</span> Vagrant plugin</h3>
<div class="outline-text-3" id="text-24-5">
<p>
Install vagrant-docker-compose plugin which installs Docker Compose as a provisioner 
<code>vagrant plugin install vagrant-docker-compose</code>
</p>

<p>
<a href="https://github.com/leighmcculloch/vagrant-docker-compose">https://github.com/leighmcculloch/vagrant-docker-compose</a>
</p>

<p>
Install vagrant-vbguest which automatically installs VirtualBox Guest Additions (VBGA) on Vagrant VM.
<code>vagrant plugin install vagrant-vbguest</code>
</p>

<p>
To prevent updating VBGA when <code>vagrant up</code>, add <code>config.vbguest.auto_update = false</code> in Vagrantfile. This happens when .box file has older version of vbguest while Vagrant on host has a newer version.
</p>

<p>
Update all installed plugins <code>vagrant plugin update</code>
</p>

<p>
List all installed plugins <code>vagrant plugin list</code>
</p>

<p>
Uninstall a plugin <code>vagrant plugin uninstall vagrant-docker-compose</code>
</p>

<p>
After Vagrant core is upgraded, you might need to auto upgrade existing plugins <code>vagrant plugin expunge --reinstall</code>
</p>

<p>
vagrant plugin install vagrant-docker-compose
</p>
<pre class="example">
Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/trusty64"

  config.vm.provision :docker
  config.vm.provision :docker_compose
end
</pre>
</div>
</div>

<div id="outline-container-orgb25222a" class="outline-3">
<h3 id="orgb25222a"><span class="section-number-3">24.6</span> Box</h3>
<div class="outline-text-3" id="text-24-6">
<p>
A VirtualBox, <code>.box</code> file, is a compressed box on top of which a VM can run.
Box has a namespace <code>username/boxname</code> as in <code>hashicorp/precise64</code>
</p>

<pre class="example">
;; # export the running VM to a new box file
vagrant package --output boxfile.box

;; # decompress a box file to ~/.vagrant.d/boxes
vagrant box add boxname boxfile.box

;; # boxname is an installed Vagrant box
;; # destroy current running Vagrant box
vagrant destroy -f
;; # and
rm Vagrantfile
;; # Setup another Vagrantfile which uses the newly created box
cofnig.vm.box = "boxname"

;; # To package an installed Vagrant box (of a specific provider and version)
;; # into a .box file
vagrant box repackage &lt;boxname&gt; &lt;provider&gt; &lt;version&gt;

;; # remove a vagrant box
vagrant box remove boxname
;; # or
vagrant box remove boxname --box-version=0.1.7

;; # List all installed Vagrant boxes
vagrant box list

;; # Check if the box used in the current folder is up-to-date
vagrant box outdated

;; # if it's not outdated and before destroy current Vagrant machine, update the box
vagrant box update
vagrant box update --box boxname
;; # Destroy the current Vagrant machine and up again.
</pre>

<p>
Vagrant .box should have these qualities:
</p>
<ul class="org-ul">
<li>vagrant as a user and map /vagrant to the current folder in host</li>
<li>be able to install as the Vagrant provision plugin instructs.</li>
</ul>

<p>
The ubuntu/xenial64 has a lot of trouble with that and hence it's not a good Vagrant box to start with.
</p>
</div>

<div id="outline-container-org3a62840" class="outline-4">
<h4 id="org3a62840"><span class="section-number-4">24.6.1</span> bento/ubuntu-16.04</h4>
<div class="outline-text-4" id="text-24-6-1">
<p>
vagrant box add bento/ubuntu-16.04
</p>
</div>
</div>
</div>

<div id="outline-container-org8b467b6" class="outline-3">
<h3 id="org8b467b6"><span class="section-number-3">24.7</span> Custom Box</h3>
<div class="outline-text-3" id="text-24-7">
<p>
<a href="https://github.com/levonlee/vagrant/tree/master/wordpress">https://github.com/levonlee/vagrant/tree/master/wordpress</a>
<a href="https://blog.engineyard.com/2014/building-a-vagrant-box">https://blog.engineyard.com/2014/building-a-vagrant-box</a>
<a href="https://scotch.io/tutorials/how-to-create-a-vagrant-base-box-from-an-existing-one">https://scotch.io/tutorials/how-to-create-a-vagrant-base-box-from-an-existing-one</a>
</p>
</div>
</div>

<div id="outline-container-orga551849" class="outline-3">
<h3 id="orga551849"><span class="section-number-3">24.8</span> SSH using Putty</h3>
<div class="outline-text-3" id="text-24-8">
<p>
Download PuttyGen to accept OpenSSH key as vagrant provides.
</p>

<p>
PuttyGen &gt; Load &gt; ~/.vagrant.d/ folder and select browse all files, select insecure_public_key
PuttyGen &gt; Save public key file as insecure_public_key.ppk and save it to the same folder. Close PuttyGen and go back to Putty
Putty &gt; Connection &gt; SSH &gt; Auth, browse and select that ppk file.
Connect using Putty!
</p>

<p>
Specify the username for login: Putty &gt; Connection &gt; Data &gt; Auto-login username
</p>

<p>
<code>/.vagrant.d/ is the global. Different box has ./.vagrant/ folder. Run ~vagrant ssh-config</code> to identify the $HOSTNAME $PORT $LOGINNAME
Convert the Identityfile to .ppk with SSH-2-RSA with 2048 bits and save it to the same folder.
</p>
</div>
</div>
</div>

<div id="outline-container-org8a6d88e" class="outline-2">
<h2 id="org8a6d88e"><span class="section-number-2">25</span> Apache</h2>
<div class="outline-text-2" id="text-25">
</div>
<div id="outline-container-org4ef2066" class="outline-3">
<h3 id="org4ef2066"><span class="section-number-3">25.1</span> Basics</h3>
<div class="outline-text-3" id="text-25-1">
<p>
Run this to get Apache version, root and config file <code>httpd -V</code> or <code>apache2 -v</code> in Ubuntu
</p>
</div>
</div>

<div id="outline-container-org2a700f8" class="outline-3">
<h3 id="org2a700f8"><span class="section-number-3">25.2</span> Config loading <a id="org04efc39">apache:config</a></h3>
<div class="outline-text-3" id="text-25-2">
<p>
apt-get update; apt-get install apache2
</p>

<p>
Refer to <a href="#orge1b9ac0">apache:config:main file</a>
</p>

<p>
Refer to <a href="#orgeebe557">image:php:apache</a> to get configs
</p>

<p>
Show compiled setting :: <code>apache2ctl -V</code> or <code>httpd -V</code> to look for HTTPD_ROOT and SERVER_CONFIG_FILE
</p>

<p>
Show parsed vhost settings and run settings :: <code>apache2ctl -S</code>
</p>
<pre class="example">
VirtualHost configuration:
*:80                   172.17.0.7 (/etc/apache2/sites-enabled/000-default.conf:1)

# run settings followed

ServerRoot: "/etc/apache2"
Main DocumentRoot: "/var/www/html"
Main ErrorLog: "/var/log/apache2/error.log"
Mutex default: dir="/var/lock/apache2" mechanism=fcntl
Mutex mpm-accept: using_defaults
Mutex watchdog-callback: using_defaults
Mutex rewrite-map: using_defaults
PidFile: "/var/run/apache2/apache2.pid"
Define: DUMP_VHOSTS
Define: DUMP_RUN_CFG
User: name="www-data" id=33
Group: name="www-data" id=33
</pre>
</div>

<div id="outline-container-org68182c4" class="outline-4">
<h4 id="org68182c4"><span class="section-number-4">25.2.1</span> Loaded Modules</h4>
<div class="outline-text-4" id="text-25-2-1">
<p>
Show all loaded modules :: <code>apache2ctl -M</code>
Sample loaded modules from <a href="#orgeebe557">image:php:apache</a>
</p>

<p>
You can also <code>ls -al /etc/apache2/mods-enabled</code>
</p>

<p>
autoindex deflate expires filter mime rewrite setenvif mpm_prefork 
</p>
</div>
</div>

<div id="outline-container-orge2f8986" class="outline-4">
<h4 id="orge2f8986"><span class="section-number-4">25.2.2</span> sites-enabled VirtualHost</h4>
<div class="outline-text-4" id="text-25-2-2">
<p>
Sites :: <i>etc/apache2/sites-enabled</i>
Sample for <a href="#orgeebe557">image:php:apache</a>
</p>

<pre class="example">
&lt;VirtualHost *:80&gt;
        # The ServerName directive sets the request scheme, hostname and port that
        # the server uses to identify itself. This is used when creating
        # redirection URLs. In the context of virtual hosts, the ServerName
        # specifies what hostname must appear in the request's Host: header to
        # match this virtual host. For the default virtual host (this file) this
        # value is not decisive as it is used as a last resort host regardless.
        # However, you must set it for any further virtual host explicitly.
        #ServerName www.example.com

        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/html

# You may add Directory here
# &lt;Directory /var/www/html&gt;
#   Options Indexes FollowSymLinks MultiViews
#   AllowOverride All
#   Order allow,deny
#   allow from all
# &lt;/Directory&gt;

        # Available loglevels: trace8, ..., trace1, debug, info, notice, warn,
        # error, crit, alert, emerg.
        # It is also possible to configure the loglevel for particular
        # modules, e.g.
        #LogLevel info ssl:warn

        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined

        # For most configuration files from conf-available/, which are
        # enabled or disabled at a global level, it is possible to
        # include a line for only one particular virtual host. For example the
        # following line enables the CGI configuration for this host only
        # after it has been globally disabled with "a2disconf".
        #Include conf-available/serve-cgi-bin.conf
&lt;/VirtualHost&gt;
</pre>
</div>
</div>

<div id="outline-container-orgd54b28e" class="outline-4">
<h4 id="orgd54b28e"><span class="section-number-4">25.2.3</span> Main Config files <a id="orge1b9ac0">apache:config:main file</a></h4>
<div class="outline-text-4" id="text-25-2-3">
<p>
Main config file :: /etc/apache2/apache2.conf /etc/httpd/httpd.conf /usr/local/apache/conf/httpd.conf
</p>

<p>
Run <a href="#org04efc39">apache:config</a> to get Apache root directory to find config location
</p>

<p>
You can see the *.conf files loading sequence
</p>
<pre class="example">
# include module config
IncludeOptional mods-enabled/*.load
IncludeOptional mods-enabled/*.conf

# include list of ports to listen on
Include ports.conf

# main config file config

# generic
IncludeOptional conf-enabled/*.conf
# virutal host config
IncludeOptional sites-enabled/*.conf
</pre>

<p>
Include <a href="https://github.com/h5bp/server-configs-apache/blob/master/dist/.htaccess">https://github.com/h5bp/server-configs-apache/blob/master/dist/.htaccess</a> inside &lt;Directory&gt; section.
</p>
</div>
</div>

<div id="outline-container-orgc0c4986" class="outline-4">
<h4 id="orgc0c4986"><span class="section-number-4">25.2.4</span> Restart <a id="orga6ec764">apache:restart</a></h4>
<div class="outline-text-4" id="text-25-2-4">
<p>
Check config before restart. Wrong config (e.g. SSL) may prevent Apache from starting
</p>

<p>
<code>apache2ctl configtest</code> or <code>apachectl configtest</code> or <code>httpd -t</code>
</p>

<p>
<code>/etc/init.d/apache2 reload</code> for apache that is initialized using command e.g. php apache docker container
Or <code>apache2ctl graceful</code> to stop and start httpd daemon. Also works for apache started using command line.
</p>

<p>
<code>apache2ctl restart</code> or <code>service apache2 restart</code> or <code>/etc/init.d/apache2 restart</code> or <code>service httpd restart</code>
</p>
</div>
</div>
</div>

<div id="outline-container-orgfdd122d" class="outline-3">
<h3 id="orgfdd122d"><span class="section-number-3">25.3</span> Modules</h3>
<div class="outline-text-3" id="text-25-3">
<p>
Available modules /etc/apache2/mods-available
Enabled modules   /etc/apache2/mods-enabled
</p>

<p>
Command line enable modules
</p>
<pre class="example">
a2enmod remoteip
# some modules need to load config. If don't specify, then the following modules don't need a3enconf

a2enconf remoteip
# apache:restart
</pre>
</div>

<div id="outline-container-orged61805" class="outline-4">
<h4 id="orged61805"><span class="section-number-4">25.3.1</span> remoteip</h4>
<div class="outline-text-4" id="text-25-3-1">
<p>
<a href="https://github.com/wichon/docker-php-maxmind-geoip/blob/master/Dockerfile">https://github.com/wichon/docker-php-maxmind-geoip/blob/master/Dockerfile</a>
</p>

<p>
When Nginx proxy Apache, Apache's remote_addr is the Nginx's IP (gateway of the current docker container)
</p>

<p>
Create remoteip.conf file under /etc/apache2/conf-available/remoteip.conf
</p>
<pre class="example">
RemoteIPHeader X-Forwarded-For
RemoteIPProxiesHeader X-Forwarded-By
</pre>

<pre class="example">
a2enmod remoteip &amp;&amp; a2enconf remoteip
apache:restart
</pre>
</div>
</div>

<div id="outline-container-org96fb9b1" class="outline-4">
<h4 id="org96fb9b1"><span class="section-number-4">25.3.2</span> mod_setenvif</h4>
<div class="outline-text-4" id="text-25-3-2">
<pre class="example">
&lt;IfModule mod_setenvif.c&gt;
    &lt;IfModule mod_headers.c&gt;
        &lt;FilesMatch "\.(bmp|cur|gif|ico|jpe?g|png|svgz?|webp)$"&gt;
            SetEnvIf Origin ":" IS_CORS
            Header set Access-Control-Allow-Origin "*" env=IS_CORS
        &lt;/FilesMatch&gt;
    &lt;/IfModule&gt;
&lt;/IfModule&gt;
</pre>
</div>
</div>

<div id="outline-container-orgc74c57f" class="outline-4">
<h4 id="orgc74c57f"><span class="section-number-4">25.3.3</span> mod_headers <a id="org1bc0ad4">apache:mod_headers</a></h4>
<div class="outline-text-4" id="text-25-3-3">
<p>
<a href="https://httpd.apache.org/docs/current/mod/mod_headers.html">https://httpd.apache.org/docs/current/mod/mod_headers.html</a>
It provides directives to control and modify HTTP request and response headers. Headers can be merged, replaced or removed.
</p>

<div class="org-src-container">
<pre class="src src-apache">&lt;<span style="color: #00ede1; font-weight: bold;">IfModule</span> mod_headers.c&gt;
    <span style="color: #ffad29; font-weight: bold;">Header</span> <span style="color: #34cae2;">set</span> Access-Control-Allow-Origin <span style="color: #e67128;">"*"</span>
&lt;/<span style="color: #00ede1; font-weight: bold;">IfModule</span>&gt;

&lt;<span style="color: #00ede1; font-weight: bold;">IfModule</span> mod_headers.c&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">FilesMatch</span> <span style="color: #e67128;">"\.(eot|otf|tt[cf]|woff2?)$"</span>&gt;
        <span style="color: #ffad29; font-weight: bold;">Header</span> <span style="color: #34cae2;">set</span> Access-Control-Allow-Origin <span style="color: #e67128;">"*"</span>
    &lt;/<span style="color: #00ede1; font-weight: bold;">FilesMatch</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">IfModule</span>&gt;
</pre>
</div>

<p>
<a id="org126b404">apache:mod_headers:cache</a> Refer to <a href="#org754d9a8">header:cache-control</a>, <a href="#orga1d37b6">php:header</a>
</p>
<div class="org-src-container">
<pre class="src src-apache">&lt;<span style="color: #00ede1; font-weight: bold;">filesMatch</span> <span style="color: #e67128;">"\.(html|htm|js|css)$"</span>&gt;
  <span style="color: #ffad29; font-weight: bold;">FileETag</span> <span style="color: #34cae2;">None</span>
  &lt;<span style="color: #00ede1; font-weight: bold;">ifModule</span> mod_headers.c&gt;
     <span style="color: #ffad29; font-weight: bold;">Header</span> <span style="color: #34cae2;">unset</span> ETag
     <span style="color: #ffad29; font-weight: bold;">Header</span> <span style="color: #34cae2;">set</span> Cache-Control <span style="color: #e67128;">"max-age=0, no-cache, no-store, must-revalidate"</span>
     <span style="color: #ffad29; font-weight: bold;">Header</span> <span style="color: #34cae2;">set</span> Pragma <span style="color: #e67128;">"no-cache"</span>
     <span style="color: #ffad29; font-weight: bold;">Header</span> <span style="color: #34cae2;">set</span> Expires <span style="color: #e67128;">"Wed, 11 Jan 1984 05:00:00 GMT"</span>
  &lt;/<span style="color: #00ede1; font-weight: bold;">ifModule</span>&gt;
&lt;/<span style="color: #00ede1; font-weight: bold;">filesMatch</span>&gt;
</pre>
</div>

<p>
<a id="org4bfb457">apache:mod_headers:header</a>
Syntax:	Header [condition] add|append|echo|edit|edit*|merge|set|setifempty|unset|note header [[expr=]value [replacement] [early|env=[!]varname|expr=expression]]
All <a href="#org548c090">apache:directive context</a>
</p>

<dl class="org-dl">
<dt><code>env=varname</code></dt><dd>applies if varname is defined</dd>
<dt><code>env=!varname</code></dt><dd>applies if varname is not defined</dd>
</dl>

<div class="org-src-container">
<pre class="src src-apache">&lt;<span style="color: #00ede1; font-weight: bold;">IfModule</span> mod_headers.c&gt;
    <span style="color: #ffad29; font-weight: bold;">Header</span> <span style="color: #34cae2;">unset</span> X-Powered-By
&lt;/<span style="color: #00ede1; font-weight: bold;">IfModule</span>&gt;
</pre>
</div>

<p>
Add flags for cookies
</p>
<div class="org-src-container">
<pre class="src src-apache"><span style="color: #ffad29; font-weight: bold;">Header</span> edit Set-Cookie ^(.*)$ $1;HttpOnly;Secure
</pre>
</div>
</div>
</div>

<div id="outline-container-org92ddf95" class="outline-4">
<h4 id="org92ddf95"><span class="section-number-4">25.3.4</span> mod_include</h4>
</div>
<div id="outline-container-orgddb5a4c" class="outline-4">
<h4 id="orgddb5a4c"><span class="section-number-4">25.3.5</span> mod_rewrite</h4>
<div class="outline-text-4" id="text-25-3-5">
<pre class="example">
&lt;IfModule mod_rewrite.c&gt;
RewriteEngine on
...
&lt;/IfModule&gt;
</pre>
</div>

<div id="outline-container-org7c24a86" class="outline-5">
<h5 id="org7c24a86"><span class="section-number-5">25.3.5.1</span> RewriteBase <a id="orga37ebf4">apache:RewriteBase</a></h5>
<div class="outline-text-5" id="text-25-3-5-1">
<p>
Syntax:	RewriteBase [URL-path]
specifies the URL prefix to be used for per-directory (htaccess) RewriteRule directives that substitute a relative path.
</p>

<pre class="example">
RewriteBase /
</pre>

<p>
Request <code>GET /somepath/localpath/pathinfo</code>
</p>
<pre class="example">
RewriteBase "/somepath"
RewriteRule ^localpath(.*) otherpath$1
# /somepath/otherpath/pathinfo
RewriteRule ^localpath(.*) /otherpath$1
# /otherpath/pathinfo
RewriteRule ^localpath(.*) http://thishost/otherpath$1
# /otherpath/pathinfo
</pre>
</div>
</div>

<div id="outline-container-org8325cd5" class="outline-5">
<h5 id="org8325cd5"><span class="section-number-5">25.3.5.2</span> RewriteCond <a id="org7ff8043">apache:RewriteCond</a></h5>
<div class="outline-text-5" id="text-25-3-5-2">
<p>
Syntax: RewriteCond [TestString] [CondPattern] [flags]
</p>

<pre class="example">
RewriteCond %{REMOTE_ADDR} ^1\.2\.3\.4$

RewriteCond %{HTTP_HOST} ^xyz\-40\.ca$ [OR]
RewriteCond %{HTTP_HOST} ^www\.xyz\-40\.ca$
RewriteRule ^(.*)$ "https\:\/\/www\.xyz\.com\/$1" [R=302,L]

</pre>
</div>
</div>

<div id="outline-container-orgeed3355" class="outline-5">
<h5 id="orgeed3355"><span class="section-number-5">25.3.5.3</span> Server-Variables</h5>
<div class="outline-text-5" id="text-25-3-5-3">
<p>
<a href="https://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritecond">https://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritecond</a>
</p>

<p>
%{HTTP_HOST} %{SERVER_PORT} %{QUERY_STRING}
</p>

<p>
%{REQUEST_URI} :: leading slash
</p>
</div>

<ol class="org-ol">
<li><a id="orgb85653d"></a><code>${HTTP_COOKIE}</code><br />
<div class="outline-text-6" id="text-25-3-5-3-1">
<pre class="example">
RewriteCond %{HTTP_COOKIE}     its=([^;]+) 
RewriteCond %1                 ^me$
RewriteRule ......
</pre>

<pre class="example">
RewriteCond %{HTTP_COOKIE}     its=([^;]+) 
RewriteCond %{unescape:%1}     ^me$
RewriteRule ......
</pre>
</div>
</li>

<li><a id="orgbdc9316"></a><code>%{TIME_*}</code><br />
<div class="outline-text-6" id="text-25-3-5-3-2">
<pre class="example">
&lt;IfModule mod_rewrite.c&gt;
  RewriteEngine On
  RewriteBase /
  RewriteRule ^dealdays/?(.*)$ /DealDays/$1 [R=302,L]
  RewriteCond %{TIME_YEAR}%{TIME_MON}%{TIME_DAY}%{TIME_HOUR} &gt;2017110521
  RewriteRule ^DealDays/?(.*)$ / [R=302,L]
&lt;/IfModule&gt;
</pre>
</div>
</li>
</ol>
</div>

<div id="outline-container-org12c83c1" class="outline-5">
<h5 id="org12c83c1"><span class="section-number-5">25.3.5.4</span> RewriteCond Flags</h5>
<div class="outline-text-5" id="text-25-3-5-4">
<p>
NC :: no case
NV :: no vary
OR
</p>

<pre class="example">
RewriteCond "%{REMOTE_HOST}"  "^host1"  [OR]
RewriteCond "%{REMOTE_HOST}"  "^host2"  [OR]
RewriteCond "%{REMOTE_HOST}"  "^host3"
RewriteRule ...some special stuff for any of these hosts...
</pre>
</div>
</div>

<div id="outline-container-orge564208" class="outline-5">
<h5 id="orge564208"><span class="section-number-5">25.3.5.5</span> RewriteRule <a id="org5c80193">apache:RewriteRule</a></h5>
<div class="outline-text-5" id="text-25-3-5-5">
<p>
Syntax:	RewriteRule [Pattern] [Substitution] [flags]
</p>

<p>
Pattern
Don't add leading slash. <code>^something</code> is a relative path that either starts with the current directory's .htaccess or <a href="#orga37ebf4">apache:RewriteBase</a>
</p>

<p>
Substitution
"-" or - :: the requested URI is not modified
If it doesn't have a leading slash, the end URL has the current directory's .htaccess or <a href="#orga37ebf4">apache:RewriteBase</a>
</p>
</div>
</div>

<div id="outline-container-org46aea7b" class="outline-5">
<h5 id="org46aea7b"><span class="section-number-5">25.3.5.6</span> RewriteRule Flags <a id="org38b3ee9">apache:RewriteRule:flags</a></h5>
<div class="outline-text-5" id="text-25-3-5-6">
<p>
<a href="https://httpd.apache.org/docs/2.4/rewrite/flags.html">https://httpd.apache.org/docs/2.4/rewrite/flags.html</a>
</p>

<p>
F :: return 403 and L is implied e.g. <code>RewriteRule "\.exe" "-" [F]</code>
L :: Last
NC :: no case
T :: set MIME type with which the resulting response will be sent.
E :: set environment variable e.g. [E=VAR:VAL] [E=VAR] (set to empty) [E=!VAR] (unset a previously set env var named VAR)
</p>

<p>
P|proxy :: handle request by mod_proxy
</p>

<p>
QSA|qsappend :: Default behavior of RewriteRule is to discard the existing query string, and replace it with the newly generated one. Use it to cause the query string to be combined
e.g. <code>RewriteRule "/pages/(.+)" "/page.php?page=$1" [QSA]</code>
/pages/123?one=two will be mapped to /page.php?page=123&amp;one=two
</p>
</div>
</div>

<div id="outline-container-orgbedc6df" class="outline-5">
<h5 id="orgbedc6df"><span class="section-number-5">25.3.5.7</span> ReWrite a path to sub directory with .htaccess</h5>
<div class="outline-text-5" id="text-25-3-5-7">
<p>
URL /inventory/* rewrite to /my-app/public/*
</p>

<p>
./my-app/public/index.php is where the app starts
./my-app/app/*.* are the app codes
./my-app/public/theme/*.* and ./my-app/public/uploads/*.* have the assets
</p>

<p>
./.htaccess
</p>
<pre class="example">
&lt;IfModule mod_rewrite.c&gt;
RewriteEngine On
RewriteBase /
RewriteRule ^inventory/?$ /my-app/public/index.php [L]
RewriteRule ^inventory/(.*)$ /my-app/public/$1 [L]
&lt;/IfModule&gt;
</pre>

<p>
./my-app/public/.htaccess
</p>
<pre class="example">
&lt;IfModule mod_rewrite.c&gt;
RewriteEngine On
RewriteBase /my-app/public/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /my-app/public/index.php [L]
&lt;/IfModule&gt;
</pre>
</div>
</div>

<div id="outline-container-org985090d" class="outline-5">
<h5 id="org985090d"><span class="section-number-5">25.3.5.8</span> WordPress Example</h5>
<div class="outline-text-5" id="text-25-3-5-8">
<p>
RewriteRule with redirect flag [R] is to redirect URL. Without it, RedirectRule maintains the URL on LHS in the address bar.
Redirect and RedirectMatch is to redirect
Redirect means the URL in the address bar will change
</p>

<p>
RewriteRule without proxy flag [P] is to maintain the URL on LHS as $_SERVER['REQUEST_URI'] in RewriteRule 
RewriteRule with [P] is to change the URL to the one on RHS as the new $_SERVER['REQUEST_URI'] in RewriteRule and pass it to the proxy
[P] requires mod_proxy enabled
</p>

<p>
The only way to modify $_SERVER['REQUEST_URI'] is to do a redirect or with the [P] flag.
</p>

<p>
RewriteRule is relative to the directory that the current .htaccess is in for both RHS and LHS.
RewriteBase only affects the dest of RewriteRule (RHS) only if dest is a relative path
</p>

<p>
Redirect /dealdays to /DealDays
</p>
<pre class="example">
# custom RewriteRule goes before the wordpress block
&lt;IfModule mod_rewrite.c&gt;
  RewriteEngine On
  RewriteBase /
  RewriteRule ^dealdays/?(.*)$ /DealDays/$1 [R=302,L]
  RewriteRule ^abc/?(.*)$ /subdir/abc.php [L]
&lt;/IfModule&gt;
# custom RewriteRule end

# BEGIN WordPress
&lt;IfModule mod_rewrite.c&gt;
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
&lt;/IfModule&gt;

# END WordPress

# default wordpress htaccess block is to redirect to index.php if it's not a file and not a directory
# Rules below the block has to be either a file or an existing directory

RewriteRule ^dealdays/(.*)$ /DealDays/$1 [R=302,L]
# If redirect to another url, use
# Redirect is prefix match and append additional path info beyond the matched URL-path to the new/target URL.
# a.com/dealdays2 to b.com/dealdays2, a.com/dealdays2/foo.txt to b.com/dealdays2/foo.txt, a.com/dealdays2/xyz to b.com/dealdays2/xyz
# Redirect syntax :: Redirect [status] [URL-path] URL
# [URL-path] is case-sensitive beginning with slash. relative path is not allowed
# URL may be either an absolute URL beginning with scheme and hostname or a URL-path beginning with a slash
Redirect 301 /dealdays2 http://b.com/dealdays2

# Redirect without appending additional path info
# RedirectMatch is like Redirect but regex
# syntax :: RedirectMatch [status] regex URL
RedirectMatch 302 ^/dealdays2/?$ http://b.com/dealdays2

# case insensitive just add (?i) in front of the pattern
RedirectMatch 302 (?i)^dealdays2/?$  /dealdays/
</pre>

<p>
Redirect root domain only but not other URI. e.g. mysite.com or www.mysite.com redirect to abc.com but not mysite.com/xyz to abc.com/xyz
</p>
<pre class="example">
RewriteEngine on
RewriteCond %{HTTP_HOST} ^(www\.)?mysite\.com [NC]
# no www :: RewriteCond %{HTTP_HOST} ^mysite\.com [NC]

RewriteCond %{REQUEST_URI} ^/$
# Rewriterule ^(.*)$ http://abc.com/ [L,R=302]
Rewriterule ^$ http://abc.com/ [L,R=302]
</pre>

<p>
Redirect www.abc.com to abc.com
</p>
<pre class="example">
RewriteCond %{HTTP_HOST}  ^www.abc.com [NC]
RewriteRule ^(.*) http://abc.com/$1 [L,R=302]
</pre>
</div>
</div>
</div>

<div id="outline-container-org36efa4a" class="outline-4">
<h4 id="org36efa4a"><span class="section-number-4">25.3.6</span> mod_autoindex</h4>
<div class="outline-text-4" id="text-25-3-6">
<p>
If the URI matches a directory but doesn't specify an index file e.g. index.html, by default Apache returns the index of that directory. Don't do that!
</p>
<pre class="example">
&lt;IfModule mod_autoindex.c&gt;
    Options -Indexes
&lt;/IfModule&gt;
</pre>
</div>
</div>

<div id="outline-container-orgc2b4790" class="outline-4">
<h4 id="orgc2b4790"><span class="section-number-4">25.3.7</span> mod_mime</h4>
<div class="outline-text-4" id="text-25-3-7">
</div>
<div id="outline-container-org6fd7bbc" class="outline-5">
<h5 id="org6fd7bbc"><span class="section-number-5">25.3.7.1</span> AddType TypesConfig <a id="org85ecc2f">apache:mod_mime:addtype</a></h5>
<div class="outline-text-5" id="text-25-3-7-1">
<p>
Context: all
</p>

<pre class="example">
AddType media-type extension [extension] ...

AddType image/webp .webp

AddType font/woff2 woff2

AddType image/jpeg jpeg jpg jpe
</pre>

<p>
/etc/apache2/mods-available/mime.conf loads MIME types using TypesConfig /etc/mime.types
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #23d7d7;">echo</span> <span style="color: #e67128;">"font/woff2 woff2"</span> &gt;&gt; /etc/mime.types
</pre>
</div>
</div>
</div>

<div id="outline-container-org68d6a09" class="outline-5">
<h5 id="org68d6a09"><span class="section-number-5">25.3.7.2</span> AddEncoding</h5>
<div class="outline-text-5" id="text-25-3-7-2">
<p>
AddEncoding encoding extension [extension] &#x2026;
extension may or may not have leading dot. This doesn't encode the file but rather sets the response header Content-Type. See <a href="#org71c73d8">apache:mod_filter:addoutputfilterbytype</a>
</p>
<pre class="example">
&lt;IfModule mod_mime.c&gt;
  AddEncoding gzip svgz
&lt;/IfModule&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orga74c17e" class="outline-4">
<h4 id="orga74c17e"><span class="section-number-4">25.3.8</span> mod_filter</h4>
<div class="outline-text-4" id="text-25-3-8">
</div>
<div id="outline-container-org322e2d7" class="outline-5">
<h5 id="org322e2d7"><span class="section-number-5">25.3.8.1</span> AddOutputFilterByType <a id="org71c73d8">apache:mod_filter:addoutputfilterbytype</a></h5>
<div class="outline-text-5" id="text-25-3-8-1">
<p>
AddOutputFilterByType filter[;filter&#x2026;] media-type [media-type] &#x2026;
Default deflate content types :: /etc/apache2/mods-available/deflate.conf
</p>

<pre class="example">
&lt;IfModule mod_filter.c&gt;
AddOutputFilterByType DEFLATE "application/atom+xml" \
                              "application/javascript" \
                              "application/json" \
                              ...
                              "image/svg+xml" \
                              ...etc.
&lt;/IfModule&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdd964fd" class="outline-4">
<h4 id="orgdd964fd"><span class="section-number-4">25.3.9</span> mod_alias</h4>
<div class="outline-text-4" id="text-25-3-9">
<p>
<a href="https://httpd.apache.org/docs/2.4/mod/mod_alias.html">https://httpd.apache.org/docs/2.4/mod/mod_alias.html</a>
</p>
</div>

<div id="outline-container-org8f11d93" class="outline-5">
<h5 id="org8f11d93"><span class="section-number-5">25.3.9.1</span> Redirect <a id="org2889a5a">apache:mode_alias:Redirect</a></h5>
</div>
</div>
</div>

<div id="outline-container-org6418441" class="outline-3">
<h3 id="org6418441"><span class="section-number-3">25.4</span> Directive Context <a id="org548c090">apache:directive context</a></h3>
<div class="outline-text-3" id="text-25-4">
<p>
server config ::This means that the directive may be used in the server configuration files (e.g., httpd.conf), but not within any &lt;VirtualHost&gt; or &lt;Directory&gt; containers. It is not allowed in .htaccess files at all.
</p>

<p>
virtual host :: This context means that the directive may appear inside &lt;VirtualHost&gt; containers in the server configuration files.
</p>

<p>
directory :: A directive marked as being valid in this context may be used inside &lt;Directory&gt;, &lt;Location&gt;, &lt;Files&gt;, &lt;If&gt;, and &lt;Proxy&gt; containers in the server configuration files, subject to the restrictions outlined in Configuration Sections.
</p>

<p>
.htaccess :: If a directive is valid in this context, it means that it can appear inside per-directory .htaccess files. It may not be processed, though depending upon the overrides currently active.
</p>
</div>
</div>

<div id="outline-container-org22288cf" class="outline-3">
<h3 id="org22288cf"><span class="section-number-3">25.5</span> Core Directives</h3>
<div class="outline-text-3" id="text-25-5">
<p>
These can be used in all <a href="#org548c090">apache:directive context</a>. However, some directive setting needs to happen in a different context.
<a href="https://httpd.apache.org/docs/2.4/mod/core.html">https://httpd.apache.org/docs/2.4/mod/core.html</a>
</p>

<pre class="example">
ErrorDocument 404 /404.html

# This setting prevents Apache from returning a 404 error as the result
# of a rewrite when the directory with the same name does not exist.
Options -MultiViews
</pre>
</div>

<div id="outline-container-org2ea2d55" class="outline-4">
<h4 id="org2ea2d55"><span class="section-number-4">25.5.1</span> AllowOverride <a id="org4e82072">apache:core:allowoverride</a></h4>
<div class="outline-text-4" id="text-25-5-1">
<p>
AllowOverride All|None|directive-type [directive-type] &#x2026;
context: only directory
default: AllowOverride None (2.3.9 and later), AllowOverride All (2.3.8 and earlier)
</p>

<p>
Which directives declared in .htaccess can override earlier configuration directives.
</p>

<p>
None :: .htaccess files are completely ignored.
</p>
</div>
</div>

<div id="outline-container-org630fd5c" class="outline-4">
<h4 id="org630fd5c"><span class="section-number-4">25.5.2</span> FilesMatch</h4>
<div class="outline-text-4" id="text-25-5-2">
<p>
Force to download a PDF file. The path doesn't matter
</p>
<div class="org-src-container">
<pre class="src src-conf">&lt;FilesMatch <span style="color: #e67128;">"aPDFfile.pdf"</span>&gt;
  ForceType application/octet-stream
  Header add Content-Disposition <span style="color: #e67128;">"attachment"</span>
&lt;/filesMatch&gt;
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3258935" class="outline-3">
<h3 id="org3258935"><span class="section-number-3">25.6</span> LogLevel</h3>
<div class="outline-text-3" id="text-25-6">
<p>
Put it inside VirtualHost e.g. in /etc/apache2/sites-available/*.conf
</p>
<pre class="example">
LogLevel alert rewrite:trace6

# For &lt; 2.4 use this for Rewrite log
RewriteEngine On
RewriteLog "/var/log/apache2/rewrite.log"
RewriteLogLevel 3
</pre>

<p>
trace1 to trace8 (most detailed)
</p>
</div>
</div>

<div id="outline-container-org695d97f" class="outline-3">
<h3 id="org695d97f"><span class="section-number-3">25.7</span> LogFormat</h3>
<div class="outline-text-3" id="text-25-7">
<p>
LogFormat <a href="https://httpd.apache.org/docs/2.4/mod/mod_log_config.html#logformat">https://httpd.apache.org/docs/2.4/mod/mod_log_config.html#logformat</a>
Context: server config, virtual host
</p>
<pre class="example">
LogFormat "%h %l %u %t \"%r\" %&gt;s %b" common
CustomLog logs/access_log common
</pre>

<p>
LogFormat associate a format string to a nickname (e.g. common), nickname is optional
CustomLog specifies the log file location for that nickname
</p>

<p>
Combined more fields
</p>
<pre class="example">
LogFormat "%h %l %u %t \"%r\" %&gt;s %b \"%{Referer}i\" \"%{User-agent}i\"" combined
CustomLog log/access_log combined

// 127.0.0.1 - frank [10/Oct/2000:13:55:36 -0700] "GET /apache_pb.gif HTTP/1.0" 200 2326
// after combined
// 127.0.0.1 - frank [10/Oct/2000:13:55:36 -0700] "GET /apache_pb.gif HTTP/1.0" 200 2326 "http://www.example.com/start.html" "Mozilla/4.08 [en] (Win98; I ;Nav)"
</pre>

<p>
2326 :: %b :: size of the object returned to the client, not including the response headers. If no content was returned to the client, this value will be "-". To log "0" for no content, use %B instead.
</p>

<p>
Custom Log Formats :: <a href="https://httpd.apache.org/docs/2.4/mod/mod_log_config.html#formats">https://httpd.apache.org/docs/2.4/mod/mod_log_config.html#formats</a>
</p>
</div>
</div>

<div id="outline-container-orge42bdb3" class="outline-3">
<h3 id="orge42bdb3"><span class="section-number-3">25.8</span> Basic authentication</h3>
<div class="outline-text-3" id="text-25-8">
<p>
htpasswd creates auth file and it needs this package. htpasswd doesn't need to be installed on server.
</p>
<pre class="example">
apt-get install apache2-utils

# use -c to create and sammy is the username, supply password later
sudo htpasswd -c /mywebsite/.htpasswd-dev sammy

# later add more user without -c
sudo htpasswd -c /mywebsite/.htpasswd-dev another_user
</pre>

<p>
.htpasswd file content
</p>
<pre class="example">
Output
sammy:$apr1$.0CAabqX$rb8lueIORA/p8UzGPYtGs/
another_user:$apr1$fqH7UG8a$SrUxurp/Atfq6j7GL/VEC1
</pre>

<p>
MD5           \(apr1\).0CAabqX$rb8lueIORA/p8UzGPYtGs/
32bit salt is       .0CAabqX
MD5 result is                rb8lueIORA/p8UzGPYtGs/
</p>
</div>

<div id="outline-container-org63a45dd" class="outline-4">
<h4 id="org63a45dd"><span class="section-number-4">25.8.1</span> Option 1: control access within Virutal Host Definition</h4>
<div class="outline-text-4" id="text-25-8-1">
<p>
/etc/apache2/sites-enabled/000-default.conf
</p>

<pre class="example">
&lt;VirtualHost *:80&gt;
  ServerAdmin webmaster@localhost
  DocumentRoot /var/www/html
  ErrorLog ${APACHE_LOG_DIR}/error.log
  CustomLog ${APACHE_LOG_DIR}/access.log combined

# add this
  &lt;Directory "/var/www/html"&gt;
    AuthType Basic
    AuthName "Restricted Content"
    AuthUserFile /etc/apache2/.htpasswd
    Require valid-user
  &lt;/Directory&gt;
# add this.

&lt;/VirtualHost&gt;
</pre>
</div>
</div>

<div id="outline-container-org8f7bc6b" class="outline-4">
<h4 id="org8f7bc6b"><span class="section-number-4">25.8.2</span> Option 2: control access with .htaccess</h4>
<div class="outline-text-4" id="text-25-8-2">
<p>
Main config file :: /etc/apache2/apache2.conf
Allow .htaccess to override config
For <i>var/www</i>, change <code>AllowOverride None</code> to <code>All</code>
</p>
<pre class="example">
. . .
&lt;Directory /var/www/&gt;
  Options Indexes FollowSymLinks
  AllowOverride All
  Require all granted
&lt;/Directory&gt;
. . .
</pre>

<p>
<i>var/www/mywebsite</i>.htaccess, restart apache
</p>
<pre class="example">
AuthType Basic
AuthName "restricted area"
AuthUserFile /var/www/__secure/.htpasswd-dev
require valid-user
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbc12729" class="outline-3">
<h3 id="orgbc12729"><span class="section-number-3">25.9</span> Production Setup <a id="org627f8c2">apache:production</a></h3>
<div class="outline-text-3" id="text-25-9">
<p>
This guide is for httpd. Optimize Webhost Setup
<code>nano /etc/httpd/conf/httpd.conf</code>
</p>

<pre class="example">
Timeout 30
KeepAlive on
MaxKeepAliveRequests 50
KeepAliveTimeout 15
#Changes to prefork module
&lt;IfModule prefork.c&gt;
  StartServers 3
  MinSpareServers 2
  MaxSpareServers 5
  ServerLimit 256
  MaxClients 10
  MaxRequestsPerChild 1000
&lt;/IfModule&gt;
</pre>

<p>
Search <code>AllowOverrride</code> and set it to All for
</p>
<pre class="example">
&lt;Directory /&gt;
  Options FollowSymLinks
  AllowOverride All
&lt;/Directory&gt;
</pre>

<p>
And
</p>

<pre class="example">
# AllowOverride controls what directives may be placed in .htaccess files.
# It can be "All", "None", or any combination of the keywords:
# Options FileInfo AuthConfig Limit
#
AllowOverride All
</pre>

<p>
Restart Apache <code>service httpd restart</code>
</p>
</div>
</div>

<div id="outline-container-org0f1adec" class="outline-3">
<h3 id="org0f1adec"><span class="section-number-3">25.10</span> Force redirect from non www to www</h3>
<div class="outline-text-3" id="text-25-10">
<pre class="example">
&lt;IfModule mod_rewrite.c&gt;
RewriteEngine On
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule ^(.*)$ http://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
&lt;/IfModule&gt;
</pre>

<p>
Redirect from www.example.com to example.com
</p>
<pre class="example">
&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
    RewriteRule ^ %{ENV:PROTO}://%1%{REQUEST_URI} [R=301,L]
&lt;/IfModule&gt;
</pre>
</div>
</div>

<div id="outline-container-orgce08dc4" class="outline-3">
<h3 id="orgce08dc4"><span class="section-number-3">25.11</span> Force redirect to https .htaccess</h3>
<div class="outline-text-3" id="text-25-11">
<p>
Diffrent hositng companies have different rule
</p>

<p>
In general
</p>
<pre class="example">
&lt;IfModule mod_rewrite.c&gt;
RewriteEngine On
# RewriteBase is optional but some hosting requires it
RewriteBase /
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
&lt;/IfModule&gt;
</pre>

<p>
InMotion <a href="https://www.inmotionhosting.com/support/website/ssl/how-to-force-https-using-the-htaccess-file">https://www.inmotionhosting.com/support/website/ssl/how-to-force-https-using-the-htaccess-file</a>
</p>

<pre class="example">
&lt;IfModule mod_rewrite.c&gt;
RewriteCond %{REQUEST_URI} !^/[0-9]+\..+\.cpaneldcv$
RewriteCond %{REQUEST_URI} !^/\.well-known/pki-validation/[A-F0-9]{32}\.txt(?:\ Comodo\ DCV)?$
RewriteEngine On 
RewriteCond %{SERVER_PORT} 80 
RewriteRule ^(.*)$ https://www.example.com/$1 [R=301,L]
&lt;/IfModule&gt;
</pre>
</div>
</div>

<div id="outline-container-orge68417b" class="outline-3">
<h3 id="orge68417b"><span class="section-number-3">25.12</span> Restrict access to a file or sub folder</h3>
<div class="outline-text-3" id="text-25-12">
<p>
<i>var/www</i>.htaccess blocks access to folders cs-devops and .git and file .gitignore. This way log gets 403 and apache doesn't need to be restarted
</p>
<pre class="example">
RewriteRule ^(cs-devops/|\.git/|\.gitignore|docker-compose\.yml|Makefile|README\.md|error_log|wp-config-li-[^.]+\.php) - [F,NC]
</pre>
</div>
</div>

<div id="outline-container-orgf7b10af" class="outline-3">
<h3 id="orgf7b10af"><span class="section-number-3">25.13</span> WebP</h3>
<div class="outline-text-3" id="text-25-13">
<pre class="example">
&lt;IfModule mod_rewrite.c&gt;

  RewriteEngine On

  # Check if browser support WebP images
  RewriteCond %{HTTP_ACCEPT} image/webp

  # Check if WebP replacement image exists
  RewriteCond %{DOCUMENT_ROOT}/$1.webp -f

  # Serve WebP image instead
  RewriteRule (.+)\.(jpe?g|png)$ $1.webp [T=image/webp,E=accept:1]

&lt;/IfModule&gt;

&lt;IfModule mod_headers.c&gt;

    Header append Vary Accept env=REDIRECT_accept

&lt;/IfModule&gt;

AddType  image/webp .webp
</pre>
</div>
</div>

<div id="outline-container-org90c701c" class="outline-3">
<h3 id="org90c701c"><span class="section-number-3">25.14</span> SSL <a id="org529dc59">apache:ssl</a></h3>
<div class="outline-text-3" id="text-25-14">
<p>
<a href="https://www.digicert.com/csr-ssl-installation/apache-openssl.htm">Docs from DigiCert</a>
Find config file that handles SSL
</p>
<pre class="example">
grep -i -r "SSLCertificateFile" /etc/httpd/
</pre>

<p>
<code>sudo a2enmod ssl</code>
</p>

<p>
<a href="https://httpd.apache.org/docs/2.4/mod/mod_ssl.html#sslcertificatefile">The <code>SSLCertificateFile</code> may also contain intermediate certificates, DH parameters and EC curve.</a>
</p>

<pre class="example">
# May need for port 80 as well
&lt;VirtualHost 192.168.0.1:80&gt;
    DocumentRoot /var/www/html2
    ServerName www.yourdomain.com
        SSLEngine on
        SSLCertificateFile /path/to/your_domain_name.crt
        SSLCertificateKeyFile /path/to/your_private.key
        SSLCertificateChainFile /path/to/DigiCertCA.crt
&lt;/VirtualHost&gt;

&lt;VirtualHost 192.168.0.1:443&gt;
    DocumentRoot /var/www/html2
    ServerName www.yourdomain.com
        SSLEngine on
        SSLCertificateFile /path/to/your_domain_name.crt
        SSLCertificateKeyFile /path/to/your_private.key
        SSLCertificateChainFile /path/to/DigiCertCA.crt
&lt;/VirtualHost&gt;
</pre>

<p>
Check before <a href="#orga6ec764">apache:restart</a>
</p>
</div>
</div>

<div id="outline-container-org1688f4e" class="outline-3">
<h3 id="org1688f4e"><span class="section-number-3">25.15</span> Redirect to HTTPS <a id="org0a532d8">apache:https</a></h3>
<div class="outline-text-3" id="text-25-15">
<pre class="example">
RewriteEngine On 
RewriteCond %{SERVER_PORT} 80 
# or
# RewriteCond %{HTTPS} off

# test one page
# RewriteCond %{REQUEST_URI} ^/page-path-name/$

RewriteRule ^(.*)$ https://www.example.com/$1 [R,L]
# or
# RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R,L]
</pre>

<p>
A specific domain
</p>
<pre class="example">
RewriteEngine On 
RewriteCond %{HTTP_HOST} ^example\.com [NC]
RewriteCond %{SERVER_PORT} 80 
RewriteRule ^(.*)$ https://www.example.com/$1 [R,L]
</pre>

<p>
Force SSL on a specific folder. Place this .htaccess in that folder
</p>
<pre class="example">
RewriteEngine On 
RewriteCond %{SERVER_PORT} 80 
RewriteCond %{REQUEST_URI} folder 
RewriteRule ^(.*)$ https://www.example.com/folder/$1 [R,L]
</pre>
</div>
</div>
</div>

<div id="outline-container-orga8fb584" class="outline-2">
<h2 id="orga8fb584"><span class="section-number-2">26</span> Nginx</h2>
<div class="outline-text-2" id="text-26">
</div>
<div id="outline-container-org5954ffa" class="outline-3">
<h3 id="org5954ffa"><span class="section-number-3">26.1</span> Install on Ubuntu 16.04</h3>
<div class="outline-text-3" id="text-26-1">
<pre class="example">
sudo apt-get update
sudo apt-get install nginx
</pre>
<p>
<a href="#org637f0c3">nginx:ufw</a>
</p>
</div>

<div id="outline-container-org264f336" class="outline-4">
<h4 id="org264f336"><span class="section-number-4">26.1.1</span> Config Firewall <a id="org637f0c3">nginx:ufw</a></h4>
<div class="outline-text-4" id="text-26-1-1">
<p>
This is optional if firewall <code>ufw</code> doesn't exist.
</p>

<p>
Nginx registers itself as a service with firewall <code>ufw</code>
</p>
<pre class="example">
sudo ufw app list

;; Available applications:
  Nginx Full
  Nginx HTTP
  Nginx HTTPS
  OpenSSH
</pre>

<p>
Nginx Full: This profile opens both port 80 (normal, unencrypted web traffic) and port 443 (TLS/SSL encrypted traffic)
Nginx HTTP: This profile opens only port 80 (normal, unencrypted web traffic)
Nginx HTTPS: This profile opens only port 443 (TLS/SSL encrypted traffic)
</p>

<p>
Enable Nginx HTTP
</p>
<pre class="example">
sudo ufw allow 'Nginx HTTP'
sudo ufw status

;; output
Status: active

To                         Action      From
--                         ------      ----
OpenSSH                    ALLOW       Anywhere                  
Nginx HTTP                 ALLOW       Anywhere                  
OpenSSH (v6)               ALLOW       Anywhere (v6)             
Nginx HTTP (v6)            ALLOW       Anywhere (v6)
</pre>

<p>
Enable HTTPS, allow Full and delete HTTP
</p>
<pre class="example">
sudo ufw allow 'Nginx Full'
sudo ufw delete allow 'Nginx HTTP'
</pre>
</div>
</div>

<div id="outline-container-org523d915" class="outline-4">
<h4 id="org523d915"><span class="section-number-4">26.1.2</span> Service Check, reload, restart, Check syntax</h4>
<div class="outline-text-4" id="text-26-1-2">
<dl class="org-dl">
<dt>Restart</dt><dd><code>systemctl status nginx</code> <code>service nginx restart</code> <code>sudo /etc/init.d/nginx restart</code></dd>
</dl>

<p>
stop, quit, reopen, reload :: <code>nginx -s reload</code>
Version in short :: <code>nginx -v</code>
</p>

<p>
Check syntax for config <code>sudo nginx -t</code>
</p>

<p>
Output
</p>
<pre class="example">
● nginx.service - A high performance web server and a reverse proxy server
   Loaded: loaded (/lib/systemd/system/nginx.service; enabled; vendor preset: enabled)
   Active: active (running) since Mon 2016-04-18 16:14:00 EDT; 4min 2s ago
 Main PID: 12857 (nginx)
   CGroup: /system.slice/nginx.service
           ├─12857 nginx: master process /usr/sbin/nginx -g daemon on; master_process on
           └─12858 nginx: worker process
</pre>

<p>
systemctl stop/start/restart/reload/disable/enable nginx
</p>

<p>
<code>restart</code> drops connection, use <code>reload</code> to not drop connection
disable nginx service, default the nginx service is to start automatically
</p>
</div>
</div>
</div>

<div id="outline-container-org02a4b6d" class="outline-3">
<h3 id="org02a4b6d"><span class="section-number-3">26.2</span> /etc/nginx /var/log/nginx</h3>
<div class="outline-text-3" id="text-26-2">
<p>
Config directory.
</p>
</div>

<div id="outline-container-orgbc90dd3" class="outline-4">
<h4 id="orgbc90dd3"><span class="section-number-4">26.2.1</span> <i>etc/nginx/sites-available</i></h4>
<div class="outline-text-4" id="text-26-2-1">
<p>
The directory where per-site "server blocks" can be stored.
Nginx will not use config files in this directory unless they are linked to the <code>sites-enabled</code> directory.
</p>

<p>
There should be a default file you can use. /etc/nginx/sites-available/default
</p>
<pre class="example">
server {
        listen 80 default_server;
        listen [::]:80 default_server;

        root /var/www/html;
        index index.html index.htm index.nginx-debian.html;

        server_name _;

        location / {
                try_files $uri $uri/ =404;
        }
}
</pre>

<p>
ATTENTION! Only one server block can have default_server
Search if there is any file has default_server
</p>
<pre class="example">
grep -R default_server /etc/nginx/sites-enabled/
</pre>

<pre class="example">
sudo cp /etc/nginx/sites-available/default /etc/nginx/sites-available/example.com
sudo nano /etc/nginx/sites-available/example.com
</pre>

<p>
/etc/nginx/sites-available/example.com
</p>
<pre class="example">
server {
        listen 80;
        listen [::]:80;

        root /var/www/example.com/html;
        index index.html index.htm index.nginx-debian.html;

        server_name example.com www.example.com;

        location / {
                try_files $uri $uri/ =404;
        }
}
</pre>

<p>
Enable the server block and restart Nginx
</p>

<p>
sudo ln -s /etc/nginx/sites-available/example.com /etc/nginx/sites-enabled/example.com
</p>

<p>
In order to avoid a possible hash bucket memory problem that can arise from adding additional server names, we will go ahead and adjust a single value within our /etc/nginx/nginx.conf file. Open the file now:
</p>
<pre class="example">
sudo nano /etc/nginx/nginx.conf
</pre>

<p>
Within the file, find the server_names_hash_bucket_size directive. Remove the # symbol to uncomment the line:
</p>
<pre class="example">
http {
    . . .

    server_names_hash_bucket_size 64;

    . . .
}
</pre>

<p>
Check syntax
</p>
<pre class="example">
sudo nginx -t
sudo systemctl restart nginx
</pre>
</div>
</div>

<div id="outline-container-org24e80f1" class="outline-4">
<h4 id="org24e80f1"><span class="section-number-4">26.2.2</span> <i>etc/nginx/sites-enabled</i></h4>
<div class="outline-text-4" id="text-26-2-2">
<p>
The directory where enabled per-site "server blocks" are stored.
</p>
</div>
</div>

<div id="outline-container-org3a7a49a" class="outline-4">
<h4 id="org3a7a49a"><span class="section-number-4">26.2.3</span> <i>etc/nginx/snippets</i></h4>
<div class="outline-text-4" id="text-26-2-3">
<p>
This directory contains config fragments that can be included elsewhere in the Nginx config.
</p>
</div>
</div>

<div id="outline-container-orgda2be27" class="outline-4">
<h4 id="orgda2be27"><span class="section-number-4">26.2.4</span> /var/log/nginx/access.log</h4>
<div class="outline-text-4" id="text-26-2-4">
<p>
Every request to your web server is recorded
</p>
</div>
</div>

<div id="outline-container-org47a0c54" class="outline-4">
<h4 id="org47a0c54"><span class="section-number-4">26.2.5</span> /var/log/nginx/error.log</h4>
</div>
</div>

<div id="outline-container-orgf52423e" class="outline-3">
<h3 id="orgf52423e"><span class="section-number-3">26.3</span> Config nginx.conf</h3>
<div class="outline-text-3" id="text-26-3">
<p>
Main global config /etc/nginx/nginx.conf
</p>

<pre class="example">
user www-data;
worker_processes 4;
pid /run/nginx.pid;

events {
  ...
}

http {
  sendfile off;
  tcp_nopush on;
  tcp_nodelay on;
  keepalive_timeout 65;
  types_hash_max_size 2048;
  include /etc/nginx/mime.types;
  default_type application/octet-stream;

  access_log /var/log/nginx/access.log ;
  error_log /var/log/nginx/error.log;

  include /etc/nginx/conf.d/*.conf;
} 
</pre>

<p>
Define server(s) in /etc/nginx/conf.d/default.conf
</p>
<pre class="example">
# comment starts here.
# You should always add a server to catch any requests without "Host" header
server {
  listen 80;
  server_name ""; # this line can be omitted if version &gt; 0.8.48
  return 444;
}

# another server
server {

}
</pre>

<p>
<a href="https://github.com/h5bp/server-configs">https://github.com/h5bp/server-configs</a>
</p>
</div>
</div>

<div id="outline-container-orgbf9e181" class="outline-3">
<h3 id="orgbf9e181"><span class="section-number-3">26.4</span> server Block</h3>
<div class="outline-text-3" id="text-26-4">
<p>
Include directives :: listen, server_name, root, index
Include blocks :: location
</p>

<pre class="example">
server {
  listen 80 default_server;
# or without any default_server in listen, the first server with listen is the default server
# listen 80;

# listen actually is a combo of ip and port 192.168.1.1:80
# nginx first identify which ip:port has the incoming request, then try to match the server_name from the request
# if no server_name matches, then it goes to the default_server for ip:port
# If no ip is set in ip:port, then 0.0.0.0 is used
# If no port is set in ip:port, then 80 is used
# If no listen is set, then 0.0.0.0:80 is used
# If only ip is specified (no port), it has a higher specificity than only port is specified.
# 0.0.0.0 means all ipv4 addresses
# listen [::]:80 ipv6only=on; # means to listen all ipv6 address :::80

  server_name example.org www.example.org;

# server_name :: can contain wildcards that either at start or end.
# *.example.org matches www.example.org and www.sub.exmple.org as well.
# nginx first searches for the exact match of a prefix given by literal strings (no regex, no wildcard)
# If not found, then checks for leading wildcard first then trailing wildcard (no regex)
# In each case if there're multiple matches, the longest match will be used
# Then nginx checks server_name given by regex in the order listed
# The first matching regex stops the search and nginx will use that server_name
# If no regex is matched, then uses the most specific prefix found earlier

# server_name regex always starts with ~. Recommended to always start with ^ and end with $
# e.g. server_name ~^www\d+\.example\.net$;
# regex containing { and/or } should be quoted entirely
# e.g. server_name "~^(?&lt;name&gt;\w\d{1,3}+)\.example\.net$"
# named capture :: later $name can be used
# always use named capture as $1 will be passed down to any sub directives and server_name is usually
# one of the top directives

# Special server_name :: "" you can do this
# server_name example.org "";
# This matches any server name
# server_name _;

  index index.cfm index.html index.htm;
  root /var/www;

# root combines with uri to get a file. e.g. /var/www/uripart1/uripart2
# If the result is a directory and doesn't have an index file (e.g. index.cfm set in index)
# Then it will return 403 forbidden
# Turn on autoindex will list files in directory
# autoindex on; 

# include any common config files. /etc/nginx/common/*.conf
  include common/common.conf
}
</pre>
</div>
</div>

<div id="outline-container-org8cfb240" class="outline-3">
<h3 id="org8cfb240"><span class="section-number-3">26.5</span> location block</h3>
<div class="outline-text-3" id="text-26-5">
<p>
location blocks are usually under server blocks
</p>
<pre class="example">
# location syntax
# location optional_modifier location_match {...}
# location only matches URI without URL parameters

# modifier =
location = /page1 {
  # exact match
  # if there is a match, return this immediately
}

# modifier ^~, non regex match
location ^~ /site {
  # This is a prefix match: /site/*
  # If this match (with ^~) is the longest prefix match, return immediately
}

# no modifier, the location_match part is a prefix
location /site {
  # This is also a prefix match: handles /site, /site/*, /site/page1/index.html
  # If this match (without ^~) is the longest prefix match, 
  # save for the moment and move on to regex matches
}

# modifier ~ or ~*, regex match
location ~ \.(jpe?g|png|gif|ico)$ {
  # ~ case-sensitive, ~* is case-insensitve
  # By now, if there is a prefix match (also longest prefix match), it's already stored in memory
  # These regex matches are checked by the listed order
  # Stop searching for the first matching regex, and return immediately
  # If no regex match, then return the previous found longest prefix match

  # So if there's a regex match, then the regex match will be used

  # Also notice, if there're any regex matches that are within the longest prefix match, 
  # those will be evaluated, in listed order, before any of the other regex matches.
}

# one location can "jump" to another location
root /var/www/main;
location / {
  rewrite ^/rewriteme/(.*)$ /$1 last;
  try_files $uri $uri.html $uri/ /fallback/index.html;
}

location /fallback {
  root /var/www/another;
}

# /rewriteme/hello &gt; /hello &gt; /hello, /hello.html, /hello/, /fallback/index.html

# one location can "jump" to another location :: custom 404
root /var/www/main;
location / {
  error_page 404 /another/whoops.html;
}

location /another {
  root /var/www;
}
</pre>
</div>
</div>

<div id="outline-container-orgf27379a" class="outline-3">
<h3 id="orgf27379a"><span class="section-number-3">26.6</span> proxy_pass directive</h3>
<div class="outline-text-3" id="text-26-6">
</div>
<div id="outline-container-org6dbcc39" class="outline-4">
<h4 id="org6dbcc39"><span class="section-number-4">26.6.1</span> Basic</h4>
<div class="outline-text-4" id="text-26-6-1">
<p>
If proxy_pass is specified with a URI, then when a request is passed to the server, the part of a normalized request URI matching the location is replaced by a URI specified in the directive
</p>
<pre class="example">
location /name/ {
    proxy_pass http://127.0.0.1/remote/;
# or http://127.0.0.1/
}
</pre>

<p>
If proxy_pass is specified without a URI, the request URI is passed to the server in the same form as sent by a client when the original request is processed, or the full normalized request URI is passed when processing the changed URI
</p>
<pre class="example">
location /some/path/ {
    proxy_pass http://127.0.0.1;
}
</pre>

<p>
proxy_pass can have URI parts if it's under a non-regex location block
</p>
<pre class="example">
location / {
  proxy_pass http://127.0.0.1:8888/long/uri;
# There's no trailing '/'
}
</pre>

<p>
proxy_pass without URI under a regex location block will pass URI to the proxy
</p>
<pre class="example">
location ~* \.(cfm|...|html)$) {
  proxy_pass http://127.0.0.1:8888;
}
</pre>

<p>
proxy_pass with URI under a regex location block will throw an error. 
To avoid error, set a variable which holds the original or modified URI to pass
</p>

<pre class="example">
location ~* \.(cfm|...|html)$) {
  set $request_url /site2$request_uri;
  if ($request_uri ~* ^/legacy_js) {
    set $request_url $request_uri;
  }
  proxy_pass http://127.0.0.1:8888$request_url;
}
</pre>
</div>
</div>

<div id="outline-container-org208b527" class="outline-4">
<h4 id="org208b527"><span class="section-number-4">26.6.2</span> Sample</h4>
<div class="outline-text-4" id="text-26-6-2">
<pre class="example">
location / {
  proxy_pass http://127.0.0.6:8888;
  proxy_set_header Host 127.0.0.6;
  proxy_redirect off;
  proxy_set_header X-Forwarded-Host $host;
  proxy_set_header X-Forwarded-Server $host;
  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_set_header X-Real-IP $remote_addr;
  proxy_connect_timeout 600;
  proxy_send_timeout 600;
  proxy_read_timeout 600;
  send_timeout 600;
}
</pre>

<p>
Common docker container <a id="org5e2d6ed">nginx:proxy:docker</a>
</p>
<pre class="example">
server {
  listen 80;
  server_name dev.myweb.com;

# refer to SSL config for nginx:ssl:server block for Let's Encrypt

  # deny .git
  location ~ /\.git {
    deny all;
  }

  location / {
    proxy_pass http://127.0.0.1:9977;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header Host $http_host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
  # proxy_set_header X-Forwarded-SSL on; # for ssl
  # proxy_redirect default; # default is to redirect location into proxy_pass
  # proxy_redirect changes the response header ~Location~ from the proxied server
  }
}
</pre>

<p>
$http_host equals always the HTTP_HOST request header.
$host equals $http_host, lowercase and without the port number (if present), except when HTTP_HOST is absent or is an empty value. 
</p>
<ul class="org-ul">
<li>In that case, $host equals the value of the server_name directive of the server which processed the request.</li>
</ul>

<p>
Refer to wordpress:ssl:behind proxy
</p>

<p>
proxy headers in PHP are HTTP_X_REAL_IP
</p>
</div>
</div>

<div id="outline-container-org08bb710" class="outline-4">
<h4 id="org08bb710"><span class="section-number-4">26.6.3</span> Sample: Redirect a path to a different proxy <a id="orgf3adc36">nginx:redirect path to proxy</a></h4>
<div class="outline-text-4" id="text-26-6-3">
<p>
<a href="#org3bca9eb">wp:redirect path to wp</a>
</p>
<pre class="example">
server {
  listen 80;
  server_name abc.com www.abc.com;

# this doens't work in wordpress! =&gt; location ^~ /subpath
  location ^~ /subpath/ {
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header Host $http_host;
    proxy_pass http://127.0.0.1:8787/;
  }

  location / {
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header Host $http_host;
    proxy_pass http://127.0.0.1:9977;
  }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org68ef768" class="outline-3">
<h3 id="org68ef768"><span class="section-number-3">26.7</span> Rewrite Directive</h3>
<div class="outline-text-3" id="text-26-7">
<p>
Case insensitve match. Source folder is CMS, and any case variants of CMS can be redirected
</p>
<pre class="example">
rewrite (?i)^/cms/?$ /CMS/index.cfm last;
rewrite (?i)^/cms/(.*)$ /CMS/$1 last;
</pre>

<p>
Flag <code>last</code> :: Not to pass any more rewrite-module directives in the current <code>server</code> or <code>location</code> block
</p>
</div>
</div>

<div id="outline-container-org0e463c4" class="outline-3">
<h3 id="org0e463c4"><span class="section-number-3">26.8</span> listen Directive</h3>
<div class="outline-text-3" id="text-26-8">
<p>
Default <code>listen *:80;</code> if Nginx is run as superuser or <code>listen *:8000</code> otherwise.
</p>

<p>
Parameter ipv6only can be set only once across all config files. Default is on. Which means when [::] is used, listen only for IP v6.
</p>
<pre class="example">
listen [::]:443 ssl ipv6only=on;
</pre>
</div>
</div>

<div id="outline-container-org684e6bf" class="outline-3">
<h3 id="org684e6bf"><span class="section-number-3">26.9</span> Server name redirect</h3>
<div class="outline-text-3" id="text-26-9">
<pre class="example">
server {
  listen 80;
  listen [::]:80;
  server_name .mydomain.com;
# this matches *.mydomain.com
  return 301 http://www.adifferentdomain.com$request_uri;
}

# if you have ssl setup, you need to specify SSL info
# refer to nginx:ssl:example
server {
  # your original setting
  server_name .yoursite.com

  listen [::]:443 ssl ipv6only=on; # You might need to remove ipv6only=on; if it was set. managed by Certbot
  listen 443 ssl; # managed by Certbot
  ssl_certificate /etc/letsencrypt/live/yoursite.com/fullchain.pem; # managed by Certbot
  ssl_certificate_key /etc/letsencrypt/live/yoursite.com/privkey.pem; # managed by Certbot
  include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
  ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot

  return 301 https://adifferentdoamin.com$request_uri;
}
</pre>
</div>
</div>

<div id="outline-container-org95261e2" class="outline-3">
<h3 id="org95261e2"><span class="section-number-3">26.10</span> Let's Encrypt SSL <a id="org624f86b">nginx:ssl</a></h3>
<div class="outline-text-3" id="text-26-10">
<p>
On Ubuntu, install Let's Encrypt SSL client <code>certbot</code> package to renew certificate.
</p>

<p>
<code>certbot</code> is <code>letsencrypt</code> in older version or <code>certbot-auto</code> in an alternate installation method.
</p>

<p>
Authenticator plugins use <code>certonly</code> command to obtain a certificate to <code>/etc/letsencrypt</code> directory
e.g. Certificate :: /etc/letsencrypt/live/example.com/fullchain.pem
</p>

<p>
Install plugins use <code>install</code> command to install a certificate :: modify webserver config
</p>

<p>
Authenticator (-a) and installer (-i) plugins can be combined
</p>
<pre class="example">
certbot run -a webroot -i apache -w /var/www/html -d example.com
</pre>

<p>
renewal config files for each domain /etc/letsencrypt/renewal/mydomain.com.conf
</p>

<p>
Global config /etc/letsencrypt/cli.ini (usually empty)
</p>

<p>
Log /var/log/letsencrypt
</p>

<p>
/etc/cron.d/certbot is just running <code>certbot -q renew</code> so renewal config file is very important for each domain
</p>
</div>

<div id="outline-container-orga1ff729" class="outline-4">
<h4 id="orga1ff729"><span class="section-number-4">26.10.1</span> Challenges</h4>
<div class="outline-text-4" id="text-26-10-1">
<dl class="org-dl">
<dt>http challenge (port 80)</dt><dd>requires to place a file with specific name and content in your-website-root/.well-known/acme-challenge/ directoy</dd>

<dt>dns (port 53 open on DNS server)</dt><dd>requires to place a TXT DNS record with specific contents
e.g. _acme-challenge.example.com. 300 IN TXT "gfj9Xq&#x2026;Rg85nM"</dd>

<dt>tls-sni (port 443)</dt><dd>prepares a self-signed SSL certificate with the challenge validation encoded into a subjectAlternatNames entry. Config your SSL server to present this challenge SSL certificate to the ACME server using SNI.
<ul class="org-ul">
<li>nginx and apache plugins use this type</li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-org9e5875a" class="outline-4">
<h4 id="org9e5875a"><span class="section-number-4">26.10.2</span> certbot nginx apache plugins</h4>
<div class="outline-text-4" id="text-26-10-2">
<p>
They are authenticator and install plugins. tls-sni-01 challenge
</p>

<pre class="example">
sudo add-apt-repository ppa:certbot/certbot
sudo apt-get update
sudo apt-get install python-certbot-nginx
# sudo apt-get install python-certbot-apache
</pre>

<p>
<code>certbot</code> looks for server block files with server_name
</p>

<p>
Allow HTTPS in firewall <a href="#org637f0c3">nginx:ufw</a>
</p>

<p>
Obtain an SSL certificate using &#x2013;nginx plugin for those -d server names
</p>
<pre class="example">
sudo certbot --nginx -d example.com -d www.example.com
</pre>

<p>
The first time running certbot, prompt to enter an email address and agree to the terms of service. After doing so, certbot will communicate with the Let's Encrypt server, then run a challenge to verify that you control the domain you're requesting a certificate for.
</p>

<p>
After everything, certificate is downloaded, Nginx config is updated and reloaded.
</p>

<p>
Modified :: /etc/nginx/sites-enabled/yoursite.com
<a id="orgb87d5e2">nginx:ssl:server block</a>
</p>
<pre class="example">
server {
    listen 80;
    listen [::]:80;
    server_name example.com www.example.com; 
    return 301 https://example.com$request_uri;
  # force redirect to https
}

server {
  # your original setting
  # listen 80; # if you want to serve http as well in the same block
  # ssl on; # is not needed when ssl is in listen directive
  listen 443 ssl; # managed by Certbot
  ssl_certificate /etc/letsencrypt/live/yoursite.com/fullchain.pem; # managed by Certbot
  ssl_certificate_key /etc/letsencrypt/live/yoursite.com/privkey.pem; # managed by Certbot
  include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
  ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot

  # follow by these proxy rules nginx:proxy:docker

}

# certbot will insert this block, but it's better to use the one atop.
server {
  if ($host = yoursite.com) {
        return 301 https://$host$request_uri;
    } # managed by Certbot

  listen 80;
  server_name yoursite.com;
    return 404; # managed by Certbot
}
</pre>

<p>
Certificate :: /etc/letsencrypt/live/example.com/fullchain.pem
Certbot config and account credential :: /etc/letsencrypt
</p>

<p>
<a href="#org119dd85">ssl:test</a>
</p>

<p>
Let's Encrypt SSL certificates are valid for 90 days. On Ubuntu, install <code>certbot</code> package to renew certificate. <code>certbot renew</code> is run twice a day on systemd timer. For non-systemd, /etc/cron.d also runs twice a day.
</p>

<p>
/etc/cron.d/certbot
</p>
<pre class="example">
SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

0 */12 * * * root test -x /usr/bin/certbot -a \! -d /run/systemd/system &amp;&amp; perl -e 'sleep int(rand(3600))' &amp;&amp; certbot -q renew
</pre>

<p>
Dry run <code>sudo certbot renew --dry-run</code>, expect no error.
</p>
</div>
</div>

<div id="outline-container-org36ec427" class="outline-4">
<h4 id="org36ec427"><span class="section-number-4">26.10.3</span> certbot manual plugin</h4>
<div class="outline-text-4" id="text-26-10-3">
<p>
An authenticator plugin that obtains a certificate by giving you instructions to perform domain validation yourself. Additionally allows you to specify scripts to automate the validation task in a customized way. hooks can be specified
</p>

<p>
http-01, dns-01 or tls-sni-01 challenge
</p>

<p>
Example usage for HTTP-01:
</p>
<pre class="example">
certbot certonly --manual --preferred-challenges=http --manual-auth-hook /path/to/http/authenticator.sh --manual-cleanup-hook /path/to/http/cleanup.sh -d secure.example.com
</pre>

<p>
authenticator.sh
</p>
<pre class="example">
#!/bin/bash
dir=/path/to/web-root/.well-known/acme-challenge
mkdir -p $dir
filename=$dir/$CERTBOT_TOKEN
test -f $filename || touch $filename
echo $CERTBOT_VALIDATION &gt; $filename
chown -R www-data:www-data $filename
</pre>

<p>
cleanup.sh
</p>
<pre class="example">
rm -f /var/www/htdocs/.well-known/acme-challenge/$CERTBOT_TOKEN
</pre>

<p>
Environment vars available to hooks
</p>
<dl class="org-dl">
<dt>CERTBOT_DOMAIN</dt><dd>The domain being authenticated</dd>
<dt>CERTBOT_VALIDATION</dt><dd>The validation string (HTTP-01 and DNS-01 only)</dd>
<dt>CERTBOT_TOKEN</dt><dd>Resource name part of the HTTP-01 challenge (HTTP-01 only)</dd>
<dt>CERTBOT_CERT_PATH</dt><dd>The challenge SSL certificate (TLS-SNI-01 only)</dd>
<dt>CERTBOT_KEY_PATH</dt><dd>The private key associated with the aforementioned SSL certificate (TLS-SNI-01 only)</dd>
<dt>CERTBOT_SNI_DOMAIN</dt><dd>The SNI name for which the ACME server expects to be presented the self-signed certificate located at $CERTBOT_CERT_PATH (TLS-SNI-01 only)</dd>
<dt>CERTBOT_AUTH_OUTPUT</dt><dd>(cleanup hook only) Whatever the auth script wrote to stdout</dd>
</dl>
</div>

<div id="outline-container-orgb72f852" class="outline-5">
<h5 id="orgb72f852"><span class="section-number-5">26.10.3.1</span> Example usage for DNS-01</h5>
<div class="outline-text-5" id="text-26-10-3-1">
<p>
(Cloudflare API v4) (for example purposes only, do not use as-is)
</p>

<pre class="example">
certbot certonly --manual --preferred-challenges=dns --manual-auth-hook /path/to/dns/authenticator.sh --manual-cleanup-hook /path/to/dns/cleanup.sh -d secure.example.com
</pre>

<p>
authenticator.sh
</p>
<pre class="example">
#!/bin/bash

# Get your API key from https://www.cloudflare.com/a/account/my-account
API_KEY="your-api-key"
EMAIL="your.email@example.com"

# Strip only the top domain to get the zone id
DOMAIN=$(expr match "$CERTBOT_DOMAIN" '.*\.\(.*\..*\)')

# Get the Cloudflare zone id
ZONE_EXTRA_PARAMS="status=active&amp;page=1&amp;per_page=20&amp;order=status&amp;direction=desc&amp;match=all"
ZONE_ID=$(curl -s -X GET "https://api.cloudflare.com/client/v4/zones?name=$DOMAIN&amp;$ZONE_EXTRA_PARAMS" \
     -H     "X-Auth-Email: $EMAIL" \
     -H     "X-Auth-Key: $API_KEY" \
     -H     "Content-Type: application/json" | python -c "import sys,json;print(json.load(sys.stdin)['result'][0]['id'])")

# Create TXT record
CREATE_DOMAIN="_acme-challenge.$CERTBOT_DOMAIN"
RECORD_ID=$(curl -s -X POST "https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_records" \
     -H     "X-Auth-Email: $EMAIL" \
     -H     "X-Auth-Key: $API_KEY" \
     -H     "Content-Type: application/json" \
     --data '{"type":"TXT","name":"'"$CREATE_DOMAIN"'","content":"'"$CERTBOT_VALIDATION"'","ttl":120}' \
             | python -c "import sys,json;print(json.load(sys.stdin)['result']['id'])")
# Save info for cleanup
if [ ! -d /tmp/CERTBOT_$CERTBOT_DOMAIN ];then
        mkdir -m 0700 /tmp/CERTBOT_$CERTBOT_DOMAIN
fi
echo $ZONE_ID &gt; /tmp/CERTBOT_$CERTBOT_DOMAIN/ZONE_ID
echo $RECORD_ID &gt; /tmp/CERTBOT_$CERTBOT_DOMAIN/RECORD_ID

# Sleep to make sure the change has time to propagate over to DNS
sleep 25
</pre>

<p>
cleanup.sh
</p>
<pre class="example">
#!/bin/bash

# Get your API key from https://www.cloudflare.com/a/account/my-account
API_KEY="your-api-key"
EMAIL="your.email@example.com"

if [ -f /tmp/CERTBOT_$CERTBOT_DOMAIN/ZONE_ID ]; then
        ZONE_ID=$(cat /tmp/CERTBOT_$CERTBOT_DOMAIN/ZONE_ID)
        rm -f /tmp/CERTBOT_$CERTBOT_DOMAIN/ZONE_ID
fi

if [ -f /tmp/CERTBOT_$CERTBOT_DOMAIN/RECORD_ID ]; then
        RECORD_ID=$(cat /tmp/CERTBOT_$CERTBOT_DOMAIN/RECORD_ID)
        rm -f /tmp/CERTBOT_$CERTBOT_DOMAIN/RECORD_ID
fi

# Remove the challenge TXT record from the zone
if [ -n "${ZONE_ID}" ]; then
    if [ -n "${RECORD_ID}" ]; then
        curl -s -X DELETE "https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_records/$RECORD_ID" \
                -H "X-Auth-Email: $EMAIL" \
                -H "X-Auth-Key: $API_KEY" \
                -H "Content-Type: application/json"
    fi
fi
</pre>
</div>
</div>
</div>

<div id="outline-container-orge2d7f18" class="outline-4">
<h4 id="orge2d7f18"><span class="section-number-4">26.10.4</span> certbot standalone plugin</h4>
<div class="outline-text-4" id="text-26-10-4">
<p>
An authenticator plugin uses a standalone webserver to obtain a certificate. It's useful when there's no webserver. Need to open port 80 or 443
http-01 or tls-sni-01 challenge.
</p>

<p>
<a href="https://www.digitalocean.com/community/tutorials/how-to-use-certbot-standalone-mode-to-retrieve-let-s-encrypt-ssl-certificates">https://www.digitalocean.com/community/tutorials/how-to-use-certbot-standalone-mode-to-retrieve-let-s-encrypt-ssl-certificates</a>
</p>

<p>
sudo add-apt-repository ppa:certbot/certbot
sudo apt-get update
sudo apt-get install certbot
</p>

<p>
Certbot may run as a standalone webserver, allow either 80 or 443
sudo ufw allow 80
</p>

<p>
generete certificate only
sudo certbot certonly &#x2013;standalone &#x2013;preferred-challenges http -d example.com
</p>

<p>
The certbot package we installed takes care of this for us by adding a renew script to /etc/cron.d
</p>

<p>
/etc/letsencrypt/renewal/example.com.conf
renew_hook = systemctl reload rabbitmq
</p>

<p>
sudo certbot renew &#x2013;dry-run
</p>
</div>
</div>

<div id="outline-container-orgdfdfc0c" class="outline-4">
<h4 id="orgdfdfc0c"><span class="section-number-4">26.10.5</span> certbot webroot plugin</h4>
<div class="outline-text-4" id="text-26-10-5">
<p>
An authenticator plugin that obtains certificate and write to an existing webroot without webserver config mod. http-01 challenge.
</p>

<pre class="example">
certbot certonly --webroot -w /var/www/example/ -d www.example.com -d example.com -w /var/www/other -d other.example.net -d another.other.example.net
</pre>
</div>
</div>

<div id="outline-container-orgd12940b" class="outline-4">
<h4 id="orgd12940b"><span class="section-number-4">26.10.6</span> certbot manage and renew certificates</h4>
<div class="outline-text-4" id="text-26-10-6">
<p>
certbot [SUBCOMMAND] [options] [-d DOMAIN] [-d DOMAIN] &#x2026;
</p>

<p>
Subcommand:
</p>
<dl class="org-dl">
<dt>(default) run</dt><dd>Obtain &amp; install a certificate in your current webserver</dd>
<dt>certonly     </dt><dd>Obtain or renew a certificate, but do not install it</dd>
</dl>

<p>
/etc/letsencrypt/archive and /etc/letsencrypt/keys contain all previous keys and certificates, while /etc/letsencrypt/live symlinks to the latest versions.
</p>

<pre class="example">
certbot certificates
certbot certonly --cert-name example.com

# Update an existing certificate with a new certificate that contains all old domains and new domains
# Use -d to specify all existing and new domains.
certbot --expand -d existing.com,example.com,newdomain.com

# remove some domains from an exisiting certificate. before it contains example.com and www.example.com
certbot certonly --cert-name example.com -d example.com

# overwrites all domains for an existing certificate
certbot certonly --cert-name example.com -d example.org,www.example.org

# revoke
certbot revoke --cert-path /etc/letsencrypt/live/CERTNAME/cert.pem

# renew any existing certificates that expire in less than 30 days.
# --pre-hook and --post-hook hooks run before and after every renewal attempt.
certbot renew --pre-hook "service nginx stop" --post-hook "service nginx start"

# If you want your hook to run only after a successful renewal, use --deploy-hook in a command like this.
certbot renew --deploy-hook /path/to/deploy-hook-script
</pre>
</div>

<div id="outline-container-org6beff1b" class="outline-5">
<h5 id="org6beff1b"><span class="section-number-5">26.10.6.1</span> Hooks</h5>
<div class="outline-text-5" id="text-26-10-6-1">
<pre class="example">
certbot renew --pre-hook "service nginx stop" --post-hook "service nginx start"

# If you want your hook to run only after a successful renewal, use --deploy-hook in a command like this.
certbot renew --deploy-hook /path/to/deploy-hook-script
</pre>

<p>
deploy-hook-script
</p>
<pre class="example">
#!/bin/sh

set -e

for domain in $RENEWED_DOMAINS; do
        case $domain in
        example.com)
                daemon_cert_root=/etc/some-daemon/certs

                # Make sure the certificate and private key files are
                # never world readable, even just for an instant while
                # we're copying them into daemon_cert_root.
                umask 077

                cp "$RENEWED_LINEAGE/fullchain.pem" "$daemon_cert_root/$domain.cert"
                cp "$RENEWED_LINEAGE/privkey.pem" "$daemon_cert_root/$domain.key"

                # Apply the proper file ownership and permissions for
                # the daemon to read its certificate and key.
                chown some-daemon "$daemon_cert_root/$domain.cert" \
                        "$daemon_cert_root/$domain.key"
                chmod 400 "$daemon_cert_root/$domain.cert" \
                        "$daemon_cert_root/$domain.key"

                service some-daemon restart &gt;/dev/null
                ;;
        esac
done
</pre>

<p>
Script files can be placed at /etc/letsencrypt/renewal-hooks/pre, /etc/letsencrypt/renewal-hooks/deploy, and /etc/letsencrypt/renewal-hooks/post
Script files are run in alpha order.
</p>
</div>
</div>

<div id="outline-container-org1a08841" class="outline-5">
<h5 id="org1a08841"><span class="section-number-5">26.10.6.2</span> Renewal conf</h5>
<div class="outline-text-5" id="text-26-10-6-2">
<p>
Sample /etc/letsencrypt/renewal/mydomain.com.conf
</p>
<pre class="example">
# renew_before_expiry = 30 days
version = 0.21.1
archive_dir = /etc/letsencrypt/archive/mydomain.com
cert = /etc/letsencrypt/live/mydomain.com/cert.pem
privkey = /etc/letsencrypt/live/mydomain.com/privkey.pem
chain = /etc/letsencrypt/live/mydomain.com/chain.pem
fullchain = /etc/letsencrypt/live/mydomain.com/fullchain.pem

# Options used in the renewal process
[renewalparams]
account = abcfdfsda
installer = nginx
authenticator = nginx
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc553016" class="outline-4">
<h4 id="orgc553016"><span class="section-number-4">26.10.7</span> A certificate <a id="org6c71819">nginx:ssl:example</a></h4>
<div class="outline-text-4" id="text-26-10-7">
<pre class="example">
server {
  # your original setting
  server_name .yoursite.com

  listen [::]:443 ssl ipv6only=on; # You might need to remove ipv6only=on; if it was set. managed by Certbot
  listen 443 ssl; # managed by Certbot
  ssl_certificate /etc/letsencrypt/live/yoursite.com/fullchain.pem; # managed by Certbot
  ssl_certificate_key /etc/letsencrypt/live/yoursite.com/privkey.pem; # managed by Certbot
  include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
  ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot

  # set proxy
}
</pre>

<p>
certbot renewal config file :: /etc/letsencrypt/renewal/mydomain.com.conf
global config :: /etc/letsencrypt/cli.ini
</p>
</div>
</div>

<div id="outline-container-orgc339acf" class="outline-4">
<h4 id="orgc339acf"><span class="section-number-4">26.10.8</span> Windows IIS</h4>
<div class="outline-text-4" id="text-26-10-8">
<ul class="org-ul">
<li>IIS 8 on Windows Server 2012 or IIS 8.5 on Windows Server 2012 R2.</li>
<li>IIS 10 on Windows server 2016</li>
</ul>

<p>
<a href="https://www.digicert.com/csr-ssl-installation/iis-8-and-8.5.htm">Manual Install SSL on IIS 8</a> or <a href="https://www.digicert.com/csr-creation-ssl-installation-iis-10.htm">IIS 10</a> :: create CSR on IIS, submit and get SSL, import cert.
</p>
<ul class="org-ul">
<li>Or on IIS, import the .p12 file with key and crt from Linux</li>
</ul>

<p>
IIS Binding
</p>
<dl class="org-dl">
<dt>Server Binding</dt><dd><code>IP:Port:HostHeader</code> to a website. e.g. <code>*:80:*</code> <code>*:81:*</code> <code>192.168.1.1:80:*</code> <code>*:80:www.microsoft.com</code> <code>*:80:microsoft.com</code></dd>
<dt>(no term)</dt><dd>HTTPS is a server binding with SSL certificate <code>*:443:abc.com</code> <code>*:443:www.abc.com</code>. For IIS 2012+, enable <code>Server Name Indication</code> option to bind multiple SSL certificates to a single IP address. Before, IIS can only bind a single SSL cert. to one IP address</dd>
</dl>

<p>
IIS Websites
</p>
<ul class="org-ul">
<li>Path (a container of physical and virtual directories) + Server Binding = Website. e.g. default container is <code>%systemdrive%\inetpub\wwwroot</code></li>
</ul>

<p>
win-acme (ACME client)
<a href="https://weblog.west-wind.com/posts/2016/Feb/22/Using-Lets-Encrypt-with-IIS-on-Windows">Intro</a> <a href="https://github.com/PKISharp/win-acme">GitHub</a>
</p>

<p>
Download latest release, unzip and run letsencrypt.exe with admin privileges.
</p>

<ul class="org-ul">
<li>A task is added to Windows Task Scheduler</li>
</ul>
</div>
</div>

<div id="outline-container-org1c66384" class="outline-4">
<h4 id="org1c66384"><span class="section-number-4">26.10.9</span> Alternative clients (ACME Clients)</h4>
<div class="outline-text-4" id="text-26-10-9">
<p>
<a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-let-s-encrypt">https://www.digitalocean.com/community/tutorials/an-introduction-to-let-s-encrypt</a>
</p>

<dl class="org-dl">
<dt><a href="https://github.com/xenolf/lego">lego</a></dt><dd>Written in Go, lego is a one-file binary install, and supports many DNS providers when using the DNS challenge</dd>
<dt><a href="https://github.com/Neilpang/acme.sh">acme.sh</a></dt><dd>acme.sh is a simple shell script that can run in unprivileged mode, and also interact with 30+ DNS providers</dd>
<dt><a href="https://caddyserver.com/">Caddy</a></dt><dd>Caddy is a full web server written in Go with built-in support for Let's Encrypt.</dd>
</dl>

<p>
<a href="https://letsencrypt.org/docs/client-options/">All other clients</a>
</p>
</div>
</div>

<div id="outline-container-orgec54ba1" class="outline-4">
<h4 id="orgec54ba1"><span class="section-number-4">26.10.10</span> Limitation</h4>
<div class="outline-text-4" id="text-26-10-10">
<p>
There are 5 levels of validation
Domain Validation (DV), Organization Validation (OV), Extended Validation (EV), Wildcard Certificate
</p>

<p>
Certificate Authority (CA) provides the above validation and Commercial Certificate Authorities are the only one provide EV and Wildcard.
</p>

<p>
Let's Encrypt provides DV only and planning to support Wildcard in near future. A certificate with up to 100 hostnames.
</p>
</div>
</div>

<div id="outline-container-orge325d20" class="outline-4">
<h4 id="orge325d20"><span class="section-number-4">26.10.11</span> SSL config <a id="org2fe41a1">nginx:ssl:config</a></h4>
<div class="outline-text-4" id="text-26-10-11">
</div>
<div id="outline-container-org8f3a729" class="outline-5">
<h5 id="org8f3a729"><span class="section-number-5">26.10.11.1</span> Combine end-user and bundled intermediate certificates</h5>
<div class="outline-text-5" id="text-26-10-11-1">
<pre class="example">
cat your_domain.crt intermediate.crt root.crt &gt;&gt; ssl-bundle.crt

# e.g. PositiveSSL
cat example_com.crt COMODORSADomainValidationSecureServerCA.crt COMODORSAAddTrustCA.crt AddTrustExternalCARoot.crt &gt;&gt; ssl-bundle.crt

# e.g. combine end-user and bundled intermediate certificates
cat example_com.crt bundle.crt &gt;&gt; ssl-bundle.crt
</pre>
</div>
</div>

<div id="outline-container-orgb6c7a8d" class="outline-5">
<h5 id="orgb6c7a8d"><span class="section-number-5">26.10.11.2</span> <a href="https://michael.lustfield.net/nginx/getting-a-perfect-ssl-labs-score">Strengthen Nginx SSL Setup</a></h5>
<div class="outline-text-5" id="text-26-10-11-2">
<pre class="example">
# Protocol support
ssl_protocols TLSv1 TLSv1.1 TLSv1.2;

# Perfect when only 1.2 is used
ssl_protocols TLSv1.2;

# Put it in server block
ssl_dhparam ssl/dhparam.pem;

# Generate DHE
openssl dhparam -out /etc/nginx/ssl/dhparam.pem 4096

# Specify ciphers that are enabled on Nginx
# Default ssl_ciphers HIGH:!aNULL:!MD5;

# Change it to use openssl ciphers, run this to get ciphers provided by openssl and wrap it with double quotes and assign it to ssl_ciphers
# openssl ciphers

ssl_ciphers "AES256+EECDH:AES256+EDH:!aNULL;"
ssl_prefer_server_ciphers on;

# Default: ssl_session_cache none;
# shared :: a cache shared between all Nginx worker processes. In bytes. 1 mb can store about 4000 sessions. le_nginx_SSL is a cache name and can be used in multiple virtual servers
# Default: ssl_session_timeout 5m;

ssl_session_cache shared:le_nginx_SSL:1m;
ssl_session_timeout 1440m;

# SSL Stapling (not implemented by Let's Encrypt)
ssl_stapling on;
ssl_stapling_verify on;
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org2d1e5e8" class="outline-2">
<h2 id="org2d1e5e8"><span class="section-number-2">27</span> Web Application Firewall (WAF)</h2>
<div class="outline-text-2" id="text-27">
</div>
<div id="outline-container-orgcef89e5" class="outline-3">
<h3 id="orgcef89e5"><span class="section-number-3">27.1</span> ModSecurity <a id="org4c0e4f8">waf:modsecurity</a></h3>
<div class="outline-text-3" id="text-27-1">
<p>
Mod security is a free Web Application Firewall (WAF) that works with Apache, Nginx and IIS. It supports a flexible rule engine to perform simple and complex operations and comes with a Core Rule Set (CRS) which has rules for SQL injection, cross site scripting, Trojans, bad user agents, session hijacking and a lot of other exploits. For Apache, it is an additional module which makes it easy to install and configure.
</p>

<p>
<a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-mod_security-with-apache-on-debian-ubuntu">https://www.digitalocean.com/community/tutorials/how-to-set-up-mod_security-with-apache-on-debian-ubuntu</a>
</p>

<p>
You can disable ModSecurity on WHM but not recommended.
In InMotion, when curl website url that is hosted on the same server, you will get
Error 406 - Not Acceptable. Generally a 406 error is caused because a request has been blocked by Mod Security.
</p>

<p>
Add user agent. This only works for cURL GET request.
</p>
<pre class="example">
curl --user-agent cPanel-Cron http://example.com/cron.php
</pre>

<p>
To see any requests that violate which rules in which .conf file, tail the apache log
</p>
<pre class="example">
tail -f /usr/local/apache/logs/error_log | grep ModSecurity | grep my-host-url.com

// to see which .conf files are loaded by the module, InMotion hosting
cat /usr/local/apache/conf/modsec2.user.conf
</pre>
</div>
</div>
</div>

<div id="outline-container-orge2f8ec6" class="outline-2">
<h2 id="orge2f8ec6"><span class="section-number-2">28</span> Git</h2>
<div class="outline-text-2" id="text-28">
</div>
<div id="outline-container-orgd8915bb" class="outline-3">
<h3 id="orgd8915bb"><span class="section-number-3">28.1</span> Show config</h3>
<div class="outline-text-3" id="text-28-1">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #74af68;"># </span><span style="color: #74af68;">List all active config for the current folder</span>
git config --list

<span style="color: #74af68;"># </span><span style="color: #74af68;">List global config only</span>
git config --global --list

<span style="color: #74af68;"># </span><span style="color: #74af68;">Edit or check all global config</span>
git config --global --edit

<span style="color: #74af68;"># </span><span style="color: #74af68;">Get all files that forms each config</span>
git config --list --show-origin

<span style="color: #74af68;"># </span><span style="color: #74af68;">Find path to git.exe</span>
which git.exe

<span style="color: #74af68;"># </span><span style="color: #74af68;">change username and email for the current repo</span>
git config user.email myname@abc.omc
git config user.name <span style="color: #e67128;">"My Name"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3593eaa" class="outline-3">
<h3 id="org3593eaa"><span class="section-number-3">28.2</span> Working Tree <a id="orgba255a4">git:Working_Tree</a></h3>
<div class="outline-text-3" id="text-28-2">
<dl class="org-dl">
<dt>untracked</dt><dd>it was never staged nor committed</dd>
<dt>tracked</dt><dd>it was previously committed, but it is not staged</dd>
<dt>staged</dt><dd>ready for commit</dd>
<dt>dirty or modified</dt><dd>file is changed but not staged</dd>
</dl>
</div>
</div>

<div id="outline-container-org6aaed53" class="outline-3">
<h3 id="org6aaed53"><span class="section-number-3">28.3</span> diff</h3>
<div class="outline-text-3" id="text-28-3">
<p>
Working Copy -&gt; git add -&gt; Index -&gt; git commit -&gt; HEAD
</p>

<p>
HEAD^ is the previous commit
</p>

<p>
git diff: Between Working Copy and Index
</p>

<p>
git diff &#x2013;cached: Between HEAD and Index
</p>

<p>
git diff HEAD: Between Working Copy and HEAD
</p>

<p>
git diff HEAD^: Between Working Copy and HEAD^
</p>
</div>
</div>

<div id="outline-container-orga42f680" class="outline-3">
<h3 id="orga42f680"><span class="section-number-3">28.4</span> Show file names only between 2 commits</h3>
<div class="outline-text-3" id="text-28-4">
<p>
Show file names only for 1 commit
</p>
<div class="org-src-container">
<pre class="src src-sh">git diff-tree --no-commit-id --name-only -r <span style="color: #e67128;">"&lt;SHA&gt;"</span>
</pre>
</div>

<p>
Show file names only between 2 commits
</p>
<div class="org-src-container">
<pre class="src src-sh">git --no-pager diff --name-only SHA1 SHA2
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfe7c3c2" class="outline-3">
<h3 id="orgfe7c3c2"><span class="section-number-3">28.5</span> Stash, Reset, Clean</h3>
<div class="outline-text-3" id="text-28-5">
<p>
<a href="#orgba255a4">git:Working_Tree</a>
</p>

<dl class="org-dl">
<dt>git reset &#x2013;hard</dt><dd>clean working tree, go back to last commit but keep the untracked.</dd>
<dt><code>git reset</code></dt><dd>undo <code>git add .</code></dd>
<dt>git clean -dfn</dt><dd>remove untracked files</dd>

<dt>git stash</dt><dd>Save and remove working directory changes</dd>
</dl>
<p>
<code>git stash list</code> List all stashes
<code>git stash apply</code> Apply latest stash
<code>git stash apply stash@{2}</code> Apply 2nd latest stash
<code>git stash drop stash@{0}</code> Remove latest stash
</p>
</div>
</div>

<div id="outline-container-orgd724276" class="outline-3">
<h3 id="orgd724276"><span class="section-number-3">28.6</span> Commit an empty folder</h3>
<div class="outline-text-3" id="text-28-6">
<p>
In the empty folder add .gitignore file
</p>

<pre class="example">
# Not to ignore .gitignore
!.gitignore

# Or you intend to keep the folder empty, exclude everything
*

</pre>
</div>
</div>

<div id="outline-container-orgd71ce6d" class="outline-3">
<h3 id="orgd71ce6d"><span class="section-number-3">28.7</span> Checkout vs Reset vs Revert</h3>
<div class="outline-text-3" id="text-28-7">
<p>
Let's current branch has c1, c2 and c3 commits in order
</p>

<p>
<code>git checkout c1</code> :: sets branch to commit 1 in a detached HEAD state. 
HEAD is not at tip of branch. It's at that commit. Not changing anything. git checkout &lt;branchname&gt; to go back to HEAD
</p>

<p>
<code>git checkout c1 .</code> or <code>git checkout -f c1 -- .</code> sets branch to commit c1 but about to make a commit c4 (Changes to be committed) that is after c3.
c4 contains all the necessary changes for going back to c1.
</p>

<p>
<code>git reset c1</code> :: sets branch to commit 1.
Reset rewrites history. Only use it for local changes that are never pushed to remote.
</p>

<p>
<code>git revert c1 --no-edit</code> undoes commit 1 and creates a commit. &#x2013;no-edit means to skip the commit message.
</p>
</div>
</div>

<div id="outline-container-orgaa9a113" class="outline-3">
<h3 id="orgaa9a113"><span class="section-number-3">28.8</span> Checkout a folder from another branch to current branch</h3>
<div class="outline-text-3" id="text-28-8">
<p>
current branch is master and get folder target-folder/ from feature branch
</p>
<pre class="example">
git checkout master
git checkout feature target-folder/
</pre>
</div>
</div>

<div id="outline-container-org9283883" class="outline-3">
<h3 id="org9283883"><span class="section-number-3">28.9</span> Branch</h3>
<div class="outline-text-3" id="text-28-9">
</div>
<div id="outline-container-orgcd8042d" class="outline-4">
<h4 id="orgcd8042d"><span class="section-number-4">28.9.1</span> Duplicate current branch with changes and switch to it</h4>
<div class="outline-text-4" id="text-28-9-1">
<pre class="example">
git checkout -b newbranch
</pre>

<p>
Create a local branch and then push to a new remote branch. Save changes to a new branch.
</p>

<pre class="example">
git checkout -b newbranch
git add . &amp;&amp; git commit -m "..."
git push --set-upstream origin newbranch
</pre>
</div>
</div>

<div id="outline-container-orge1ae62b" class="outline-4">
<h4 id="orge1ae62b"><span class="section-number-4">28.9.2</span> Duplicate current branch to a commit and switch</h4>
<div class="outline-text-4" id="text-28-9-2">
<p>
git checkout -b newbranch &lt;SHA1&gt;
</p>
</div>
</div>

<div id="outline-container-orgd0a5eae" class="outline-4">
<h4 id="orgd0a5eae"><span class="section-number-4">28.9.3</span> Delete branch</h4>
<div class="outline-text-4" id="text-28-9-3">
<p>
git branch -d branchname= or <code>-D</code>
</p>
</div>
</div>

<div id="outline-container-orgf97b937" class="outline-4">
<h4 id="orgf97b937"><span class="section-number-4">28.9.4</span> Rename current branch</h4>
<div class="outline-text-4" id="text-28-9-4">
<p>
git branch -m new-branch-name
</p>
</div>
</div>

<div id="outline-container-orgfc740de" class="outline-4">
<h4 id="orgfc740de"><span class="section-number-4">28.9.5</span> Commit difference between 2 branches</h4>
<div class="outline-text-4" id="text-28-9-5">
<p>
<code>git log master..li</code>
</p>

<p>
For a specific file <code>git log master..li path/to/file</code>
</p>
</div>
</div>

<div id="outline-container-org829529c" class="outline-4">
<h4 id="org829529c"><span class="section-number-4">28.9.6</span> File difference between 2 branches</h4>
<div class="outline-text-4" id="text-28-9-6">
<p>
<code>git diff --name-status master..origin/master</code> or 
<code>git diff --stat --color master..origin/master</code>
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Missing file or line in remote branch</td>
<td class="org-left">D or -</td>
</tr>

<tr>
<td class="org-left">New file or line in remote branch</td>
<td class="org-left">A or +</td>
</tr>

<tr>
<td class="org-left">Both are modified</td>
<td class="org-left">M</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgbb5303b" class="outline-4">
<h4 id="orgbb5303b"><span class="section-number-4">28.9.7</span> Find authors of all remote/local branches and tags</h4>
<div class="outline-text-4" id="text-28-9-7">
<pre class="example">
git for-each-ref --format='%(committerdate) %09 %(authorname) %09 %(refname)' | sort -k5n -k2M -k3n -k4n
</pre>
</div>
</div>

<div id="outline-container-orgaba718d" class="outline-4">
<h4 id="orgaba718d"><span class="section-number-4">28.9.8</span> Make current branch exactly as another branch</h4>
<div class="outline-text-4" id="text-28-9-8">
<p>
Make current branch li exactly the same as remote branch origin/master
</p>
<pre class="example">
git checkout li
git reset --hard origin/master
</pre>
</div>
</div>

<div id="outline-container-org503e295" class="outline-4">
<h4 id="org503e295"><span class="section-number-4">28.9.9</span> Force push to remote branch</h4>
<div class="outline-text-4" id="text-28-9-9">
<p>
local master has different commits than remote li's master branch
</p>
<pre class="example">
git checkout master
git push li master -f
</pre>
</div>
</div>

<div id="outline-container-org9a1cacf" class="outline-4">
<h4 id="org9a1cacf"><span class="section-number-4">28.9.10</span> Find most recent ancestor of 2 branches</h4>
<div class="outline-text-4" id="text-28-9-10">
<pre class="example">
git merge-base branch2 branch3
</pre>
</div>
</div>

<div id="outline-container-org45800ca" class="outline-4">
<h4 id="org45800ca"><span class="section-number-4">28.9.11</span> Revert to common ancestor</h4>
<div class="outline-text-4" id="text-28-9-11">
<p>
You have a feature branch and master branch. Both have remote branches and are in sync.
Branch feature has some commits that master doesn't have and master are ahead of feature.
</p>

<p>
Keep the commits in feature but undo those commits and make a new commit in feature.
</p>

<p>
Find the most recent ancestor of feature and master
git merge-base feature master
</p>

<p>
Say the commit is common1
Make a new branch to test if it's a real common ancestor
git checkout feature
git checkout -b featuretest common1
git log master..featuretest // You should see nothing and featuretest is not ahead of master
</p>

<p>
Then make feature to go back to that commit without changing history
</p>

<p>
<code>=</code> Method 1 <code>=</code>
git checkout feature
<code>git checkout common1 .</code> or <code>git checkout -f c1 --.</code>
git commit -m "reset to common1"
Now you can merge master into feature
git merge &#x2013;no-commit master
</p>

<p>
<code>=</code> Method 2 <code>=</code>
<i>/ Revert commits one by one
/</i> Get commits from an old commit to HEAD
git log common1..HEAD
// or
git rev-list common1..HEAD
git revert &#x2013;no-commit D
git revert &#x2013;no-commit C
git revert &#x2013;no-commit B
&#x2026;
git commit -m "reset to common1"
</p>

<p>
<code>=</code> Method 3 <code>=</code>
// Caution! You are rewriting history on feature branch at local and remote
git checkout feature
git reset &#x2013;hard common1
git push -f
</p>
</div>
</div>

<div id="outline-container-orgafabbc5" class="outline-4">
<h4 id="orgafabbc5"><span class="section-number-4">28.9.12</span> Orphan Branch with no parent</h4>
<div class="outline-text-4" id="text-28-9-12">
<p>
<a href="#orgaf6c79b">github:gh-pages</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orgcdffa89" class="outline-3">
<h3 id="orgcdffa89"><span class="section-number-3">28.10</span> Merge</h3>
<div class="outline-text-3" id="text-28-10">
</div>
<div id="outline-container-orgdebcd79" class="outline-4">
<h4 id="orgdebcd79"><span class="section-number-4">28.10.1</span> &#x2013;no-commit vs &#x2013;squash</h4>
<div class="outline-text-4" id="text-28-10-1">
<p>
&#x2013;no-commit creates a merge commit if it can be fast-forwarded. If not, fix the conflict and git add files then commit.
&#x2013;squash merges and modifies working tree but doesn't make a commit at all. Commit after is not a merge commit. Just a normal commit.
</p>
</div>
</div>

<div id="outline-container-org44ab724" class="outline-4">
<h4 id="org44ab724"><span class="section-number-4">28.10.2</span> Abort merge</h4>
<div class="outline-text-4" id="text-28-10-2">
<p>
git merge &#x2013;abort
</p>
</div>
</div>
</div>

<div id="outline-container-orgfc9ac08" class="outline-3">
<h3 id="orgfc9ac08"><span class="section-number-3">28.11</span> Rebase</h3>
<div class="outline-text-3" id="text-28-11">
<p>
feature branch has 1 commit ahead (C4) and 1 commit behind master (C3) and their common ancestor is C2
</p>
<div class="org-src-container">
<pre class="src src-sh">git checkout master
git pull --rebase
git checkout feature
<span style="color: #74af68;"># </span><span style="color: #74af68;">make some changes and git commit</span>
git rebase master
<span style="color: #74af68;"># </span><span style="color: #74af68;">git status to review conflicts if exist. After resolving,</span>
git add .
git rebase --continue
<span style="color: #74af68;"># </span><span style="color: #74af68;">now your commits in feature are applied on top of the tip </span>
<span style="color: #74af68;"># </span><span style="color: #74af68;">you can merge commits into one commit on feature branch to further clean up your feature branch commits</span>
git checkout master
git merge feature
</pre>
</div>

<p>
The result is feature and master are exactly the same: C2 -&gt; C3 -&gt; C4
</p>
</div>
<div id="outline-container-org540f07b" class="outline-4">
<h4 id="org540f07b"><span class="section-number-4">28.11.1</span> Merge commits into one commit on local branch</h4>
<div class="outline-text-4" id="text-28-11-1">
<p>
Branch feature has 4 commits ahead of branch master
</p>

<p>
m1 &gt; c1 &gt; c2 &gt; c3 &gt; c4
</p>

<p>
Combine c2, c3 and c4 to c5 and assign a different commit message
</p>
<pre class="example">
git rebase -i c1
// open up VIM, keep the first line unchanged pick c2 and change pick to s or squash for all other commits
pick c2
s c3
s c4

// ESC and :wq to save, VIM returns that what will happen. Comment lines with # and give a new commit message without #
changes about c5

// ESC and :wq to save. Done!
</pre>
</div>
</div>
</div>

<div id="outline-container-org4c827ca" class="outline-3">
<h3 id="org4c827ca"><span class="section-number-3">28.12</span> Show merge commit</h3>
<div class="outline-text-3" id="text-28-12">
<p>
After merge or rebase happened, a merge commit is created. 
git status gives :: C0 &gt; C1 &gt; merge commit abc
</p>

<p>
See what this merge commit abc consists of. Take a look at the git status of abc, you will find 
Merge: C1 xyz
</p>

<p>
Show file names only :: git diff &#x2013;name-only C1..abc
Show commits in a merge commit :: git log C1..abc
Show file names in each commit in a merge commit :: git show &#x2013;name-only C1..abc
Show changes of a file that is caused by the merge commit :: git diff C1..abc &#x2013; path/to/file
</p>
</div>
</div>

<div id="outline-container-org8f9a726" class="outline-3">
<h3 id="org8f9a726"><span class="section-number-3">28.13</span> Fork</h3>
<div class="outline-text-3" id="text-28-13">
<p>
Sync a fork with original repo
Add a remote: upstream
</p>
<div class="org-src-container">
<pre class="src src-sh">git clone git@github.com:YOUR-USERNAME/YOUR-FORKED-REPO.git
<span style="color: #23d7d7;">cd</span> into/cloned/fork-repo
git remote -v
git remote add upstream git://github.com/ORIGINAL-DEV-USERNAME/REPO-YOU-FORKED-FROM.git
git remote -v
git fetch upstream
git pull upstream master
</pre>
</div>
</div>
</div>

<div id="outline-container-org30a0159" class="outline-3">
<h3 id="org30a0159"><span class="section-number-3">28.14</span> Remove tracking for commited files</h3>
<div class="outline-text-3" id="text-28-14">
<p>
A file is commited but you don't want to track it anymore in the future.
Remember the file will still be in Git but future clone won't grab the file.
<code>git update-index --assume-unchanged path/to/file.txt</code>
</p>

<p>
If you change your mind and want to track it again:
<code>git update-index --no-assume-unchanged path/to/file.txt</code>
</p>

<p>
Don't track a folder of files which are already commited
First try to run this because this will work with file names with space
<code>git ls-files -z myFolderToIgnore/ | xargs -0 git update-index --assume-unchanged</code>
</p>

<p>
Path is relative.
</p>

<p>
If you encounter error <code>xargs: git: bad file number</code>, run this
<code>git ls-files -- myFolderToIgnore/ | xargs -l git update-index --assume-unchanged</code>
</p>

<p>
List all assumed unchanged files
</p>
<pre class="example">
git ls-files -v | grep '[[:lower:]]'
</pre>
</div>
</div>

<div id="outline-container-orge5a7e0c" class="outline-3">
<h3 id="orge5a7e0c"><span class="section-number-3">28.15</span> Remove a commited file from file but leave in filesystem</h3>
<div class="outline-text-3" id="text-28-15">
<p>
Delete a file from Git (top of the current branch) but leave the file in filesystem
The file becomes Untracked File
</p>
<pre class="example">
git rm --cached file.txt
</pre>

<p>
Remove a folder
<code>git rm -r --cached .emacs.d/</code>
</p>

<p>
Add file to local or global ignore so that the file won't appear as Untracked File and prevent 
from staging the file when <code>git add .</code>
</p>
</div>
</div>

<div id="outline-container-orga1a2215" class="outline-3">
<h3 id="orga1a2215"><span class="section-number-3">28.16</span> Remove large files and folders</h3>
<div class="outline-text-3" id="text-28-16">
<pre class="example">
git gc
# Get the top 10 biggest files. It will take about a minute for it to run
git rev-list --objects --all | grep "$(git verify-pack -v .git/objects/pack/*.idx | sort -k 3 -n | tail -10 | awk '{print$1}')"

# path/to/bigfile1, path/to/bigfile2
# filter-branch runs on the current branch and filter through from top (HEAD) to oldest
git filter-branch --index-filter 'git rm --cached --ignore-unmatch path/to/bigfile1' HEAD
# repeat for every file

# To remove a directory
git filter-branch --index-filter 'git rm -r --cached --ignore-unmatch path/to/folder1' HEAD

# To remove files and subdirectories (except hidden files) of a directory
git filter-branch --index-filter 'git rm -r --cached --ignore-unmatch sites/default/files/*' HEAD

# filter-branch creates backups of your original refs namespaced under ~refs/original~
# Run this to delete the backed up refs, allowing the large objects to be garbage collected
git for-each-ref --format="%(refname)" refs/original/ | xargs -n 1 git update-ref -d

# if all big files are in one branch only, just delete the branch will remove all the references
# git branch -D branch-name
# Prune all reflog references from the branch on back.
# git reflog expire --expire=now branch-name

# Prune all reflog references from now to the first commit
git reflog expire --expire=now --all

# Repack the repo by running gc and pruning old objects
git gc --prune=now

# Push changes back to remote repo. All branches (refs under ~refs/heads~)
# I found I can push one branch only
git push --all --force

# Make sure tags are current and pushed to remote
git push --tags --force
</pre>

<p>
&#x2013;index-filter :: modify a repo's staging
&#x2013;cached :: remove a file from the index not the disk
&#x2013;ignore-unmatch :: prevent <code>git rm</code> from failing if the file isn't there
HEAD :: to remove from the start
</p>

<p>
Say git filter-branch is run once, and the backup <code>refs/original</code> is not deleted, the subsequent filter-branch will not run
Add -f to force it to run and overwrite <code>refs/original</code>
</p>
<pre class="example">
git filter-branch -f --index-filter [...]
</pre>

<p>
<code>git filter-branch [...] HEAD</code> just shrinks the current branch and leave the other branches intact. 
Say feature branch is a copy of master, then run filter-branch on feature. master branch and others are not affected. But now feature branch diverged from master.
The get-top-10-biggest-files command returns the same files after filter-branch and the cleanup mentioned above are done. Because it's just one branch that you cleaned up, big files are still in other branches.
You won't notice a big change in total <a href="#org19f6ea1">git:repo size</a>, as it's just one branch that had the big files removed.
I didn't try <code>git push --force</code> to update a real remote branch.
Let's say the repo is at /path/to/repo, and you duplicate master branch to shrinksize branch. Run filter-branch and the cleanup.
Then you create another folder /path/to/duplicaterepo, and clone only the shrinksize branch from the original repo
</p>

<pre class="example">
cd /path/to
mkdir duplicaterepo
cd duplicaterepo
git clone file:///path/to/repo --branch shrinksize --single-branch
cd repo
du -sh .git/objects
# push branch shrinksize to another remote as master branch
git remote add anotherremote ...
git push anotherremote shrinksize:master
</pre>
</div>
</div>

<div id="outline-container-orgec85d12" class="outline-3">
<h3 id="orgec85d12"><span class="section-number-3">28.17</span> Commit History</h3>
<div class="outline-text-3" id="text-28-17">
<p>
<code>git log --graph</code>
<code>git log -3</code> Last 3 commits
<code>git log --grep=&lt;pattern&gt;</code> Search commit message
</p>

<p>
%s :: subject (commit message)
</p>
<pre class="example">
#!/bin/bash

TMPLOG=/mnt/e/project-logs.csv
touch $TMPLOG
echo "" &gt; $TMPLOG
gitrepos=( '/mnt/e/li/repo1' '/mnt/e/li/repo2' )

for i in "${gitrepos[@]}"; do
   if [ -d $i ] &amp;&amp; [ -d $i/.git ]; then
      cd $i
      git log --since='last 2 months' --pretty=format:"$i,%ai,%s" &gt;&gt; $TMPLOG
      # After and including May 1, 2018
      # git log --after='2018-5-1'
      echo "" &gt;&gt; $TMPLOG
      cd ..
   fi;
done
</pre>
</div>
</div>

<div id="outline-container-org496e3a2" class="outline-3">
<h3 id="org496e3a2"><span class="section-number-3">28.18</span> Head Detached Mode, checkout previous commit</h3>
<div class="outline-text-3" id="text-28-18">
<p>
At the current branch master, find hash of the old commit that you want to revert back to and checkout
</p>
<pre class="example">
git checkout a1b2c3
</pre>

<p>
when you are done, set the HEAD back to the front
</p>
<pre class="example">
git checkout master
</pre>
</div>
</div>

<div id="outline-container-orgda34908" class="outline-3">
<h3 id="orgda34908"><span class="section-number-3">28.19</span> Local Ignore, Global Ignore, git status -u</h3>
<div class="outline-text-3" id="text-28-19">
<dl class="org-dl">
<dt>Show untracked files</dt><dd><code>git status -u</code></dd>

<dt>(no term)</dt><dd>Add file or directory paths to
<ul class="org-ul">
<li>.git/info/exclude/ (will not be committed)</li>
<li>.gitignore file (will be commited)</li>
<li>Create <code>touch .gitignore</code></li>
</ul></dd>

<dt>Add global ignore file</dt><dd><code>~\.gitignore_global</code> and run <code>git config --global core.excludesfile ~/.gitignore_global</code></dd>
</dl>

<p>
Sometimes, Windows is set up for all applications to use user profile folder at a different location, e.g. phpStorm
</p>
<dl class="org-dl">
<dt>Find which config files set a certain config</dt><dd><code>git config --list --show-origin</code></dd>
<dt>(no term)</dt><dd>Change excludesfile to a folder location that you know under <code>[core]</code> after <code>git config --global -e</code> (edit the global config file)</dd>
<dt>(no term)</dt><dd>Or try this <code>git config --global core.excludesfile K:/.gitignore_global</code></dd>

<dt>Show all ignored files</dt><dd><code>git status --ignored</code></dd>
<dt>Why a file is ignored</dt><dd><code>git check-ignore -v path/to/filename</code></dd>
</dl>

<p>
After 1.8.2, <code>**</code> can be used to mean zero or more sub-directories (relative to the place where .gitignore is)
<code>bin/</code> ignores any folder named bin
<code>/bin/</code> ignores one folder named bin relative to the .gitignore file
</p>

<p>
However, if there're more than 1 folder
<code>wp-content/uploads/</code> only ignore /wp-content/uploads.
Use <code>**/wp-content/uploads/</code> to ignore any folder that has path <code>wp-content/uploads</code>
</p>

<pre class="example">
/main/**/bin/
</pre>

<p>
Negate
An optional prefix ! which negates the pattern; any matching file excluded by a previous pattern will become included again. If a negated pattern matches, this will override lower precedence patterns sources.
</p>
<pre class="example">
# Ignore everything

*

# But don't ignore these files...
!.gitignore
!script.pl
!template.latex
# etc...

# ...even if they are in subdirectories. (don't ignore first level subdirectories)
# without this line, script.pl will only be included in the root directory
!*/
</pre>

<p>
If you want to ignore a folder but don't ignore a file, create .gitignore in that folder
</p>
<pre class="example">
*
!.gitignore
!*.sql
!*/
</pre>

<p>
Escape square brackets
</p>
<pre class="example">
e.g. ignore a directory site[123]
site\[123\]
</pre>

<dl class="org-dl">
<dt>Ignore files whose name ends in <code>~</code> which is a usual suffix for text editors backup files</dt><dd><code>*~</code></dd>
</dl>

<p>
<a href="https://www.atlassian.com/git/tutorials/gitignore">https://www.atlassian.com/git/tutorials/gitignore</a>
</p>
</div>

<div id="outline-container-orgaf6d555" class="outline-4">
<h4 id="orgaf6d555"><span class="section-number-4">28.19.1</span> WordPress .gitignore <a id="org5006e6c">git:gitignore:wordpress</a></h4>
<div class="outline-text-4" id="text-28-19-1">
<pre class="example">
*~
cgi-bin/
.well-known/
.DS_Store
.svn
.cvs
*.bak
*.swp
Thumbs.db
wp-config.php
wp-content/uploads/
wp-content/blogs.dir/
wp-content/upgrade/
wp-content/backup-db/
wp-content/advanced-cache.php
wp-content/wp-cache-config.php
wp-content/w3tc-config/*
wp-content/cache/*
wp-content/cache/supercache/*
*.log
error_log
wp-content/plugins/error_log
wp-content/cache/
wp-content/backups/
sitemap.xml
sitemap.xml.gz
sql-admin/
cs-devops/
</pre>
</div>
</div>

<div id="outline-container-orge52a1f8" class="outline-4">
<h4 id="orge52a1f8"><span class="section-number-4">28.19.2</span> NodeJS, NPM .gitignore</h4>
<div class="outline-text-4" id="text-28-19-2">
<pre class="example">
node_modules
npm-debug.log
</pre>
</div>
</div>
</div>

<div id="outline-container-org68128a6" class="outline-3">
<h3 id="org68128a6"><span class="section-number-3">28.20</span> Customize Settings per folder</h3>
<div class="outline-text-3" id="text-28-20">
<p>
For a single repository, attributes should be placed in <code>$GIT_DIR/info/attributes</code> file.
<code>$GIT_DIR</code> is the repository. But this file won't be commited.
</p>

<p>
If you want to commit, <code>.gitattributes</code> file in the root <code>$GIT_DIR</code> or any sub folders.
</p>

<pre class="example">
# Syntax
# pattern attr1 attr2 ...
*.txt text*.js text*.html text*.md text*.json text*.svg text

# text is an attribute without value. `Set [attr] to true`

*.pdf -text

# text is again an attribute without value but prefixed with -. `Unset [attr] or Set [attr] to false`

*.txt text eol=lf

# Set text to true and Set eol to a value lf
</pre>
</div>
</div>

<div id="outline-container-orgdf22964" class="outline-3">
<h3 id="orgdf22964"><span class="section-number-3">28.21</span> Git Windows</h3>
<div class="outline-text-3" id="text-28-21">
<dl class="org-dl">
<dt><code>gitk</code></dt><dd>GUI</dd>
<dt><code>start path/to/filename</code></dt><dd>to tell Windows to open a file</dd>
<dt>(no term)</dt><dd>edit a file using vi <code>vi afile</code></dd>
<dt>Run tree command</dt><dd><code>cmd //c tree</code></dd>
<dt>(no term)</dt><dd>At Git Bash, open the current folder in Windows Explorer <code>explorer .</code></dd>
</dl>
</div>

<div id="outline-container-org6310a81" class="outline-4">
<h4 id="org6310a81"><span class="section-number-4">28.21.1</span> Line Feed, Long Path</h4>
<div class="outline-text-4" id="text-28-21-1">
<p>
Always don't do any conversion when files are added to local index or codes are checked out to local filesystem.
<code>git config --global core.autocrlf false</code>
Do git clone again.
</p>

<p>
You may encouter <code>file name too long</code> or <code>pathname too long</code> error.
Change the git setting
<code>git config --system core.longpaths true</code>
</p>
</div>
</div>

<div id="outline-container-orgb0746eb" class="outline-4">
<h4 id="orgb0746eb"><span class="section-number-4">28.21.2</span> Special characters in filename</h4>
<div class="outline-text-4" id="text-28-21-2">
<p>
You can git clone in Linux, tar it and untar it using 7zip on Windows. 7zip will change the filenames to fit in Windows.
</p>
</div>
</div>

<div id="outline-container-org42e24d8" class="outline-4">
<h4 id="org42e24d8"><span class="section-number-4">28.21.3</span> File name case-insensitive</h4>
<div class="outline-text-4" id="text-28-21-3">
<p>
Git has 2 file names the same except casing. After clone to Windows, you will find Changes not staged for commit.
</p>

<p>
If the files are not important and you are not going to modify them on Windows, you can tell your local Windows Git not to checkout those files.
</p>

<pre class="example">
git config core.sparsecheckout true
echo '*' &gt;.git/info/sparse-checkout
echo '!unwanted_dir/unwanted_filename' &gt;&gt;.git/info/sparse-checkout
# I found just unwanted_dir/ is not enought, have to repeat each problematic files returned by `git status`
git read-tree --reset -u HEAD
git status
</pre>

<p>
If the files are important, you can use Git in <code>Bash on Windows</code>, it will checkout files with case-sensitive names. But all other Windows applications including Git Windows and phpStorm will report wrong Git info. Keep using Bash on Windows to Git.
</p>

<p>
It's better to fix the file names on Linux, commit and push and work on local.. 
</p>
</div>
</div>
</div>

<div id="outline-container-orgaad7bb5" class="outline-3">
<h3 id="orgaad7bb5"><span class="section-number-3">28.22</span> Multiple Github accounts and https</h3>
<div class="outline-text-3" id="text-28-22">
<p>
You manage 2 Github accounts.
git clone does not require credentials for https
When you push to the remote which is under Github account A, Windows asks you for credentials
After that, your credentials for account A is stored under <a href="#org9682045">Windows Credential Store Panel</a> (WCSP).
You can add account A to an account B's repository as a collaborator.
Any push will be made by account A.
</p>

<p>
You have to delete 2 Github credentials from WCSP and then push commits to account B's repository 
and then use account B's credential if you want to completely switch account.
</p>

<p>
If you want to switch between multiple Github accounts frequently, use SSH instead of https
</p>

<p>
SSH might be blocked in public internet networks though.
</p>

<p>
Git has upgraded credential helper from manager to wincred.
git config &#x2013;global crendential.helper wincred
</p>
</div>
</div>

<div id="outline-container-org5c514da" class="outline-3">
<h3 id="org5c514da"><span class="section-number-3">28.23</span> Clone to an empty folder</h3>
<div class="outline-text-3" id="text-28-23">
<pre class="example">
cd ~/expressjs
# add .git at the end
# --bare means to clone all branches
git clone --bare https://githublink/express.git .git
git config --bool core.bare false
git reset --hard
</pre>
</div>
</div>

<div id="outline-container-orga7e04f6" class="outline-3">
<h3 id="orga7e04f6"><span class="section-number-3">28.24</span> Clone or Pull to existing repository</h3>
<div class="outline-text-3" id="text-28-24">
</div>
<div id="outline-container-org4154fe9" class="outline-4">
<h4 id="org4154fe9"><span class="section-number-4">28.24.1</span> Existing repo is not git initialized</h4>
<div class="outline-text-4" id="text-28-24-1">
<p>
The existing repo has some other files that need to keep but not version controlled.
In the existing repo run
</p>

<div class="org-src-container">
<pre class="src src-sh">git init
git remote add origin https://github.com/username/reponame.git
git fetch --all
git reset --hard origin/master
<span style="color: #74af68;"># </span><span style="color: #74af68;">dump all untracked changes and checkout remote master branch</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge2b9fce" class="outline-4">
<h4 id="orge2b9fce"><span class="section-number-4">28.24.2</span> Existing repo is git initialized</h4>
<div class="outline-text-4" id="text-28-24-2">
<p>
Pull from remote and put changes to staged without commit (ready to commit)
</p>
<pre class="example">
git pull --no-rebase --squash -Xtheirs origin master
# origin can be a different upstream in URL format
# git://github.com/pantheon-systems/drops-7.git
# the remote that's pulled from usually has the same codebase as your current local repo
</pre>
</div>
</div>
</div>

<div id="outline-container-org373ef4a" class="outline-3">
<h3 id="org373ef4a"><span class="section-number-3">28.25</span> Clone a subdirectory</h3>
<div class="outline-text-3" id="text-28-25">
<p>
Just clone examples/shopping-cart directory from branch dev
</p>
<pre class="example">
git init &lt;repo&gt;
cd &lt;repo&gt;
git remote add origin https://github.com/vuejs/vuex.git
git config core.sparsecheckout true
echo "examples/shopping-cart/*" &gt;&gt; .git/info/sparse-checkout
git pull --depth=1 origin master
</pre>

<p>
Result is ./&lt;repo&gt;/examples/shopping-cart
</p>
</div>
</div>

<div id="outline-container-org463d811" class="outline-3">
<h3 id="org463d811"><span class="section-number-3">28.26</span> Track local branch with a remote branch <a id="orge4ff390">git:upstream</a></h3>
<div class="outline-text-3" id="text-28-26">
<pre class="example">
git branch --set-upstream master origin/master
</pre>

<p>
List all local branches' upstream remotes
</p>
<pre class="example">
git branch -vv
</pre>
</div>
</div>

<div id="outline-container-orga607a18" class="outline-3">
<h3 id="orga607a18"><span class="section-number-3">28.27</span> List all remote repo</h3>
<div class="outline-text-3" id="text-28-27">
<pre class="example">
# List all remote URL's 
git remote -v
</pre>
</div>
</div>

<div id="outline-container-org21bb899" class="outline-3">
<h3 id="org21bb899"><span class="section-number-3">28.28</span> Repo size, maintenance <a id="org19f6ea1">git:repo size</a></h3>
<div class="outline-text-3" id="text-28-28">
<pre class="example">
git gc
git count-objects -vH

# I found this better
du -hs .git/objects
</pre>
</div>
</div>

<div id="outline-container-org9e2dfaa" class="outline-3">
<h3 id="org9e2dfaa"><span class="section-number-3">28.29</span> Number of tracked files</h3>
<div class="outline-text-3" id="text-28-29">
<p>
Doesn't include directories. Only files
<code>git ls-files | wc -l</code>
</p>
</div>
</div>

<div id="outline-container-org262a868" class="outline-3">
<h3 id="org262a868"><span class="section-number-3">28.30</span> GitHub Push to New Repo with local repo</h3>
<div class="outline-text-3" id="text-28-30">
<p>
Create a new repo on Github.com without creating any .gitignore, README nor license
On local, git init, add .gitignore, git add . and check if files are ignored, git commit -m "1st commit"
</p>

<p>
Add a remote
<code>git remote add origin ssh_or_github_https_link_with_.git_at_the_end</code>
</p>

<p>
List all remotes <code>git remote -v</code>
Remove a remote 'origin' <code>git remote rm origin</code>
</p>

<p>
Local branch is not set to sync with remote until you do the first push with '-u'
<code>git push -u origin master</code>
</p>

<p>
Finally check <code>cat .git/config</code> to see if local branch "master" has setup a remote
</p>
<pre class="example">
[branch "master"]
        remote = origin
        merge = refs/heads/master
</pre>

<p>
You may encounter 403 Forbidden and HTTP request failed errors. Try to use SSH or modify the HTTPS url
</p>
<pre class="example">
https://[GITHUB_USERNAME]@github.com/[GITHUB_USERNAME]/[REPO_NAME].git
Instead of the original
https://github.com/[GITHUB_USERNAME]/[REPO_NAME].git
</pre>
</div>
</div>

<div id="outline-container-org1bf664a" class="outline-3">
<h3 id="org1bf664a"><span class="section-number-3">28.31</span> Add a remote, remove a remote and its branches, change upstream</h3>
<div class="outline-text-3" id="text-28-31">
<pre class="example">
git remote add origin https://...
git remote -v
git remote rm origin
// rename a remtoe
git remote rename origin li
git branch master --set-upstream-to origin/master
</pre>
</div>
</div>

<div id="outline-container-org5b0bb6a" class="outline-3">
<h3 id="org5b0bb6a"><span class="section-number-3">28.32</span> Push to 2 remotes</h3>
<div class="outline-text-3" id="text-28-32">
<p>
An existing remote: origin
</p>
<pre class="example">
git remote add origin ssh_or_github_https_link_with_.git_at_the_end
# check remotes
git remote -v
# cat .git/config
[remote "origin"]
  url=ssh://.../repo.git
  fetch= +refs/heads/*:refs/remotes/origin/*
</pre>

<p>
Method 1: Configure Origin as a Multi-Remote Destination
Add another push URL for origin within <code>.git/config</code>
Commits will be pushed to both remote destinations automatically on <code>git push origin</code>
</p>
<pre class="example">
[remote "origin"]
  url=ssh://.../repo.git
  url = git@github.com:username/reponame.git
  fetch= +refs/heads/*:refs/remotes/origin/*
</pre>

<p>
Method 2: Add another remote github
</p>
<pre class="example">
git remote add github git@github.com:username/reponame.git
# or a https directly from github
# Push and track the current local branch master
git push -u github master
</pre>
</div>
</div>

<div id="outline-container-org89c2c16" class="outline-3">
<h3 id="org89c2c16"><span class="section-number-3">28.33</span> Tag</h3>
<div class="outline-text-3" id="text-28-33">
<pre class="example">
# list all tags
git tag
# search tags
git tag -l "v1.8.5*"

# Make annotated tag and assign to the HEAD
git tag -a v1.4 -m "tagging message"

# Show a tag
git show 

# make lightweigth tag and assign to the HEAD
git tag v1.4-lw

# lightweight tag doens't show anything when git show

# Attach an annotated tag at a specific commit
git tag -a v1.2 0fceb02

git push origin [tagname]
# or
git push origin --tags

git describe --long --match 'live*'
# live-10-g7digits
# HEAD is now 10 commits ahead of tag live
</pre>
</div>
</div>

<div id="outline-container-org69fcc14" class="outline-3">
<h3 id="org69fcc14"><span class="section-number-3">28.34</span> Submodule</h3>
<div class="outline-text-3" id="text-28-34">
<pre class="example">
// create a folder DbConnector in parent project directory root folder
cd /parent
git submodule add https://github.com/chaconinc/DbConnector
// change the subfolder name from DbConnector to dbconnector
// git submodule add https://github.com/chaconinc/DbConnector dbconnector
</pre>
</div>
</div>

<div id="outline-container-org24a767c" class="outline-3">
<h3 id="org24a767c"><span class="section-number-3">28.35</span> Github API</h3>
<div class="outline-text-3" id="text-28-35">
<p>
REST API v3 :: <a href="https://developer.github.com/v3/">https://developer.github.com/v3/</a>
</p>

<p>
Get repo size
</p>
<pre class="example">
# for public repo, auth is not required
curl https://api.github.com/repos/:owner/:reponame | grep size

# for private repo
curl -u ownername:password https://api.github.com/repos/:owner/:reponame | grep size

// sort repos of user:alibaba by number of stars
https://github.com/search?q=user%3Aalibaba+&amp;s=stars&amp;type=Repositories
</pre>
</div>
</div>

<div id="outline-container-orga595284" class="outline-3">
<h3 id="orga595284"><span class="section-number-3">28.36</span> Github Pages</h3>
<div class="outline-text-3" id="text-28-36">
<p>
You can add /docs folder to your repository on master and enable GitHub Pages in the repository setting
Or you can create an orphan branch called gh-pages
</p>

<p>
If you don't have branch gh-pages or /docs in master branch, just click on Launch automatic page generator and it will create the gh-pages branch with Jekyll files.
</p>

<p>
Project website is <a href="https://levonlee.github.io/reponame">https://levonlee.github.io/reponame</a> or a domain docs.abc.com CNAME YOUR-GITHUB-USERNAME.github.io then it'd be <a href="https://docs.abc.com/reponame">https://docs.abc.com/reponame</a> 
</p>

<p>
<a id="orgaf6c79b">github:gh-pages</a>
</p>
<div class="org-src-container">
<pre class="src src-sh">git checkout --orphan gh-pages
git rm -rf .
git commit -m <span style="color: #e67128;">"GitHub Pages"</span>
</pre>
</div>

<p>
For User or Organization Site, create repo levonlee.github.io and add index.html and push to repo
</p>
</div>

<div id="outline-container-org11000e6" class="outline-4">
<h4 id="org11000e6"><span class="section-number-4">28.36.1</span> SVG, View HTML</h4>
<div class="outline-text-4" id="text-28-36-1">
<p>
<a href="http://rawgit.com/">http://rawgit.com/</a>
</p>

<p>
Image files other than SVG can be served directly from GitHub using Raw Repo Path.
</p>
<dl class="org-dl">
<dt>Blob Repo Path</dt><dd><code>https://github.com/levonlee/cssSandbox/blob/master/assets/img/sprite.svg</code></dd>
<dt>(no term)</dt><dd>Raw Repo Path
<ul class="org-ul">
<li><code>https://github.com/levonlee/cssSandbox/raw/master/assets/img/300x250x1.jpg</code></li>
<li><code>https://raw.githubusercontent.com/levonlee/cssSandbox/master/assets/img/300x250x1.jpg</code></li>
</ul></dd>
</dl>

<p>
For svg and html, use rawgit
</p>
<dl class="org-dl">
<dt>RawGit Path</dt><dd>/levonlee/reponame/master/folder1/s1.svg</dd>
<dt>RawGit Path for Gist</dt><dd><i>levonlee</i>[long-gist-id]/raw/index.html</dd>
<dt>Whole Path</dt><dd><code>https://rawgit.com/levonlee/cssSandbox/master/{dir}/index.html</code></dd>
<dt>Whole Path for Gist</dt><dd><code>https://gist.githubusercontent.com/levonlee/[long-gist-id]/raw/index.html</code></dd>
</dl>

<p>
Development (Traffic limited)
<a href="https://rawgit.com/">https://rawgit.com/</a> + RawGit Path
Production (No traffic limit, permanently cached, no url query param)
<a href="https://cdn.rawgit.com/">https://cdn.rawgit.com/</a> + RawGit Path
</p>
</div>
</div>

<div id="outline-container-org481b834" class="outline-4">
<h4 id="org481b834"><span class="section-number-4">28.36.2</span> Markdown</h4>
<div class="outline-text-4" id="text-28-36-2">
<p>
<code>![Alt text](http://url/to/img.png)</code>
</p>
</div>
</div>
</div>

<div id="outline-container-org86d0f7d" class="outline-3">
<h3 id="org86d0f7d"><span class="section-number-3">28.37</span> Troubleshooting</h3>
<div class="outline-text-3" id="text-28-37">
</div>
<div id="outline-container-org74ad956" class="outline-4">
<h4 id="org74ad956"><span class="section-number-4">28.37.1</span> unable to create thread: Resource temporarily unavailable</h4>
<div class="outline-text-4" id="text-28-37-1">
<p>
It could stop you from pushing to remote repo
Try using ssh server instead.
</p>
</div>
</div>

<div id="outline-container-org96169b8" class="outline-4">
<h4 id="org96169b8"><span class="section-number-4">28.37.2</span> warning: suboptimal pack - out of memory</h4>
<div class="outline-text-4" id="text-28-37-2">
<p>
This may happen in shared hosting with limited resources..
</p>
<pre class="example">
Counting objects: 2422, done.
Delta compression using up to 48 threads.
warning: suboptimal pack - out of memory
fatal: inflate: out of memory52/2395)
error: failed to push some refs to 'user@host:directory/repo-name.git'
</pre>

<p>
Pay attention to the Delta compression using 48 threads. Change it to only 1 thread
</p>
<pre class="example">
git config --global pack.threads 1
</pre>

<p>
fatal: unable to create threaded lstat
</p>
<pre class="example">
git config core.preloadIndex false
# or
# git config --global core.preloadIndex false
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgcd6b261" class="outline-2">
<h2 id="orgcd6b261"><span class="section-number-2">29</span> BitBucket</h2>
<div class="outline-text-2" id="text-29">
</div>
<div id="outline-container-org6affe10" class="outline-3">
<h3 id="org6affe10"><span class="section-number-3">29.1</span> Basic</h3>
<div class="outline-text-3" id="text-29-1">
<p>
BitBucket can create priviate repo for free! Limit each repo to 1gb.
</p>

<p>
Create a private repo on BitBucket UI.
</p>

<p>
For existing local Git repo, add a remote
</p>

<pre class="example">
cd /path/to/local/repo
git remote add bb https://username@bitbucket.org/username/reponame.git
# git push -u bb localbranch
# e.g. git push -u bb master
# git push -u bb localbranch:repobranch
# e.g. git push -u bb master:masteronbb
</pre>

<p>
<code>git push -u remotename localbranch</code> pushes the code to a remote and set the remote as upstream remote.
</p>

<p>
By default, <code>git push</code> pushes code at current local branch to the same branch on upstream remote.
</p>

<p>
See <a href="#orge4ff390">git:upstream</a> to change local branch's upstream remote branch
</p>

<p>
.git/config
</p>
<pre class="example">
[branch "master"]
        remote = origin
        merge = refs/heads/master
</pre>

<p>
git branch -vv
</p>
<pre class="example">
  localbranch1 hexcode [origin/localbranch1] last commit msg
* master       hexcode [origin/master] last commit msg
  localbranch2 hexcode [origin/localbranch2] last commit msg
</pre>
</div>
</div>
</div>

<div id="outline-container-org15f1c31" class="outline-2">
<h2 id="org15f1c31"><span class="section-number-2">30</span> Pantheon <a id="org19279be">hosting:pantheon</a></h2>
<div class="outline-text-2" id="text-30">
</div>
<div id="outline-container-orgef07ac2" class="outline-3">
<h3 id="orgef07ac2"><span class="section-number-3">30.1</span> Deploy</h3>
<div class="outline-text-3" id="text-30-1">
<pre class="example">
terminus site deploy --site=&lt;s&gt; --env=&lt;e&gt; --sync-content --cc
terminus env:deploy my-site.test --sync-content --note="Deploy core and contrib updates" --cc
</pre>
</div>
</div>

<div id="outline-container-orgca7b1c6" class="outline-3">
<h3 id="orgca7b1c6"><span class="section-number-3">30.2</span> pantheon.yml</h3>
<div class="outline-text-3" id="text-30-2">
<p>
In the code directory. You need to commit to take effect.
</p>

<p>
PHP supported version :: 5.3, 5.5, 5.6, and 7.0.
Drush version: 5, 7, or 8. 8 is recommended
</p>
</div>
</div>

<div id="outline-container-orga7fd391" class="outline-3">
<h3 id="orga7fd391"><span class="section-number-3">30.3</span> Drush <a id="org41f4e6a">Pantheon Drush</a></h3>
<div class="outline-text-3" id="text-30-3">
<pre class="example">
terminus drush "&lt;drush command&gt; &lt;drush args&gt;" --site=&lt;&gt; --env=&lt;&gt; 
terminus remote:drush site-name.env-name drush-command
terminus remote:drush site-name.env-name -- ws --tail
terminus env:clear-cache site-name.env-name
terminus remote:drush &lt;site&gt;.&lt;env&gt; -- cc all
</pre>

<p>
If a module is updated via Pantheon terminus drush up, original module folder will be saved to /drush-backups/pantheon/date/modules/modulename
</p>

<p>
In order for drush cc all to clear Varnish cache, <a href="https://pantheon.io/docs/pantheon_api-module/">pantheon_api</a> module (in Pantheon upstream) must be enabled.
</p>

<p>
<a id="org2fea9d7">pantheon:drupal:alias</a>
Download Pantheon Aliases
terminus sites aliases
</p>

<p>
Drush version (5, 7, or 8) 8 is recommended for all Drupal version.
terminus drush "status" &#x2013;site=&lt;&gt; &#x2013;env=&lt;&gt;
</p>

<p>
.drush folder is at one level higher than the code folder
You can put custom drush commands into this folder. For example,
drush @pantheon.SITE.ENV dl utf8mb4_convert-7.x
Will put utf8mb4_convert/utf8mb4_convert.dursh.inc under .drush/ folder
Then you clear drush cache before using the new command
drush @pantheon.SITE.ENV cc drush
</p>
</div>
</div>

<div id="outline-container-org781378f" class="outline-3">
<h3 id="org781378f"><span class="section-number-3">30.4</span> WP CLI <a id="org41e2f94">WP CLI Pantheon</a></h3>
<div class="outline-text-3" id="text-30-4">
<pre class="example">
terminus wp 'option get home' --site=&lt;site&gt; --env=dev
</pre>
</div>
</div>

<div id="outline-container-orga2f3daf" class="outline-3">
<h3 id="orga2f3daf"><span class="section-number-3">30.5</span> Drupal Core Update</h3>
<div class="outline-text-3" id="text-30-5">
<p>
<a id="orgdf7b140">pantheon:drupal:core</a>
</p>
</div>
<div id="outline-container-orgea8b3af" class="outline-4">
<h4 id="orgea8b3af"><span class="section-number-4">30.5.1</span> UI</h4>
<div class="outline-text-4" id="text-30-5-1">
<p>
Create a multidev of the current Live, then hit the upgrade button.
Check everything. If it's ok, do this on Dev, then pull code from Dev to Test, and then Live
Done!
</p>

<p>
To update other multidevs, after Dev master is updated, pull code from Dev to multidev and run update.php
Check Status from Pantheon.
</p>
</div>
</div>

<div id="outline-container-org6c42a00" class="outline-4">
<h4 id="org6c42a00"><span class="section-number-4">30.5.2</span> Manual pull from upstream to resolve conflicts</h4>
<div class="outline-text-4" id="text-30-5-2">
<p>
Check on Pantheon UI to find out the Upstream : Settings &gt; About site
e.g. <a href="https://github.com/pantheon-systems/drops-7">https://github.com/pantheon-systems/drops-7</a>
</p>

<pre class="example">
# add a remote
git remote add pantheon-drops-7 git://github.com/pantheon-systems/drops-7.git
git fetch pantheon-drops-7
git rebase pantheon-drops-7/master
# resolve conflicts
git add .
git rebase --continue
git push origin branchname(e.g. master)
</pre>

<p>
I found that the UI pull from upstream can resolve the following error while in manual pull
So use UI pull whenever possible.
</p>
<pre class="example">
First, rewinding head to replay your work on top of it...
Applying: Adding project shell
fatal: mode change for modules/pantheon/pantheon_api/pantheon_api.install, which is not in current HEAD
error: could not build fake ancestor
Patch failed at 0001 Adding project shell
The copy of the patch that failed is found in: .git/rebase-apply/patch

When you have resolved this problem, run "git rebase --continue".
If you prefer to skip this patch, run "git rebase --skip" instead.
To check out the original branch and stop rebasing, run "git rebase --abort".
</pre>
</div>
</div>
</div>

<div id="outline-container-org7755ec9" class="outline-3">
<h3 id="org7755ec9"><span class="section-number-3">30.6</span> Drupal Cron</h3>
<div class="outline-text-3" id="text-30-6">
<p>
Pantheon runs cron within 5 to 10 minutes of half past each hour: 4:30pm, 5:30pm, 6:30pm, etc.
<code>drush pantheon_cron 3600</code>
This bootstraps the site and invokes drupal_cron_run.
</p>

<p>
If the site is not accessed for at least 2 hours, Pantheon suspends all associated services and thus cron will not run.
</p>
</div>
</div>

<div id="outline-container-orge8bb480" class="outline-3">
<h3 id="orge8bb480"><span class="section-number-3">30.7</span> Determine Environment <a id="orge388abe">pantheon:environment</a></h3>
<div class="outline-text-3" id="text-30-7">
<div class="org-src-container">
<pre class="src src-php"><span style="color: #ffad29; font-weight: bold;">if</span> (defined(<span style="color: #e67128;">'PANTHEON_ENVIRONMENT'</span>) &amp;&amp; <span style="color: #008b8b;">PANTHEON_ENVIRONMENT</span> == <span style="color: #e67128;">'dev'</span>) {} 

<span style="color: #ffad29; font-weight: bold;">if</span> (<span style="color: #ffad29; font-weight: bold;">isset</span>(<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_SERVER</span>[<span style="color: #e67128;">'PANTHEON_ENVIRONMENT'</span>])) {
 <span style="color: #74af68;">// </span><span style="color: #74af68;">Web only excluding Drush </span>
 <span style="color: #ffad29; font-weight: bold;">if</span> (<span style="color: #e1e1e0; background-color: #2d3743;">$</span><span style="color: #dbdb95;">_SERVER</span>[<span style="color: #e67128;">'PANTHEON_ENVIRONMENT'</span>] == <span style="color: #e67128;">'dev'</span>) {
  <span style="color: #74af68;">// </span><span style="color: #74af68;">Web only excluding Drush and on dev</span>
 }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org54f5fba" class="outline-3">
<h3 id="org54f5fba"><span class="section-number-3">30.8</span> Disable Newrelic</h3>
<div class="outline-text-3" id="text-30-8">
<p>
<a href="https://pantheon.io/docs/new-relic">https://pantheon.io/docs/new-relic</a>
</p>

<p>
Newrelic may inject javascript in pages.. Disable it
</p>

<p>
Drupal (sites/default/settings.php)
</p>
<pre class="example">
if (function_exists('newrelic_ignore_transaction')) {
 newrelic_ignore_transaction();
}
</pre>
</div>
</div>

<div id="outline-container-org77f8d75" class="outline-3">
<h3 id="org77f8d75"><span class="section-number-3">30.9</span> Cookie <a id="org123d210">pantheon:cookie</a></h3>
<div class="outline-text-3" id="text-30-9">
<p>
<a href="https://pantheon.io/docs/cookies">https://pantheon.io/docs/cookies</a>
</p>

<p>
cookies set by javascript or at client side must have this name structure :: STYXKEY[a-zA-Z0-9_-]
e.g. STYXKEY_my-key-name
</p>

<p>
So that php can read them. And cookies set in this way should change the value on client side once it's been set.
</p>

<p>
Content pages with same cookies (with this name structure) and same url will be cached.
</p>

<p>
A cookie can be set in PHP in a response to prevent caching
</p>
<pre class="example">
if ((preg_match($regex_path_match, $_SERVER['REQUEST_URI'])) {
  $domain =  $_SERVER['HTTP_HOST'];
  setcookie('NO_CACHE', '1', time()+0, '/path-to-page', $domain);
}
</pre>

<p>
See <a href="#org139bed1">pantheon:varnish</a> to prevent caching on certain pages by setting http header.
</p>

<p>
Cookie limit for Pantheon Edge is 10K. Any larger cookies are dropped as if there is no cookie and header <code>X-Cookies-Dropped: 1</code> will be added.
</p>

<p>
Varnish will not try to respond to the request from its cache or store the response if any of these cookies is present:
</p>
<ul class="org-ul">
<li>Cookies beginning with <code>SESS</code> that are followed by numbers and lowercase letters.</li>
<li>Drupal uses SESS-prefixed cookies for its own session tracking</li>
<li>Make sure you use different SESS-prefixed cookies for ignoring caching so that there's no conflict with Drupal</li>
<li>Correct: SESSfollowbylowercasewordwithnumbers123</li>
<li>Incorrect: SESS_hello, SESS-123, mycustomSESS, Sessone, sess123testing, SESSFIVE</li>
<li>Wordpress doesn't use PHP session cookies. Plugin <a href="https://wordpress.org/plugins/wp-native-php-sessions/">Wordpress Native PHP Sessions</a> allows custom code to use <code>$_SESSIONS</code> but it's pulled from db.</li>
<li>Other <a href="https://pantheon.io/docs/caching-advanced-topics/">cache-busting cookie patterns</a></li>
</ul>
<pre class="example">
NO_CACHE
S+ESS[a-z0-9]+
fbs[a-z0-9_]+
SimpleSAML[A-Za-z]+
PHPSESSID
wordpress[A-Za-z0-9_]*
wp-[A-Za-z0-9_]+
comment_author_[a-z0-9_]+
duo_wordpress_auth_cookie
duo_secure_wordpress_auth_cookie
bp_completed_create_steps # BuddyPress cookie used when creating groups
bp_new_group_id # BuddyPress cookie used when creating groups
wp-resetpass-[A-Za-z0-9_]+
(wp_)?woocommerce[A-Za-z0-9_-]+
</pre>

<p>
Default cookie lifetime is 2,000,000 seconds and session lifetime is 200,000 seconds in Drupal's default.settings.php
</p>

<p>
Any logged in pages will not be cached. If different content is shown based on a user's location, either use frontend or use STYXKEY cookie as described above so that caching is possible.
</p>
</div>
</div>

<div id="outline-container-orgbf303e6" class="outline-3">
<h3 id="orgbf303e6"><span class="section-number-3">30.10</span> Domain</h3>
<div class="outline-text-3" id="text-30-10">
<p>
Connect Domain: www.example.com and example.com
In your DNS:
A @ ip_from_pantheon
AAAA @ value_from_pantheon
CNAME www live-example.pantheonsite.io (Pantheon live URL)
</p>
</div>
</div>

<div id="outline-container-orgeb07af6" class="outline-3">
<h3 id="orgeb07af6"><span class="section-number-3">30.11</span> Global CDN</h3>
<div class="outline-text-3" id="text-30-11">
<p>
Fastly's edge cloud platform. 36 global points of presence (PoPs). Cache entire pages at the edge not just static assets.
</p>

<p>
Each PoP is an edge server which is proxy cache.
</p>

<p>
Cache key is the entire URL plus query string.
</p>
</div>
</div>

<div id="outline-container-orgb467978" class="outline-3">
<h3 id="orgb467978"><span class="section-number-3">30.12</span> HTTPS</h3>
<div class="outline-text-3" id="text-30-12">
</div>
<div id="outline-container-org95e3de6" class="outline-4">
<h4 id="org95e3de6"><span class="section-number-4">30.12.1</span> Redirect to HTTPS</h4>
<div class="outline-text-4" id="text-30-12-1">
<p>
<a href="https://pantheon.io/docs/domains/">https://pantheon.io/docs/domains/</a>
</p>

<pre class="example">
// wordpress
if (isset($_SERVER['PANTHEON_ENVIRONMENT']) &amp;&amp; php_sapi_name() != 'cli') {
  // Redirect to https://$primary_domain/ in the Live environment
  if ($_ENV['PANTHEON_ENVIRONMENT'] === 'live'):
    /** Replace www.example.com with your registered domain name */
    $primary_domain = 'www.example.com';
  else:
    // Redirect to HTTPS on every Pantheon environment.
    $primary_domain = $_SERVER['HTTP_HOST'];
  endif;
  $base_url = 'https://'. $primary_domain;
  define('WP_SITEURL', $base_url);
  define('WP_HOME', $base_url);
  if ($_SERVER['HTTP_HOST'] != $primary_domain
      || !isset($_SERVER['HTTP_X_SSL'])
      || $_SERVER['HTTP_X_SSL'] != 'ON' ) {

    // Name transaction "redirect" in New Relic for improved reporting (optoinal)
    if (extension_loaded('newrelic')) {
      newrelic_name_transaction("redirect");
    }
    header('HTTP/1.0 301 Moved Permanently');
    header('Location: '. $base_url . $_SERVER['REQUEST_URI']);
    exit();
  }
}

// D7
if (isset($_SERVER['PANTHEON_ENVIRONMENT']) &amp;&amp; php_sapi_name() != 'cli') {
  // Redirect to https://$primary_domain/ in the Live environment
  if ($_ENV['PANTHEON_ENVIRONMENT'] === 'live'):
    /** Replace www.example.com with your registered domain name */
    $primary_domain = 'www.example.com';
  else:
    // Redirect to HTTPS on every Pantheon environment.
    $primary_domain = $_SERVER['HTTP_HOST'];
  endif;
  $base_url = 'https://'. $primary_domain;
  if ($_SERVER['HTTP_HOST'] != $primary_domain
      || !isset($_SERVER['HTTP_X_SSL'])
      || $_SERVER['HTTP_X_SSL'] != 'ON' ) {

    // Name transaction "redirect" in New Relic for improved reporting (optional)
    if (extension_loaded('newrelic')) {
      newrelic_name_transaction("redirect");
    }
    header('HTTP/1.0 301 Moved Permanently');
    header('Location: '. $base_url . $_SERVER['REQUEST_URI']);
    exit();
  }
}

// D8
if (isset($_SERVER['PANTHEON_ENVIRONMENT']) &amp;&amp; php_sapi_name() != 'cli') {
  // Redirect to https://$primary_domain/ in the Live environment
  if ($_ENV['PANTHEON_ENVIRONMENT'] === 'live'):
    /** Replace www.example.com with your registered domain name */
    $primary_domain = 'www.example.com';
  else:
    // Redirect to HTTPS on every Pantheon environment.
    $primary_domain = $_SERVER['HTTP_HOST'];
  endif;
  if ($_SERVER['HTTP_HOST'] != $primary_domain
      || !isset($_SERVER['HTTP_X_SSL'])
      || $_SERVER['HTTP_X_SSL'] != 'ON' ) {

    // Name transaction "redirect" in New Relic for improved reporting (optoinal)
    if (extension_loaded('newrelic')) {
      newrelic_name_transaction("redirect");
    }

    header('HTTP/1.0 301 Moved Permanently');
    header('Location: '. 'https://'. $primary_domain . $_SERVER['REQUEST_URI']);
    exit();
  }
  // Drupal 8 Trusted Host Settings
  if (is_array($settings)) {
    $settings['trusted_host_patterns'] = array('^'. preg_quote($primary_domain) .'$');
  }
}
</pre>
</div>
</div>

<div id="outline-container-org82c1956" class="outline-4">
<h4 id="org82c1956"><span class="section-number-4">30.12.2</span> HSTS: HTTP Header</h4>
<div class="outline-text-4" id="text-30-12-2">
<p>
After redirection to HTTPS is setup, set the HTTP Strict Transport Security (HSTS) header to stop client communicating to HTTP.
A+ SSL rating will be achieved in <a href="https://www.ssllabs.com/ssltest/">SSL Labs</a>.
</p>

<p>
Wordpress: install LH HSTS plugin
</p>
<pre class="example">
terminus remote:wp &lt;site&gt;.&lt;env&gt; -- plugin install lh-hsts --activate
# Once enabled, this header will be sent in response
Strict-Transport-Security: max-age=15984000; includeSubDomains; preload

# D7
terminus remote:drush &lt;site&gt;.&lt;env&gt; -- pm-enable hsts --yes
# Visit the module configuration page (/admin/config/security/hsts).
# Check the Enable HTTP Strict Transport Security checkbox, set Max Age to 15552000 and click Save Configuration.
# Once installed and configured, the following header will be sent in responses:
strict-transport-security: max-age=15552000

# D8
terminus remote:drush &lt;site&gt;.&lt;env&gt; -- pm-enable hsts --yes
# Visit the module configuration page (/admin/config/system/hsts).
# Check the Enable HTTP Strict Transport Security checkbox, set Max Age to at least 1 year and click Save Configuration.
# Once installed and configured, the following header will be sent in responses:
strict-transport-security: max-age=31536000
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd2edb20" class="outline-3">
<h3 id="orgd2edb20"><span class="section-number-3">30.13</span> Varnish <a id="org139bed1">pantheon:varnish</a></h3>
<div class="outline-text-3" id="text-30-13">
<p>
<a href="https://wordpress.org/plugins/pantheon-advanced-page-cache/">Wordpress plugin Pantheon Advanced Page Cache</a>
<a href="https://pantheon.io/docs/wordpress-cache-plugin/">Clear cache functions on Wordpress</a>
<a href="https://www.varnish-software.com/wiki/content/tutorials/wordpress/wp_step_by_step.html">Varnish step-by-step guide to making a wordpress site fly</a>
</p>

<p>
Varnish doesn't cache page requests with cookies and it respects the HTTP header that you set in PHP.
Pantheon sets Varnish to ignore most cookies so that pages can be cached.
</p>

<p>
To troubleshoot whether a page is cached, examine the response HTTP header Age. If Age stays at 0, means the page is not cached.
</p>

<p>
If there's a HTTP header <code>Cache-Control: no-cache, must-revalidate, post-check=0, pre-check=0</code>, Varnish will not cache the page.
e.g. drupal_set_message sets <code>no-cache</code> in HTTP header.
</p>

<p>
Set HTTP header for preventing certain pages from caching
</p>
<pre class="example">
// wordpress
if (preg_match($regex_path_match, $_SERVER['REQUEST_URI'])) {
    add_action( 'send_headers', 'add_header_nocache', 15 );
}
function add_header_nocache() {
  header( 'Cache-Control: no-cache, must-revalidate, max-age=0' );
}

// D7
  if (preg_match($regex_path_match, $_SERVER['REQUEST_URI'])) {
    drupal_page_is_cacheable(FALSE);
    $conf['page_cache_maximum_age'] = 0;
  }

// D8
$build['#cache']['max-age'] = 0;
</pre>
<p>
See <a href="#org123d210">pantheon:cookie</a> to prevent caching on certain pages by setting NO_CACHE cookie
</p>

<p>
Pantheon Varnish will ignore the following GET parameters when caching:
</p>
<ul class="org-ul">
<li>Prefixed with 2 underscores <code>__</code></li>
<li>Prefixed with <code>utm_</code></li>
</ul>

<p>
PHP read values of these GET parameter as <code>PANTHEON_STRIPPED</code>
</p>

<p>
Varnish configuration file (.vcl) is not supposed to edit.
</p>
</div>
</div>

<div id="outline-container-orgd1107bb" class="outline-3">
<h3 id="orgd1107bb"><span class="section-number-3">30.14</span> Object Cache - Redis</h3>
<div class="outline-text-3" id="text-30-14">
<p>
Enable Redis in Pantheon Dashboard Settings &gt; Add Ons &gt; Add
For Wordpress, no more is needed because the WP Redis plugin is loaded via drop-in file
Install Redis module <a href="https://www.drupal.org/project/redis">https://www.drupal.org/project/redis</a> or run terminus to install
</p>
<pre class="example">
terminus remote:drush &lt;site&gt;.&lt;env&gt; -- en redis -y
</pre>

<p>
Edit <a href="https://pantheon.io/docs/redis/">sites/default/settings.php</a>
</p>
<pre class="example">
// D7
/ All Pantheon Environments.
if (defined('PANTHEON_ENVIRONMENT')) {
  // Use Redis for caching.
  $conf['redis_client_interface'] = 'PhpRedis';

  // Point Drupal to the location of the Redis plugin.
  $conf['cache_backends'][] = 'sites/all/modules/redis/redis.autoload.inc';
  // If you've installed your plugin in a contrib directory, use this line instead:
  // $conf['cache_backends'][] = 'sites/all/modules/contrib/redis/redis.autoload.inc';

  $conf['cache_default_class'] = 'Redis_Cache';
  $conf['cache_prefix'] = array('default' =&gt; 'pantheon-redis');

  // Do not use Redis for cache_form (no performance difference).
  $conf['cache_class_cache_form'] = 'DrupalDatabaseCache';

  // Use Redis for Drupal locks (semaphore).
  $conf['lock_inc'] = 'sites/all/modules/redis/redis.lock.inc';
  // Or if you've installed the redis module in a contrib subdirectory, use:
  // $conf['lock_inc'] = 'sites/all/modules/contrib/redis/redis.lock.inc';

}

// D8
if (defined('PANTHEON_ENVIRONMENT')) {
  // Include the Redis services.yml file. Adjust the path if you installed to a contrib or other subdirectory.
  $settings['container_yamls'][] = 'modules/redis/example.services.yml';

  //phpredis is built into the Pantheon application container.
  $settings['redis.connection']['interface'] = 'PhpRedis';
  // These are dynamic variables handled by Pantheon.
  $settings['redis.connection']['host']      = $_ENV['CACHE_HOST'];
  $settings['redis.connection']['port']      = $_ENV['CACHE_PORT'];
  $settings['redis.connection']['password']  = $_ENV['CACHE_PASSWORD'];

  $settings['cache']['default'] = 'cache.backend.redis'; // Use Redis as the default cache.
  $settings['cache_prefix']['default'] = 'pantheon-redis'; 

  // Always set the fast backend for bootstrap, discover and config, otherwise this gets lost when redis is enabled.
  $settings['cache']['bins']['bootstrap'] = 'cache.backend.chainedfast';
  $settings['cache']['bins']['discovery'] = 'cache.backend.chainedfast';
  $settings['cache']['bins']['config']    = 'cache.backend.chainedfast';
}
</pre>

<p>
Install Redis locally <a href="https://redis.io/download">https://redis.io/download</a>
Use Redis Connection Info from Dashboard
</p>
<pre class="example">
redis&gt; keys *
 1) "pantheon-rediscache_menu:links:management:tree-data:en:27cbcc1096e9daf2c319c2c"
 2) "pantheon-rediscache:features_module_info"
 3) "pantheon-rediscache_bootstrap:bootstrap_modules"
 4) "pantheon-rediscache_menu:menu_item:b38e608d4f709b7c1fcb6ac5f6dd2ab72a9a034"

# set and check
redis&gt; SET key1 "Hello"
OK
redis&gt; EXISTS key1
(integer) 1
redis&gt; EXISTS key2
(integer) 0
redis&gt;

# find a key
redis&gt; KEYS *a*
$17
englash bigkahuna
redis&gt; KEYS engl?sh
$23
englosh englash english
redis&gt; KEYS engl[ia]sh
$15
englash english

# clear cache
redis&gt; flushall
OK

# Number of keys in cache
redis&gt; DBSIZE
:0
</pre>
</div>
</div>

<div id="outline-container-org8d12f0e" class="outline-3">
<h3 id="org8d12f0e"><span class="section-number-3">30.15</span> Clear Cache</h3>
<div class="outline-text-3" id="text-30-15">
<p>
Use <code>terminus env:clear-cache</code> to debug clear cache failure.
</p>
</div>
</div>
</div>

<div id="outline-container-org24ce206" class="outline-2">
<h2 id="org24ce206"><span class="section-number-2">31</span> AWS</h2>
<div class="outline-text-2" id="text-31">
</div>
<div id="outline-container-org67ceff6" class="outline-3">
<h3 id="org67ceff6"><span class="section-number-3">31.1</span> SSH <a id="orgecb24f1">aws:ssh</a></h3>
<div class="outline-text-3" id="text-31-1">
<p>
Each instance has a Key Pair, shown as Key Name in Instance.
</p>

<p>
When Key Pair is created for the first time, a .pem file is downloaded.
</p>

<p>
Convert this pem file to ppk in PuttyGen. "Save private key" using RSA with 2048 bits.
If RSA is not available in old PuttyGen, use SSH-2 RSA.
</p>

<p>
Start up a Putty session using user_name@public_dns_name. For user_name, you can use root.
If it's not right, it will prompt you to use the correct one. For Amazon Linux AMI (t2 micro image), use ec2-user
</p>

<p>
Port is 22, type is SSH. Under Putty &gt; Category &gt; Connection &gt; SSH &gt; Auth, select the new .ppk file.
</p>

<p>
Copy from remote to local <a id="orgeecb892">aws:scp</a>
</p>
<pre class="example">
# copy a file
scp user@remotehost.comorip:/path/to/foo.md /path/to/local/

# copy a folder
scp -r user@remotehost.comorip:/path/to/foo /path/to/local/

# copy a folder to the current folder, then the result is ./foo
scp -r user@remotehost.com:/path/to/foo .

# copy all files/folders of a folder to the current folder without creating ./foo
scp -r user@remotehostcom:/path/to/foo/. .
</pre>

<p>
If port is not 22, it has to be specified <code>-P 2222</code>.
If the default private key doesn't work, use <code>-i ~/.ssh/your_private_key_file</code>
</p>
</div>
</div>

<div id="outline-container-org78f5306" class="outline-3">
<h3 id="org78f5306"><span class="section-number-3">31.2</span> Amazon Linux AMI</h3>
<div class="outline-text-3" id="text-31-2">
<p>
I use t2 micro image.
</p>

<pre class="example">
yum install php-mysql php-devel
yum install php-mbstring
chown -R root:www /var/www/html
chmod -R 755 /var/www/html
service httpd restart
service mysqld start
mysql_secure_installation
</pre>

<p>
Then do <a href="#org627f8c2">apache:production</a> setup
</p>

<p>
Add these to MySQL config file <code>nano /etc/my.cnf</code>
</p>

<pre class="example">
[mysqld]
key_buffer_size = 16M
read_buffer_size = 256K
read_rnd_buffer_size = 512K
query_cache_size = 16M
</pre>

<p>
Restart MySQL <code>service mysqld restart</code>
Check php configuration <a href="#org593aa6f">php:config</a>
</p>
</div>

<div id="outline-container-orgf2e739c" class="outline-4">
<h4 id="orgf2e739c"><span class="section-number-4">31.2.1</span> Update an instance</h4>
<div class="outline-text-4" id="text-31-2-1">
<p>
Simply create a screen session and run <code>sudo yum update</code> and 'y'
Reboot the instance.
</p>
</div>
</div>
</div>

<div id="outline-container-org4f03396" class="outline-3">
<h3 id="org4f03396"><span class="section-number-3">31.3</span> S3 <a id="org2a48924">aws:s3</a></h3>
<div class="outline-text-3" id="text-31-3">
<p>
Alternative :: Azure, Google Cloud, BackBlaze B2
By default, the maximum number of buckets is 100. Creating bucket and enable logging in bucket doesn't cost anything. Create a user in IAM with access key and assign the following policy and assign the policy:
</p>

<p>
First create a group policy with ListAllMyBuckets permission then add a new user to that group. 
The user policy is Allow All for 2 resources <code>arn:aws:s3:::&lt;bucket_name&gt;</code> and <code>arn:aws:s3:::&lt;bucket_name&gt;/*</code>
</p>

<pre class="example">
{
    "Effect": "Allow",
    "Action": [
        "s3:ListAllMyBuckets"
    ],
    "Resource": "arn:aws:s3:::*"
},
{
    "Effect": "Allow",
    "Action": [
        "s3:*"
    ],
    "Resource": [
        "arn:aws:s3:::&lt;bucket_name&gt;",
        "arn:aws:s3:::&lt;bucket_name&gt;/*",
    ]
}
</pre>

<p>
For the properties of the bucket, you can set a tag with key <code>application</code> and value is the website name.
</p>
</div>

<div id="outline-container-org3bfef1e" class="outline-4">
<h4 id="org3bfef1e"><span class="section-number-4">31.3.1</span> Storage Classes</h4>
<div class="outline-text-4" id="text-31-3-1">
<p>
STANDARD: 
STANDARD_IA (infrequent class): Retrieval fee. Real-time retrieval. Good for larger objects (&gt;128kb).
GLACIER: Retrieval fee. Retrieval time is hours.
REDUCED_REDUNDANCY: less durability and availability. Best for storing thumbnail images.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org5e3993e" class="outline-2">
<h2 id="org5e3993e"><span class="section-number-2">32</span> Database</h2>
<div class="outline-text-2" id="text-32">
</div>
<div id="outline-container-orgac47c13" class="outline-3">
<h3 id="orgac47c13"><span class="section-number-3">32.1</span> Basics</h3>
<div class="outline-text-3" id="text-32-1">
</div>
<div id="outline-container-org1949048" class="outline-4">
<h4 id="org1949048"><span class="section-number-4">32.1.1</span> Modeling Optimization</h4>
<div class="outline-text-4" id="text-32-1-1">
<p>
First normal form (1NF) :: every field should have one value. (Not comma separated values)
</p>

<p>
Second normal form (2NF) :: If you have multiple primary keys (composite keys) in a table, 
every field should be unique to all of those composite keys.
e.g. CourseID and Date are 2 primary keys in table A. Field CourseTitle is unique to courseID. courseTitle should not be in 
table A. Create a new table B to include CourseID and CourseTitle.
</p>

<p>
Third normal form (3NF) :: Say you have CourseID, Date, Room, Seats in table A.
Seats is unique to Room. You should create table B to hold Room, Seats and include just Room in table A.
</p>
</div>
</div>

<div id="outline-container-orgba596b4" class="outline-4">
<h4 id="orgba596b4"><span class="section-number-4">32.1.2</span> Transaction and ACID</h4>
<div class="outline-text-4" id="text-32-1-2">
<dl class="org-dl">
<dt>Atomic</dt><dd>All parts involved should be either success or failure as a whole.</dd>
<dt>Consistent</dt><dd>cannot result in a situation that violates any of the integrity rules.</dd>
<dt>Isolated</dt><dd>all relevant data is locked until the transaction is finished. (Race condition)
<dl class="org-dl">
<dt>Pessimistic Locking</dt><dd>Once locked, others can't even read (be refused or have to wait)</dd>
<dt>Optimistic Locking</dt><dd>Once one request lock data, other requests can read</dd>
</dl></dd>
</dl>
<p>
but roll back when try to write to db while lock is encountered.
</p>
<dl class="org-dl">
<dt>Durable</dt><dd>Once success, always success.</dd>
</dl>
</div>
</div>

<div id="outline-container-org5bdf24e" class="outline-4">
<h4 id="org5bdf24e"><span class="section-number-4">32.1.3</span> Index</h4>
<div class="outline-text-4" id="text-32-1-3">
<p>
One table can have only one clustered index which is by default the primary key column.
You may make another column as non-clustered index. 
Each non-clustered index creates a new table which includes the clustered index column and the new column (sorted).
When a new row is added to the main table, a new row is also added to each non-cluster indexed table.
</p>
</div>
</div>
</div>

<div id="outline-container-org85ae600" class="outline-3">
<h3 id="org85ae600"><span class="section-number-3">32.2</span> Access</h3>
<div class="outline-text-3" id="text-32-2">
</div>
<div id="outline-container-org12bd874" class="outline-4">
<h4 id="org12bd874"><span class="section-number-4">32.2.1</span> Null</h4>
<div class="outline-text-4" id="text-32-2-1">
<pre class="example">
IsNull(col1) return true or false
Nz(col1,'') return '' if col1 is null
</pre>

<p>
Sometimes IsNull() and Nz() don't work, e.g. UcanAccess,
Use NVL() which is the same as Nz(). Or use col1 IS NULL
</p>
</div>
</div>

<div id="outline-container-orgc3de8c4" class="outline-4">
<h4 id="orgc3de8c4"><span class="section-number-4">32.2.2</span> Coldfusion Datetime</h4>
<div class="outline-text-4" id="text-32-2-2">
<pre class="example">
&lt;cfset dStart = DateFormat(form.startdate, "mm/dd/yyyy")&gt;

SELECT *
FROM aTable
WHERE DateStart &gt;= #CreateDate(Year(now()),Month(now()),Day(now()))#
AND DateEnd &lt;= #CreateDate(Year(now()),Month(now()),DaysInMonth(now()))#
AND DateStart BETWEEN #dStart# AND #CreateDate(Year(dStart),Month(dStyart),DaysInMonth(dStart))#
</pre>
</div>
</div>

<div id="outline-container-org584defe" class="outline-4">
<h4 id="org584defe"><span class="section-number-4">32.2.3</span> Random Order</h4>
<div class="outline-text-4" id="text-32-2-3">
<pre class="example">
SELECT *
FROM aTable
ORDER BY rnd(INT(NOW*id)-NOW*id)

&lt;!--- OR
rnd(aTable.ID)
---&gt;
</pre>
</div>
</div>

<div id="outline-container-orgaf071ce" class="outline-4">
<h4 id="orgaf071ce"><span class="section-number-4">32.2.4</span> Troubleshooting</h4>
<div class="outline-text-4" id="text-32-2-4">
</div>
<div id="outline-container-org9f78109" class="outline-5">
<h5 id="org9f78109"><span class="section-number-5">32.2.4.1</span> "Record is too large"</h5>
<div class="outline-text-5" id="text-32-2-4-1">
<p>
This is because the size of a single record is around 2K. 
You can change the data type for some of fields to Long Text (&gt;Access 2013) or Memo (&lt;= Access 2000)
</p>
</div>
</div>

<div id="outline-container-org01fad68" class="outline-5">
<h5 id="org01fad68"><span class="section-number-5">32.2.4.2</span> "Application uses a value of the wrong type for the current operation"</h5>
<div class="outline-text-5" id="text-32-2-4-2">
<p>
It's possibly due to you are using Microsoft Access with Unicode driver in ColdFusion and you insert to a memo or long text field. 
<code>cf_sql_longvarchar</code> doesn't work. You should use <code>&lt;cfqueryparam cfsqltype="CF_SQL_CLOB" value="#description#"&gt;</code> instead. 
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org7e57eb1" class="outline-3">
<h3 id="org7e57eb1"><span class="section-number-3">32.3</span> MySQL</h3>
<div class="outline-text-3" id="text-32-3">
</div>
<div id="outline-container-org711f121" class="outline-4">
<h4 id="org711f121"><span class="section-number-4">32.3.1</span> Version, Settings, Global variables <a id="org25924a8">mysql:config</a></h4>
<div class="outline-text-4" id="text-32-3-1">
<p>
<code>service mysql status</code>
</p>

<p>
<code>service mysql restart</code> or <code>service mysqld restart</code>
</p>

<p>
In console
</p>
<pre class="example">
# all settings / global variables
SHOW VARIABLES;

# one setting
SHOW VARIABLES LIKE "%version%";

# check if it's MariaDB
SELECT VERSION();
</pre>
</div>

<div id="outline-container-orgc1df9cf" class="outline-5">
<h5 id="orgc1df9cf"><span class="section-number-5">32.3.1.1</span> Minimum</h5>
<div class="outline-text-5" id="text-32-3-1-1">
<p>
<a href="http://www.tocker.ca/2014/03/10/configuring-mysql-to-use-minimal-memory.html">http://www.tocker.ca/2014/03/10/configuring-mysql-to-use-minimal-memory.html</a>
<a href="https://github.com/levonlee/vagrant/tree/master/build/docker-compose/mysql">https://github.com/levonlee/vagrant/tree/master/build/docker-compose/mysql</a>
</p>

<pre class="example">
[mysqld]
innodb_buffer_pool_size=5M
innodb_log_buffer_size=256K
query_cache_size=0
max_connections=10
key_buffer_size=8
thread_cache_size=0
host_cache_size=0
innodb_ft_cache_size=1600000
innodb_ft_total_cache_size=32000000

# per thread or per operation settings
thread_stack=131072
sort_buffer_size=32K
read_buffer_size=8200
read_rnd_buffer_size=8200
max_heap_table_size=16K
tmp_table_size=1K
bulk_insert_buffer_size=0
join_buffer_size=128
net_buffer_length=1K
innodb_sort_buffer_size=64K

#settings that relate to the binary log (if enabled)
binlog_cache_size=4K
binlog_stmt_cache_size=4K
</pre>
</div>
</div>

<div id="outline-container-orgb374346" class="outline-5">
<h5 id="orgb374346"><span class="section-number-5">32.3.1.2</span> charset, collation <a id="org545f6c8">mysql:charset</a> <a id="org0937ca6">mysql:collation</a></h5>
<div class="outline-text-5" id="text-32-3-1-2">
<p>
Default charset is utf8, collation is utf8_general_ci
which is 3 bytes. utf8mb4 is 4 bytes
MySQL server default charset and collation
</p>

<p>
SELECT @@character_set_database, @@collation_database;
ALTER DATABASE db_name CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
ALTER TABLE {tbl_name} CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
ALTER TABLE {tbl_name} MODIFY "field_name" "field_type" CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
</p>

<p>
In order to enable utf8mb4, you need to change my.cnf setting and restart MySQL
mysqld (client) is used on Pantheon instead of libmysqlclient
The following settings becomes available on mysqld (MySQL) server version &gt; 5.5.14 and default since 5.7.7
As of Nov 25, 2016, Pantheon MySQL (innodb) version is 5.6.26 
</p>
<pre class="example">
[mysqld]
innodb_large_prefix=true
innodb_file_format=barracuda
innodb_file_per_table=true
</pre>

<p>
mysqld (client) &gt; 5.0.9, libmysqlclient &gt; v. 5.5.3, has to support utf8mb4 charset
</p>

<p>
The major problem here is that for an indexed string column (primary key column) MySQL has 767 bytes limit.
In utf8, it's 767/3=255 characters varchar(255). In utf8mb4, it's 767/4=191 characters varchar(191).
If MySQL server doesn't have the above setting, the indexed column should contain less than 191 characters.
But those columns already have varchar(255) defined, you will need to re-create the indexes
ALTER TABLE tbl_name CHANGE index_col index_col VARCHAR(191) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
</p>

<p>
That's actually what Wordpress does: resize the indexed columns for some tables and make every table and field utf8mb4.
</p>

<p>
Until Nov 25, 2016, Pantheon doesn't make those settings to MySQL server, so you will need to manually do the same as Wordpress.
</p>

<p>
Referred by <a href="#orge0e3cd2">d7:mysql:charset</a>
</p>
</div>
</div>

<div id="outline-container-org46b169b" class="outline-5">
<h5 id="org46b169b"><span class="section-number-5">32.3.1.3</span> Memory, InnoDB Buffer, packet</h5>
<div class="outline-text-5" id="text-32-3-1-3">
<p>
name, default
innodb-buffer-pool-size = innodb-buffer-pool-chunk-size * innodb-buffer-pool-instaces
max-allowed-packet :: 16M # total BLOB data size for a single row
</p>
</div>
</div>

<div id="outline-container-orgd1f4f5f" class="outline-5">
<h5 id="orgd1f4f5f"><span class="section-number-5">32.3.1.4</span> Last Update time for a table in a database</h5>
<div class="outline-text-5" id="text-32-3-1-4">
<pre class="example">
SELECT UPDATE_TIME, TABLE_SCHEMA, TABLE_NAME
FROM   INFORMATION_SCHEMA.TABLES
WHERE TABLE_SCHEMA NOT LIKE '%information_schema%'
AND TABLE_SCHEMA LIKE '%your_db_name%'
AND TABLE_NAME LIKE '%your_db_table_name%'
</pre>

<pre class="example">
SELECT MAX(UPDATE_TIME), TABLE_SCHEMA
FROM   INFORMATION_SCHEMA.TABLES
WHERE TABLE_SCHEMA NOT LIKE '%information_schema%'
GROUP BY TABLE_SCHEMA
ORDER BY MAX(UPDATE_TIME)
</pre>
</div>
</div>

<div id="outline-container-org61b5143" class="outline-5">
<h5 id="org61b5143"><span class="section-number-5">32.3.1.5</span> Query Log</h5>
<div class="outline-text-5" id="text-32-3-1-5">
<p>
MySQL &gt;= 5.1.12
</p>
<pre class="example">
show variables like 'general_log%';
// see if it's enabled
show variables like 'log_output%';
// TABLE :: log to a table, FILE or NONE

// Change this at runtime
SET GLOBAL log_output = 'TABLE';
SET GLOBAL general_log = 'ON';

SELECT * FROM general_log

// If you prefer to output to a file instead of a table:

SET GLOBAL log_output = "FILE"; the default.
SET GLOBAL general_log_file = "/path/to/your/logfile.log";
SET GLOBAL general_log = 'ON';
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcaa2e3a" class="outline-4">
<h4 id="orgcaa2e3a"><span class="section-number-4">32.3.2</span> Install</h4>
<div class="outline-text-4" id="text-32-3-2">
<pre class="example">
# Ubuntu
apt-get update; apt-get install mysql-server
service mysql start

# Debian
yum install php-mysql
service httpd restart
service mysqld start

# both
mysql_secure_installation
</pre>
</div>

<div id="outline-container-org7e3fc1e" class="outline-5">
<h5 id="org7e3fc1e"><span class="section-number-5">32.3.2.1</span> MySQL does not start after installation, Ubuntu</h5>
<div class="outline-text-5" id="text-32-3-2-1">
<p>
<code>No directory, logging in with HOME=/</code> and <code>service mysql status</code> shows it is inactive.
This is new.. Change the owner:group for relevant folders
</p>
<pre class="example">
chown -R mysql:mysql /var/lib/mysql /var/run/mysqld
</pre>
</div>
</div>

<div id="outline-container-org800b577" class="outline-5">
<h5 id="org800b577"><span class="section-number-5">32.3.2.2</span> Reset root password, Ubuntu</h5>
<div class="outline-text-5" id="text-32-3-2-2">
<p>
ERROR 1045: Access denied for user: 'root@localhost' (Using password: NO) or yes
</p>

<pre class="example">
# stop
sudo /etc/init.d/mysql stop

# skip permission check
sudo /usr/sbin/mysqld --skip-grant-tables --skip-networking &amp;

# start mysql client without a password
mysql -u root
FLUSH PRIVILEGES;

# Update root password
SET PASSWORD FOR root@'localhost' = PASSWORD('password');

# If you have a mysql root account that can connect from everywhere, you should also do:
UPDATE mysql.user SET Password=PASSWORD('password') WHERE User='root';

# Alternate
USE mysql
UPDATE user SET Password = PASSWORD()
WHERE Host = 'localhost' And User='root';

# Alternate for root can access from everywhere
USE mysql
UPDATE user SET Password = PASSWORD('password');
WHERE Host = '%' AND User = 'root';

FLUSH PRIVILEGES;
exit
service mysql restart

# or

sudo /etc/init.d/mysql stop
sudo /etc/init.d/mysql start
</pre>
</div>
</div>
</div>

<div id="outline-container-org5eb5b12" class="outline-4">
<h4 id="org5eb5b12"><span class="section-number-4">32.3.3</span> Data Types</h4>
<div class="outline-text-4" id="text-32-3-3">
</div>
<div id="outline-container-orgc15bd87" class="outline-5">
<h5 id="orgc15bd87"><span class="section-number-5">32.3.3.1</span> <a id="org217f492">MySQL Integer</a></h5>
<div class="outline-text-5" id="text-32-3-3-1">
<p>
SIGNED :: contains negative, 0 and positive
UNSIGNED :: contains 0 and positive
</p>
<ul class="org-ul">
<li>TINYINT</li>
<li>SMALLINT</li>
<li>MEDIUMINT</li>
<li id="INT"><code>INT(10)</code> 10 is display-width. INT(1) and INT(10) UNSIGNED max is the same: 4,294,967,295</li>
<li>BIGINT</li>
</ul>
</div>
</div>

<div id="outline-container-orgbd5ea8c" class="outline-5">
<h5 id="orgbd5ea8c"><span class="section-number-5">32.3.3.2</span> <a id="org1295bee">MySQL Date and Time</a></h5>
<div class="outline-text-5" id="text-32-3-3-2">
<dl class="org-dl">
<dt>TIME</dt><dd>format 'HH:MM:SS' from '-838:59:59.000' to '838:59:59.000'</dd>
</dl>

<p>
1 Year ago
post_date &gt; DATE_SUB(NOW(), INTERVAL 1 YEAR)
</p>

<p>
Date comparison
</p>

<pre class="example">
CAST(post_date AS DATE) &gt; '2014-01-01'
FROM_UNIXTIME(intTime) &gt; '2014-01-01'
FROM_UNIXTIME(intTime) BETWEEN '2014-01-01 00:00:00' AND '2014-12-31 23:59:00'
</pre>

<p>
Unix Time
</p>
<pre class="example">
DATE_FORMAT(FROM_UNIXTIME(intTime),'%Y-%m-%d %H:%i:%s') :: default date format
UNIX_TIMESTAMP(NOW())
</pre>
</div>
</div>

<div id="outline-container-org43f437c" class="outline-5">
<h5 id="org43f437c"><span class="section-number-5">32.3.3.3</span> <a id="orga11e1cd">MySQL String</a></h5>
<div class="outline-text-5" id="text-32-3-3-3">
<p>
<a href="https://dev.mysql.com/doc/refman/5.7/en/string-functions.html">https://dev.mysql.com/doc/refman/5.7/en/string-functions.html</a>
</p>

<p>
Concatenate user variable
</p>
<pre class="example">
SET @s3 = 'http://s3.amazonaws.com/abc/';
SELECT REGEXP_REPLACE(thumbnail.uri, "^(s3://)(.*)", CONCAT(@s3,'\\2')) AS thumbnail
</pre>

<p>
Concatenate columns or strings of one row. It doesn't skip empty string but it does skip NULL values.
</p>
<pre class="example">
CONCAT_WS(',', colA, colB, 'Column C Value')
WHERE url_alias.source = CONCAT('node/', n.nid)

-- if there any value that is NULL, CONCAT returns NULL
CONCAT_WS(',', NULL, '123', NULL) -- 123
CONCAT_WS(',', NULL, NULL) -- empty value
CONCAT_WS(',', NULL, '123', '', NULL) -- 123,,
</pre>

<p>
replace all occurances, case-sensitve. multibyte safe
</p>
<pre class="example">
SELECT REPLACE('www.mysql.com', 'w', 'Ww');
</pre>

<p>
Use regex_replace to do more complicated find and replace. MariaDB driver on host is required.
</p>
<pre class="example">
SELECT REGEXP_REPLACE("stackoverflow", "(stack)(over)(flow)", '\\2 - \\1 - \\3')
</pre>

<p>
String delimited list
</p>
<pre class="example">
substring_index ( substring_index ( context,',',1 ), ',', -1) ) 
substring_index ( substring_index ( context,',',2 ), ',', -1) ) 
substring_index ( substring_index ( context,',',3 ), ',', -1) ) 
substring_index ( substring_index ( context,',',4 ), ',', -1) )
it means 1st value, 2nd, 3rd, etc.
</pre>
<p>
Explanation: original string is "34,7,23,89", substring_index( context,',', 3) returns "34,7,23". The outer substring_index takes the value returned by the inner substring_index and the -1 allows you to take the last value. So you get "23" from the "34,7,23".
</p>

<p>
See <a href="#orgf609cff">mysql:string:list:temp table</a> for more
</p>
</div>
</div>

<div id="outline-container-org224c525" class="outline-5">
<h5 id="org224c525"><span class="section-number-5">32.3.3.4</span> <a id="org9ace90d">MySQL Null</a></h5>
<div class="outline-text-5" id="text-32-3-3-4">
<p>
IFNULL(column_name, 0)
WHERE column_name IS NOT NULL
</p>
</div>
</div>
</div>

<div id="outline-container-org0208743" class="outline-4">
<h4 id="org0208743"><span class="section-number-4">32.3.4</span> REGEXP <a id="org48be5c2">MySQL REGEX</a></h4>
<div class="outline-text-4" id="text-32-3-4">
<p>
Unless the field is binary, REGEXP is case-insensitive.
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #ffad29; font-weight: bold;">WHERE</span> aut_name REGEXP "^w"
<span style="color: #ffad29; font-weight: bold;">WHERE</span> aut_name REGEXP "^I am \"Great!\""
</pre>
</div>
</div>
</div>

<div id="outline-container-org9f98c76" class="outline-4">
<h4 id="org9f98c76"><span class="section-number-4">32.3.5</span> Update Fields in Multiple Tables</h4>
<div class="outline-text-4" id="text-32-3-5">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #ffad29; font-weight: bold;">UPDATE</span> node, node_revision
<span style="color: #ffad29; font-weight: bold;">SET</span> node.comment=1,
    node_revision.comment = 1
<span style="color: #ffad29; font-weight: bold;">WHERE</span> node_revision.nid = node.nid <span style="color: #ffad29; font-weight: bold;">AND</span> node.<span style="color: #ffad29; font-weight: bold;">type</span> &lt;&gt; <span style="color: #e67128;">'blog'</span>
</pre>
</div>

<p>
Update Joined Tables
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #ffad29; font-weight: bold;">UPDATE</span> tableA a
<span style="color: #ffad29; font-weight: bold;">JOIN</span> tableB b <span style="color: #ffad29; font-weight: bold;">ON</span> a.a_id = b.a_id
<span style="color: #ffad29; font-weight: bold;">JOIN</span> tableC c <span style="color: #ffad29; font-weight: bold;">ON</span> b.b_id = c.b_id
<span style="color: #ffad29; font-weight: bold;">SET</span> b.val = a.val+c.val,
a.val2 = <span style="color: #e67128;">'new'</span>
<span style="color: #ffad29; font-weight: bold;">WHERE</span> a.val &gt; 10 <span style="color: #ffad29; font-weight: bold;">AND</span> c.val &gt; 10
</pre>
</div>
</div>
</div>

<div id="outline-container-org9164d71" class="outline-4">
<h4 id="org9164d71"><span class="section-number-4">32.3.6</span> LIMIT in Sub Query</h4>
<div class="outline-text-4" id="text-32-3-6">
<p>
Can't directly use LIMIT in sub query
This doesn't work
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #ffad29; font-weight: bold;">SELECT</span> *
<span style="color: #ffad29; font-weight: bold;">FROM</span> wp_posts
<span style="color: #ffad29; font-weight: bold;">WHERE</span> wp_posts.ID <span style="color: #ffad29; font-weight: bold;">IN</span> (
<span style="color: #ffad29; font-weight: bold;">SELECT</span> p2.ID <span style="color: #ffad29; font-weight: bold;">FROM</span> wp_posts p2 <span style="color: #ffad29; font-weight: bold;">WHERE</span> p2.post_type <span style="color: #ffad29; font-weight: bold;">IN</span> (<span style="color: #e67128;">'posts'</span>)
<span style="color: #ffad29; font-weight: bold;">LIMIT</span> 5)
</pre>
</div>

<p>
Do this
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #ffad29; font-weight: bold;">SELECT</span> *
<span style="color: #ffad29; font-weight: bold;">FROM</span> wp_posts
<span style="color: #ffad29; font-weight: bold;">WHERE</span> wp_posts.ID <span style="color: #ffad29; font-weight: bold;">IN</span> (
<span style="color: #ffad29; font-weight: bold;">SELECT</span> * <span style="color: #ffad29; font-weight: bold;">FROM</span> (<span style="color: #ffad29; font-weight: bold;">SELECT</span> p2.ID <span style="color: #ffad29; font-weight: bold;">FROM</span> wp_posts p2 <span style="color: #ffad29; font-weight: bold;">WHERE</span> p2.post_type <span style="color: #ffad29; font-weight: bold;">IN</span> (<span style="color: #e67128;">'posts'</span>) <span style="color: #ffad29; font-weight: bold;">LIMIT</span> 5) <span style="color: #ffad29; font-weight: bold;">AS</span> sq1
)
</pre>
</div>

<p>
Remember if the outter query has LIMIT, then it will overwrite any subquery's LIMIT
</p>
</div>
</div>

<div id="outline-container-org0357da8" class="outline-4">
<h4 id="org0357da8"><span class="section-number-4">32.3.7</span> EXISTS</h4>
<div class="outline-text-4" id="text-32-3-7">
<p>
If only checking existance in other tables but not returning any data from other tables, always use `EXISTS` or `NOT EXISTS`
</p>

<p>
The following returns nodes that have field_dealer = 101615 and field_ad_status = active but not returning any fields from 
tables field_data_*.
</p>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #ffad29; font-weight: bold;">SELECT</span> <span style="color: #23d7d7;">count</span>(*) <span style="color: #ffad29; font-weight: bold;">FROM</span> node <span style="color: #ffad29; font-weight: bold;">AS</span> n
<span style="color: #ffad29; font-weight: bold;">WHERE</span> n.<span style="color: #ffad29; font-weight: bold;">type</span>=<span style="color: #e67128;">'ad_listing'</span>
<span style="color: #ffad29; font-weight: bold;">AND</span> n.status = 1
<span style="color: #ffad29; font-weight: bold;">AND</span> <span style="color: #ffad29; font-weight: bold;">EXISTS</span> (
 <span style="color: #ffad29; font-weight: bold;">SELECT</span> *
 <span style="color: #ffad29; font-weight: bold;">FROM</span> field_data_field_dealer d
 <span style="color: #ffad29; font-weight: bold;">INNER</span> <span style="color: #ffad29; font-weight: bold;">JOIN</span> node nsub <span style="color: #ffad29; font-weight: bold;">ON</span> nsub.nid=d.entity_id <span style="color: #ffad29; font-weight: bold;">AND</span> d.bundle=<span style="color: #e67128;">'ad_listing'</span> <span style="color: #ffad29; font-weight: bold;">AND</span> d.field_dealer_target_id <span style="color: #ffad29; font-weight: bold;">IN</span> (101615)
 <span style="color: #ffad29; font-weight: bold;">WHERE</span> nsub.nid=n.nid
)
<span style="color: #ffad29; font-weight: bold;">AND</span> <span style="color: #ffad29; font-weight: bold;">EXISTS</span> (
 <span style="color: #ffad29; font-weight: bold;">SELECT</span> *
 <span style="color: #ffad29; font-weight: bold;">FROM</span> field_data_field_ad_status s
 <span style="color: #ffad29; font-weight: bold;">INNER</span> <span style="color: #ffad29; font-weight: bold;">JOIN</span> node nsub <span style="color: #ffad29; font-weight: bold;">ON</span> nsub.nid=s.entity_id <span style="color: #ffad29; font-weight: bold;">AND</span> s.bundle=<span style="color: #e67128;">'ad_listing'</span> <span style="color: #ffad29; font-weight: bold;">AND</span> s.field_ad_status_value = <span style="color: #e67128;">'active'</span>
 <span style="color: #ffad29; font-weight: bold;">WHERE</span> nsub.nid=n.nid
)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd3431de" class="outline-4">
<h4 id="orgd3431de"><span class="section-number-4">32.3.8</span> UNION</h4>
<div class="outline-text-4" id="text-32-3-8">
<pre class="example">
select_statement_1
UNION [ALL]
select_statement_2
UNION [ALL]
select_statement_3
...
...
</pre>

<ul class="org-ul">
<li>In a UNION query, there are at least two SELECT statements.</li>

<li>The two SELECT statements must have the same number of columns and the the columns must have compatible data types.</li>

<li>The column headings in each of the SELECT statements do not have to have the same name. The column headings in the result of a UNION query are always taken from the first SELECT statement.</li>

<li>If you want to sort the result set of the UNION operation, you can only put an ORDER BY clause after the last SELECT statement. ORDER BY clause can't be specified in any other SELECT statements in the UNION query.</li>

<li>The column(s) used in ORDER BY clause can only be taken from the first SELECT statement.</li>

<li>If you don't specify an ORDER BY clause in the UNION query, the result set is always sorted by the first column.</li>

<li>If you use UNION ALL, the entire result set from the second SELECT statement is appended to the first SELECT statement. In this case, there could be duplicate records in the unioned result set.</li>

<li>If you only use UNION, MySQL removes duplicate rows from the final result set.</li>
</ul>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #ffad29; font-weight: bold;">SELECT</span> s.id <span style="color: #ffad29; font-weight: bold;">AS</span> id, score.score, course.course, <span style="color: #ffad29; font-weight: bold;">null</span> <span style="color: #ffad29; font-weight: bold;">AS</span> certificate
<span style="color: #ffad29; font-weight: bold;">FROM</span> student s
  <span style="color: #ffad29; font-weight: bold;">LEFT</span> <span style="color: #ffad29; font-weight: bold;">JOIN</span> s_score score <span style="color: #ffad29; font-weight: bold;">ON</span> score.sid = s.id
  <span style="color: #ffad29; font-weight: bold;">LEFT</span> <span style="color: #ffad29; font-weight: bold;">JOIN</span> s_course course <span style="color: #ffad29; font-weight: bold;">ON</span> score.sid = s.id
<span style="color: #ffad29; font-weight: bold;">UNION</span> <span style="color: #ffad29; font-weight: bold;">ALL</span>
<span style="color: #ffad29; font-weight: bold;">SELECT</span> s.id <span style="color: #ffad29; font-weight: bold;">AS</span> id, <span style="color: #ffad29; font-weight: bold;">null</span>, <span style="color: #ffad29; font-weight: bold;">null</span>, cert.certificate
<span style="color: #ffad29; font-weight: bold;">FROM</span> student s
  <span style="color: #ffad29; font-weight: bold;">LEFT</span> <span style="color: #ffad29; font-weight: bold;">JOIN</span> s_certificate cert <span style="color: #ffad29; font-weight: bold;">ON</span> cert.sid = s.id
<span style="color: #ffad29; font-weight: bold;">ORDER</span> <span style="color: #ffad29; font-weight: bold;">BY</span> id
</pre>
</div>
</div>
</div>

<div id="outline-container-org28c85ac" class="outline-4">
<h4 id="org28c85ac"><span class="section-number-4">32.3.9</span> CASE, IF(), IFNULL(), NULLIF()</h4>
<div class="outline-text-4" id="text-32-3-9">
<p>
<a href="https://dev.mysql.com/doc/refman/5.7/en/control-flow-functions.html">https://dev.mysql.com/doc/refman/5.7/en/control-flow-functions.html</a>
</p>

<pre class="example">
SELECT IF(1&gt;2,2,3); // 3
SELECT IF(1=1,2,3); // 2
SELECT IF(STRCMP('1', '1') = 0, 2, 3); // 2
</pre>

<pre class="example">
mysql&gt; SELECT CASE 1 WHEN 1 THEN 'one'
    -&gt;     WHEN 2 THEN 'two' ELSE 'more' END;
        -&gt; 'one'
mysql&gt; SELECT CASE WHEN 1&gt;0 THEN 'true' ELSE 'false' END;
        -&gt; 'true'
mysql&gt; SELECT CASE BINARY 'B'
    -&gt;     WHEN 'a' THEN 1 WHEN 'b' THEN 2 END;
        -&gt; NULL
</pre>
</div>
</div>

<div id="outline-container-org5303d74" class="outline-4">
<h4 id="org5303d74"><span class="section-number-4">32.3.10</span> Concatenate values of a column across multiple rows about the same record <a id="orgeabffc2">mysql:concat columns</a></h4>
<div class="outline-text-4" id="text-32-3-10">
<p>
<a href="#org63e15cc">mysqlfiddle</a>
</p>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #ffad29; font-weight: bold;">SELECT</span> s.id, s.firstname, s.lastname
, GROUP_CONCAT(<span style="color: #ffad29; font-weight: bold;">DISTINCT</span> ts.score <span style="color: #ffad29; font-weight: bold;">ORDER</span> <span style="color: #ffad29; font-weight: bold;">BY</span> ts.testDate SEPARATOR <span style="color: #e67128;">', '</span>) <span style="color: #ffad29; font-weight: bold;">AS</span> student_scores
, GROUP_CONCAT(<span style="color: #ffad29; font-weight: bold;">DISTINCT</span> liConCat2(c.course, c.<span style="color: #ffad29; font-weight: bold;">year</span>) SEPARATOR 0x1E) <span style="color: #ffad29; font-weight: bold;">AS</span> courses
<span style="color: #ffad29; font-weight: bold;">FROM</span> student s 
     <span style="color: #ffad29; font-weight: bold;">LEFT</span> <span style="color: #ffad29; font-weight: bold;">JOIN</span> testScore ts <span style="color: #ffad29; font-weight: bold;">ON</span> ts.sid = s.id
     <span style="color: #ffad29; font-weight: bold;">LEFT</span> <span style="color: #ffad29; font-weight: bold;">JOIN</span> s_course c <span style="color: #ffad29; font-weight: bold;">ON</span> c.sid = s.id
<span style="color: #ffad29; font-weight: bold;">GROUP</span> <span style="color: #ffad29; font-weight: bold;">BY</span> s.id
<span style="color: #ffad29; font-weight: bold;">ORDER</span> <span style="color: #ffad29; font-weight: bold;">BY</span> s.lastname
</pre>
</div>

<p>
<code>GROUP_CONCAT</code> only concatenates non-null values. If all values are null, null will be returned.
</p>

<p>
<code>GROUP_CONCAT</code> by default only handles 1024 letters. Change it for the current session
</p>
<pre class="example">
SET SESSION group_concat_max_len = 65535;
</pre>

<p>
If there're multiple fields that have multiple values, e.g. a student can have multiple scores and multiple courses, and they are joined,
</p>

<p>
Total number of rows are for one student is: N(courses of student) X N(scores of student),
N(x) is number of x, when x is zero, N(0) = 1.
</p>

<p>
When you do GROUP_CONCAT on course, use DISTINCT inside.
</p>

<p>
Concatenate multiple fields
<code>GROUP_CONCAT(DISTINCT liConCat2(c.course, c.year) SEPARATOR 0x1E) AS courses</code>
</p>
</div>

<div id="outline-container-org150afa6" class="outline-5">
<h5 id="org150afa6"><span class="section-number-5">32.3.10.1</span> Concatenate strings, use a different separator</h5>
<div class="outline-text-5" id="text-32-3-10-1">
<ul class="org-ul">
<li>0x1F (31): unit (fields) separator</li>
<li>0x1E (30): record separator</li>
<li>0x1D (29): group separator</li>
</ul>
<pre class="example">
GROUP_CONCAT(foo SEPARATOR 0x1D)
$array = explode(chr(29),$s);
</pre>
</div>
</div>
</div>

<div id="outline-container-orga353345" class="outline-4">
<h4 id="orga353345"><span class="section-number-4">32.3.11</span> User Variable</h4>
<div class="outline-text-4" id="text-32-3-11">
<pre class="example">
SET @s3 = 'http://s3.amazon.com/abc/';
SELECT @s3
</pre>
</div>
</div>

<div id="outline-container-orgb453adf" class="outline-4">
<h4 id="orgb453adf"><span class="section-number-4">32.3.12</span> Routines</h4>
<div class="outline-text-4" id="text-32-3-12">
<p>
Procedure and User Defined Functions are stored under the schema as routines
</p>

<p>
e.g. Schema (database) is pantheon, pantheon.tables are all tables and pantheon.routines
</p>

<p>
<a id="org3b9a43a">mysql:routine:characteristics</a>
</p>
<pre class="example">
characteristic:
    COMMENT 'string'
  | LANGUAGE SQL
  | [NOT] DETERMINISTIC
  | { CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }
  | SQL SECURITY { DEFINER | INVOKER }
</pre>

<p>
Don't specify LANGUAGE SQL
</p>

<p>
A routine is considered “deterministic” if it always produces the same result for the same input parameters, and “not deterministic” otherwise. If neither DETERMINISTIC nor NOT DETERMINISTIC is given in the routine definition, the default is NOT DETERMINISTIC. To declare that a function is deterministic, you must specify DETERMINISTIC explicitly.
</p>

<p>
Non-deterministic examples are data modification, have UPDATE, INSERT or DELETE statement(s).
Default without <code>SET GLOBAL log_bin_trust_function_creators = 1;</code> is <code>NOT DETERMINISTIC</code>
Without specifying DETERMINISTIC and with the default setting, this error throws:
</p>
<pre class="example">
This function has none of DETERMINISTIC, NO SQL, or READS SQL DATA in its declaration and binary logging is enabled (you *might* want to use the less safe log_bin_trust_function_creators variable)
</pre>

<p>
{ CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }
</p>

<ul class="org-ul">
<li>CONTAINS SQL Default, indicates that the routine does not contain statements that read or write data. Examples of such statements are SET @x = 1 or DO RELEASE_LOCK('abc'), which execute but neither read nor write data.</li>
<li id="NO SQL">indicates that the routine contains no SQL statements.</li>
<li id="READS SQL">DATA indicates that the routine contains statements that read data (for example, SELECT), but not statements that write data.</li>
<li id="MODIFIES SQL DATA">indicates that the routine contains statements that may write data (for example, INSERT or DELETE).</li>
</ul>

<p>
The parameter list enclosed within parentheses must always be present. If there are no parameters, an empty parameter list of () should be used. Parameter names are not case sensitive.
</p>
</div>
</div>

<div id="outline-container-org977d4c8" class="outline-4">
<h4 id="org977d4c8"><span class="section-number-4">32.3.13</span> Procedure</h4>
<div class="outline-text-4" id="text-32-3-13">
</div>
<div id="outline-container-orgdef4d93" class="outline-5">
<h5 id="orgdef4d93"><span class="section-number-5">32.3.13.1</span> Syntax</h5>
<div class="outline-text-5" id="text-32-3-13-1">
<pre class="example">
CREATE
    [DEFINER = { user | CURRENT_USER }]
    PROCEDURE sp_name ([proc_parameter[,...]])
    [characteristic ...] routine_body

proc_parameter:
    [ IN | OUT | INOUT ] param_name type

mysql:routine:characteristics
</pre>

<dl class="org-dl">
<dt>IN</dt><dd>Default. It passes a value into a procedure. The procedure might modify the value, but the modification is not visible to the caller when the procedure returns.</dd>
<dt>OUT</dt><dd>passes a value from the procedure back to the caller. Its initial value is NULL within the procedure, and its value is visible to the caller when the procedure returns. An INOUT parameter is initialized by the caller, can be modified by the procedure, and any change made by the procedure is visible to the caller when the procedure returns.</dd>
</dl>

<p>
For each OUT or INOUT parameter, pass a user-defined variable in the CALL statement that invokes the procedure so that you can obtain its value when the procedure returns. If you are calling the procedure from within another stored procedure or function, you can also pass a routine parameter or local routine variable as an IN or INOUT parameter.
</p>

<p>
Routine parameters cannot be referenced in statements prepared within the routine
</p>

<p>
Each SELECT statement that does not insert into a table or a variable will produce a result set.
</p>
<pre class="example">
mysql&gt; delimiter //

mysql&gt; CREATE PROCEDURE simpleproc (OUT param1 INT)
    -&gt; BEGIN
    -&gt;   SELECT COUNT(*) INTO param1 FROM t;
    -&gt; END//
Query OK, 0 rows affected (0.00 sec)

mysql&gt; delimiter ;

mysql&gt; CALL simpleproc(@a);
Query OK, 0 rows affected (0.00 sec)

mysql&gt; SELECT @a;
+------+
| @a   |
+------+
| 3    |
+------+
1 row in set (0.00 sec)
</pre>
</div>
</div>

<div id="outline-container-org25a8239" class="outline-5">
<h5 id="org25a8239"><span class="section-number-5">32.3.13.2</span> Prepare Statement, Convert delimited string into temp table</h5>
<div class="outline-text-5" id="text-32-3-13-2">
<p>
A prepare statement is unique to a session. If it's not deallocated, it will be deallocated automatically when the session ends.
<a id="orgf609cff">mysql:string:list:temp table</a>
</p>
<pre class="example">
DROP PROCEDURE IF EXISTS `getArticlesByCats`;
CREATE PROCEDURE getArticlesByCats(IN pDelim VARCHAR(32), IN pStr TEXT )
DETERMINISTIC
MODIFIES SQL DATA
  BEGIN
    DROP TABLE IF EXISTS li_temp_explode;
    CREATE TEMPORARY TABLE li_temp_explode (id INT AUTO_INCREMENT PRIMARY KEY NOT NULL, word VARCHAR(40));
    SET @sql := CONCAT('INSERT INTO li_temp_explode (word) VALUES (', REPLACE(QUOTE(pStr), pDelim, '\'), (\''), ')');
    PREPARE myStmt FROM @sql;
    EXECUTE myStmt;
    DEALLOCATE PREPARE myStmt;
    -- Later use the temp table in IN statement
    SELECT *
    FROM node n
    WHERE EXISTS(
      SELECT * 
      FROM cats c
      WHERE c.cid IN (
        SELECT CAST(word AS UNSIGNED)
        FROM li_temp_explode
      )
    )
  END;
</pre>
<p>
word column is string
</p>

<pre class="example">
CALL `getArticlesByCats`(',', '1,31,5,6,7,8,9,10');
SELECT * FROM li_temp_explode;
</pre>
</div>
</div>
</div>

<div id="outline-container-org4b10eec" class="outline-4">
<h4 id="org4b10eec"><span class="section-number-4">32.3.14</span> User Defined Function <a id="orge4e4e4c">mysql:udf</a></h4>
<div class="outline-text-4" id="text-32-3-14">
<p>
A UDF always returns a value.
</p>

<p>
Syntax
</p>
<pre class="example">
CREATE
    [DEFINER = { user | CURRENT_USER }]
    FUNCTION sp_name ([func_parameter[,...]])
    RETURNS type
    [characteristic ...] routine_body

func_parameter:
    param_name type

type:
    Any valid MySQL data type

mysql:routine:characteristics
</pre>

<pre class="example">
SET @lis3 = 'http://s3.amazonaws.com/abc/';
SET @lifs = 'http://abc.com/sites/default/files/';
SET @litt = 'http://abc.com/';
SET @lir1 = '^(s3://)(.*)';
SET @lir2 = CONCAT(@lis3, '\\2');
SET @lir3 = '^(public://)(.*)';
SET @lir4 = CONCAT(@lifs, '\\2');

DROP FUNCTION IF EXISTS `liFileUri`;

CREATE FUNCTION `liFileUri` (`uri` VARCHAR(255)) 
  RETURNS VARCHAR(255)
DETERMINISTIC
NO SQL
  BEGIN
    RETURN REGEXP_REPLACE(REGEXP_REPLACE(uri, @lir1, @lir2), @lir3, @lir4);
  END;

DROP FUNCTION IF EXISTS `liConCat2`;
CREATE FUNCTION `liConCat2`(`v1` TEXT, `v2` TEXT)
  RETURNS TEXT
DETERMINISTIC
NO SQL
  BEGIN
    DECLARE s TEXT;
    IF (v1 IS NULL AND v2 IS NULL)
    THEN SET s = NULL;
    ELSE SET s = CONCAT_WS(0x1F, v1, v2);
    END IF;
    RETURN s;
  END;

-- UDF can't have optional parameter. e.g. have to create liConCat3 to concat 3 fields

DROP FUNCTION IF EXISTS `liFixNull`;
CREATE FUNCTION `liFixNull`(`text` TEXT)
  RETURNS TEXT
DETERMINISTIC
  BEGIN
-- Use this with CONCAT('aString', liFixNull(aColumn)) is useful because CONCAT returns NULL if any is null
    RETURN CASE text
           WHEN 'NULL' THEN NULL
           WHEN '' THEN NULL
           ELSE text
           END;
  END;
</pre>
</div>
</div>

<div id="outline-container-orgc8b0587" class="outline-4">
<h4 id="orgc8b0587"><span class="section-number-4">32.3.15</span> SQL Fiddle <a id="org63e15cc">mysqlfiddle</a></h4>
<div class="outline-text-4" id="text-32-3-15">
<p>
<a href="http://sqlfiddle.com/">http://sqlfiddle.com/</a> <a href="http://dbfiddle.uk/">http://dbfiddle.uk/</a>
</p>

<p>
Schema
</p>
<pre class="example">
CREATE TABLE student (
`id` INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY, 
`firstname` VARCHAR(20) NOT NULL,
`lastname` VARCHAR(20) NOT NULL,
`reg_date` TIMESTAMP
);

INSERT INTO student ( firstname, lastname, reg_date )
VALUES 
( 'first1', 'last1', current_timestamp),
( 'first2', 'last2', current_timestamp),
( 'first3', 'last3', current_timestamp)
;

CREATE TABLE s_score (
`id` INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY, 
`sid` INT(6) UNSIGNED NOT NULL,
`score` INT(3) UNSIGNED NOT NULL
);

INSERT INTO s_score ( sid, score )
VALUES 
( 1, 20 ),
( 1, 30 ),
( 2, 40 )
;

CREATE TABLE s_course (
`id` INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY, 
`sid` INT(6) UNSIGNED NOT NULL,
`course` VARCHAR(20)
);

INSERT INTO s_course ( sid, course )
VALUES 
( 1, 'Math'),
( 1, 'English' ),
( 2, 'PHP' )
;
</pre>
</div>
</div>

<div id="outline-container-orgab06f6f" class="outline-4">
<h4 id="orgab06f6f"><span class="section-number-4">32.3.16</span> Dump, Restore</h4>
<div class="outline-text-4" id="text-32-3-16">
<div class="org-src-container">
<pre class="src src-bash">mysqldump -u user -p database_name &gt; database_name_backup.sql

<span style="color: #74af68;"># </span><span style="color: #74af68;">dump specific tables</span>
mysqldump -u user -p database_name t1 t2 t3 &gt; a.sql

<span style="color: #74af68;"># </span><span style="color: #74af68;">Use config file to avoid typing password</span>
mysqldump --defaults-extra-file=/path/to/.mydb.cnf -u user db_name &gt; db_name_bk.sql
</pre>
</div>

<p>
.mydb.cnf
</p>
<pre class="example">
[mysqldump]
password='enclosedwithdoublequotes'
</pre>

<p>
MySQL is inside a container some-mysql and dump it on host
</p>
<div class="org-src-container">
<pre class="src src-bash">docker exec some-mysql sh -c <span style="color: #e67128;">'exec mysqldump --all-databases -uroot -p"your-passowrd"'</span> &gt; /some/path/on/your/host/all-databases.sql
</pre>
</div>

<p>
Restore
</p>
<div class="org-src-container">
<pre class="src src-bash">cat backup.sql | docker exec -i CONTAINER /usr/bin/mysql -u root --password=root DATABASE
</pre>
</div>

<p>
Dump a remote database
</p>
<div class="org-src-container">
<pre class="src src-bash">mysqldump -P3306  -h192.168.20.151 -u root -p databasename &gt; c:/my.sql
</pre>
</div>
</div>
</div>

<div id="outline-container-orga135220" class="outline-4">
<h4 id="orga135220"><span class="section-number-4">32.3.17</span> Binary Log</h4>
<div class="outline-text-4" id="text-32-3-17">
<p>
<a href="https://dev.mysql.com/doc/internals/en/binary-log-overview.html">https://dev.mysql.com/doc/internals/en/binary-log-overview.html</a>
</p>

<p>
See if it's enabled and see if the format :: ROW, MIXED or STATEMENT
</p>
<pre class="example">
select variable_value as "BINARY LOGGING STATUS (log-bin) :: "
from information_schema.global_variables where variable_name='log_bin';

select variable_value as "BINARY LOG FORMAT (binlog_format) :: " 
from information_schema.global_variables where variable_name='binlog_format'

// 
show variables like 'datadir';
</pre>

<p>
To update the setup, you need to update the MySQL configuration file (my.ini or my.cnf)  by adding the following lines to the [mysqld] section (the Server Section).
</p>

<pre class="example">
log-bin=bin.log
log-bin-index=bin-log.index
max_binlog_size=100M
binlog_format=row
socket=mysql.sock
</pre>

<pre class="example">
show variables like 'datadir';

// Log file location :: datadir/bin.0001.log

show binary logs;
</pre>

<p>
<a href="https://jinyuwang.weebly.com/for-mysql/how-to-enable-binary-logging-for-mysql">https://jinyuwang.weebly.com/for-mysql/how-to-enable-binary-logging-for-mysql</a>
</p>

<p>
Recover from deleted rows
</p>
<pre class="example">
mysqlbinlog binary_log_file &gt; query_log.sql
</pre>

<p>
Then search for missing rows.
</p>
</div>
</div>

<div id="outline-container-orge37776e" class="outline-4">
<h4 id="orge37776e"><span class="section-number-4">32.3.18</span> phpMyAdmin</h4>
<div class="outline-text-4" id="text-32-3-18">
<p>
<a href="https://www.phpmyadmin.net/downloads/">https://www.phpmyadmin.net/downloads/</a>
Just put sql-admin to any Wordpress website root directory and run <a href="http://yourwebsiteip:port/sql-admin">http://yourwebsiteip:port/sql-admin</a>
You don't need to do anything else.
</p>

<p>
It first loads sql-admin\libraries\config.default.php and then load sql-admin\config.inc.php
To create a config.inc.php, just duplicate sql-admin/config.sample.inc.php
</p>
</div>
</div>

<div id="outline-container-org32c098d" class="outline-4">
<h4 id="org32c098d"><span class="section-number-4">32.3.19</span> Adminer <a id="org6181cf6">db:adminer</a></h4>
<div class="outline-text-4" id="text-32-3-19">
<p>
When choose to dump (export in newer version) a database, leave blank for Database (don't DROP+CREATE) but DROP+CREATE for tables
</p>

<p>
Routines and Events for Database
Only Triggers for Tables
Data :: INSERT
</p>

<pre class="example">
-- START We don't want these lines
DROP DATABASE IF EXISTS `your_db`;
CREATE DATABASE `your_db`
USE `your_db`
-- END We don't want these lines

DROP TABLE IF EXISTS `wp_abc`;
CREATE TABLE `wp_ABC` ...
</pre>
</div>
</div>
</div>

<div id="outline-container-org4f8454b" class="outline-3">
<h3 id="org4f8454b"><span class="section-number-3">32.4</span> MSSQL</h3>
<div class="outline-text-3" id="text-32-4">
</div>
<div id="outline-container-orge366d1c" class="outline-4">
<h4 id="orge366d1c"><span class="section-number-4">32.4.1</span> Modify column values if exist (CASE WHEN)</h4>
<div class="outline-text-4" id="text-32-4-1">
<pre class="example">
SELECT colOne,
varColTwo = 
CASE colTwo
 WHEN 1 THEN 1
 WHEN 0 THEN 3
END,
varImage = 
CASE
 WHEN len(colImage) &gt; 0 THEN 'http://abc.com/images/' + colImage
 ELSE ''
END
FROM aTable
ORDER BY varColTwo DESC,
CASE 
 WHEN colFour = 1 THEN colFive
 WHEN colFour = 2 THEN colSix
END ASC      
</pre>
</div>
</div>

<div id="outline-container-org16f5302" class="outline-4">
<h4 id="org16f5302"><span class="section-number-4">32.4.2</span> Concatenate Multiple Columns to Single Column as String</h4>
<div class="outline-text-4" id="text-32-4-2">
<p>
A doc has multiple categories. Concatenate the categories delimited by commas.
</p>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #ffad29; font-weight: bold;">SELECT</span> doc.intDocID
      ,doc.varTitle
      ,STUFF(
          (<span style="color: #ffad29; font-weight: bold;">SELECT</span> <span style="color: #e67128;">','</span> + <span style="color: #23d7d7;">CAST</span>( t2.catID <span style="color: #ffad29; font-weight: bold;">AS</span> <span style="color: #34cae2;">varchar</span>(10) )
           <span style="color: #ffad29; font-weight: bold;">FROM</span> tblDocCat t2
           <span style="color: #ffad29; font-weight: bold;">WHERE</span> t2.intDocID = doc.intDocID
           <span style="color: #ffad29; font-weight: bold;">FOR</span> XML <span style="color: #ffad29; font-weight: bold;">PATH</span>(<span style="color: #e67128;">''</span>)
          ),
          1,
          1,
          <span style="color: #e67128;">''</span>
       ) <span style="color: #ffad29; font-weight: bold;">AS</span> docCats
</pre>
</div>
</div>

<div id="outline-container-org9b9c678" class="outline-5">
<h5 id="org9b9c678"><span class="section-number-5">32.4.2.1</span> STUFF</h5>
<div class="outline-text-5" id="text-32-4-2-1">
<p>
This deletes the first letter of a column and returns the rest.
STUFF first deletes a substring from aCol at start:1 and length_to_delete:1
and then insert a string at the start position
</p>
<pre class="example">
STUFF(aCol, 1,1, '')
</pre>
</div>
</div>
</div>

<div id="outline-container-org31faeb7" class="outline-4">
<h4 id="org31faeb7"><span class="section-number-4">32.4.3</span> Export as CSV - BCP <a id="orga302ce9">mssql:bcp</a></h4>
<div class="outline-text-4" id="text-32-4-3">
<p>
bcp.exe is in 
C:\Program Files\Microsoft SQL Server\90\Tools\Binn\
</p>

<pre class="example">
bcp "Select * from fullDatabasename.dbo.tableName" queryout "c:\aFolder\aFile.csv" -c -t"\",\"" -r"\"\n\"" -T
</pre>

<p>
Table name in full :: DEDP225.[dev.todaystrucking].dbo.[tblDocument]
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">c</td>
<td class="org-left">Ascii</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">field terminator. Comma</td>
</tr>

<tr>
<td class="org-left">r</td>
<td class="org-left">row terminator. New line :: "\n"</td>
</tr>

<tr>
<td class="org-left">T</td>
<td class="org-left">trusted connection</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-org5e72105" class="outline-5">
<h5 id="org5e72105"><span class="section-number-5">32.4.3.1</span> Escape % if bcp is in batch file</h5>
<div class="outline-text-5" id="text-32-4-3-1">
<pre class="example">
bcp "SELECT * FROM aTable WHERE email LIKE '%%@%%.%%'"
</pre>
</div>
</div>

<div id="outline-container-org0e8b0a4" class="outline-5">
<h5 id="org0e8b0a4"><span class="section-number-5">32.4.3.2</span> Save long query in Global Temporary table (GTT)</h5>
<div class="outline-text-5" id="text-32-4-3-2">
<pre class="example">
SELECT *
INTO ##myglobaltemptable
FROM tableA
</pre>

<p>
Drop the GTT after bcp: <code>DROP TABLE ##myglobaltemptable</code>
</p>

<pre class="example">
bcp ##myglobaltemptable out "c:\folder\file.csv" -c -t"\",\"" -r"\"\n\"" -T
</pre>
</div>
</div>

<div id="outline-container-org399ee8f" class="outline-5">
<h5 id="org399ee8f"><span class="section-number-5">32.4.3.3</span> Get all columns</h5>
<div class="outline-text-5" id="text-32-4-3-3">
<pre class="example">
DECLARE @colnames VARCHAR(max);
SELECT @colnames = COALESCE(@colnames + ',', '') + char(39)+ column_name +char(39) 
FROM INFORMATION_SCHEMA.COLUMNS where TABLE_NAME='%yourtablename%'; 
SELECT @colnames
</pre>

<p>
It returns <code>'col1','col2',...,'colLast'</code>
</p>

<p>
Export to header.csv
<code>bcp "SELECT 'col1','col2',...,'colLast'" queryout "c:\header.csv" -c -t"\",\"" -r"\"\n\"" -T</code>
</p>
</div>
</div>

<div id="outline-container-orgdfd1c8f" class="outline-5">
<h5 id="orgdfd1c8f"><span class="section-number-5">32.4.3.4</span> Last step</h5>
<div class="outline-text-5" id="text-32-4-3-4">
<p>
Both header and data files need to be fixed.
Insert a double quote at the beginning of the file and delete the last double quote at the end of it.
Insert a new line at the end of the header file.
</p>

<p>
Combine 2 files
<code>copy /b c:\header.csv+c:\folder\file.csv c:\export.csv</code>
</p>
</div>
</div>
</div>

<div id="outline-container-orgbf2a947" class="outline-4">
<h4 id="orgbf2a947"><span class="section-number-4">32.4.4</span> Export as XML</h4>
<div class="outline-text-4" id="text-32-4-4">
<p>
By default, it's UTF-8 encoded. datetime will be automatically converted to XML format.
If value is NULL, the xml node will not be generated.
By default, MSSQL will add <code>&lt;CR&gt;&lt;LF&gt;</code> into the Unicode XML data stream every 2033 characters.
Use bcp with option -r to add no new line.
</p>
</div>

<div id="outline-container-org0d33a70" class="outline-5">
<h5 id="org0d33a70"><span class="section-number-5">32.4.4.1</span> Query</h5>
<div class="outline-text-5" id="text-32-4-4-1">
<pre class="example">
SELECT CustomerID as "@id",
CompanyName,
Address as "address/street",
City as "address/city",
Region as "address/region",
PostalCode as "address/zip",
Country as "address/country",
ContactName as "contact/name",
ContactTitle as "contact/title",
NULLIF(Phone,'') as "contact/phone",
-- If value is NULL, the xml node will not be generated
Fax as "contact/fax"
FROM Customers
FOR XML PATH('Customer'), ROOT('doc')
</pre>

<p>
Result
</p>
<pre class="example">
&lt;doc&gt;
  &lt;Customer id="ALFKI"&gt;
    &lt;CompanyName&gt;Alfreds Futterkiste&lt;/CompanyName&gt;
    &lt;address&gt;
      &lt;street&gt;Obere Str. 57&lt;/street&gt;
      &lt;city&gt;Berlin&lt;/city&gt;
      &lt;zip&gt;12209&lt;/zip&gt;
      &lt;country&gt;Germany&lt;/country&gt;
    &lt;/address&gt;
    &lt;contact&gt;
      &lt;name&gt;Maria Anders&lt;/name&gt;
      &lt;title&gt;Sales Representative&lt;/title&gt;
      &lt;phone&gt;030-0074321&lt;/phone&gt;
      &lt;fax&gt;030-0076545&lt;/fax&gt;
    &lt;/contact&gt;
  &lt;/Customer&gt;
  ...
&lt;/doc&gt;
</pre>

<p>
INNER JOIN Multiple records
</p>
<pre class="example">
SELECT d.docID
,(
SELECT c.category AS category
FROM tblDocCats dc
 INNER JOIN tblCategory c ON c.catID = dc.catID
WHERE dc.docID = d.docID
FOR XML PATH(''), TYPE
) AS categories
FROM doc d
FOR XML PATH('item'), ROOT('items')
</pre>

<p>
Result
</p>
<pre class="example">
&lt;items&gt;
 &lt;item&gt;
  &lt;docID&gt;&lt;/docID&gt;
  &lt;categories&gt;
   &lt;category&gt;&lt;/category&gt;
   ...
  &lt;categories&gt;
 &lt;item&gt;
&lt;/items&gt;
</pre>

<p>
This
</p>
<pre class="example">
,(
SELECT c.category AS name, c.catID as ID
FROM tblDocCats dc
 INNER JOIN tblCategory c ON c.catID = dc.catID
WHERE dc.docID = d.docID
FOR XML PATH('category'), TYPE
)
</pre>
<p>
will result as
</p>
<pre class="example">
&lt;items&gt;
 &lt;item&gt;
  &lt;docID&gt;&lt;/docID&gt;
  &lt;category&gt;
   &lt;name&gt;&lt;/name&gt;
   &lt;id&gt;&lt;/id&gt;
  &lt;category&gt;
  &lt;category&gt;
   &lt;name&gt;&lt;/name&gt;
   &lt;id&gt;&lt;/id&gt;
  &lt;/category&gt;
  ...
 &lt;item&gt;
&lt;/items&gt;
</pre>
</div>
</div>

<div id="outline-container-org7e2b11d" class="outline-5">
<h5 id="org7e2b11d"><span class="section-number-5">32.4.4.2</span> Different modes</h5>
<div class="outline-text-5" id="text-32-4-4-2">
<p>
FOR XML AUTO
</p>
<pre class="example">
&lt;servername.dbo.Customers ID="C11" Name="..." Address="..." /&gt;
</pre>

<p>
FOR XML RAW
</p>
<pre class="example">
&lt;row ID="C11" Name="..." Address="..." /&gt;
</pre>

<p>
FOR XML PATH
</p>
<pre class="example">
&lt;row&gt;
  &lt;ID&gt;&lt;/ID&gt;
  &lt;Name&gt;&lt;/Name&gt;
  &lt;Address&gt;&lt;/Address&gt;
&lt;/row&gt;
</pre>
</div>
</div>

<div id="outline-container-org7c294b2" class="outline-5">
<h5 id="org7c294b2"><span class="section-number-5">32.4.4.3</span> bcp</h5>
<div class="outline-text-5" id="text-32-4-4-3">
<pre class="example">
bcp "query..." queryout C:\file.xml -T -w -r
</pre>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">r</td>
<td class="org-left">no value means don't add any newline character for every 2033 characters or new row</td>
</tr>

<tr>
<td class="org-left">w</td>
<td class="org-left">Use Unicode characters</td>
</tr>

<tr>
<td class="org-left">S</td>
<td class="org-left">server_name[\instance_name]</td>
</tr>
</tbody>
</table>

<p>
Save long query as stored procedure. You can't save FOR XML in Global Temporary Table.
dev.todaystrucking is the database name. Inside the real SELECT, you can refer to table as
dbo.tablename not DEDP225.[dev.todaystrucking].dbo.tablename
</p>
<pre class="example">
USE [dev.todaystrucking]
GO

IF OBJECT_ID('dbo.usp_exporttr') IS NOT NULL DROP PROC dbo.usp_exporttr
GO

CREATE PROC dbo.usp_exporttr AS

SET NOCOUNT ON

SELECT ...
FOR XML PATH('item'), ROOT('items')

RETURN
GO
</pre>

<p>
Then creat another query in MS SQL Server Management Studio and run
</p>
<pre class="example">
EXEC xp_cmdshell 'bcp "EXEC [dev.todaystrucking].dbo.usp_exporttr" queryout "c:\a.xml" -S (local) -T -w -r'
</pre>

<p>
You may receive "SQL Server blocked access to procedure 'sys.xp_cmdshell' of component 'xp_cmdshell' because this component is turned off as part of the security configuration"
</p>

<p>
Just go to bcp folder and run as a command line <a href="#orga302ce9">mssql:bcp</a>
</p>
<pre class="example">
bcp "EXEC [dev.todaystrucking].dbo.usp_exporttr" queryout "c:\a.xml" -S (local) -T -w -r
</pre>

<p>
The exported xml file will have UCS-2 encoding which is a preceding version of UTF-16.
This encoding is in BOM. For SQL Server lower than 2016, you can't set encoding to UTF-8.
</p>
</div>
</div>

<div id="outline-container-orgfbf5106" class="outline-5">
<h5 id="orgfbf5106"><span class="section-number-5">32.4.4.4</span> bcp clean up</h5>
<div class="outline-text-5" id="text-32-4-4-4">
<p>
You can run these in Git Bash on Windows
Change encoding to UTF-8
iconv -f UCS-2 -t UTF-8 a.xml &gt; b.xml
</p>

<p>
Add xml declaration
echo '&lt;?xml version="1.0"?&gt;' | cat - b.xml &gt; c.xml
</p>

<p>
Delete <a href="#org435fc1f">xml:invalid_characters</a> <a href="#org97dacda">bash:sed</a>
sed "s/&amp;#x1f;//gi; s/&amp;#x1e;//gi;" c.xml &gt; d.xml
</p>
</div>
</div>
</div>

<div id="outline-container-orgf321339" class="outline-4">
<h4 id="orgf321339"><span class="section-number-4">32.4.5</span> Copy to Excel</h4>
<div class="outline-text-4" id="text-32-4-5">
<p>
C-a and C-c, C-v in Excel
For datetime, you can <code>=now()</code> in a new cell, format paint the datetime columns.
</p>

<p>
In the <code>=now()</code> cell, you can check out the Custom format. It's yyyy-mm-dd h:mm
You can change it to yyyy-mm-dd h:mm:ss AM/PM
</p>
</div>
</div>

<div id="outline-container-org3aadb4b" class="outline-4">
<h4 id="org3aadb4b"><span class="section-number-4">32.4.6</span> Migrate to MySQL</h4>
<div class="outline-text-4" id="text-32-4-6">
<p>
Export MSSQL to a bak file. <a href="#org077c0ab">mssql:backup</a>
<a href="https://stackoverflow.com/questions/156279/how-to-import-a-sql-server-bak-file-into-mysql">https://stackoverflow.com/questions/156279/how-to-import-a-sql-server-bak-file-into-mysql</a>
</p>

<p>
If the bak file is less than 10gb, follow this:
<a href="https://www.silicongadget.com/software/database/import-mssql-bak-files-to-mysql/2955/">https://www.silicongadget.com/software/database/import-mssql-bak-files-to-mysql/2955/</a>
</p>
<ul class="org-ul">
<li>Restore MSSQL database using the bak file using MS SQL Server Express Edition</li>
<li>Use MySQL Workbench to connect to the MSSQL database and then migrate to MySQL</li>
</ul>
</div>
</div>

<div id="outline-container-org0a948ad" class="outline-4">
<h4 id="org0a948ad"><span class="section-number-4">32.4.7</span> Connections</h4>
<div class="outline-text-4" id="text-32-4-7">
<p>
Number of active connections by database
</p>
<pre class="example">
SELECT 
    DB_NAME(dbid) as DBName, 
    COUNT(dbid) as NumberOfConnections,
    loginame as LoginName
FROM sys.sysprocesses
WHERE dbid &gt; 0
GROUP BY dbid, loginame

-- 2017 new query

SELECT @@ServerName AS server
 ,NAME AS dbname
 ,COUNT(STATUS) AS number_of_connections
FROM sys.databases sd
LEFT JOIN sys.sysprocesses sp ON sd.database_id = sp.dbid
GROUP BY NAME
</pre>
</div>
</div>

<div id="outline-container-orga676a51" class="outline-4">
<h4 id="orga676a51"><span class="section-number-4">32.4.8</span> Last access</h4>
<div class="outline-text-4" id="text-32-4-8">
<pre class="example">
SELECT d.name,
last_user_seek = MAX(last_user_seek),
last_user_scan = MAX(last_user_scan),
last_user_lookup = MAX(last_user_lookup),
last_user_update = MAX(last_user_update)
FROM sys.dm_db_index_usage_stats AS i
JOIN sys.databases AS d ON i.database_id=d.database_id
GROUP BY d.name
</pre>
</div>
</div>

<div id="outline-container-org308efb2" class="outline-4">
<h4 id="org308efb2"><span class="section-number-4">32.4.9</span> Backup</h4>
<div class="outline-text-4" id="text-32-4-9">
<p>
<a id="org077c0ab">mssql:backup</a>
<a href="https://docs.microsoft.com/en-us/sql/relational-databases/backup-restore/create-a-full-database-backup-sql-server">https://docs.microsoft.com/en-us/sql/relational-databases/backup-restore/create-a-full-database-backup-sql-server</a>
Export database to bak file.
SQL Management Studio Tool &gt; right click on a database and
Tasks &gt; Backup &gt; Use Full backup, specify a destination (path to bak).
Use overwrite settings in Options.
Then click on Script &gt; Script to file. You will get a .sql:
</p>
<pre class="example">
BACKUP DATABASE [aDatabase] TO DISK ='N'C:\afile.bak' WITH NOFORMAT, INIT, 
NAME = N'aDatabase-Full Database Backup', 
SKIP, NOREWIND, NOUNLOAD,  STATS = 10
GO
</pre>

<p>
Make filename dynamic (remove spaces if necessary):
</p>
<pre class="example">
DECLARE @filename nvarchar(200) = ''
SELECT @filename = 'C:\test-' + convert(varchar(23), getdate(), 126) + '.bak'
BACKUP DATABASE [aDatabase] TO
 DISK =  @filename WITH NOFORMAT, INIT,  
 NAME = N'aDatabase-Full Database Backup', SKIP, NOREWIND, NOUNLOAD,  STATS = 10
GO
</pre>

<p>
Run this .sql file:
</p>
<pre class="example">
sqlcmd -S sqlservername -i C:\sqlFileName.sql
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org378bf2a" class="outline-2">
<h2 id="org378bf2a"><span class="section-number-2">33</span> DFP</h2>
<div class="outline-text-2" id="text-33">
</div>
<div id="outline-container-org2a3477e" class="outline-3">
<h3 id="org2a3477e"><span class="section-number-3">33.1</span> Why async is required</h3>
<div class="outline-text-3" id="text-33-1">
<p>
Video companion requires async
pubService.refresh requires async
POST request requires async. GET request with larger than 2048 bytes not supported.
</p>

<p>
However, it's better to use sync mode for rich media creative unless the creative is in friendly frames
</p>
</div>
</div>

<div id="outline-container-org6328bc3" class="outline-3">
<h3 id="org6328bc3"><span class="section-number-3">33.2</span> Competition Calculation</h3>
<div class="outline-text-3" id="text-33-2">
<ul class="org-ul">
<li>List of candidate line items</li>
<li>select the best line item</li>
<li>select the best creative associated with the winning line item</li>
<li>DFP remnant and Ad Exchange/Adsense line items are evaluated</li>
</ul>
<p>
to see if they have line items with a higher yield
</p>
<ul class="org-ul">
<li>the best creastive associated with the winning line item is selected</li>
<li>creative returned to the browser. Dynamic allocation.</li>
</ul>
</div>
</div>

<div id="outline-container-orge0c7e6d" class="outline-3">
<h3 id="orge0c7e6d"><span class="section-number-3">33.3</span> Key-Value Targeting</h3>
<div class="outline-text-3" id="text-33-3">
<p>
Slot-level targeting is recommended
</p>
<pre class="example">
googletag.defineSlot('/123/travel/asia/food', [728, 90], "div-id")
         .addService(googletag.pubads())
         .setTargeting("interests", ["sports", "music"]);
</pre>

<p>
Page-level targeting
</p>
<pre class="example">
googltag.pubads().setTargeting("topic", "basketball");
</pre>
</div>
</div>

<div id="outline-container-org0ec1c26" class="outline-3">
<h3 id="org0ec1c26"><span class="section-number-3">33.4</span> Exclusive Ads on Specific Page</h3>
<div class="outline-text-3" id="text-33-4">
<p>
Let's say there're 2 LBs and 2 BBs throughout the website.
999/LB1, 999/LB2, 999/BB1, 999/BB2
For a specific page, Line Item A takes over all ad units.
For another specific page, Line Item B takes over all ad units.
</p>

<p>
The perfect way
Create multilevel ad units and make them Special Ad Units. 
999/LB1/exclusive, 999/LB2/exclusive
999/BB1/exclusive, 999/BB2/exclusive
</p>

<p>
On those specific pages:
</p>
<ul class="org-ul">
<li>Use the new tags of multilevel and special ad units on HTML instead of the original ones.</li>
<li>setTargetting on HTML and on DFP so that Line Item A and B can be distinguished.</li>
</ul>

<p>
The better way
Multilevel and Special ad units are only avaiable in Premium. Here's the way for SBS
</p>
<ul class="org-ul">
<li>999/LB1_exclusive, 999/LB2_exclusive</li>
<li>999/BB1_exclusive, 999/BB2_exclusive</li>
<li>Use the new tags on HTML instead of the original ones</li>
<li>setTargetting on HTML and DFP so that Line Item A and B</li>
</ul>

<p>
The workaround way
If you don't have control on HTML, you can:
</p>
<ul class="org-ul">
<li>For Line Item A and B
<ul class="org-ul">
<li>On DFP
<ul class="org-ul">
<li>add Key-Value pair exclusive is exclusive</li>
<li>add Key-Value pair sponsor is lineitemA</li>
</ul></li>
<li>In HTML, for those specific pages
<ul class="org-ul">
<li>setTargeting("exclusive","exclusive");</li>
<li>setTargeting("sponsor","lineitemA");</li>
</ul></li>
</ul></li>
<li>For other normal line items
<ul class="org-ul">
<li>On DFP
<ul class="org-ul">
<li>add Key-Value par 'exclusive is not <code>exclusive' (</code> means contain and * means begin with)</li>
</ul></li>
<li>In HTML, do nothing (remain the same)</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org8d0d2c0" class="outline-3">
<h3 id="org8d0d2c0"><span class="section-number-3">33.5</span> DFP in email</h3>
<div class="outline-text-3" id="text-33-5">
<p>
<a href="https://support.google.com/dfp_premium/answer/2623168?hl=en">Simplified URL tags on DFP Help</a>
</p>

<pre class="example">
&lt;a href="http://my.com/ad/ad_unit_name/728x90/"&gt;
 &lt;img width="728" height="90" alt=""
  src="http://pubads.g.doubleclick.net/gampad/ad?iu=/networkid/ad_unit_name&amp;sz=728x90&amp;c=[todays_date][account]" /&gt;
&lt;/a&gt;
</pre>

<p>
Base URL :: <a href="http://pubads.g.doubleclick.net/gampad/">http://pubads.g.doubleclick.net/gampad/</a>[request-type]?[parameters]
</p>

<p>
Request Type
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">ad</td>
<td class="org-left">simple image creative</td>
</tr>

<tr>
<td class="org-left">jump</td>
<td class="org-left">log click and redirect to destination URL</td>
</tr>

<tr>
<td class="org-left">adx</td>
<td class="org-left">return raw code of creative</td>
</tr>

<tr>
<td class="org-left">clk</td>
<td class="org-left">only log click but no redirect. Only in DFP Premium</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Parameters
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">iu</td>
<td class="org-left">for all request types</td>
</tr>

<tr>
<td class="org-left">sz</td>
<td class="org-left">for ad, jump and adx</td>
</tr>

<tr>
<td class="org-left">t</td>
<td class="org-left">for ad, jump and adx. key-value pairs</td>
</tr>

<tr>
<td class="org-left">excl_cat</td>
<td class="org-left">competitive exclusions</td>
</tr>

<tr>
<td class="org-left">c</td>
<td class="org-left">for ad, jump and adx. cache buster. only number</td>
</tr>

<tr>
<td class="org-left">m</td>
<td class="org-left">for adx. Specify file type to return. m=text/html</td>
</tr>

<tr>
<td class="org-left">submodel</td>
<td class="org-left">for all request types. Mobile device name</td>
</tr>

<tr>
<td class="org-left">u_w</td>
<td class="org-left">for all request types. Mobile device screen height.</td>
</tr>

<tr>
<td class="org-left">title</td>
<td class="org-left">required if mutliple ad tags use the same ad unit code on the same page</td>
</tr>

<tr>
<td class="org-left">mob</td>
<td class="org-left">Indicaste it's a mobile request.</td>
</tr>
</tbody>
</table>

<pre class="example">
&lt;script src="//code.jquery.com/jquery-1.10.2.js"&gt;&lt;/script&gt;
&lt;script&gt;
var ad_unit = 'ad_unit_name';
var ad_unit_size = '728x90';
var rnd=Math.floor(Math.random() * (999999 - 10 +1)) + 10;
var theUrl='//pubads.g.doubleclick.net/gampad/adx?iu=/' + ad_unit 
        + '&amp;sz=' + ad_unit_size + '&amp;c=' + rnd;
var xmlHttp = null;
xmlHttp = new XMLHttpRequest();
xmlHttp.open( "GET", theUrl );
xmlHttp.send();
xmlHttp.onreadystatechange=function() {
  if (xmlHttp.readyState==4 &amp;&amp; xmlHttp.status==200) {
    xmlDoc = $.parseHTML( xmlHttp.response );
    adlink = $(xmlDoc).find('a').attr('href');
    if (typeof adlink == "undefined") adlink = "http://www.example.com";
      window.location = adlink;
  }
}
&lt;/script&gt;
</pre>

<p>
PHP, DFP creative type Custom. Get response line by line
</p>
<pre class="example">
$url = "http://pubads.g.doubleclick.net/gampad/adx?iu=/12343/ad_unit_name&amp;sz=230x20&amp;c=". REQUEST_TIME."&amp;m=text/html";
$json = @file_get_contents($url);
if ($json !== FALSE) {
  $lines = explode("\n", $json);
  $link = ( isset($lines[0]) ) ? trim($lines[0]) : 'default';
}
</pre>

<p>
Wordpress example <a href="#org93d7a17">wp:filter:template_include</a>
</p>
</div>
</div>

<div id="outline-container-org1548af4" class="outline-3">
<h3 id="org1548af4"><span class="section-number-3">33.6</span> Responsive</h3>
<div class="outline-text-3" id="text-33-6">
<p>
Add a size to the ad unit /networkid/adunitname
You can specify one or more sizes for a line item that uses this ad unit.
And upload each creative and specify the size. You can have creative bigger than the size you specify.
</p>

<pre class="example">
googletag.cmd.push(function() {
  var leaderboard_mapping = googletag.sizeMapping()
  .addSize([1280, 800], [[970, 250], [970, 90], [728, 90]])
  .addSize([600, 800], [468, 60]) // viewport size is width and height both &gt; 600 and 800
  .addSize([0, 0], [[320, 50], [320, 100]]) // Map any viewport size
/* This will only display the ad if it's mobile or tablet viewport size
  .addSize([0, 0], []) // [] means don't try to call an ad
  .addSize([320, 700], [300, 250]) // Mobile or tablet
  .addSize([1050, 200], [])
*/
  .build();

  googletag.defineSlot('/networkid/adunitname'
           , [728, 90] // If there is an error in the mapping or if the browser size can't be determined
                       // the size specified here in .defineSlot will be used. 
           , 'div-id')
           .defineSizeMapping(leaderboard_mapping)
           .addService(googletag.pubads());
});
</pre>
</div>
</div>

<div id="outline-container-orgcd8ba8e" class="outline-3">
<h3 id="orgcd8ba8e"><span class="section-number-3">33.7</span> Macro in Third Party Code, Custom Code</h3>
<div class="outline-text-3" id="text-33-7">
<p>
CACHEBUSTER :: time in integer
CLICK_URL_UNESC :: normal click macro
CLICK_URL_ESC :: escaped click macro (&amp;, ? , %)
</p>

<p>
VIEW_URL_UNESC, VIEW_URL_ESC :: required in Custom Code
</p>

<p>
If DFP macro comes at the start of the URL chain, the unescaped macro should be used.
IF DFP macro comes at the end of the URL chain, the escaped macro should be used. (DFP macro is passed as a parameter to 3rd party server)
</p>

<p>
<a id="org9643b1c">dfp:third party code</a>
Third Party Code with macro automatically inserted
</p>
<pre class="example">
&lt;!-- url parameter ncu is inserted, ord's [timestamp] is replaced by CACHEBUSTER --&gt;
&lt;script src="http://bs.serving-sys.com/Serving/adServer.bs?c=28&amp;cn=display&amp;pli=1074030166&amp;w=728&amp;h=90&amp;ncu=$$%%CLICK_URL_UNESC%%$$&amp;ord=%%CACHEBUSTER%%&amp;ifrm=-1&amp;z=0"&gt;&lt;/script&gt;
&lt;noscript&gt;
&lt;!-- insert CLICK_URL_UNESC in href --&gt;
&lt;a href="%%CLICK_URL_UNESC%%http://bs.serving-sys.com/Serving/adServer.bs?cn=brd&amp;pli=1074030166&amp;Page=&amp;Pos=944448101" target="_blank"&gt;
&lt;img src="http://bs.serving-sys.com/Serving/adServer.bs?c=8&amp;cn=display&amp;pli=1074030166&amp;Page=&amp;Pos=944448101" border=0 width=728 height=90&gt;&lt;/a&gt;
&lt;/noscript&gt;
</pre>

<p>
Sometimes you need to have DFP inserted the macros in third party code mode, and then use that in Custom Code.
</p>

<p>
<a id="org49b8e24">dfp:custom code</a>
VIEW_URL_UNESC or VIEW_URL_ESC should be included otherwise impression won't be tracked.
In preview, this view macro returns empty but that's normal. It has value when the creative is served.
</p>
</div>
</div>

<div id="outline-container-org827e156" class="outline-3">
<h3 id="org827e156"><span class="section-number-3">33.8</span> Creative Type: Third Party Code - Video</h3>
<div class="outline-text-3" id="text-33-8">
<pre class="example">
&lt;script src="//content.jwplatform.com/players/xxx-xxx.js?v=%%CACHEBUSTER%%"&gt;&lt;/script&gt;
</pre>

<p>
Viewbix
</p>
<pre class="example">
&lt;iframe width="300" height="250" 
src="http://www.viewbix.com/frame/1234-567-890?w=300&amp;h=250&amp;ord=%%CACHEBUSTER%%" 
frameborder="0" scrolling="no" allowTransparency="true"&gt;&lt;/iframe&gt;
</pre>
</div>
</div>

<div id="outline-container-orgdaa7c7e" class="outline-3">
<h3 id="orgdaa7c7e"><span class="section-number-3">33.9</span> Creative Type: HTML5</h3>
<div class="outline-text-3" id="text-33-9">
<p>
Upload zip file or single html file
</p>
</div>
</div>

<div id="outline-container-org2dc02ea" class="outline-3">
<h3 id="org2dc02ea"><span class="section-number-3">33.10</span> Creative Type: DoubleClick Tag, DCM Tag</h3>
<div class="outline-text-3" id="text-33-10">
<p>
DCM, previously known as DFA (for advertisers), is DoubleClick Campaign Manager, part of the DoubleClick Marketing Solutions.
</p>

<p>
<a href="https://support.google.com/dcm/partner/answer/2826636">DCM placement tags</a>
</p>

<p>
Always use Internal redirect tag for DFP. Sometimes this tag is not given by agency, you will need to convert it to this type.
Ins tag is recommended for ad servers other than DFP because it has active view capability.
</p>

<p>
ddm/jump tag (redirect to final destination) has to be loaded with ddm/ad tag.
</p>

<p>
Other tags like ddm/trackimp, ddm/trackclk, ddm/clk don't have to be loaded with ddm/ad tag.
</p>
</div>

<div id="outline-container-orga1123ff" class="outline-4">
<h4 id="orga1123ff"><span class="section-number-4">33.10.1</span> Standard tags (ddm/jump, ddm/ad)</h4>
<div class="outline-text-4" id="text-33-10-1">
<pre class="example">
&lt;A HREF="https://ad.doubleclick.net/ddm/jump/Nxxxx.site-keyname/Byyyyyyy.Pzzzz;sz=widthxheight;kw=[keyword];ord=[timestamp]?"&gt;

&lt;IMG SRC="https://ad.doubleclick.net/ddm/ad/Nxxxx.site-keyname/Byyyyyyy.Pzzzz;sz=widthxheight;ord=[timestamp];dc_lat=N;dc_rdid=Czzzz;tag_for_child_directed_treatment=I?" BORDER=0 WIDTH=X HEIGHT=Y ALT="Click Here"&gt;&lt;/A&gt;
</pre>

<p>
Nxxx: DCM account id
Byyyy: DCM campaign ID
.Pzzzz: DCM placement ID
dc_lat=N: key-value pair for mobile app to pass if the user has enabled "Limit Ad Tracking"
dc_rdid=Czzz: key-value pair for mobile app to pass resettable device identifiers in the form of IDFA for iOS or advertising ID (AdID) for Android
tag_for_child_directed_treatment=I: key-value pair for mobile app to pass info about if a request may come from a user under the age of 13
</p>
</div>
</div>

<div id="outline-container-org95e9b19" class="outline-4">
<h4 id="org95e9b19"><span class="section-number-4">33.10.2</span> iframe/javascript tags  (ddm/adi, ddm/adj)</h4>
<div class="outline-text-4" id="text-33-10-2">
<pre class="example">
&lt;IFRAME SRC=""https://ad.doubleclick.net/ddm/adi/N1234.123456yoursite.com/B1234567.123456789;sz=300x250;ord=[timestamp];dc_lat=;dc_rdid=;tag_for_child_directed_treatment=?"" WIDTH=300 HEIGHT=250 MARGINWIDTH=0 MARGINHEIGHT=0 HSPACE=0 VSPACE=0 FRAMEBORDER=0 SCROLLING=no BORDERCOLOR='#000000'&gt;
&lt;SCRIPT language='JavaScript1.1' SRC=""https://ad.doubleclick.net/ddm/adj/N1234.123456yoursite.com/B1234567.123456789;abr=!ie;sz=300x250;ord=[timestamp];dc_lat=;dc_rdid=;tag_for_child_directed_treatment=?""&gt;
&lt;/SCRIPT&gt;
&lt;NOSCRIPT&gt;
&lt;A HREF=""https://ad.doubleclick.net/ddm/jump/N1234.123456yoursite.com/B1234567.123456789;abr=!ie4;abr=!ie5;sz=300x250;ord=[timestamp]?""&gt;
&lt;IMG SRC=""https://ad.doubleclick.net/ddm/ad/N1234.123456yoursite.com/B1234567.123456789/B10762433.143897886;abr=!ie4;abr=!ie5;sz=300x250;ord=[timestamp];dc_lat=;dc_rdid=;tag_for_child_directed_treatment=?"" BORDER=0 WIDTH=300 HEIGHT=250 ALT=""Advertisement""&gt;&lt;/A&gt;
&lt;/NOSCRIPT&gt;
&lt;/IFRAME&gt;
</pre>
</div>
</div>

<div id="outline-container-orged30803" class="outline-4">
<h4 id="orged30803"><span class="section-number-4">33.10.3</span> javascript (ddm/adj)</h4>
<div class="outline-text-4" id="text-33-10-3">
<pre class="example">
&lt;SCRIPT language='JavaScript1.1' SRC=""https://ad.doubleclick.net/ddm/adj/N1234.123456yoursite.com/B1234567.123456789;sz=300x250;ord=[timestamp];dc_lat=;dc_rdid=;tag_for_child_directed_treatment=?""&gt;
&lt;/SCRIPT&gt;
&lt;NOSCRIPT&gt;
&lt;A HREF=""https://ad.doubleclick.net/ddm/jump/N1234.123456yoursite.com/B1234567.123456789;sz=300x250;ord=[timestamp]?""&gt;
&lt;IMG SRC=""https://ad.doubleclick.net/ddm/ad/N1234.123456yoursite.com/B1234567.123456789;sz=300x250;ord=[timestamp];dc_lat=;dc_rdid=;tag_for_child_directed_treatment=?"" BORDER=0 WIDTH=300 HEIGHT=250 ALT=""Advertisement""&gt;&lt;/A&gt;
&lt;/NOSCRIPT&gt;
</pre>
</div>
</div>

<div id="outline-container-org3d2316f" class="outline-4">
<h4 id="org3d2316f"><span class="section-number-4">33.10.4</span> Pre-fetch tags (ddm/pfadx)</h4>
<div class="outline-text-4" id="text-33-10-4">
<pre class="example">
# VAST 2.0
https://ad.doubleclick.net/ddm/pfadx/Nxxxx.site-keyname/Byyyyyyy;kw=[keyword]; sz=widthxheight;ord=[timestamp];dc_lat=N;dc_rdid=Czzzz;tag_for_child_directed_treatment=I;dcmt=text/xml

# VAST 3.0
https://ad.doubleclick.net/ddm/pfadx/Nxxxx.site-keyname/Byyyyyyy;kw=[keyword]; sz=widthxheight;ord=[timestamp];dc_lat=N;dc_rdid=Czzzz;tag_for_child_directed_treatment=I;dcmt=text/xml;dc_vast=3

# VAST 4.0
https://ad.doubleclick.net/ddm/pfadx/Nxxxx.site-keyname/Byyyyyyy;kw=[keyword]; sz=widthxheight;ord=[timestamp];dc_lat=N;dc_rdid=Czzzz;tag_for_child_directed_treatment=I;dcmt=text/xml;dc_vast=4
</pre>
</div>
</div>

<div id="outline-container-orge63517f" class="outline-4">
<h4 id="orge63517f"><span class="section-number-4">33.10.5</span> Click tracker (ddm/clk)</h4>
<div class="outline-text-4" id="text-33-10-5">
<pre class="example">
https://ad.doubleclick.net/ddm/clk/[ad ID];[placement ID];[verifier]?[click-through URL]
</pre>
</div>
</div>

<div id="outline-container-orga5f0ded" class="outline-4">
<h4 id="orga5f0ded"><span class="section-number-4">33.10.6</span> Internal redirect tag</h4>
<div class="outline-text-4" id="text-33-10-6">
<p>
<a href="https://ad.doubleclick.net/ddm/ad/N1234.123456yoursite.com/B1234567.123456789;sz=320x548">https://ad.doubleclick.net/ddm/ad/N1234.123456yoursite.com/B1234567.123456789;sz=320x548</a>
</p>

<pre class="example">
# Image URL
https://ad.doubleclick.net/ddm/ad/Nxxxx.site-keyname/Byyyyyyy.n;sz=widthxheight;dc_expa=URL

# Click-through URL
https://ad.doubleclick.net/ddm/jump/Nxxxx.site-keyname/Byyyyyyy.n;sz=widthxheight
</pre>

<p>
dc_expa: Ping an encoded URL in order to track real-time expansions of rich media display expanding creatives.
</p>

<p>
Grab the attribute data-dcm-placement value from either iframe or Ins tag and also the size
</p>
<pre class="example">
https://ad.doubleclick.net/ddm/ad/[data-dcm-placement];sz=widthxheight
</pre>
</div>
</div>

<div id="outline-container-org47a19a9" class="outline-4">
<h4 id="org47a19a9"><span class="section-number-4">33.10.7</span> Ins tag</h4>
<div class="outline-text-4" id="text-33-10-7">
<p>
In DFP, always use internal redirect tag. May also deploy DCM tag as a custom creative by adding DFP macros. <a href="https://support.google.com/dfp_premium/answer/1656861?hl=en&amp;ref_topic=28160">Instructions</a>
</p>

<pre class="example">
Iframe
&lt;ins class='dcmads' style='display:inline-block;width:300px;height:250px'
    data-dcm-placement='N1234.123456yoursite.com/B1234567.123456789'
    data-dcm-rendering-mode='script'
    data-dcm-https-only
    data-dcm-resettable-device-id=''
    data-dcm-app-id=''&gt;
  &lt;script src='https://www.googletagservices.com/dcm/dcmads.js'&gt;&lt;/script&gt;
&lt;/ins&gt;

Javascript
&lt;ins class='dcmads' style='display:inline-block;width:300px;height:250px'
    data-dcm-placement='N1234.123456yoursite.com/B1234567.123456789'
    data-dcm-rendering-mode='script'
    data-dcm-https-only
    data-dcm-resettable-device-id=''
    data-dcm-app-id=''&gt;
  &lt;script src='https://www.googletagservices.com/dcm/dcmads.js'&gt;&lt;/script&gt;
&lt;/ins&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org03bae3e" class="outline-3">
<h3 id="org03bae3e"><span class="section-number-3">33.11</span> Wallpaper, Site Skin</h3>
<div class="outline-text-3" id="text-33-11">
<p>
On DFP
</p>
<pre class="example">
&lt;script type="text/javascript"&gt;
  (function() {
  'use strict';
  parent.jQuery(document).ready(function() {
  var backgroundAdwidth = 480; // TODO: find out the background image width
  var backgroundAdheight = 860; // TODO: find out the background image height
  var backgroundAdLeftImage = '%%VIEW_URL_UNESC%%%%FILE:JPG1%%';
  var backgroundAdRightImage = '%%VIEW_URL_UNESC%%%%FILE:JPG2%%';
  var backgroundAdLinkLeft = '%%CLICK_URL_UNESC%%%%DEST_URL%%';
  var backgroundAdLinkRight = backgroundAdLinkLeft;
  var backgroundAdMainContentDivWidth = 996;
  var backgroundAdExtraTopSpace = 100; // Set to 0 if you don't want extra top space
  parent.jQuery('body').prepend('&lt;div id="background-ad-right"&gt;&lt;/div&gt;&lt;div id="background-ad-left"&gt;&lt;/div&gt;');
  var jsLink1 = "&lt;script type='text/javascript'&gt;" +
  "var backgroundAdwidth = " + backgroundAdwidth + ";" +
  "var backgroundAdheight = " + backgroundAdheight +";" +
  "var backgroundAdMainContentDivWidth = " + backgroundAdMainContentDivWidth + ";" +
  "var backgroundAdExtraTopSpace = " + backgroundAdExtraTopSpace + ";" +
  "&lt;/scr" + "ipt&gt;";
  parent.jQuery('head').append(jsLink1);
  var jsLink2 = parent.jQuery("&lt;script type='text/javascript' src='http://yours.com/js/backgroundskinad.js'&gt;");
  parent.jQuery('head').append(jsLink2);
  var cssLink = parent.jQuery("&lt;link rel='stylesheet' href='http://yours.com/css/media-w1200-w992.css'&gt;");
  parent.jQuery('head').append(cssLink);
  parent.jQuery('#background-ad-left, #background-ad-right').css({
  'position': 'fixed',
  'z-index': '1',
  'cursor': 'pointer',
  'height': backgroundAdheight
  });
  parent.jQuery('#background-ad-left').css({
  'background': 'url(' + backgroundAdLeftImage + ') no-repeat right top'
  });
  parent.jQuery('#background-ad-right').css({
  'background': 'url(' + backgroundAdRightImage + ') no-repeat left top'
  });
  parent.jQuery('#background-ad-left').click(function() {
  window.open(backgroundAdLinkLeft);
  });
  parent.jQuery('#background-ad-right').click(function() {
  window.open(backgroundAdLinkRight);
  });
  });
  })();
&lt;/script&gt;
</pre>

<p>
On Web Server
backgroundskinad.js
</p>
<pre class="example">
jQuery(document).ready(function($) {
  var backgroundAdMainContentDivWidth = 996;
  var backgroundAdExtraTopSpace = 0;
  function setBackgroundAdPositionX() {
    var adPosition = new Array();
    var viewportWidth = $(window).width();
    var leftSpace = (viewportWidth-backgroundAdMainContentDivWidth)/2;
    if (leftSpace &gt; 0) {
      if (leftSpace &lt;= backgroundAdwidth) {
        adPosition['adWidthRealtime'] = leftSpace;
        adPosition['adHorizontalSpacing'] = 0;
      } else {
        adPosition['adWidthRealtime'] = backgroundAdwidth;
        adPosition['adHorizontalSpacing'] = leftSpace - backgroundAdwidth;
      }
    }
    else {
      adPosition['adWidthRealtime'] = 0;
      adPosition['adHorizontalSpacing'] = 0;
    }

    $('#background-ad-left').css({
      'left': adPosition['adHorizontalSpacing'],
      'width': adPosition['adWidthRealtime']
    });

    $('#background-ad-right').css({
      'right': adPosition['adHorizontalSpacing'],
      'width': adPosition['adWidthRealtime']
    });
    return adPosition;
  }

  function setBackgroundAdPositionY() {
    var topspace = backgroundAdExtraTopSpace - $(window).scrollTop();
    // nav HTML element height
    if ($('#newcom-header-masthead').length &amp;&amp; $('#newcom-header-masthead').height()) {
      topspace += $('#newcom-header-masthead').height();
    }
    topspace = (topspace &gt; 0) ? topspace : 0;
    $('#background-ad-left, #background-ad-right').css('top', topspace + 'px');
  }

  function wallpaperFixViewport() {
    $('.cover-slogan, .cover-logo').addClass("m-clear");
    $('#newcom-single-left').toggleClass("col-md-9 col-md-8");
    $('#newcom-single-right').toggleClass("col-md-3 col-md-4");
    $('#newcom-page-news-middle').toggleClass("col-md-7 col-md-6");
    $('#newcom-page-news-right').toggleClass("col-md-3 col-md-4");
    $('#newcom-taxonomy-videoseries-middle').toggleClass("col-md-7 col-md-6");
    $('#newcom-content-sidebar-page-left').toggleClass("col-md-9 col-md-8");
    $('#newcom-content-sidebar-page-right').toggleClass("col-md-3 col-md-4");
    $('#newcom-page-middle').toggleClass("col-md-7 col-md-6");
    $('#newcom-page-right').toggleClass("col-md-3 col-md-4");
    $('#newcom-search-middle').toggleClass("col-md-7 col-md-6");
    $('#newcom-search-right').toggleClass("col-md-3 col-md-4");

    $('div.row div.col-md-8 div.row div.col-md-3 div.well').toggleClass("pa-sm");

    $('#div-gpt-placeholder-1, #div-gpt-placeholder-2').toggleClass('center-block');

    // Enlarge column of a parent if it has a child
    var videoDiv = $( "#yourspecialchild" ).parent( ".the-content" ).parent( ".col-md-9" );
    if (videoDiv.length) {
      videoDiv.toggleClass("col-md-9 col-md-12");
      // Move
      var titleDiv = videoDiv.prev();
      if (titleDiv.length) {
        titleDiv.toggleClass("col-md-3 col-md-12");
        titleDiv.insertAfter(videoDiv);
      }
    }

  }

  function setBackgroundMobile() {
    if (typeof backgroundAdMobile300x90 !== 'undefined' &amp;&amp; backgroundAdMobile300x90) {
      var ad = jQuery('&lt;a href="' + backgroundAdLink +'" target="_blank"&gt;&lt;/a&gt;').append(jQuery('&lt;img /&gt;',{
        width: 300,
        height: 90,
        src: backgroundAdMobile300x90
      }));

      if (jQuery("#background-ad-mobile").length) {
        jQuery("#background-ad-mobile").append(ad);
      }
      else {
        var subpages = '#wrapper div.row div.col-md-8';
        if (jQuery(subpages).length) {
          var html = jQuery('&lt;div id="background-ad-mobile"&gt;&lt;/div&gt;').append(ad);
          jQuery(subpages).first().prepend(html);
        }
      }
    }
  }

  $(window).load(function() {
    wallpaperFixViewport();
//  setBackgroundMobile();
    setBackgroundAdPositionX();
    setBackgroundAdPositionY();
    $("#div-gpt-placeholder-0-oop").hide();
  });

  $(window).resize(function() {setBackgroundAdPositionX();});
  $(window).scroll(function() {setBackgroundAdPositionY();});

});
</pre>

<p>
media-w1200-w992.css
</p>
<pre class="example">
@media (min-width:1200px){
  .col-lg-1, .col-lg-2, .col-lg-3, .col-lg-4, .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8, .col-lg-9, .col-lg-10, .col-lg-11, .col-lg-12{
    width:auto;
    float:none;
  }

  .container{
    width:990px
  }

  .col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6, .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11{
    float:left
  }

  .col-md-12{
    width:100%
  }

  .col-md-11{
    width:91.66666666666666%
  }

  .col-md-10{
    width:83.33333333333334%
  }

  .col-md-9{
    width:75%
  }

  .col-md-8{
    width:66.66666666666666%
  }

  .col-md-7{
    width:58.333333333333336%
  }

  .col-md-6{
    width:50%
  }

  .col-md-5{
    width:41.66666666666667%
  }

  .col-md-4{
    width:33.33333333333333%
  }

  .col-md-3{
    width:25%
  }

  .col-md-2{
    width:16.666666666666664%
  }

  .col-md-1{
    width:8.333333333333332%
  }

  .col-md-pull-12{
    right:100%
  }

  .col-md-pull-11{
    right:91.66666666666666%
  }

  .col-md-pull-10{
    right:83.33333333333334%
  }

  .col-md-pull-9{
    right:75%
  }

  .col-md-pull-8{
    right:66.66666666666666%
  }

  .col-md-pull-7{
    right:58.333333333333336%
  }

  .col-md-pull-6{
    right:50%
  }

  .col-md-pull-5{
    right:41.66666666666667%
  }

  .col-md-pull-4{
    right:33.33333333333333%
  }

  .col-md-pull-3{
    right:25%
  }

  .col-md-pull-2{
    right:16.666666666666664%
  }

  .col-md-pull-1{
    right:8.333333333333332%
  }

  .col-md-push-12{
    left:100%
  }

  .col-md-push-11{
    left:91.66666666666666%
  }

  .col-md-push-10{
    left:83.33333333333334%
  }

  .col-md-push-9{
    left:75%
  }

  .col-md-push-8{
    left:66.66666666666666%
  }

  .col-md-push-7{
    left:58.333333333333336%
  }

  .col-md-push-6{
    left:50%
  }

  .col-md-push-5{
    left:41.66666666666667%
  }

  .col-md-push-4{
    left:33.33333333333333%
  }

  .col-md-push-3{
    left:25%
  }

  .col-md-push-2{
    left:16.666666666666664%
  }

  .col-md-push-1{
    left:8.333333333333332%
  }

  .col-md-offset-12{
    margin-left:100%
  }

  .col-md-offset-11{
    margin-left:91.66666666666666%
  }

  .col-md-offset-10{
    margin-left:83.33333333333334%
  }

  .col-md-offset-9{
    margin-left:75%
  }

  .col-md-offset-8{
    margin-left:66.66666666666666%
  }

  .col-md-offset-7{
    margin-left:58.333333333333336%
  }

  .col-md-offset-6{
    margin-left:50%
  }

  .col-md-offset-5{
    margin-left:41.66666666666667%
  }

  .col-md-offset-4{
    margin-left:33.33333333333333%
  }

  .col-md-offset-3{
    margin-left:25%
  }

  .col-md-offset-2{
    margin-left:16.666666666666664%
  }

  .col-md-offset-1{
    margin-left:8.333333333333332%
  }
}
</pre>
</div>
</div>

<div id="outline-container-orgf75dc5c" class="outline-3">
<h3 id="orgf75dc5c"><span class="section-number-3">33.12</span> Interstitial Ad</h3>
<div class="outline-text-3" id="text-33-12">
<p>
Load third party code into 1x1 floating ad unit. Insert DFP macro as a third party code first. Refer to <a href="#org9643b1c">dfp:third party code</a>
</p>

<pre class="example">
// Outside of the div
var dfpSlots = {}; // non single request mode

googletag.cmd.push(function() {
 // non single request mode
 dfpSlots.floating = googletag.defineOutOfPageSlot('/123456/floating', 'interstitial').addService(googletag.pubads()); 

 // single request mode
 // googletag.defineOutOfPageSlot('/123456/floating', 'interstitial').addService(googletag.pubads());

 googletag.pubads().addEventListener('slotRenderEnded', function (event) {
   if (event.slot.getAdUnitPath() === '/123456/floating') {
     document.getElementById('interstitial').style.display = 'none';
   }
 });

});

&lt;div id='interstitial'&gt;
  &lt;script type='text/javascript'&gt;
    googletag.cmd.push(function() { googletag.display('interstitial'); });
  &lt;/script&gt;
&lt;/div&gt;
</pre>

<p>
On DFP, Custom Code :: postMessage to website to create jQuery UI dialog and later receives a message to create content inside the iframe
</p>
<pre class="example">
&lt;script type="text/javascript"&gt;
  (function() {
    'use strict';
    var temp = '%%VIEW_URL_UNESC%%'; // Custom Code requires VIEW_URL_UNESC or VIEW_URL_ESC macro..
    window.onload = function() {
      function receiveMessage(e) {
        if (e.data == 'load_interstitial_ad') {
          var html = '&lt;div style="width:640px;height:480px;"&gt;' +
              '&lt;script src="insert third party code"'+'&gt;'+'&lt;/'+'script&gt;'+
              '&lt;noscript&gt;' +
              '&lt;a href="insert_third_party_code" target="_blank"&gt;&lt;img src="insert_third_party_code" border=0 width=640 height=480&gt;&lt;/a&gt;'+
              '&lt;/noscript&gt;'+ 
            '&lt;/div&gt;';
          document.write(html);
        }
      }
      window.addEventListener('message', receiveMessage);
      var sendData = {action:"dfp_load_interstitial_ad", width:"640", height:"480"};
      parent.postMessage(sendData,'*');
    }
  })();
&lt;/script&gt;
</pre>

<p>
On website :: once received message from iframe, load internal script and only load it once
</p>
<pre class="example">
var dfpInterstitial = {};
dfpInterstitial.loadCount=0;

function newcomReceiveMessage(e) {
  if (e.data == 'dfp_load_interstitial_ad' &amp;&amp; dfpInterstitial.loadCount == 0) {
    dfpInterstitial.loadCount++;
    dfpInterstitial.width =e.data.width;
    dfpInterstitial.height =e.data.height;
    // var cssLink = parent.jQuery("&lt;link rel='stylesheet' href='https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/themes/ui-lightness/jquery-ui.css'&gt;");
    // jQuery('head').append(cssLink);

    ['//ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/themes/ui-darkness/jquery-ui.css',
     '/wp-content/themes/xxx/css/interstitial.css'].forEach(function (src) {
      var _css = document.createElement("link");
      _css.rel = 'stylesheet';
      _css.type = 'text/css';
      _css.href = src;
      document.head.appendChild(_css);
    });

    [ 'https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js','/sites/all/themes/abc/js/interstitial.js'
    ].forEach(function(src) {
      var script = document.createElement('script');
      script.src = src;
      script.async = false;
      document.head.appendChild(script);
    });
    // var jsLink = jQuery("&lt;script type='text/javascript' src='http://yourwebsite.io/interstitial.js'&gt;");
    // jQuery('head').append(jsLink);
  }
}
window.addEventListener('message', newcomReceiveMessage, false);
</pre>

<p>
On website, interstitial.js :: make ad unit div as a dialog using jQuery UI. <a href="#orgf498fd3">jqueryui:dialog</a>
jQuery UI Dialog runs script inside the container twice. The script is setup in DFP which only posts or receives message.
Even though the same message is posted twice but the dfpInterstitialCount ensures this javascript only runs once.
</p>
<pre class="example">
jQuery(function(){
  var targetDialog = '#interstitial'; // TODO
  var iframeId = jQuery(targetDialog).find('iframe').get(0).id;
  var adWidth = dfpInterstitial.width;
  var adHeight = dfpInterstitial.height;

  jQuery(targetDialog).dialog({
    width: 'auto',
    height: 'auto',
    resizable: false,
    draggable: false,
    closeOnEscape: true,
    modal: true,
    create: function (event, ui) {
      jQuery("#ui-dialog-title-dialog").hide();
      jQuery(".ui-widget-content").css({"background-color":"transparent","background":"transparent","border":"none"});
      jQuery(".ui-dialog-titlebar").css({"background-color":"transparent","background":"transparent","border":"none"});
      jQuery(".ui-dialog-titlebar").removeClass('ui-widget-header');

      // In Single Request Mode, every time .display() is called, the div will refilled with new ad
      // In Non-Single-request mode, you need to do .refresh(). 
      if (typeof dfpSlots !== "undefined" &amp;&amp; typeof dfpSlots.floating !== "undefined") {
        googletag.cmd.push(function() {
          googletag.pubads().refresh([dfpSlots.floating]);
        });
      }
      jQuery(targetDialog).find('iframe').width(adWidth);
      jQuery(targetDialog).find('iframe').height(adHeight);
    },
    open: function() {
      jQuery('.ui-widget-overlay').addClass('custom-overlay');
      jQuery(this).closest(".ui-dialog")
        .find(".ui-dialog-titlebar-close")
        .removeClass("ui-dialog-titlebar-close")
        .html("&lt;span class='ui-button-icon-primary ui-icon ui-icon-closethick'&gt;&lt;/span&gt;");
      jQuery(".ui-dialog-titlebar button").css({"border":"none"});
      jQuery('.ui-widget-overlay').bind('click',function(){
        jQuery(targetDialog).dialog('close');
      })
    },
    close: function() {
      jQuery('.ui-widget-overlay').removeClass('custom-overlay');
    }
  });

  setTimeout(function () {
    jQuery(targetDialog).show();
    var receiver = document.getElementById(iframeId).contentWindow;
    receiver.postMessage('load_interstitial_ad', '*');
  }, 3000);

});
</pre>

<p>
/wp-content/themes/xxx/css/interstitial.css
</p>
<pre class="example">
.ui-widget-overlay.custom-overlay {
  background-color: black;
  background-image: none;
  opacity: 0.7;
}
</pre>

<p>
Interstitial as JW Player is a bit complicated. <a href="https://gist.github.com/levonlee/1e162c34af377d04364295d027a33c96">Gist</a>
</p>
</div>
</div>

<div id="outline-container-orgbc3c12e" class="outline-3">
<h3 id="orgbc3c12e"><span class="section-number-3">33.13</span> Pre-roll or Linear Video Ad</h3>
<div class="outline-text-3" id="text-33-13">
<ul class="org-ul">
<li>The ad unit should have a Video (VAST) size: 640x360v</li>
<li>In the line item, select the same video size as the inventory size and also select the ad unit</li>
<li>Add a new Creative Set and select Linear then Video (not VPAID) for pre-roll, mid-roll or post-roll.</li>
<li>Upload the video file that a higher resolution e.g. 1920x1080. DFP will create all lower resolution videos.</li>
<li>Your video creative is setup. You need to generate the tag for the ad unit.</li>
<li>Use <a href="https://developers.google.com/interactive-media-ads/docs/sdks/html5/vastinspector">Video Suite Inspector</a> to test the video ad. If the ad unit is newly created, it could take an hour to preview the video ad..</li>
<li>Delivery &gt; Troubleshoot &gt; Video simulates the request taking under/over delivery into account.</li>
</ul>

<p>
DFP Video Tag
</p>
<pre class="example">
https://pubads.g.doubleclick.net/gampad/ads?sz=640x360&amp;iu=/{network_id}/{VAST_code_name}&amp;ciu_szs=640x90&amp;impl=s&amp;gdfp_req=1&amp;env=vp&amp;output=xml_vast2&amp;unviewed_position_start=1&amp;url=[referrer_url]&amp;description_url=[description_url]&amp;correlator=[timestamp]
</pre>

<p>
In the tag, use JW Player Targeting Macros to add values into these url parameters:
The url of the page where the ad will appear
`&amp;url=__page-url__`
`&amp;correlator=__timestamp__`
`&amp;description_url=__referrer__`
</p>

<p>
e.g. DFP tag in JW is
</p>
<pre class="example">
https://pubads.g.doubleclick.net/gampad/ads?sz=640x360&amp;iu=/{network_id}/{VAST_code_name}&amp;ciu_szs=640x90&amp;impl=s&amp;gdfp_req=1&amp;env=vp&amp;output=xml_vast2&amp;unviewed_position_start=1&amp;url=__page-url__&amp;description_url=__referrer__&amp;correlator=__timestamp__
</pre>

<p>
In JW, specify the div id which the companion ad will be in and on the website:
</p>
<pre class="example">
&lt;div id="newcomjwplayerbanner" style="width:640px;height:90px;margin-bottom: 10px;"&gt;&lt;/div&gt;
&lt;div id="newcomjwplayer"&gt;
  &lt;script type="application/javascript" src="//content.jwplatform.com/players/{video_id}-{player_id}.js"&gt;&lt;/script&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-orge5d4683" class="outline-3">
<h3 id="orge5d4683"><span class="section-number-3">33.14</span> Native Ad, Native Styles, Custom Rendering</h3>
<div class="outline-text-3" id="text-33-14">
<p>
Custom Rendering can only be used in mobile apps.
</p>

<p>
Create a native ad format under Delivery &gt; Creatives &gt; Native Styles
Associate this native format with an ad unit. A native format is basically a HTML/CSS template with some placeholders
which can be later defined when you upload a creative of Native type to a line item.
Create a line item with Inventory sizes = Standard and Native format, and target the ad unit.
Upload a creative of Native type. Specify the placeholders.
</p>
</div>
</div>

<div id="outline-container-orgee323bd" class="outline-3">
<h3 id="orgee323bd"><span class="section-number-3">33.15</span> SafeFrame API</h3>
<div class="outline-text-3" id="text-33-15">
<p>
Custom creative
</p>
<pre class="example">
&lt;div id="container"&gt;
    &lt;script&gt;
      function updateInViewPercentage() {
         var text = $sf.ext.inViewPercentage() + '%';
         document.getElementById('percentage').innerHTML = text;
      }

      $sf.ext.register(728, 90, function(status, data) {
        // 728,90 are inital size of the creative
        // register is needed for calling other $sf.ext.xxx
        // Do nothing. This test doesn't make use of this callback.
      });

      return false;
    };
    &lt;/script&gt;
    &lt;span&gt;
        &lt;strong&gt;$sf.ext.inViewPercentage&lt;/strong&gt;
    &lt;/span&gt;
    &lt;button onclick="updateInViewPercentage();"&gt;In view pecentage&lt;/button&gt;
    &lt;div id="percentage"&gt;&lt;/div&gt;
&lt;/div&gt;
</pre>

<p>
Preview creative doesn't enable SafeFrame. The creative has to be deployed.
When console shows FriendlyFrame, it shows the container is not SafeFrame.
</p>

<p>
<a href="https://support.google.com/dfp_premium/answer/6023110">Other SafeFrame methods</a>
</p>
</div>
</div>

<div id="outline-container-org90c1c27" class="outline-3">
<h3 id="org90c1c27"><span class="section-number-3">33.16</span> Events</h3>
<div class="outline-text-3" id="text-33-16">
<div class="org-src-container">
<pre class="src src-js">googletag.pubads().addEventListener(<span style="color: #e67128;">'slotRenderEnded'</span>, <span style="color: #ffad29; font-weight: bold;">function</span> (<span style="color: #dbdb95;">event</span>) {
  <span style="color: #ffad29; font-weight: bold;">if</span> (event.slot.getAdUnitPath() === <span style="color: #e67128;">'/123456/adunit_name'</span>) {
    document.getElementById(<span style="color: #e67128;">'div-gpt-ad-1403025754774-0-oop'</span>).style.display = <span style="color: #e67128;">'none'</span>;
  }
});
</pre>
</div>
</div>
</div>

<div id="outline-container-org05f7102" class="outline-3">
<h3 id="org05f7102"><span class="section-number-3">33.17</span> Google Publisher Console</h3>
<div class="outline-text-3" id="text-33-17">
<p>
To open, append to URL ?googfc=1 (display console after page is loaded)
or ?google_console (keyboard to toggle console display)
C-F10
</p>

<p>
Or make a bookmark <code>javascript: googletag.openConsole();</code>
</p>
</div>
</div>

<div id="outline-container-org7786f97" class="outline-3">
<h3 id="org7786f97"><span class="section-number-3">33.18</span> Passback tag</h3>
<div class="outline-text-3" id="text-33-18">
<p>
Situation 1
</p>
<ol class="org-ol">
<li>The webpage makes a call to the DFP ad server using the DFP ad tag</li>
<li>DFP ad server returns an ad containing a third-party ad tag</li>
<li>Third-party ad tag calls the third-party ad server for an ad</li>
<li>Third-party ad server doesn't have an eligible ad, so returns a passback ad tag</li>
<li>Passback ad tag makes a call to DFP to serve an ad matching the specified targeting criteria</li>
<li>DFP server returns an ad that matches the passback ad tag targeting criteria</li>
</ol>

<p>
Situation 2
</p>
<ol class="org-ol">
<li>Passback ad tag makes a call to DFP to serve an ad matching the specified targeting criteria</li>
<li>DFP server returns an ad that matches the passback ad tag targeting criteria</li>
</ol>
</div>
</div>

<div id="outline-container-org28d5490" class="outline-3">
<h3 id="org28d5490"><span class="section-number-3">33.19</span> Downloaded impression</h3>
<div class="outline-text-3" id="text-33-19">
<p>
DFP provides a System Query called Downloaded Impressions to compare with the old impression counting
</p>

<p>
Ad server impressions and Impressions are the old impression counting
Ad server downloaded impressions are the new impression counting
</p>

<p>
Also now a new metric called Request Type to divide:
</p>
<ul class="org-ul">
<li>Goolge Publisher Tag</li>
<li>Video Tag</li>
<li>GPT Simple URL</li>
<li>GPT Light</li>
<li>Amp Ad Tag</li>
</ul>

<p>
For Simple URL Tags, used in email, which do not allow javascript
</p>
<ul class="org-ul">
<li>Use <code>ad</code> request type to get the image with <code>&amp;d_imp=1&amp;d_imp_hdr=1</code> appended</li>
<li>Use <code>adx</code> request type to get the URL from http header <code>google-delayed-impression</code> or <code>google-3rdparty-delayed-impression</code>
with <code>&amp;d_imp=1&amp;d_imp_hdr=1</code> appended in the <code>adx</code> request</li>
<li>Ping the URL</li>
<li>Return or output the image as raw</li>
</ul>

<p>
Notes
</p>
<ul class="org-ul">
<li><code>&amp;d_imp=1&amp;d_imp_hdr=1</code> does not return downloaded impression tracking link from <code>ad</code> request</li>
<li><code>adx</code> does not return a useful <code>img src</code> because its response is supposed to put into iframe where javascript is used</li>
</ul>

<p>
Wordpress Gist
<a href="https://gist.github.com/levonlee/888f5f5b0a33acebe2b20ecbbff3b106">https://gist.github.com/levonlee/888f5f5b0a33acebe2b20ecbbff3b106</a>
</p>
</div>
</div>

<div id="outline-container-org793a1d8" class="outline-3">
<h3 id="org793a1d8"><span class="section-number-3">33.20</span> Anti Adblocke</h3>
<div class="outline-text-3" id="text-33-20">
<p>
<a href="https://gist.github.com/levonlee/da658dd8d6c91f093fc90aeca4653ae7">https://gist.github.com/levonlee/da658dd8d6c91f093fc90aeca4653ae7</a>
</p>
</div>
</div>

<div id="outline-container-orgd4fd7c4" class="outline-3">
<h3 id="orgd4fd7c4"><span class="section-number-3">33.21</span> Benchmarks</h3>
<div class="outline-text-3" id="text-33-21">
<p>
Sizmek Benchmarks
Based on 2016 H1 report, CTR (click-through rate = clicks / impressions) is around 0.14% in North America and South Asia is the highest 0.28% for standard banner.
</p>

<p>
Rich Media CTR is around from 6 to 8 times higher than standard banner.
</p>

<p>
Programmatic Rich Media that is not confined to the iFrame performs around 145% better than polite.
</p>

<p>
Doubleclick Insights
<a href="https://www.doubleclickbygoogle.com/insights/">https://www.doubleclickbygoogle.com/insights/</a>
</p>

<p>
LiveIntent, AdButler, PowerInbox
</p>
</div>
</div>
</div>

<div id="outline-container-org39993d0" class="outline-2">
<h2 id="org39993d0"><span class="section-number-2">34</span> XML</h2>
<div class="outline-text-2" id="text-34">
</div>
<div id="outline-container-orgd5f2c2e" class="outline-3">
<h3 id="orgd5f2c2e"><span class="section-number-3">34.1</span> XML DOM</h3>
<div class="outline-text-3" id="text-34-1">
<p>
Everything is a node
nodeType :: 1 - element, 2 - attribute, 3 - text, 4 - comment, 5 - document
nodeName :: read-only, text node name is #text, document node name is #document
nodeValue :: element node value is undefined
</p>

<p>
var elements = xmlDoc.getElementByTagName("title");
console.log(elements.length);
var element = elements[0];
var elementToRemove = xmlDoc.getElementsByTagName('book')[0];
xmlDoc.documentElement.removeChild(y);
element.<a href="#org01d485a">parentNode</a>.removeChild(element); // remove myself
</p>

<p>
xde = xmlDoc.documentElement; 
newNode = xmlDoc.createElement('book'); // create element node
newTitle = xmlDoc.createElement('title');
newText = xmlDoc.createTextNode('A Notebook'); <i>/ create text node
newTitle.<a href="#org25654c8">appendChild</a>(newText); /</i> add text node to element node
newNode.<a href="#org25654c8">appendChild</a>(newTitle); // add element node to element node
</p>

<p>
y = xmlDoc.getElementsByTagName('book')[0];
xde.replaceChild(newNode, y); <i>/ replace an element node
aTextNode.replaceData(0,8,"Easy"); /</i> replace data of text node (from start to 8 in length)
// Use nodeValue, it's easier
</p>

<p>
var attributes = element.attributes;
var attribute = element.getAttribute('lang');
var attributeNode = element.getAttributeNode('lang');
attributeNode.nodeValue;
attributeNode.nodeValue = "new attribute value";
element.setAttribute('category', 'food');
</p>

<p>
element.removeAttributeNode(attributeNode); <i>/ remove an attribute node
element.removeChild("category"); /</i> remove an attribute node by name
// remove multiple attribute nodes, you will have to loop all
</p>

<p>
var x = element.childNodes[0].nodeName;
</p>
</div>

<div id="outline-container-org2f494bd" class="outline-4">
<h4 id="org2f494bd"><span class="section-number-4">34.1.1</span> Navigate</h4>
<div class="outline-text-4" id="text-34-1-1">
<p>
var fc = element.firstChild;
var lc = element.lastChild;
fc.<a href="#org01d485a">parentNode</a>;
var nc = fc.nextSibling;
nc.previousSibling;
</p>

<p>
function get_nextSibling(n) {
 // Bypass empty text node while traversing
 var y = n.nextSibling;
 while (y.nodeType != 1) {
  y = y.nextSibling;
 }
 return y;
}
</p>
</div>
</div>
</div>

<div id="outline-container-org0d46168" class="outline-3">
<h3 id="org0d46168"><span class="section-number-3">34.2</span> Do not parse &lt; and &amp;</h3>
<div class="outline-text-3" id="text-34-2">
<pre class="example">
&lt;![CDATA
]]&gt;
</pre>
</div>
</div>

<div id="outline-container-orgae62668" class="outline-3">
<h3 id="orgae62668"><span class="section-number-3">34.3</span> Comment</h3>
<div class="outline-text-3" id="text-34-3">
<div class="org-src-container">
<pre class="src src-xml"><span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">Same as HTML but double -- is not allowed </span><span style="color: #74af68;">--&gt;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org77f7634" class="outline-3">
<h3 id="org77f7634"><span class="section-number-3">34.4</span> XML newline is always LF</h3>
</div>
<div id="outline-container-org351a401" class="outline-3">
<h3 id="org351a401"><span class="section-number-3">34.5</span> XML Element node name can contain -, _ and . but not space</h3>
</div>
<div id="outline-container-org78c8238" class="outline-3">
<h3 id="org78c8238"><span class="section-number-3">34.6</span> Attribute value should be HTML entity encoded</h3>
<div class="outline-text-3" id="text-34-6">
<p>
Mainly enocde the double quotes " to &amp;quot;
&gt; &amp;gt;
&lt; &amp;lt;
</p>
</div>
</div>

<div id="outline-container-org97e9431" class="outline-3">
<h3 id="org97e9431"><span class="section-number-3">34.7</span> <a id="orgbeb11ba">XML namespace</a></h3>
<div class="outline-text-3" id="text-34-7">
<div class="org-src-container">
<pre class="src src-xml">&lt;<span style="color: #00ede1; font-weight: bold;">root</span> 
<span style="color: #23d7d7;">xmlns</span>:<span style="color: #dbdb95;">h</span>=<span style="color: #e67128;">"http://www.w3.org/TR/html4/"</span>
<span style="color: #23d7d7;">xmlns</span>:<span style="color: #dbdb95;">f</span>=<span style="color: #e67128;">"http://www.w3schools.com/furniture"</span>&gt;

&lt;<span style="color: #23d7d7;">h</span>:<span style="color: #00ede1; font-weight: bold;">table</span>&gt;
  &lt;<span style="color: #23d7d7;">h</span>:<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
    &lt;<span style="color: #23d7d7;">h</span>:<span style="color: #00ede1; font-weight: bold;">td</span>&gt;Apples&lt;/<span style="color: #23d7d7;">h</span>:<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
    &lt;<span style="color: #23d7d7;">h</span>:<span style="color: #00ede1; font-weight: bold;">td</span>&gt;Bananas&lt;/<span style="color: #23d7d7;">h</span>:<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
  &lt;/<span style="color: #23d7d7;">h</span>:<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
&lt;/<span style="color: #23d7d7;">h</span>:<span style="color: #00ede1; font-weight: bold;">table</span>&gt;

&lt;<span style="color: #23d7d7;">f</span>:<span style="color: #00ede1; font-weight: bold;">table</span>&gt;
  &lt;<span style="color: #23d7d7;">f</span>:<span style="color: #00ede1; font-weight: bold;">name</span>&gt;African Coffee Table&lt;/<span style="color: #23d7d7;">f</span>:<span style="color: #00ede1; font-weight: bold;">name</span>&gt;
  &lt;<span style="color: #23d7d7;">f</span>:<span style="color: #00ede1; font-weight: bold;">width</span>&gt;80&lt;/<span style="color: #23d7d7;">f</span>:<span style="color: #00ede1; font-weight: bold;">width</span>&gt;
  &lt;<span style="color: #23d7d7;">f</span>:<span style="color: #00ede1; font-weight: bold;">length</span>&gt;120&lt;/<span style="color: #23d7d7;">f</span>:<span style="color: #00ede1; font-weight: bold;">length</span>&gt;
&lt;/<span style="color: #23d7d7;">f</span>:<span style="color: #00ede1; font-weight: bold;">table</span>&gt;

&lt;/<span style="color: #00ede1; font-weight: bold;">root</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org761554e" class="outline-3">
<h3 id="org761554e"><span class="section-number-3">34.8</span> XSLT</h3>
<div class="outline-text-3" id="text-34-8">
<p>
XSLT stands for XSL (Extensible Stylesheet Language) Transformations
XSLT uses <a href="#orgc0cbc97">XPath</a> to navigate through elements.
</p>

<p>
XSLT code
</p>
<div class="org-src-container">
<pre class="src src-xml"><span style="color: #e67128;">&lt;?</span><span style="color: #ffad29; font-weight: bold;">xml</span><span style="color: #e67128;"> </span><span style="color: #e67128;">version="1.0" encoding="UTF-8"</span><span style="color: #e67128;">?&gt;</span>
&lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">stylesheet</span> <span style="color: #dbdb95;">version</span>=<span style="color: #e67128;">"1.0"</span> <span style="color: #23d7d7;">xmlns</span>:<span style="color: #dbdb95;">xsl</span>=<span style="color: #e67128;">"http://www.w3.org/1999/XSL/Transform"</span>&gt;
&lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">template</span> <span style="color: #dbdb95;">match</span>=<span style="color: #e67128;">"/"</span>&gt;
<span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">Associate the template with the root of the XML source document </span><span style="color: #74af68;">--&gt;</span>
<span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">A template contains rules to apply when a specified node is match </span><span style="color: #74af68;">--&gt;</span>
  &lt;<span style="color: #00ede1; font-weight: bold;">h2</span>&gt;My CD Collection&lt;/<span style="color: #00ede1; font-weight: bold;">h2</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">table</span> <span style="color: #dbdb95;">border</span>=<span style="color: #e67128;">"1"</span>&gt;
      &lt;<span style="color: #00ede1; font-weight: bold;">tr</span> <span style="color: #dbdb95;">bgcolor</span>=<span style="color: #e67128;">"#9acd32"</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">th</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"text-align:left"</span>&gt;Title&lt;/<span style="color: #00ede1; font-weight: bold;">th</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">th</span> <span style="color: #dbdb95;">style</span>=<span style="color: #e67128;">"text-align:left"</span>&gt;Artist&lt;/<span style="color: #00ede1; font-weight: bold;">th</span>&gt;
      &lt;/<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
      &lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">for-each</span> <span style="color: #dbdb95;">select</span>=<span style="color: #e67128;">"catalog/cd"</span>&gt;
<span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">for-each loop, select contains XPath expression </span><span style="color: #74af68;">--&gt;</span>
<span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">select="catelog/cd[artist='Bob Dylan']" </span><span style="color: #74af68;">--&gt;</span>
<span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">=, !-, &amp;lt;, &amp;gt; </span><span style="color: #74af68;">--&gt;</span>
     &lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">sort</span> <span style="color: #dbdb95;">select</span>=<span style="color: #e67128;">"artist"</span> /&gt;
<span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">sort </span><span style="color: #74af68;">--&gt;</span>
      &lt;<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">td</span>&gt;&lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">value-of</span> <span style="color: #dbdb95;">select</span>=<span style="color: #e67128;">"title"</span>/&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">td</span>&gt;&lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">value-of</span> <span style="color: #dbdb95;">select</span>=<span style="color: #e67128;">"artist"</span>/&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
        &lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">if</span> <span style="color: #dbdb95;">test</span>=<span style="color: #e67128;">"price </span><span style="color: #008b8b;">&amp;</span><span style="color: #008b8b;">gt</span><span style="color: #008b8b;">;</span><span style="color: #e67128;"> 10"</span>&gt;
        &lt;<span style="color: #00ede1; font-weight: bold;">td</span>&gt;&lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">value-of</span> <span style="color: #dbdb95;">select</span>=<span style="color: #e67128;">"price"</span>/&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
        &lt;/<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">if</span>&gt;
<span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">choose, when, otherwise </span><span style="color: #74af68;">--&gt;</span>
       &lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">choose</span>&gt;
        &lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">when</span> <span style="color: #dbdb95;">test</span>=<span style="color: #e67128;">"price </span><span style="color: #008b8b;">&amp;</span><span style="color: #008b8b;">lt</span><span style="color: #008b8b;">;</span><span style="color: #e67128;"> 10"</span>&gt;
         &lt;<span style="color: #00ede1; font-weight: bold;">td</span> <span style="color: #dbdb95;">bgcolor</span>=<span style="color: #e67128;">""</span>&gt;&lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">value-of</span> <span style="color: #dbdb95;">select</span>=<span style="color: #e67128;">"price"</span>/&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
        &lt;/<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">when</span>&gt;
        <span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">Multiple when's </span><span style="color: #74af68;">--&gt;</span>
        &lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">otherwise</span>&gt;
         &lt;<span style="color: #00ede1; font-weight: bold;">td</span>&gt;&lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">value-of</span> <span style="color: #dbdb95;">select</span>=<span style="color: #e67128;">"price"</span>/&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">td</span>&gt;
        &lt;/<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">otherwise</span>&gt;
       &lt;/<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">choose</span>&gt;
<span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">choose, when, otherwise. </span><span style="color: #74af68;">--&gt;</span>
      &lt;/<span style="color: #00ede1; font-weight: bold;">tr</span>&gt;
      &lt;/<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">for-each</span>&gt;
<span style="color: #74af68;">&lt;!-- </span><span style="color: #74af68;">Close a loop </span><span style="color: #74af68;">--&gt;</span>
    &lt;/<span style="color: #00ede1; font-weight: bold;">table</span>&gt;
&lt;/<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">template</span>&gt;
&lt;/<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">stylesheet</span>&gt;
</pre>
</div>

<p>
XML file
</p>
<div class="org-src-container">
<pre class="src src-xml"><span style="color: #e67128;">&lt;?</span><span style="color: #ffad29; font-weight: bold;">xml</span><span style="color: #e67128;"> </span><span style="color: #e67128;">version="1.0" encoding="UTF-8"</span><span style="color: #e67128;">?&gt;</span>
&lt;<span style="color: #00ede1; font-weight: bold;">catalog</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">cd</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">title</span>&gt;Empire Burlesque&lt;/<span style="color: #00ede1; font-weight: bold;">title</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">artist</span>&gt;Bob Dylan&lt;/<span style="color: #00ede1; font-weight: bold;">artist</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">country</span>&gt;USA&lt;/<span style="color: #00ede1; font-weight: bold;">country</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">company</span>&gt;Columbia&lt;/<span style="color: #00ede1; font-weight: bold;">company</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">price</span>&gt;10.90&lt;/<span style="color: #00ede1; font-weight: bold;">price</span>&gt;
    &lt;<span style="color: #00ede1; font-weight: bold;">year</span>&gt;1985&lt;/<span style="color: #00ede1; font-weight: bold;">year</span>&gt;
  &lt;/<span style="color: #00ede1; font-weight: bold;">cd</span>&gt;
  &lt;<span style="color: #00ede1; font-weight: bold;">cd</span>&gt;...&lt;/<span style="color: #00ede1; font-weight: bold;">cd</span>&gt;
  ...
&lt;/<span style="color: #00ede1; font-weight: bold;">catalog</span>&gt;
</pre>
</div>

<p>
Template and subtemplates
</p>
<div class="org-src-container">
<pre class="src src-xml"><span style="color: #e67128;">&lt;?</span><span style="color: #ffad29; font-weight: bold;">xml</span><span style="color: #e67128;"> </span><span style="color: #e67128;">version="1.0" encoding="UTF-8"</span><span style="color: #e67128;">?&gt;</span>
&lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">stylesheet</span> <span style="color: #dbdb95;">version</span>=<span style="color: #e67128;">"1.0"</span> <span style="color: #23d7d7;">xmlns</span>:<span style="color: #dbdb95;">xsl</span>=<span style="color: #e67128;">"http://www.w3.org/1999/XSL/Transform"</span>&gt;
&lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">template</span> <span style="color: #dbdb95;">match</span>=<span style="color: #e67128;">"/"</span>&gt;
 &lt;<span style="color: #00ede1; font-weight: bold;">html</span>&gt;
 &lt;<span style="color: #00ede1; font-weight: bold;">body</span>&gt;
  &lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">apply-templates</span>/&gt;
 &lt;/<span style="color: #00ede1; font-weight: bold;">body</span>&gt;
 &lt;/<span style="color: #00ede1; font-weight: bold;">html</span>&gt;
&lt;/<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">template</span>&gt;

&lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">template</span> <span style="color: #dbdb95;">match</span>=<span style="color: #e67128;">"cd"</span>&gt;
 &lt;<span style="color: #00ede1; font-weight: bold;">p</span>&gt;
 &lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">apply-templates</span> <span style="color: #dbdb95;">select</span>=<span style="color: #e67128;">"title"</span>/&gt;
 &lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">apply-templates</span> <span style="color: #dbdb95;">select</span>=<span style="color: #e67128;">"artist"</span>/&gt;
 &lt;/<span style="color: #00ede1; font-weight: bold;">p</span>&gt;
&lt;/<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">template</span>&gt;

&lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">template</span> <span style="color: #dbdb95;">match</span>=<span style="color: #e67128;">"title"</span>&gt;
 Title: &lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">value-of</span> <span style="color: #dbdb95;">select</span>=<span style="color: #e67128;">"."</span>/&gt;
 &lt;<span style="color: #00ede1; font-weight: bold;">br</span> /&gt;
&lt;/<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">template</span>&gt;

&lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">template</span> <span style="color: #dbdb95;">match</span>=<span style="color: #e67128;">"title"</span>&gt;
 Artist: &lt;<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">value-of</span> <span style="color: #dbdb95;">select</span>=<span style="color: #e67128;">"."</span>/&gt;
 &lt;<span style="color: #00ede1; font-weight: bold;">br</span> /&gt;
&lt;/<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">template</span>&gt;
&lt;/<span style="color: #23d7d7;">xsl</span>:<span style="color: #00ede1; font-weight: bold;">stylesheet</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org37bd22e" class="outline-3">
<h3 id="org37bd22e"><span class="section-number-3">34.9</span> Invalid characters <a id="org435fc1f">xml:invalid_characters</a></h3>
<div class="outline-text-3" id="text-34-9">
<p>
Characters :: &amp;#x1F; &amp;#x1E;
</p>

<p>
change to version 1.1 or get rid of the characters
</p>
<pre class="example">
&lt;?xml version="1.1" encoding="UTF-8" ?&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbcd9a82" class="outline-2">
<h2 id="orgbcd9a82"><span class="section-number-2">35</span> DevOps</h2>
<div class="outline-text-2" id="text-35">
</div>
<div id="outline-container-orgc4da545" class="outline-3">
<h3 id="orgc4da545"><span class="section-number-3">35.1</span> Knowledge</h3>
<div class="outline-text-3" id="text-35-1">
<p>
Methodologies
</p>
<ol class="org-ol">
<li>People over process over tools</li>
<li>Continuous delivery</li>
<li>Lean Management
<ul class="org-ul">
<li>Work in small batches</li>
<li>Work in progress limits</li>
<li>Feedback loops</li>
<li>Visualization</li>
</ul></li>
<li>Visible ops change control
<ul class="org-ul">
<li>Eliminate fragile artifacts</li>
<li>Crate a repeatable build process</li>
<li>Manage dependencies</li>
<li>Create an environment of continous improvement</li>
</ul></li>
<li>Infrastructure as code
<ul class="org-ul">
<li>Systems treated like code</li>
<li>Checked into source control</li>
<li>Reviewed, built and tested</li>
<li>Managed programmatically</li>
</ul></li>
</ol>

<p>
10 Best practices
</p>
<ul class="org-ul">
<li>Chaos Moneky</li>
<li>Blue/Green Deployment</li>
<li>Dependency Injection</li>
<li>Andon Cords (anyone can pull to stop the production line)</li>
<li>The Cloud (fast API services)</li>
<li>Embedded Teams</li>
<li>Blameless Postmortems
<ul class="org-ul">
<li>The people whose actions have contributed to an accident can give a detailed account of 5 W's</li>
<li>And they can give this detailed account without fear of punishment</li>
<li>The detailed account gives an understanding of the mechanism, pathology, and operation of the failure</li>
<li>The account also guarantees that it will repeat</li>
<li>It's a meeting within 48 hours of the incident</li>
<li>Have a third party run it</li>
</ul></li>
<li>Public Status Page</li>
<li>Developers on Call</li>
<li>Incident Command System</li>
</ul>

<p>
Provision :: Making a server ready for operation, including hardware, OS, system services, network connectivity
Deployment :: automatically deploying and upgrading applications on a server
Orchestration :: performing coordinated operations across multiple systems
Configuration management :: management of change control for system configuration after initial provision; maintaining and upgrading
the application and application dependencies
</p>

<p>
Imperative/procedural :: commands necessary to produce a desired state are defined and executed
Declarative/functional :: a desired state is defined, relying on the tool to configure a system to match that state
</p>

<p>
Idempotent :: the ability to execute repeatedly, resulting in the same outcome
</p>

<p>
Self service :: the ability for an end user to initiate a process without having to go through other people
</p>

<p>
Continuous integration :: is the practice of automatically building and unit testing the entire application frequently. Ideally, every source code check in.
</p>

<p>
Continuous Delivery :: is the addtional practice of deploying every change to to a production like environment and performing automated integration and acceptance testing.
</p>

<p>
Continuous Deployment :: extends this to where every change goes through full enough automated testing.
</p>

<p>
CI Phases and corresponding tools
</p>
<ul class="org-ul">
<li>Version control</li>
<li>CI systems (Jenkin, CloudBees, Bamboo, CircleCI, TravisCI)</li>
<li>Build (Make/Rake, Maven, Gulp)</li>
<li>Test (JUnit, golint/gofmt, RuboCop, Robot, Protractor, Cucumber, Selenium, Sauce Labs, ApacheBench, JMeter, Brakeman, Veracode)</li>
<li>Artifact repository (Artifactory, Nexus, Docker Hub, AWS S3)</li>
<li>Deployment (Rundeck, UrbanCode, ThoughtWorks, Deployinator)</li>
</ul>

<p>
Docker Swarm, Google Kubernetes, Apache Mesos
</p>
</div>
</div>

<div id="outline-container-org096f367" class="outline-3">
<h3 id="org096f367"><span class="section-number-3">35.2</span> Visual Regression Testing</h3>
<div class="outline-text-3" id="text-35-2">
</div>
<div id="outline-container-orge425b7a" class="outline-4">
<h4 id="orge425b7a"><span class="section-number-4">35.2.1</span> Tools</h4>
<div class="outline-text-4" id="text-35-2-1">
<p>
<a href="https://github.com/mojoaxel/awesome-regression-testing">https://github.com/mojoaxel/awesome-regression-testing</a>
<a href="https://www.creativebloq.com/features/the-5-best-visual-regression-testing-tools">https://www.creativebloq.com/features/the-5-best-visual-regression-testing-tools</a>
</p>

<p>
Headless browser
</p>
<dl class="org-dl">
<dt>PhantomJS</dt><dd>WebKit</dd>
<dt>SlimerJS</dt><dd>Firefox</dd>
</dl>

<p>
CasperJS :: JavaScript navigation scripting and testing utility for PhantomJS and SlimerJS
ResemberJS :: JavaScript / HTML5 library for making image comparisons.
</p>

<p>
<a href="https://backtrac.io/">https://backtrac.io/</a>
</p>

<p>
BackstopJS 3
</p>
</div>
</div>
</div>

<div id="outline-container-org5a709db" class="outline-3">
<h3 id="org5a709db"><span class="section-number-3">35.3</span> Code Linting</h3>
<div class="outline-text-3" id="text-35-3">
<p>
Drupal module Coder to check code linting
</p>
</div>
</div>

<div id="outline-container-org8a2cd09" class="outline-3">
<h3 id="org8a2cd09"><span class="section-number-3">35.4</span> Security Scans</h3>
<div class="outline-text-3" id="text-35-4">
<p>
Tinfoil SEcurity
SiteImprove
</p>
</div>
</div>

<div id="outline-container-orgf571dec" class="outline-3">
<h3 id="orgf571dec"><span class="section-number-3">35.5</span> Accessibility</h3>
<div class="outline-text-3" id="text-35-5">
<p>
SiteImprove
</p>
</div>
</div>

<div id="outline-container-org05cd0fb" class="outline-3">
<h3 id="org05cd0fb"><span class="section-number-3">35.6</span> Performance Testing</h3>
<div class="outline-text-3" id="text-35-6">
<p>
<a href="https://loader.io/">https://loader.io/</a>
</p>
</div>
</div>

<div id="outline-container-orge4a0851" class="outline-3">
<h3 id="orge4a0851"><span class="section-number-3">35.7</span> Drupal</h3>
<div class="outline-text-3" id="text-35-7">
<p>
drupalvm.com
devwithlando.io
</p>

<p>
Send metrics and logs (e.g. Watchdog) to Elasticsearch 
</p>

<p>
Kibana
PHP APM (Application Performance Metrics)
</p>
</div>
</div>

<div id="outline-container-org8e5dec5" class="outline-3">
<h3 id="org8e5dec5"><span class="section-number-3">35.8</span> Ansible</h3>
</div>
</div>
<div id="outline-container-org762a3ed" class="outline-2">
<h2 id="org762a3ed"><span class="section-number-2">36</span> Tools</h2>
<div class="outline-text-2" id="text-36">
</div>
<div id="outline-container-orgb9b0edb" class="outline-3">
<h3 id="orgb9b0edb"><span class="section-number-3">36.1</span> phpStorm</h3>
<div class="outline-text-3" id="text-36-1">
<p>
Help &gt; Default Keymap Reference
</p>
</div>
<div id="outline-container-org7e1b1e9" class="outline-4">
<h4 id="org7e1b1e9"><span class="section-number-4">36.1.1</span> Installation and 64 bit</h4>
<div class="outline-text-4" id="text-36-1-1">
<p>
Just install the new version and it will guide you to uninstall and keep the settings.
For activation, choose License server, address is <a href="http://idea.lanyus.com/">http://idea.lanyus.com/</a> 
(last time <a href="http://idea.qinxi1992.cn/">http://idea.qinxi1992.cn/</a>)
</p>

<p>
Install Java SE Development Kit (JDK) 64 bit
Open C:\Program Files (x86)\JetBrains\PhpStorm 10.0.3\bin\PhpStorm64.exe
Help &gt; About, you should see
JRE: amd64
JVM: 64-bit
If not, set environment variable `JAVA_HOME` to C:\Program Files\Java\jdk1.8.0_101 and restart PhpStorm64.exe
Inside PhpStorm, Help &gt; Edit Custom VM Options 
and change `-Xms` and `-Xmx` to	`-Xms4g` and `-Xmx4g`
Restart PhpStorm64.exe and open multiple projects to test RAM.
Finally, edit the shortcut to use PhpStorm64.exe
</p>

<p>
Help &gt; Check for Update &gt; Change setting to don't auto check update.
You can still use it to update plugins manually in this way.
</p>
</div>
</div>

<div id="outline-container-org881daa3" class="outline-4">
<h4 id="org881daa3"><span class="section-number-4">36.1.2</span> Change config directories</h4>
<div class="outline-text-4" id="text-36-1-2">
<p>
<a href="https://intellij-support.jetbrains.com/hc/en-us/articles/207240985-Changing-IDE-default-directories-used-for-config-plugins-and-caches-storage">https://intellij-support.jetbrains.com/hc/en-us/articles/207240985-Changing-IDE-default-directories-used-for-config-plugins-and-caches-storage</a>
</p>

<p>
Before doing that, export settings so that you can import them later.
</p>

<p>
Help | Edit Custom Properties…
</p>

<p>
idea.config.path=c:/work/idea/caches/trunk-config
idea.system.path=c:/work/idea/caches/trunk-system
idea.plugins.path=c:/work/idea/caches/trunk-plugins
</p>
</div>
</div>

<div id="outline-container-org45c4a6e" class="outline-4">
<h4 id="org45c4a6e"><span class="section-number-4">36.1.3</span> Open big file</h4>
<div class="outline-text-4" id="text-36-1-3">
<p>
Ensure phpStorm is running in 64bit.
</p>

<p>
<a href="https://intellij-support.jetbrains.com/hc/en-us/articles/206544519">https://intellij-support.jetbrains.com/hc/en-us/articles/206544519</a>
This is called idea.config.path
Create a custom idea.properties file in one these locations. This is called 
For Windows: in %USERPROFILE%\.IntelliJIdeaXX or %USERPROFILE%\.IdeaICXX,
For Windows: actually %USERPROFILE%\.PhpStorm2017.1\config
For *NIX: in ~/.IntelliJIdeaXX or ~/.IdeaICXX
For macOS: in ~/Library/Preferences/IntelliJIdeaXX or ~/Library/Preferences/IdeaICXX
</p>

<p>
Or Help &gt; Edit Custom Properties to create it and edit
</p>

<p>
Don't change the system idea.properties at install-path/bin e.g.
</p>
<pre class="example">
# in kb
# Provide code assistance
idea.max.intellisense.filesize=50000
# Open file size
idea.max.content.load.filesize=500000
</pre>

<p>
More settings :: <a href="http://www.jetbrains.com/help/idea/tuning-the-ide.html">http://www.jetbrains.com/help/idea/tuning-the-ide.html</a>
</p>
</div>

<div id="outline-container-orgad588d3" class="outline-5">
<h5 id="orgad588d3"><span class="section-number-5">36.1.3.1</span> Plugin: JB SDK Bintray Downloader</h5>
<div class="outline-text-5" id="text-36-1-3-1">
<p>
Install JetBrains Plugin
Find Action &gt; Get JB SDK
Select the most recent version to download and then install: e.g. jbsdk8u152b941_windows_x64.tar.gz
%USERPROFILE%\.PhpStorm2017.1\config\jdks\ holds JB SDK libraries downloaded using the plugin
</p>

<p>
About should show
JRE: 1.8.0_152-release-b941 amd64
JVM: OpenJDK 64-Bit Server VM by JetBrains s.r.o
</p>

<p>
Find Action &gt; Switch IDE Boot SDK to switch between installed runtimes. Always use the JetBrains version.
</p>
</div>
</div>
</div>

<div id="outline-container-orgbbcd96a" class="outline-4">
<h4 id="orgbbcd96a"><span class="section-number-4">36.1.4</span> Deployment</h4>
<div class="outline-text-4" id="text-36-1-4">
<p>
For localhost, Use In place type, and Web server root URL is the file path to the project root directory e.g. <a href="file:///E:/li/cssSandbox/">file:///E:/li/cssSandbox/</a>
Mappings &gt; Web path on server is /
</p>
</div>
</div>

<div id="outline-container-org0e9e86f" class="outline-4">
<h4 id="org0e9e86f"><span class="section-number-4">36.1.5</span> Find file</h4>
<div class="outline-text-4" id="text-36-1-5">
<p>
Navigate &gt; File
Find directory: <code>name/</code> or <code>name\</code>
</p>

<p>
Find file
CamelHumps :: <code>sap</code> matches <code>StrangeAnimalPage.html</code>
snake_case :: <code>s a p</code> matches <code>strange_animal_page.html</code>
Files in nested directories :: <code>a/a/s a p</code> matches <code>calendar\Animals\Animaux\StrangeAnimalPage.html</code> and <code>strange_animal_page.html</code> in the same folder
e.g. for Drupal, <code>s/a/m/custom/*.md</code> matches <code>sites/all/modules/custom/*.md</code> files
</p>
</div>
</div>

<div id="outline-container-orga33ba41" class="outline-4">
<h4 id="orga33ba41"><span class="section-number-4">36.1.6</span> HTML, CSS, Javascript</h4>
<div class="outline-text-4" id="text-36-1-6">
</div>
<div id="outline-container-org85c2a85" class="outline-5">
<h5 id="org85c2a85"><span class="section-number-5">36.1.6.1</span> Show Applied Styles</h5>
<div class="outline-text-5" id="text-36-1-6-1">
<p>
Right click on element and select <span class="underline">Show Applied Sytles for Tag</span>
</p>
</div>
</div>

<div id="outline-container-orgc0375a7" class="outline-5">
<h5 id="orgc0375a7"><span class="section-number-5">36.1.6.2</span> CSS vendor prefix</h5>
<div class="outline-text-5" id="text-36-1-6-2">
<p>
e.g. all vendor prefixes for box-sizing. Type -box-sizing and hit tab.
</p>
</div>
</div>

<div id="outline-container-orga2659e2" class="outline-5">
<h5 id="orga2659e2"><span class="section-number-5">36.1.6.3</span> JavaScript version</h5>
<div class="outline-text-5" id="text-36-1-6-3">
<p>
Settings &gt; Languages &amp; Frameworks &gt; JavaScript &gt; JavaScript language version to ECMAScript 6
For Scratch, right click on the file in Edit window and change language to ES6
</p>
</div>
</div>
</div>

<div id="outline-container-org2d5c2a6" class="outline-4">
<h4 id="org2d5c2a6"><span class="section-number-4">36.1.7</span> Regex Find</h4>
<div class="outline-text-4" id="text-36-1-7">
<p>
Find function name that contains <code>_node_</code>
<code>function[\s+].*_node</code>
</p>
</div>
</div>

<div id="outline-container-org6d0ca35" class="outline-4">
<h4 id="org6d0ca35"><span class="section-number-4">36.1.8</span> <a href="#orgc0cbc97">XPath</a></h4>
<div class="outline-text-4" id="text-36-1-8">
<p>
You need to make the xml file part of a project to use Evaluate <a href="#orgc0cbc97">XPath</a>&#x2026; (right click) 
</p>
</div>
</div>

<div id="outline-container-org7fd9f13" class="outline-4">
<h4 id="org7fd9f13"><span class="section-number-4">36.1.9</span> Emmet</h4>
<div class="outline-text-4" id="text-36-1-9">
</div>
<div id="outline-container-org97f5616" class="outline-5">
<h5 id="org97f5616"><span class="section-number-5">36.1.9.1</span> How it works</h5>
<div class="outline-text-5" id="text-36-1-9-1">
<p>
snippets.json store something like "m": "margin:|;"
</p>

<p>
Settings &gt; Emmet &gt; HTML, CSS, JSX
Settings &gt; Keymap &gt; search emmet
</p>

<p>
<a href="https://docs.emmet.io/cheat-sheet/">https://docs.emmet.io/cheat-sheet/</a>
<a href="https://docs.emmet.io/">https://docs.emmet.io/</a>
</p>
</div>
</div>

<div id="outline-container-org0cc3379" class="outline-5">
<h5 id="org0cc3379"><span class="section-number-5">36.1.9.2</span> Surround with, wrap each line with a tag <a id="orgde5ce64">phpstorm:emmet:wrap</a></h5>
<div class="outline-text-5" id="text-36-1-9-2">
<p>
Refer to <a href="#orgdd669f5">phpstorm:surround with</a>
</p>

<pre class="example">
//* Unordered item 1
//* Unordered item 2
//* Unordered item 3

// Select 3 lines and type (abbreviation)
// ul&gt;li*

&lt;ul&gt;
    &lt;li&gt;* Unordered item 1&lt;/li&gt;
    &lt;li&gt;* Unordered item 2&lt;/li&gt;
    &lt;li&gt;* Unordered item 3&lt;/li&gt;
&lt;/ul&gt;

// Use filter t (trim) to remove list markers
// ul.nav&gt;li.nav-item$*&gt;a|t
</pre>
</div>
</div>

<div id="outline-container-orga5036b0" class="outline-5">
<h5 id="orga5036b0"><span class="section-number-5">36.1.9.3</span> Number $</h5>
</div>
<div id="outline-container-orgeef9418" class="outline-5">
<h5 id="orgeef9418"><span class="section-number-5">36.1.9.4</span> Repeat input * as $#</h5>
</div>
<div id="outline-container-orgffcf158" class="outline-5">
<h5 id="orgffcf158"><span class="section-number-5">36.1.9.5</span> Filters using Pipe(s)</h5>
<div class="outline-text-5" id="text-36-1-9-5">
</div>
<ol class="org-ol">
<li><a id="org72b88be"></a>Escape XML e<br />
<div class="outline-text-6" id="text-36-1-9-5-1">
<pre class="example">
iframe|e
&amp;lt;iframe src="" frameborder="0" title=""&amp;gt;&amp;lt;/iframe&amp;gt;
</pre>
</div>
</li>

<li><a id="org5ad77e3"></a>Comment c<br />
<div class="outline-text-6" id="text-36-1-9-5-2">
<p>
Add comments around tags with id or class attribute.
</p>
</div>
</li>

<li><a id="org9c26420"></a>xsl<br /></li>
<li><a id="org505c91f"></a>Single Line s<br /></li>
<li><a id="orge3a0c9f"></a>Trim t<br /></li>
</ol>
</div>
<div id="outline-container-org38ad528" class="outline-5">
<h5 id="org38ad528"><span class="section-number-5">36.1.9.6</span> HTML</h5>
</div>
<div id="outline-container-org0083e82" class="outline-5">
<h5 id="org0083e82"><span class="section-number-5">36.1.9.7</span> CSS</h5>
<div class="outline-text-5" id="text-36-1-9-7">
</div>
<ol class="org-ol">
<li><a id="org7a309bd"></a>margin (m), color (c), border (bd)<br />
<div class="outline-text-6" id="text-36-1-9-7-1">
<p>
m10 TAB for margin: 10px;
m10-20 TAB for margin: 10px 20px;
m-10&#x2013;20 TAB for margin: -10px -20px;
m1.5 TAB for margin: 1.5em;
m1.5rem TAB for margin: 1.5rem;
m10p30e5x TAB for margin: 10% 30em 5ex;
</p>

<p>
p :: percentage
e :: em
x :: ex
</p>

<p>
Color (c) :: e.g. c#fc0
</p>

<p>
Border (bd, s) :: e.g. bd5#0s border: 5px #000 solid
</p>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-orgd851cc2" class="outline-4">
<h4 id="orgd851cc2"><span class="section-number-4">36.1.10</span> Show unprintable characters (TAB)</h4>
<div class="outline-text-4" id="text-36-1-10">
<p>
Find Action (Ctrl+Shift+A) &gt; search Show Whitespaces
</p>
</div>
</div>

<div id="outline-container-orgeffba08" class="outline-4">
<h4 id="orgeffba08"><span class="section-number-4">36.1.11</span> Convert to Tab/Spaces for indentation</h4>
<div class="outline-text-4" id="text-36-1-11">
<p>
Find Action &gt; To Tab
</p>
</div>
</div>

<div id="outline-container-org7883dd4" class="outline-4">
<h4 id="org7883dd4"><span class="section-number-4">36.1.12</span> Surround with&#x2026; - Shortcut Alt + Shift + Z or Ctrl + Alt + T <a id="orgdd669f5">phpstorm:surround with</a></h4>
<div class="outline-text-4" id="text-36-1-12">
</div>
<div id="outline-container-orgcea9435" class="outline-5">
<h5 id="orgcea9435"><span class="section-number-5">36.1.12.1</span> Surround with Live Template</h5>
<div class="outline-text-5" id="text-36-1-12-1">
<p>
Select a text abc and wrap it into a function call
</p>

<p>
Settings &gt; Live Templates &gt; under user, +, Live Template &gt;
Abbreviation :: lifc
Description :: Surround with function call
Template text :: <code>$END$($SELECTION$)</code>
Context :: Everywhere
</p>

<p>
Then select the text, Surround with
</p>
</div>
</div>

<div id="outline-container-orga6a2684" class="outline-5">
<h5 id="orga6a2684"><span class="section-number-5">36.1.12.2</span> Surround with Emmet <a href="#orgde5ce64">phpstorm:emmet:wrap</a></h5>
</div>
</div>
<div id="outline-container-org365366f" class="outline-4">
<h4 id="org365366f"><span class="section-number-4">36.1.13</span> File and Code Templates</h4>
<div class="outline-text-4" id="text-36-1-13">
<p>
Settings &gt; Editor &gt; Code Style &gt; File and Code Templates
</p>
</div>
</div>

<div id="outline-container-org66599c2" class="outline-4">
<h4 id="org66599c2"><span class="section-number-4">36.1.14</span> Custom code folding regions</h4>
<div class="outline-text-4" id="text-36-1-14">
<p>
Select the block of code you want to fold
C-M-t or "surround with"
Choose either NetBeans style or VisualStudio style. Don't mix 2 styles.
</p>
</div>
</div>

<div id="outline-container-orgc779910" class="outline-4">
<h4 id="orgc779910"><span class="section-number-4">36.1.15</span> Multiple cursors, move cursor, selection</h4>
<div class="outline-text-4" id="text-36-1-15">
<p>
Alt and click to create a cursor. Esc to reduce to only one cursor
</p>

<dl class="org-dl">
<dt>Ctrl + Shift + Up</dt><dd>Move to previous sibling element in HTML. If there's none, then move to the start of the parent element</dd>
<dt>Ctrl + Shift + Down</dt><dd>Move to next sibling element in HTML.</dd>

<dt>Alt + Shift + Up / Down</dt><dd>Increase / Decrease selection, e.g. select current element and content and increase to select parent element for HTML</dd>
</dl>
</div>
</div>

<div id="outline-container-org4e0698f" class="outline-4">
<h4 id="org4e0698f"><span class="section-number-4">36.1.16</span> Stop indexing for a directory</h4>
<div class="outline-text-4" id="text-36-1-16">
<p>
Settings &gt; Directories &gt; Select and Exclude
</p>

<p>
About marking directories :: <a href="https://www.jetbrains.com/help/phpstorm/configuring-folders-within-a-content-root.html">https://www.jetbrains.com/help/phpstorm/configuring-folders-within-a-content-root.html</a>
</p>
</div>
</div>

<div id="outline-container-orgd72bb38" class="outline-4">
<h4 id="orgd72bb38"><span class="section-number-4">36.1.17</span> MySQL</h4>
<div class="outline-text-4" id="text-36-1-17">
<p>
When there're multiple statements (multiple ;), Ctrl + Enter (or to Execute from Menu) prompts a list of statements to run:
</p>
<ul class="org-ul">
<li>Smallest statement. 
<ul class="org-ul">
<li>The smallest of the possible statements is executed. For example, when the cursor is inside a subquery, the subquery is executed.</li>
</ul></li>
<li>Largest statement. 
<ul class="org-ul">
<li>The largest possible statement is executed.</li>
<li>e.g., when the cursor is inside a subquery, an outer statement is executed.</li>
</ul></li>
<li>Largest statement or batch. 
<ul class="org-ul">
<li>For Transact-SQL (SQL Server and Sybase), the current batch of statements is executed. For all other dialects - the same as the previous option.</li>
</ul></li>
<li>Whole script. All the statements are executed. (This item always appears and always appear last)</li>
</ul>

<p>
You can also Ctrl + A to select all statements and Ctrl + Enter to run all of them.
</p>
</div>
</div>

<div id="outline-container-org4d9d6da" class="outline-4">
<h4 id="org4d9d6da"><span class="section-number-4">36.1.18</span> Return all query results</h4>
<div class="outline-text-4" id="text-36-1-18">
<p>
Click on the Wrench icon on the toolbar of the Database Console tool window.
Switch to Database | Data Views page, specify 0 in the Result set page size field, and click OK.
Default is 500.
</p>

<p>
That way you can export all rows to csv file.
</p>
</div>
</div>

<div id="outline-container-orge557946" class="outline-4">
<h4 id="orge557946"><span class="section-number-4">36.1.19</span> nodejs <a id="orgac0548b">phpstorm:nodejs</a></h4>
<div class="outline-text-4" id="text-36-1-19">
<p>
Enable ES6 for Settings &gt; Languages &amp; Frameworks &gt; Javascript &gt; JavaScript language version &gt; ECMAScript 6
Install plugin NodeJS, restart phpStorm after Node and NPM are installed on Windows. 
Enable <code>Node.js Core library</code> in Settings &gt; Languages &amp; Frameworks &gt; Node.js and NPM
Node interpreter looks like <code>C:\Program Files\nodejs\node.exe</code>
</p>
</div>
</div>

<div id="outline-container-orgd606f14" class="outline-4">
<h4 id="orgd606f14"><span class="section-number-4">36.1.20</span> Golang Plugin <a id="org127aa5e">phpstorm:golang</a></h4>
<div class="outline-text-4" id="text-36-1-20">
<p>
Search for Go, install plugin and restart phpStorm
Setup SDK, which is c:\go
</p>
</div>
</div>

<div id="outline-container-org437cb39" class="outline-4">
<h4 id="org437cb39"><span class="section-number-4">36.1.21</span> plugin - Makefile support</h4>
</div>
<div id="outline-container-org9b1180b" class="outline-4">
<h4 id="org9b1180b"><span class="section-number-4">36.1.22</span> plugin - Makefile Navigator</h4>
<div class="outline-text-4" id="text-36-1-22">
<p>
Turn off the plugin:Makefile support and enable this plugin
</p>
</div>
</div>

<div id="outline-container-org75d0e97" class="outline-4">
<h4 id="org75d0e97"><span class="section-number-4">36.1.23</span> Docker support</h4>
<div class="outline-text-4" id="text-36-1-23">
<p>
In Docker for Windows &gt; Settings &gt; General
Choose Expose daemon on tcp://localhost:2375 without TLS
</p>

<p>
In phpStorm, Settings &gt; Build, Execution, Deployment &gt; Docker, create Docker with a + button.
</p>

<p>
Default should work, so just OK
</p>

<p>
API URL: tcp://localhost:2375
Certificates folder: blank
Docker Compose executable: docker-compose
VirtualBox shared folders: VM Path - /c/Users, Local path - C:\Users
</p>

<p>
You should see Docker under the bottom bar, select and connect to it. Now you should see the running containers and available images.
</p>
</div>
</div>

<div id="outline-container-org979c6c1" class="outline-4">
<h4 id="org979c6c1"><span class="section-number-4">36.1.24</span> Vue.js</h4>
<div class="outline-text-4" id="text-36-1-24">
<p>
JetBrains plugin repository
</p>
</div>
</div>

<div id="outline-container-org3ac70ac" class="outline-4">
<h4 id="org3ac70ac"><span class="section-number-4">36.1.25</span> TS: Reset Index</h4>
<div class="outline-text-4" id="text-36-1-25">
<p>
File | Invalidate Caches and restart IDE
</p>
</div>
</div>
</div>

<div id="outline-container-orgf8996c8" class="outline-3">
<h3 id="orgf8996c8"><span class="section-number-3">36.2</span> Emacs</h3>
<div class="outline-text-3" id="text-36-2">
</div>
<div id="outline-container-orgac3dd27" class="outline-4">
<h4 id="orgac3dd27"><span class="section-number-4">36.2.1</span> Install &amp; Configuration</h4>
<div class="outline-text-4" id="text-36-2-1">
<ul class="org-ul">
<li>Download for Windows <a href="https://ftp.gnu.org/pub/gnu/emacs/windows/">https://ftp.gnu.org/pub/gnu/emacs/windows/</a></li>
<li id="This version"><a href="https://ftp.gnu.org/gnu/emacs/windows/emacs-26/emacs-26.1-x86_64.zip">https://ftp.gnu.org/gnu/emacs/windows/emacs-26/emacs-26.1-x86_64.zip</a>
<dl class="org-dl">
<dt>Previous versions</dt><dd>emacs-26.1-x86_64.zip (with all deps 64-bit) emacs-25.1-i686-w64-mingw32 emacs-24.5-bin-i686-mingw32.zip</dd>
</dl></li>
<li>Extract it to C:\emacs, so you will have C:\emacs\emacs-24.5-bin-i686-mingw32\</li>
</ul>

<p>
Windows Shortcut to Start:
</p>
<ul class="org-ul">
<li>Make a shortcut of this file /bin/runemacs.exe and copy to your notes folder say C:\c\notes\</li>
<li>Then right click, select Properties of the shortcut and change the <code>Start In</code> to <code>C:\c\notes</code></li>
</ul>

<p>
Windows Batch File to Start:
</p>
<ul class="org-ul">
<li>Set a HOME user environment variable in Windows as <code>C:\c\notes</code> and that is <code>~/</code> as the home directory inside Emacs</li>
<li>Include an init file <code>C:\c\notes\.emacs</code></li>
</ul>

<p>
Your home folder in Emacs is <code>C:\c\notes</code> and from time to time there're auto-save-list (auto saved files records) saved in home folder <code>C:\c\notes\.emacs.d</code> folder
</p>

<p>
C:/c/notes/run.bat
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #23d7d7;">set</span> <span style="color: #dbdb95;">HOME</span>=E:\li\notes
C:\emacs\emacs-25.1-i686-w64-mingw32\bin\runemacs.exe notes.org
</pre>
</div>

<dl class="org-dl">
<dt>To display images inline</dt><dd>Extract emacs-25-i686-deps.zip and copy all files in bin to C:\emacs\emacs-25.1-i686-w64-mingw32\bin</dd>
</dl>

<p>
Performance
</p>
<dl class="org-dl">
<dt>Show init time</dt><dd><code>M-x emacs-init-time</code></dd>
</dl>
</div>
</div>

<div id="outline-container-org8ec2e7e" class="outline-4">
<h4 id="org8ec2e7e"><span class="section-number-4">36.2.2</span> MELPA packages</h4>
<div class="outline-text-4" id="text-36-2-2">
<p>
Default is just one package-archives "gnu" at <a href="http://elpa.gnu.org/packages/">http://elpa.gnu.org/packages/</a>
Add <a href="http://melpa.org/packages/">http://melpa.org/packages/</a>
</p>

<p>
Run <code>M-x list-packages</code> to see all packages including built-in pkgs and package-archives. <code>i</code> for installation, <code>u</code> to unmark, <code>x</code> to perform the i and u installation. <code>RET</code> to see more about a pkg.
</p>

<p>
New install is in <code>~/.emacs.d/elpa/newpkgname-YYYYMMDD.123</code>, then you can follow instructions on Melpa.org to initialize in .emacs init file.
</p>

<p>
Another GitHub pkg <code>el-get</code> can be used to install/load pkgs from difference sources :: <a href="https://mrblog.nl/emacs/config.html">https://mrblog.nl/emacs/config.html</a>
</p>

<p>
Place packages under load-path <code>C-h v load-path RET</code>
C:\emacs\emacs-24.5-bin-i686-mingw32\share\emacs\VERSION\site-lisp is /usr/local/share/emacs/VERSION/site-lisp for a particular Emacs version
C:\emacs\emacs-24.5-bin-i686-mingw32\share\emacs\site-lisp is /usr/local/share/emacs/VERSION/site-lisp for all Emacs version
</p>

<p>
*.el (source) *.,elc (byte-compiled) are ELPA package and should be used for emacs 24+
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-to-list 'load-path <span style="color: #e67128;">"~/.emacs.d/lisp/"</span>)

(add-to-list 'load-path <span style="color: #e67128;">"c:/c/notes/lisp"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org544de7c" class="outline-4">
<h4 id="org544de7c"><span class="section-number-4">36.2.3</span> M-x</h4>
<div class="outline-text-4" id="text-36-2-3">
<dl class="org-dl">
<dt><a id="org57a207a">emacs:m-x:customize-themes</a></dt><dd>Load a theme</dd>
<dt><a id="org8e6c150">emacs:m-x:customize-variable</a></dt><dd>see a variable value and may change later <code>M-x customize-variable [RET] package-archives [RET]</code></dd>
<dt><a id="orga3ceb6e">emacs:m-x:delete-trailing-whitespace</a></dt><dd>delete current buffer's trailing whitespace</dd>
<dt><a id="orgfcfd3b3">emacs:m-x:indent-region</a></dt><dd>reformat indentation for the current buffer without select regions. Or select region then <code>C-M-\</code></dd>
</dl>
</div>
</div>

<div id="outline-container-org56df70c" class="outline-4">
<h4 id="org56df70c"><span class="section-number-4">36.2.4</span> Basics</h4>
<div class="outline-text-4" id="text-36-2-4">
<p>
Help :: C-h
</p>
<dl class="org-dl">
<dt>See all help options</dt><dd><code>C-h ?</code></dd>
<dt>Find shortcut by command (where-is)</dt><dd><code>C-h w</code></dd>
<dt>Description of a function</dt><dd><code>C-h f</code></dd>
<dt>Get variable value</dt><dd><code>C-h v</code></dd>
</dl>

<p>
File
</p>
<dl class="org-dl">
<dt>C-x C-s</dt><dd>save file, save current buffer</dd>
<dt>C-x C-c</dt><dd>quit Emacs</dd>
<dt>C-x C-f</dt><dd>open file, create file</dd>
</dl>

<table id="org826b257" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>

<tr>
<th scope="col" class="org-left">Editing</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><span class="underline">underlined</span></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>verbatim</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>verbatim</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><del>strike_through</del></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><i>Italics</i></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">C-c .</td>
<td class="org-left">Insert timestamp</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">C-k</td>
<td class="org-left">Remove line, Delete Line</td>
</tr>

<tr>
<td class="org-left">C-x u</td>
<td class="org-left">Undo</td>
</tr>

<tr>
<td class="org-left">C-a</td>
<td class="org-left">Beginning of line</td>
</tr>

<tr>
<td class="org-left">C-e</td>
<td class="org-left">End of line</td>
</tr>

<tr>
<td class="org-left">C-h k</td>
<td class="org-left">Explain what key-combo will do</td>
</tr>

<tr>
<td class="org-left">C-S-Bksp</td>
<td class="org-left">Kill whole line</td>
</tr>

<tr>
<td class="org-left">C-x u</td>
<td class="org-left">undo</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&lt;q</td>
<td class="org-left"><code>BEGIN_QUOTE</code></td>
</tr>

<tr>
<td class="org-left">&lt;H</td>
<td class="org-left"><code>BEGIN_HTML</code></td>
</tr>

<tr>
<td class="org-left">&lt;c</td>
<td class="org-left"><code>BEGIN_CENTER</code></td>
</tr>

<tr>
<td class="org-left">&lt;e</td>
<td class="org-left"><code>BEGIN_EXAMPLE</code></td>
</tr>

<tr>
<td class="org-left">c-c ;</td>
<td class="org-left"><code>BEGIN_COMMENT</code></td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Headline</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">TAB</td>
<td class="org-left">Local tree fold/unfold</td>
</tr>

<tr>
<td class="org-left">C-u TAB</td>
<td class="org-left">Global tree fold/unfold</td>
</tr>

<tr>
<td class="org-left">C-u C-u C-u TAB</td>
<td class="org-left">Show all</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Table</td>
<td class="org-left"><a id="orga9f14c0">emacs:table</a></td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">C-c -</td>
<td class="org-left">Insert a horizontal line below</td>
</tr>

<tr>
<td class="org-left">M-S-&lt;down&gt;</td>
<td class="org-left">Insert a new row above</td>
</tr>

<tr>
<td class="org-left">C-c &lt;RET&gt;</td>
<td class="org-left">Insert horizontal line and a new row below</td>
</tr>

<tr>
<td class="org-left">M-S-&lt;up&gt;</td>
<td class="org-left">Delete a current row</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">M-S-&lt;right&gt;</td>
<td class="org-left">Insert new column on the right</td>
</tr>

<tr>
<td class="org-left">M-S-&lt;left&gt;</td>
<td class="org-left">Delete current column</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">C-c &lt;SPC&gt;</td>
<td class="org-left">Blank current field</td>
</tr>

<tr>
<td class="org-left">C-c `</td>
<td class="org-left">Edit current field</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">S-&lt;TAB&gt;</td>
<td class="org-left">Move to previous field</td>
</tr>

<tr>
<td class="org-left">M-&lt;up&gt;/&lt;down&gt;</td>
<td class="org-left">Move a row</td>
</tr>

<tr>
<td class="org-left">M-&lt;left&gt;/&lt;right&gt;</td>
<td class="org-left">Move a column</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">C-c &vert;</td>
<td class="org-left">After text is selected, convert to table</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Moving</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">C-l</td>
<td class="org-left">Scroll current line to center</td>
</tr>

<tr>
<td class="org-left">C-x b</td>
<td class="org-left">switch to another buffer</td>
</tr>

<tr>
<td class="org-left">M-&lt;</td>
<td class="org-left">Move to beginning of buffer</td>
</tr>

<tr>
<td class="org-left">M-&gt;</td>
<td class="org-left">Move to end of buffer</td>
</tr>

<tr>
<td class="org-left">M-g M-g</td>
<td class="org-left">Go to a line</td>
</tr>

<tr>
<td class="org-left">C-c C-j</td>
<td class="org-left">org-goto. Search in headlines only</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org115a8b9" class="outline-4">
<h4 id="org115a8b9"><span class="section-number-4">36.2.5</span> Windows</h4>
<div class="outline-text-4" id="text-36-2-5">
<dl class="org-dl">
<dt>Remove current window</dt><dd>C-x 0</dd>
<dt>Remove a help window or close all other window</dt><dd>C-x 1</dd>
<dt>Split horizontally</dt><dd>C-x 2</dd>
<dt>Split vertically</dt><dd>C-x 3</dd>
<dt>Move to other window</dt><dd>C-x o</dd>
</dl>
</div>
</div>

<div id="outline-container-org5bf1f58" class="outline-4">
<h4 id="org5bf1f58"><span class="section-number-4">36.2.6</span> Region (selection)</h4>
<div class="outline-text-4" id="text-36-2-6">
<dl class="org-dl">
<dt><code>C-space</code></dt><dd>start region, then move cursor</dd>
<dt><code>C-x h</code></dt><dd>copy all in buffer</dd>
<dt><code>C-g</code></dt><dd>quit selection</dd>
</dl>
</div>
</div>

<div id="outline-container-orgf5ef7fc" class="outline-4">
<h4 id="orgf5ef7fc"><span class="section-number-4">36.2.7</span> Copy &amp; Paste</h4>
<div class="outline-text-4" id="text-36-2-7">
<dl class="org-dl">
<dt>C-w</dt><dd>cut</dd>
<dt>M-w</dt><dd>copy without cut (copy to kill-ring, shared with other buffers)</dd>
<dt>C-y</dt><dd>yank (paste)</dd>
</dl>
</div>
</div>

<div id="outline-container-org725cdd3" class="outline-4">
<h4 id="org725cdd3"><span class="section-number-4">36.2.8</span> Search</h4>
<div class="outline-text-4" id="text-36-2-8">
<dl class="org-dl">
<dt>C-s</dt><dd>search by pure text, next search result. If search string contains no uppercase, then it's a case-insensitive search</dd>
<dt>C-r</dt><dd>previous search</dd>
<dt>M-C-s</dt><dd>regex search</dd>
<dt>M-C-r</dt><dd>regex reverse search</dd>
<dt>M-s o</dt><dd>list-matching-lines regex and show matching lines</dd>
<dt>C-s C-s or C-r C-r</dt><dd>search again</dd>
<dt>Regex escape</dt><dd><code>[ ] \ + * ? .</code></dd>
<dt>Regex case-sensitive</dt><dd>case-sensitive is auto enabled when text contains uppercase</dd>
<dt>(no term)</dt><dd><a href="http://ergoemacs.org/emacs/emacs_regex.html">Emacs Regex</a></dd>
</dl>
</div>
</div>

<div id="outline-container-org7aa6fc8" class="outline-4">
<h4 id="org7aa6fc8"><span class="section-number-4">36.2.9</span> Headline <a id="org033a047">emacs:headline</a></h4>
<div class="outline-text-4" id="text-36-2-9">
<dl class="org-dl">
<dt>C-u TAB</dt><dd>Global tree fold/unfold</dd>
<dt>C-u C-u C-u TAB</dt><dd>Show all</dd>
<dt>C-c C-n</dt><dd>Next heading</dd>
<dt>C-c C-p</dt><dd>Previous heading</dd>
<dt>C-c C-f</dt><dd>Next heading same level</dd>
<dt>C-c C-b</dt><dd>Previous heading same level</dd>
<dt>C-c C-u</dt><dd>Backward to higher level heading</dd>
<dt>M-S-&lt;right&gt;</dt><dd>Increase heading level of an item and its child items</dd>
<dt>M-S-&lt;left&gt;</dt><dd>Same as above but decrease</dd>
<dt>M-&lt;right&gt;/&lt;left&gt;</dt><dd>Decrease/increase level of a parent item only</dd>
<dt>S-&lt;TAB&gt;</dt><dd>In table, go to previous cell. In other places, global fold/unfold</dd>
<dt>C-x n s</dt><dd>Work on one section</dd>
<dt>C-x n w</dt><dd>Back to outline</dd>
<dt>C-c C-j</dt><dd>jump to different heading. C-g to exit and return to the current position. up/down to move headline, <code>/</code> sparse-tree search</dd>
<dt>M-&lt;RET&gt; or C-&lt;RET&gt;</dt><dd>insert heading</dd>
</dl>
</div>

<div id="outline-container-orgee1edab" class="outline-5">
<h5 id="orgee1edab"><span class="section-number-5">36.2.9.1</span> Drawer</h5>
<div class="outline-text-5" id="text-36-2-9-1">
<p>
C-c C-x d :: Create a drawer
</p>

<p>
This is inside the drawer
</p>
</div>
</div>
</div>

<div id="outline-container-org9ca7356" class="outline-4">
<h4 id="org9ca7356"><span class="section-number-4">36.2.10</span> Code Block</h4>
<div class="outline-text-4" id="text-36-2-10">
<p>
Create a code block: <code>&lt;e</code> and <code>Tab</code>
Inside a code block, <code>C-c + '</code> to go to a new major-mode edit buffer to edit the code, <code>C-x C-s</code> saves the buffer and updates the contents of the Org buffer. <code>C-c + '</code> again to exit.
</p>

<p>
Inline code block
</p>
<pre class="example">
src_&lt;language&gt;[&lt;header arguments&gt;]{&lt;body&gt;}
</pre>



<p>
<code class="src src-html">&lt;<span style="color: #00ede1; font-weight: bold;">el</span>&gt;&lt;/<span style="color: #00ede1; font-weight: bold;">el</span>&gt;</code>
</p>

<p>
<code class="src src-haskell">fac 5</code>
</p>

<p>
<a href="https://orgmode.org/worg/org-contrib/babel/languages.html">All languages</a> :: html xml css sass js makefile java sh sql sqlite ruby python perl C C++ matlab org dns
</p>

<p>
Find modes on <a href="https://github.com/emacs-mirror/emacs/find/master">GitHub</a> <code>-mode</code> to *-mode.el files
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #74af68;">#</span><span style="color: #74af68;">!/bin/</span><span style="color: #ffad29; font-weight: bold;">bash</span>
<span style="color: #23d7d7;">echo</span> html
</pre>
</div>

<p>
When in *-mode edit buffer:
</p>
<ul class="org-ul">
<li><a href="#orga3ceb6e">emacs:m-x:delete-trailing-whitespace</a></li>
<li><a href="#orgfcfd3b3">emacs:m-x:indent-region</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgf0a3c24" class="outline-4">
<h4 id="orgf0a3c24"><span class="section-number-4">36.2.11</span> Symbol and Escape <a id="org4606c86">emacs:escape</a></h4>
<div class="outline-text-4" id="text-36-2-11">
<pre class="example">
\vert{}
which escapes |
</pre>

<p>
<a href="http://orgmode.org/worg/org-symbols.html">Table of Symbols</a>
</p>

<p>
Insert a tab character <code>Ctrl+q tab</code>
</p>
</div>
</div>

<div id="outline-container-orgf22454e" class="outline-4">
<h4 id="orgf22454e"><span class="section-number-4">36.2.12</span> <code>TODO</code></h4>
<div class="outline-text-4" id="text-36-2-12">
<pre class="example">
** TODO
</pre>
<p>
S-left/right :: Cycle through <b>TODO</b>, <b>DONE</b> and empty.
</p>
</div>
</div>

<div id="outline-container-org89a8a90" class="outline-4">
<h4 id="org89a8a90"><span class="section-number-4">36.2.13</span> Sparse Tree, Search</h4>
<div class="outline-text-4" id="text-36-2-13">
<p>
C-c / r :: Search regex, C-c C-c to quit.
M-g M-n :: Next match
M-g M-p :: Previous match
</p>
</div>
</div>

<div id="outline-container-org06555a3" class="outline-4">
<h4 id="org06555a3"><span class="section-number-4">36.2.14</span> Link <a id="org58a3bc7">emacs:link</a></h4>
<div class="outline-text-4" id="text-36-2-14">
<p>
<a href="http://orgmode.org/manual/Link-format.html#Link-format">Here's description of the link</a>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">C-c C-l</th>
<th scope="col" class="org-left">add or modify link</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">C-c &amp;</td>
<td class="org-left">Go back to previous position</td>
</tr>

<tr>
<td class="org-left">C-c C-c</td>
<td class="org-left">Update radio targets</td>
</tr>
</tbody>
</table>

<pre class="example">
[[My Target]]
By defalt, it leads to a text search
</pre>

<pre class="example">
[[Link]] "Link" matches an exact headline
</pre>

<pre class="example">
Something is referred to later in the file &lt;&lt;internal target&gt;&gt;
[[internal target]] will go to the target
</pre>

<table id="org9cd852e" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">a</th>
<th scope="col" class="org-left">table</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">of</td>
<td class="org-left">four cells</td>
</tr>
</tbody>
</table>

<pre class="example">
Go to a named section [[Table One]]
</pre>

<p>
<a id="orgb626d1d">emacs:radio</a>
</p>
<pre class="example">
&lt;&lt;&lt;Radio target&gt;&gt;&gt;
This causes each occurence of 'Radio target' in normal text to become activated as a link
Emacs only update radio targets when the file is first loaded. To manual update, C-c C-c
</pre>
</div>
</div>

<div id="outline-container-orgbe534d1" class="outline-4">
<h4 id="orgbe534d1"><span class="section-number-4">36.2.15</span> Superscript and Subscript</h4>
<div class="outline-text-4" id="text-36-2-15">
<p>
By default <code>Sometext_subscript</code> and <code>Sometext^superscript</code> shows sub/super scripts when .org is exported.
</p>

<p>
Have this setting: Org &gt; Customize &gt; Browse Org Group &gt; Group Org Export &gt; Group Org Export General &gt; Option Org Export With Sub Superscripts
</p>

<p>
After that, to show sub/super scripts, type these <code>Sometext_{subscript}</code> <code>Sometext^notsuperscript^{superscript}</code>
</p>
</div>
</div>

<div id="outline-container-org388cc99" class="outline-4">
<h4 id="org388cc99"><span class="section-number-4">36.2.16</span> dot</h4>
<div class="outline-text-4" id="text-36-2-16">
<p>
Install <a href="https://graphviz.gitlab.io/download/">Graphviz using .msi</a>, copy <code>C:\Program Files (x86)\Graphviz2.38\bin</code> to PATH and make sure <code>dot</code> or <code>dot.exe</code> can be run.
</p>

<p>
And add this to .emacs
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(org-babel-do-load-languages
'org-babel-load-languages
'((dot . t)))
</pre>
</div>

<p>
To compile <code>C-c C-c</code> and display inline image <code>C-c C-x C-v</code>
</p>


<div class="figure">
<p><img src="images/dot_success.png" alt="dot_success.png" />
</p>
</div>

<p>
<a href="https://www.graphviz.org/doc/info/attrs.html">Graphviz Node, Edge and Graph Attributes</a>
</p>
<dl class="org-dl">
<dt>rankdir</dt><dd>default layout is from top to bottom. LR is left to right</dd>
<dt>splines</dt><dd>how edges look
<dl class="org-dl">
<dt><code>none</code> or <code>""</code></dt><dd>no edges</dd>
<dt><code>false</code> or <code>line</code></dt><dd>edges can go through nodes</dd>
<dt><code>true</code> or <code>spline</code></dt><dd>edges are routed around nodes (splines) and edges can be curved in order to avoid going through nodes</dd>
<dt><code>curved</code></dt><dd>edges are curved arcs</dd>
<dt><code>polylines</code></dt><dd>edges are one or multiple straight lines connected</dd>
<dt><code>ortho</code></dt><dd>edges are routed with 2 perpendicular straight lines</dd>
</dl></dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org0639215" class="outline-3">
<h3 id="org0639215"><span class="section-number-3">36.3</span> Regex</h3>
<div class="outline-text-3" id="text-36-3">
<p>
<a href="https://regexr.com/">https://regexr.com/</a> <a href="https://regexr.com/">https://regexr.com/</a>
</p>
</div>
</div>

<div id="outline-container-org92ba2be" class="outline-3">
<h3 id="org92ba2be"><span class="section-number-3">36.4</span> <a href="https://developers.google.com/web/updates/">Chrome</a></h3>
<div class="outline-text-3" id="text-36-4">
</div>
<div id="outline-container-orgde445ab" class="outline-4">
<h4 id="orgde445ab"><span class="section-number-4">36.4.1</span> Command Menu (DevTools &gt; C+S P)</h4>
<div class="outline-text-4" id="text-36-4-1">
</div>
<div id="outline-container-org4bf5002" class="outline-5">
<h5 id="org4bf5002"><span class="section-number-5">36.4.1.1</span> Coverage (Show coverage)</h5>
</div>
</div>
<div id="outline-container-orgcc4d305" class="outline-4">
<h4 id="orgcc4d305"><span class="section-number-4">36.4.2</span> Console</h4>
<div class="outline-text-4" id="text-36-4-2">
</div>
<div id="outline-container-orgdf3c7b9" class="outline-5">
<h5 id="orgdf3c7b9"><span class="section-number-5">36.4.2.1</span> Console Commands</h5>
<div class="outline-text-5" id="text-36-4-2-1">
<p>
<a href="https://developers.google.com/web/tools/chrome-devtools/console/console-reference">https://developers.google.com/web/tools/chrome-devtools/console/console-reference</a>
</p>

<p>
console.count
</p>
<pre class="example">
function login(user) {
    console.count("Login called for user " + user);
}

users = [ // by last name since we have too many Pauls.
    'Irish',
    'Bakaus',
    'Kinlan'
];

users.forEach(function(element, index, array) {
    login(element);
});

login(users[0]);
</pre>

<p>
console.dir(document.body.firstElementChild) :: Formats DOM elements as JavaScript objects
</p>

<p>
Show string only when the first parameter evaluates to false
</p>
<pre class="example">
console.assert(list.childNodes.length &lt;= 500, "Node count is &gt; 500");
</pre>

<p>
Specifiers
</p>
<pre class="example">
//Style console output with CSS
console.log("%cThis will be formatted with large, blue text", "color: blue; font-size: x-large");

// format a value as string
console.log("%s has %d points", "Sam", 100);

%i or %d for integer
%f float
%o :: expandable DOM element as seen in Elements panel
%O :: Formats the value as an expandable JavaScript object
</pre>

<pre class="example">
console.group("Authenticating user '%s'", user);
console.group("Authorizing user '%s'", user);
console.log("User '%s' was authorized.", user);
console.groupEnd();
console.groupEnd();
</pre>

<p>
console.warn(), console.info()
</p>

<p>
console.trace(object)
</p>
</div>
</div>

<div id="outline-container-orga700842" class="outline-5">
<h5 id="orga700842"><span class="section-number-5">36.4.2.2</span> Command Line API</h5>
<div class="outline-text-5" id="text-36-4-2-2">
<p>
<a href="https://developers.google.com/web/tools/chrome-devtools/console/command-line-reference">https://developers.google.com/web/tools/chrome-devtools/console/command-line-reference</a>
</p>

<p>
$('code') <i>/ Returns the first code element in the document.
$$('figure') /</i> Returns an array of all figure elements in the document.
$x('html/body/p') // Returns an array of all paragraphs in the document body. <a href="#orgc0cbc97">XPath</a>
</p>

<p>
$('[data-target="inspecting-dom-elements-example"]')
inspect($_)
</p>

<p>
$0, $1, $2, $3, $4 :: recently selected
$_ :: last evaluated expression
</p>

<p>
monitorEvents(document.body, "click");
</p>
</div>
</div>

<div id="outline-container-org833eaa6" class="outline-5">
<h5 id="org833eaa6"><span class="section-number-5">36.4.2.3</span> Inject CSS file in Console</h5>
<div class="outline-text-5" id="text-36-4-2-3">
<p>
<code>jQuery(document.head).append('&lt;link rel</code>"stylesheet" href="path_to_my_css"&gt;');=
</p>
</div>
</div>

<div id="outline-container-org82dc1f2" class="outline-5">
<h5 id="org82dc1f2"><span class="section-number-5">36.4.2.4</span> Offload CSS file in Console</h5>
<div class="outline-text-5" id="text-36-4-2-4">
<pre class="example">
document.styleSheets[0].disabled = true;

$0.disabled = true; // select the &lt;link&gt; or &lt;style&gt; element in Elements and then run in Console
</pre>
</div>
</div>
</div>

<div id="outline-container-org8371a46" class="outline-4">
<h4 id="org8371a46"><span class="section-number-4">36.4.3</span> Capture full size screenshot - Mobile View</h4>
<div class="outline-text-4" id="text-36-4-3">
<p>
F12, mobile view, click on the top right tool button of the main website window
</p>
</div>
</div>

<div id="outline-container-org2cef034" class="outline-4">
<h4 id="org2cef034"><span class="section-number-4">36.4.4</span> Block Request or Domain - Network</h4>
<div class="outline-text-4" id="text-36-4-4">
<p>
Block a certain file request or any files from a domain. Network &gt; right click on a file and Block Request
</p>
</div>
</div>

<div id="outline-container-org110bc3f" class="outline-4">
<h4 id="org110bc3f"><span class="section-number-4">36.4.5</span> Get all events of an element in Console</h4>
<div class="outline-text-4" id="text-36-4-5">
<p>
getEventListeners($0);
</p>
</div>
</div>

<div id="outline-container-org519057c" class="outline-4">
<h4 id="org519057c"><span class="section-number-4">36.4.6</span> <a href="#orgc0cbc97">XPath</a> <a id="orgc0cbc97">XPath</a></h4>
<div class="outline-text-4" id="text-36-4-6">
<p>
In DevTools &gt; Elements, search using <a href="#orgc0cbc97">Xpath</a>, e.g. find all h4 element //h4
<a href="http://www.freeformatter.com/xpath-tester.html">xPath Online tools</a>
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><i>nodename</i></td>
<td class="org-left">select all nodes with name</td>
</tr>

<tr>
<td class="org-left"><code>/</code></td>
<td class="org-left">select from the root node</td>
</tr>

<tr>
<td class="org-left">//</td>
<td class="org-left">select nodes from the current node that match the select no matter where they are</td>
</tr>

<tr>
<td class="org-left">.</td>
<td class="org-left">select the current node</td>
</tr>

<tr>
<td class="org-left">..</td>
<td class="org-left">select the parent of the current node</td>
</tr>

<tr>
<td class="org-left">@</td>
<td class="org-left">select attribute</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">store/book[1]</td>
<td class="org-left">first book element</td>
</tr>

<tr>
<td class="org-left">store/book[last()]</td>
<td class="org-left">last book element</td>
</tr>

<tr>
<td class="org-left">store/book[last()-1]</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">store/book[position()&lt;3]</td>
<td class="org-left">first 2 book elements</td>
</tr>

<tr>
<td class="org-left">store/book[price&gt;35.00]</td>
<td class="org-left">all book elements that have price element with a value greater than 35.00</td>
</tr>

<tr>
<td class="org-left">store/book/title[@lang]</td>
<td class="org-left">lang attributes of all title elements in book elements</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>*</code></td>
<td class="org-left">match any element node</td>
</tr>

<tr>
<td class="org-left">@*</td>
<td class="org-left">match any attribute node. Have at least one attribute</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Select multiple paths
//book/title | //book/price
</p>
</div>

<div id="outline-container-orgb8f7c6b" class="outline-5">
<h5 id="orgb8f7c6b"><span class="section-number-5">36.4.6.1</span> Axis Syntax</h5>
<div class="outline-text-5" id="text-36-4-6-1">
<p>
axisname::nodetest[predicate]
</p>

<p>
axisname is the relationship name
</p>
<ul class="org-ul">
<li>self</li>
<li>child</li>
</ul>
<p>
etc.
</p>

<p>
nodetest is a node name to test
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">child::book</td>
<td class="org-left">book nodes that are children of the current node</td>
</tr>

<tr>
<td class="org-left">attribute::lang</td>
<td class="org-left">lang attribute of the current node</td>
</tr>

<tr>
<td class="org-left">child::*</td>
<td class="org-left">children elements of the current node</td>
</tr>

<tr>
<td class="org-left">child::text()</td>
<td class="org-left">text node of the current node</td>
</tr>

<tr>
<td class="org-left">child::node()</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org7738d90" class="outline-5">
<h5 id="org7738d90"><span class="section-number-5">36.4.6.2</span> <a href="#orgc0cbc97">XPath</a> Operators</h5>
<div class="outline-text-5" id="text-36-4-6-2">
<ul class="org-ul">
<li>- * div</li>
</ul>
<p>
mod (division remainder) :: 5 mod 2 
<code>|</code> combine 2 node-sets
= != &lt; &lt;= &gt; &gt;=
or :: price=9.8 or price=9.7
and
</p>
</div>
</div>
</div>

<div id="outline-container-org0b2dff8" class="outline-4">
<h4 id="org0b2dff8"><span class="section-number-4">36.4.7</span> Turn on DevTools Experiment</h4>
<div class="outline-text-4" id="text-36-4-7">
<p>
chrome://flags &gt; search a Feature, enable and relaunch
</p>

<p>
Developer Tools experiments :: Experiments under DevTools &gt; Settings
Experimental JavaScript
</p>
</div>
</div>

<div id="outline-container-orgc1f2da5" class="outline-4">
<h4 id="orgc1f2da5"><span class="section-number-4">36.4.8</span> Elements</h4>
<div class="outline-text-4" id="text-36-4-8">
</div>
<div id="outline-container-org59378ea" class="outline-5">
<h5 id="org59378ea"><span class="section-number-5">36.4.8.1</span> Styles</h5>
<div class="outline-text-5" id="text-36-4-8-1">
<p>
Click on color and expand Contrast Ratio produces 1 line. Choose color below the line in order to make it AA or AAA compliant.
</p>
</div>
</div>

<div id="outline-container-org1e1f68f" class="outline-5">
<h5 id="org1e1f68f"><span class="section-number-5">36.4.8.2</span> Accessibility</h5>
</div>
</div>
<div id="outline-container-org2eb9c0b" class="outline-4">
<h4 id="org2eb9c0b"><span class="section-number-4">36.4.9</span> Audits</h4>
<div class="outline-text-4" id="text-36-4-9">
<p>
Run checks using Light House
</p>
</div>
</div>

<div id="outline-container-org11d1248" class="outline-4">
<h4 id="org11d1248"><span class="section-number-4">36.4.10</span> Sources</h4>
<div class="outline-text-4" id="text-36-4-10">
</div>
<div id="outline-container-org791bc42" class="outline-5">
<h5 id="org791bc42"><span class="section-number-5">36.4.10.1</span> Local Overrides</h5>
<div class="outline-text-5" id="text-36-4-10-1">
<p>
Specify a directory where DevTools should save changes. This directory will contain all changes across different website domains.
DevTools &gt; Sources &gt; Overrides
</p>

<p>
Select folder &gt; Allow &gt; Enable Local Overrides
</p>

<p>
This only works to override styles that are loaded by a CSS file and you can override the CSS files.
</p>
</div>
</div>

<div id="outline-container-org9f96474" class="outline-5">
<h5 id="org9f96474"><span class="section-number-5">36.4.10.2</span> Event Listener Breakpoints and Blackboxing</h5>
<div class="outline-text-5" id="text-36-4-10-2">
<p>
Mouse &gt; click
Say it jumps jquery.js at function abc at line 1000. Find this under Call Stack, right click and Blackbox script. jquery.js will be ignored.
</p>

<p>
Right click again to stop blackboxing, To see all blackboxed scripts:
DevTools &gt; Settings &gt; Blackboxing
<a href="https://developer.chrome.com/devtools/docs/blackboxing">https://developer.chrome.com/devtools/docs/blackboxing</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org8194711" class="outline-4">
<h4 id="org8194711"><span class="section-number-4">36.4.11</span> Extension</h4>
<div class="outline-text-4" id="text-36-4-11">
</div>
<div id="outline-container-org1d18a7d" class="outline-5">
<h5 id="org1d18a7d"><span class="section-number-5">36.4.11.1</span> Google Tag Assistant</h5>
</div>
<div id="outline-container-org110082a" class="outline-5">
<h5 id="org110082a"><span class="section-number-5">36.4.11.2</span> <a href="https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop?utm_source=chrome-app-launcher-info-dialog">Postman</a></h5>
<div class="outline-text-5" id="text-36-4-11-2">
<p>
Fire GET and POST requests.
For POST request, insert data in Body and change Header &gt; Content-Type to application/x-www-form-urlencoded; charset=UTF-8
</p>
</div>
</div>

<div id="outline-container-org17822bf" class="outline-5">
<h5 id="org17822bf"><span class="section-number-5">36.4.11.3</span> <a href="https://chrome.google.com/webstore/detail/save-page-we/dhhpefjklgkmgeafimnjhojgjamoafof?utm_source=chrome-app-launcher-info-dialog">Save Page WE</a></h5>
<div class="outline-text-5" id="text-36-4-11-3">
<p>
Chrome's default save page as HTML has some limitations such as not all images are downloaded.
This saves all content in one HTML file.
</p>

<p>
Font file is not converted but you can fix the url() manually.
</p>

<p>
Turn off <a href="#org53bdeb3">chrome:cors</a>
</p>
</div>
</div>

<div id="outline-container-org951e9bc" class="outline-5">
<h5 id="org951e9bc"><span class="section-number-5">36.4.11.4</span> <a href="https://chrome.google.com/webstore/detail/ignore-x-frame-headers/gleekbfjekiniecknbkamfmkohkpodhe">Ignore X-Frame headers</a></h5>
<div class="outline-text-5" id="text-36-4-11-4">
<p>
Ignore headers X-Frame-x e.g. X-Frame-Options
</p>
</div>
</div>

<div id="outline-container-orgb8d1d3c" class="outline-5">
<h5 id="orgb8d1d3c"><span class="section-number-5">36.4.11.5</span> <a href="https://chrome.google.com/webstore/detail/requestly-redirect-url-mo/mdnleldcmiljblolnjhpnblkcekpdkpa">Requestly</a></h5>
<div class="outline-text-5" id="text-36-4-11-5">
<p>
Modify http request and response headers
</p>
</div>
</div>

<div id="outline-container-org9c98907" class="outline-5">
<h5 id="org9c98907"><span class="section-number-5">36.4.11.6</span> <a href="https://chrome.google.com/webstore/detail/axe/lhdoppojpmngadmnindnejefpokejbdd">aXe</a></h5>
<div class="outline-text-5" id="text-36-4-11-6">
<p>
Accessibility testing. Node.js <a href="https://www.axe-core.org/">https://www.axe-core.org/</a>
</p>
</div>
</div>

<div id="outline-container-orga91457d" class="outline-5">
<h5 id="orga91457d"><span class="section-number-5">36.4.11.7</span> <a href="https://chrome.google.com/webstore/detail/jquery-audit/dhhnpbajdcgdmbbcoakfhmfgmemlncjg">jQuery Audit</a></h5>
<div class="outline-text-5" id="text-36-4-11-7">
<p>
Find function that attaches events to a selected element. Element &gt; jQuery Audit
Expand the Events and RC on handler to Reveal function in source.
</p>
</div>
</div>

<div id="outline-container-orga58077a" class="outline-5">
<h5 id="orga58077a"><span class="section-number-5">36.4.11.8</span> <a href="https://chrome.google.com/webstore/detail/web-server-for-chrome/ofhbbkphhbklhfoeikjpcbhemlocgigb?hl=en">Web Server for Chrome</a></h5>
</div>
<div id="outline-container-orga122d64" class="outline-5">
<h5 id="orga122d64"><span class="section-number-5">36.4.11.9</span> Hosts file</h5>
<div class="outline-text-5" id="text-36-4-11-9">
<p>
<a href="https://chrome.google.com/webstore/detail/host-switch-plus/bopepoejgapmihklfepohbilpkcdoaeo">Host Switch Plus</a>
<a href="https://chrome.google.com/webstore/detail/virtual-hosts/aiehidpclglccialeifedhajckcpedom">Virtual Hosts</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org0eaf9d1" class="outline-4">
<h4 id="org0eaf9d1"><span class="section-number-4">36.4.12</span> Network</h4>
<div class="outline-text-4" id="text-36-4-12">
</div>
<div id="outline-container-orgcfe43a8" class="outline-5">
<h5 id="orgcfe43a8"><span class="section-number-5">36.4.12.1</span> Filter Post Requests</h5>
<div class="outline-text-5" id="text-36-4-12-1">
<p>
method:POST
</p>
</div>
</div>

<div id="outline-container-org383ca60" class="outline-5">
<h5 id="org383ca60"><span class="section-number-5">36.4.12.2</span> Preserve log</h5>
<div class="outline-text-5" id="text-36-4-12-2">
<p>
Preserve all requests log even though the page URL is changed (e.g. after the Post request, URL changes)
</p>
</div>
</div>

<div id="outline-container-org68df484" class="outline-5">
<h5 id="org68df484"><span class="section-number-5">36.4.12.3</span> Capture Screeshots</h5>
<div class="outline-text-5" id="text-36-4-12-3">
<p>
Double click to show image and single click to review timeline
</p>
</div>
</div>

<div id="outline-container-orgd5a0db9" class="outline-5">
<h5 id="orgd5a0db9"><span class="section-number-5">36.4.12.4</span> Network Performance</h5>
<div class="outline-text-5" id="text-36-4-12-4">
<p>
Blue line is DOMContentLoaded and red line is load
</p>

<p>
In Waterfall for a request
</p>
<dl class="org-dl">
<dt>Queueing</dt><dd>The browser queues requests when:
<ul class="org-ul">
<li>There are higher priority requests.</li>
<li>There are already six TCP connections open for this origin, which is the limit. Applies to HTTP/1.0 and HTTP/1.1 only.</li>
<li>The browser is briefly allocating space in the disk cache</li>
</ul></dd>
<dt>Stalled</dt><dd>The request could be stalled for any of the reasons described in Queueing.</dd>
<dt>DNS Lookup</dt><dd>The browser is resolving the request's IP address.</dd>
<dt>Proxy negotiation</dt><dd>The browser is negotiating the request with a proxy server.</dd>
<dt>(no term)</dt><dd>Request sent. The request is being sent.</dd>
<dt>(no term)</dt><dd>ServiceWorker Preparation. The browser is starting up the service worker.</dd>
<dt>(no term)</dt><dd>Request to ServiceWorker. The request is being sent to the service worker.</dd>

<dt>(no term)</dt><dd>Waiting (TTFB). The browser is waiting for the first byte of a response. TTFB stands for Time To First Byte. This timing includes 1 round trip of latency and the time the server took to prepare the response.</dd>

<dt>(no term)</dt><dd>Content Download. The browser is receiving the response.</dd>
<dt>(no term)</dt><dd>Receiving Push. The browser is receiving data for this response via HTTP/2 Server Push.</dd>
<dt>(no term)</dt><dd>Reading Push. The browser is reading the local data previously received.</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org5198580" class="outline-4">
<h4 id="org5198580"><span class="section-number-4">36.4.13</span> Performance</h4>
<div class="outline-text-4" id="text-36-4-13">
<p>
<a href="https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/reference">https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/reference</a>
The first chart is called Overview and sections follow
</p>

<p>
Select a section and use W S A D to move the zoom in, move left, zoom out and move right in Overview. Selected section or item will be outlined in blue.
</p>

<p>
Ctrl+F to search an activity :: ^E.* in regex e.g. Evaluate Script&#x2026; Shift+Enter to select the previous and Enter for the next.
</p>

<p>
Darker yellow is scripting activity :: Event, Function Call, Evaluate Script, Compile Script, etc.
Purple event is rendering activity :: Recalculate Style, Layout, Update Layer Tree, etc.
</p>

<p>
Under each section, the chart is called flame chart. Root activities are the ones at the top of Main section chart and they are activities that cause the browser to do some work.
</p>

<p>
Call Tree tab shows which root activities cause the most work during the selected portion of a recording (range in Overview)
</p>
<dl class="org-dl">
<dt>Activity</dt><dd>root activities followed by their children</dd>
<dt>Self Time</dt><dd>the time directly spent in that activity.</dd>
<dt>Total Time</dt><dd>the time spent in that activity or any of its children</dd>
<dt>Show Heaviest Stack</dt><dd>shows which children of the selected activity took the longest time to execute</dd>
</dl>

<p>
Bottom-Up tab shows which activities directly took up the most time in aggregate
</p>

<p>
Event Log tag views activites in the order in which they occurred during the recording
</p>

<p>
Network Section
</p>
<ul class="org-ul">
<li>HTML: Blue</li>
<li>CSS: Purple</li>
<li>JS: Yellow</li>
<li>Images: Green</li>
</ul>
</div>
</div>

<div id="outline-container-org1441fd5" class="outline-4">
<h4 id="org1441fd5"><span class="section-number-4">36.4.14</span> Refresh Favicon</h4>
<div class="outline-text-4" id="text-36-4-14">
<p>
Delete files Favicons and Favicons-journal in this folder. It will remove all favicon cache
C:\Users\your_username\AppData\Local\Google\Chrome\User Data\Default
</p>
</div>
</div>

<div id="outline-container-org3681fff" class="outline-4">
<h4 id="org3681fff"><span class="section-number-4">36.4.15</span> Flush DNS Caches in Chrome</h4>
<div class="outline-text-4" id="text-36-4-15">
<p>
Even ipconfig /flushdns is run, Chrome still caches the DNS
Navigate to <code>chrome://net-internals/#dns</code> and press "Clear host cache" button
Or on the top right, down arrow &gt; Tools &gt; Clear Cache
</p>

<p>
Make sure bookmark has the right url. Say you bookmark abc.com as www.abc.com, if you type abc.com, Chrome will go to www.abc.com!
</p>

<p>
Also say before there was a DNS A record for www.abc.com to 1.2.3.4 which is an old IP. You remove it and set a CNAME for www.abc.com to abc.com, www.abc.com and <a href="https://www.abc.com">https://www.abc.com</a> will actually go to 1.2.3.4 which is not expected.
</p>

<p>
For more edge cases like above and in case of the local network DNS caches which you have no control of, set the network adapter to use 8.8.8.8 Google DNS.
</p>
</div>
</div>

<div id="outline-container-org97c4e71" class="outline-4">
<h4 id="org97c4e71"><span class="section-number-4">36.4.16</span> Flash Couldn't Load Plugin</h4>
<div class="outline-text-4" id="text-36-4-16">
<p>
Properites &gt; Security, give Full Control for Everyone in this folder
C:\Users\you\AppData\Local\Google\Chrome\User Data\PepperFlash\some.version.number
</p>
</div>
</div>

<div id="outline-container-org51ecefb" class="outline-4">
<h4 id="org51ecefb"><span class="section-number-4">36.4.17</span> Allow <a href="#org88b9832">XMLHttpRequest</a> for local files</h4>
<div class="outline-text-4" id="text-36-4-17">
<pre class="example">
chrome.exe --allow-file-access-from-files
</pre>
</div>
</div>

<div id="outline-container-org83dac83" class="outline-4">
<h4 id="org83dac83"><span class="section-number-4">36.4.18</span> Allow CORS locally</h4>
<div class="outline-text-4" id="text-36-4-18">
<p>
<a id="org53bdeb3">chrome:cors</a>
May need to close all Chrome instances. Mine opens the Chromium version not the regular Chrome.
Errors such as
</p>
<ul class="org-ul">
<li>Access to Font at 'yourwebsite.com' from origin 'e.g. localhost' has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin 'e.g. localhost' is therefore not allowed access.</li>
</ul>

<pre class="example">
chrome.exe --disable-web-security --user-data-dir
</pre>
</div>
</div>

<div id="outline-container-orgd7f9bf9" class="outline-4">
<h4 id="orgd7f9bf9"><span class="section-number-4">36.4.19</span> Remote Debug Android Devices</h4>
<div class="outline-text-4" id="text-36-4-19">
<p>
On Android, Settings &gt; System &gt; About phone &gt; tap Build number 7 times, then Sytem &gt; Developer options is enabled, enable USB debugging.
It allows Android Studio and other SDK tools to recognize your device when connected via USB, so you can use the debugger and other tools.
Other options on Android: <a href="https://developer.android.com/studio/debug/dev-options">https://developer.android.com/studio/debug/dev-options</a>
</p>

<p>
Connect Android to test machine &gt; DevTools &gt; 3 dots &gt; More tools &gt; Remote devices &gt; enable Discover USB devices.
</p>

<p>
When the phone is connected to a computer, on the phone say transfer photos and open the device on the computer so that the debug connection can be made.
</p>

<p>
On the phone, you may need to enable Always prompt when connecting to USB in Developer Options in order for prompting Use USB for Transfer Photos.
</p>

<p>
Don't let the phone screen turn off while debugging.
</p>
</div>
</div>
</div>

<div id="outline-container-orgc7001d0" class="outline-3">
<h3 id="orgc7001d0"><span class="section-number-3">36.5</span> Firefox</h3>
<div class="outline-text-3" id="text-36-5">
</div>
<div id="outline-container-org88f6d0d" class="outline-4">
<h4 id="org88f6d0d"><span class="section-number-4">36.5.1</span> Make all new windows open in Private Mode</h4>
<div class="outline-text-4" id="text-36-5-1">
<ul class="org-ul">
<li>Visit about:config and click "Yes, I'll be careful"</li>
<li>Search for <code>browser.privatebrowsing.autostart</code></li>
<li>Change value to True</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgd753382" class="outline-3">
<h3 id="orgd753382"><span class="section-number-3">36.6</span> BrowserStack</h3>
<div class="outline-text-3" id="text-36-6">
<p>
2018/03 Devices chosen for screenshots
</p>

<p>
iOS 
v8.3 iPad Mini 2, iPhone 6, iPhone 6 Plus
v7 iPhone 5S, iPad Mini
v6 iPad 3
</p>

<p>
Android
Samsung S5, S4
Google Nexus 9, 7
</p>

<p>
Win 10
Edge 15, IE 11, Chrome 50
</p>

<p>
Win 8.1
IE 11
</p>

<p>
Win 8
IE 10
</p>

<p>
Win 7
IE 11, 10
</p>

<p>
Mac OS X 10.11 El Capitan
Safari 9.1
Chrome 50
</p>

<p>
Mac OS X 10.10 Yosemite
Safari 8
Chrome 50
</p>

<p>
Mac OS X 10.9 Mavericks
Safari 7.1
</p>
</div>
</div>

<div id="outline-container-org3b81d2b" class="outline-3">
<h3 id="org3b81d2b"><span class="section-number-3">36.7</span> Device Market share, Metrics</h3>
<div class="outline-text-3" id="text-36-7">
</div>
<div id="outline-container-org32f717a" class="outline-4">
<h4 id="org32f717a"><span class="section-number-4">36.7.1</span> Browser</h4>
<div class="outline-text-4" id="text-36-7-1">
<p>
<a href="https://docs.google.com/spreadsheets/d/1iAOjjA-MG5nUiAidhP_MdmnM-kEbX1j6qpMI9zbKjCw/edit?usp=sharing">https://docs.google.com/spreadsheets/d/1iAOjjA-MG5nUiAidhP_MdmnM-kEbX1j6qpMI9zbKjCw/edit?usp=sharing</a>
</p>

<p>
<a href="https://data.apteligent.com/ios/">https://data.apteligent.com/ios/</a>
iOS Overview 2018/03
&lt;=6 .06%   (.06%)
&lt;=7 .30%   (.23%)
&lt;=8 .93%   (.63%)
&lt;=9  6.5%  (5.57%)
&lt;=10 20.5% (13.94%)
</p>

<p>
<a href="https://data.apteligent.com/android/">https://data.apteligent.com/android/</a>
Android overview 2018/03
&lt;=4 .41%
4.4 12%
</p>

<p>
<a href="https://netmarketshare.com">https://netmarketshare.com</a>
Browser Market Share across all devices 2018/03
Chrome 58.57%
Safari 17.15%
Firefox 6.61%
Internet Explorer 6.52%
Edge 2.11%
</p>

<p>
Internet Explorer Browser Market Share across all devices 2018/03
IE 11 71.76%
IE 10 5.5%
IE 9 6.81%
IE 8 12.19%
IE 7 1.56%
</p>

<p>
<a href="http://gs.statcounter.com/os-version-market-share/windows/desktop/worldwide">http://gs.statcounter.com/os-version-market-share/windows/desktop/worldwide</a>
Windows Desktop 2018/03
Win 10 38.29%
Win 7 44.58%
Win 8.1 9.21%
Win 8 2.5%
Win XP 4.47%
Win Vista .86%
</p>

<p>
<a href="http://gs.statcounter.com/macos-version-market-share/desktop/worldwide">http://gs.statcounter.com/macos-version-market-share/desktop/worldwide</a>
macOS Desktop overview 2018/03
High Sierra 10.13 14.75%
Sierra 10.12 39.27%
El Capitan 10.11 21.22%
Yosemite 10.10 14.12%
Mavericks 10.9 4.95%
Mountain Lion 10.8 &lt; 2.13%
Lion 10.7 &lt;2.13%
Snow Leopard 10.6 2.13%
</p>

<p>
Resolution Distribution
<a href="http://gs.statcounter.com/">http://gs.statcounter.com/</a>
</p>
</div>
</div>

<div id="outline-container-org5fad093" class="outline-4">
<h4 id="org5fad093"><span class="section-number-4">36.7.2</span> Device Metrics</h4>
<div class="outline-text-4" id="text-36-7-2">
<p>
Device Platform, Screen dimensions in in or cm, aspect ratio, dp or dip (density-indepenndent pixels), px (CSS pixels), density (px/dp)
<a href="https://material.io/tools/devices/">https://material.io/tools/devices/</a>
</p>

<p>
<a href="https://www.mydevice.io/">https://www.mydevice.io/</a> with newer devices
</p>
<ul class="org-ul">
<li>By popularity <a href="http://screensiz.es/">http://screensiz.es/</a></li>
<li>By release date <a href="http://viewportsizes.com/">http://viewportsizes.com/</a></li>
</ul>

<p>
Device and viewport size in JavaScript :: <a href="http://ryanve.com/lab/dimensions/">http://ryanve.com/lab/dimensions/</a>
</p>

<p>
iPhone X, iPhone 8 Plus, iPhone 7 Plus and iPhone 6s Plus has pixel density (scale factor) of 3x and others are 2x
</p>

<p>
Android devices :: <a href="https://developer.android.com/about/dashboards/">https://developer.android.com/about/dashboards/</a>
</p>
</div>
</div>

<div id="outline-container-orgfce12b1" class="outline-4">
<h4 id="orgfce12b1"><span class="section-number-4">36.7.3</span> Email Client Market Share</h4>
<div class="outline-text-4" id="text-36-7-3">
<p>
<a href="http://emailclientmarketshare.com/">http://emailclientmarketshare.com/</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org32f5d28" class="outline-3">
<h3 id="org32f5d28"><span class="section-number-3">36.8</span> Windows</h3>
<div class="outline-text-3" id="text-36-8">
</div>
<div id="outline-container-org6085ffa" class="outline-4">
<h4 id="org6085ffa"><span class="section-number-4">36.8.1</span> Win Shortcuts</h4>
<div class="outline-text-4" id="text-36-8-1">
<p>
<a href="https://support.microsoft.com/en-ie/help/12445/windows-keyboard-shortcuts">https://support.microsoft.com/en-ie/help/12445/windows-keyboard-shortcuts</a>
</p>

<p>
Win + Space : switch input language and keyboard layout
</p>

<p>
Win + Home : minimize all windows except the active one
</p>

<p>
Win + Shift + Up : stretch active window to top while maintaining width
Win + Shift + Left/Right : move active window to next monitor
</p>

<p>
Win + number : open the app # pinned to the taskbar. If the app is already running, switch to that app
Win + Shift + number : same as above but open a new instance
Win + Ctrl + Shift + number : same as above but open a new instance as Administrator 
Win + Ctrl + number : switch to the last active window of the app pinned to the taskbar
Win + Alt + number : same as above but open the Jump List
</p>

<p>
Win + T : cycle through apps on taskbar
</p>

<p>
Win + , : temp peak at desktop
</p>

<p>
Win + Pause : display System Properties
Win + i : open Windows Settings or go back to the current Windows Settings
</p>

<p>
Win + U : enlarge text on display, enable night light mode
</p>

<p>
Win + P : presentation (change monitors)
</p>

<p>
Win + K : Connect to other devices on network
</p>

<p>
Win + C : Open Cortana in listening mode. Off by default. Start &gt; Settings &gt; Cortana and turn on "Let Cortana listen for my commands when I press the Windows logo key + C"
</p>

<p>
Ctrl + R vs F5 : refresh
</p>

<p>
Alt + Left/Right : Go back/forward
</p>

<p>
Alt + Up : Go up one folder level in File Explorer
F3 : search in File Explorer
</p>

<p>
F6 : cycle through screen elements in a window or desktop
F10 : activate Menu in active app
</p>

<p>
Alt + Enter : display properties for the selected item (right click menu)
Alt + Spacebar : open shortcut menu like Close, Maximize, Minimize the active app
</p>

<p>
Shift + F10 : display shortcut menu for the selected item
</p>

<p>
Alt + Esc : cycle through apps in the order in which they were opened
</p>

<p>
Ctrl + F4 vs Alt + F4 : close current document while the latter closes the whole app
</p>

<p>
Ctrl + D vs Shift + delete : delete and move it to recycle bin vs permanent delete
</p>

<p>
Ctrl + Y vs Ctrl + Z : Redo and undo
</p>

<p>
Win + . : display Emoji
Ctrl + Left/Right : move cursor to the start or end of the next word
Ctrl + Up/Down : move cursor to the prev/next paragraph
</p>

<p>
Ctrl + arrow keys : resize Start menu when it's open
</p>
</div>
</div>

<div id="outline-container-org90452ff" class="outline-4">
<h4 id="org90452ff"><span class="section-number-4">36.8.2</span> Win 7</h4>
<div class="outline-text-4" id="text-36-8-2">
<p>
Install KB3138612 and KB3145739 to boost Windows Update
</p>
</div>
</div>

<div id="outline-container-orgbd947ee" class="outline-4">
<h4 id="orgbd947ee"><span class="section-number-4">36.8.3</span> Win 10</h4>
<div class="outline-text-4" id="text-36-8-3">
</div>
<div id="outline-container-org06a01ba" class="outline-5">
<h5 id="org06a01ba"><span class="section-number-5">36.8.3.1</span> Boot to Safe Mode with Boot Options Menu</h5>
<div class="outline-text-5" id="text-36-8-3-1">
<p>
Start Menu &gt; Power &gt; hold Shift and click Restart
Or use command line where you need to wait 1 minute <code>shutdown.exe /r /o</code>
</p>
</div>
</div>

<div id="outline-container-org8b889b5" class="outline-5">
<h5 id="org8b889b5"><span class="section-number-5">36.8.3.2</span> Install a printer loop in "Type a printer name"</h5>
<div class="outline-text-5" id="text-36-8-3-2">
<p>
Run <code>bcdedit.exe /set nointegritychecks on</code> and restart Windows 10 to disable the driver signature enforcement
Or Shift click on Power &gt; Restart, choose Troubleshoot &gt; Startup Settings &gt; Restart, after restart choose F7 to disable driver signature enforcement
</p>
</div>
</div>

<div id="outline-container-orgb2ab0c3" class="outline-5">
<h5 id="orgb2ab0c3"><span class="section-number-5">36.8.3.3</span> Windows version Run `winver`</h5>
<div class="outline-text-5" id="text-36-8-3-3">
<p>
Windows 10, version 1607 also known as the Anniversary Update
1703 Windows 10 Creators Update
</p>
</div>
</div>

<div id="outline-container-org1a42070" class="outline-5">
<h5 id="org1a42070"><span class="section-number-5">36.8.3.4</span> Upgrade from Windows 7</h5>
<div class="outline-text-5" id="text-36-8-3-4">
<p>
Make sure to do all critical and optional Windows Updates to ensure all drivers are up-to-date.
Use Lenovo System Update to update all drivers and BIOS.
If you experience black or blank screen during reboot to install Win 10, 
go to BIOS and change Display setting to Integrated (disable Discrete). Reboot and do the upgrade again.
</p>
</div>
</div>

<div id="outline-container-org9c648a4" class="outline-5">
<h5 id="org9c648a4"><span class="section-number-5">36.8.3.5</span> Ubuntu Bash on Windows</h5>
<div class="outline-text-5" id="text-36-8-3-5">
<p>
It's also called Windows Bash Shell
Turn on Developer Mode (it's not necessary any more)
<del>You need to have Win 10 Anniverary Update, Creators Update is recommended.</del>
<del>Make sure OS Build is not below 14393</del> 
<del>Win + X &gt; Settings &gt; System &gt; About</del>
<del>Win + X &gt; Settings &gt; Update and Security &gt; For developers &gt; Developer Mode</del>
</p>

<p>
Enable Windows Subsystem for Linux feature
Search Windows Features &gt; turn on Windows Subsystem for Linux (beta)
</p>

<p>
Win + S and type microsoft store, search linux and you will see different distros. Choose and install Ubuntu or a specific Ubuntu version. Then Win + S or go to Start &gt; Dashboard to find the one just installed. Follow the username and password setup:
</p>

<p>
<del>Reboot then open a command prompt, run <code>bash</code> and type <code>y</code> to install Ubuntu on Windows.</del>
<del>If you see "Unsupported console settings", right click on the cmd top bar &gt; Properties &gt; uncheck Use legacy console</del>
</p>

<p>
Create a UNIX user and password which have no relationship to Windows username and password
The user will be added to sudo group and will signed-in automatically every Bash instance.
</p>

<ul class="org-ul">
<li>Multiple distro bash can be installed
<ul class="org-ul">
<li>List all installed Linux environments <code>wslconfig /l</code></li>
<li>Set default Linux environment <code>wslconfig /setdefault &lt;name&gt;</code></li>
<li>Run one of these to directly open a specific Linux environment <code>ubuntu</code> <code>opensuse-42</code> <code>sles-12</code></li>
<li>Run a command on a specific Linux environment in PowerShell or Command Prompt <code>ubuntu -c apt-get moo</code></li>
<li>Run a command on the default Linux environment <code>bash -c "uname -a"</code></li>
<li></li>
</ul></li>

<li>Run <code>wsl</code> (or <code>bash</code> but deprecated) to get to Bash on Windows</li>

<li>Upgrade Linux Environment
<ul class="org-ul">
<li>Win + S, type bash or ubuntu, right click to uninstall. Choose Ubuntu in Microsoft Store to install the latest version</li>
<li><a href="https://www.howtogeek.com/261188/how-to-uninstall-or-reinstall-windows-10s-ubuntu-bash-shell/">Uninstall and install through commands</a></li>
</ul></li>

<li>Access Windows restricted folders</li>
</ul>
<p>
A Bash session with Windows admin privileges (run cmd as admin) may <code>cd /mnt/c/Users/Administrator</code>
which is a directory restricted by Windows.
While a Bash session without admin privileges would see Permission Denied.
</p>

<ul class="org-ul">
<li>Run Windows command (e.g. to open IE) <code>/mnt/c/Prgram\ Files\ \(x86\)/Internet\ Explorer/iexplore.exe</code></li>

<li>Ubuntu is installed at <code>%localappdata%\lxss\</code>, don't modify files using Windows tools and apps here!</li>

<li>Windows Drives, Files and File Permissions</li>
</ul>
<p>
Mount <i>mnt/c or /mnt/e is drive C: and E:. Store files in any mount and modify files using Windows or Linux apps.
It's not possible to modify file permissions under /mnt/(your_drive)</i>. scp from here to remote will have files/directories full permission! Change those on remote host after scp..
</p>
<ul class="org-ul">
<li>Remote files can be copied to any places other than /mnt/(your_drive). But don't open these files using Windows apps!</li>
</ul>
<p>
Permissions can be playe around in any places other than /mnt/(your_drive)
</p>
</div>
</div>

<div id="outline-container-org19786f9" class="outline-5">
<h5 id="org19786f9"><span class="section-number-5">36.8.3.6</span> Win 10 Build Update History</h5>
<div class="outline-text-5" id="text-36-8-3-6">
<p>
<a href="https://support.microsoft.com/en-us/help/4018124/windows-10-update-history">https://support.microsoft.com/en-us/help/4018124/windows-10-update-history</a>
</p>
</div>
</div>

<div id="outline-container-org295dfd5" class="outline-5">
<h5 id="org295dfd5"><span class="section-number-5">36.8.3.7</span> Startup Programs and Change HOMEDRIVE, HOMEPATH</h5>
<div class="outline-text-5" id="text-36-8-3-7">
<p>
Run <code>shell:startup</code> to find out the folder and copy shortucts of programs
That will return the startup folder for your user account only.
To find out the startup folder for all users, run <code>shell:common startup</code>
</p>

<p>
Active Directory might override some environment variables such as <code>HOMEDRIVE</code> <code>HOMEPATH</code>
Create a batch file C:\Windows\System32\userinit.cmd
</p>
<pre class="example">
@ECHO OFF
SET HOMEDRIVE=C:
SET HOMEPATH=\Users\%USERNAME%
SET HOMESHARE=\\localhost\C$\Users\%USERNAME%
@START C:\Windows\system32\userinit.exe
</pre>

<p>
Set the registry key <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</code> to 'C:\Windows\System32\userinit.cmd,'
Userinit default value is 'C:\Windows\system32\userinit.exe,'
</p>
</div>
</div>

<div id="outline-container-org8bb353e" class="outline-5">
<h5 id="org8bb353e"><span class="section-number-5">36.8.3.8</span> Remove a keyboard</h5>
<div class="outline-text-5" id="text-36-8-3-8">
<p>
Win+S &gt; Region &amp; language settings &gt; Select language and options &gt; remove the keyboard if you see it, if not add the same language/keyboard and remove it.
</p>

<p>
Set default keyboard :: Control Panel &gt; Language &gt; Advanced settings &gt; Override for default input method
</p>
</div>
</div>

<div id="outline-container-org67d4821" class="outline-5">
<h5 id="org67d4821"><span class="section-number-5">36.8.3.9</span> Move a window</h5>
<div class="outline-text-5" id="text-36-8-3-9">
<p>
Shift + right click on a tab in Task Bar and you should see Move.
</p>
</div>
</div>
</div>

<div id="outline-container-org74bfaed" class="outline-4">
<h4 id="org74bfaed"><span class="section-number-4">36.8.4</span> Win Server 2003</h4>
<div class="outline-text-4" id="text-36-8-4">
</div>
<div id="outline-container-orgd75ab5d" class="outline-5">
<h5 id="orgd75ab5d"><span class="section-number-5">36.8.4.1</span> System Information</h5>
<div class="outline-text-5" id="text-36-8-4-1">
<p>
run <code>winmsd.exe</code> and look for processor to find out the bit count
</p>
</div>
</div>

<div id="outline-container-orgdd504d2" class="outline-5">
<h5 id="orgdd504d2"><span class="section-number-5">36.8.4.2</span> Update_Windows.exe error</h5>
<div class="outline-text-5" id="text-36-8-4-2">
<p>
It consumes a lot of CPU and slows down the server. 2017/07/07. It's a hack..
<a href="https://answers.microsoft.com/en-us/windows/forum/windows_other-performance/server-2003-updatewindowsexe/974869b1-712c-438d-98ea-1dd935d359bc">Solution</a>: Go to C:\Windows\Debug, Tools &gt; Folder Options &gt; View &gt; Uncheck Hide Protected Operating System Files
The batch files are referring to bitcoin mining website.. 
Ctrl+Alt+Del &gt; Task Manager to stop Update_Windows.exe, then delete Update_Windows.exe, debug.exe, debug.bat, dll.bat
</p>
</div>
</div>
</div>

<div id="outline-container-org1eadb25" class="outline-4">
<h4 id="org1eadb25"><span class="section-number-4">36.8.5</span> PowerSehll</h4>
<div class="outline-text-4" id="text-36-8-5">
</div>
<div id="outline-container-org93d9765" class="outline-5">
<h5 id="org93d9765"><span class="section-number-5">36.8.5.1</span> Get-Command - gcm</h5>
<div class="outline-text-5" id="text-36-8-5-1">
<p>
Get manual of a command e.g. Select-String
</p>
<pre class="example">
gcm Select-String | select -expand definition
</pre>
</div>
</div>

<div id="outline-container-org686a5bd" class="outline-5">
<h5 id="org686a5bd"><span class="section-number-5">36.8.5.2</span> Search text in files</h5>
<div class="outline-text-5" id="text-36-8-5-2">
<pre class="example">
Get-ChildItem -Path "C:\path" -recurse | Select-String -Pattern "find me" | group path | select -Unique name

# dir is an alias of Get-ChildItem, sls is an alias of Select-String
# Since -Path and -Pattern are the default parameters in Get-ChildItem and Select-String, they can be omitted
Get-ChildItem "c:\path" -recurse | Select-String "find me" | group path | select -unique name

# current directory is ".\"

# Exclude some binary files by file extension so that it runs faster
dir ".\" -recurse -Exclude *jpg, *jpeg, *png, *pdf | sls "&lt;body&gt;" | group path | select -unique name

# also exclude a folder, ? is alias of where
dir ".\" -recurse -Exclude *jpg, *jpeg, *png, *pdf | ?{ $_.FullName -NotLike "C:\fullpath\.git\*" } | sls "&lt;body&gt;" | group path | select -unique name

# exclude multiple sub folders
dir ".\" -recurse -Exclude *jpg, *jpeg, *png, *pdf, *.mp4, *.ogv, *.webm, *pdf, *.png, *.svg, *.otf, *.eot, *.woff, *.ttf | ?{ $_.FullName -NotLike "C:\fullpath\.git\*" -and $_.FullName -NotLike "C:\fullpath\abc\*" } | sls "&lt;body&gt;" | group path | select -unique name

# test dir without sls first to make sure you have the right "where" clause
</pre>
</div>
</div>

<div id="outline-container-orgcd913a3" class="outline-5">
<h5 id="orgcd913a3"><span class="section-number-5">36.8.5.3</span> Create script file</h5>
<div class="outline-text-5" id="text-36-8-5-3">
<p>
create C:\test.ps1
Run it
</p>
<pre class="example">
&amp; "C:\test.ps1"
</pre>

<p>
Pass parameters, always use param in the first line in the relevant scope
</p>
<pre class="example">
---- Begin script foo.ps1 ----
param([string]$foo = "foo", [string]$bar = "bar")
Write-Host "Arg: $foo"
Write-Host "Arg: $bar"
----  End script foo.ps1  ----
PS C:\&gt; .\foo.ps1 -foo "foo" -bar "bar"
Arg: foo
Arg: bar
</pre>

<p>
Function
</p>
<pre class="example">
function foo([string]$foo = "foo", [string]$bar = "bar")
{
  Write-Host "Arg: $foo";
  Write-Host "Arg: $bar";
}

function foo()
{
  param([string]$foo = "foo", [string]$bar = "bar");
  Write-Host "Arg: $foo";
  Write-Host "Arg: $bar";
}
</pre>

<p>
Scriptblocks
</p>
<pre class="example">
PS C:\&gt;&amp; {param([string]$foo = "foo", [string]$bar = "bar") Write-Host "Arg: $foo"; Write-Host "Arg: $bar"; }
Arg: foo
Arg: bar
</pre>
</div>
</div>
</div>

<div id="outline-container-org452d2f2" class="outline-4">
<h4 id="org452d2f2"><span class="section-number-4">36.8.6</span> Wireless hotspot</h4>
<div class="outline-text-4" id="text-36-8-6">
<p>
Tested with Win10
First, check if wireless adapter supports <code>Hosted Network supported: Yes</code>
</p>
<pre class="example">
netsh wlan show drivers
# Create a wireless Hosted Network
netsh wlan set hostednetwork mode=allow ssid=WindowsCentral key="yourkey"
# Start the newly created Microsoft Hosted Virtual Adapter
netsh wlan start hostednetwork  
</pre>

<p>
WinKey + x and select Network Connections, select any network adapter (LAN or wireless) currently have an internet connection,
Properties &gt; Sharing &gt; Allow ohter network users to connect through this computer's Internet connection &gt; Home networking connection select the newly created "Local Area Connection* 13 (or other numbers)"
</p>

<p>
Start and stop the Microsoft Hosted Virtual Adapter
</p>
<pre class="example">
netsh wlan stop hostednetwork
netsh wlan start hostednetwork
netsh wlan set hostednetwork mode=disallow
netsh wlan set hostednetwork mode=allow
</pre>

<p>
Change setting
</p>
<pre class="example">
netsh wlan set hostednetwork ssid=Your_New_SSID
netsh wlan set hostednetwork key="abc"
# View
netsh wlan show hostednetwork
netsh wlan show hostednetwork setting=security
</pre>

<p>
It's not easy to delete the hostednetwork setting
HKEY_LOCAL_MACHINE\system\currentcontrolset\services\wlansvc\parameters\hostednetworksettings
Right-click the HostedNetworkSettings DWORD key, select Delete, and click Yes to confirm deletion.
Reboot
</p>
</div>
</div>

<div id="outline-container-org336f4df" class="outline-4">
<h4 id="org336f4df"><span class="section-number-4">36.8.7</span> SOCKS Proxy</h4>
<div class="outline-text-4" id="text-36-8-7">
<p>
Setup Windows to use SOCKS proxy for all internet connections. Win + s &gt; Internet Options &gt; Connections &gt; LAN settings &gt; Use a proxy server, go to Advanced, clear all protocols but config for SOCKS.
</p>

<p>
IP will be the proxy server IP but local DNS is used to resolve domain names to IP.
</p>
</div>
</div>

<div id="outline-container-org2d06278" class="outline-4">
<h4 id="org2d06278"><span class="section-number-4">36.8.8</span> Windows Virtual PC</h4>
<div class="outline-text-4" id="text-36-8-8">
<p>
Install XP Mode on Windows 10 Pro and only Pro version can install
</p>
<ul class="org-ul">
<li>Google Windows XP Mode and download the en-us version</li>
<li>Enable Hyper-V in BIOS</li>
<li>In Win 10, run optionalfeatures.exe to go to Windows Features, enable all Hyper-V. Restart Windows</li>
<li>Control Panel &gt; Admin Tools &gt; Hyper-V manager</li>
<li>Download 7-Zip. Choose 64-bit if Win is 64.</li>
<li>Extract the downloaded XP mode file, go to folder Sources and find xpm file. right click and choose 7-zip &gt; Open archive</li>
<li>Find <code>VirtualXPVHD</code>, extract it and rename to <code>VirtualXPVHD.vhd</code> file</li>
<li>Open Hyper-V Manager, go to Virtual Switch Manage to create a Virtual Switch
<ul class="org-ul">
<li>Type External, use default for others so that VM can use internet</li>
</ul></li>
<li>In Hyper-V Manager, select the one and only local virtualization server on the left pane.</li>
<li>Action &gt; New &gt; Virtual Machine
<ul class="org-ul">
<li>Specify a name</li>
<li>Use Generation 1</li>
<li>RAM should 512MB or 1024MB</li>
<li>Select a Virutal Switch</li>
<li>Select an existing Virtual Hard Disk</li>
<li>Next, Finish</li>
</ul></li>
<li>On the right pane in Hyper-V Manager, click Connect then Start</li>
<li>Set Region and Time</li>
<li>License is required..</li>
<li>Turn off Windows Update. Expect to see some driver installation failed</li>
<li>Most likely, internet doesn't work. Turn off VM. 
<ul class="org-ul">
<li>Settings &gt; Add Hardware &gt; Legacy Network Adapter</li>
<li>Choose the Virtual Switch, Apply. Start VM</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org6664015" class="outline-4">
<h4 id="org6664015"><span class="section-number-4">36.8.9</span> Find physical path by shared path</h4>
<div class="outline-text-4" id="text-36-8-9">
<p>
On server, run <code>net share</code>
</p>
</div>
</div>

<div id="outline-container-org349d795" class="outline-4">
<h4 id="org349d795"><span class="section-number-4">36.8.10</span> Process Monitor procmon.exe</h4>
<div class="outline-text-4" id="text-36-8-10">
<p>
To troubleshoot a process, e.g. OUTLOOK.EXE
Filter &gt; Filter, or Ctrl+L, add Process Name is not OUTLOOK.exe Exclude, Apply
Tools &gt; Count Occurrences &gt; Column: Result, double click on each Result to filter events
</p>
</div>
</div>

<div id="outline-container-orgf96b8fb" class="outline-4">
<h4 id="orgf96b8fb"><span class="section-number-4">36.8.11</span> Dosbox</h4>
<div class="outline-text-4" id="text-36-8-11">
<p>
<a href="http://www.dosbox.com/download.php?main=1">http://www.dosbox.com/download.php?main=1</a>
</p>

<p>
This is to run old DOS programs.
Double click to install to C:\DOSBox
Put all your old DOS programs to, e.g. C:\OLDGAMES
</p>

<p>
Then go to cmd, run C:\DOSBox\dosbox.exe
</p>

<pre class="example">
Z:\&gt;MOUNT C C:\OLDGAMES
Z:\&gt;C:
C:\&gt;run your dos commands!
</pre>

<p>
To automate the mount commands, double click on DOSBox-v-numberConfiguration, and a dosbox.conf text file pops up.
Add these 2 under [autoexec]
</p>
<pre class="example">
[autoexec]
MOUNT C C:\CT
C:
</pre>
</div>
</div>

<div id="outline-container-orgd398f67" class="outline-4">
<h4 id="orgd398f67"><span class="section-number-4">36.8.12</span> Batch Script</h4>
<div class="outline-text-4" id="text-36-8-12">
<p>
F7 in command prompt to review command history for the current window
</p>
</div>

<div id="outline-container-org2ae8913" class="outline-5">
<h5 id="org2ae8913"><span class="section-number-5">36.8.12.1</span> Setting</h5>
<div class="outline-text-5" id="text-36-8-12-1">
<p>
Usually at the top of a .bat file. @ in front makes the command apply to itself only
@echo off :: turn off output of the command itself
</p>
</div>
</div>

<div id="outline-container-org844168c" class="outline-5">
<h5 id="org844168c"><span class="section-number-5">36.8.12.2</span> Comment</h5>
<div class="outline-text-5" id="text-36-8-12-2">
<p>
Rem Your comment in one line
</p>
</div>
</div>
</div>

<div id="outline-container-org53b1486" class="outline-4">
<h4 id="org53b1486"><span class="section-number-4">36.8.13</span> FART</h4>
<div class="outline-text-4" id="text-36-8-13">
<p>
<a id="org3919cdf">windows:FART</a> <a href="http://fart-it.sourceforge.net/">Download</a>
Replace text in files
Replace original_text with new_text for all files
fart.exe -i -r "C:\Dir\To\Files\*.txt" original_text new_text
</p>

<p>
Remove original_text for all files under current folder
fart.exe -i -r &#x2013;remove *.txt "original text"
</p>

<p>
Say you want to remove double quotes. You will need to escape " with \"
And you need to use -C for using \, \t, \n etc.
fart -i -C &#x2013;remove *.txt "\""
</p>

<dl class="org-dl">
<dt>-i</dt><dd>case insensitive</dd>
<dt>-w</dt><dd>whole word</dd>
<dt>-r</dt><dd>recursive</dd>
<dt>-f</dt><dd>Find and replace filename instead of contents</dd>
<dt>-B</dt><dd>Also find and replace in binary files</dd>
<dt>-p</dt><dd>preview. no action</dd>
</dl>

<p>
I realize fart sometimes cannot find files.. Use Linux
</p>
</div>
</div>

<div id="outline-container-org96c06e4" class="outline-4">
<h4 id="org96c06e4"><span class="section-number-4">36.8.14</span> <a href="#org9682045">Windows Credential Store Panel</a> <a id="org9682045">Windows Credential Store Panel</a></h4>
<div class="outline-text-4" id="text-36-8-14">
<p>
User Accounts &gt; Your Account &gt; Manage your credentials
Or Credential Manager
Instead of Web Credentials, choose Windows Credentials
</p>

<p>
OneNote needs a password to sync this notebook. Delete any records MicrosoftOffice{15|16}_Data:Live:cid=some set of numbers
Which have no username and restart OneNote.
</p>
</div>
</div>

<div id="outline-container-orgd68d557" class="outline-4">
<h4 id="orgd68d557"><span class="section-number-4">36.8.15</span> MAC address</h4>
<div class="outline-text-4" id="text-36-8-15">
<p>
<code>getmac /v /fo list</code>
</p>
</div>
</div>

<div id="outline-container-orgf3a62e4" class="outline-4">
<h4 id="orgf3a62e4"><span class="section-number-4">36.8.16</span> Meter an Ethernet Connection</h4>
<div class="outline-text-4" id="text-36-8-16">
<p>
Run regedit: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\DefaultMediaCost
Right click on the key &gt; Permissions &gt; Advanced &gt; <code>Change</code> next to Owner on the top 
Type <code>Administrators</code> and Check Names
Check the box next to <b>Replace owner on subcontainers and objects</b> and click <b>OK</b>
Back in the <b>Permissions for DefaultMediaCost</b> window, click <b>Administrators</b> to select the group
Assign <b>Full Control Allow</b>, then <b>OK</b>
Right click <i>DefaultMediaCost &gt; Ethernet</i> and <i>Modify</i>
Change from 1 to 2 for metered (DWORD 32-bit, Base Hexadecimal)
</p>
</div>
</div>

<div id="outline-container-org422f0d4" class="outline-4">
<h4 id="org422f0d4"><span class="section-number-4">36.8.17</span> Troubleshoot "Installation Directory must be on a local hard drive"</h4>
<div class="outline-text-4" id="text-36-8-17">
<p>
Install .msi using admin privilege
Shift+Right Click on the msi file and select copy path
Open cmd run as admin and run: <code>msiexec /i "the path"</code>
</p>
</div>
</div>
</div>

<div id="outline-container-org85f043e" class="outline-3">
<h3 id="org85f043e"><span class="section-number-3">36.9</span> Exchange, Office</h3>
<div class="outline-text-3" id="text-36-9">
</div>
<div id="outline-container-orgee5d303" class="outline-4">
<h4 id="orgee5d303"><span class="section-number-4">36.9.1</span> Exchange Online, Office 365</h4>
<div class="outline-text-4" id="text-36-9-1">
</div>
<div id="outline-container-orgc97c8d5" class="outline-5">
<h5 id="orgc97c8d5"><span class="section-number-5">36.9.1.1</span> Shared Mailbox</h5>
<div class="outline-text-5" id="text-36-9-1-1">
<p>
Shared mailbox doesn't require a license and quota is 50gb each. If it exceeds the quota, it will be locked.
</p>

<p>
After it's added from Admin, user has to restart Outlook in order to see the shared mailbox. 
It takes one hour for new members to see the new shared mailbox.
</p>
</div>

<ol class="org-ol">
<li><a id="org1335d39"></a>Open Shared Mailbox in OWA<br />
<div class="outline-text-6" id="text-36-9-1-1-1">
<p>
Click on your picture and select Open another mailbox
Type the shared mailbox name
</p>
</div>
</li>

<li><a id="org0ecc69c"></a>Add Alias and Move Messages<br />
<div class="outline-text-6" id="text-36-9-1-1-2">
<p>
Add secondary email address to a shared mailbox and then setup Rules to that shared mailbox
Logon to OWA and open the shared mailbox primary email address
Gear &gt; Options &gt; Mail &gt; Automatic processing &gt; Inbox rules
Say the primary email is: abc@abc.com and a secondary email is: xyz@abc.com
You want to move emails sent to xyz@abc.com to a sub folder in the shared mailbox.
You need to use <code>it includes these words in the message header = xyz@abc.com</code>
</p>
</div>
</li>

<li><a id="orga63aa62"></a>Add Members<br />
<div class="outline-text-6" id="text-36-9-1-1-3">
<p>
A new member by default has full access:
Read, manage, and send as (send as the mailbox email address).
</p>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org0661aaa" class="outline-4">
<h4 id="org0661aaa"><span class="section-number-4">36.9.2</span> SharePoint</h4>
<div class="outline-text-4" id="text-36-9-2">
<p>
Site collection can have multiple subsites.
Each site collection must have one top-level site.
Defautl site collection and top-level site: yourcompany.sharepoint.com
The default Team Site (yourcompany.sharepoint.com/TeamSite) is a top-site of the defautl site collection 
</p>

<p>
See all site collections, Sharepoint admin center &gt; site collections
</p>

<p>
Manage subsites and top-level site, go to one of the subsites and then click on Site Settings
or go to the top-level site then Site Settings
</p>
</div>

<div id="outline-container-orgbbd57c7" class="outline-5">
<h5 id="orgbbd57c7"><span class="section-number-5">36.9.2.1</span> Site Permissions</h5>
<div class="outline-text-5" id="text-36-9-2-1">
<p>
3 core default SharePoint permission groups: Owners, Members, Visitors.
</p>

<p>
You can add "Everyone except external" to a group. 
</p>

<p>
Site Settings &gt; People and Groups &gt; Select the desired group &gt; New
</p>
</div>
</div>
</div>

<div id="outline-container-org6ebdca7" class="outline-4">
<h4 id="org6ebdca7"><span class="section-number-4">36.9.3</span> Office 2016</h4>
<div class="outline-text-4" id="text-36-9-3">
</div>
<div id="outline-container-orgb29b816" class="outline-5">
<h5 id="orgb29b816"><span class="section-number-5">36.9.3.1</span> One-time-purchase Office License</h5>
<div class="outline-text-5" id="text-36-9-3-1">
<p>
Enter product key on a hard copy (card) on office.com/myaccount, get a digital product key.
</p>

<p>
To find out the digital product key of Office which is one-time-purchase.
</p>

<p>
<a href="https://support.office.com/en-us/article/Manage-multiple-one-time-purchase-Office-installs-that-use-the-same-Microsoft-account-b2897d43-9ec1-4040-9cf0-2bafa416e071?ui=en-US&amp;rs=en-US&amp;ad=US&amp;fromAR=1">Detailed Instructions</a>
</p>

<p>
Office 2016 32-bit on Win 64-bit
cscript "C:\Program Files (x86)\Microsoft Office\Office16\OSPP.VBS" /dstatus 
</p>

<p>
Office 2016 64-bit on Win 64-bit
cscript "C:\Program Files\Microsoft Office\Office16\OSPP.VBS" /dstatus
</p>

<p>
Office 2013 32-bit on Win 64-bit
cscript "C:\Program Files (x86)\Microsoft Office\Office15\OSPP.VBS" /dstatus
</p>

<p>
Office 2013 64-bit on Win 64-bit
cscript "C:\Program Files\Microsoft Office\Office15\OSPP.VBS" /dstatus
</p>
</div>
</div>

<div id="outline-container-orge3b1033" class="outline-5">
<h5 id="orge3b1033"><span class="section-number-5">36.9.3.2</span> Outlook</h5>
<div class="outline-text-5" id="text-36-9-3-2">
</div>
<ol class="org-ol">
<li><a id="org7ca8fbf"></a>Export Contacts as CSV and Reimport to Outlook<br />
<div class="outline-text-6" id="text-36-9-3-2-1">
<p>
There's no option in Outlook for Mac to export contacts as CSV. OWA exports contacts without Company field.
First, go to Outlook for Mac, select all contacts and drag them to a folder as VCF files.
Open cmd on Windows, go to the folder with VCF files and run <code>copy /B *.vcf all_in_one.vcf</code>
Use vCard to <a href="http://labs.brotherli.ch/vcfconvert">LDIF/CSV Converter</a> to convert all_in_one.vcf to CSV
Open the csv in Excel and Save as CSV so that file uses CR+LF
Go to OWA, delete all contacts
Always use PC Outlook to import CSV. OWA barely functions.
</p>
</div>
</li>

<li><a id="org53cb442"></a>Import Contacts<br />
<div class="outline-text-6" id="text-36-9-3-2-2">
<p>
Import from .pst file handles the field mapping automatically.
Import from .csv you would need to Clear Map and Default Map.
</p>
</div>
</li>

<li><a id="orgae900ac"></a>Rules: Multiple Senders<br />
<div class="outline-text-6" id="text-36-9-3-2-3">
<p>
Create a new contact folder and put contacts with emails.
Create a rule which can be triggered when anyone in the contact folder belongs to "From"
The rule is called "Sender is in specified Address Book"
</p>
</div>
</li>

<li><a id="org7a06690"></a>Rebuild OST<br />
<div class="outline-text-6" id="text-36-9-3-2-4">
<p>
Make a copy of the .ost file before delete. Then open Outlook again.
If you can't copy/delete .ost file, close Outlook, Skype for Business and Office applications.
</p>
</div>
</li>

<li><a id="org7652225"></a>Rebuild .srs file<br />
<div class="outline-text-6" id="text-36-9-3-2-5">
<p>
When rules don't work automatically but work manually, you should rename your-profile-name.srs at
C:\Users\%username%\AppData\Roaming\Microsoft\Outlook
</p>
</div>
</li>

<li><a id="org8a24ae0"></a>Outlook for Mac<br />
<ol class="org-ol">
<li><a id="orgf6f6c63"></a>Troubleshooting<br />
<div class="outline-text-7" id="text-36-9-3-2-6-1">
<p>
Sorry, we're having server problems, so we can't add Office 365 SharePoint right now. Please try again later.
</p>

<ul class="org-ul">
<li>Quit all Outlook and Office apps</li>
<li>Spotlight search and open KeyChain Access</li>
<li>Under Keychains &gt; login on the right, delete all of these search results
<ul class="org-ul">
<li>Exchange</li>
<li>Office</li>
<li>ADAL</li>
</ul></li>
<li>Launch Outlook</li>
</ul>
</div>
</li>
</ol>
</li>
</ol>
</div>

<div id="outline-container-org8a7960e" class="outline-5">
<h5 id="org8a7960e"><span class="section-number-5">36.9.3.3</span> OneNote</h5>
<div class="outline-text-5" id="text-36-9-3-3">
<p>
OneNote sync issue or remove crendentials. Refer to <a href="#org9682045">Windows Credential Store Panel</a>
</p>

<p>
Move a OneOnte on SharePoint to personal OneDrive
</p>
<ul class="org-ul">
<li>Export the whole Notebook to a local .onepkg file</li>
<li>Open the .onepkg file and then File &gt; Share &gt; Move Notebook (you may need to Add a Place first)</li>

<li id="Open another OneNote window">Ctrl + M</li>
</ul>
</div>
</div>

<div id="outline-container-org05ed352" class="outline-5">
<h5 id="org05ed352"><span class="section-number-5">36.9.3.4</span> Troubleshooting</h5>
<div class="outline-text-5" id="text-36-9-3-4">
</div>
<ol class="org-ol">
<li><a id="org3b0b615"></a>Outlook CSV Import<br />
<div class="outline-text-6" id="text-36-9-3-4-1">
<p>
A file error has occured in the Comma Separated Values translator while initializing a translator to build a field map.
That's because the CSV file does not use CR+LF. Open it in Excel and Save As
</p>
</div>
</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org8f07dc1" class="outline-3">
<h3 id="org8f07dc1"><span class="section-number-3">36.10</span> Reflector, ILSpy and Reflexil</h3>
<div class="outline-text-3" id="text-36-10">
<p>
C#, VB, F# and other .NET codes are compiled to Common Intermediate Language (CIL) or IL for short. Which is .dll file.
</p>

<p>
CIL is an object-oriented assembly language.
</p>

<p>
Red-gate <a href="https://www.red-gate.com/products/dotnet-development/reflector/">.Net Reflector</a> (trial) and <a href="https://github.com/icsharpcode/ILSpy/releases">ILSpy</a> (open-source) can decompile a dll into source code.
</p>

<p>
<a href="https://github.com/sailro/Reflexil/releases">Reflexil</a> is a plugin for Reflect or ILSpy to change the OpCode for dll and export a new dll.
</p>

<p>
Reflexil v2.1 only works for ILSpy v2.4 but works for Reflector v9
</p>

<p>
Put Reflexil AIO (all-in-one version) dll to ILSpy.exe directory and run ILSpy.exe. View &gt; Reflexil
</p>

<p>
Put Reflexil AIO dll to Reflector's Addins folder C:\Program Files (x86)\Red Gate\.NET Reflector\Desktop 9.0\Addins. Tools &gt; Add-Ins, add the dll.
</p>

<p>
After edit, right click on the Object Browser &gt; Reflexil &gt; Save as
</p>
</div>
</div>

<div id="outline-container-orgdfc2c96" class="outline-3">
<h3 id="orgdfc2c96"><span class="section-number-3">36.11</span> Jira, YouTrack</h3>
<div class="outline-text-3" id="text-36-11">
</div>
<div id="outline-container-orgda2e65e" class="outline-4">
<h4 id="orgda2e65e"><span class="section-number-4">36.11.1</span> Jira</h4>
<div class="outline-text-4" id="text-36-11-1">
</div>
<div id="outline-container-org57d3c01" class="outline-5">
<h5 id="org57d3c01"><span class="section-number-5">36.11.1.1</span> Agile</h5>
<div class="outline-text-5" id="text-36-11-1-1">
<p>
Characteristics of Agile
</p>
<ul class="org-ul">
<li>Sprint is 4-8 weeks long</li>
<li>Face to face communication</li>
<li>Business and technicial team members are co-located</li>
<li>100% committed sponsor</li>
<li>Requirement changes are anticipated and accommodated</li>
</ul>

<p>
Stages in Agile Life Cycle
</p>
<ul class="org-ul">
<li>Envision &gt; Speculate &gt; Explore &gt; Adapt (may go back to speculate) &gt; Close</li>
<li id="Envision">what to build, resource and team you have, values &amp; norms
<dl class="org-dl">
<dt>Project charter</dt><dd>Scope, Objectives, Defined Stakeholders
<ul class="org-ul">
<li><a href="pdf/project-charter-university-of-waterloo-2014.pdf">Sample: University of Waterloo</a></li>
</ul></dd>
<dt>(no term)</dt><dd>Set up collaboration tools</dd>
<dt>Establish team norms</dt><dd>e.g. work and meeting schedule</dd>
</dl></li>
<li>Speculate, Explore and Adapt happen in each sprint</li>
<li>Speculate
<ul class="org-ul">
<li>features based delivery plan and for each feature what estimates (time &amp; resource) and risks are</li>
<li>Requirements broken down to features. At the end of each sprint, they will be implemented</li>
</ul></li>
<li>Explore
<ul class="org-ul">
<li>Daily stand-up meetings, honest peer reviews of features among business team, testing and technical team</li>
</ul></li>
<li id="Adapt">quick, often within one day
<ul class="org-ul">
<li>final review of the features by the customer</li>
<li>a documented meeting of team members to reflect on their performance</li>
<li>so that lessons are captured and shared and future sprint plans are reviewed and adjusted</li>
</ul></li>
<li>Close
<ul class="org-ul">
<li>ensure all deliverables are completed</li>
<li>capture lessons learned</li>
</ul></li>
</ul>


<div class="figure">
<p><img src="images/agile_life_cycle.png" alt="agile_life_cycle.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org2ef6909" class="outline-5">
<h5 id="org2ef6909"><span class="section-number-5">36.11.1.2</span> Story</h5>
<div class="outline-text-5" id="text-36-11-1-2">
<p>
In an agile framework, user stories are the smallest units of work.
User stories are sketched out by the product owner, and then the entire product team collectively determins detailed requirements.
As a {type of user}, I want {goal} so that I {receive benefit}.
</p>
</div>
</div>

<div id="outline-container-org25f5322" class="outline-5">
<h5 id="org25f5322"><span class="section-number-5">36.11.1.3</span> Kanban board</h5>
<div class="outline-text-5" id="text-36-11-1-3">
<p>
Board Setting &gt; Setup Kanban backlog
Assign status (To Do, In Progress, In Review, Done, etc.) to Kanban backlog
Number of cards (issues) can be controlled for each column (In Progress, Done)
</p>

<p>
Setup priorities of issues as swimlanes
</p>

<p>
Reports: Control Chart, Cumulative Flow Diagram
</p>
</div>
</div>
</div>

<div id="outline-container-org47bc81c" class="outline-4">
<h4 id="org47bc81c"><span class="section-number-4">36.11.2</span> YouTrack</h4>
<div class="outline-text-4" id="text-36-11-2">
</div>
<div id="outline-container-orgdbecea6" class="outline-5">
<h5 id="orgdbecea6"><span class="section-number-5">36.11.2.1</span> Default field: State</h5>
<div class="outline-text-5" id="text-36-11-2-1">
<p>
Settings &gt; Custom Fields Settings &gt; Fields List &gt; State
See which values are considered as Resolved, others are Unresolved.
Use this as a query keyword #resolved or #unresolved
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org9e1de58" class="outline-3">
<h3 id="org9e1de58"><span class="section-number-3">36.12</span> Image</h3>
<div class="outline-text-3" id="text-36-12">
</div>
<div id="outline-container-org251f2fd" class="outline-4">
<h4 id="org251f2fd"><span class="section-number-4">36.12.1</span> Sample Image</h4>
<div class="outline-text-4" id="text-36-12-1">
</div>
<div id="outline-container-org1f28d90" class="outline-5">
<h5 id="org1f28d90"><span class="section-number-5">36.12.1.1</span> Placeholder.com</h5>
<div class="outline-text-5" id="text-36-12-1-1">
<p>
<a href="http://placehold.it/350x150">http://placehold.it/350x150</a>
</p>

<p>
<a href="http://via.placeholder.com/300x250/?text=hello+world">http://via.placeholder.com/300x250/?text=hello+world</a>
</p>

<p>
<a href="http://via.placeholder.com/300/ffffff/000000/?text=hello+world">http://via.placeholder.com/300/ffffff/000000/?text=hello+world</a>
</p>

<p>
Hex, first is background color and then text color
</p>

<p>
<a href="http://via.placeholder.com/300/ffffff/?text=hello+world">http://via.placeholder.com/300/ffffff/?text=hello+world</a>
</p>

<p>
Auto text color
</p>
</div>
</div>

<div id="outline-container-org6c00e07" class="outline-5">
<h5 id="org6c00e07"><span class="section-number-5">36.12.1.2</span> Text with Transparency</h5>
<div class="outline-text-5" id="text-36-12-1-2">
<p>
<a href="https://imgplaceholder.com/">https://imgplaceholder.com/</a>
</p>

<p>
First color is background color and second color is font color whose default is 757575
</p>

<pre class="example">
https://imgplaceholder.com/420x320/transparent?text=hello
https://imgplaceholder.com/420x320/transparent/fff?text=hello

https://imgplaceholder.com/420x420/ca5353/757575?text=hello+world
https://imgplaceholder.com/420x420/ca5353?text=hello+world
https://imgplaceholder.com/420x420/ca5353?text=hello+world_br_Im+here+with+a+line+break
https://imgplaceholder.com/420x420/ca5353?text=hello+world_br_Im+here+with+a+line+break&amp;font-size=12

https://imgplaceholder.com/420x420/ca5353?text=hello+world&amp;font-size=12&amp;font-family=Roboto

https://imgplaceholder.com/420x320/b13939/fff/glyphicon-tags
https://imgplaceholder.com/420x320/transparent/fff/glyphicon-tags

https://imgplaceholder.com/420x320/transparent/fff/ion-android-more-vertical

https://imgplaceholder.com/420x320/b13939/fff/fa-android
</pre>
</div>
</div>

<div id="outline-container-org1a1ab18" class="outline-5">
<h5 id="org1a1ab18"><span class="section-number-5">36.12.1.3</span> Real Image - Picsum.photos</h5>
<div class="outline-text-5" id="text-36-12-1-3">
<p>
Pick a picture that you like :: <a href="https://picsum.photos/images">https://picsum.photos/images</a>
<a href="https://picsum.photos/">https://picsum.photos/</a>
</p>

<p>
Specific picture :: <a href="https://picsum.photos/200/300?image=0">https://picsum.photos/200/300?image=0</a>
</p>

<p>
Random picture :: <a href="https://picsum.photos/200/300/?random">https://picsum.photos/200/300/?random</a>
</p>

<p>
Blur :: <a href="https://picsum.photos/200/300/?blur">https://picsum.photos/200/300/?blur</a>
</p>

<p>
Grayscale :: <a href="https://picsum.photos/g/200/300">https://picsum.photos/g/200/300</a>
</p>

<p>
Square :: <a href="https://picsum.photos/200">https://picsum.photos/200</a>
</p>
</div>
</div>

<div id="outline-container-orgef30e7f" class="outline-5">
<h5 id="orgef30e7f"><span class="section-number-5">36.12.1.4</span> Free PNG with transparency</h5>
<div class="outline-text-5" id="text-36-12-1-4">
<p>
<a href="http://www.stickpng.com/">http://www.stickpng.com/</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orge2ce6d9" class="outline-4">
<h4 id="orge2ce6d9"><span class="section-number-4">36.12.2</span> Convert image to favicon (.ico)</h4>
<div class="outline-text-4" id="text-36-12-2">
<p>
<a href="https://converticon.com/">https://converticon.com/</a>
</p>
</div>
</div>

<div id="outline-container-orge0bbb5a" class="outline-4">
<h4 id="orge0bbb5a"><span class="section-number-4">36.12.3</span> WebP</h4>
<div class="outline-text-4" id="text-36-12-3">
<p>
Supported by Chrome desktop and android and Opera.
</p>

<p>
<a href="https://developers.google.com/speed/webp/faq#how_can_i_detect_browser_support_for_webp">https://developers.google.com/speed/webp/faq#how_can_i_detect_browser_support_for_webp</a>
Detect if request header <code>accept</code> literally contains image/webp. Browsers have these accept headers
</p>
<pre class="example">
*/*
image/*
</pre>

<p>
Some CDN support content negotiation in action means if the accept doesn't have image/webp then deliver .png or .jpg. How to deliver different cache based on the same URL? Nginx example
</p>
<pre class="example">
server {
   listen 80;
   server_name ei8gd7lwnymbl2d.cdnconnect.netdna-cdn.com jdorfman.cdnconnect.com;
   set $webp "";
   if ($http_accept ~* image/webp) {
           set $webp "webp";
   }
   location ~ /purge(/.*) {
           allow 192.168.0.1/24;
           deny all;
           proxy_cache_purge my_diskcached ei8gd7lwnymbl2d.cdnconnect10$myae$webp$1$is_args$args;
   }
   location / {
     [clipped]
           proxy_cache_key ei8gd7lwnymbl2d.cdnconnect10$myae$webp$uri$is_args$args;
   }
}
</pre>
<p>
Notice how the “$webp” variable gives us different cache keys for the various versions.
</p>

<p>
More on WebP and Nginx :: <a href="https://www.igvita.com/2013/05/01/deploying-webp-via-accept-content-negotiation/">https://www.igvita.com/2013/05/01/deploying-webp-via-accept-content-negotiation/</a>
</p>

<p>
Use <a href="#org965daec">html:picture</a> <a href="#org73eba46">modernizr:webp</a>
</p>
</div>
</div>

<div id="outline-container-org022d56c" class="outline-4">
<h4 id="org022d56c"><span class="section-number-4">36.12.4</span> Image Stock</h4>
<div class="outline-text-4" id="text-36-12-4">
<p>
<a href="https://www.freeimages.com/">https://www.freeimages.com/</a>
<a href="http://publicdomainarchive.com/">http://publicdomainarchive.com/</a>
<a href="https://unsplash.com/">https://unsplash.com/</a>
Vintage <a href="http://nos.twnsnd.co/">http://nos.twnsnd.co/</a>
</p>

<p>
Paid <a href="https://www.stocksy.com/">https://www.stocksy.com/</a>
</p>

<p>
Free Flag SVG <a href="https://github.com/lipis/flag-icon-css">https://github.com/lipis/flag-icon-css</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orgf49f82e" class="outline-3">
<h3 id="orgf49f82e"><span class="section-number-3">36.13</span> cPanel WHM</h3>
<div class="outline-text-3" id="text-36-13">
</div>
<div id="outline-container-org7c55b41" class="outline-4">
<h4 id="org7c55b41"><span class="section-number-4">36.13.1</span> WHM Auto Backup</h4>
<div class="outline-text-4" id="text-36-13-1">
<p>
Do it using WHM and don't do it using cPanel as it needs to setup scripts to do backup on cPanel
search Backup Configuration &gt; Enable
<a href="https://www.inmotionhosting.com/support/product-guides/dedicated-hosting/setup-scheduled-cpanel-backups">https://www.inmotionhosting.com/support/product-guides/dedicated-hosting/setup-scheduled-cpanel-backups</a>
</p>

<p>
Default backup directory is /backup
</p>
</div>
</div>

<div id="outline-container-org1a1b9ae" class="outline-4">
<h4 id="org1a1b9ae"><span class="section-number-4">36.13.2</span> WHM/cPanel DNS Record Files</h4>
<div class="outline-text-4" id="text-36-13-2">
<p>
Directory /var/named/yourdomain.com.db
</p>

<p>
Create full backup and inside folder dnszones, there's yourdomain.com.db
</p>
</div>
</div>

<div id="outline-container-org15c958b" class="outline-4">
<h4 id="org15c958b"><span class="section-number-4">36.13.3</span> WHM Add IP to Firewall - Permit SSH Access</h4>
<div class="outline-text-4" id="text-36-13-3">
<p>
In order to see the list of IPs, <code>cat /etc/apf/allow_hosts.rules</code>
</p>
</div>
</div>

<div id="outline-container-org80b902e" class="outline-4">
<h4 id="org80b902e"><span class="section-number-4">36.13.4</span> WHM List of Accounts</h4>
<div class="outline-text-4" id="text-36-13-4">
<p>
Modify Account
</p>
<dl class="org-dl">
<dt>Privileges</dt><dd>Shell Access (SSH)</dd>
</dl>
</div>
</div>

<div id="outline-container-orgd2e8b26" class="outline-4">
<h4 id="orgd2e8b26"><span class="section-number-4">36.13.5</span> WHM Security Advisor</h4>
</div>
<div id="outline-container-org7228c77" class="outline-4">
<h4 id="org7228c77"><span class="section-number-4">36.13.6</span> WHM Access</h4>
<div class="outline-text-4" id="text-36-13-6">
<p>
<a href="https://example.com:2087">https://example.com:2087</a>
<a href="http://example.com/whm">http://example.com/whm</a> (port 2086)
<a href="http://whm.example.com">http://whm.example.com</a> (port 80)
</p>
</div>
</div>

<div id="outline-container-orgfdc99f1" class="outline-4">
<h4 id="orgfdc99f1"><span class="section-number-4">36.13.7</span> SSH access</h4>
<div class="outline-text-4" id="text-36-13-7">
<p>
For VPS account, you might need to add IP to allowed rule under "Add IP to Firewall".
</p>
</div>
</div>

<div id="outline-container-org7a79cb7" class="outline-4">
<h4 id="org7a79cb7"><span class="section-number-4">36.13.8</span> <a href="#org2bb4a59">autossl:whm</a></h4>
</div>
<div id="outline-container-org21cc965" class="outline-4">
<h4 id="org21cc965"><span class="section-number-4">36.13.9</span> Remote MySQL connection - cPanel</h4>
<div class="outline-text-4" id="text-36-13-9">
<p>
Remote MySQL and add remote IP address. Use the cPanel domain for db host
<a href="https://www.inmotionhosting.com/support/website/databases/setting-up-a-remote-mysql-connection-in-cpanel">https://www.inmotionhosting.com/support/website/databases/setting-up-a-remote-mysql-connection-in-cpanel</a>
</p>
</div>
</div>

<div id="outline-container-orge8a56a8" class="outline-4">
<h4 id="orge8a56a8"><span class="section-number-4">36.13.10</span> Access Log - cPanel</h4>
<div class="outline-text-4" id="text-36-13-10">
<p>
Metrics &gt; Raw Access.
Current logs :: ~/access_logs
Archived logs :: ~/logs
</p>
</div>
</div>

<div id="outline-container-orgb7565a7" class="outline-4">
<h4 id="orgb7565a7"><span class="section-number-4">36.13.11</span> Root domain A record change - cPanel</h4>
<div class="outline-text-4" id="text-36-13-11">
<p>
You want to point the root domain to antoher server. Assuming root domain originally has A record 1.2.3.4 and new IP is 2.2.3.4
</p>
<ul class="org-ul">
<li>Change root domain A record  to 2.2.3.4</li>
<li>Change mail.yourdomain.com CNAME yourdomain.com to A record 1.2.3.4</li>
<li>Change smtp.yourdomain.com CNAME yourdomain.com to CNAME mail.yourdomain.com</li>
<li>Change yourdomain.com MX yourdomain.com to mail.yourdomain.com</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org36b618a" class="outline-3">
<h3 id="org36b618a"><span class="section-number-3">36.14</span> Hosting Comparison</h3>
<div class="outline-text-3" id="text-36-14">
<p>
<a href="#org19279be">hosting:pantheon</a> is good for hosting one website
</p>

<p>
Charged by monthly pageviews
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">features</td>
<td class="org-right">$25</td>
<td class="org-right">$100</td>
<td class="org-left">$400</td>
</tr>

<tr>
<td class="org-left">pageviews</td>
<td class="org-right">10k</td>
<td class="org-right">100k</td>
<td class="org-left">500k</td>
</tr>

<tr>
<td class="org-left">storage gb</td>
<td class="org-right">5</td>
<td class="org-right">20</td>
<td class="org-left">30</td>
</tr>

<tr>
<td class="org-left">memory</td>
<td class="org-right">256</td>
<td class="org-right">256</td>
<td class="org-left">512</td>
</tr>

<tr>
<td class="org-left">PHP workers</td>
<td class="org-right">4</td>
<td class="org-right">8</td>
<td class="org-left">16</td>
</tr>

<tr>
<td class="org-left">database working set</td>
<td class="org-right">128</td>
<td class="org-right">500</td>
<td class="org-left">1gb</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
hosting:wp-engine is good for 1, 5 and 15 websites
</p>

<p>
Charged by monthly visits and bandwidth. Multisite is possible.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">features</td>
<td class="org-right">$35</td>
<td class="org-right">$115</td>
<td class="org-right">$290</td>
</tr>

<tr>
<td class="org-left">sites</td>
<td class="org-right">1</td>
<td class="org-right">5</td>
<td class="org-right">15</td>
</tr>

<tr>
<td class="org-left">visits</td>
<td class="org-right">25k</td>
<td class="org-right">100k</td>
<td class="org-right">400k</td>
</tr>

<tr>
<td class="org-left">bandwidth gb</td>
<td class="org-right">50</td>
<td class="org-right">200</td>
<td class="org-right">400</td>
</tr>

<tr>
<td class="org-left">storage gb</td>
<td class="org-right">10</td>
<td class="org-right">20</td>
<td class="org-right">30</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Digital Ocean has no bandwidth cap.
</p>
</div>
</div>

<div id="outline-container-org4ca45c2" class="outline-3">
<h3 id="org4ca45c2"><span class="section-number-3">36.15</span> Internet Trends, Internet Technology Trend</h3>
<div class="outline-text-3" id="text-36-15">
<p>
Internet Trends Report by Mary Meeker from Kleiner Perkins
<a href="https://trends.builtwith.com/">https://trends.builtwith.com/</a>
</p>
</div>
</div>

<div id="outline-container-org0c3b936" class="outline-3">
<h3 id="org0c3b936"><span class="section-number-3">36.16</span> Website Status</h3>
<div class="outline-text-3" id="text-36-16">
<p>
StatusCake - Free for 10 websites, 5 minutes check, random test locations
Pingdom - Free for 1 website only.
</p>
</div>
</div>

<div id="outline-container-org0dfb71f" class="outline-3">
<h3 id="org0dfb71f"><span class="section-number-3">36.17</span> Website Security, Testing</h3>
<div class="outline-text-3" id="text-36-17">
<p>
<a href="https://www.qualys.com/">Qualys</a> :: vulnerability test
</p>

<p>
HTML link to another domain with target="_blank", better add this so that window.opener object doesn't exist on the new page in new tab.
</p>
<pre class="example">
&lt;a href="anotherdomain.gg" target="_blank" rel="noopener"&gt;...&lt;/a&gt;
</pre>

<p>
Security <a href="#org9f9b13c">google:site status</a>
</p>

<p>
<a href="https://sitecheck.sucuri.net/">https://sitecheck.sucuri.net/</a>
<a href="https://www.virustotal.com">https://www.virustotal.com</a>
</p>

<p>
<a href="#orgb3405eb">wp:ts:hacked</a>
</p>

<p>
Performance testing :: <a href="https://www.webpagetest.org/">https://www.webpagetest.org/</a>
</p>

<p>
Header response security test :: <a href="https://securityheaders.com/">https://securityheaders.com/</a>
</p>

<p>
<a href="https://speedcurve.com">SpeedCurve</a> and <a href="https://calibreapp.com/">Calibre</a> :: Monitor web performance budgets using <a href="#org7dfee75">chrome:lighthouse</a> and <a href="#org290a8ef">google:pagespeed</a>
</p>
</div>

<div id="outline-container-orgba8f124" class="outline-4">
<h4 id="orgba8f124"><span class="section-number-4">36.17.1</span> XSS</h4>
<div class="outline-text-4" id="text-36-17-1">
<p>
Tests
</p>
<pre class="example">
http://a.ca/abc-xyz--&gt;&lt;form&gt;&lt;button formaction='/esi.attack.sim'&gt;&lt;!--
http://a.ca/abc-xyz--&gt;&lt;script src='a' onerror=alert(document.domain)&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf0d9eb2" class="outline-3">
<h3 id="orgf0d9eb2"><span class="section-number-3">36.18</span> WCAG, AODA, Web Content Accessibility Guidelines</h3>
<div class="outline-text-3" id="text-36-18">
<p>
Checking Tools
</p>
<ul class="org-ul">
<li>SortSite by powermapper.
<dl class="org-dl">
<dt>Block pages</dt><dd>View &gt; Options &gt; Blocks e.g. <b>featherlight.gallery.min.css</b></dd>
</dl></li>
<li id="<a href="https://achecker.ca/checker/index.php">Achecker.ca</a>">Check one page only. Used by Ontario Government</li>
<li id="aodaonline.com">First 50 pages is free</li>
</ul>

<p>
<a href="https://www.w3.org/WAI/WCAG20/quickref/">https://www.w3.org/WAI/WCAG20/quickref/</a>
</p>

<p>
Keyboard accessbile for non link elements and non form elements
</p>
<pre class="example">
&lt;div onclick="doSumat();" onkeypress="doSumat();" tabindex=""&gt;
</pre>
</div>

<div id="outline-container-org91dc0d0" class="outline-4">
<h4 id="org91dc0d0"><span class="section-number-4">36.18.1</span> &lt;a&gt;</h4>
<div class="outline-text-4" id="text-36-18-1">
<p>
Multiple read more on a page
</p>
<pre class="example">
&lt;a href="babymayor.html" aria-label="Read more about Seminole's new baby mayor"&gt;[Read more...]&lt;/a&gt;
</pre>
</div>
</div>

<div id="outline-container-org29d6999" class="outline-4">
<h4 id="org29d6999"><span class="section-number-4">36.18.2</span> iframe</h4>
<div class="outline-text-4" id="text-36-18-2">
<p>
&lt;iframe title="" style="border:0px;"&gt;
</p>

<p>
frameborder="0" is obsolete.
</p>
</div>
</div>

<div id="outline-container-org5d4f513" class="outline-4">
<h4 id="org5d4f513"><span class="section-number-4">36.18.3</span> input, label</h4>
<div class="outline-text-4" id="text-36-18-3">
<p>
if &lt;input&gt; has no &lt;label&gt;, then add title attribute
</p>

<p>
Remove size attribute for input type file, confirm_email
</p>
<pre class="example">
$html = preg_replace('/(&lt;input type="file" [^&gt;]+) size=".*?"/si', '$1', $html);
</pre>
</div>
</div>

<div id="outline-container-orgee886ce" class="outline-4">
<h4 id="orgee886ce"><span class="section-number-4">36.18.4</span> pdf</h4>
<div class="outline-text-4" id="text-36-18-4">
<p>
PDF and Office documents need to set Title, Advanced &gt; Language in Document Properties
</p>

<p>
PDF and Office document image has to have title attribute.
</p>

<p>
Acrobat DC :: Edit &gt; Manage Tools &gt; add Accessibility to the right pane
</p>

<p>
Accessibility &gt; Full Check &gt; Click on items need alternate text to find on page and then doubleclick to select and then right click Tag as Figure
</p>

<p>
Accessibility &gt; Autotag Document will retag the whole document. The best approach is to add tag to image/figure because autotag might add links wrong based on text context. Do this:
</p>

<p>
Accessbility &gt; Reading Order &gt; Show Order Panel. Right click on the figure and Tag
</p>

<p>
Add Adobe Reader download link
<a href="http://www.adobe.com/ca/legal/permissions/icons-web-logos.html#adobereader">http://www.adobe.com/ca/legal/permissions/icons-web-logos.html#adobereader</a>
</p>

<p>
Get Adobe Reader
</p>

<pre class="example">
&lt;a href="http://www.adobe.com/go/getreader" target="_blank"&gt;&lt;img src="get-reader-158x39.png" alt="Get Adobe Reader DC"&gt;&lt;/a&gt;
</pre>

<p>
PDF/UA-1 compliance. PDF needs to have this XMP metadata to mark it as PDF/UA-1 compliant.
Tools &gt; Print Production &gt; Preflight, choose PDF Standards or Acrobat Pro DC 2015 Profiles as profile, choose the wrench tool icon (Select single fixups), expand to Document info and Metadata and choose Set PDF/UA-1 entry and then Fix.
</p>
</div>
</div>

<div id="outline-container-org92cffd7" class="outline-4">
<h4 id="org92cffd7"><span class="section-number-4">36.18.5</span> <a href="#orgdd4f0e1">meta viewport</a></h4>
</div>
<div id="outline-container-org23e144d" class="outline-4">
<h4 id="org23e144d"><span class="section-number-4">36.18.6</span> Skip to content link</h4>
<div class="outline-text-4" id="text-36-18-6">
<p>
Right below &lt;body&gt;
</p>
<pre class="example">
&lt;a id="skip-nav" href="#main-content"&gt;Skip to content&lt;/a&gt;
&lt;div id="main-content"&gt;&lt;/div&gt;
#skip-nav {
  position: absolute;
  top: -1000px;
  left: -1000px;
  height: 1px;
  width: 1px;
  text-align: left;
  overflow: hidden;
}
#skip-nav:active,
#skip-nav:focus,
#skip-nav:hover {
  width: auto;
  height: auto;
  position:static;
  overflow: visible;
}
</pre>
</div>
</div>

<div id="outline-container-org31a2290" class="outline-4">
<h4 id="org31a2290"><span class="section-number-4">36.18.7</span> Color Contrast Ratio</h4>
<div class="outline-text-4" id="text-36-18-7">
<p>
WCAG 2.0 level AA requires a contrast ratio of 4.5:1 for normal text and 3:1 for large text. Level AAA requires a contrast ratio of 7:1 for normal text and 4.5:1 for large text.
<a href="https://webaim.org/resources/contrastchecker/">https://webaim.org/resources/contrastchecker/</a>
<a href="http://leaverou.github.io/contrast-ratio/">http://leaverou.github.io/contrast-ratio/</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orge2d5841" class="outline-3">
<h3 id="orge2d5841"><span class="section-number-3">36.19</span> Screencast + Audio, FFmpeg</h3>
<div class="outline-text-3" id="text-36-19">
<p>
<a href="https://getsharex.com/">ShareX</a> Download the portable version, Task Settings &gt; Capture &gt; Screen recorder &gt; Screen recording options&#x2026;
Click Download to download the latest FFmpeg.exe
Under Sources, hit Refresh until you see the right Audio source.
Then go back to UI, Capture &gt; Screen recording
</p>

<p>
Convert a gif to mp4
</p>
<pre class="example">
ffmpeg.exe -i animated.gif -movflags faststart -pix_fmt yuv420p -vf "scale=trunc(iw/2)*2:trunc(ih/2)*2" video.mp4
</pre>

<dl class="org-dl">
<dt>-pix_fmt yuv420p</dt><dd>MP4 store pixels in different formats and this is the max compatible across all browsers.</dd>
<dt>-vf</dt><dd>MP4 videos using H.264 need to have a dimensions that are divisible by 2.</dd>
</dl>

<pre class="example">
&lt;img src="video.gif" alt="" width="400" height="300" /&gt;

&lt;video autoplay="autoplay" loop="loop" width="400" height="300"&gt;
  &lt;source src="video.mp4" type="video/mp4" /&gt;
  &lt;img src="video.gif" width="400" height="300" /&gt;
&lt;/video&gt;
</pre>
</div>
</div>

<div id="outline-container-org8607bc5" class="outline-3">
<h3 id="org8607bc5"><span class="section-number-3">36.20</span> Sketch Diagrams</h3>
<div class="outline-text-3" id="text-36-20">
<p>
<a href="https://bubbl.us/">https://bubbl.us/</a>
</p>
</div>
</div>

<div id="outline-container-org6eeb012" class="outline-3">
<h3 id="org6eeb012"><span class="section-number-3">36.21</span> Video</h3>
<div class="outline-text-3" id="text-36-21">
</div>
<div id="outline-container-org5b2cdd3" class="outline-4">
<h4 id="org5b2cdd3"><span class="section-number-4">36.21.1</span> Youtube Download</h4>
<div class="outline-text-4" id="text-36-21-1">
<p>
<a href="http://www.clipconverter.cc">http://www.clipconverter.cc</a>
</p>
</div>
</div>

<div id="outline-container-org474dc50" class="outline-4">
<h4 id="org474dc50"><span class="section-number-4">36.21.2</span> Kodi</h4>
<div class="outline-text-4" id="text-36-21-2">
</div>
<div id="outline-container-orga623b32" class="outline-5">
<h5 id="orga623b32"><span class="section-number-5">36.21.2.1</span> Settings</h5>
<div class="outline-text-5" id="text-36-21-2-1">
<ul class="org-ul">
<li>Display Chinese characters, you need to go to</li>
</ul>
<p>
Settings &gt; Appearance &gt; Fonts &gt; Arial based
</p>

<ul class="org-ul">
<li>Add apps to Homepage e.g. Video</li>
</ul>
<p>
Settings &gt; Appearance &gt; Settings &gt; Add-on
</p>
</div>
</div>

<div id="outline-container-org2427b80" class="outline-5">
<h5 id="org2427b80"><span class="section-number-5">36.21.2.2</span> File Manager</h5>
<div class="outline-text-5" id="text-36-21-2-2">
<ul class="org-ul">
<li><a href="https://aznhusband.github.io/">https://aznhusband.github.io/</a> App: icdrama</li>

<li><a href="http://fusion.tvaddons.ag/">http://fusion.tvaddons.ag/</a></li>
</ul>
<p>
Install from zip file
Folder xbmc-repos &gt; english &gt; 
</p>
<ul class="org-ul">
<li>repository.exodus-1.0.1.zip (Exodus repository)</li>
<li>repository.xbmchub-1.0.6.zip (TVADDONS.ag Addon Repository)</li>
<li>chinese-repository.kodi-addons-chinese-1.0.2.zip (Kodi Add-ons of Chinese)</li>
<li>chinese-repository.kodi-repo.zip (Joname's repo)</li>
<li>chinese-repository.xbmc-addons-chinese-1.2.0.zip (Chinese Add-ons repository)</li>
</ul>
<ul class="org-ul">
<li><a href="http://srp.nu">http://srp.nu</a></li>
</ul>
<p>
Install from zip file
Folder isengard &gt; all &gt; superrepo.kodi.isengard.all-0.7.04.zip (Superrepo All repository)
</p>
</div>
</div>

<div id="outline-container-org2022d9f" class="outline-5">
<h5 id="org2022d9f"><span class="section-number-5">36.21.2.3</span> Addons</h5>
<div class="outline-text-5" id="text-36-21-2-3">
<p>
Video
Exodus (Exodus Artwork) Use Torba, Putlocker as the video sources (Exodus repository)
Phoenix (TVADDONS.ag Addon Repository)git s
icdrama.se (Superrepo All repository)
azdrama.net (Superrepo All repository)
</p>

<p>
Subtitle
163sub (Chinese Add-ons repository)
Sub HD (Chinese Add-ons repository)
subom (Chinese Add-ons repository)
</p>

<p>
zimuku (Chinese Add-ons repository)
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf0b03d2" class="outline-3">
<h3 id="orgf0b03d2"><span class="section-number-3">36.22</span> Google</h3>
<div class="outline-text-3" id="text-36-22">
</div>
<div id="outline-container-orgfc88aaf" class="outline-4">
<h4 id="orgfc88aaf"><span class="section-number-4">36.22.1</span> Google Public DNS</h4>
<div class="outline-text-4" id="text-36-22-1">
<p>
8.8.8.8
8.8.4.4
</p>
</div>
</div>

<div id="outline-container-org7c4abe0" class="outline-4">
<h4 id="org7c4abe0"><span class="section-number-4">36.22.2</span> Google S2</h4>
<div class="outline-text-4" id="text-36-22-2">
<p>
Get favicon of any website
<a href="http://www.google.com/s2/favicons?domain=http://superuser.com/">http://www.google.com/s2/favicons?domain=http://superuser.com/</a>
</p>
</div>
</div>

<div id="outline-container-org57a722e" class="outline-4">
<h4 id="org57a722e"><span class="section-number-4">36.22.3</span> Google reCaptcha</h4>
<div class="outline-text-4" id="text-36-22-3">
<p>
<a href="https://developers.google.com/recaptcha/intro">https://developers.google.com/recaptcha/intro</a>
</p>
</div>

<div id="outline-container-org8a286b0" class="outline-5">
<h5 id="org8a286b0"><span class="section-number-5">36.22.3.1</span> Client - Basic</h5>
<div class="outline-text-5" id="text-36-22-3-1">
<pre class="example">
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;reCAPTCHA demo: Simple page&lt;/title&gt;
     &lt;script src="https://www.google.com/recaptcha/api.js" async defer&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;form action="?" method="POST"&gt;
      &lt;div class="g-recaptcha" data-sitekey="your_site_key"&gt;&lt;/div&gt;
      &lt;br/&gt;
      &lt;input type="submit" value="Submit"&gt;
    &lt;/form&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>
</div>
</div>

<div id="outline-container-orgfce6b57" class="outline-5">
<h5 id="orgfce6b57"><span class="section-number-5">36.22.3.2</span> Client - Defer loading, explict rendering one widget/instance</h5>
<div class="outline-text-5" id="text-36-22-3-2">
<pre class="example">
&lt;script type="text/javascript"&gt;
  var onloadCallback = function() {
    alert("grecaptcha is ready!");
    grecaptch.render('html_element', {
      'sitekey' : 'your_site_key'
    });
  };
&lt;/script&gt;

&lt;form action="?" method="POST"&gt;
      &lt;div id="html_element"&gt;&lt;/div&gt;
      &lt;br&gt;
      &lt;input type="submit" value="Submit"&gt;
&lt;/form&gt;

&lt;script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&amp;render=explicit"
        async defer&gt;
&lt;/script&gt;
</pre>
</div>
</div>

<div id="outline-container-org28efb53" class="outline-5">
<h5 id="org28efb53"><span class="section-number-5">36.22.3.3</span> Client - Multiple reCaptcha widgets/instance</h5>
<div class="outline-text-5" id="text-36-22-3-3">
<pre class="example">
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;reCAPTCHA demo: Explicit render for multiple widgets&lt;/title&gt;
    &lt;script type="text/javascript"&gt;
      var verifyCallback = function(response) {
        alert(response);
      };
      var widgetId1;
      var widgetId2;
      var onloadCallback = function() {
        // Renders the HTML element with id 'example1' as a reCAPTCHA widget.
        // The id of the reCAPTCHA widget is assigned to 'widgetId1'.
        widgetId1 = grecaptcha.render('example1', {
          'sitekey' : 'your_site_key',
          'theme' : 'light'
        });
        widgetId2 = grecaptcha.render(document.getElementById('example2'), {
          'sitekey' : 'your_site_key'
        });
        grecaptcha.render('example3', {
          'sitekey' : 'your_site_key',
          'callback' : verifyCallback,
          'theme' : 'dark'
        });
      };
    &lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;!-- The g-recaptcha-response string displays in an alert message upon submit. --&gt;
    &lt;form action="javascript:alert(grecaptcha.getResponse(widgetId1));"&gt;
      &lt;div id="example1"&gt;&lt;/div&gt;
      &lt;br&gt;
      &lt;input type="submit" value="getResponse"&gt;
    &lt;/form&gt;
    &lt;br&gt;
    &lt;!-- Resets reCAPTCHA widgetId2 upon submit. --&gt;
    &lt;form action="javascript:grecaptcha.reset(widgetId2);"&gt;
      &lt;div id="example2"&gt;&lt;/div&gt;
      &lt;br&gt;
      &lt;input type="submit" value="reset"&gt;
    &lt;/form&gt;
    &lt;br&gt;
    &lt;!-- POSTs back to the page's URL upon submit with a g-recaptcha-response POST parameter. --&gt;
    &lt;form action="?" method="POST"&gt;
      &lt;div id="example3"&gt;&lt;/div&gt;
      &lt;br&gt;
      &lt;input type="submit" value="Submit"&gt;
    &lt;/form&gt;
    &lt;script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&amp;render=explicit"
        async defer&gt;
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>
</div>
</div>

<div id="outline-container-org4e66dcb" class="outline-5">
<h5 id="org4e66dcb"><span class="section-number-5">36.22.3.4</span> api.js options</h5>
<div class="outline-text-5" id="text-36-22-3-4">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">onload</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Optional. The name of your callback function to be executed once all the dependencies have loaded.</td>
</tr>

<tr>
<td class="org-left">render</td>
<td class="org-left">explict onload</td>
<td class="org-left">Optional. Whether to render the widget explicitly.</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Defaults to onload, which will render the widget in the first g-recaptcha tag it finds.</td>
</tr>

<tr>
<td class="org-left">hl</td>
<td class="org-left">See language codes</td>
<td class="org-left">Optional. Forces the widget to render in a specific language.</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Auto-detects the user's language if unspecified.</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgb7d18fa" class="outline-5">
<h5 id="orgb7d18fa"><span class="section-number-5">36.22.3.5</span> class="g-recaptcha" tag attributes</h5>
<div class="outline-text-5" id="text-36-22-3-5">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">tag attribute</td>
<td class="org-left">grecaptcha.render parameter</td>
<td class="org-left">Value</td>
<td class="org-left">Default</td>
<td class="org-left">Description</td>
</tr>

<tr>
<td class="org-left">data-sitekey</td>
<td class="org-left">sitekey</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Your sitekey.</td>
</tr>

<tr>
<td class="org-left">data-theme</td>
<td class="org-left">theme</td>
<td class="org-left">dark</td>
<td class="org-left">light</td>
<td class="org-left">Optional. Color</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">light</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">data-type</td>
<td class="org-left">type</td>
<td class="org-left">audio</td>
<td class="org-left">image</td>
<td class="org-left">Optional.</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">image</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">data-size</td>
<td class="org-left">size</td>
<td class="org-left">compact</td>
<td class="org-left">normal</td>
<td class="org-left">Optional.</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">normal</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">data-tabindex</td>
<td class="org-left">tabindex</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">0</td>
<td class="org-left">Optional.</td>
</tr>

<tr>
<td class="org-left">data-callback</td>
<td class="org-left">callback</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Optional.</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">To execute when the user submits</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">a successful response: g-recaptcha-response</td>
</tr>

<tr>
<td class="org-left">data-expired-callback</td>
<td class="org-left">expired-callback</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Optional.</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">To execute when recaptcha response expires</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">and the user needs to solve a new CAPTCHA</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org2ca51d4" class="outline-5">
<h5 id="org2ca51d4"><span class="section-number-5">36.22.3.6</span> JavaScript API</h5>
<div class="outline-text-5" id="text-36-22-3-6">
</div>
<ol class="org-ol">
<li><a id="org49cd1bd"></a>grecaptcha.render(container,parameters)<br />
<div class="outline-text-6" id="text-36-22-3-6-1">
<p>
Renders the container as a reCAPTCHA widget and returns the ID of the newly created widget.
container :: The HTML element to render the reCAPTCHA widget.  Specify either the ID of the container (string) or the DOM element itself.
parameters :: An object containing parameters as key=value pairs, for example, {"sitekey": "your_site_key", "theme": "light"}. See grecaptcha.render parameters.
</p>
</div>
</li>

<li><a id="org276d780"></a>grecaptcha.reset(opt_widget_id)<br />
<div class="outline-text-6" id="text-36-22-3-6-2">
<p>
Resets the reCAPTCHA widget.
opt_widget_id
  Optional widget ID, defaults to the first widget created if unspecified.
</p>
</div>
</li>

<li><a id="orgf028de5"></a>grecaptcha.getResponse(opt_widget_id)<br />
<div class="outline-text-6" id="text-36-22-3-6-3">
<p>
Gets the response for the reCAPTCHA widget.
opt_widget_id
  Optional widget ID, defaults to the first widget created if unspecified.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org42fbf5f" class="outline-5">
<h5 id="org42fbf5f"><span class="section-number-5">36.22.3.7</span> Server Validation</h5>
<div class="outline-text-5" id="text-36-22-3-7">
<p>
For web users, a new field (g-recaptcha-response) will be populated in HTML and you can get the user’s response in one of three ways:
</p>

<ol class="org-ol">
<li>g-recaptcha-response POST parameter when the user submits the form on your site</li>
<li>grecaptcha.getResponse(opt_widget_id) after the user completes the CAPTCHA challenge</li>
<li>As a string argument to your callback function if data-callback is specified in either the g-recaptcha tag attribute or the callback parameter in the grecaptcha.render method</li>
</ol>

<p>
URL: <a href="https://www.google.com/recaptcha/api/siteverify">https://www.google.com/recaptcha/api/siteverify</a>
METHOD: POST
</p>

<p>
Parameters
secret :: Required. The shared key between your site and reCAPTCHA.
response :: Required. The user response token provided by reCAPTCHA, verifying the user on your site.
remoteip :: Optional. The user's IP address.
</p>

<p>
API Response
</p>
<pre class="example">
{
  "success": true|false,
  "challenge_ts": timestamp,  // timestamp of the challenge load (ISO format yyyy-MM-dd'T'HH:mm:ssZZ)
  "hostname": string,         // the hostname of the site where the reCAPTCHA was solved
  "error-codes": [...]        // optional
}
</pre>

<p>
Error codes
missing-input-secret :: The secret parameter is missing.
invalid-input-secret :: The secret parameter is invalid or malformed.
missing-input-response :: The response parameter is missing.
invalid-input-response :: The response parameter is invalid or malformed.
bad-request :: The request is invalid or malformed.
</p>

<p>
PHP
</p>
<pre class="example">
private function validateReCaptcha() {
  if (!isset($_POST['g-recaptcha-response']))
    return FALSE;
  $C_CAPTCHA                = $_POST['g-recaptcha-response'];
  $C_CAPTCHA_google_request = [
    'url'     =&gt; 'https://www.google.com/recaptcha/api/siteverify',
    'options' =&gt; [
      'secret'   =&gt; 'your-key',
      'response' =&gt; $C_CAPTCHA,
    ],
  ];

  $ch      = curl_init();
  $options = [
    CURLOPT_URL            =&gt; $C_CAPTCHA_google_request['url'],
    CURLOPT_POSTFIELDS     =&gt; http_build_query($C_CAPTCHA_google_request['options']),
    CURLOPT_FOLLOWLOCATION =&gt; 1,
    CURLOPT_HEADER         =&gt; 0,
    CURLOPT_RETURNTRANSFER =&gt; 1,
  ];
  curl_setopt_array($ch, $options);
  $C_CAPTCHA_google_result = json_decode(curl_exec($ch), TRUE);
  curl_close($ch);

  if (is_array($C_CAPTCHA_google_result) &amp;&amp; $C_CAPTCHA_google_result['success'] === TRUE) {
    return TRUE;
  }
}
</pre>
</div>
</div>

<div id="outline-container-org31aadc3" class="outline-5">
<h5 id="org31aadc3"><span class="section-number-5">36.22.3.8</span> CSS</h5>
<div class="outline-text-5" id="text-36-22-3-8">
<p>
The button might be too large for width &lt; 320px
</p>
<pre class="example">
@media (max-width: 320px) {
  .g-recaptcha {
    transform:scale(0.77);
    -webkit-transform:scale(0.77);
    transform-origin:0 0;
    -webkit-transform-origin:0 0;
  }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org4182eb5" class="outline-4">
<h4 id="org4182eb5"><span class="section-number-4">36.22.4</span> Google Search - Advanced</h4>
<div class="outline-text-4" id="text-36-22-4">
<p>
<a href="https://bynd.com/news-ideas/google-advanced-search-comprehensive-list-google-search-operators/">https://bynd.com/news-ideas/google-advanced-search-comprehensive-list-google-search-operators/</a>
</p>

<p>
<a href="https://support.google.com/websearch/answer/2466433">https://support.google.com/websearch/answer/2466433</a>
</p>

<p>
Search operators: <a id="org6dd2b2c">google:search operators</a>
</p>
<pre class="example">
site:nytimes.com
site:.gov
@twitter
camera $400
#throwbackthursday
jaguar speed -car
"tallest building"
largest * in the world
$50..$100
marathon OR race
related:time.com
# get details about a site
info:time.com
cache:time.com
</pre>

<p>
Google Search usually ignores punctuation that isn’t part of a search operator.
</p>
</div>
</div>

<div id="outline-container-orga87c406" class="outline-4">
<h4 id="orga87c406"><span class="section-number-4">36.22.5</span> Google Ads Personalization Setting</h4>
<div class="outline-text-4" id="text-36-22-5">
<p>
<a href="https://www.google.com/settings/ads">https://www.google.com/settings/ads</a>
</p>
</div>
</div>

<div id="outline-container-org0bcbacc" class="outline-4">
<h4 id="org0bcbacc"><span class="section-number-4">36.22.6</span> Partners</h4>
<div class="outline-text-4" id="text-36-22-6">
<p>
First, set up your company as a Google Partners.
</p>
<ul class="org-ul">
<li>Use a non-gmail email address to create an account to google.com/partners e.g. abc@yourcompany.com</li>
<li>abc@yourcompany.com has to have edit or admin access to an AdWords account. This AdWords account can be registered using any Google account. Login to that AdWords account and add abc@yourcompany.com with edit or admin access.</li>
<li>Once you created one Partner Profile account, go to Overview &gt; My Profile, fill up address and phone number and select AdWords account as the "Top-level AdWords manager account"</li>
<li>Go back to Overview, and add your company</li>
</ul>

<p>
After that, any Google account users without @yourcompany.com can affiliate with that company. However, an individual can only affiliate with one company.
</p>

<ul class="org-ul">
<li>Sign in as abc@yourcompany.com to Google Partners and go to Overview &gt; My Company &gt; People to approve affiliation requests.</li>
</ul>

<p>
An Individual can work with who ever they wish, but can only affiliate their credentials of passing the required exams to ONE Company.
</p>
<ul class="org-ul">
<li>An individual is now required to have admin, standard or read-only access to the company's AdWords manager account.</li>
</ul>

<p>
Google Partner is set up in basically for Companies that meet certain requirements of Certification, Ad Spend, and Best Practices qualify and earn the GOOGLE PARTNERS BADGE.
</p>

<p>
The benefit is to the company to have your credential of passing the exams on their roster, or towards them fulfilling the TEST requirements to become a Google Partner
</p>

<p>
Individuals who receive certification but are not considered Google Partners unless they meet the other requirements of Best Practices (from their linked MCC account) and Ad Spend levels.
</p>
</div>
</div>

<div id="outline-container-org0f953bb" class="outline-4">
<h4 id="org0f953bb"><span class="section-number-4">36.22.7</span> Gmail</h4>
<div class="outline-text-4" id="text-36-22-7">
<p>
Use Gmail SMTP to send emails
</p>

<p>
Turn off 2-Step-Verification or use the <a href="https://support.google.com/accounts/answer/185833?hl=en">App Password</a>. 
</p>

<p>
If you can't setup App Password, it's because 2-Step-Verification is not turned on.
</p>

<p>
In that case, <a href="https://support.google.com/accounts/answer/6010255?hl=en">Let less secure apps use your account</a>.
</p>

<p>
Which is here: <a href="https://myaccount.google.com/lesssecureapps">https://myaccount.google.com/lesssecureapps</a>
</p>
</div>
</div>

<div id="outline-container-org3608d46" class="outline-4">
<h4 id="org3608d46"><span class="section-number-4">36.22.8</span> Non-gmail email address as Google Account</h4>
<div class="outline-text-4" id="text-36-22-8">
<p>
First create a Gmail account abc@gmail.com then go to My Account &gt; Personal Info &amp; privacy &gt; Your personal info &gt; Email &gt; Advanced &gt; Alternate emails &gt; Add alternate email.
</p>

<p>
This is to add an alternate non-gmail email address to your Gmail email account.
</p>

<p>
These alternate non-gmail email addresses can be used to signin, recover password, get notifications and more.
</p>

<p>
Using Google products e.g. Google Docs, will show your primary gmail email address.
</p>
</div>
</div>

<div id="outline-container-orgb40b711" class="outline-4">
<h4 id="orgb40b711"><span class="section-number-4">36.22.9</span> Google Surveys</h4>
</div>
<div id="outline-container-org3aa16f7" class="outline-4">
<h4 id="org3aa16f7"><span class="section-number-4">36.22.10</span> Google Correlate</h4>
<div class="outline-text-4" id="text-36-22-10">
<p>
Use it to find other search keywords that are related to your keyword!
</p>
</div>
</div>

<div id="outline-container-org3b205e8" class="outline-4">
<h4 id="org3b205e8"><span class="section-number-4">36.22.11</span> Google Planning Tools</h4>
<div class="outline-text-4" id="text-36-22-11">
<p>
<a href="https://www.thinkwithgoogle.com/tools/">https://www.thinkwithgoogle.com/tools/</a>
</p>
</div>
</div>

<div id="outline-container-org5e1e84e" class="outline-4">
<h4 id="org5e1e84e"><span class="section-number-4">36.22.12</span> Tools for Web Developers</h4>
<div class="outline-text-4" id="text-36-22-12">
</div>
<div id="outline-container-orgfa1ff76" class="outline-5">
<h5 id="orgfa1ff76"><span class="section-number-5">36.22.12.1</span> Lighthouse in DevTools <a id="org7dfee75">chrome:lighthouse</a></h5>
<div class="outline-text-5" id="text-36-22-12-1">
<p>
It only measures mobile device
</p>
</div>
</div>

<div id="outline-container-org0e46073" class="outline-5">
<h5 id="org0e46073"><span class="section-number-5">36.22.12.2</span> <a href="https://search.google.com/test/mobile-friendly">Mobile-Friendly Test</a> <a href="https://testmysite.thinkwithgoogle.com/">WebPageTest.org provided by Google</a></h5>
</div>
<div id="outline-container-orgf9a2372" class="outline-5">
<h5 id="orgf9a2372"><span class="section-number-5">36.22.12.3</span> <a href="https://developers.google.com/speed/">PageSpeed</a> <a id="org290a8ef">google:pagespeed</a></h5>
</div>
<div id="outline-container-org39f536c" class="outline-5">
<h5 id="org39f536c"><span class="section-number-5">36.22.12.4</span> Fetch as Google <a href="#org5e9364e">google:search console</a></h5>
<div class="outline-text-5" id="text-36-22-12-4">
<p>
For sites that you don't own :: <a href="https://technicalseo.com/seo-tools/fetch-render/">https://technicalseo.com/seo-tools/fetch-render/</a> or do an iframe like this and then use Fetch as Google
</p>
<pre class="example">
&lt;html&gt;
&lt;head&gt;&lt;title&gt;Fetch &amp;amp; Render Proxy&lt;/title&gt;
&lt;/head&gt;
&lt;body style="margin:0px;padding:0px"&gt;
&lt;iframe src="http://www.example.com/" frameborder="0" style="overflow:hidden;height:10000;width:1024" height="10000" width="1024"&gt;&lt;/iframe&gt;
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
</div>
</div>

<div id="outline-container-org5e73e6d" class="outline-5">
<h5 id="org5e73e6d"><span class="section-number-5">36.22.12.5</span> Rich Snippet Testing Tool, Structured Data Testing Tool <a href="#org63ffcf7">google:json-ld</a></h5>
<div class="outline-text-5" id="text-36-22-12-5">
<p>
Test websites that you own and don't
</p>
</div>
</div>

<div id="outline-container-org45f6f2e" class="outline-5">
<h5 id="org45f6f2e"><span class="section-number-5">36.22.12.6</span> Google Site Status (security) <a id="org9f9b13c">google:site status</a></h5>
<div class="outline-text-5" id="text-36-22-12-6">
<p>
Google Site Status :: <a href="https://transparencyreport.google.com/safe-browsing/search">https://transparencyreport.google.com/safe-browsing/search</a>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org620acbd" class="outline-3">
<h3 id="org620acbd"><span class="section-number-3">36.23</span> Translation</h3>
<div class="outline-text-3" id="text-36-23">
<p>
<a id="org3bd4eca">tool:Poedit</a>
Open .pot and .po files in <a href="https://poedit.net/">Poedit</a>
</p>

<p>
<a href="https://localise.biz/free/poeditor">Online Editor</a>. Send .po file to customer who will translate online and they can save and send back the translated .po!
</p>
</div>
</div>

<div id="outline-container-org4e81463" class="outline-3">
<h3 id="org4e81463"><span class="section-number-3">36.24</span> HTML Minimizer, document.write</h3>
<div class="outline-text-3" id="text-36-24">
<p>
Online minimizer
</p>
<ul class="org-ul">
<li><a href="http://www.willpeavy.com/minifier/">http://www.willpeavy.com/minifier/</a></li>
<li><a href="https://www.textfixer.com/html/compress-html-compression.php">https://www.textfixer.com/html/compress-html-compression.php</a></li>
<li><a href="http://htmlcompressor.com/compressor/">http://htmlcompressor.com/compressor/</a></li>
</ul>

<p>
Node.js minimizer
</p>
<ul class="org-ul">
<li><a href="https://www.npmjs.com/package/html-minifier">https://www.npmjs.com/package/html-minifier</a></li>
</ul>

<p>
<a id="org401f1c0">tool:html:document.write</a>
Online convert a single line html to document.write
</p>
<ul class="org-ul">
<li><a href="http://accessify.com/tools-and-wizards/developer-tools/html-javascript-convertor/">http://accessify.com/tools-and-wizards/developer-tools/html-javascript-convertor/</a></li>
<li><a href="http://www.andrewdavidson.com/convert-html-to-javascript/">http://www.andrewdavidson.com/convert-html-to-javascript/</a></li>
</ul>

<p>
document.write("string") where string has to escape:
</p>
<ul class="org-ul">
<li>double quotes <code>\"</code></li>
<li>backward slash <code>\\</code></li>
<li>forward slash <code>\/</code> as "&lt;/tag&gt;" causes an error</li>
</ul>

<p>
Use document.write is not a good idea and the usage will be blocked only when all the following conditions are met:
</p>

<ul class="org-ul">
<li>The user is experiencing a very poor network connectivity,</li>
<li>The script is parser-blocking (neither async nor defer attributes) and is not already in the browser cache,</li>
<li>The instruction is added in the top level document (e.g. iframes won’t be concerned),</li>
</ul>

<p>
Use e.innerHTML('') to insert elements, refer to <a href="#org343612c">js:external script</a> to load javascript
</p>
</div>
</div>

<div id="outline-container-org88167ec" class="outline-3">
<h3 id="org88167ec"><span class="section-number-3">36.25</span> CloudConvert.com</h3>
<div class="outline-text-3" id="text-36-25">
<p>
Provides NPM module for batch processing.
</p>
</div>
</div>

<div id="outline-container-orgba8ea2a" class="outline-3">
<h3 id="orgba8ea2a"><span class="section-number-3">36.26</span> Online App Publishing</h3>
<div class="outline-text-3" id="text-36-26">
</div>
<div id="outline-container-org3162d4f" class="outline-4">
<h4 id="org3162d4f"><span class="section-number-4">36.26.1</span> <a href="https://glitch.com">https://glitch.com</a></h4>
<div class="outline-text-4" id="text-36-26-1">
<p>
Node.js with SQLite, Webpage
</p>
</div>
</div>

<div id="outline-container-org417a56c" class="outline-4">
<h4 id="org417a56c"><span class="section-number-4">36.26.2</span> <a href="https://www.bitballoon.com">https://www.bitballoon.com</a></h4>
<div class="outline-text-4" id="text-36-26-2">
<p>
Webpage
</p>
</div>
</div>

<div id="outline-container-org813e068" class="outline-4">
<h4 id="org813e068"><span class="section-number-4">36.26.3</span> <a href="https://zeit.co/">https://zeit.co/</a></h4>
<div class="outline-text-4" id="text-36-26-3">
<p>
Node.js, Dockerfile
</p>
</div>
</div>
</div>

<div id="outline-container-org135c8fd" class="outline-3">
<h3 id="org135c8fd"><span class="section-number-3">36.27</span> Email</h3>
<div class="outline-text-3" id="text-36-27">
</div>
<div id="outline-container-orgad4af4e" class="outline-4">
<h4 id="orgad4af4e"><span class="section-number-4">36.27.1</span> SendGrid</h4>
<div class="outline-text-4" id="text-36-27-1">
<p>
You can create website specific users who can use to authenticate SMTP and API.
Sign to main account and go to Settings &gt; Credentials
</p>

<p>
Add a header X-SMTPAPI as JSON to assign category shown on SendGrid.com Stats and Activity
Drupal way =$message['header']['X-SMTPAPI'] = '{"category": ["fromwebsiteA"]}' =
</p>

<ul class="org-ul">
<li>Drupal</li>
</ul>
<p>
Use the SMTP Authentication Support module (smtp) and go to /admin/config/system/smtp to config
Install Options - turn this module on
SMTP server: smtp.sendgrid.net
SMTP port: 465 (587 is being used&#x2026;)
Use encripted protocol: Use SSL
</p>
<ul class="org-ul">
<li>Wordpress</li>
</ul>
<p>
Install plugin <a href="https://wordpress.org/plugins/sendgrid-email-delivery-simplified">SendGrid</a> Refer to GitHub for setting config in wp-config.php
</p>
</div>

<div id="outline-container-org58a04db" class="outline-5">
<h5 id="org58a04db"><span class="section-number-5">36.27.1.1</span> Whitelabel</h5>
<div class="outline-text-5" id="text-36-27-1-1">
<p>
2 types of whitelabel: domain and email link.
</p>
<ul class="org-ul">
<li>Domain whitelabel</li>
</ul>
<p>
adds a SPF (Sender Policy Framework) record to your domain and DKIM (DomainKeys Indentified Mail) entries,
which authorizes and authenticates SendGrid sending on behalf of your domain. It basically removes "sent on behalf of SendGrid" or "via"
message that some email providers dispaly.
</p>

<p>
The sent domain is the domain of the email address from "From".
</p>

<p>
Usually, you need to create one subdomain per main domain. e.g. delivery.yourdomain.com
</p>

<p>
With Automated Security checked, SendGrid will show you to create 3 CNAME records for your DNS registrar.
</p>

<p>
Some DNS registrar might not support _ in subdomains in CNAME host. In this case, don't check Automated Security.
</p>

<p>
Without Automated Security checked, 1 MX and 2 TXT records are provided from SendGrid.
</p>

<ul class="org-ul">
<li>Email link whitelabel</li>
</ul>
<p>
adds a CNAME record for a a subdomain that you choose, which masks click and open-tracking links to your domain 
rather than a SendGrid domain. e.g. In email body there's a link yourdomain.com. Before email link whitelabel is setup,
the sent out email with this link changed to SendGrid domain. After whitelabel is setup, this link is changed to e.g. click.yourdomain.com
</p>

<p>
This subdomain has to be different from the Domain whitelable subdomain.
</p>

<p>
SendGrid will show you 2 CNAMES per subdomain setup.
</p>
</div>
</div>

<div id="outline-container-org2c1ff1f" class="outline-5">
<h5 id="org2c1ff1f"><span class="section-number-5">36.27.1.2</span> PHPMailer</h5>
<div class="outline-text-5" id="text-36-27-1-2">
<pre class="example">
date_default_timezone_set('America/Toronto');
require_once(__DIR__.'/../../../wp-includes/class-phpmailer.php');

$receipients = array('a@b.com');
$subject = '';
$body = '';
$html = &lt;&lt;&lt;HTML
    &lt;html&gt;
    &lt;head&gt;
      &lt;title&gt;{$subject}&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
      {$body}
    &lt;/body&gt;
    &lt;/html&gt;
HTML;

$mail = new \PHPMailer();
$mail-&gt;isSMTP();
//$mail-&gt;SMTPDebug = 2; // 0 for off in production
$mail-&gt;SMTPDebug = 0;
$mail-&gt;Host = 'smtp.sendgrid.net';
$mail-&gt;SMTPAuth=true;
$mail-&gt;Username= 'apikey'; // literally 'apikey'
$mail-&gt;Password= 'secret key';
$mail-&gt;Port = 587;
$mail-&gt;CharSet= 'UTF-8';
$mail-&gt;SetFrom('donotreply@myweb.com', 'My Website');

$mail-&gt;addCustomHeader('X-SMTPAPI', '{"category": ["fromwebsiteA"]}');

foreach ($reciepients as $v) {
  $mail-&gt;AddAddress($v);
}

$mail-&gt;Subject = $subject;
$mail-&gt;MsgHTML($html);

if (!$mail-&gt;Send()) {
  return 'error: '.$mail-&gt;ErrorInfo;
}
else {
  return 'success';
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgad6b172" class="outline-4">
<h4 id="orgad6b172"><span class="section-number-4">36.27.2</span> DMARC, SPF, DKIM</h4>
<div class="outline-text-4" id="text-36-27-2">
<p>
Domain-based Message Authentication, Reporting, and Conformance.
</p>

<p>
It serves as a method of authentication for your brand, alongside Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM).
</p>

<p>
What sets DMARC apart from the other two authentication methods is its reporting capability.
</p>

<p>
DMARC is an email authentication technology that protects a domain from being used in phishing and spoofing attempts by using a signing policy to define how receiving inbox providers should handle messages that fail an authentication check. DMARC also allows for a reporting mechanism in which inbox providers can send reports on email that appears to be sent from a certain domain back to the domain owner.
</p>

<p>
Inbox providers that support DMARC will attempt to validate both DKIM and SPF, and depending on the outcome of those checks, will look to the sending domain's DMARC policy on how to handle emails that fail authentication.
</p>

<p>
If the inbox provider is able to successfully validate either DKIM or SPF, the email will continue on its normal path. If the message fails both DKIM and SPF authentication checks, however, the inbox provider will enforce the sender’s DMARC policy, which specifies how the email should be handled if it fails authentication and where to send any reports.
</p>

<p>
DMARC has three levels of policy:
</p>

<p>
None: If the policy is set to none, the receiving inbox provider monitors and reports on metrics.
Quarantine: If the DMARC policy is set to quarantine, the inbox provider places messages that fail the required checks into the user's spam folder.
Reject: If the policy is set to reject, the inbox provider will block any message that fails authentication.
</p>

<p>
<a href="https://sendgrid.com/blog/dmarc-domain-based-message-authentication-reporting-conformance/">https://sendgrid.com/blog/dmarc-domain-based-message-authentication-reporting-conformance/</a>
</p>
</div>
</div>

<div id="outline-container-org769706a" class="outline-4">
<h4 id="org769706a"><span class="section-number-4">36.27.3</span> Preview text</h4>
<div class="outline-text-4" id="text-36-27-3">
<p>
Preview text is the hidden text that is the first element in the body and it should be at least 90 characters long. Img alt attribute values.
</p>

<pre class="example">
&lt;div style="display:none;font-size:1px;color:#333333;line-height:1px;max-height:0px;max-width:0px;opacity:0;overflow:hidden;"&gt;
  Insert preview text here.
&lt;/div&gt;

&lt;!-- Insert &amp;zwnj;&amp;nbsp; hack after hidden preview text. 10 characters --&gt;
&lt;div style="display: none; max-height: 0px; overflow: hidden;"&gt;
&amp;nbsp;&amp;zwnj;&amp;nbsp;&amp;zwnj;&amp;nbsp;&amp;zwnj;&amp;nbsp;&amp;zwnj;&amp;nbsp;&amp;zwnj;
&lt;/div&gt;
</pre>
</div>
</div>

<div id="outline-container-org6f02e31" class="outline-4">
<h4 id="org6f02e31"><span class="section-number-4">36.27.4</span> Send test HTML email for free</h4>
<div class="outline-text-4" id="text-36-27-4">
<p>
<a href="https://htmlmail.pro/">https://htmlmail.pro/</a> use your Gmail to send HTML emails.
</p>
</div>
</div>
</div>

<div id="outline-container-org336da96" class="outline-3">
<h3 id="org336da96"><span class="section-number-3">36.28</span> Payment Gateway</h3>
<div class="outline-text-3" id="text-36-28">
</div>
<div id="outline-container-org76d7a80" class="outline-4">
<h4 id="org76d7a80"><span class="section-number-4">36.28.1</span> Chase E-xact Gateway <a id="org80f28e1">payment:chase</a></h4>
<div class="outline-text-4" id="text-36-28-1">
<p>
Chase Paymentech
</p>

<p>
Chase Payment Gateway
Test mode form goes to <a href="https://rpm.demo.e-xact.com/payment">https://rpm.demo.e-xact.com/payment</a>
Normal mode form goes to <a href="https://checkout.e-xact.com/payment">https://checkout.e-xact.com/payment</a>
</p>

<p>
Payment Page Settings
General
	Return to Your Site URL is hard coded. It's shown when a user comes to Payment Page and sees a Return to Website if the user doesn't want to proceed. And it also serves as a go back link when timeout happens.
Receipt Page
	AUTO-POST, AUTO-GET don't display a receipt on Chase Payment Gateway but instead post the transcaction result to your website
	POST, GET display a receipt on chase Payment Gateway and a button including a link to GET or POST back to your website.
	Unfortunately, this link cannot be dynamic.
</p>

<p>
Relay Response
Transaction result is POST to your site and your site responds with HTML which E-xact later displays. The response is usually a custom receipt. If response is not received in 25 seconds, E-xact will display its own receipt.
You can give a dynamic relay response url in the submit form rather than a static url setup in E-xact Payment Page setting page. The form field is x_relay_url
If replay response is required, in submit form you should add a hidden form field
&lt;input name="x_relay_response" value="TRUE" type="hidden"&gt;
Silent Post
Same as replay response but the response is ignored. The sequence of silent post and relay response is not guaranteed!
</p>

<p>
Chase Payment Gateway Form
Create a Payment Page and you will get transaction_key, page_id, response_key
</p>

<p>
Do not expose transaction_key, page_id, response_key!!
</p>

<p>
Form field for submit (required fields)
x_login :: page_id
x_invoice_num :: your internal order id $order_number
x_fp_sequence :: Random number e.g. your internal order id. $order_number
x_fp_timestamp :: Requests expire after 15 minutes. Time in seconds. php :: time(). $x_fp_timestamp
x_amount :: positive number. $x_amount
x_fp_hash :: string. 
	HMAC-MD5 hash from the transaction_key and concatenation of the values for x_login, x_fp_sequence, x_fp_timestamp, x_amount and (if given) x_currency_code. Separated by ^.
	php : 
	hash_hmac('MD5', 
	$page_id. '^' . $order_number. '^' . $x_fp_timestamp. '^' . $x_amount. '^CAD'
	, $transaction_key);
x_show_form :: 'PAYMENT_FORM', constant
</p>

<p>
Post back data and fields
<a href="https://hostedcheckout.zendesk.com/hc/en-us/articles/114094066114#10.1">https://hostedcheckout.zendesk.com/hc/en-us/articles/114094066114#10.1</a>
x_response_code
	1 for approved, 2 for process but not approved, 3 for not processed including cancel
</p>

<p>
x_response_reason_code
	1 for approved, 2 for declined, 3 for error
x_response_reason_text
</p>

<p>
x_invoice_num :: the same as x_fp_sequence in TandT case
x_fp_sequence
</p>

<p>
x_test_request
	boolean. If it's in test mode, true
exact_ctr
	string. Receipt string. Successful or failed, always return a string. Always show!
exact_issname
	string. Issuing Bank name
exact_issconf
	string. Issuing Bank Confirmation Number
x_fp_timestamp
x_MD5_Hash
</p>

<p>
You need to validate the post back value if 
$_POST['x_MD5_Hash'] == md5($response_key. $_POST['x_login'] . $_POST['x_trans_id'] . $_POST['x_amount']);
</p>
</div>
</div>

<div id="outline-container-org7cfa7a5" class="outline-4">
<h4 id="org7cfa7a5"><span class="section-number-4">36.28.2</span> Moneris Payment Gateway <a id="org2b7c5e3">payment:moneris</a></h4>
<div class="outline-text-4" id="text-36-28-2">
<p>
<a href="https://developer.moneris.com/More/Testing/Testing%20a%20Solution">https://developer.moneris.com/More/Testing/Testing a Solution</a>
<a href="https://developer.moneris.com/More/Testing/Penny%20Value%20Simulator">https://developer.moneris.com/More/Testing/Penny Value Simulator</a>
</p>

<dl class="org-dl">
<dt>Visa</dt><dd>4242424242424242 4502285070000007</dd>
<dt>MasterCard</dt><dd>5454545454545454</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org601a867" class="outline-3">
<h3 id="org601a867"><span class="section-number-3">36.29</span> Marketing Research &amp; Agency</h3>
<div class="outline-text-3" id="text-36-29">
<p>
<a href="https://vividata.ca/">https://vividata.ca/</a>
</p>

<p>
<a href="https://hashtagpaid.com/">https://hashtagpaid.com/</a> :: AI to find influencers
</p>
</div>
</div>

<div id="outline-container-orgf504b23" class="outline-3">
<h3 id="orgf504b23"><span class="section-number-3">36.30</span> W3C</h3>
<div class="outline-text-3" id="text-36-30">
<ul class="org-ul">
<li>Working Draft</li>
<li>Last Call</li>
<li>Candidate Recommenation (CR, Standard)</li>
<li>Proposed Recommendation (PR)</li>
<li>Recommendation (REC)</li>
<li>Working Group Note, Interest Group Note (NOTE) which may make Editor's Drafts (ED, API's may take this as a strong signal..)</li>
</ul>
</div>
</div>

<div id="outline-container-orge19fe14" class="outline-3">
<h3 id="orge19fe14"><span class="section-number-3">36.31</span> Adobe</h3>
<div class="outline-text-3" id="text-36-31">
</div>
<div id="outline-container-orgd4f138b" class="outline-4">
<h4 id="orgd4f138b"><span class="section-number-4">36.31.1</span> Creative Cloud</h4>
<div class="outline-text-4" id="text-36-31-1">
<p>
If you have error 146 and an app update failed, you might need to reinstall Creative Cloud Desktop App and then update individual app.
</p>
</div>
</div>
<div id="outline-container-org991604c" class="outline-4">
<h4 id="org991604c"><span class="section-number-4">36.31.2</span> Photoshop</h4>
<div class="outline-text-4" id="text-36-31-2">
</div>
<div id="outline-container-org7d688a9" class="outline-5">
<h5 id="org7d688a9"><span class="section-number-5">36.31.2.1</span> Image Resize</h5>
<div class="outline-text-5" id="text-36-31-2-1">
<ul class="org-ul">
<li>Preserve Details (enlargement)</li>
<li>Bicubic Smoother (enlargement)</li>
<li>Bicubic Sharper (reduction)</li>
</ul>

<p>
Resize an animated gif
Window &gt; Workspace &gt; Motion
</p>

<p>
Crop if you like. 
</p>

<p>
File &gt; Export &gt; Save for Web (Legacy) &gt; Resize it there
</p>
</div>
</div>
</div>

<div id="outline-container-org7fc051a" class="outline-4">
<h4 id="org7fc051a"><span class="section-number-4">36.31.3</span> Illustrator</h4>
<div class="outline-text-4" id="text-36-31-3">
</div>
<div id="outline-container-org95fec3f" class="outline-5">
<h5 id="org95fec3f"><span class="section-number-5">36.31.3.1</span> Setting</h5>
<div class="outline-text-5" id="text-36-31-3-1">
<p>
Preferences &gt; General &gt; enable Scale Strokes &amp; Effects
</p>

<p>
Control Panel &gt; Document Setup
When nothing is selected, on the top below menu, you will see a Control Panel.
Document Setup can set Units and Bleed.
</p>

<p>
<code>View &gt; Smart Guides</code> Show Smart Guides (alignment suggestion)
<code>View &gt; Show Grid</code> Show grids inside and outside artboards
</p>
</div>
</div>

<div id="outline-container-orge7b7d44" class="outline-5">
<h5 id="orge7b7d44"><span class="section-number-5">36.31.3.2</span> Panels, Workspace, Artboard</h5>
<div class="outline-text-5" id="text-36-31-3-2">
<p>
Add extra panels <code>Window Menu</code>
</p>
<ul class="org-ul">
<li>Align along with Transform and Pathfinder</li>
<li>Info without Navigator</li>
<li>Type &gt; Character panel</li>
</ul>

<p>
Default Panels
</p>
</div>
<ol class="org-ol">
<li><a id="orgff3a1f0"></a>Layers Panel<br />
<div class="outline-text-6" id="text-36-31-3-2-1">
<ul class="org-ul">
<li>Change path color</li>
<li>Template and Dim images to
<ul class="org-ul">
<li>That layer has raster images. Used as a background to draw vector path on top of it</li>
</ul></li>
<li>Move objects inside or to a different layer</li>
</ul>
</div>
</li>

<li><a id="orgaa11747"></a>Artboards Panel, Artboard Tool <code>Shift + O</code><br />
<div class="outline-text-6" id="text-36-31-3-2-2">
<ul class="org-ul">
<li>Change canvas size, orientation and other settings which you see when creating a document</li>
<li>May also change the current artboard in the Artboard Tool</li>
<li>Export individual artboard to different file format File &gt; Export &gt; Export for Screens</li>
<li>Show Center Mark (center point)</li>
</ul>

<p>
Save as a new workspace. Reset to default workspace.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgdce380b" class="outline-5">
<h5 id="orgdce380b"><span class="section-number-5">36.31.3.3</span> Hand, Zoom, Screen mode, View, Rulers, Guides</h5>
<div class="outline-text-5" id="text-36-31-3-3">
<p>
Hand Tool <code>H</code> or <code>Spacebar</code> to temporary change to hand tool
</p>

<p>
Zoom tool (z)
</p>
<ul class="org-ul">
<li><code>Alt + Click</code> zoom out</li>
<li><code>Ctrl + 0</code> view whole or double click on hand tool</li>
<li><code>Ctrl + 1</code> view at 100% or double click on zoom tool</li>
</ul>

<p>
Cycle through screen modes for presentation <code>F</code>
</p>

<p>
A View is a view which shows a portion with correct zoom and boundaries.
</p>

<p>
View Menu &gt; Create a new view
</p>

<p>
Show Rulers <code>Ctrl + R</code>
</p>
<ul class="org-ul">
<li>Drag from one ruler to create a guide line</li>
<li>Or double click on the ruler to create a guide</li>
<li>Lock Guides in View Menu &gt;  Guides &gt; Lock Guides</li>
<li id="Draw a shape and make it guides">View &gt; Guides &gt; Make Guides</li>
</ul>
</div>
</div>

<div id="outline-container-orgb0b9a22" class="outline-5">
<h5 id="orgb0b9a22"><span class="section-number-5">36.31.3.4</span> Repeat the previous action</h5>
<div class="outline-text-5" id="text-36-31-3-4">
<p>
<code>Ctrl + D</code> e.g.
</p>
<ul class="org-ul">
<li>Duplicate an object after Alt + Drag</li>
<li>after scaling with the Copy action.</li>
</ul>
</div>
</div>

<div id="outline-container-org9181c82" class="outline-5">
<h5 id="org9181c82"><span class="section-number-5">36.31.3.5</span> Move, Select</h5>
<div class="outline-text-5" id="text-36-31-3-5">
<p>
Shift + Arrow :: move 10px
</p>

<p>
Ctrol + click on an object :: temporary select an object
Ctrol + Drag :: temporary select multiple objects
</p>
</div>
</div>

<div id="outline-container-org50a0b06" class="outline-5">
<h5 id="org50a0b06"><span class="section-number-5">36.31.3.6</span> Pencil and Brush tools</h5>
<div class="outline-text-5" id="text-36-31-3-6">
<p>
Free hand draw.
Pencil Tool (N) can only apply regular stroke.
Double click on the Pencil Tool on the left to changeL
</p>
<ul class="org-ul">
<li>smoothness</li>
<li>Closing path pixel amount</li>
</ul>

<p>
When about to close the path, hold down Alt. When you see a circle in the cursor, release the mouse.
The path will be closed.
</p>

<p>
Redraw part of the path to reshape part of the path
</p>

<p>
Brush (B) is the same as pencil but can add pattern and image in path.
</p>
<ul class="org-ul">
<li>Window &gt; Brush</li>
</ul>
</div>
</div>

<div id="outline-container-orge932498" class="outline-5">
<h5 id="orge932498"><span class="section-number-5">36.31.3.7</span> Basic Shapes</h5>
<div class="outline-text-5" id="text-36-31-3-7">
</div>
<ol class="org-ol">
<li><a id="org41e5ecc"></a>Line, arc, spiral, rectangular grids, polar grid<br />
<div class="outline-text-6" id="text-36-31-3-7-1">
<p>
In the left menu 
</p>
<ul class="org-ul">
<li>line (\)</li>
<li>arc</li>
<li>spiral (Shift, Up and Down to increase # of rings )</li>
<li>rectangular grids</li>
<li>polar grid</li>
</ul>
</div>
</li>

<li><a id="org4f7392a"></a>Rectangle, Ellipse<br />
<div class="outline-text-6" id="text-36-31-3-7-2">
<p>
In the left menu
</p>
<ul class="org-ul">
<li>Rectangle tool (M)</li>
<li>Rounded Rectangle Tool</li>
<li id="Ellipse tool (L)"></li>

<li id="Polygon Tool">Up or Down to change the number of sides</li>
<li id="Star Tool">Up or Down to change the number of angles.</li>
<li>Flare Tool</li>
</ul>

<p>
For any shape tool
</p>
<ul class="org-ul">
<li><code>Alt + Click</code> to draw a new shape with the same center point of another shape</li>
<li><code>Ctrl + Drag</code> to make the shape fatter or skinnier.</li>
</ul>
</div>
</li>
</ol>
</div>

<div id="outline-container-org71ea550" class="outline-5">
<h5 id="org71ea550"><span class="section-number-5">36.31.3.8</span> Drawing Modes</h5>
<div class="outline-text-5" id="text-36-31-3-8">
<p>
Shift + D :: change drawing mode: normal, behind, inside
</p>
</div>
</div>

<div id="outline-container-orgd8dfe67" class="outline-5">
<h5 id="orgd8dfe67"><span class="section-number-5">36.31.3.9</span> Transform Object</h5>
<div class="outline-text-5" id="text-36-31-3-9">
</div>
<ol class="org-ol">
<li><a id="org63c8f00"></a>Change Anchor Points or Control Handles<br />
<div class="outline-text-6" id="text-36-31-3-9-1">
<p>
Direct Selection Tool <code>A</code>
</p>
<ul class="org-ul">
<li><code>Alt + Drag</code> on anchor point to change only on one side</li>
</ul>
</div>
</li>

<li><a id="org9b3d206"></a>Group, Ungroup Objects, Isolation mode, Lasso Tool<br />
<div class="outline-text-6" id="text-36-31-3-9-2">
<ul class="org-ul">
<li><code>Ctrol + G</code> Group multiple objects</li>
<li><code>Shift + Ctrol + G</code> Ungroup</li>
</ul>
<p>
Isolation mode: Double click on a group to go to sub group
</p>

<p>
Lasso Tool <code>Q</code>
</p>
<ul class="org-ul">
<li>Manual select multiple objects and then group them.</li>
</ul>
</div>
</li>

<li><a id="org9cd0acb"></a>Duplicate Object<br />
<div class="outline-text-6" id="text-36-31-3-9-3">
<p>
Alt + Drag :: with <code>Shift</code> to duplicate it horizontally or vertically
Repeat the previous action <code>Ctrl + D</code>
</p>
</div>
</li>

<li><a id="org4aa2b93"></a>Offset an object<br />
<div class="outline-text-6" id="text-36-31-3-9-4">
<p>
Offset anchor points to create another object
Object &gt; Offset Path
</p>
</div>
</li>

<li><a id="org3c20d0e"></a>Scale, Shear<br />
<div class="outline-text-6" id="text-36-31-3-9-5">
<p>
Scale Tool <code>S</code>. Double click to scale numerically.
May also change the reference point to scale to withtout Double click.
</p>

<p>
Shear Tool. Double click to shear numerically.
</p>
</div>
</li>

<li><a id="org4f5b927"></a>Rotate and Reflect Object<br />
<div class="outline-text-6" id="text-36-31-3-9-6">
<p>
Rotation Tool <code>R</code>
Choose another reference point to rotate
<code>Alt + Drag</code> while rotating and release will make a copy after rotation
Then may repeat the action to make several copies <code>Ctrl + D</code>
</p>

<p>
Reflect Tool <code>O</code> Symmetry
When the tool is selected, the reference point by default is the center point.
Change the reference point and then drag.
Use <code>Shift</code> to rotate vertically or horizontally
Hold down <code>Alt</code> while drag and then release to copy the reflection object
</p>

<p>
May also right click on the object, select Transform &gt; Reflect and select copy. Later move that object in place
</p>
</div>
</li>

<li><a id="orgbbeeeaa"></a>Free Transform Tool<br />
<div class="outline-text-6" id="text-36-31-3-9-7">
<p>
Mouse operations only <code>E</code>
Rotate, scale, change aspect ratio
</p>
</div>
</li>

<li><a id="org48340c8"></a>Transform Each<br />
<div class="outline-text-6" id="text-36-31-3-9-8">
<p>
Object Menu &gt; Transform &gt; Transform Each <code>Ctrl + Alt + Shift + D</code>
</p>

<p>
Transform based on one of the 9 points. 
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgf9ae840" class="outline-5">
<h5 id="orgf9ae840"><span class="section-number-5">36.31.3.10</span> Fill and Stroke</h5>
<div class="outline-text-5" id="text-36-31-3-10">
<p>
Default Fill and Stroke <code>D</code>
No fill <code>\</code>
Select multiple objects, press <code>I</code>, then select a color. All objects will be filled in that color.
</p>
</div>

<ol class="org-ol">
<li><a id="org03b1b00"></a>Gradient<br />
<div class="outline-text-6" id="text-36-31-3-10-1">
<p>
Select an object, go to Window &gt; Gradient, select a Type.
</p>

<p>
On the left menu, select Gradient Tool <code>G</code>, then draw line inside the object.
</p>

<p>
May apply gradients to both stroke and fill for an object.
</p>
</div>
</li>

<li><a id="org5afb118"></a>Stroke<br />
<div class="outline-text-6" id="text-36-31-3-10-2">
<p>
Show outline only <code>Ctrl+Y</code>
Click on Stroke on the top menu (Control Panel), when a path/object is selected.
</p>

<p>
May change the width of a stroke partially or dynamically using Width Tool <code>Shift + W</code>
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org42c9fa4" class="outline-5">
<h5 id="org42c9fa4"><span class="section-number-5">36.31.3.11</span> Color, Swatch</h5>
<div class="outline-text-5" id="text-36-31-3-11">
</div>
<ol class="org-ol">
<li><a id="org893ee0c"></a>Color Setting<br />
<div class="outline-text-6" id="text-36-31-3-11-1">
<p>
Edit &gt; Color Settings
North America General Purpose 2
RGB: sRGB IEC61966-2.1
CMYK: US Web Coated SWOP v2
Choose Preserve for RGB and CMYK
Enable all Ask When Opening, Ask When Pasting
</p>
</div>
</li>

<li><a id="orge201df0"></a>Process, Global, Spot Color<br />
<div class="outline-text-6" id="text-36-31-3-11-2">
<p>
Process color means that color only applies to an object. 
Changing that process color only changes color of that object.
Changing a global color means all objects using that global color will change color.
</p>

<p>
To create a global color
Open Window &gt; Swatches
Apply a color for an object. Select or create a group. New Swatch, select Global
</p>

<p>
Spot color is usually provided by a vendor/company which, for example, provides specific ink.
To further ensure the spot color is always accurate on finished products (e.g. prints).
</p>
</div>
</li>

<li><a id="orgb268369"></a>Import Export Swatch<br />
<div class="outline-text-6" id="text-36-31-3-11-3">
<p>
.ase file. Window &gt; Swatches
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org0c80746" class="outline-5">
<h5 id="org0c80746"><span class="section-number-5">36.31.3.12</span> Appearance</h5>
<div class="outline-text-5" id="text-36-31-3-12">
<p>
Window &gt; Appearance
Add overall effects on all objects or on a specific object
Change attributes: Stroke, Fill, Opacity
May stack stroke and fill effects.
May use pattern in Fill 
Add Live Effects (fx) or Effect (top menu): Drop Shadow, Warp etc.
Save appearances as graphic styles
Select an object with some Appearances, then open Window &gt; Graphic Styles, create new
Apply that new Graphic Style on another object in the same .ai file.
In the Graphic Styles window, Select unused graphic styles, and remove.
Save the rest Graphic Styles, and hit Save Graphic Styles as Library.
Open a new ai file, in the Graphic Styles Window, load User Defined.
Then you can apply the Graphic Style across ai files.
</p>
</div>
</div>

<div id="outline-container-org99d42ef" class="outline-5">
<h5 id="org99d42ef"><span class="section-number-5">36.31.3.13</span> Complex Shapes, Compound Path, Pathfinder, Shape Builder</h5>
<div class="outline-text-5" id="text-36-31-3-13">
<p>
Compound Path
</p>
<ul class="org-ul">
<li>2 Paths: Inner and outer circles</li>
<li>Select both paths and Ctrl+8 to make a compound path</li>
<li>Later double click on the compound path, inner circle can be resized!</li>
</ul>

<p>
Pathfinder
</p>
<ul class="org-ul">
<li>Window &gt; Pathfinder. You can't change the paths after it's applied</li>
<li>Shape modes: the result is a single path of the end shape
<ul class="org-ul">
<li>Unite</li>
<li id="Minus Front">Back path mius front path. Punch a front path hole in back path.</li>
<li>Intersect</li>
<li id="Exclude">Front + Back - intersect</li>
</ul></li>
<li>Pathfinders mode: the result is a bunch of paths that form the end shape
<dl class="org-dl">
<dt>Divide</dt><dd>Front + Back but with shapes cut at any intersection</dd>
<dt>(no term)</dt><dd>Trim</dd>
<dt>(no term)</dt><dd>Merge</dd>
<dt>(no term)</dt><dd>Crop</dd>
<dt>(no term)</dt><dd>Outline</dd>
<dt>(no term)</dt><dd>Minus Back</dd>
</dl></li>
</ul>

<p>
Shape Builder
</p>
<ul class="org-ul">
<li>Left menu: Shift + M</li>
<li>Result is like Pathfinder's Pathfinders mode.</li>
<li>Select both paths and draw straight line to indicate which area should bring front</li>
<li>Draw straight line while holding <code>Alt</code> is to subtract</li>
</ul>
</div>
</div>

<div id="outline-container-org890d955" class="outline-5">
<h5 id="org890d955"><span class="section-number-5">36.31.3.14</span> Eraser</h5>
<div class="outline-text-5" id="text-36-31-3-14">
<p>
Eraser fixes path around edges. Shift + E
[ or ] to increase the size
</p>

<p>
Make sure to select a path then erase. Otherwise all paths will be erased.
</p>
</div>
</div>

<div id="outline-container-orgd0d4213" class="outline-5">
<h5 id="orgd0d4213"><span class="section-number-5">36.31.3.15</span> Pen Tool</h5>
<div class="outline-text-5" id="text-36-31-3-15">
<p>
Pen Tool <code>P</code>
</p>
<ul class="org-ul">
<li>Point, click and move to create straight line</li>
<li><code>Alt + Drag</code> to bend any path at any point</li>
<li>Draw curve line with Pen Tool
<ul class="org-ul">
<li>Start point: Click and drag to the direction that the curve starts</li>
<li>End point: click and drag to the opposite direction that the curve ends</li>
<li>Change handle pdirection of an anchor point
<ul class="org-ul">
<li>Direct Selection Tool <code>A</code> and change the handle direction</li>
</ul></li>
<li>Remove "whip": remove the handle of an anchor point
<ul class="org-ul">
<li><code>Alt + Click</code> on the anchor point</li>
</ul></li>
</ul></li>
<li>No fill or fill none <code>\</code> when necessary</li>
<li>Direct Select Tool <code>A</code> to change anchor points and handles</li>
</ul>

<p>
Add Anchor Point Tool <code>+</code>
Delete Anchor Point Tool <code>-</code>
Anchor Point Tool <code>Shift + C</code>
</p>
<ul class="org-ul">
<li>Turn a point into anchor point (no handle, angle)</li>
<li><code>Click + Drag</code> to create 2 handles</li>
</ul>
</div>
</div>

<div id="outline-container-org9962c26" class="outline-5">
<h5 id="org9962c26"><span class="section-number-5">36.31.3.16</span> Type Tool</h5>
<div class="outline-text-5" id="text-36-31-3-16">
<p>
<code>T</code>
Convert between Point Type and Area Type <code>Type &gt; Convert to Point Type</code>
</p>
<dl class="org-dl">
<dt>Point Type</dt><dd>one line. It scales when it's resized</dd>
<dt>Area Type</dt><dd>Fit text into a box. It doesn't scale when it's resized</dd>
</dl>

<p>
Panels
</p>
<ul class="org-ul">
<li>Window &gt; Character
<ul class="org-ul">
<li>Character, Paragraph, OpenType</li>
</ul></li>
<li>Window &gt; Character Styles
<ul class="org-ul">
<li>Used to save Character or Paragraph styles defined above</li>
<li>Character Styles, Paragraph Styles</li>
</ul></li>
</ul>

<p>
Wrap text around an object
</p>
<ul class="org-ul">
<li>Select the object that text should wrap around</li>
<li>Object &gt; Text Wrap &gt; Make</li>
<li><code>Object &gt; Text Wrap &gt; Text Wrap Options</code> to change the offset</li>
<li>Right click on the same object, Arrange &gt; Bring to Front</li>
</ul>

<p>
Type on a Path Tool
</p>
<ul class="org-ul">
<li>e.g. curve path</li>
</ul>

<p>
Change Font Size Shortcuts
</p>
<ul class="org-ul">
<li><code>shift + ctrl + &gt; or &lt;</code> 2 points at a time</li>
<li><code>shift + alt + ctrl + &gt; or &lt;</code> 10 points at a time</li>
</ul>

<p>
Change Tracking of Font (horizontal space between characters)
</p>
<ul class="org-ul">
<li><code>opt + right or left arrow</code></li>
</ul>

<p>
Paragraph spacing <code>opt + up or down arrow</code>
</p>

<p>
Adobe Typekit :: Sync Fonts with local Desktop as long as Creative Clouds are installed locally
</p>

<p>
Turn Type into Paths <code>Type &gt; Create Outlines</code>
</p>
</div>
</div>

<div id="outline-container-orgf1f4438" class="outline-5">
<h5 id="orgf1f4438"><span class="section-number-5">36.31.3.17</span> Copy from InDesign</h5>
<div class="outline-text-5" id="text-36-31-3-17">
<ul class="org-ul">
<li>Select objects in InDesign and paste in AI.</li>
<li>View &gt; Outline, you will clipping mask. Get rid of it!</li>
<li>Object &gt; Clipping Mask &gt; Release</li>
<li>Select the outest outline and delete it.</li>
<li>View &gt; Preview to turn off Outline view.</li>
</ul>
</div>
</div>

<div id="outline-container-orga293b49" class="outline-5">
<h5 id="orga293b49"><span class="section-number-5">36.31.3.18</span> Resize canvas to selection</h5>
<div class="outline-text-5" id="text-36-31-3-18">
<p>
Object &gt; Artboards &gt; Fit to Selected Art
</p>
</div>
</div>

<div id="outline-container-org64ab6ac" class="outline-5">
<h5 id="org64ab6ac"><span class="section-number-5">36.31.3.19</span> Raster Image</h5>
<div class="outline-text-5" id="text-36-31-3-19">
<p>
Place an image <code>File &gt; Place</code>
The image is linked from Illustrator to the image file.
Illustrator can see any changes on the image file. 
</p>

<p>
Links Panel <code>Window &gt; Links</code>
</p>

<p>
Embed and Unembed (relink)
</p>

<p>
Clipping Mask
</p>
<ul class="org-ul">
<li>Draw a circle shape on top of the image</li>
<li>Select both the circle and the image</li>
<li><code>Object &gt; Clipping Mask &gt; Make</code> or right click <code>Make Clipping Mask</code></li>
<li>Double click to change the circle or image</li>
<li>Later right click on the image, <code>Release clipping mask</code> to remove the circle mask</li>
</ul>

<p>
Image Trace
Select the image, <code>Window &gt; Image Trace</code>
</p>

<p>
Convert Image Tracing to Paths
Select the Image Tracing object and <code>Object &gt; Expand</code> or <code>Expand</code> in the top Image Tracing control panel
Once expanded, image cannot be traced again.
</p>
</div>
</div>

<div id="outline-container-org64d7fe5" class="outline-5">
<h5 id="org64d7fe5"><span class="section-number-5">36.31.3.20</span> Crop image</h5>
<div class="outline-text-5" id="text-36-31-3-20">
<p>
You CAN crop raster images in Illustrator.
</p>

<p>
Draw a rectangle above the raster image.
Select both the rectangle and the image
choose Object &gt; Clipping Mask &gt; Make.
change blending mode to "darken" from transparency tab
choose Object &gt; Flatten Transparency..&gt; OK
Choose Object &gt; Expand&#x2026;
Now you have trimmed raster object.
</p>
</div>
</div>

<div id="outline-container-org84170d6" class="outline-5">
<h5 id="org84170d6"><span class="section-number-5">36.31.3.21</span> Export Assets</h5>
<div class="outline-text-5" id="text-36-31-3-21">
<p>
Window &gt; Asset Export.
Add objects one by one to Asset Export
</p>
</div>
</div>

<div id="outline-container-org969282c" class="outline-5">
<h5 id="org969282c"><span class="section-number-5">36.31.3.22</span> Export SVG</h5>
<div class="outline-text-5" id="text-36-31-3-22">
<p>
Select the object on the artboard then <code>File &gt; Save As &gt; svg</code>
Turn font into path :: Select all text &gt; Type &gt; Create Outlines
</p>

<p>
CS6 
</p>
<ul class="org-ul">
<li><code>Save As</code> all objects on one or multiple artboards.</li>
<li>Can't <code>Export</code> selection or Export multiple artboards</li>
<li>The artboard size is the viewport size in SVG</li>
</ul>

<p>
CC version
</p>
<ul class="org-ul">
<li>All or selected artboards can be Exported as SVG.</li>
<li>Selected objects can be exported separately using <code>File &gt; Export Selection</code></li>
<li>Add an object as Asset and Export Asset</li>
<li>Copy the object and paste in Dreamweaver!</li>
</ul>

<p>
SVG Profile :: SVG 1.1
Fonts. 
</p>
<ul class="org-ul">
<li>Type: SVG. If there's small text, use Convert to Outline which converts all Type to paths</li>
<li>Subsetting: None</li>
<li id="Image Location">Embed. Usually don't include raster image in SVG</li>
<li>Don't check <code>Preserve Illustrator Editing Capabilities</code> because it increases file size</li>
</ul>

<p>
Styling :: Inline Style or Presentation Attributes
Font :: Convert to Outlines
Images :: Preserve
Minify but not Responsive
</p>
</div>
</div>

<div id="outline-container-orgc892e03" class="outline-5">
<h5 id="orgc892e03"><span class="section-number-5">36.31.3.23</span> Scripts</h5>
<div class="outline-text-5" id="text-36-31-3-23">
<p>
Save script file in C:\Program Files (x86)\Adobe\Adobe Illustrator CS6\Presets\en_US\Scripts\
</p>

<p>
Restart AI and the script can be executed under File &gt; Scripts &gt;
</p>
</div>
</div>
</div>

<div id="outline-container-orge8da260" class="outline-4">
<h4 id="orge8da260"><span class="section-number-4">36.31.4</span> Color CC</h4>
<div class="outline-text-4" id="text-36-31-4">
<p>
<a href="https://color.adobe.com/create/color-wheel/">https://color.adobe.com/create/color-wheel/</a>
<a href="https://www.lynda.com/Creative-Cloud-tutorials/Kuler-Essential-Training/136175-2.html">https://www.lynda.com/Creative-Cloud-tutorials/Kuler-Essential-Training/136175-2.html</a>
</p>

<p>
Analogous
Create variants of the Base color which is always the center point. 
All 5 colors have the same saturation but differ in hue.
</p>

<p>
Monochormatic
Same Hue value, but different saturation and brightness values.
</p>

<p>
Triad
Create contrast colors.
</p>

<p>
Complementary
Opposite colors.
</p>

<p>
Compound
2 sets of opposite colors and for each set create another analogous color
</p>

<p>
Shades
Only different in brightness.
</p>

<p>
Use Mobile App: Adobe Capture to capture colors.
</p>
</div>
</div>
</div>

<div id="outline-container-orga742a69" class="outline-3">
<h3 id="orga742a69"><span class="section-number-3">36.32</span> Training</h3>
<div class="outline-text-3" id="text-36-32">
</div>
<div id="outline-container-org8a5345b" class="outline-4">
<h4 id="org8a5345b"><span class="section-number-4">36.32.1</span> Microsoft Virtual Academy MVA</h4>
<div class="outline-text-4" id="text-36-32-1">
<p>
Free <a href="https://mva.microsoft.com">https://mva.microsoft.com</a>
Put in the Exam code, e.g. 70-480 to get free training resources
</p>
</div>
</div>
<div id="outline-container-org7d8baf4" class="outline-4">
<h4 id="org7d8baf4"><span class="section-number-4">36.32.2</span> Microsoft Certification exam list</h4>
<div class="outline-text-4" id="text-36-32-2">
<p>
<a href="https://www.microsoft.com/en-us/learning/exam-list.aspx">https://www.microsoft.com/en-us/learning/exam-list.aspx</a>
</p>
</div>
</div>

<div id="outline-container-orga1fcf28" class="outline-4">
<h4 id="orga1fcf28"><span class="section-number-4">36.32.3</span> Microsoft Certification List and Study Group</h4>
<div class="outline-text-4" id="text-36-32-3">
<p>
<a href="https://borntolearn.mslearn.net/certification">A list of certifications and exams required for each certification</a>
<a href="https://borntolearn.mslearn.net/certification/developer">Study group for each exam and certification</a>
</p>
</div>
</div>

<div id="outline-container-org9fc8a09" class="outline-4">
<h4 id="org9fc8a09"><span class="section-number-4">36.32.4</span> Microsoft Online Proctored Exams</h4>
<div class="outline-text-4" id="text-36-32-4">
<p>
<a href="https://www.microsoft.com/en-us/learning/online-proctored-exams.aspx">https://www.microsoft.com/en-us/learning/online-proctored-exams.aspx</a>
Install the software and do a hardware test.
Sign in <a href="http://microsoft.com/learning">http://microsoft.com/learning</a> to take an exam half an hour early
Click "Your benefits &amp; exams" then "Start a previously scheduled online proctored exam"
</p>
</div>
</div>
</div>

<div id="outline-container-org23c4ed2" class="outline-3">
<h3 id="org23c4ed2"><span class="section-number-3">36.33</span> Work Ethics</h3>
<div class="outline-text-3" id="text-36-33">
</div>
<div id="outline-container-orgb8c5727" class="outline-4">
<h4 id="orgb8c5727"><span class="section-number-4">36.33.1</span> Remove Credentials</h4>
<div class="outline-text-4" id="text-36-33-1">
<ul class="org-ul">
<li><a href="#org9682045">Windows Credential Store Panel</a></li>
<li>Chrome</li>
<li>Git remove remotes <code>git remote rm li</code> this also deletes all branches of that remote</li>
<li>~/.ssh/config</li>
<li>rm -rf <i>mnt/e/li</i></li>
<li>phpStorm remove all projects</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgc270878" class="outline-3">
<h3 id="orgc270878"><span class="section-number-3">36.34</span> TeamViewer</h3>
<div class="outline-text-3" id="text-36-34">
<p>
1）完整卸载并删除现有TeamViewer安装过的版本
2）删除：%AppData%\Teamviewer、%tmp%\TeamViewer
3）删除：C:\Users\Administrator\AppData\Local\TeamViewer
4）删除：HKCU\Software\TeamViewer、HKLM\SOFTWARE\TeamViewer
5）下载Teamviewer对应版本，安装方式选个人非商业用途，然后打补丁即可！
</p>

<p>
如果想让破解补丁用于便携版，可装一次安装版，然后打完补丁后把下面三个文件：
TeamViewer.exe、TeamViewer_Service.exe、TeamViewer_Desktop.exe 
复制出来替换到便携版即可！
</p>

<p>
<a href="http://www.zdfans.com/6351.html">http://www.zdfans.com/6351.html</a>
</p>
</div>
</div>

<div id="outline-container-org9585592" class="outline-3">
<h3 id="org9585592"><span class="section-number-3">36.35</span> Font</h3>
<div class="outline-text-3" id="text-36-35">
<p>
WOFF is supported in Edge and modern browsers. IE 11 and less only supports EOT.
</p>

<p>
Install OTF (OpenType Font) over TTF (TrueType Font).
</p>

<p>
For web, always include WOFF (Web Open Font Format), then TTF then OTF. WOFF is good for SEO
</p>

<p>
As you can see OTF is newer and based on TTF but it's much smaller.
</p>

<p>
TTF rendered in different devices has non-equal pixels.
</p>

<p>
Refer to <a href="#org0eea7ac">css:font-face</a>
</p>
</div>

<div id="outline-container-org4940841" class="outline-4">
<h4 id="org4940841"><span class="section-number-4">36.35.1</span> Abbreviations Foundary</h4>
<div class="outline-text-4" id="text-36-35-1">
<p>
<a href="https://www.extensis.com/blog/fonts/abbreviations-font-names/">https://www.extensis.com/blog/fonts/abbreviations-font-names/</a>
</p>

<p>
Foundry name: usually in the form of one or two letters at the beginning or end of the name (LT, MT, A, BT, FB, URW). “Foundries” are the companies that create fonts, a term going back to the days of metal type.
</p>

<p>
Language designation: comes at the end of a name (Cyr, Grk, CE). Generally this only applies to older fonts where a separate font was issued for different languages. In most cases, newer fonts put all the languages in a single font.
</p>

<p>
Font size as intended in print: (Text, Display, Poster/Caption, Small Text, Regular, Subhead, Display).
</p>
</div>
</div>

<div id="outline-container-orgd267a68" class="outline-4">
<h4 id="orgd267a68"><span class="section-number-4">36.35.2</span> Not a valid font file Windows</h4>
<div class="outline-text-4" id="text-36-35-2">
<p>
Turn off firewall or try font converter to convert the font and then install
</p>
</div>
</div>

<div id="outline-container-org40ebc4b" class="outline-4">
<h4 id="org40ebc4b"><span class="section-number-4">36.35.3</span> Line height</h4>
<div class="outline-text-4" id="text-36-35-3">
<p>
Fonts rendered different line height across browsers is because Line Height Adjustment option is not in the font.
</p>

<p>
Line Height Adjustments
</p>

<ul class="org-ul">
<li>Best (Use the best method to normalize the line height for this font)</li>
<li>120% (Redefine the line height as 120% of the point size)</li>
<li>Automatic (Distributes OS/2.Typo values across ascender, descender and line gap)</li>
<li>*Bounding Box (Match the bounding box of the glyphs, line gap will always be 0)</li>
<li>Native (Use the line height as defined in the font, results may differ between browsers)</li>
</ul>

<p>
Use Bounding Box.
</p>

<p>
<a href="https://iamvdo.me/en/blog/css-font-metrics-line-height-and-vertical-align">https://iamvdo.me/en/blog/css-font-metrics-line-height-and-vertical-align</a>
</p>

<p>
p {
    <i>* font metrics *</i>
    &#x2013;font: Catamaran;
    &#x2013;fm-capitalHeight: 0.68;
    &#x2013;fm-descender: 0.54;
    &#x2013;fm-ascender: 1.1;
    &#x2013;fm-linegap: 0;
</p>

<p>
<i>* desired font-size for capital height *</i>
&#x2013;capital-height: 100;
</p>

<p>
<i>* apply font-family *</i>
font-family: var(&#x2013;font);
</p>

<p>
<i>* compute font-size to get capital height equal desired font-size *</i>
&#x2013;computedFontSize: (var(&#x2013;capital-height) / var(&#x2013;fm-capitalHeight));
font-size: calc(var(&#x2013;computedFontSize) * 1px);
</p>

<p>
<i>* compute line-height:normal and content-area's height *</i>
&#x2013;lineheightNormal: (var(&#x2013;fm-ascender) + var(&#x2013;fm-descender) + var(&#x2013;fm-linegap));
&#x2013;contentArea: (var(&#x2013;lineheightNormal) * var(&#x2013;computedFontSize));
</p>

<p>
&#x2013;distanceBottom: (var(&#x2013;fm-descender));
&#x2013;distanceTop: (var(&#x2013;fm-ascender) - var(&#x2013;fm-capitalHeight));
</p>

<p>
&#x2013;valign: ((var(&#x2013;distanceBottom) - var(&#x2013;distanceTop)) * var(&#x2013;computedFontSize));
</p>

<p>
  &#x2013;line-height: 3;
    line-height: calc(((var(&#x2013;line-height) * var(&#x2013;capital-height)) - var(&#x2013;valign)) * 1px);
}
</p>
</div>
</div>

<div id="outline-container-orga82edd5" class="outline-4">
<h4 id="orga82edd5"><span class="section-number-4">36.35.4</span> <a href="https://docs.microsoft.com/en-us/typography/font-list/">Windows Font List</a></h4>
</div>
<div id="outline-container-orgc3ceb46" class="outline-4">
<h4 id="orgc3ceb46"><span class="section-number-4">36.35.5</span> <a href="http://iosfonts.com/">iOS Font List</a></h4>
</div>
<div id="outline-container-orgfff6a43" class="outline-4">
<h4 id="orgfff6a43"><span class="section-number-4">36.35.6</span> FontForge</h4>
<div class="outline-text-4" id="text-36-35-6">
<p>
<a href="http://fontforge.github.io/en-US/">http://fontforge.github.io/en-US/</a>
</p>

<p>
Element &gt; Font Info &gt; General to get Em Size
</p>

<p>
Element &gt; Font Info &gt; OS/2 to get 
</p>

<ul class="org-ul">
<li>Win Ascent, Win Descent for Windows</li>
<li>H Head Ascent, H Head Descent for Mac OS</li>
<li>Capital Height</li>
<li>X Height</li>
<li>Typo Line Gap and H Head Line Gap</li>
</ul>
</div>
</div>

<div id="outline-container-org1db173e" class="outline-4">
<h4 id="org1db173e"><span class="section-number-4">36.35.7</span> Google Font (GF)</h4>
<div class="outline-text-4" id="text-36-35-7">
<p>
Can be downloaded and installed on Desktop as .ttf and for website .woff or .woff2
</p>

<pre class="example">
# subset / scripts, Latin subset is always included if available and need not be specified.
&lt;link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Roboto+Mono&amp;subset=greek"&gt;

# Multiple fonts
https://fonts.googleapis.com/css?family=Tangerine|Inconsolata|Droid+Sans

# Multiple styles/wegihts (,)
https://fonts.googleapis.com/css?family=Tangerine:bold,bolditalic|Inconsolata:italic|Droid+Sans

http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,300italic,400italic,600italic
</pre>

<p>
text with url encoded value
</p>
<pre class="example">
https://fonts.googleapis.com/css?family=Inconsolata&amp;text=Hello%20World
</pre>

<p>
<a href="https://developers.google.com/fonts/docs/getting_started#enabling_font_effects_beta">effect</a>
</p>
<pre class="example">
https://fonts.googleapis.com/css?family=Rancho&amp;effect=shadow-multiple

// font-effect- class prefix
&lt;div class="font-effect-shadow-multiple"&gt;This is a font effect!&lt;div&gt;
</pre>
</div>
</div>

<div id="outline-container-org285f3ce" class="outline-4">
<h4 id="org285f3ce"><span class="section-number-4">36.35.8</span> Material Font, GF</h4>
<div class="outline-text-4" id="text-36-35-8">
<pre class="example">
&lt;link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"&gt;

// IE 10+
&lt;i class="material-icons"&gt;face&lt;/i&gt;

// For browsers do not support ligatures,
&lt;i class="material-icons"&gt;&amp;#xE87C;&lt;/i&gt;
</pre>

<p>
<a href="https://material.io/icons/">https://material.io/icons/</a> and corresponding <a href="https://github.com/google/material-design-icons/blob/master/iconfont/codepoints">codepoint index</a>
</p>

<p>
Recommended sizing and color setting
</p>
<pre class="example">
/* Rules for sizing the icon. */
.material-icons.md-18 { font-size: 18px; }
.material-icons.md-24 { font-size: 24px; }
.material-icons.md-36 { font-size: 36px; }
.material-icons.md-48 { font-size: 48px; }

/* Rules for using icons as black on a light background. */
.material-icons.md-dark { color: rgba(0, 0, 0, 0.54); }
.material-icons.md-dark.md-inactive { color: rgba(0, 0, 0, 0.26); }

/* Rules for using icons as white on a dark background. */
.material-icons.md-light { color: rgba(255, 255, 255, 1); }
.material-icons.md-light.md-inactive { color: rgba(255, 255, 255, 0.3); }

/* Custom color*/
.material-icons.orange600 { color: #FB8C00; }

&lt;i class="material-icons md-24"&gt;face&lt;/i&gt;

&lt;i class="material-icons md-dark"&gt;face&lt;/i&gt;
&lt;i class="material-icons md-dark md-inactive"&gt;face&lt;/i&gt;
&lt;i class="material-icons md-light"&gt;face&lt;/i&gt;

&lt;i class="material-icons orange600"&gt;face&lt;/i&gt;
</pre>
</div>
</div>

<div id="outline-container-orgae18af9" class="outline-4">
<h4 id="orgae18af9"><span class="section-number-4">36.35.9</span> Open source alternative, identify font</h4>
<div class="outline-text-4" id="text-36-35-9">
<p>
<a href="http://alternatype.net/">http://alternatype.net/</a>
</p>

<p>
Identify font: <a href="https://www.whatfontis.com/">https://www.whatfontis.com/</a>
</p>
</div>
</div>

<div id="outline-container-org8d276c7" class="outline-4">
<h4 id="org8d276c7"><span class="section-number-4">36.35.10</span> Extensis</h4>
<div class="outline-text-4" id="text-36-35-10">
<p>
<a href="https://www.extensis.com/support">https://www.extensis.com/support</a> Download Universal Type Client (6.1.5) not Universal Type Server 6 Core Client
</p>
</div>
</div>

<div id="outline-container-org960bb3a" class="outline-4">
<h4 id="org960bb3a"><span class="section-number-4">36.35.11</span> Monoid</h4>
<div class="outline-text-4" id="text-36-35-11">
<p>
<a href="https://github.com/JB-Dmitry/monoid">https://github.com/JB-Dmitry/monoid</a>
</p>
</div>
</div>

<div id="outline-container-org72e4c24" class="outline-4">
<h4 id="org72e4c24"><span class="section-number-4">36.35.12</span> Hasklig</h4>
<div class="outline-text-4" id="text-36-35-12">
<p>
<a href="https://github.com/i-tu/Hasklig">https://github.com/i-tu/Hasklig</a> Extend Source Code Pro
</p>
</div>
</div>

<div id="outline-container-org6025760" class="outline-4">
<h4 id="org6025760"><span class="section-number-4">36.35.13</span> Poppin, GF</h4>
</div>
<div id="outline-container-org3f4f8b2" class="outline-4">
<h4 id="org3f4f8b2"><span class="section-number-4">36.35.14</span> Museo, GF</h4>
</div>
<div id="outline-container-org845e3bd" class="outline-4">
<h4 id="org845e3bd"><span class="section-number-4">36.35.15</span> Roboto Slab, GF</h4>
</div>
<div id="outline-container-org861a39a" class="outline-4">
<h4 id="org861a39a"><span class="section-number-4">36.35.16</span> IcoMoon</h4>
<div class="outline-text-4" id="text-36-35-16">
<p>
Upload font to IcoMoon, and you can generate SVG sprite!
</p>
</div>
</div>

<div id="outline-container-org7944819" class="outline-4">
<h4 id="org7944819"><span class="section-number-4">36.35.17</span> Fontello</h4>
<div class="outline-text-4" id="text-36-35-17">
<p>
Open source Font, CSS, SVG sprites.
Fontelico
Font Awesome
Entypo
Typicons
Iconic
Modern Pictograms
Meteocons
MFG Labs
Maki
Zocial
Brandico
Elusive
Linecons
Web Symbols
</p>
</div>
</div>
</div>

<div id="outline-container-org2c1624e" class="outline-3">
<h3 id="org2c1624e"><span class="section-number-3">36.36</span> Digital Agency</h3>
<div class="outline-text-3" id="text-36-36">
<p>
DriveDigital.ca
<a href="https://gildedagency.com/">https://gildedagency.com/</a> Ontario
<a href="https://upperquad.com/">https://upperquad.com/</a>
<a href="https://18f.gsa.gov/">https://18f.gsa.gov/</a>
<a href="https://therefore.ca/">https://therefore.ca/</a>
<a href="https://echidna.ca/">https://echidna.ca/</a>
<a href="https://www.optasy.com/">https://www.optasy.com/</a>
<a href="https://www.myplanet.com/">https://www.myplanet.com/</a>
<a href="https://devshop.support/">https://devshop.support/</a>
</p>

<p>
<a href="http://www.webmarketingassociation.org/wma/">Web Marketing Association and awards</a> (WMA)
<a href="http://www.webaward.org/">WebAward.org</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org512cfb2" class="outline-2">
<h2 id="org512cfb2"><span class="section-number-2">37</span> <span class="todo TODO">TODO</span> s</h2>
<div class="outline-text-2" id="text-37">
</div>
<div id="outline-container-org762edd9" class="outline-3">
<h3 id="org762edd9"><span class="section-number-3">37.1</span> <span class="todo TODO">TODO</span> Inspectlet.com</h3>
</div>
<div id="outline-container-orgdea0815" class="outline-3">
<h3 id="orgdea0815"><span class="section-number-3">37.2</span> <span class="todo TODO">TODO</span> QUnit</h3>
</div>
<div id="outline-container-org577cbc5" class="outline-3">
<h3 id="org577cbc5"><span class="section-number-3">37.3</span> <span class="todo TODO">TODO</span> Lynda Bootstrap Layout Responsive Single-Page Design</h3>
</div>
<div id="outline-container-org6199956" class="outline-3">
<h3 id="org6199956"><span class="section-number-3">37.4</span> <span class="todo TODO">TODO</span> Lynda Bootstrap 3: Advanced Web Development</h3>
</div>
<div id="outline-container-org4cf0ebc" class="outline-3">
<h3 id="org4cf0ebc"><span class="section-number-3">37.5</span> <span class="todo TODO">TODO</span> Learn Continuous Integration "Pantheon Build Drupal with Composer on Travis"</h3>
</div>
<div id="outline-container-org07f99ff" class="outline-3">
<h3 id="org07f99ff"><span class="section-number-3">37.6</span> <span class="todo TODO">TODO</span> Learn tool Zeplin</h3>
</div>
<div id="outline-container-org33a1640" class="outline-3">
<h3 id="org33a1640"><span class="section-number-3">37.7</span> <span class="todo TODO">TODO</span> Blowfish hashing algorithm using random salt which is stored in db</h3>
</div>
<div id="outline-container-orgeaaa790" class="outline-3">
<h3 id="orgeaaa790"><span class="section-number-3">37.8</span> <span class="todo TODO">TODO</span> Lynda Web Project Workflows with Gulp.js, Git, and Browserify</h3>
</div>
<div id="outline-container-org428c6a1" class="outline-3">
<h3 id="org428c6a1"><span class="section-number-3">37.9</span> <span class="todo TODO">TODO</span> Lynda Agile Project Management</h3>
</div>
<div id="outline-container-orgd803996" class="outline-3">
<h3 id="orgd803996"><span class="section-number-3">37.10</span> <span class="todo TODO">TODO</span> Lynda Javascript: Enhancing the DOM</h3>
</div>
<div id="outline-container-org9042aff" class="outline-3">
<h3 id="org9042aff"><span class="section-number-3">37.11</span> <span class="todo TODO">TODO</span> Lynda Firebase, Travis CI, Heroku</h3>
</div>
<div id="outline-container-orgac260ae" class="outline-3">
<h3 id="orgac260ae"><span class="section-number-3">37.12</span> <span class="todo TODO">TODO</span> Lynda: Foundations of Programming: Object-Oriented Design</h3>
</div>
<div id="outline-container-orgd1e3b5f" class="outline-3">
<h3 id="orgd1e3b5f"><span class="section-number-3">37.13</span> <span class="todo TODO">TODO</span> JavaScript HTML5 Animation Framework: GSAP or Tween <a href="https://greensock.com/">https://greensock.com/</a></h3>
</div>
<div id="outline-container-orge4ad0ff" class="outline-3">
<h3 id="orge4ad0ff"><span class="section-number-3">37.14</span> <span class="todo TODO">TODO</span> Lynda: MVC Frameworks for Building PHP Web Applications with Drew Falkman</h3>
</div>
<div id="outline-container-orgebed0e9" class="outline-3">
<h3 id="orgebed0e9"><span class="section-number-3">37.15</span> <span class="todo TODO">TODO</span> Book: Design Patterns: Elements of Reusable Object-Oriented Software (Addison-Wesley)</h3>
</div>
<div id="outline-container-org6f437fb" class="outline-3">
<h3 id="org6f437fb"><span class="section-number-3">37.16</span> <span class="todo TODO">TODO</span> Book: Code Complete (2nd Edition, Microsoft Press)</h3>
</div>
<div id="outline-container-org6a653e1" class="outline-3">
<h3 id="org6a653e1"><span class="section-number-3">37.17</span> <span class="todo TODO">TODO</span> custom-elements-everywhere.com, williams sonoma</h3>
</div>
<div id="outline-container-org58c7716" class="outline-3">
<h3 id="org58c7716"><span class="section-number-3">37.18</span> <span class="todo TODO">TODO</span> gridbyexample.com</h3>
</div>
<div id="outline-container-org23212f4" class="outline-3">
<h3 id="org23212f4"><span class="section-number-3">37.19</span> <span class="todo TODO">TODO</span> BrowserStack and BeHat</h3>
</div>
<div id="outline-container-org3806daf" class="outline-3">
<h3 id="org3806daf"><span class="section-number-3">37.20</span> <span class="todo TODO">TODO</span> SearchKings.ca</h3>
</div>
<div id="outline-container-org312b79d" class="outline-3">
<h3 id="org312b79d"><span class="section-number-3">37.21</span> <span class="todo TODO">TODO</span> Agency DriveDigital.ca</h3>
</div>
<div id="outline-container-org419a8fc" class="outline-3">
<h3 id="org419a8fc"><span class="section-number-3">37.22</span> <span class="todo TODO">TODO</span> Front End Design</h3>
<div class="outline-text-3" id="text-37-22">
</div>
<div id="outline-container-org31f6b9b" class="outline-4">
<h4 id="org31f6b9b"><span class="section-number-4">37.22.1</span> <a href="https://codekitapp.com/">https://codekitapp.com/</a></h4>
</div>
<div id="outline-container-org4f8776b" class="outline-4">
<h4 id="org4f8776b"><span class="section-number-4">37.22.2</span> <a href="https://webpack.js.org/">https://webpack.js.org/</a></h4>
</div>
<div id="outline-container-org9242890" class="outline-4">
<h4 id="org9242890"><span class="section-number-4">37.22.3</span> <a href="http://postcss.org/">http://postcss.org/</a></h4>
</div>
</div>
<div id="outline-container-org01b55fc" class="outline-3">
<h3 id="org01b55fc"><span class="section-number-3">37.23</span> <span class="todo TODO">TODO</span> <a href="https://wpengine.com/partners/agencies/">Web agencies backed by WP Engine</a></h3>
</div>
<div id="outline-container-org8d01f48" class="outline-3">
<h3 id="org8d01f48"><span class="section-number-3">37.24</span> <span class="todo TODO">TODO</span> <a href="https://developers.google.com/training/">https://developers.google.com/training/</a></h3>
</div>
<div id="outline-container-org4a1870a" class="outline-3">
<h3 id="org4a1870a"><span class="section-number-3">37.25</span> <span class="todo TODO">TODO</span> <a href="https://grow.google/">https://grow.google/</a></h3>
</div>
<div id="outline-container-orgea000c4" class="outline-3">
<h3 id="orgea000c4"><span class="section-number-3">37.26</span> <span class="todo TODO">TODO</span> <a href="https://www.thinkwithgoogle.com/intl/en-ca/">https://www.thinkwithgoogle.com/intl/en-ca/</a></h3>
</div>
<div id="outline-container-org1b72e9a" class="outline-3">
<h3 id="org1b72e9a"><span class="section-number-3">37.27</span> <span class="todo TODO">TODO</span> <a href="https://experiments.withgoogle.com/chrome">https://experiments.withgoogle.com/chrome</a></h3>
</div>
<div id="outline-container-org7ea6085" class="outline-3">
<h3 id="org7ea6085"><span class="section-number-3">37.28</span> <span class="todo TODO">TODO</span> <a href="https://www.sitepoint.com/nuxt-js-universal-vue-js/">https://www.sitepoint.com/nuxt-js-universal-vue-js/</a></h3>
</div>
<div id="outline-container-org1ca581d" class="outline-3">
<h3 id="org1ca581d"><span class="section-number-3">37.29</span> <span class="todo TODO">TODO</span> <a href="https://generalassemb.ly/">https://generalassemb.ly/</a> Course on Product Management</h3>
</div>
<div id="outline-container-org922ac65" class="outline-3">
<h3 id="org922ac65"><span class="section-number-3">37.30</span> <span class="todo TODO">TODO</span> <a href="https://www.roberthalf.com/">https://www.roberthalf.com/</a> Job Hunt</h3>
</div>
<div id="outline-container-orge245d89" class="outline-3">
<h3 id="orge245d89"><span class="section-number-3">37.31</span> <span class="todo TODO">TODO</span> <a href="https://developers.google.com/experts/">https://developers.google.com/experts/</a> <a href="https://abrah.am/">https://abrah.am/</a></h3>
</div>
<div id="outline-container-org20945a9" class="outline-3">
<h3 id="org20945a9"><span class="section-number-3">37.32</span> <span class="todo TODO">TODO</span> <a href="http://grow.io/">http://grow.io/</a></h3>
</div>
<div id="outline-container-org2a930cf" class="outline-3">
<h3 id="org2a930cf"><span class="section-number-3">37.33</span> <span class="todo TODO">TODO</span> <a href="https://www.ontario.ca/page/digital-government">https://www.ontario.ca/page/digital-government</a> <a href="https://medium.com/ontariodigital">https://medium.com/ontariodigital</a></h3>
</div>
<div id="outline-container-orgf0f2bc9" class="outline-3">
<h3 id="orgf0f2bc9"><span class="section-number-3">37.34</span> <span class="done DONE">DONE</span> Chase Payment</h3>
</div>
<div id="outline-container-orgb5eacda" class="outline-3">
<h3 id="orgb5eacda"><span class="section-number-3">37.35</span> <span class="done DONE">DONE</span> Lynda <a href="https://www.behance.net/">Behance.net</a></h3>
</div>
<div id="outline-container-org86a3673" class="outline-3">
<h3 id="org86a3673"><span class="section-number-3">37.36</span> <span class="done DONE">DONE</span> Lynda Illustrator CC for Web Design: Core Concepts, Aesthetics, Image Optimization, Wireframing, SVG</h3>
</div>
<div id="outline-container-orgb50b479" class="outline-3">
<h3 id="orgb50b479"><span class="section-number-3">37.37</span> <span class="done DONE">DONE</span> Lynda Adobe Illustrator Essential</h3>
</div>
<div id="outline-container-org319b18e" class="outline-3">
<h3 id="org319b18e"><span class="section-number-3">37.38</span> <span class="done DONE">DONE</span> Learn Bootstrap CSS framework</h3>
</div>
<div id="outline-container-org887d8c3" class="outline-3">
<h3 id="org887d8c3"><span class="section-number-3">37.39</span> <span class="done DONE">DONE</span> learn emacs org mode</h3>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2018-09-18 Tue 15:50</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
